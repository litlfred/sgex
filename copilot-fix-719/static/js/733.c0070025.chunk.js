"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[733],{38389:(e,t,s)=>{s.d(t,{Q5:()=>r,hI:()=>n,kv:()=>c,q_:()=>i,uC:()=>o,x:()=>a});const a={DAK:"dak",COMPONENT:"component",ASSET:"asset"};class r{constructor(e){let{id:t,level:s,title:a,description:r,parameters:n=[],tags:i=[],version:o="1.0.0",isTemplate:c=!1,componentTypes:l=[],assetTypes:d=[]}=e;this.id=t,this.level=s,this.title=a,this.description=r,this.parameters=n,this.tags=i,this.version=o,this.isTemplate=c,this.componentTypes=l,this.assetTypes=d}}class n{constructor(e){let{name:t,type:s="string",required:a=!1,description:r="",defaultValue:n=null,validation:i={}}=e;this.name=t,this.type=s,this.required=a,this.description=r,this.defaultValue=n,this.validation=i}}class i{constructor(e){let{repository:t,locale:s="en_US",branch:a="main",user:r=null,assetFile:n=null,componentType:i=null,storage:o=null}=e;this.repository=t,this.locale=s,this.branch=a,this.user=r,this.assetFile=n,this.componentType=i,this.storage=o}}class o{constructor(e){let{structured:t={},narrative:s="",warnings:a=[],errors:r=[],meta:n={}}=e;this.structured=t,this.narrative=s,this.warnings=a,this.errors=r,this.meta=n}}class c{constructor(e){let{scope:t="repository",key:s="",ttl:a=3600,dependencies:r=[]}=e;this.scope=t,this.key=s,this.ttl=a,this.dependencies=r}}},61733:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var a=s(89379),r=s(65043),n=s(74117),i=s(73537),o=s(38389),c=s(55661);const l=new class{constructor(){this.registry=null,this.loaded=!1}loadFromYaml(e){try{this.registry=c.Ay.load(e),this.loaded=!0}catch(t){throw new Error("Failed to parse parameter registry YAML: ".concat(t.message))}}getParameters(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.loaded||!this.registry)throw new Error("Parameter registry not loaded");const s=[];if(this.registry.defaults)for(const[a,n]of Object.entries(this.registry.defaults))s.push(new o.hI({name:a,type:n.type,required:n.required||!1,description:n.description||"",defaultValue:n.default||null,validation:n.validation||{}}));if(this.registry[e])if(t&&this.registry[e][t])for(const[n,i]of Object.entries(this.registry[e][t]))s.push(new o.hI((0,a.A)({name:n},i)));else if(!t)for(const[n,i]of Object.entries(this.registry[e]))"object"===typeof i&&i.type&&s.push(new o.hI((0,a.A)({name:n},i)));const r=new Map;return s.forEach(e=>{r.set(e.name,e)}),Array.from(r.values())}validateParameters(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=this.getParameters(t,s),r={},n=[];for(const i of a){const t=e[i.name];if(i.required&&(void 0===t||null===t)){n.push("Required parameter '".concat(i.name,"' is missing"));continue}const s=void 0!==t?t:i.defaultValue;if(null!==s&&void 0!==s){const e=this.validateParameterType(s,i);if(e){n.push("Parameter '".concat(i.name,"': ").concat(e));continue}const t=this.validateParameterCustom(s,i);if(t){n.push("Parameter '".concat(i.name,"': ").concat(t));continue}}r[i.name]=s}for(const i of Object.keys(e))a.find(e=>e.name===i)||n.push("Unknown parameter '".concat(i,"'"));return{normalized:r,errors:n,isValid:0===n.length}}validateParameterType(e,t){const s=t.type,a=typeof e;switch(s){case"string":if("string"!==a)return"Expected string, got ".concat(a);break;case"boolean":if("boolean"!==a)return"Expected boolean, got ".concat(a);break;case"number":if("number"!==a||isNaN(e))return"Expected number, got ".concat(a);break;case"array":if(!Array.isArray(e))return"Expected array, got ".concat(a);break;case"object":if("object"!==a||Array.isArray(e))return"Expected object, got ".concat(a);break;default:return"Unknown type: ".concat(s)}return null}validateParameterCustom(e,t){if(!t.validation)return null;const s=t.validation;if(s.pattern&&"string"===typeof e){if(!new RegExp(s.pattern).test(e))return"Value does not match pattern ".concat(s.pattern)}return s.enum&&Array.isArray(s.enum)&&!s.enum.includes(e)?"Value must be one of: ".concat(s.enum.join(", ")):void 0!==s.minLength&&"string"===typeof e&&e.length<s.minLength?"String must be at least ".concat(s.minLength," characters"):void 0!==s.maxLength&&"string"===typeof e&&e.length>s.maxLength?"String must be at most ".concat(s.maxLength," characters"):void 0!==s.min&&"number"===typeof e&&e<s.min?"Number must be at least ".concat(s.min):void 0!==s.max&&"number"===typeof e&&e>s.max?"Number must be at most ".concat(s.max):null}getParameterSchema(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.getParameters(e,t),a={},r=[];for(const n of s){const e={type:n.type,description:n.description};null!==n.defaultValue&&(e.default=n.defaultValue),n.validation&&Object.assign(e,n.validation),a[n.name]=e,n.required&&r.push(n.name)}return{type:"object",properties:a,required:r}}};l.loadFromYaml('\ndefaults:\n  repository:\n    type: string\n    required: true\n    description: "Repository context (always required)"\n  locale:\n    type: string\n    required: false\n    default: "en_US"\n    description: "Locale for responses"\n  branch:\n    type: string\n    required: false\n    default: "main"\n    description: "Git branch context"\n\ndak:\n\ncomponent:\n  businessProcess:\n    componentType:\n      type: string\n      required: true\n      default: "businessProcess"\n      description: "Type of component being analyzed"\n\nasset:\n  lesson:\n    assetFile:\n      type: string\n      required: true\n      description: "Relative path to the lesson file"\n');const d=l;class u{async readFile(e){throw new Error("readFile must be implemented by subclass")}async fileExists(e){throw new Error("fileExists must be implemented by subclass")}async listFiles(e){throw new Error("listFiles must be implemented by subclass")}async getFileInfo(e){throw new Error("getFileInfo must be implemented by subclass")}}class h extends u{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";super(),this.githubService=e,this.repository=t,this.branch=s,this.cache=new Map}parseRepository(e){if("string"===typeof e){if(e.includes("github.com")){const t=e.match(/github\.com\/([^/]+)\/([^/?#]+)/);if(t)return{owner:t[1],repo:t[2].replace(/\.git$/,"")}}const t=e.split("/");if(2===t.length)return{owner:t[0],repo:t[1]}}throw new Error("Invalid repository format: ".concat(e))}async readFile(e){const t="".concat(this.repository,":").concat(this.branch,":").concat(e);if(this.cache.has(t))return this.cache.get(t);try{const{owner:s,repo:a}=this.parseRepository(this.repository),r=await this.githubService.getFileContent(s,a,e,this.branch),n=Buffer.from(r.content,"base64");return this.cache.set(t,n),n}catch(s){throw new Error("Failed to read file ".concat(e,": ").concat(s.message))}}async fileExists(e){try{return await this.readFile(e),!0}catch(t){return!1}}async listFiles(e){try{const{owner:t,repo:s}=this.parseRepository(this.repository),a=(await this.githubService.getRepositoryTree(t,s,this.branch,!0)).tree.filter(e=>"blob"===e.type).map(e=>e.path);if(e.includes("*")||e.includes("?")){const t=e.replace(/\./g,"\\.").replace(/\*/g,".*").replace(/\?/g,"."),s=new RegExp("^".concat(t,"$"));return a.filter(e=>s.test(e))}return a.filter(t=>t.startsWith(e))}catch(t){throw new Error("Failed to list files: ".concat(t.message))}}async getFileInfo(e){try{const{owner:t,repo:s}=this.parseRepository(this.repository),a=await this.githubService.getFileContent(t,s,e,this.branch);return{size:Buffer.from(a.content,"base64").length,sha:a.sha,path:a.path,type:a.type,url:a.html_url}}catch(t){throw new Error("Failed to get file info for ".concat(e,": ").concat(t.message))}}}const m=new class{constructor(){this.questionRegistry=new Map,this.initialized=!1}async initialize(){if(!this.initialized)try{await this.loadQuestions(),this.initialized=!0}catch(e){throw new Error("Failed to initialize FAQ engine: ".concat(e.message))}}async loadQuestions(){const e=[{id:"dak-name",module:()=>s.e(554).then(s.bind(s,78554))},{id:"dak-version",module:()=>s.e(41).then(s.bind(s,20041))},{id:"business-process-workflows",module:()=>s.e(703).then(s.bind(s,62703))},{id:"decision-table-inputs",module:()=>s.e(560).then(s.bind(s,48560))}];for(const s of e)try{const e=await s.module();e.metadata&&e.execute?this.questionRegistry.set(s.id,{metadata:e.metadata,execute:e.execute,Render:e.Render||null}):console.warn("Question ".concat(s.id," is missing required exports (metadata, execute)"))}catch(t){console.error("Failed to load question ".concat(s.id,":"),t)}}getCatalog(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.initialized)throw new Error("FAQ engine not initialized");let t=Array.from(this.questionRegistry.values()).map(e=>e.metadata);return e.level&&(t=t.filter(t=>t.level===e.level)),e.tags&&Array.isArray(e.tags)&&(t=t.filter(t=>e.tags.some(e=>t.tags.includes(e)))),e.componentType&&(t=t.filter(t=>!t.componentTypes||0===t.componentTypes.length||t.componentTypes.includes(e.componentType))),e.assetType&&(t=t.filter(t=>!t.assetTypes||0===t.assetTypes.length||t.assetTypes.includes(e.assetType))),t}async executeBatch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.initialized||await this.initialize();const s=[];for(const r of e)try{const e=await this.executeQuestion(r,t);s.push({questionId:r.questionId,success:!0,result:e})}catch(a){s.push({questionId:r.questionId,success:!1,error:a.message,result:new o.uC({structured:{},narrative:this.getErrorNarrative(r.locale||"en_US",a.message),errors:[a.message],meta:{}})})}return s}async executeQuestion(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{questionId:s,parameters:r={},assetFiles:n=[]}=e,i=this.questionRegistry.get(s);if(!i)throw new Error("Question not found: ".concat(s));if(i.metadata.isTemplate&&n.length>0)return await this.executeTemplateQuestion(i,e,t);const c=d.validateParameters(r,i.metadata.level,this.getQuestionType(i.metadata));if(!c.isValid)throw new Error("Parameter validation failed: ".concat(c.errors.join(", ")));const l=this.createStorage(c.normalized,t),u=new o.q_({repository:c.normalized.repository,locale:c.normalized.locale||"en_US",branch:c.normalized.branch||"main",user:t.user||null,assetFile:c.normalized.assetFile||null,componentType:c.normalized.componentType||null,storage:l}),h=(0,a.A)((0,a.A)({},c.normalized),{},{storage:l,context:u});return await i.execute(h)}async executeTemplateQuestion(e,t,s){const{parameters:r={},assetFiles:n=[]}=t,i=[],c=[],l=[];for(const p of n)try{const t=(0,a.A)((0,a.A)({},r),{},{assetFile:p}),n=d.validateParameters(t,e.metadata.level,this.getQuestionType(e.metadata));if(!n.isValid){l.push("Asset ".concat(p,": ").concat(n.errors.join(", ")));continue}const u=this.createStorage(n.normalized,s),h=new o.q_({repository:n.normalized.repository,locale:n.normalized.locale||"en_US",branch:n.normalized.branch||"main",user:s.user||null,assetFile:p,componentType:n.normalized.componentType||null,storage:u}),m=(0,a.A)((0,a.A)({},n.normalized),{},{storage:u,context:h}),g=await e.execute(m);i.push({assetFile:p,result:g}),g.warnings&&c.push(...g.warnings),g.errors&&l.push(...g.errors)}catch(m){l.push("Asset ".concat(p,": ").concat(m.message))}const u={assets:i.map(e=>(0,a.A)({assetFile:e.assetFile},e.result.structured)),summary:{totalAssets:n.length,successfulAssets:i.length,failedAssets:n.length-i.length}},h=this.aggregateNarratives(i,t.locale||"en_US");return new o.uC({structured:u,narrative:h,warnings:c,errors:l,meta:{isAggregated:!0,questionId:e.metadata.id,assetCount:n.length}})}createStorage(e,t){if(t.githubService)return new h(t.githubService,e.repository,e.branch||"main");throw new Error("Local storage not implemented in web context")}getQuestionType(e){return e.componentTypes&&e.componentTypes.length>0?e.componentTypes[0]:e.assetTypes&&e.assetTypes.length>0?e.assetTypes[0]:null}aggregateNarratives(e,t){if(0===e.length)return"<h4>No Results</h4><p>No assets were processed successfully.</p>";let s="<h4>Asset Analysis Results</h4>";s+="<p>Processed ".concat(e.length," asset(s):</p>"),s+="<ul>";for(const{assetFile:a,result:r}of e)s+="<li><strong>".concat(a,"</strong>"),r.errors&&r.errors.length>0?s+=' <span class="error">('.concat(r.errors.length," error(s))</span>"):r.warnings&&r.warnings.length>0?s+=' <span class="warning">('.concat(r.warnings.length," warning(s))</span>"):s+=' <span class="success">\u2713</span>',s+="</li>";return s+="</ul>",s}getErrorNarrative(e,t){const s={en_US:'<h4>Error</h4><p class="error">An error occurred while executing the question: '.concat(t,"</p>"),fr_FR:"<h4>Erreur</h4><p class=\"error\">Une erreur s'est produite lors de l'ex\xe9cution de la question: ".concat(t,"</p>"),es_ES:'<h4>Error</h4><p class="error">Ocurri\xf3 un error al ejecutar la pregunta: '.concat(t,"</p>")};return s[e]||s.en_US}normalizeLocale(e){if(!e)return"en_US";const t=e.replace("-","_");if(["en_US","fr_FR","es_ES","ar_AR","zh_CN","ru_RU"].includes(t))return t;return{en:"en_US",fr:"fr_FR",es:"es_ES",ar:"ar_AR",zh:"zh_CN",ru:"ru_RU"}[t.split("_")[0]]||"en_US"}};var p=s(87977),g=s(70579);const f=e=>{let{questionId:t,parameters:s={},githubService:i=null,assetFiles:o=[],showRawData:c=!1,className:l=""}=e;const{t:d,i18n:u}=(0,n.Bd)(),[h,f]=(0,r.useState)(null),[y,v]=(0,r.useState)(!1),[x,b]=(0,r.useState)(null),w=(0,r.useCallback)(async()=>{if(t&&i){v(!0),b(null);try{const e={questionId:t,parameters:(0,a.A)((0,a.A)({},s),{},{locale:u.language.replace("-","_")||"en_US"}),assetFiles:o},r={githubService:i},n=await m.executeQuestion(e,r);f(n)}catch(e){b(e.message)}finally{v(!1)}}},[t,s,i,o,u.language]);(0,r.useEffect)(()=>{w()},[w]);return y?(0,g.jsxs)("div",{className:"faq-answer loading ".concat(l),children:[(0,g.jsx)("div",{className:"faq-loading-spinner"}),(0,g.jsx)("p",{children:d("dak.faq.loading")})]}):x?(0,g.jsxs)("div",{className:"faq-answer error ".concat(l),children:[(0,g.jsx)("h4",{children:d("dak.faq.error_title")}),(0,g.jsx)("p",{className:"faq-error-message",children:x}),(0,g.jsx)("button",{onClick:w,className:"faq-retry-button",children:d("dak.faq.retry")})]}):h?(0,g.jsxs)("div",{className:"faq-answer success ".concat(l),children:[(()=>{return null!==h&&void 0!==h&&h.narrative?(0,g.jsx)("div",{className:"faq-narrative",dangerouslySetInnerHTML:{__html:(e=h.narrative,p.A.sanitize(e,{ALLOWED_TAGS:["h1","h2","h3","h4","h5","h6","p","div","span","ul","ol","li","strong","em","code","pre","time","small"],ALLOWED_ATTR:["class","datetime"]}))}}):null;var e})(),(()=>{const e=(null===h||void 0===h?void 0:h.warnings)||[],t=(null===h||void 0===h?void 0:h.errors)||[];return 0===e.length&&0===t.length?null:(0,g.jsxs)("div",{className:"faq-messages",children:[t.map((e,t)=>(0,g.jsxs)("div",{className:"faq-message faq-error",children:[(0,g.jsx)("span",{className:"faq-message-icon",children:"\u26a0\ufe0f"}),e]},"error-".concat(t))),e.map((e,t)=>(0,g.jsxs)("div",{className:"faq-message faq-warning",children:[(0,g.jsx)("span",{className:"faq-message-icon",children:"\u26a0\ufe0f"}),e]},"warning-".concat(t)))]})})(),c&&null!==h&&void 0!==h&&h.structured?(0,g.jsxs)("details",{className:"faq-structured-data",children:[(0,g.jsx)("summary",{children:d("dak.faq.structured_data")}),(0,g.jsx)("pre",{children:JSON.stringify(h.structured,null,2)})]}):null,c&&null!==h&&void 0!==h&&h.meta?(0,g.jsxs)("details",{className:"faq-metadata",children:[(0,g.jsx)("summary",{children:d("dak.faq.metadata")}),(0,g.jsx)("pre",{children:JSON.stringify(h.meta,null,2)})]}):null]}):(0,g.jsx)("div",{className:"faq-answer empty ".concat(l),children:(0,g.jsx)("p",{children:d("dak.faq.no_data")})})};var y=s(50404);const v=()=>{const{t:e}=(0,n.Bd)(),{user:t,repo:s,branch:o}=(0,i.g)(),c=(0,i.zy)(),[l,d]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[p,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{x()},[]);const x=async()=>{try{h(!0),await m.initialize();const e=m.getCatalog();d(e)}catch(e){v(e.message)}finally{h(!1)}},b=(()=>{if(t&&s)return{repository:"".concat(t,"/").concat(s),branch:o||"main"};const e=c.state;return null!==e&&void 0!==e&&e.user&&null!==e&&void 0!==e&&e.repo?{repository:"".concat(e.user,"/").concat(e.repo),branch:e.branch||"main"}:null})();return u?(0,g.jsxs)("div",{className:"dak-faq-demo loading",children:[(0,g.jsx)("div",{className:"loading-spinner"}),(0,g.jsx)("p",{children:e("dak.faq.loading")})]}):p?(0,g.jsxs)("div",{className:"dak-faq-demo error",children:[(0,g.jsx)("h2",{children:"FAQ System Error"}),(0,g.jsx)("p",{children:p}),(0,g.jsx)("button",{onClick:x,children:"Retry"})]}):b?(0,g.jsxs)("div",{className:"dak-faq-demo",children:[(0,g.jsxs)("header",{className:"dak-faq-demo-header",children:[(0,g.jsx)("h1",{children:"DAK FAQ Demo"}),(0,g.jsxs)("div",{className:"repository-info",children:[(0,g.jsx)("span",{className:"repo-name",children:b.repository}),(0,g.jsxs)("span",{className:"branch-name",children:["(",b.branch,")"]})]})]}),(0,g.jsxs)("div",{className:"faq-questions",children:[(0,g.jsx)("h2",{children:"Available Questions"}),(0,g.jsx)("p",{children:"Here are some example FAQ questions that can be answered about this DAK:"}),[{id:"dak-name",title:"What is the name of this DAK?",description:"Extracts the DAK name from sushi-config.yaml"},{id:"dak-version",title:"What is the version of this DAK?",description:"Extracts the DAK version from sushi-config.yaml"},{id:"decision-table-inputs",title:"What are the inputs required for this decision table?",description:"Analyzes DMN files and extracts input requirements for decision tables"}].map(e=>(0,g.jsxs)("div",{className:"faq-question-section",children:[(0,g.jsx)("h3",{children:e.title}),(0,g.jsx)("p",{className:"question-description",children:e.description}),"decision-table-inputs"===e.id?(0,g.jsxs)("div",{className:"dmn-demo",children:[(0,g.jsx)("p",{children:(0,g.jsx)("em",{children:"This is an asset-level question that analyzes individual DMN files. In a real DAK repository, this would scan DMN files in directories like input/cql/ or input/dmn/."})}),(0,g.jsx)(f,{questionId:e.id,parameters:(0,a.A)((0,a.A)({},b),{},{assetFile:"input/cql/IMMZ.D2.DT.BCG.dmn"}),githubService:y.A,showRawData:!0})]}):(0,g.jsx)(f,{questionId:e.id,parameters:b,githubService:y.A,showRawData:!0})]},e.id))]}),(0,g.jsxs)("div",{className:"faq-catalog",children:[(0,g.jsx)("h2",{children:"FAQ Question Catalog"}),(0,g.jsx)("p",{children:"All available questions in the system:"}),(0,g.jsx)("div",{className:"catalog-grid",children:l.map(e=>(0,g.jsxs)("div",{className:"catalog-item",children:[(0,g.jsx)("h4",{children:e.title}),(0,g.jsx)("p",{children:e.description}),(0,g.jsxs)("div",{className:"catalog-meta",children:[(0,g.jsx)("span",{className:"level",children:e.level}),(0,g.jsxs)("span",{className:"version",children:["v",e.version]})]}),(0,g.jsx)("div",{className:"tags",children:e.tags.map(e=>(0,g.jsx)("span",{className:"tag",children:e},e))})]},e.id))})]}),(0,g.jsxs)("div",{className:"mcp-info",children:[(0,g.jsx)("h2",{children:"MCP Server Integration"}),(0,g.jsx)("p",{children:"The FAQ system can also be accessed via the local MCP server API for programmatic access. Start the MCP server and access:"}),(0,g.jsxs)("ul",{children:[(0,g.jsxs)("li",{children:[(0,g.jsx)("code",{children:"GET http://127.0.0.1:3001/faq/questions/catalog"})," - Get question catalog"]}),(0,g.jsxs)("li",{children:[(0,g.jsx)("code",{children:"POST http://127.0.0.1:3001/faq/questions/execute"})," - Execute questions"]})]})]})]}):(0,g.jsxs)("div",{className:"dak-faq-demo no-context",children:[(0,g.jsx)("h2",{children:"DAK FAQ Demo"}),(0,g.jsx)("p",{children:"No repository context available. Please navigate from a DAK repository page."}),(0,g.jsxs)("div",{className:"demo-info",children:[(0,g.jsx)("h3",{children:"Available Questions"}),(0,g.jsx)("ul",{children:l.map(e=>(0,g.jsxs)("li",{children:[(0,g.jsx)("strong",{children:e.title})," - ",e.description]},e.id))})]})]})}}}]);
//# sourceMappingURL=733.c0070025.chunk.js.map