{"ast":null,"code":"import _taggedTemplateLiteral from \"/home/runner/work/sgex/sgex/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";\nimport _objectSpread from \"/home/runner/work/sgex/sgex/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nvar _templateObject;\nimport { render, html } from '../../ui';\nimport { domify, remove as domRemove, closest as domClosest, attr as domAttr } from 'min-dom';\nimport { forEach, isFunction, omit, isDefined } from 'min-dash';\nimport PopupMenuComponent from './PopupMenuComponent';\n\n/**\n * @typedef {import('../../core/Canvas').default} Canvas\n * @typedef {import('../../core/EventBus').default} EventBus\n * @typedef {import('../search/search').default} search\n *\n * @typedef {import('../../util/Types').Point} Point\n *\n * @typedef {import('./PopupMenuProvider').PopupMenuEntries} PopupMenuEntries\n * @typedef {import('./PopupMenuProvider').PopupMenuEntry} PopupMenuEntry\n * @typedef {import('./PopupMenuProvider').PopupMenuHeaderEntries} PopupMenuHeaderEntries\n * @typedef {import('./PopupMenuProvider').PopupMenuHeaderEntry} PopupMenuHeaderEntry\n * @typedef {import('./PopupMenuProvider').default} PopupMenuProvider\n *\n * @typedef {import('../../model/Types').Element} Element\n *\n * @typedef { {\n *   scale?: {\n *     min?: number;\n *     max?: number;\n *   } | boolean;\n * } } PopupMenuConfig\n *\n * @typedef {Element|Element[]} PopupMenuTarget;\n */\n\nvar DATA_REF = 'data-id';\nvar CLOSE_EVENTS = ['contextPad.close', 'canvas.viewbox.changing', 'commandStack.changed'];\nvar DEFAULT_PRIORITY = 1000;\n\n/**\n * A popup menu to show a number of actions on the canvas.\n *\n * @param {PopupMenuConfig} config\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {search} search\n */\nexport default function PopupMenu(config, eventBus, canvas, search) {\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._search = search;\n  this._current = null;\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1\n  };\n  this._config = {\n    scale: scale\n  };\n  eventBus.on('diagram.destroy', () => {\n    this.close();\n  });\n  eventBus.on('element.changed', event => {\n    const element = this.isOpen() && this._current.target;\n    if (event.element === element) {\n      this.refresh();\n    }\n  });\n}\nPopupMenu.$inject = ['config.popupMenu', 'eventBus', 'canvas', 'search'];\nPopupMenu.prototype._render = function () {\n  const {\n    position: _position,\n    providerId: className,\n    entries,\n    headerEntries,\n    emptyPlaceholder,\n    options\n  } = this._current;\n  const entriesArray = Object.entries(entries).map(_ref => {\n    let [key, value] = _ref;\n    return _objectSpread({\n      id: key\n    }, value);\n  });\n  const headerEntriesArray = Object.entries(headerEntries).map(_ref2 => {\n    let [key, value] = _ref2;\n    return _objectSpread({\n      id: key\n    }, value);\n  });\n  const position = _position && (container => this._ensureVisible(container, _position));\n  const scale = this._updateScale(this._current.container);\n  const onClose = result => this.close(result);\n  const onSelect = (event, entry, action) => this.trigger(event, entry, action);\n  render(html(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n      <\", \"\\n        onClose=\", \"\\n        onSelect=\", \"\\n        position=\", \"\\n        className=\", \"\\n        entries=\", \"\\n        headerEntries=\", \"\\n        emptyPlaceholder=\", \"\\n        scale=\", \"\\n        onOpened=\", \"\\n        onClosed=\", \"\\n        searchFn=\", \"\\n        ...\", \"\\n      />\\n    \"])), PopupMenuComponent, onClose, onSelect, position, className, entriesArray, headerEntriesArray, emptyPlaceholder, scale, this._onOpened.bind(this), this._onClosed.bind(this), this._search, _objectSpread({}, options)), this._current.container);\n};\n\n/**\n * Open the popup menu at the given position.\n *\n * @param {PopupMenuTarget} target\n * @param {string} providerId\n * @param {Point} position\n * @param {Object} [options]\n */\nPopupMenu.prototype.open = function (target, providerId, position, options) {\n  if (!target) {\n    throw new Error('target is missing');\n  }\n  if (!providerId) {\n    throw new Error('providers for <' + providerId + '> not found');\n  }\n  if (!position) {\n    throw new Error('position is missing');\n  }\n  if (this.isOpen()) {\n    this.close();\n  }\n  const {\n    entries,\n    headerEntries,\n    emptyPlaceholder\n  } = this._getContext(target, providerId);\n  this._current = {\n    position,\n    providerId,\n    target,\n    entries,\n    headerEntries,\n    emptyPlaceholder,\n    container: this._createContainer({\n      provider: providerId\n    }),\n    options\n  };\n  this._emit('open');\n  this._bindAutoClose();\n  this._render();\n};\n\n/**\n * Refresh the popup menu entries without changing the target or position.\n */\nPopupMenu.prototype.refresh = function () {\n  if (!this.isOpen()) {\n    return;\n  }\n  const {\n    target,\n    providerId\n  } = this._current;\n  const {\n    entries,\n    headerEntries,\n    emptyPlaceholder\n  } = this._getContext(target, providerId);\n  this._current = _objectSpread(_objectSpread({}, this._current), {}, {\n    entries,\n    headerEntries,\n    emptyPlaceholder\n  });\n  this._emit('refresh');\n  this._render();\n};\nPopupMenu.prototype._getContext = function (target, provider) {\n  const providers = this._getProviders(provider);\n  if (!providers || !providers.length) {\n    throw new Error('provider for <' + provider + '> not found');\n  }\n  const entries = this._getEntries(target, providers);\n  const headerEntries = this._getHeaderEntries(target, providers);\n  const emptyPlaceholder = this._getEmptyPlaceholder(providers);\n  return {\n    entries,\n    headerEntries,\n    emptyPlaceholder,\n    empty: !(Object.keys(entries).length || Object.keys(headerEntries).length)\n  };\n};\nPopupMenu.prototype.close = function () {\n  if (!this.isOpen()) {\n    return;\n  }\n  this._emit('close');\n  this.reset();\n  this._canvas.restoreFocus();\n  this._current = null;\n};\nPopupMenu.prototype.reset = function () {\n  const container = this._current.container;\n  render(null, container);\n  domRemove(container);\n};\nPopupMenu.prototype._emit = function (event, payload) {\n  this._eventBus.fire(\"popupMenu.\".concat(event), payload);\n};\nPopupMenu.prototype._onOpened = function () {\n  this._emit('opened');\n};\nPopupMenu.prototype._onClosed = function () {\n  this._emit('closed');\n};\nPopupMenu.prototype._createContainer = function (config) {\n  var canvas = this._canvas,\n    parent = canvas.getContainer();\n  const container = domify(\"<div class=\\\"djs-popup-parent djs-scrollable\\\" data-popup=\".concat(config.provider, \"></div>\"));\n  parent.appendChild(container);\n  return container;\n};\n\n/**\n * Set up listener to close popup automatically on certain events.\n */\nPopupMenu.prototype._bindAutoClose = function () {\n  this._eventBus.once(CLOSE_EVENTS, this.close, this);\n};\n\n/**\n * Remove the auto-closing listener.\n*/\nPopupMenu.prototype._unbindAutoClose = function () {\n  this._eventBus.off(CLOSE_EVENTS, this.close, this);\n};\n\n/**\n * Updates popup style.transform with respect to the config and zoom level.\n *\n * @return {number}\n */\nPopupMenu.prototype._updateScale = function () {\n  var zoom = this._canvas.zoom();\n  var scaleConfig = this._config.scale,\n    minScale,\n    maxScale,\n    scale = zoom;\n  if (scaleConfig !== true) {\n    if (scaleConfig === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = scaleConfig.min;\n      maxScale = scaleConfig.max;\n    }\n    if (isDefined(minScale) && zoom < minScale) {\n      scale = minScale;\n    }\n    if (isDefined(maxScale) && zoom > maxScale) {\n      scale = maxScale;\n    }\n  }\n  return scale;\n};\nPopupMenu.prototype._ensureVisible = function (container, position) {\n  var documentBounds = document.documentElement.getBoundingClientRect();\n  var containerBounds = container.getBoundingClientRect();\n  var overAxis = {},\n    left = position.x,\n    top = position.y;\n  if (position.x + containerBounds.width > documentBounds.width) {\n    overAxis.x = true;\n  }\n  if (position.y + containerBounds.height > documentBounds.height) {\n    overAxis.y = true;\n  }\n  if (overAxis.x && overAxis.y) {\n    left = position.x - containerBounds.width;\n    top = position.y - containerBounds.height;\n  } else if (overAxis.x) {\n    left = position.x - containerBounds.width;\n    top = position.y;\n  } else if (overAxis.y && position.y < containerBounds.height) {\n    left = position.x;\n    top = 10;\n  } else if (overAxis.y) {\n    left = position.x;\n    top = position.y - containerBounds.height;\n  }\n\n  // underAxis\n  if (position.y < documentBounds.top) {\n    top = position.y + containerBounds.height;\n  }\n  return {\n    x: left,\n    y: top\n  };\n};\n\n/**\n * Check whether there are no popup menu providers or provided entries for the\n * given target.\n *\n * @param {PopupMenuTarget} target\n * @param {string} providerId\n *\n * @return {boolean}\n */\nPopupMenu.prototype.isEmpty = function (target, providerId) {\n  if (!target) {\n    throw new Error('target is missing');\n  }\n  if (!providerId) {\n    throw new Error('provider ID is missing');\n  }\n  const providers = this._getProviders(providerId);\n  if (!providers || !providers.length) {\n    return true;\n  }\n  return this._getContext(target, providerId).empty;\n};\n\n/**\n * @overlord\n *\n * Register a popup menu provider with default priority. See\n * {@link PopupMenuProvider} for examples.\n *\n * @param {string} id\n * @param {PopupMenuProvider} provider\n */\n\n/**\n * Register a popup menu provider with the given priority. See\n * {@link PopupMenuProvider} for examples.\n *\n * @param {string} id\n * @param {number} priority\n * @param {PopupMenuProvider} provider\n */\nPopupMenu.prototype.registerProvider = function (id, priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n  this._eventBus.on('popupMenu.getProviders.' + id, priority, function (event) {\n    event.providers.push(provider);\n  });\n};\n\n/**\n * @param {string} id\n *\n * @return {PopupMenuProvider[]}\n */\nPopupMenu.prototype._getProviders = function (id) {\n  var event = this._eventBus.createEvent({\n    type: 'popupMenu.getProviders.' + id,\n    providers: []\n  });\n  this._eventBus.fire(event);\n  return event.providers;\n};\n\n/**\n * @param {PopupMenuTarget} target\n * @param {PopupMenuProvider[]} providers\n *\n * @return {PopupMenuEntries}\n */\nPopupMenu.prototype._getEntries = function (target, providers) {\n  var entries = {};\n  forEach(providers, function (provider) {\n    // handle legacy method\n    if (!provider.getPopupMenuEntries) {\n      forEach(provider.getEntries(target), function (entry) {\n        var id = entry.id;\n        if (!id) {\n          throw new Error('entry ID is missing');\n        }\n        entries[id] = omit(entry, ['id']);\n      });\n      return;\n    }\n    var entriesOrUpdater = provider.getPopupMenuEntries(target);\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function (entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n  return entries;\n};\n\n/**\n * @param {PopupMenuTarget} target\n * @param {PopupMenuProvider[]} providers\n *\n * @return {PopupMenuHeaderEntries}\n */\nPopupMenu.prototype._getHeaderEntries = function (target, providers) {\n  var entries = {};\n  forEach(providers, function (provider) {\n    // handle legacy method\n    if (!provider.getPopupMenuHeaderEntries) {\n      if (!provider.getHeaderEntries) {\n        return;\n      }\n      forEach(provider.getHeaderEntries(target), function (entry) {\n        var id = entry.id;\n        if (!id) {\n          throw new Error('entry ID is missing');\n        }\n        entries[id] = omit(entry, ['id']);\n      });\n      return;\n    }\n    var entriesOrUpdater = provider.getPopupMenuHeaderEntries(target);\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function (entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n  return entries;\n};\nPopupMenu.prototype._getEmptyPlaceholder = function (providers) {\n  const provider = providers.find(provider => isFunction(provider.getEmptyPlaceholder));\n  return provider && provider.getEmptyPlaceholder();\n};\n\n/**\n * Check if the popup menu is open.\n *\n * @return {boolean}\n */\nPopupMenu.prototype.isOpen = function () {\n  return !!this._current;\n};\n\n/**\n * Trigger an action associated with an entry.\n *\n * @param {Event} event\n * @param {PopupMenuEntry} entry\n * @param {string} [action='click']\n *\n * @return {any}\n */\nPopupMenu.prototype.trigger = function (event, entry) {\n  let action = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'click';\n  // silence other actions\n  event.preventDefault();\n  if (!entry) {\n    let element = domClosest(event.delegateTarget || event.target, '.entry', true);\n    let entryId = domAttr(element, DATA_REF);\n    entry = _objectSpread({\n      id: entryId\n    }, this._getEntry(entryId));\n  }\n  const handler = entry.action;\n  if (this._emit('trigger', {\n    entry,\n    event\n  }) === false) {\n    return;\n  }\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      return handler(event, entry);\n    }\n  } else {\n    if (handler[action]) {\n      return handler[action](event, entry);\n    }\n  }\n};\n\n/**\n * Get the entry (entry or header entry) with the given ID.\n *\n * @param {string} entryId\n *\n * @return {PopupMenuEntry|PopupMenuHeaderEntry}\n */\nPopupMenu.prototype._getEntry = function (entryId) {\n  var entry = this._current.entries[entryId] || this._current.headerEntries[entryId];\n  if (!entry) {\n    throw new Error('entry not found');\n  }\n  return entry;\n};","map":{"version":3,"names":["render","html","domify","remove","domRemove","closest","domClosest","attr","domAttr","forEach","isFunction","omit","isDefined","PopupMenuComponent","DATA_REF","CLOSE_EVENTS","DEFAULT_PRIORITY","PopupMenu","config","eventBus","canvas","search","_eventBus","_canvas","_search","_current","scale","min","max","_config","on","close","event","element","isOpen","target","refresh","$inject","prototype","_render","position","_position","providerId","className","entries","headerEntries","emptyPlaceholder","options","entriesArray","Object","map","_ref","key","value","_objectSpread","id","headerEntriesArray","_ref2","container","_ensureVisible","_updateScale","onClose","result","onSelect","entry","action","trigger","_templateObject","_taggedTemplateLiteral","_onOpened","bind","_onClosed","open","Error","_getContext","_createContainer","provider","_emit","_bindAutoClose","providers","_getProviders","length","_getEntries","_getHeaderEntries","_getEmptyPlaceholder","empty","keys","reset","restoreFocus","payload","fire","concat","parent","getContainer","appendChild","once","_unbindAutoClose","off","zoom","scaleConfig","minScale","maxScale","documentBounds","document","documentElement","getBoundingClientRect","containerBounds","overAxis","left","x","top","y","width","height","isEmpty","registerProvider","priority","push","createEvent","type","getPopupMenuEntries","getEntries","entriesOrUpdater","getPopupMenuHeaderEntries","getHeaderEntries","find","getEmptyPlaceholder","arguments","undefined","preventDefault","delegateTarget","entryId","_getEntry","handler"],"sources":["/home/runner/work/sgex/sgex/node_modules/diagram-js/lib/features/popup-menu/PopupMenu.js"],"sourcesContent":["import {\n  render,\n  html\n} from '../../ui';\n\nimport {\n  domify,\n  remove as domRemove,\n  closest as domClosest,\n  attr as domAttr\n} from 'min-dom';\n\nimport {\n  forEach,\n  isFunction,\n  omit,\n  isDefined\n} from 'min-dash';\n\nimport PopupMenuComponent from './PopupMenuComponent';\n\n/**\n * @typedef {import('../../core/Canvas').default} Canvas\n * @typedef {import('../../core/EventBus').default} EventBus\n * @typedef {import('../search/search').default} search\n *\n * @typedef {import('../../util/Types').Point} Point\n *\n * @typedef {import('./PopupMenuProvider').PopupMenuEntries} PopupMenuEntries\n * @typedef {import('./PopupMenuProvider').PopupMenuEntry} PopupMenuEntry\n * @typedef {import('./PopupMenuProvider').PopupMenuHeaderEntries} PopupMenuHeaderEntries\n * @typedef {import('./PopupMenuProvider').PopupMenuHeaderEntry} PopupMenuHeaderEntry\n * @typedef {import('./PopupMenuProvider').default} PopupMenuProvider\n *\n * @typedef {import('../../model/Types').Element} Element\n *\n * @typedef { {\n *   scale?: {\n *     min?: number;\n *     max?: number;\n *   } | boolean;\n * } } PopupMenuConfig\n *\n * @typedef {Element|Element[]} PopupMenuTarget;\n */\n\nvar DATA_REF = 'data-id';\n\nvar CLOSE_EVENTS = [\n  'contextPad.close',\n  'canvas.viewbox.changing',\n  'commandStack.changed'\n];\n\nvar DEFAULT_PRIORITY = 1000;\n\n/**\n * A popup menu to show a number of actions on the canvas.\n *\n * @param {PopupMenuConfig} config\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {search} search\n */\nexport default function PopupMenu(config, eventBus, canvas, search) {\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._search = search;\n\n  this._current = null;\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1\n  };\n\n  this._config = {\n    scale: scale\n  };\n\n\n  eventBus.on('diagram.destroy', () => {\n    this.close();\n  });\n\n  eventBus.on('element.changed', event => {\n\n    const element = this.isOpen() && this._current.target;\n\n    if (event.element === element) {\n      this.refresh();\n    }\n  });\n\n}\n\nPopupMenu.$inject = [\n  'config.popupMenu',\n  'eventBus',\n  'canvas',\n  'search'\n];\n\nPopupMenu.prototype._render = function() {\n\n  const {\n    position: _position,\n    providerId: className,\n    entries,\n    headerEntries,\n    emptyPlaceholder,\n    options\n  } = this._current;\n\n  const entriesArray = Object.entries(entries).map(\n    ([ key, value ]) => ({ id: key, ...value })\n  );\n\n  const headerEntriesArray = Object.entries(headerEntries).map(\n    ([ key, value ]) => ({ id: key, ...value })\n  );\n\n  const position = _position && (\n    (container) => this._ensureVisible(container, _position)\n  );\n\n  const scale = this._updateScale(this._current.container);\n\n  const onClose = result => this.close(result);\n  const onSelect = (event, entry, action) => this.trigger(event, entry, action);\n\n  render(\n    html`\n      <${PopupMenuComponent}\n        onClose=${ onClose }\n        onSelect=${ onSelect }\n        position=${ position }\n        className=${ className }\n        entries=${ entriesArray }\n        headerEntries=${ headerEntriesArray }\n        emptyPlaceholder=${ emptyPlaceholder }\n        scale=${ scale }\n        onOpened=${ this._onOpened.bind(this) }\n        onClosed=${ this._onClosed.bind(this) }\n        searchFn=${ this._search }\n        ...${{ ...options }}\n      />\n    `,\n    this._current.container\n  );\n};\n\n\n/**\n * Open the popup menu at the given position.\n *\n * @param {PopupMenuTarget} target\n * @param {string} providerId\n * @param {Point} position\n * @param {Object} [options]\n */\nPopupMenu.prototype.open = function(target, providerId, position, options) {\n  if (!target) {\n    throw new Error('target is missing');\n  }\n\n  if (!providerId) {\n    throw new Error('providers for <' + providerId + '> not found');\n  }\n\n  if (!position) {\n    throw new Error('position is missing');\n  }\n\n  if (this.isOpen()) {\n    this.close();\n  }\n\n  const {\n    entries,\n    headerEntries,\n    emptyPlaceholder\n  } = this._getContext(target, providerId);\n\n  this._current = {\n    position,\n    providerId,\n    target,\n    entries,\n    headerEntries,\n    emptyPlaceholder,\n    container: this._createContainer({ provider: providerId }),\n    options\n  };\n\n  this._emit('open');\n\n  this._bindAutoClose();\n\n  this._render();\n};\n\n/**\n * Refresh the popup menu entries without changing the target or position.\n */\nPopupMenu.prototype.refresh = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  const {\n    target,\n    providerId\n  } = this._current;\n\n  const {\n    entries,\n    headerEntries,\n    emptyPlaceholder\n  } = this._getContext(target, providerId);\n\n  this._current = {\n    ...this._current,\n    entries,\n    headerEntries,\n    emptyPlaceholder\n  };\n\n  this._emit('refresh');\n\n  this._render();\n};\n\n\nPopupMenu.prototype._getContext = function(target, provider) {\n\n  const providers = this._getProviders(provider);\n\n  if (!providers || !providers.length) {\n    throw new Error('provider for <' + provider + '> not found');\n  }\n\n  const entries = this._getEntries(target, providers);\n\n  const headerEntries = this._getHeaderEntries(target, providers);\n\n  const emptyPlaceholder = this._getEmptyPlaceholder(providers);\n\n  return {\n    entries,\n    headerEntries,\n    emptyPlaceholder,\n    empty: !(\n      Object.keys(entries).length ||\n          Object.keys(headerEntries).length\n    )\n  };\n};\n\nPopupMenu.prototype.close = function() {\n\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._emit('close');\n\n  this.reset();\n\n  this._canvas.restoreFocus();\n\n  this._current = null;\n};\n\nPopupMenu.prototype.reset = function() {\n  const container = this._current.container;\n\n  render(null, container);\n\n  domRemove(container);\n};\n\nPopupMenu.prototype._emit = function(event, payload) {\n  this._eventBus.fire(`popupMenu.${ event }`, payload);\n};\n\nPopupMenu.prototype._onOpened = function() {\n  this._emit('opened');\n};\n\nPopupMenu.prototype._onClosed = function() {\n  this._emit('closed');\n};\n\nPopupMenu.prototype._createContainer = function(config) {\n\n  var canvas = this._canvas,\n      parent = canvas.getContainer();\n\n  const container = domify(`<div class=\"djs-popup-parent djs-scrollable\" data-popup=${config.provider}></div>`);\n\n  parent.appendChild(container);\n\n  return container;\n};\n\n/**\n * Set up listener to close popup automatically on certain events.\n */\nPopupMenu.prototype._bindAutoClose = function() {\n  this._eventBus.once(CLOSE_EVENTS, this.close, this);\n};\n\n\n/**\n * Remove the auto-closing listener.\n*/\nPopupMenu.prototype._unbindAutoClose = function() {\n  this._eventBus.off(CLOSE_EVENTS, this.close, this);\n};\n\n\n/**\n * Updates popup style.transform with respect to the config and zoom level.\n *\n * @return {number}\n */\nPopupMenu.prototype._updateScale = function() {\n  var zoom = this._canvas.zoom();\n\n  var scaleConfig = this._config.scale,\n      minScale,\n      maxScale,\n      scale = zoom;\n\n  if (scaleConfig !== true) {\n\n    if (scaleConfig === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = scaleConfig.min;\n      maxScale = scaleConfig.max;\n    }\n\n    if (isDefined(minScale) && zoom < minScale) {\n      scale = minScale;\n    }\n\n    if (isDefined(maxScale) && zoom > maxScale) {\n      scale = maxScale;\n    }\n\n  }\n\n  return scale;\n};\n\nPopupMenu.prototype._ensureVisible = function(container, position) {\n  var documentBounds = document.documentElement.getBoundingClientRect();\n  var containerBounds = container.getBoundingClientRect();\n\n  var overAxis = {},\n      left = position.x,\n      top = position.y;\n\n  if (position.x + containerBounds.width > documentBounds.width) {\n    overAxis.x = true;\n  }\n\n  if (position.y + containerBounds.height > documentBounds.height) {\n    overAxis.y = true;\n  }\n\n  if (overAxis.x && overAxis.y) {\n    left = position.x - containerBounds.width;\n    top = position.y - containerBounds.height;\n  } else if (overAxis.x) {\n    left = position.x - containerBounds.width;\n    top = position.y;\n  } else if (overAxis.y && position.y < containerBounds.height) {\n    left = position.x;\n    top = 10;\n  } else if (overAxis.y) {\n    left = position.x;\n    top = position.y - containerBounds.height;\n  }\n\n  // underAxis\n  if (position.y < documentBounds.top) {\n    top = position.y + containerBounds.height;\n  }\n\n  return {\n    x: left,\n    y: top\n  };\n};\n\n/**\n * Check whether there are no popup menu providers or provided entries for the\n * given target.\n *\n * @param {PopupMenuTarget} target\n * @param {string} providerId\n *\n * @return {boolean}\n */\nPopupMenu.prototype.isEmpty = function(target, providerId) {\n  if (!target) {\n    throw new Error('target is missing');\n  }\n\n  if (!providerId) {\n    throw new Error('provider ID is missing');\n  }\n\n  const providers = this._getProviders(providerId);\n\n  if (!providers || !providers.length) {\n    return true;\n  }\n\n  return this._getContext(target, providerId).empty;\n};\n\n/**\n * @overlord\n *\n * Register a popup menu provider with default priority. See\n * {@link PopupMenuProvider} for examples.\n *\n * @param {string} id\n * @param {PopupMenuProvider} provider\n */\n\n/**\n * Register a popup menu provider with the given priority. See\n * {@link PopupMenuProvider} for examples.\n *\n * @param {string} id\n * @param {number} priority\n * @param {PopupMenuProvider} provider\n */\nPopupMenu.prototype.registerProvider = function(id, priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('popupMenu.getProviders.' + id, priority, function(event) {\n    event.providers.push(provider);\n  });\n};\n\n/**\n * @param {string} id\n *\n * @return {PopupMenuProvider[]}\n */\nPopupMenu.prototype._getProviders = function(id) {\n  var event = this._eventBus.createEvent({\n    type: 'popupMenu.getProviders.' + id,\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\n/**\n * @param {PopupMenuTarget} target\n * @param {PopupMenuProvider[]} providers\n *\n * @return {PopupMenuEntries}\n */\nPopupMenu.prototype._getEntries = function(target, providers) {\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuEntries) {\n      forEach(provider.getEntries(target), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('entry ID is missing');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuEntries(target);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\n/**\n * @param {PopupMenuTarget} target\n * @param {PopupMenuProvider[]} providers\n *\n * @return {PopupMenuHeaderEntries}\n */\nPopupMenu.prototype._getHeaderEntries = function(target, providers) {\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuHeaderEntries) {\n      if (!provider.getHeaderEntries) {\n        return;\n      }\n\n      forEach(provider.getHeaderEntries(target), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('entry ID is missing');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuHeaderEntries(target);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\n\nPopupMenu.prototype._getEmptyPlaceholder = function(providers) {\n  const provider = providers.find(\n    provider => isFunction(provider.getEmptyPlaceholder)\n  );\n\n  return provider && provider.getEmptyPlaceholder();\n};\n\n\n/**\n * Check if the popup menu is open.\n *\n * @return {boolean}\n */\nPopupMenu.prototype.isOpen = function() {\n  return !!this._current;\n};\n\n\n/**\n * Trigger an action associated with an entry.\n *\n * @param {Event} event\n * @param {PopupMenuEntry} entry\n * @param {string} [action='click']\n *\n * @return {any}\n */\nPopupMenu.prototype.trigger = function(event, entry, action = 'click') {\n\n  // silence other actions\n  event.preventDefault();\n\n  if (!entry) {\n    let element = domClosest(event.delegateTarget || event.target, '.entry', true);\n    let entryId = domAttr(element, DATA_REF);\n\n    entry = { id: entryId, ...this._getEntry(entryId) };\n  }\n\n  const handler = entry.action;\n\n  if (this._emit('trigger', { entry, event }) === false) {\n    return;\n  }\n\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      return handler(event, entry);\n    }\n  } else {\n    if (handler[action]) {\n      return handler[action](event, entry);\n    }\n  }\n};\n\n/**\n * Get the entry (entry or header entry) with the given ID.\n *\n * @param {string} entryId\n *\n * @return {PopupMenuEntry|PopupMenuHeaderEntry}\n */\nPopupMenu.prototype._getEntry = function(entryId) {\n\n  var entry = this._current.entries[ entryId ] || this._current.headerEntries[ entryId ];\n\n\n  if (!entry) {\n    throw new Error('entry not found');\n  }\n\n  return entry;\n};"],"mappings":";;;AAAA,SACEA,MAAM,EACNC,IAAI,QACC,UAAU;AAEjB,SACEC,MAAM,EACNC,MAAM,IAAIC,SAAS,EACnBC,OAAO,IAAIC,UAAU,EACrBC,IAAI,IAAIC,OAAO,QACV,SAAS;AAEhB,SACEC,OAAO,EACPC,UAAU,EACVC,IAAI,EACJC,SAAS,QACJ,UAAU;AAEjB,OAAOC,kBAAkB,MAAM,sBAAsB;;AAErD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIC,QAAQ,GAAG,SAAS;AAExB,IAAIC,YAAY,GAAG,CACjB,kBAAkB,EAClB,yBAAyB,EACzB,sBAAsB,CACvB;AAED,IAAIC,gBAAgB,GAAG,IAAI;;AAE3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,SAASA,CAACC,MAAM,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,MAAM,EAAE;EAClE,IAAI,CAACC,SAAS,GAAGH,QAAQ;EACzB,IAAI,CAACI,OAAO,GAAGH,MAAM;EACrB,IAAI,CAACI,OAAO,GAAGH,MAAM;EAErB,IAAI,CAACI,QAAQ,GAAG,IAAI;EAEpB,IAAIC,KAAK,GAAGd,SAAS,CAACM,MAAM,IAAIA,MAAM,CAACQ,KAAK,CAAC,GAAGR,MAAM,CAACQ,KAAK,GAAG;IAC7DC,GAAG,EAAE,CAAC;IACNC,GAAG,EAAE;EACP,CAAC;EAED,IAAI,CAACC,OAAO,GAAG;IACbH,KAAK,EAAEA;EACT,CAAC;EAGDP,QAAQ,CAACW,EAAE,CAAC,iBAAiB,EAAE,MAAM;IACnC,IAAI,CAACC,KAAK,CAAC,CAAC;EACd,CAAC,CAAC;EAEFZ,QAAQ,CAACW,EAAE,CAAC,iBAAiB,EAAEE,KAAK,IAAI;IAEtC,MAAMC,OAAO,GAAG,IAAI,CAACC,MAAM,CAAC,CAAC,IAAI,IAAI,CAACT,QAAQ,CAACU,MAAM;IAErD,IAAIH,KAAK,CAACC,OAAO,KAAKA,OAAO,EAAE;MAC7B,IAAI,CAACG,OAAO,CAAC,CAAC;IAChB;EACF,CAAC,CAAC;AAEJ;AAEAnB,SAAS,CAACoB,OAAO,GAAG,CAClB,kBAAkB,EAClB,UAAU,EACV,QAAQ,EACR,QAAQ,CACT;AAEDpB,SAAS,CAACqB,SAAS,CAACC,OAAO,GAAG,YAAW;EAEvC,MAAM;IACJC,QAAQ,EAAEC,SAAS;IACnBC,UAAU,EAAEC,SAAS;IACrBC,OAAO;IACPC,aAAa;IACbC,gBAAgB;IAChBC;EACF,CAAC,GAAG,IAAI,CAACtB,QAAQ;EAEjB,MAAMuB,YAAY,GAAGC,MAAM,CAACL,OAAO,CAACA,OAAO,CAAC,CAACM,GAAG,CAC9CC,IAAA;IAAA,IAAC,CAAEC,GAAG,EAAEC,KAAK,CAAE,GAAAF,IAAA;IAAA,OAAAG,aAAA;MAAQC,EAAE,EAAEH;IAAG,GAAKC,KAAK;EAAA,CAC1C,CAAC;EAED,MAAMG,kBAAkB,GAAGP,MAAM,CAACL,OAAO,CAACC,aAAa,CAAC,CAACK,GAAG,CAC1DO,KAAA;IAAA,IAAC,CAAEL,GAAG,EAAEC,KAAK,CAAE,GAAAI,KAAA;IAAA,OAAAH,aAAA;MAAQC,EAAE,EAAEH;IAAG,GAAKC,KAAK;EAAA,CAC1C,CAAC;EAED,MAAMb,QAAQ,GAAGC,SAAS,KACvBiB,SAAS,IAAK,IAAI,CAACC,cAAc,CAACD,SAAS,EAAEjB,SAAS,CAAC,CACzD;EAED,MAAMf,KAAK,GAAG,IAAI,CAACkC,YAAY,CAAC,IAAI,CAACnC,QAAQ,CAACiC,SAAS,CAAC;EAExD,MAAMG,OAAO,GAAGC,MAAM,IAAI,IAAI,CAAC/B,KAAK,CAAC+B,MAAM,CAAC;EAC5C,MAAMC,QAAQ,GAAGA,CAAC/B,KAAK,EAAEgC,KAAK,EAAEC,MAAM,KAAK,IAAI,CAACC,OAAO,CAAClC,KAAK,EAAEgC,KAAK,EAAEC,MAAM,CAAC;EAE7EjE,MAAM,CACJC,IAAI,CAAAkE,eAAA,KAAAA,eAAA,GAAAC,sBAAA,6TACCvD,kBAAkB,EACRgD,OAAO,EACNE,QAAQ,EACRvB,QAAQ,EACPG,SAAS,EACXK,YAAY,EACNQ,kBAAkB,EACfV,gBAAgB,EAC3BpB,KAAK,EACF,IAAI,CAAC2C,SAAS,CAACC,IAAI,CAAC,IAAI,CAAC,EACzB,IAAI,CAACC,SAAS,CAACD,IAAI,CAAC,IAAI,CAAC,EACzB,IAAI,CAAC9C,OAAO,EAAA8B,aAAA,KACdP,OAAO,IAGrB,IAAI,CAACtB,QAAQ,CAACiC,SAChB,CAAC;AACH,CAAC;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAzC,SAAS,CAACqB,SAAS,CAACkC,IAAI,GAAG,UAASrC,MAAM,EAAEO,UAAU,EAAEF,QAAQ,EAAEO,OAAO,EAAE;EACzE,IAAI,CAACZ,MAAM,EAAE;IACX,MAAM,IAAIsC,KAAK,CAAC,mBAAmB,CAAC;EACtC;EAEA,IAAI,CAAC/B,UAAU,EAAE;IACf,MAAM,IAAI+B,KAAK,CAAC,iBAAiB,GAAG/B,UAAU,GAAG,aAAa,CAAC;EACjE;EAEA,IAAI,CAACF,QAAQ,EAAE;IACb,MAAM,IAAIiC,KAAK,CAAC,qBAAqB,CAAC;EACxC;EAEA,IAAI,IAAI,CAACvC,MAAM,CAAC,CAAC,EAAE;IACjB,IAAI,CAACH,KAAK,CAAC,CAAC;EACd;EAEA,MAAM;IACJa,OAAO;IACPC,aAAa;IACbC;EACF,CAAC,GAAG,IAAI,CAAC4B,WAAW,CAACvC,MAAM,EAAEO,UAAU,CAAC;EAExC,IAAI,CAACjB,QAAQ,GAAG;IACde,QAAQ;IACRE,UAAU;IACVP,MAAM;IACNS,OAAO;IACPC,aAAa;IACbC,gBAAgB;IAChBY,SAAS,EAAE,IAAI,CAACiB,gBAAgB,CAAC;MAAEC,QAAQ,EAAElC;IAAW,CAAC,CAAC;IAC1DK;EACF,CAAC;EAED,IAAI,CAAC8B,KAAK,CAAC,MAAM,CAAC;EAElB,IAAI,CAACC,cAAc,CAAC,CAAC;EAErB,IAAI,CAACvC,OAAO,CAAC,CAAC;AAChB,CAAC;;AAED;AACA;AACA;AACAtB,SAAS,CAACqB,SAAS,CAACF,OAAO,GAAG,YAAW;EACvC,IAAI,CAAC,IAAI,CAACF,MAAM,CAAC,CAAC,EAAE;IAClB;EACF;EAEA,MAAM;IACJC,MAAM;IACNO;EACF,CAAC,GAAG,IAAI,CAACjB,QAAQ;EAEjB,MAAM;IACJmB,OAAO;IACPC,aAAa;IACbC;EACF,CAAC,GAAG,IAAI,CAAC4B,WAAW,CAACvC,MAAM,EAAEO,UAAU,CAAC;EAExC,IAAI,CAACjB,QAAQ,GAAA6B,aAAA,CAAAA,aAAA,KACR,IAAI,CAAC7B,QAAQ;IAChBmB,OAAO;IACPC,aAAa;IACbC;EAAgB,EACjB;EAED,IAAI,CAAC+B,KAAK,CAAC,SAAS,CAAC;EAErB,IAAI,CAACtC,OAAO,CAAC,CAAC;AAChB,CAAC;AAGDtB,SAAS,CAACqB,SAAS,CAACoC,WAAW,GAAG,UAASvC,MAAM,EAAEyC,QAAQ,EAAE;EAE3D,MAAMG,SAAS,GAAG,IAAI,CAACC,aAAa,CAACJ,QAAQ,CAAC;EAE9C,IAAI,CAACG,SAAS,IAAI,CAACA,SAAS,CAACE,MAAM,EAAE;IACnC,MAAM,IAAIR,KAAK,CAAC,gBAAgB,GAAGG,QAAQ,GAAG,aAAa,CAAC;EAC9D;EAEA,MAAMhC,OAAO,GAAG,IAAI,CAACsC,WAAW,CAAC/C,MAAM,EAAE4C,SAAS,CAAC;EAEnD,MAAMlC,aAAa,GAAG,IAAI,CAACsC,iBAAiB,CAAChD,MAAM,EAAE4C,SAAS,CAAC;EAE/D,MAAMjC,gBAAgB,GAAG,IAAI,CAACsC,oBAAoB,CAACL,SAAS,CAAC;EAE7D,OAAO;IACLnC,OAAO;IACPC,aAAa;IACbC,gBAAgB;IAChBuC,KAAK,EAAE,EACLpC,MAAM,CAACqC,IAAI,CAAC1C,OAAO,CAAC,CAACqC,MAAM,IACvBhC,MAAM,CAACqC,IAAI,CAACzC,aAAa,CAAC,CAACoC,MAAM;EAEzC,CAAC;AACH,CAAC;AAEDhE,SAAS,CAACqB,SAAS,CAACP,KAAK,GAAG,YAAW;EAErC,IAAI,CAAC,IAAI,CAACG,MAAM,CAAC,CAAC,EAAE;IAClB;EACF;EAEA,IAAI,CAAC2C,KAAK,CAAC,OAAO,CAAC;EAEnB,IAAI,CAACU,KAAK,CAAC,CAAC;EAEZ,IAAI,CAAChE,OAAO,CAACiE,YAAY,CAAC,CAAC;EAE3B,IAAI,CAAC/D,QAAQ,GAAG,IAAI;AACtB,CAAC;AAEDR,SAAS,CAACqB,SAAS,CAACiD,KAAK,GAAG,YAAW;EACrC,MAAM7B,SAAS,GAAG,IAAI,CAACjC,QAAQ,CAACiC,SAAS;EAEzC1D,MAAM,CAAC,IAAI,EAAE0D,SAAS,CAAC;EAEvBtD,SAAS,CAACsD,SAAS,CAAC;AACtB,CAAC;AAEDzC,SAAS,CAACqB,SAAS,CAACuC,KAAK,GAAG,UAAS7C,KAAK,EAAEyD,OAAO,EAAE;EACnD,IAAI,CAACnE,SAAS,CAACoE,IAAI,cAAAC,MAAA,CAAe3D,KAAK,GAAKyD,OAAO,CAAC;AACtD,CAAC;AAEDxE,SAAS,CAACqB,SAAS,CAAC+B,SAAS,GAAG,YAAW;EACzC,IAAI,CAACQ,KAAK,CAAC,QAAQ,CAAC;AACtB,CAAC;AAED5D,SAAS,CAACqB,SAAS,CAACiC,SAAS,GAAG,YAAW;EACzC,IAAI,CAACM,KAAK,CAAC,QAAQ,CAAC;AACtB,CAAC;AAED5D,SAAS,CAACqB,SAAS,CAACqC,gBAAgB,GAAG,UAASzD,MAAM,EAAE;EAEtD,IAAIE,MAAM,GAAG,IAAI,CAACG,OAAO;IACrBqE,MAAM,GAAGxE,MAAM,CAACyE,YAAY,CAAC,CAAC;EAElC,MAAMnC,SAAS,GAAGxD,MAAM,8DAAAyF,MAAA,CAA4DzE,MAAM,CAAC0D,QAAQ,YAAS,CAAC;EAE7GgB,MAAM,CAACE,WAAW,CAACpC,SAAS,CAAC;EAE7B,OAAOA,SAAS;AAClB,CAAC;;AAED;AACA;AACA;AACAzC,SAAS,CAACqB,SAAS,CAACwC,cAAc,GAAG,YAAW;EAC9C,IAAI,CAACxD,SAAS,CAACyE,IAAI,CAAChF,YAAY,EAAE,IAAI,CAACgB,KAAK,EAAE,IAAI,CAAC;AACrD,CAAC;;AAGD;AACA;AACA;AACAd,SAAS,CAACqB,SAAS,CAAC0D,gBAAgB,GAAG,YAAW;EAChD,IAAI,CAAC1E,SAAS,CAAC2E,GAAG,CAAClF,YAAY,EAAE,IAAI,CAACgB,KAAK,EAAE,IAAI,CAAC;AACpD,CAAC;;AAGD;AACA;AACA;AACA;AACA;AACAd,SAAS,CAACqB,SAAS,CAACsB,YAAY,GAAG,YAAW;EAC5C,IAAIsC,IAAI,GAAG,IAAI,CAAC3E,OAAO,CAAC2E,IAAI,CAAC,CAAC;EAE9B,IAAIC,WAAW,GAAG,IAAI,CAACtE,OAAO,CAACH,KAAK;IAChC0E,QAAQ;IACRC,QAAQ;IACR3E,KAAK,GAAGwE,IAAI;EAEhB,IAAIC,WAAW,KAAK,IAAI,EAAE;IAExB,IAAIA,WAAW,KAAK,KAAK,EAAE;MACzBC,QAAQ,GAAG,CAAC;MACZC,QAAQ,GAAG,CAAC;IACd,CAAC,MAAM;MACLD,QAAQ,GAAGD,WAAW,CAACxE,GAAG;MAC1B0E,QAAQ,GAAGF,WAAW,CAACvE,GAAG;IAC5B;IAEA,IAAIhB,SAAS,CAACwF,QAAQ,CAAC,IAAIF,IAAI,GAAGE,QAAQ,EAAE;MAC1C1E,KAAK,GAAG0E,QAAQ;IAClB;IAEA,IAAIxF,SAAS,CAACyF,QAAQ,CAAC,IAAIH,IAAI,GAAGG,QAAQ,EAAE;MAC1C3E,KAAK,GAAG2E,QAAQ;IAClB;EAEF;EAEA,OAAO3E,KAAK;AACd,CAAC;AAEDT,SAAS,CAACqB,SAAS,CAACqB,cAAc,GAAG,UAASD,SAAS,EAAElB,QAAQ,EAAE;EACjE,IAAI8D,cAAc,GAAGC,QAAQ,CAACC,eAAe,CAACC,qBAAqB,CAAC,CAAC;EACrE,IAAIC,eAAe,GAAGhD,SAAS,CAAC+C,qBAAqB,CAAC,CAAC;EAEvD,IAAIE,QAAQ,GAAG,CAAC,CAAC;IACbC,IAAI,GAAGpE,QAAQ,CAACqE,CAAC;IACjBC,GAAG,GAAGtE,QAAQ,CAACuE,CAAC;EAEpB,IAAIvE,QAAQ,CAACqE,CAAC,GAAGH,eAAe,CAACM,KAAK,GAAGV,cAAc,CAACU,KAAK,EAAE;IAC7DL,QAAQ,CAACE,CAAC,GAAG,IAAI;EACnB;EAEA,IAAIrE,QAAQ,CAACuE,CAAC,GAAGL,eAAe,CAACO,MAAM,GAAGX,cAAc,CAACW,MAAM,EAAE;IAC/DN,QAAQ,CAACI,CAAC,GAAG,IAAI;EACnB;EAEA,IAAIJ,QAAQ,CAACE,CAAC,IAAIF,QAAQ,CAACI,CAAC,EAAE;IAC5BH,IAAI,GAAGpE,QAAQ,CAACqE,CAAC,GAAGH,eAAe,CAACM,KAAK;IACzCF,GAAG,GAAGtE,QAAQ,CAACuE,CAAC,GAAGL,eAAe,CAACO,MAAM;EAC3C,CAAC,MAAM,IAAIN,QAAQ,CAACE,CAAC,EAAE;IACrBD,IAAI,GAAGpE,QAAQ,CAACqE,CAAC,GAAGH,eAAe,CAACM,KAAK;IACzCF,GAAG,GAAGtE,QAAQ,CAACuE,CAAC;EAClB,CAAC,MAAM,IAAIJ,QAAQ,CAACI,CAAC,IAAIvE,QAAQ,CAACuE,CAAC,GAAGL,eAAe,CAACO,MAAM,EAAE;IAC5DL,IAAI,GAAGpE,QAAQ,CAACqE,CAAC;IACjBC,GAAG,GAAG,EAAE;EACV,CAAC,MAAM,IAAIH,QAAQ,CAACI,CAAC,EAAE;IACrBH,IAAI,GAAGpE,QAAQ,CAACqE,CAAC;IACjBC,GAAG,GAAGtE,QAAQ,CAACuE,CAAC,GAAGL,eAAe,CAACO,MAAM;EAC3C;;EAEA;EACA,IAAIzE,QAAQ,CAACuE,CAAC,GAAGT,cAAc,CAACQ,GAAG,EAAE;IACnCA,GAAG,GAAGtE,QAAQ,CAACuE,CAAC,GAAGL,eAAe,CAACO,MAAM;EAC3C;EAEA,OAAO;IACLJ,CAAC,EAAED,IAAI;IACPG,CAAC,EAAED;EACL,CAAC;AACH,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA7F,SAAS,CAACqB,SAAS,CAAC4E,OAAO,GAAG,UAAS/E,MAAM,EAAEO,UAAU,EAAE;EACzD,IAAI,CAACP,MAAM,EAAE;IACX,MAAM,IAAIsC,KAAK,CAAC,mBAAmB,CAAC;EACtC;EAEA,IAAI,CAAC/B,UAAU,EAAE;IACf,MAAM,IAAI+B,KAAK,CAAC,wBAAwB,CAAC;EAC3C;EAEA,MAAMM,SAAS,GAAG,IAAI,CAACC,aAAa,CAACtC,UAAU,CAAC;EAEhD,IAAI,CAACqC,SAAS,IAAI,CAACA,SAAS,CAACE,MAAM,EAAE;IACnC,OAAO,IAAI;EACb;EAEA,OAAO,IAAI,CAACP,WAAW,CAACvC,MAAM,EAAEO,UAAU,CAAC,CAAC2C,KAAK;AACnD,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACApE,SAAS,CAACqB,SAAS,CAAC6E,gBAAgB,GAAG,UAAS5D,EAAE,EAAE6D,QAAQ,EAAExC,QAAQ,EAAE;EACtE,IAAI,CAACA,QAAQ,EAAE;IACbA,QAAQ,GAAGwC,QAAQ;IACnBA,QAAQ,GAAGpG,gBAAgB;EAC7B;EAEA,IAAI,CAACM,SAAS,CAACQ,EAAE,CAAC,yBAAyB,GAAGyB,EAAE,EAAE6D,QAAQ,EAAE,UAASpF,KAAK,EAAE;IAC1EA,KAAK,CAAC+C,SAAS,CAACsC,IAAI,CAACzC,QAAQ,CAAC;EAChC,CAAC,CAAC;AACJ,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA3D,SAAS,CAACqB,SAAS,CAAC0C,aAAa,GAAG,UAASzB,EAAE,EAAE;EAC/C,IAAIvB,KAAK,GAAG,IAAI,CAACV,SAAS,CAACgG,WAAW,CAAC;IACrCC,IAAI,EAAE,yBAAyB,GAAGhE,EAAE;IACpCwB,SAAS,EAAE;EACb,CAAC,CAAC;EAEF,IAAI,CAACzD,SAAS,CAACoE,IAAI,CAAC1D,KAAK,CAAC;EAE1B,OAAOA,KAAK,CAAC+C,SAAS;AACxB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA9D,SAAS,CAACqB,SAAS,CAAC4C,WAAW,GAAG,UAAS/C,MAAM,EAAE4C,SAAS,EAAE;EAC5D,IAAInC,OAAO,GAAG,CAAC,CAAC;EAEhBnC,OAAO,CAACsE,SAAS,EAAE,UAASH,QAAQ,EAAE;IAEpC;IACA,IAAI,CAACA,QAAQ,CAAC4C,mBAAmB,EAAE;MACjC/G,OAAO,CAACmE,QAAQ,CAAC6C,UAAU,CAACtF,MAAM,CAAC,EAAE,UAAS6B,KAAK,EAAE;QACnD,IAAIT,EAAE,GAAGS,KAAK,CAACT,EAAE;QAEjB,IAAI,CAACA,EAAE,EAAE;UACP,MAAM,IAAIkB,KAAK,CAAC,qBAAqB,CAAC;QACxC;QAEA7B,OAAO,CAACW,EAAE,CAAC,GAAG5C,IAAI,CAACqD,KAAK,EAAE,CAAE,IAAI,CAAE,CAAC;MACrC,CAAC,CAAC;MAEF;IACF;IAEA,IAAI0D,gBAAgB,GAAG9C,QAAQ,CAAC4C,mBAAmB,CAACrF,MAAM,CAAC;IAE3D,IAAIzB,UAAU,CAACgH,gBAAgB,CAAC,EAAE;MAChC9E,OAAO,GAAG8E,gBAAgB,CAAC9E,OAAO,CAAC;IACrC,CAAC,MAAM;MACLnC,OAAO,CAACiH,gBAAgB,EAAE,UAAS1D,KAAK,EAAET,EAAE,EAAE;QAC5CX,OAAO,CAACW,EAAE,CAAC,GAAGS,KAAK;MACrB,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;EAEF,OAAOpB,OAAO;AAChB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA3B,SAAS,CAACqB,SAAS,CAAC6C,iBAAiB,GAAG,UAAShD,MAAM,EAAE4C,SAAS,EAAE;EAClE,IAAInC,OAAO,GAAG,CAAC,CAAC;EAEhBnC,OAAO,CAACsE,SAAS,EAAE,UAASH,QAAQ,EAAE;IAEpC;IACA,IAAI,CAACA,QAAQ,CAAC+C,yBAAyB,EAAE;MACvC,IAAI,CAAC/C,QAAQ,CAACgD,gBAAgB,EAAE;QAC9B;MACF;MAEAnH,OAAO,CAACmE,QAAQ,CAACgD,gBAAgB,CAACzF,MAAM,CAAC,EAAE,UAAS6B,KAAK,EAAE;QACzD,IAAIT,EAAE,GAAGS,KAAK,CAACT,EAAE;QAEjB,IAAI,CAACA,EAAE,EAAE;UACP,MAAM,IAAIkB,KAAK,CAAC,qBAAqB,CAAC;QACxC;QAEA7B,OAAO,CAACW,EAAE,CAAC,GAAG5C,IAAI,CAACqD,KAAK,EAAE,CAAE,IAAI,CAAE,CAAC;MACrC,CAAC,CAAC;MAEF;IACF;IAEA,IAAI0D,gBAAgB,GAAG9C,QAAQ,CAAC+C,yBAAyB,CAACxF,MAAM,CAAC;IAEjE,IAAIzB,UAAU,CAACgH,gBAAgB,CAAC,EAAE;MAChC9E,OAAO,GAAG8E,gBAAgB,CAAC9E,OAAO,CAAC;IACrC,CAAC,MAAM;MACLnC,OAAO,CAACiH,gBAAgB,EAAE,UAAS1D,KAAK,EAAET,EAAE,EAAE;QAC5CX,OAAO,CAACW,EAAE,CAAC,GAAGS,KAAK;MACrB,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;EAEF,OAAOpB,OAAO;AAChB,CAAC;AAGD3B,SAAS,CAACqB,SAAS,CAAC8C,oBAAoB,GAAG,UAASL,SAAS,EAAE;EAC7D,MAAMH,QAAQ,GAAGG,SAAS,CAAC8C,IAAI,CAC7BjD,QAAQ,IAAIlE,UAAU,CAACkE,QAAQ,CAACkD,mBAAmB,CACrD,CAAC;EAED,OAAOlD,QAAQ,IAAIA,QAAQ,CAACkD,mBAAmB,CAAC,CAAC;AACnD,CAAC;;AAGD;AACA;AACA;AACA;AACA;AACA7G,SAAS,CAACqB,SAAS,CAACJ,MAAM,GAAG,YAAW;EACtC,OAAO,CAAC,CAAC,IAAI,CAACT,QAAQ;AACxB,CAAC;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAR,SAAS,CAACqB,SAAS,CAAC4B,OAAO,GAAG,UAASlC,KAAK,EAAEgC,KAAK,EAAoB;EAAA,IAAlBC,MAAM,GAAA8D,SAAA,CAAA9C,MAAA,QAAA8C,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAG,OAAO;EAEnE;EACA/F,KAAK,CAACiG,cAAc,CAAC,CAAC;EAEtB,IAAI,CAACjE,KAAK,EAAE;IACV,IAAI/B,OAAO,GAAG3B,UAAU,CAAC0B,KAAK,CAACkG,cAAc,IAAIlG,KAAK,CAACG,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC;IAC9E,IAAIgG,OAAO,GAAG3H,OAAO,CAACyB,OAAO,EAAEnB,QAAQ,CAAC;IAExCkD,KAAK,GAAAV,aAAA;MAAKC,EAAE,EAAE4E;IAAO,GAAK,IAAI,CAACC,SAAS,CAACD,OAAO,CAAC,CAAE;EACrD;EAEA,MAAME,OAAO,GAAGrE,KAAK,CAACC,MAAM;EAE5B,IAAI,IAAI,CAACY,KAAK,CAAC,SAAS,EAAE;IAAEb,KAAK;IAAEhC;EAAM,CAAC,CAAC,KAAK,KAAK,EAAE;IACrD;EACF;EAEA,IAAItB,UAAU,CAAC2H,OAAO,CAAC,EAAE;IACvB,IAAIpE,MAAM,KAAK,OAAO,EAAE;MACtB,OAAOoE,OAAO,CAACrG,KAAK,EAAEgC,KAAK,CAAC;IAC9B;EACF,CAAC,MAAM;IACL,IAAIqE,OAAO,CAACpE,MAAM,CAAC,EAAE;MACnB,OAAOoE,OAAO,CAACpE,MAAM,CAAC,CAACjC,KAAK,EAAEgC,KAAK,CAAC;IACtC;EACF;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA/C,SAAS,CAACqB,SAAS,CAAC8F,SAAS,GAAG,UAASD,OAAO,EAAE;EAEhD,IAAInE,KAAK,GAAG,IAAI,CAACvC,QAAQ,CAACmB,OAAO,CAAEuF,OAAO,CAAE,IAAI,IAAI,CAAC1G,QAAQ,CAACoB,aAAa,CAAEsF,OAAO,CAAE;EAGtF,IAAI,CAACnE,KAAK,EAAE;IACV,MAAM,IAAIS,KAAK,CAAC,iBAAiB,CAAC;EACpC;EAEA,OAAOT,KAAK;AACd,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}