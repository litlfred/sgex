{"ast":null,"code":"import { getDi } from '../../util/ModelUtil';\nimport { filter, forEach, map } from 'min-dash';\nimport { selfAndAllChildren } from 'diagram-js/lib/util/Elements';\n\n/**\n * @typedef {import('diagram-js/lib/core/EventBus').default} EventBus\n * @typedef {import('diagram-js/lib/core/Canvas').default} Canvas\n */\n\nvar HIGH_PRIORITY = 2000;\n\n/**\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function BpmnDiOrdering(eventBus, canvas) {\n  eventBus.on('saveXML.start', HIGH_PRIORITY, orderDi);\n  function orderDi() {\n    var rootElements = canvas.getRootElements();\n    forEach(rootElements, function (root) {\n      var rootDi = getDi(root),\n        elements,\n        diElements;\n      elements = selfAndAllChildren([root], false);\n\n      // only bpmndi:Shape and bpmndi:Edge can be direct children of bpmndi:Plane\n      elements = filter(elements, function (element) {\n        return element !== root && !element.labelTarget;\n      });\n      diElements = map(elements, getDi);\n      rootDi.set('planeElement', diElements);\n    });\n  }\n}\nBpmnDiOrdering.$inject = ['eventBus', 'canvas'];","map":{"version":3,"names":["getDi","filter","forEach","map","selfAndAllChildren","HIGH_PRIORITY","BpmnDiOrdering","eventBus","canvas","on","orderDi","rootElements","getRootElements","root","rootDi","elements","diElements","element","labelTarget","set","$inject"],"sources":["/home/runner/work/sgex/sgex/node_modules/bpmn-js/lib/features/di-ordering/BpmnDiOrdering.js"],"sourcesContent":["import { getDi } from '../../util/ModelUtil';\n\nimport {\n  filter,\n  forEach,\n  map\n} from 'min-dash';\n\nimport { selfAndAllChildren } from 'diagram-js/lib/util/Elements';\n\n/**\n * @typedef {import('diagram-js/lib/core/EventBus').default} EventBus\n * @typedef {import('diagram-js/lib/core/Canvas').default} Canvas\n */\n\nvar HIGH_PRIORITY = 2000;\n\n/**\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function BpmnDiOrdering(eventBus, canvas) {\n\n  eventBus.on('saveXML.start', HIGH_PRIORITY, orderDi);\n\n  function orderDi() {\n    var rootElements = canvas.getRootElements();\n\n    forEach(rootElements, function(root) {\n      var rootDi = getDi(root),\n          elements,\n          diElements;\n\n      elements = selfAndAllChildren([ root ], false);\n\n      // only bpmndi:Shape and bpmndi:Edge can be direct children of bpmndi:Plane\n      elements = filter(elements, function(element) {\n        return element !== root && !element.labelTarget;\n      });\n\n      diElements = map(elements, getDi);\n\n      rootDi.set('planeElement', diElements);\n    });\n  }\n}\n\nBpmnDiOrdering.$inject = [ 'eventBus', 'canvas' ];\n"],"mappings":"AAAA,SAASA,KAAK,QAAQ,sBAAsB;AAE5C,SACEC,MAAM,EACNC,OAAO,EACPC,GAAG,QACE,UAAU;AAEjB,SAASC,kBAAkB,QAAQ,8BAA8B;;AAEjE;AACA;AACA;AACA;;AAEA,IAAIC,aAAa,GAAG,IAAI;;AAExB;AACA;AACA;AACA;AACA,eAAe,SAASC,cAAcA,CAACC,QAAQ,EAAEC,MAAM,EAAE;EAEvDD,QAAQ,CAACE,EAAE,CAAC,eAAe,EAAEJ,aAAa,EAAEK,OAAO,CAAC;EAEpD,SAASA,OAAOA,CAAA,EAAG;IACjB,IAAIC,YAAY,GAAGH,MAAM,CAACI,eAAe,CAAC,CAAC;IAE3CV,OAAO,CAACS,YAAY,EAAE,UAASE,IAAI,EAAE;MACnC,IAAIC,MAAM,GAAGd,KAAK,CAACa,IAAI,CAAC;QACpBE,QAAQ;QACRC,UAAU;MAEdD,QAAQ,GAAGX,kBAAkB,CAAC,CAAES,IAAI,CAAE,EAAE,KAAK,CAAC;;MAE9C;MACAE,QAAQ,GAAGd,MAAM,CAACc,QAAQ,EAAE,UAASE,OAAO,EAAE;QAC5C,OAAOA,OAAO,KAAKJ,IAAI,IAAI,CAACI,OAAO,CAACC,WAAW;MACjD,CAAC,CAAC;MAEFF,UAAU,GAAGb,GAAG,CAACY,QAAQ,EAAEf,KAAK,CAAC;MAEjCc,MAAM,CAACK,GAAG,CAAC,cAAc,EAAEH,UAAU,CAAC;IACxC,CAAC,CAAC;EACJ;AACF;AAEAV,cAAc,CAACc,OAAO,GAAG,CAAE,UAAU,EAAE,QAAQ,CAAE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}