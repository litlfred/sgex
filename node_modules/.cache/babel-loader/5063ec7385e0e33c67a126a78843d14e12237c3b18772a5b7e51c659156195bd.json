{"ast":null,"code":"import React,{useState,useEffect,useRef,useCallback,useMemo}from'react';import{useLocation,useNavigate}from'react-router-dom';import BpmnViewer from'bpmn-js/lib/NavigatedViewer';import githubService from'../services/githubService';import{PageLayout,useDAKParams}from'./framework';import'./BPMNViewer.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BPMNViewerComponent=()=>{const location=useLocation();const navigate=useNavigate();const viewerRef=useRef(null);const containerRef=useRef(null);// Try to get data from framework params first, then fall back to location state\nconst frameworkData=useDAKParams();console.log('BPMNViewer: Framework data received:',frameworkData);console.log('BPMNViewer: Location state:',location.state);const{profile,repository,component,selectedFile,selectedBranch}=location.state||{};// Use framework data if available, otherwise use location state\nconst currentProfile=(frameworkData===null||frameworkData===void 0?void 0:frameworkData.profile)||profile;const currentRepository=(frameworkData===null||frameworkData===void 0?void 0:frameworkData.repository)||repository;const currentBranch=(frameworkData===null||frameworkData===void 0?void 0:frameworkData.branch)||selectedBranch;const assetPath=frameworkData===null||frameworkData===void 0?void 0:frameworkData.asset;console.log('BPMNViewer: Final computed values:',{currentProfile:!!currentProfile,currentRepository:!!currentRepository,currentBranch,assetPath});// If we have asset path from URL, create a selectedFile object\nconst currentSelectedFile=useMemo(()=>{return assetPath?{name:assetPath.split('/').pop(),path:assetPath}:selectedFile;},[assetPath,selectedFile]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[hasWriteAccess,setHasWriteAccess]=useState(false);const[enhancedFullwidth,setEnhancedFullwidth]=useState(false);const[autoHide,setAutoHide]=useState(false);// Check write permissions\nuseEffect(()=>{const checkPermissions=async()=>{if(currentRepository&&currentProfile){try{var _currentRepository$pe;// Simple permission check - in real app, this would use githubService\nconst writeAccess=currentProfile.token&&((_currentRepository$pe=currentRepository.permissions)===null||_currentRepository$pe===void 0?void 0:_currentRepository$pe.push);setHasWriteAccess(writeAccess||false);}catch(error){console.warn('Could not check write permissions:',error);setHasWriteAccess(false);}}};checkPermissions();},[currentRepository,currentProfile]);// Load BPMN file content - simplified to avoid race conditions\nconst loadBpmnContent=useCallback(async()=>{var _currentRepository$ow;console.log('üöÄ BPMNViewer: loadBpmnContent called with:',{hasViewer:!!viewerRef.current,selectedFile:currentSelectedFile,repository:currentRepository?{name:currentRepository.name,owner:currentRepository.owner}:null});if(!viewerRef.current||!currentSelectedFile||!currentRepository){console.warn('‚ùå BPMNViewer: Missing required parameters for loadBpmnContent:',{hasViewer:!!viewerRef.current,hasSelectedFile:!!currentSelectedFile,hasRepository:!!currentRepository});return;}// Declare variables outside try block so they're accessible in catch block\nconst owner=((_currentRepository$ow=currentRepository.owner)===null||_currentRepository$ow===void 0?void 0:_currentRepository$ow.login)||currentRepository.full_name.split('/')[0];const repoName=currentRepository.name;const ref=currentBranch||'main';try{var _currentSelectedFile$,_currentSelectedFile$2;setLoading(true);setError(null);console.log('üîç BPMNViewer: Repository and file analysis:',{repository:{name:currentRepository.name,full_name:currentRepository.full_name,owner:currentRepository.owner,isDemo:currentRepository.isDemo,default_branch:currentRepository.default_branch},selectedFile:{name:currentSelectedFile.name,path:currentSelectedFile.path,size:currentSelectedFile.size},derivedOwner:owner,repoName:repoName,ref:ref,githubServiceAuthenticated:githubService.isAuth()});console.log(`üìÇ BPMNViewer: Preparing to load BPMN content from ${owner}/${repoName}:${currentSelectedFile.path} (ref: ${ref})`);console.log('üìã BPMNViewer: Full selected file object:',JSON.stringify(currentSelectedFile,null,2));let bpmnXml;const isDemo=((_currentSelectedFile$=currentSelectedFile.path)===null||_currentSelectedFile$===void 0?void 0:_currentSelectedFile$.includes('demo/'))||((_currentSelectedFile$2=currentSelectedFile.sha)===null||_currentSelectedFile$2===void 0?void 0:_currentSelectedFile$2.startsWith('demo-'));if(isDemo){// For demo files, generate BPMN XML locally\nconsole.log('üé≠ BPMNViewer: Demo file detected, generating BPMN content locally');const processName=currentSelectedFile.name.replace('.bpmn','').replace(/[-_]/g,' ');bpmnXml=`<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<bpmn:definitions xmlns:bpmn=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" \n                  xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" \n                  xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" \n                  xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\" \n                  id=\"Definitions_1\" targetNamespace=\"http://bpmn.io/schema/bpmn\">\n  <bpmn:process id=\"Process_${currentSelectedFile.name.replace(/[^a-zA-Z0-9]/g,'_')}\" isExecutable=\"false\">\n    <bpmn:startEvent id=\"StartEvent_1\" name=\"Start\">\n      <bpmn:outgoing>Flow_1</bpmn:outgoing>\n    </bpmn:startEvent>\n    <bpmn:task id=\"Task_1\" name=\"${processName}\">\n      <bpmn:incoming>Flow_1</bpmn:incoming>\n      <bpmn:outgoing>Flow_2</bpmn:outgoing>\n    </bpmn:task>\n    <bpmn:endEvent id=\"EndEvent_1\" name=\"End\">\n      <bpmn:incoming>Flow_2</bpmn:incoming>\n    </bpmn:endEvent>\n    <bpmn:sequenceFlow id=\"Flow_1\" sourceRef=\"StartEvent_1\" targetRef=\"Task_1\" />\n    <bpmn:sequenceFlow id=\"Flow_2\" sourceRef=\"Task_1\" targetRef=\"EndEvent_1\" />\n  </bpmn:process>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\n    <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_${currentSelectedFile.name.replace(/[^a-zA-Z0-9]/g,'_')}\">\n      <bpmndi:BPMNShape id=\"StartEvent_1_di\" bpmnElement=\"StartEvent_1\">\n        <dc:Bounds x=\"152\" y=\"82\" width=\"36\" height=\"36\" />\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"158\" y=\"125\" width=\"24\" height=\"14\" />\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Task_1_di\" bpmnElement=\"Task_1\">\n        <dc:Bounds x=\"250\" y=\"60\" width=\"100\" height=\"80\" />\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"EndEvent_1_di\" bpmnElement=\"EndEvent_1\">\n        <dc:Bounds x=\"402\" y=\"82\" width=\"36\" height=\"36\" />\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"410\" y=\"125\" width=\"20\" height=\"14\" />\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"Flow_1_di\" bpmnElement=\"Flow_1\">\n        <di:waypoint x=\"188\" y=\"100\" />\n        <di:waypoint x=\"250\" y=\"100\" />\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"Flow_2_di\" bpmnElement=\"Flow_2\">\n        <di:waypoint x=\"350\" y=\"100\" />\n        <di:waypoint x=\"402\" y=\"100\" />\n      </bpmndi:BPMNEdge>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</bpmn:definitions>`;}else{// For real files, use githubService to fetch file content\nbpmnXml=await githubService.getFileContent(owner,repoName,currentSelectedFile.path,ref);}// Validate BPMN content\nif(!bpmnXml||!bpmnXml.trim()){throw new Error('Empty or invalid BPMN file content');}if(!bpmnXml.includes('bpmn:definitions')&&!bpmnXml.includes('<definitions')){throw new Error('File does not appear to contain valid BPMN XML content');}// Validate BPMN content\nif(!bpmnXml||!bpmnXml.trim()){throw new Error('Empty or invalid BPMN file content');}if(!bpmnXml.includes('bpmn:definitions')&&!bpmnXml.includes('<definitions')){throw new Error('File does not appear to contain valid BPMN XML content');}// Import XML into viewer\nconsole.log('üé® BPMNViewer: Importing XML into BPMN viewer...');await viewerRef.current.importXML(bpmnXml);// Center the diagram\ntry{const canvas=viewerRef.current.get('canvas');canvas.zoom('fit-viewport');console.log('‚úÖ BPMNViewer: Successfully loaded and centered BPMN diagram');}catch(centerError){console.warn('‚ö†Ô∏è BPMNViewer: Could not center diagram:',centerError);}setLoading(false);}catch(err){console.error('üí• BPMNViewer: Error loading BPMN file:',err);console.error('üîç BPMNViewer: Full error details:',{message:err.message,status:err.status,stack:err.stack,repository:{owner:owner,name:repoName,ref:ref},file:{name:currentSelectedFile.name,path:currentSelectedFile.path}});// Provide specific error messages\nif(err.status===404){setError('BPMN file not found in the repository.');}else if(err.status===403){setError('Access denied. This repository may be private and require authentication.');}else if(err.message.includes('Empty or invalid BPMN')){setError('The selected file appears to be empty or corrupted.');}else if(err.message.includes('does not appear to contain valid BPMN')){setError('The selected file does not appear to contain valid BPMN XML content.');}else{setError(`Failed to load BPMN diagram: ${err.message}`);}setLoading(false);}},[currentSelectedFile,currentRepository,currentBranch]);const cleanupContainer=useCallback(()=>{if(containerRef.current){containerRef.current.innerHTML='';console.log('üßπ BPMNViewer: Container cleaned up');}},[]);// Initialize BPMN viewer - simplified to avoid race conditions\nuseEffect(()=>{const initializeViewer=()=>{console.log('üõ†Ô∏è BPMNViewer: initializeViewer called with:',{hasContainer:!!containerRef.current,hasViewer:!!viewerRef.current,selectedFile:currentSelectedFile?currentSelectedFile.name:'none',containerRefCurrent:containerRef.current,viewerRefCurrent:viewerRef.current});if(containerRef.current&&!viewerRef.current&&currentSelectedFile){try{// Clean the container before creating a new viewer\ncleanupContainer();console.log('üîß BPMNViewer: Creating new BPMN viewer...');console.log('üîß BPMNViewer: Container element details:',{tagName:containerRef.current.tagName,className:containerRef.current.className,clientWidth:containerRef.current.clientWidth,clientHeight:containerRef.current.clientHeight,innerHTML:containerRef.current.innerHTML.length});viewerRef.current=new BpmnViewer({container:containerRef.current});console.log('‚úÖ BPMNViewer: BPMN viewer initialized successfully');console.log('üìû BPMNViewer: About to call loadBpmnContent()...');loadBpmnContent();}catch(error){console.error('‚ùå BPMNViewer: Failed to initialize BPMN viewer:',error);console.error('üîç BPMNViewer: Initialization error details:',{message:error.message,stack:error.stack,containerExists:!!containerRef.current,containerContent:containerRef.current?containerRef.current.innerHTML:'N/A'});// If it's an \"element already exists\" error, try to clean up and retry once\nif(error.message.includes('already exists')){console.log('üîÑ BPMNViewer: Detected \"element already exists\" error, attempting cleanup and retry...');cleanupContainer();// Wait a bit and try again\nsetTimeout(()=>{if(containerRef.current&&!viewerRef.current){try{console.log('üîÑ BPMNViewer: Retrying viewer creation after cleanup...');viewerRef.current=new BpmnViewer({container:containerRef.current});console.log('‚úÖ BPMNViewer: BPMN viewer initialized successfully on retry');loadBpmnContent();}catch(retryError){console.error('‚ùå BPMNViewer: Failed to initialize BPMN viewer on retry:',retryError);setError(`Failed to initialize BPMN viewer: ${retryError.message}`);setLoading(false);}}},100);}else{setError(`Failed to initialize BPMN viewer: ${error.message}`);setLoading(false);}}}else{console.log('‚ö†Ô∏è BPMNViewer: Skipping viewer initialization:',{hasContainer:!!containerRef.current,hasViewer:!!viewerRef.current,hasSelectedFile:!!currentSelectedFile,reason:!containerRef.current?'No container':viewerRef.current?'Viewer already exists':!currentSelectedFile?'No selected file':'Unknown'});}};const waitForContainer=function(){let attempt=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;const maxAttempts=50;// Try for up to 5 seconds (50 * 100ms)\nif(containerRef.current){console.log(`‚úÖ BPMNViewer: Container found on attempt ${attempt+1}`);initializeViewer();}else if(attempt<maxAttempts){console.log(`‚è≥ BPMNViewer: Container not ready, attempt ${attempt+1}/${maxAttempts}, retrying in 100ms...`);setTimeout(()=>waitForContainer(attempt+1),100);}else{console.error('‚ùå BPMNViewer: Container never became available after maximum attempts');setError('Failed to initialize BPMN viewer: container not available');setLoading(false);}};if(currentSelectedFile){console.log('‚è∞ BPMNViewer: Starting container readiness check for selectedFile:',currentSelectedFile.name);waitForContainer();}else{console.log('‚ùå BPMNViewer: No currentSelectedFile, skipping viewer initialization');}return()=>{if(viewerRef.current){try{viewerRef.current.destroy();}catch(error){console.warn('Warning cleaning up BPMN viewer:',error);}viewerRef.current=null;}};},[currentSelectedFile,loadBpmnContent,cleanupContainer]);const handleEditMode=()=>{var _currentRepository$ow2;if(!hasWriteAccess){alert('You need write permissions to edit BPMN files. Please check your GitHub token permissions.');return;}const owner=((_currentRepository$ow2=currentRepository.owner)===null||_currentRepository$ow2===void 0?void 0:_currentRepository$ow2.login)||currentRepository.full_name.split('/')[0];const repoName=currentRepository.name;const path=currentBranch?`/bpmn-editor/${owner}/${repoName}/${currentBranch}`:`/bpmn-editor/${owner}/${repoName}`;navigate(path,{state:{profile:currentProfile,repository:currentRepository,component,selectedFile:currentSelectedFile,selectedBranch:currentBranch,mode:'edit'}});};const handleBackToSelection=()=>{navigate('/business-process-selection',{state:{profile:currentProfile,repository:currentRepository,component,selectedBranch:currentBranch}});};const handleToggleEnhancedFullwidth=()=>{const newState=!enhancedFullwidth;setEnhancedFullwidth(newState);// Add/remove class on body for enhanced fullwidth mode\nif(newState){document.body.classList.add('enhanced-fullwidth-active');}else{document.body.classList.remove('enhanced-fullwidth-active');}};const handleToggleAutoHide=()=>{setAutoHide(!autoHide);};// Cleanup effect for enhanced fullwidth\nuseEffect(()=>{return()=>{// Clean up body class on unmount\ndocument.body.classList.remove('enhanced-fullwidth-active');};},[]);// Update body class when enhanced fullwidth changes\nuseEffect(()=>{if(enhancedFullwidth){document.body.classList.add('enhanced-fullwidth-active');}else{document.body.classList.remove('enhanced-fullwidth-active');}return()=>{document.body.classList.remove('enhanced-fullwidth-active');};},[enhancedFullwidth]);// Handle redirect when data is missing\nuseEffect(()=>{// Check if we're on an asset URL pattern (has more than 5 path segments after /sgex)\nconst pathSegments=location.pathname.split('/').filter(segment=>segment);const isAssetURL=pathSegments.length>5;// /sgex/bpmn-viewer/user/repo/branch/asset...\n// If we're on an asset URL, wait for framework to load before deciding to redirect\nif(isAssetURL){// Only redirect if we have both no framework data AND no location state\nif(!(frameworkData!==null&&frameworkData!==void 0&&frameworkData.profile)&&!(frameworkData!==null&&frameworkData!==void 0&&frameworkData.repository)&&!(frameworkData!==null&&frameworkData!==void 0&&frameworkData.asset)&&!currentProfile&&!currentRepository&&!currentSelectedFile){console.log('BPMNViewer: On asset URL but no data available from framework or location state, redirecting to home');navigate('/');}}else{// For non-asset URLs, use the original logic\nif(!currentProfile||!currentRepository||!currentSelectedFile){console.log('BPMNViewer: Missing required data, redirecting to home:',{hasProfile:!!currentProfile,hasRepository:!!currentRepository,hasSelectedFile:!!currentSelectedFile});navigate('/');}}},[currentProfile,currentRepository,currentSelectedFile,frameworkData,location.pathname,navigate]);// Don't render the component if we're missing required data, unless we're on asset URL and framework is loading\nconst pathSegments=location.pathname.split('/').filter(segment=>segment);const isAssetURL=pathSegments.length>5;if(!currentProfile||!currentRepository||!currentSelectedFile){if(isAssetURL&&(!(frameworkData!==null&&frameworkData!==void 0&&frameworkData.profile)||!(frameworkData!==null&&frameworkData!==void 0&&frameworkData.repository)||!(frameworkData!==null&&frameworkData!==void 0&&frameworkData.asset))){// Framework might still be loading for asset URL\nreturn/*#__PURE__*/_jsx(\"div\",{children:\"Loading framework data...\"});}return/*#__PURE__*/_jsx(\"div\",{children:\"Loading or redirecting...\"});}return/*#__PURE__*/_jsx(PageLayout,{pageName:\"bpmn-viewer\",children:/*#__PURE__*/_jsx(\"div\",{className:`bpmn-viewer ${enhancedFullwidth?'enhanced-fullwidth':''} ${autoHide?'auto-hide':''}`,children:/*#__PURE__*/_jsx(\"div\",{className:\"viewer-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"viewer-main\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"viewer-toolbar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-left\",children:[/*#__PURE__*/_jsx(\"h3\",{children:currentSelectedFile.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"artifact-badges\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"artifact-badge bpmn\",children:\"\\uD83D\\uDCCA BPMN\"}),/*#__PURE__*/_jsx(\"span\",{className:\"dak-component-badge\",children:\"\\uD83D\\uDD04 Business Process\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"view-mode-badge\",children:\"\\uD83D\\uDC41\\uFE0F Read-Only View\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"toolbar-right\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"action-btn secondary\",onClick:handleToggleAutoHide,title:\"Toggle auto-hide headers/footers\",children:[autoHide?'üìå':'üëÅÔ∏è',\" Auto-Hide\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"action-btn secondary\",onClick:handleToggleEnhancedFullwidth,title:\"Toggle enhanced fullwidth mode\",children:[enhancedFullwidth?'üî≥':'‚õ∂',\" Full Container\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn secondary\",onClick:handleBackToSelection,children:\"\\u2190 Back to List\"}),hasWriteAccess&&/*#__PURE__*/_jsx(\"button\",{className:\"action-btn primary\",onClick:handleEditMode,children:\"\\u270F\\uFE0F Edit\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"diagram-container\",children:[loading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-overlay\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"loading-info\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Loading BPMN diagram...\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"loading-details\",children:[\"Fetching \",currentSelectedFile.name,\" from \",currentRepository.name]}),/*#__PURE__*/_jsx(\"p\",{className:\"loading-hint\",children:\"This may take a few moments for large files or slow connections.\"})]})]}):error?/*#__PURE__*/_jsxs(\"div\",{className:\"error-overlay\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u274C \",error]}),/*#__PURE__*/_jsxs(\"div\",{className:\"error-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"action-btn secondary\",onClick:()=>loadBpmnContent(),children:\"\\uD83D\\uDD04 Retry\"}),/*#__PURE__*/_jsx(\"button\",{className:\"action-btn secondary\",onClick:()=>navigate('/business-process-selection',{state:{profile:currentProfile,repository:currentRepository,component,selectedBranch:currentBranch}}),children:\"\\u2190 Back to List\"})]})]}):null,/*#__PURE__*/_jsx(\"div\",{className:\"bpmn-container\",ref:containerRef,style:{display:loading||error?'none':'block',width:'100%',height:'100%'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"diagram-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"condensed-file-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"condensed-info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"\\uD83D\\uDCC1\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:(currentSelectedFile===null||currentSelectedFile===void 0?void 0:currentSelectedFile.name)||'No file'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"condensed-info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"\\uD83D\\uDCCF\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:currentSelectedFile!==null&&currentSelectedFile!==void 0&&currentSelectedFile.size?`${(currentSelectedFile.size/1024).toFixed(1)} KB`:'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"condensed-info-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"\\uD83C\\uDF3F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:currentBranch||'main'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"condensed-view-mode\",children:[/*#__PURE__*/_jsx(\"span\",{className:`condensed-access-badge ${hasWriteAccess?'write':'read'}`,children:hasWriteAccess?'‚úèÔ∏è Edit':'üëÅÔ∏è Read'}),/*#__PURE__*/_jsx(\"span\",{className:\"condensed-info-item\",children:/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:enhancedFullwidth?'‚õ∂ Full Container':autoHide?'üëÅÔ∏è Auto-Hide':'üì∫ Fullwidth'})})]})]})]})})})});};export default BPMNViewerComponent;","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useMemo","useLocation","useNavigate","BpmnViewer","githubService","PageLayout","useDAKParams","jsx","_jsx","jsxs","_jsxs","BPMNViewerComponent","location","navigate","viewerRef","containerRef","frameworkData","console","log","state","profile","repository","component","selectedFile","selectedBranch","currentProfile","currentRepository","currentBranch","branch","assetPath","asset","currentSelectedFile","name","split","pop","path","loading","setLoading","error","setError","hasWriteAccess","setHasWriteAccess","enhancedFullwidth","setEnhancedFullwidth","autoHide","setAutoHide","checkPermissions","_currentRepository$pe","writeAccess","token","permissions","push","warn","loadBpmnContent","_currentRepository$ow","hasViewer","current","owner","hasSelectedFile","hasRepository","login","full_name","repoName","ref","_currentSelectedFile$","_currentSelectedFile$2","isDemo","default_branch","size","derivedOwner","githubServiceAuthenticated","isAuth","JSON","stringify","bpmnXml","includes","sha","startsWith","processName","replace","getFileContent","trim","Error","importXML","canvas","get","zoom","centerError","err","message","status","stack","file","cleanupContainer","innerHTML","initializeViewer","hasContainer","containerRefCurrent","viewerRefCurrent","tagName","className","clientWidth","clientHeight","length","container","containerExists","containerContent","setTimeout","retryError","reason","waitForContainer","attempt","arguments","undefined","maxAttempts","destroy","handleEditMode","_currentRepository$ow2","alert","mode","handleBackToSelection","handleToggleEnhancedFullwidth","newState","document","body","classList","add","remove","handleToggleAutoHide","pathSegments","pathname","filter","segment","isAssetURL","hasProfile","children","pageName","onClick","title","style","display","width","height","toFixed"],"sources":["/home/runner/work/sgex/sgex/src/components/BPMNViewer.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport BpmnViewer from 'bpmn-js/lib/NavigatedViewer';\nimport githubService from '../services/githubService';\nimport { PageLayout, useDAKParams } from './framework';\nimport './BPMNViewer.css';\n\nconst BPMNViewerComponent = () => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const viewerRef = useRef(null);\n  const containerRef = useRef(null);\n  \n  // Try to get data from framework params first, then fall back to location state\n  const frameworkData = useDAKParams();\n  \n  console.log('BPMNViewer: Framework data received:', frameworkData);\n  console.log('BPMNViewer: Location state:', location.state);\n  \n  const { profile, repository, component, selectedFile, selectedBranch } = location.state || {};\n  \n  // Use framework data if available, otherwise use location state\n  const currentProfile = frameworkData?.profile || profile;\n  const currentRepository = frameworkData?.repository || repository;\n  const currentBranch = frameworkData?.branch || selectedBranch;\n  const assetPath = frameworkData?.asset;\n  \n  console.log('BPMNViewer: Final computed values:', {\n    currentProfile: !!currentProfile,\n    currentRepository: !!currentRepository,\n    currentBranch,\n    assetPath\n  });\n  \n  // If we have asset path from URL, create a selectedFile object\n  const currentSelectedFile = useMemo(() => {\n    return assetPath ? {\n      name: assetPath.split('/').pop(),\n      path: assetPath\n    } : selectedFile;\n  }, [assetPath, selectedFile]);\n  \n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [hasWriteAccess, setHasWriteAccess] = useState(false);\n  const [enhancedFullwidth, setEnhancedFullwidth] = useState(false);\n  const [autoHide, setAutoHide] = useState(false);\n\n  // Check write permissions\n  useEffect(() => {\n    const checkPermissions = async () => {\n      if (currentRepository && currentProfile) {\n        try {\n          // Simple permission check - in real app, this would use githubService\n          const writeAccess = currentProfile.token && currentRepository.permissions?.push;\n          setHasWriteAccess(writeAccess || false);\n        } catch (error) {\n          console.warn('Could not check write permissions:', error);\n          setHasWriteAccess(false);\n        }\n      }\n    };\n\n    checkPermissions();\n  }, [currentRepository, currentProfile]);\n\n  // Load BPMN file content - simplified to avoid race conditions\n  const loadBpmnContent = useCallback(async () => {\n    console.log('üöÄ BPMNViewer: loadBpmnContent called with:', {\n      hasViewer: !!viewerRef.current,\n      selectedFile: currentSelectedFile,\n      repository: currentRepository ? {\n        name: currentRepository.name,\n        owner: currentRepository.owner\n      } : null\n    });\n\n    if (!viewerRef.current || !currentSelectedFile || !currentRepository) {\n      console.warn('‚ùå BPMNViewer: Missing required parameters for loadBpmnContent:', {\n        hasViewer: !!viewerRef.current,\n        hasSelectedFile: !!currentSelectedFile,\n        hasRepository: !!currentRepository\n      });\n      return;\n    }\n\n    // Declare variables outside try block so they're accessible in catch block\n    const owner = currentRepository.owner?.login || currentRepository.full_name.split('/')[0];\n    const repoName = currentRepository.name;\n    const ref = currentBranch || 'main';\n    try {\n      setLoading(true);\n      setError(null);\n\n      console.log('üîç BPMNViewer: Repository and file analysis:', {\n        repository: {\n          name: currentRepository.name,\n          full_name: currentRepository.full_name,\n          owner: currentRepository.owner,\n          isDemo: currentRepository.isDemo,\n          default_branch: currentRepository.default_branch\n        },\n        selectedFile: {\n          name: currentSelectedFile.name,\n          path: currentSelectedFile.path,\n          size: currentSelectedFile.size\n        },\n        derivedOwner: owner,\n        repoName: repoName,\n        ref: ref,\n        githubServiceAuthenticated: githubService.isAuth()\n      });\n\n      console.log(`üìÇ BPMNViewer: Preparing to load BPMN content from ${owner}/${repoName}:${currentSelectedFile.path} (ref: ${ref})`);\n      console.log('üìã BPMNViewer: Full selected file object:', JSON.stringify(currentSelectedFile, null, 2));\n\n      let bpmnXml;\n      const isDemo = currentSelectedFile.path?.includes('demo/') || currentSelectedFile.sha?.startsWith('demo-');\n      \n      if (isDemo) {\n        // For demo files, generate BPMN XML locally\n        console.log('üé≠ BPMNViewer: Demo file detected, generating BPMN content locally');\n        const processName = currentSelectedFile.name.replace('.bpmn', '').replace(/[-_]/g, ' ');\n        bpmnXml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<bpmn:definitions xmlns:bpmn=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" \n                  xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" \n                  xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" \n                  xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\" \n                  id=\"Definitions_1\" targetNamespace=\"http://bpmn.io/schema/bpmn\">\n  <bpmn:process id=\"Process_${currentSelectedFile.name.replace(/[^a-zA-Z0-9]/g, '_')}\" isExecutable=\"false\">\n    <bpmn:startEvent id=\"StartEvent_1\" name=\"Start\">\n      <bpmn:outgoing>Flow_1</bpmn:outgoing>\n    </bpmn:startEvent>\n    <bpmn:task id=\"Task_1\" name=\"${processName}\">\n      <bpmn:incoming>Flow_1</bpmn:incoming>\n      <bpmn:outgoing>Flow_2</bpmn:outgoing>\n    </bpmn:task>\n    <bpmn:endEvent id=\"EndEvent_1\" name=\"End\">\n      <bpmn:incoming>Flow_2</bpmn:incoming>\n    </bpmn:endEvent>\n    <bpmn:sequenceFlow id=\"Flow_1\" sourceRef=\"StartEvent_1\" targetRef=\"Task_1\" />\n    <bpmn:sequenceFlow id=\"Flow_2\" sourceRef=\"Task_1\" targetRef=\"EndEvent_1\" />\n  </bpmn:process>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\n    <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_${currentSelectedFile.name.replace(/[^a-zA-Z0-9]/g, '_')}\">\n      <bpmndi:BPMNShape id=\"StartEvent_1_di\" bpmnElement=\"StartEvent_1\">\n        <dc:Bounds x=\"152\" y=\"82\" width=\"36\" height=\"36\" />\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"158\" y=\"125\" width=\"24\" height=\"14\" />\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"Task_1_di\" bpmnElement=\"Task_1\">\n        <dc:Bounds x=\"250\" y=\"60\" width=\"100\" height=\"80\" />\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"EndEvent_1_di\" bpmnElement=\"EndEvent_1\">\n        <dc:Bounds x=\"402\" y=\"82\" width=\"36\" height=\"36\" />\n        <bpmndi:BPMNLabel>\n          <dc:Bounds x=\"410\" y=\"125\" width=\"20\" height=\"14\" />\n        </bpmndi:BPMNLabel>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"Flow_1_di\" bpmnElement=\"Flow_1\">\n        <di:waypoint x=\"188\" y=\"100\" />\n        <di:waypoint x=\"250\" y=\"100\" />\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"Flow_2_di\" bpmnElement=\"Flow_2\">\n        <di:waypoint x=\"350\" y=\"100\" />\n        <di:waypoint x=\"402\" y=\"100\" />\n      </bpmndi:BPMNEdge>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</bpmn:definitions>`;\n      } else {\n        // For real files, use githubService to fetch file content\n        bpmnXml = await githubService.getFileContent(owner, repoName, currentSelectedFile.path, ref);\n      }\n      \n      // Validate BPMN content\n      if (!bpmnXml || !bpmnXml.trim()) {\n        throw new Error('Empty or invalid BPMN file content');\n      }\n      \n      if (!bpmnXml.includes('bpmn:definitions') && !bpmnXml.includes('<definitions')) {\n        throw new Error('File does not appear to contain valid BPMN XML content');\n      }\n\n      \n      // Validate BPMN content\n      if (!bpmnXml || !bpmnXml.trim()) {\n        throw new Error('Empty or invalid BPMN file content');\n      }\n      \n      if (!bpmnXml.includes('bpmn:definitions') && !bpmnXml.includes('<definitions')) {\n        throw new Error('File does not appear to contain valid BPMN XML content');\n      }\n\n      // Import XML into viewer\n      console.log('üé® BPMNViewer: Importing XML into BPMN viewer...');\n      await viewerRef.current.importXML(bpmnXml);\n      \n      // Center the diagram\n      try {\n        const canvas = viewerRef.current.get('canvas');\n        canvas.zoom('fit-viewport');\n        console.log('‚úÖ BPMNViewer: Successfully loaded and centered BPMN diagram');\n      } catch (centerError) {\n        console.warn('‚ö†Ô∏è BPMNViewer: Could not center diagram:', centerError);\n      }\n      \n      setLoading(false);\n    } catch (err) {\n      console.error('üí• BPMNViewer: Error loading BPMN file:', err);\n      console.error('üîç BPMNViewer: Full error details:', {\n        message: err.message,\n        status: err.status,\n        stack: err.stack,\n        repository: {\n          owner: owner,\n          name: repoName,\n          ref: ref\n        },\n        file: {\n          name: currentSelectedFile.name,\n          path: currentSelectedFile.path\n        }\n      });\n      \n      // Provide specific error messages\n      if (err.status === 404) {\n        setError('BPMN file not found in the repository.');\n      } else if (err.status === 403) {\n        setError('Access denied. This repository may be private and require authentication.');\n      } else if (err.message.includes('Empty or invalid BPMN')) {\n        setError('The selected file appears to be empty or corrupted.');\n      } else if (err.message.includes('does not appear to contain valid BPMN')) {\n        setError('The selected file does not appear to contain valid BPMN XML content.');\n      } else {\n        setError(`Failed to load BPMN diagram: ${err.message}`);\n      }\n      \n      setLoading(false);\n    }\n  }, [currentSelectedFile, currentRepository, currentBranch]);\n\n  const cleanupContainer = useCallback(() => {\n    if (containerRef.current) {\n      containerRef.current.innerHTML = '';\n      console.log('üßπ BPMNViewer: Container cleaned up');\n    }\n  }, []);\n\n  // Initialize BPMN viewer - simplified to avoid race conditions\n  useEffect(() => {\n    const initializeViewer = () => {\n      console.log('üõ†Ô∏è BPMNViewer: initializeViewer called with:', {\n        hasContainer: !!containerRef.current,\n        hasViewer: !!viewerRef.current,\n        selectedFile: currentSelectedFile ? currentSelectedFile.name : 'none',\n        containerRefCurrent: containerRef.current,\n        viewerRefCurrent: viewerRef.current\n      });\n\n      if (containerRef.current && !viewerRef.current && currentSelectedFile) {\n        try {\n          // Clean the container before creating a new viewer\n          cleanupContainer();\n          \n          console.log('üîß BPMNViewer: Creating new BPMN viewer...');\n          console.log('üîß BPMNViewer: Container element details:', {\n            tagName: containerRef.current.tagName,\n            className: containerRef.current.className,\n            clientWidth: containerRef.current.clientWidth,\n            clientHeight: containerRef.current.clientHeight,\n            innerHTML: containerRef.current.innerHTML.length\n          });\n          \n          viewerRef.current = new BpmnViewer({\n            container: containerRef.current\n          });\n          console.log('‚úÖ BPMNViewer: BPMN viewer initialized successfully');\n          console.log('üìû BPMNViewer: About to call loadBpmnContent()...');\n          \n          loadBpmnContent();\n        } catch (error) {\n          console.error('‚ùå BPMNViewer: Failed to initialize BPMN viewer:', error);\n          console.error('üîç BPMNViewer: Initialization error details:', {\n            message: error.message,\n            stack: error.stack,\n            containerExists: !!containerRef.current,\n            containerContent: containerRef.current ? containerRef.current.innerHTML : 'N/A'\n          });\n          \n          // If it's an \"element already exists\" error, try to clean up and retry once\n          if (error.message.includes('already exists')) {\n            console.log('üîÑ BPMNViewer: Detected \"element already exists\" error, attempting cleanup and retry...');\n            cleanupContainer();\n            \n            // Wait a bit and try again\n            setTimeout(() => {\n              if (containerRef.current && !viewerRef.current) {\n                try {\n                  console.log('üîÑ BPMNViewer: Retrying viewer creation after cleanup...');\n                  viewerRef.current = new BpmnViewer({\n                    container: containerRef.current\n                  });\n                  console.log('‚úÖ BPMNViewer: BPMN viewer initialized successfully on retry');\n                  loadBpmnContent();\n                } catch (retryError) {\n                  console.error('‚ùå BPMNViewer: Failed to initialize BPMN viewer on retry:', retryError);\n                  setError(`Failed to initialize BPMN viewer: ${retryError.message}`);\n                  setLoading(false);\n                }\n              }\n            }, 100);\n          } else {\n            setError(`Failed to initialize BPMN viewer: ${error.message}`);\n            setLoading(false);\n          }\n        }\n      } else {\n        console.log('‚ö†Ô∏è BPMNViewer: Skipping viewer initialization:', {\n          hasContainer: !!containerRef.current,\n          hasViewer: !!viewerRef.current,\n          hasSelectedFile: !!currentSelectedFile,\n          reason: !containerRef.current ? 'No container' : \n                  viewerRef.current ? 'Viewer already exists' : \n                  !currentSelectedFile ? 'No selected file' : 'Unknown'\n        });\n      }\n    };\n\n    const waitForContainer = (attempt = 0) => {\n      const maxAttempts = 50; // Try for up to 5 seconds (50 * 100ms)\n      \n      if (containerRef.current) {\n        console.log(`‚úÖ BPMNViewer: Container found on attempt ${attempt + 1}`);\n        initializeViewer();\n      } else if (attempt < maxAttempts) {\n        console.log(`‚è≥ BPMNViewer: Container not ready, attempt ${attempt + 1}/${maxAttempts}, retrying in 100ms...`);\n        setTimeout(() => waitForContainer(attempt + 1), 100);\n      } else {\n        console.error('‚ùå BPMNViewer: Container never became available after maximum attempts');\n        setError('Failed to initialize BPMN viewer: container not available');\n        setLoading(false);\n      }\n    };\n\n    if (currentSelectedFile) {\n      console.log('‚è∞ BPMNViewer: Starting container readiness check for selectedFile:', currentSelectedFile.name);\n      waitForContainer();\n    } else {\n      console.log('‚ùå BPMNViewer: No currentSelectedFile, skipping viewer initialization');\n    }\n\n    return () => {\n      if (viewerRef.current) {\n        try {\n          viewerRef.current.destroy();\n        } catch (error) {\n          console.warn('Warning cleaning up BPMN viewer:', error);\n        }\n        viewerRef.current = null;\n      }\n    };\n  }, [currentSelectedFile, loadBpmnContent, cleanupContainer]);\n\n  const handleEditMode = () => {\n    if (!hasWriteAccess) {\n      alert('You need write permissions to edit BPMN files. Please check your GitHub token permissions.');\n      return;\n    }\n\n    const owner = currentRepository.owner?.login || currentRepository.full_name.split('/')[0];\n    const repoName = currentRepository.name;\n    const path = currentBranch \n      ? `/bpmn-editor/${owner}/${repoName}/${currentBranch}`\n      : `/bpmn-editor/${owner}/${repoName}`;\n\n    navigate(path, {\n      state: {\n        profile: currentProfile,\n        repository: currentRepository,\n        component,\n        selectedFile: currentSelectedFile,\n        selectedBranch: currentBranch,\n        mode: 'edit'\n      }\n    });\n  };\n\n  const handleBackToSelection = () => {\n    navigate('/business-process-selection', {\n      state: {\n        profile: currentProfile,\n        repository: currentRepository,\n        component,\n        selectedBranch: currentBranch\n      }\n    });\n  };\n\n  const handleToggleEnhancedFullwidth = () => {\n    const newState = !enhancedFullwidth;\n    setEnhancedFullwidth(newState);\n    \n    // Add/remove class on body for enhanced fullwidth mode\n    if (newState) {\n      document.body.classList.add('enhanced-fullwidth-active');\n    } else {\n      document.body.classList.remove('enhanced-fullwidth-active');\n    }\n  };\n\n  const handleToggleAutoHide = () => {\n    setAutoHide(!autoHide);\n  };\n\n  // Cleanup effect for enhanced fullwidth\n  useEffect(() => {\n    return () => {\n      // Clean up body class on unmount\n      document.body.classList.remove('enhanced-fullwidth-active');\n    };\n  }, []);\n\n  // Update body class when enhanced fullwidth changes\n  useEffect(() => {\n    if (enhancedFullwidth) {\n      document.body.classList.add('enhanced-fullwidth-active');\n    } else {\n      document.body.classList.remove('enhanced-fullwidth-active');\n    }\n    \n    return () => {\n      document.body.classList.remove('enhanced-fullwidth-active');\n    };\n  }, [enhancedFullwidth]);\n\n  // Handle redirect when data is missing\n  useEffect(() => {\n    // Check if we're on an asset URL pattern (has more than 5 path segments after /sgex)\n    const pathSegments = location.pathname.split('/').filter(segment => segment);\n    const isAssetURL = pathSegments.length > 5; // /sgex/bpmn-viewer/user/repo/branch/asset...\n    \n    // If we're on an asset URL, wait for framework to load before deciding to redirect\n    if (isAssetURL) {\n      // Only redirect if we have both no framework data AND no location state\n      if (!frameworkData?.profile && !frameworkData?.repository && !frameworkData?.asset && \n          !currentProfile && !currentRepository && !currentSelectedFile) {\n        console.log('BPMNViewer: On asset URL but no data available from framework or location state, redirecting to home');\n        navigate('/');\n      }\n    } else {\n      // For non-asset URLs, use the original logic\n      if (!currentProfile || !currentRepository || !currentSelectedFile) {\n        console.log('BPMNViewer: Missing required data, redirecting to home:', {\n          hasProfile: !!currentProfile,\n          hasRepository: !!currentRepository,\n          hasSelectedFile: !!currentSelectedFile\n        });\n        navigate('/');\n      }\n    }\n  }, [currentProfile, currentRepository, currentSelectedFile, frameworkData, location.pathname, navigate]);\n\n  // Don't render the component if we're missing required data, unless we're on asset URL and framework is loading\n  const pathSegments = location.pathname.split('/').filter(segment => segment);\n  const isAssetURL = pathSegments.length > 5;\n  \n  if (!currentProfile || !currentRepository || !currentSelectedFile) {\n    if (isAssetURL && (!frameworkData?.profile || !frameworkData?.repository || !frameworkData?.asset)) {\n      // Framework might still be loading for asset URL\n      return <div>Loading framework data...</div>;\n    }\n    return <div>Loading or redirecting...</div>;\n  }\n\n  return (\n    <PageLayout pageName=\"bpmn-viewer\">\n      <div className={`bpmn-viewer ${enhancedFullwidth ? 'enhanced-fullwidth' : ''} ${autoHide ? 'auto-hide' : ''}`}>\n      <div className=\"viewer-content\">\n\n        <div className=\"viewer-main\">\n          <div className=\"viewer-toolbar\">\n            <div className=\"toolbar-left\">\n              <h3>{currentSelectedFile.name}</h3>\n              <div className=\"artifact-badges\">\n                <span className=\"artifact-badge bpmn\">üìä BPMN</span>\n                <span className=\"dak-component-badge\">üîÑ Business Process</span>\n              </div>\n              <span className=\"view-mode-badge\">üëÅÔ∏è Read-Only View</span>\n            </div>\n            <div className=\"toolbar-right\">\n              <button \n                className=\"action-btn secondary\"\n                onClick={handleToggleAutoHide}\n                title=\"Toggle auto-hide headers/footers\"\n              >\n                {autoHide ? 'üìå' : 'üëÅÔ∏è'} Auto-Hide\n              </button>\n              <button \n                className=\"action-btn secondary\"\n                onClick={handleToggleEnhancedFullwidth}\n                title=\"Toggle enhanced fullwidth mode\"\n              >\n                {enhancedFullwidth ? 'üî≥' : '‚õ∂'} Full Container\n              </button>\n              <button \n                className=\"action-btn secondary\"\n                onClick={handleBackToSelection}\n              >\n                ‚Üê Back to List\n              </button>\n              {hasWriteAccess && (\n                <button \n                  className=\"action-btn primary\"\n                  onClick={handleEditMode}\n                >\n                  ‚úèÔ∏è Edit\n                </button>\n              )}\n            </div>\n          </div>\n\n          <div className=\"diagram-container\">\n            {loading ? (\n              <div className=\"loading-overlay\">\n                <div className=\"spinner\"></div>\n                <div className=\"loading-info\">\n                  <p>Loading BPMN diagram...</p>\n                  <p className=\"loading-details\">\n                    Fetching {currentSelectedFile.name} from {currentRepository.name}\n                  </p>\n                  <p className=\"loading-hint\">\n                    This may take a few moments for large files or slow connections.\n                  </p>\n                </div>\n              </div>\n            ) : error ? (\n              <div className=\"error-overlay\">\n                <p>‚ùå {error}</p>\n                <div className=\"error-actions\">\n                  <button \n                    className=\"action-btn secondary\"\n                    onClick={() => loadBpmnContent()}\n                  >\n                    üîÑ Retry\n                  </button>\n                  <button \n                    className=\"action-btn secondary\"\n                    onClick={() => navigate('/business-process-selection', {\n                      state: { profile: currentProfile, repository: currentRepository, component, selectedBranch: currentBranch }\n                    })}\n                  >\n                    ‚Üê Back to List\n                  </button>\n                </div>\n              </div>\n            ) : null}\n            \n            {/* Always render the BPMN container so the ref can be set */}\n            <div \n              className=\"bpmn-container\" \n              ref={containerRef}\n              style={{ \n                display: loading || error ? 'none' : 'block',\n                width: '100%',\n                height: '100%'\n              }}\n            ></div>\n          </div>\n\n          <div className=\"diagram-info\">\n            <div className=\"condensed-file-info\">\n              <div className=\"condensed-info-item\">\n                <span className=\"label\">üìÅ</span>\n                <span className=\"value\">{currentSelectedFile?.name || 'No file'}</span>\n              </div>\n              <div className=\"condensed-info-item\">\n                <span className=\"label\">üìè</span>\n                <span className=\"value\">{currentSelectedFile?.size ? `${(currentSelectedFile.size / 1024).toFixed(1)} KB` : 'N/A'}</span>\n              </div>\n              <div className=\"condensed-info-item\">\n                <span className=\"label\">üåø</span>\n                <span className=\"value\">{currentBranch || 'main'}</span>\n              </div>\n            </div>\n            <div className=\"condensed-view-mode\">\n              <span className={`condensed-access-badge ${hasWriteAccess ? 'write' : 'read'}`}>\n                {hasWriteAccess ? '‚úèÔ∏è Edit' : 'üëÅÔ∏è Read'}\n              </span>\n              <span className=\"condensed-info-item\">\n                <span className=\"value\">\n                  {enhancedFullwidth ? '‚õ∂ Full Container' : autoHide ? 'üëÅÔ∏è Auto-Hide' : 'üì∫ Fullwidth'}\n                </span>\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default BPMNViewerComponent;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}