{"ast":null,"code":"var MARKER_RESIZING = 'djs-resizing',\n  MARKER_RESIZE_NOT_OK = 'resize-not-ok';\nvar LOW_PRIORITY = 500;\nimport { attr as svgAttr, remove as svgRemove, classes as svgClasses } from 'tiny-svg';\n\n/**\n * @typedef {import('../../core/Canvas').default} Canvas\n * @typedef {import('../../core/EventBus').default} EventBus\n * @typedef {import('../preview-support/PreviewSupport').default} PreviewSupport\n */\n\n/**\n * Provides previews for resizing shapes when resizing.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {PreviewSupport} previewSupport\n */\nexport default function ResizePreview(eventBus, canvas, previewSupport) {\n  /**\n   * Update resizer frame.\n   *\n   * @param {Object} context\n   */\n  function updateFrame(context) {\n    var shape = context.shape,\n      bounds = context.newBounds,\n      frame = context.frame;\n    if (!frame) {\n      frame = context.frame = previewSupport.addFrame(shape, canvas.getActiveLayer());\n      canvas.addMarker(shape, MARKER_RESIZING);\n    }\n    if (bounds.width > 5) {\n      svgAttr(frame, {\n        x: bounds.x,\n        width: bounds.width\n      });\n    }\n    if (bounds.height > 5) {\n      svgAttr(frame, {\n        y: bounds.y,\n        height: bounds.height\n      });\n    }\n    if (context.canExecute) {\n      svgClasses(frame).remove(MARKER_RESIZE_NOT_OK);\n    } else {\n      svgClasses(frame).add(MARKER_RESIZE_NOT_OK);\n    }\n  }\n\n  /**\n   * Remove resizer frame.\n   *\n   * @param {Object} context\n   */\n  function removeFrame(context) {\n    var shape = context.shape,\n      frame = context.frame;\n    if (frame) {\n      svgRemove(context.frame);\n    }\n    canvas.removeMarker(shape, MARKER_RESIZING);\n  }\n\n  // add and update previews\n  eventBus.on('resize.move', LOW_PRIORITY, function (event) {\n    updateFrame(event.context);\n  });\n\n  // remove previews\n  eventBus.on('resize.cleanup', function (event) {\n    removeFrame(event.context);\n  });\n}\nResizePreview.$inject = ['eventBus', 'canvas', 'previewSupport'];","map":{"version":3,"names":["MARKER_RESIZING","MARKER_RESIZE_NOT_OK","LOW_PRIORITY","attr","svgAttr","remove","svgRemove","classes","svgClasses","ResizePreview","eventBus","canvas","previewSupport","updateFrame","context","shape","bounds","newBounds","frame","addFrame","getActiveLayer","addMarker","width","x","height","y","canExecute","add","removeFrame","removeMarker","on","event","$inject"],"sources":["/home/runner/work/sgex/sgex/node_modules/diagram-js/lib/features/resize/ResizePreview.js"],"sourcesContent":["var MARKER_RESIZING = 'djs-resizing',\n    MARKER_RESIZE_NOT_OK = 'resize-not-ok';\n\nvar LOW_PRIORITY = 500;\n\nimport {\n  attr as svgAttr,\n  remove as svgRemove,\n  classes as svgClasses\n} from 'tiny-svg';\n\n/**\n * @typedef {import('../../core/Canvas').default} Canvas\n * @typedef {import('../../core/EventBus').default} EventBus\n * @typedef {import('../preview-support/PreviewSupport').default} PreviewSupport\n */\n\n/**\n * Provides previews for resizing shapes when resizing.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {PreviewSupport} previewSupport\n */\nexport default function ResizePreview(eventBus, canvas, previewSupport) {\n\n  /**\n   * Update resizer frame.\n   *\n   * @param {Object} context\n   */\n  function updateFrame(context) {\n\n    var shape = context.shape,\n        bounds = context.newBounds,\n        frame = context.frame;\n\n    if (!frame) {\n      frame = context.frame = previewSupport.addFrame(shape, canvas.getActiveLayer());\n\n      canvas.addMarker(shape, MARKER_RESIZING);\n    }\n\n    if (bounds.width > 5) {\n      svgAttr(frame, { x: bounds.x, width: bounds.width });\n    }\n\n    if (bounds.height > 5) {\n      svgAttr(frame, { y: bounds.y, height: bounds.height });\n    }\n\n    if (context.canExecute) {\n      svgClasses(frame).remove(MARKER_RESIZE_NOT_OK);\n    } else {\n      svgClasses(frame).add(MARKER_RESIZE_NOT_OK);\n    }\n  }\n\n  /**\n   * Remove resizer frame.\n   *\n   * @param {Object} context\n   */\n  function removeFrame(context) {\n    var shape = context.shape,\n        frame = context.frame;\n\n    if (frame) {\n      svgRemove(context.frame);\n    }\n\n    canvas.removeMarker(shape, MARKER_RESIZING);\n  }\n\n  // add and update previews\n  eventBus.on('resize.move', LOW_PRIORITY, function(event) {\n    updateFrame(event.context);\n  });\n\n  // remove previews\n  eventBus.on('resize.cleanup', function(event) {\n    removeFrame(event.context);\n  });\n\n}\n\nResizePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'previewSupport'\n];"],"mappings":"AAAA,IAAIA,eAAe,GAAG,cAAc;EAChCC,oBAAoB,GAAG,eAAe;AAE1C,IAAIC,YAAY,GAAG,GAAG;AAEtB,SACEC,IAAI,IAAIC,OAAO,EACfC,MAAM,IAAIC,SAAS,EACnBC,OAAO,IAAIC,UAAU,QAChB,UAAU;;AAEjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,aAAaA,CAACC,QAAQ,EAAEC,MAAM,EAAEC,cAAc,EAAE;EAEtE;AACF;AACA;AACA;AACA;EACE,SAASC,WAAWA,CAACC,OAAO,EAAE;IAE5B,IAAIC,KAAK,GAAGD,OAAO,CAACC,KAAK;MACrBC,MAAM,GAAGF,OAAO,CAACG,SAAS;MAC1BC,KAAK,GAAGJ,OAAO,CAACI,KAAK;IAEzB,IAAI,CAACA,KAAK,EAAE;MACVA,KAAK,GAAGJ,OAAO,CAACI,KAAK,GAAGN,cAAc,CAACO,QAAQ,CAACJ,KAAK,EAAEJ,MAAM,CAACS,cAAc,CAAC,CAAC,CAAC;MAE/ET,MAAM,CAACU,SAAS,CAACN,KAAK,EAAEf,eAAe,CAAC;IAC1C;IAEA,IAAIgB,MAAM,CAACM,KAAK,GAAG,CAAC,EAAE;MACpBlB,OAAO,CAACc,KAAK,EAAE;QAAEK,CAAC,EAAEP,MAAM,CAACO,CAAC;QAAED,KAAK,EAAEN,MAAM,CAACM;MAAM,CAAC,CAAC;IACtD;IAEA,IAAIN,MAAM,CAACQ,MAAM,GAAG,CAAC,EAAE;MACrBpB,OAAO,CAACc,KAAK,EAAE;QAAEO,CAAC,EAAET,MAAM,CAACS,CAAC;QAAED,MAAM,EAAER,MAAM,CAACQ;MAAO,CAAC,CAAC;IACxD;IAEA,IAAIV,OAAO,CAACY,UAAU,EAAE;MACtBlB,UAAU,CAACU,KAAK,CAAC,CAACb,MAAM,CAACJ,oBAAoB,CAAC;IAChD,CAAC,MAAM;MACLO,UAAU,CAACU,KAAK,CAAC,CAACS,GAAG,CAAC1B,oBAAoB,CAAC;IAC7C;EACF;;EAEA;AACF;AACA;AACA;AACA;EACE,SAAS2B,WAAWA,CAACd,OAAO,EAAE;IAC5B,IAAIC,KAAK,GAAGD,OAAO,CAACC,KAAK;MACrBG,KAAK,GAAGJ,OAAO,CAACI,KAAK;IAEzB,IAAIA,KAAK,EAAE;MACTZ,SAAS,CAACQ,OAAO,CAACI,KAAK,CAAC;IAC1B;IAEAP,MAAM,CAACkB,YAAY,CAACd,KAAK,EAAEf,eAAe,CAAC;EAC7C;;EAEA;EACAU,QAAQ,CAACoB,EAAE,CAAC,aAAa,EAAE5B,YAAY,EAAE,UAAS6B,KAAK,EAAE;IACvDlB,WAAW,CAACkB,KAAK,CAACjB,OAAO,CAAC;EAC5B,CAAC,CAAC;;EAEF;EACAJ,QAAQ,CAACoB,EAAE,CAAC,gBAAgB,EAAE,UAASC,KAAK,EAAE;IAC5CH,WAAW,CAACG,KAAK,CAACjB,OAAO,CAAC;EAC5B,CAAC,CAAC;AAEJ;AAEAL,aAAa,CAACuB,OAAO,GAAG,CACtB,UAAU,EACV,QAAQ,EACR,gBAAgB,CACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}