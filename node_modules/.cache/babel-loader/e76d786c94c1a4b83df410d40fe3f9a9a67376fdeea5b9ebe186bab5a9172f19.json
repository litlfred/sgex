{"ast":null,"code":"import SnapContext from './SnapContext';\nimport { bottomRight, getChildren, isSnapped, setSnapped, topLeft } from './SnapUtil';\nimport { isCmd } from '../keyboard/KeyboardUtil';\nimport { asTRBL, getMid } from '../../layout/LayoutUtil';\nimport { forEach } from 'min-dash';\nimport { isConnection, isLabel } from '../../util/ModelUtil';\n\n/**\r\n * @typedef {import('../../core/EventBus').default} EventBus\r\n * @typedef {import('./Snapping').default} Snapping\r\n */\n\nvar HIGHER_PRIORITY = 1250;\n\n/**\r\n * Snap during resize.\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\nexport default function ResizeSnapping(eventBus, snapping) {\n  var self = this;\n  eventBus.on(['resize.start'], function (event) {\n    self.initSnap(event);\n  });\n  eventBus.on(['resize.move', 'resize.end'], HIGHER_PRIORITY, function (event) {\n    var context = event.context,\n      shape = context.shape,\n      parent = shape.parent,\n      direction = context.direction,\n      snapContext = context.snapContext;\n    if (event.originalEvent && isCmd(event.originalEvent)) {\n      return;\n    }\n    if (isSnapped(event)) {\n      return;\n    }\n    var snapPoints = snapContext.pointsForTarget(parent);\n    if (!snapPoints.initialized) {\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, parent, direction);\n      snapPoints.initialized = true;\n    }\n    if (isHorizontal(direction)) {\n      setSnapped(event, 'x', event.x);\n    }\n    if (isVertical(direction)) {\n      setSnapped(event, 'y', event.y);\n    }\n    snapping.snap(event, snapPoints);\n  });\n  eventBus.on(['resize.cleanup'], function () {\n    snapping.hide();\n  });\n}\nResizeSnapping.prototype.initSnap = function (event) {\n  var context = event.context,\n    shape = context.shape,\n    direction = context.direction,\n    snapContext = context.snapContext;\n  if (!snapContext) {\n    snapContext = context.snapContext = new SnapContext();\n  }\n  var snapOrigin = getSnapOrigin(shape, direction);\n  snapContext.setSnapOrigin('corner', {\n    x: snapOrigin.x - event.x,\n    y: snapOrigin.y - event.y\n  });\n  return snapContext;\n};\nResizeSnapping.prototype.addSnapTargetPoints = function (snapPoints, shape, target, direction) {\n  var snapTargets = this.getSnapTargets(shape, target);\n  forEach(snapTargets, function (snapTarget) {\n    snapPoints.add('corner', bottomRight(snapTarget));\n    snapPoints.add('corner', topLeft(snapTarget));\n  });\n  snapPoints.add('corner', getSnapOrigin(shape, direction));\n  return snapPoints;\n};\nResizeSnapping.$inject = ['eventBus', 'snapping'];\nResizeSnapping.prototype.getSnapTargets = function (shape, target) {\n  return getChildren(target).filter(function (child) {\n    return !isAttached(child, shape) && !isConnection(child) && !isHidden(child) && !isLabel(child);\n  });\n};\n\n// helpers //////////\n\nfunction getSnapOrigin(shape, direction) {\n  var mid = getMid(shape),\n    trbl = asTRBL(shape);\n  var snapOrigin = {\n    x: mid.x,\n    y: mid.y\n  };\n  if (direction.indexOf('n') !== -1) {\n    snapOrigin.y = trbl.top;\n  } else if (direction.indexOf('s') !== -1) {\n    snapOrigin.y = trbl.bottom;\n  }\n  if (direction.indexOf('e') !== -1) {\n    snapOrigin.x = trbl.right;\n  } else if (direction.indexOf('w') !== -1) {\n    snapOrigin.x = trbl.left;\n  }\n  return snapOrigin;\n}\nfunction isAttached(element, host) {\n  return element.host === host;\n}\nfunction isHidden(element) {\n  return !!element.hidden;\n}\nfunction isHorizontal(direction) {\n  return direction === 'n' || direction === 's';\n}\nfunction isVertical(direction) {\n  return direction === 'e' || direction === 'w';\n}","map":{"version":3,"names":["SnapContext","bottomRight","getChildren","isSnapped","setSnapped","topLeft","isCmd","asTRBL","getMid","forEach","isConnection","isLabel","HIGHER_PRIORITY","ResizeSnapping","eventBus","snapping","self","on","event","initSnap","context","shape","parent","direction","snapContext","originalEvent","snapPoints","pointsForTarget","initialized","addSnapTargetPoints","isHorizontal","x","isVertical","y","snap","hide","prototype","snapOrigin","getSnapOrigin","setSnapOrigin","target","snapTargets","getSnapTargets","snapTarget","add","$inject","filter","child","isAttached","isHidden","mid","trbl","indexOf","top","bottom","right","left","element","host","hidden"],"sources":["/home/runner/work/sgex/sgex/node_modules/diagram-js/lib/features/snapping/ResizeSnapping.js"],"sourcesContent":["import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  bottomRight,\r\n  getChildren,\r\n  isSnapped,\r\n  setSnapped,\r\n  topLeft,\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  asTRBL,\r\n  getMid\r\n} from '../../layout/LayoutUtil';\r\n\r\nimport { forEach } from 'min-dash';\r\n\r\nimport {\r\n  isConnection,\r\n  isLabel\r\n} from '../../util/ModelUtil';\r\n\r\n/**\r\n * @typedef {import('../../core/EventBus').default} EventBus\r\n * @typedef {import('./Snapping').default} Snapping\r\n */\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during resize.\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function ResizeSnapping(eventBus, snapping) {\r\n  var self = this;\r\n\r\n  eventBus.on([ 'resize.start' ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'resize.move',\r\n    'resize.end',\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        parent = shape.parent,\r\n        direction = context.direction,\r\n        snapContext = context.snapContext;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event)) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(parent);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, parent, direction);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    if (isHorizontal(direction)) {\r\n      setSnapped(event, 'x', event.x);\r\n    }\r\n\r\n    if (isVertical(direction)) {\r\n      setSnapped(event, 'y', event.y);\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([ 'resize.cleanup' ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nResizeSnapping.prototype.initSnap = function(event) {\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      direction = context.direction,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var snapOrigin = getSnapOrigin(shape, direction);\r\n\r\n  snapContext.setSnapOrigin('corner', {\r\n    x: snapOrigin.x - event.x,\r\n    y: snapOrigin.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nResizeSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target, direction) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n    snapPoints.add('corner', bottomRight(snapTarget));\r\n    snapPoints.add('corner', topLeft(snapTarget));\r\n  });\r\n\r\n  snapPoints.add('corner', getSnapOrigin(shape, direction));\r\n\r\n  return snapPoints;\r\n};\r\n\r\nResizeSnapping.$inject = [\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nResizeSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isAttached(child, shape)\r\n      && !isConnection(child)\r\n      && !isHidden(child)\r\n      && !isLabel(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction getSnapOrigin(shape, direction) {\r\n  var mid = getMid(shape),\r\n      trbl = asTRBL(shape);\r\n\r\n  var snapOrigin = {\r\n    x: mid.x,\r\n    y: mid.y\r\n  };\r\n\r\n  if (direction.indexOf('n') !== -1) {\r\n    snapOrigin.y = trbl.top;\r\n  } else if (direction.indexOf('s') !== -1) {\r\n    snapOrigin.y = trbl.bottom;\r\n  }\r\n\r\n  if (direction.indexOf('e') !== -1) {\r\n    snapOrigin.x = trbl.right;\r\n  } else if (direction.indexOf('w') !== -1) {\r\n    snapOrigin.x = trbl.left;\r\n  }\r\n\r\n  return snapOrigin;\r\n}\r\n\r\nfunction isAttached(element, host) {\r\n  return element.host === host;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isHorizontal(direction) {\r\n  return direction === 'n' || direction === 's';\r\n}\r\n\r\nfunction isVertical(direction) {\r\n  return direction === 'e' || direction === 'w';\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}