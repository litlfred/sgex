{"ast":null,"code":"import { getLanesRoot } from '../util/LaneUtil';\nimport { is, isAny } from '../../../util/ModelUtil';\n\n/**\r\n * @typedef {import('diagram-js/lib/core/ElementRegistry').default} ElementRegistry\r\n * @typedef {import('diagram-js/lib/core/EventBus').default} EventBus\r\n * @typedef {import('diagram-js/lib/core/Canvas').default} Canvas\r\n */\n\nvar HIGH_PRIORITY = 1500;\nvar HIGHEST_PRIORITY = 2000;\n\n/**\r\n * Correct hover targets in certain situations to improve diagram interaction.\r\n *\r\n * @param {ElementRegistry} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n */\nexport default function FixHoverBehavior(elementRegistry, eventBus, canvas) {\n  eventBus.on(['create.hover', 'create.move', 'create.out', 'create.end', 'shape.move.hover', 'shape.move.move', 'shape.move.out', 'shape.move.end'], HIGH_PRIORITY, function (event) {\n    var context = event.context,\n      shape = context.shape || event.shape,\n      hover = event.hover;\n\n    // ensure elements are not dropped onto a bpmn:Lane but onto\n    // the underlying bpmn:Participant\n    if (is(hover, 'bpmn:Lane') && !isAny(shape, ['bpmn:Lane', 'bpmn:Participant'])) {\n      event.hover = getLanesRoot(hover);\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\n    }\n    var rootElement = canvas.getRootElement();\n\n    // ensure bpmn:Group and label elements are dropped\n    // always onto the root\n    if (hover !== rootElement && (shape.labelTarget || isAny(shape, ['bpmn:Group', 'bpmn:TextAnnotation']))) {\n      event.hover = rootElement;\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\n    }\n  });\n  eventBus.on(['connect.hover', 'connect.out', 'connect.end', 'connect.cleanup', 'global-connect.hover', 'global-connect.out', 'global-connect.end', 'global-connect.cleanup'], HIGH_PRIORITY, function (event) {\n    var hover = event.hover;\n\n    // ensure connections start/end on bpmn:Participant,\n    // not the underlying bpmn:Lane\n    if (is(hover, 'bpmn:Lane')) {\n      event.hover = getLanesRoot(hover) || hover;\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\n    }\n  });\n  eventBus.on(['bendpoint.move.hover'], HIGH_PRIORITY, function (event) {\n    var context = event.context,\n      hover = event.hover,\n      type = context.type;\n\n    // ensure reconnect start/end on bpmn:Participant,\n    // not the underlying bpmn:Lane\n    if (is(hover, 'bpmn:Lane') && /reconnect/.test(type)) {\n      event.hover = getLanesRoot(hover) || hover;\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\n    }\n  });\n  eventBus.on(['connect.start'], HIGH_PRIORITY, function (event) {\n    var context = event.context,\n      start = context.start;\n\n    // ensure connect start on bpmn:Participant,\n    // not the underlying bpmn:Lane\n    if (is(start, 'bpmn:Lane')) {\n      context.start = getLanesRoot(start) || start;\n    }\n  });\n\n  // allow movement of participants from lanes\n  eventBus.on('shape.move.start', HIGHEST_PRIORITY, function (event) {\n    var shape = event.shape;\n    if (is(shape, 'bpmn:Lane')) {\n      event.shape = getLanesRoot(shape) || shape;\n    }\n  });\n\n  // ensure lanes aren't resized without their parent participant when using\n  // space tool\n  eventBus.on('spaceTool.move', HIGHEST_PRIORITY, function (event) {\n    var hover = event.hover;\n    if (hover && is(hover, 'bpmn:Lane')) {\n      event.hover = getLanesRoot(hover);\n    }\n  });\n}\nFixHoverBehavior.$inject = ['elementRegistry', 'eventBus', 'canvas'];","map":{"version":3,"names":["getLanesRoot","is","isAny","HIGH_PRIORITY","HIGHEST_PRIORITY","FixHoverBehavior","elementRegistry","eventBus","canvas","on","event","context","shape","hover","hoverGfx","getGraphics","rootElement","getRootElement","labelTarget","type","test","start","$inject"],"sources":["/home/runner/work/sgex/sgex/node_modules/bpmn-js/lib/features/modeling/behavior/FixHoverBehavior.js"],"sourcesContent":["import { getLanesRoot } from '../util/LaneUtil';\r\n\r\nimport { is, isAny } from '../../../util/ModelUtil';\r\n\r\n/**\r\n * @typedef {import('diagram-js/lib/core/ElementRegistry').default} ElementRegistry\r\n * @typedef {import('diagram-js/lib/core/EventBus').default} EventBus\r\n * @typedef {import('diagram-js/lib/core/Canvas').default} Canvas\r\n */\r\n\r\nvar HIGH_PRIORITY = 1500;\r\nvar HIGHEST_PRIORITY = 2000;\r\n\r\n\r\n/**\r\n * Correct hover targets in certain situations to improve diagram interaction.\r\n *\r\n * @param {ElementRegistry} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n */\r\nexport default function FixHoverBehavior(elementRegistry, eventBus, canvas) {\r\n\r\n  eventBus.on([\r\n    'create.hover',\r\n    'create.move',\r\n    'create.out',\r\n    'create.end',\r\n    'shape.move.hover',\r\n    'shape.move.move',\r\n    'shape.move.out',\r\n    'shape.move.end'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape || event.shape,\r\n        hover = event.hover;\r\n\r\n    // ensure elements are not dropped onto a bpmn:Lane but onto\r\n    // the underlying bpmn:Participant\r\n    if (is(hover, 'bpmn:Lane') && !isAny(shape, [ 'bpmn:Lane', 'bpmn:Participant' ])) {\r\n      event.hover = getLanesRoot(hover);\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n\r\n    var rootElement = canvas.getRootElement();\r\n\r\n    // ensure bpmn:Group and label elements are dropped\r\n    // always onto the root\r\n    if (hover !== rootElement && (shape.labelTarget || isAny(shape, [ 'bpmn:Group', 'bpmn:TextAnnotation' ]))) {\r\n      event.hover = rootElement;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n  eventBus.on([\r\n    'connect.hover',\r\n    'connect.out',\r\n    'connect.end',\r\n    'connect.cleanup',\r\n    'global-connect.hover',\r\n    'global-connect.out',\r\n    'global-connect.end',\r\n    'global-connect.cleanup'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var hover = event.hover;\r\n\r\n    // ensure connections start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane')) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'bendpoint.move.hover'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        hover = event.hover,\r\n        type = context.type;\r\n\r\n    // ensure reconnect start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane') && /reconnect/.test(type)) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'connect.start'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        start = context.start;\r\n\r\n    // ensure connect start on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(start, 'bpmn:Lane')) {\r\n      context.start = getLanesRoot(start) || start;\r\n    }\r\n  });\r\n\r\n\r\n  // allow movement of participants from lanes\r\n  eventBus.on('shape.move.start', HIGHEST_PRIORITY, function(event) {\r\n    var shape = event.shape;\r\n\r\n    if (is(shape, 'bpmn:Lane')) {\r\n      event.shape = getLanesRoot(shape) || shape;\r\n    }\r\n  });\r\n\r\n  // ensure lanes aren't resized without their parent participant when using\r\n  // space tool\r\n  eventBus.on('spaceTool.move', HIGHEST_PRIORITY, function(event) {\r\n    var hover = event.hover;\r\n\r\n    if (hover && is(hover, 'bpmn:Lane')) {\r\n      event.hover = getLanesRoot(hover);\r\n    }\r\n  });\r\n\r\n}\r\n\r\nFixHoverBehavior.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas'\r\n];"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}