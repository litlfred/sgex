{"ast":null,"code":"import _objectSpread from\"/home/runner/work/sgex/sgex/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{Octokit}from'@octokit/rest';import{processConcurrently}from'../utils/concurrency';import repositoryCompatibilityCache from'../utils/repositoryCompatibilityCache';import secureTokenStorage from'./secureTokenStorage';import logger from'../utils/logger';class GitHubService{constructor(){this.octokit=null;this.isAuthenticated=false;this.permissions=null;this.tokenType=null;// 'classic', 'fine-grained', or 'oauth'\nthis.logger=logger.getLogger('GitHubService');this.logger.debug('GitHubService instance created');}// Initialize with a GitHub token (supports both OAuth and PAT tokens)\nauthenticate(token){const startTime=Date.now();this.logger.auth('Starting authentication',{tokenProvided:!!token,tokenMask:token?secureTokenStorage.maskToken(token):'none'});try{// Validate token format using SecureTokenStorage\nconst validation=secureTokenStorage.validateTokenFormat(token);if(!validation.isValid){this.logger.warn('Token validation failed during authentication',{reason:validation.reason,tokenMask:secureTokenStorage.maskToken(token)});this.isAuthenticated=false;return false;}this.octokit=new Octokit({auth:validation.token});this.isAuthenticated=true;this.tokenType=validation.type;// Store token securely\nconst stored=secureTokenStorage.storeToken(validation.token);if(!stored){this.logger.warn('Failed to store token securely, authentication will not persist');}const duration=Date.now()-startTime;this.logger.auth('Authentication successful',{duration,tokenType:this.tokenType,tokenMask:secureTokenStorage.maskToken(token),securelyStored:stored});this.logger.performance('GitHub authentication',duration);return true;}catch(error){const duration=Date.now()-startTime;this.logger.auth('Authentication failed',{error:error.message,duration,tokenMask:secureTokenStorage.maskToken(token)});console.error('Failed to authenticate with GitHub:',error);this.isAuthenticated=false;secureTokenStorage.clearToken();// Clear any partially stored data\nreturn false;}}// Initialize with an existing Octokit instance (for OAuth flow)\nauthenticateWithOctokit(octokitInstance){this.logger.auth('Starting OAuth authentication with Octokit instance');try{this.octokit=octokitInstance;this.isAuthenticated=true;this.tokenType='oauth';this.logger.auth('OAuth authentication successful',{tokenType:this.tokenType});return true;}catch(error){this.logger.auth('OAuth authentication failed',{error:error.message});console.error('Failed to authenticate with Octokit instance:',error);this.isAuthenticated=false;return false;}}// Initialize authentication from securely stored token\ninitializeFromStoredToken(){this.logger.auth('Attempting to initialize from stored token');try{// First try to migrate any legacy tokens\nconst migrated=secureTokenStorage.migrateLegacyToken();if(migrated){this.logger.debug('Successfully migrated legacy token to secure storage');}// Retrieve token from secure storage\nconst tokenData=secureTokenStorage.retrieveToken();if(!tokenData){this.logger.debug('No valid stored token found');return false;}// Initialize Octokit with stored token\nthis.octokit=new Octokit({auth:tokenData.token});this.isAuthenticated=true;this.tokenType=tokenData.type;this.logger.auth('Successfully initialized from stored token',{tokenType:this.tokenType,tokenMask:secureTokenStorage.maskToken(tokenData.token),expires:new Date(tokenData.expires).toISOString()});return true;}catch(error){this.logger.auth('Failed to initialize from stored token',{error:error.message});this.isAuthenticated=false;secureTokenStorage.clearToken();return false;}}// Check if there's a valid stored token\nhasStoredToken(){return secureTokenStorage.hasValidToken();}// Get information about stored token\ngetStoredTokenInfo(){return secureTokenStorage.getTokenInfo();}// Check token permissions and type\nasync checkTokenPermissions(){if(!this.isAuth()){const error=new Error('Not authenticated with GitHub');this.logger.error('Token permission check failed - not authenticated');throw error;}const startTime=Date.now();this.logger.apiCall('GET','/user',null);try{// Try to get token info to determine type and permissions\nconst response=await this.octokit.request('GET /user');this.logger.apiResponse('GET','/user',response.status,Date.now()-startTime);// Check if this is a fine-grained token by trying to access rate limit info\ntry{const rateLimitStart=Date.now();this.logger.apiCall('GET','/rate_limit',null);const rateLimit=await this.octokit.rest.rateLimit.get();this.logger.apiResponse('GET','/rate_limit',rateLimit.status,Date.now()-rateLimitStart);// Fine-grained tokens have different rate limit structure\nthis.tokenType=rateLimit.data.resources.core?'classic':'fine-grained';this.logger.debug('Token type determined',{tokenType:this.tokenType,hasCore:!!rateLimit.data.resources.core});}catch(rateLimitError){this.tokenType='unknown';this.logger.warn('Could not determine token type from rate limit',{error:rateLimitError.message});}const permissions={type:this.tokenType,user:response.data};this.permissions=permissions;this.logger.debug('Token permissions checked successfully',{tokenType:this.tokenType,username:response.data.login});return permissions;}catch(error){const duration=Date.now()-startTime;this.logger.apiError('GET','/user',error);this.logger.performance('Token permission check (failed)',duration);console.error('Failed to check token permissions:',error);throw error;}}// Check if we have write permissions for a specific repository\nasync checkRepositoryWritePermissions(owner,repo){if(!this.isAuth()){this.logger.warn('Cannot check repository write permissions - not authenticated',{owner,repo});return false;}const startTime=Date.now();this.logger.debug('Checking write permissions for repository',{owner,repo});try{// Get current user first\nconst currentUser=await this.getCurrentUser();const username=currentUser.login;this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/collaborators/\").concat(username,\"/permission\"),null);// Try to get repository collaborator permissions\nconst{data}=await this.octokit.rest.repos.getCollaboratorPermissionLevel({owner,repo,username});const duration=Date.now()-startTime;this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/collaborators/\").concat(username,\"/permission\"),200,duration);const hasWriteAccess=['write','admin'].includes(data.permission);this.logger.debug('Repository write permissions checked',{owner,repo,permission:data.permission,hasWriteAccess});return hasWriteAccess;}catch(error){const duration=Date.now()-startTime;this.logger.apiError('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/collaborators/*/permission\"),error);this.logger.performance('Repository write permission check (failed)',duration);// If we can't check permissions, assume we don't have write access\nconsole.warn('Could not check repository write permissions:',error);this.logger.warn('Assuming no write access due to permission check failure',{owner,repo,error:error.message});return false;}}// Alias method for backward compatibility - delegates to checkRepositoryWritePermissions\nasync checkRepositoryPermissions(owner,repo){return this.checkRepositoryWritePermissions(owner,repo);}// Check if authenticated\nisAuth(){return this.isAuthenticated&&this.octokit!==null;}// Get current user data\nasync getCurrentUser(){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.users.getAuthenticated();return data;}catch(error){console.error('Failed to fetch user data:',error);throw error;}}// Get user's organizations\nasync getUserOrganizations(){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.orgs.listForAuthenticatedUser();return data;}catch(error){console.error('Failed to fetch organizations:',error);throw error;}}// Get specific organization data (public data, no auth required)\nasync getOrganization(orgLogin){try{// Create a temporary Octokit instance for public API calls if we don't have one\nconst octokit=this.octokit||new Octokit();const{data}=await octokit.rest.orgs.get({org:orgLogin});return data;}catch(error){console.error(\"Failed to fetch organization \".concat(orgLogin,\":\"),error);throw error;}}// Get specific user data (public data, no auth required)\nasync getUser(username){try{// Create a temporary Octokit instance for public API calls if we don't have one\nconst octokit=this.octokit||new Octokit();const{data}=await octokit.rest.users.getByUsername({username});return data;}catch(error){console.error(\"Failed to fetch user \".concat(username,\":\"),error);throw error;}}// Get WHO organization data with fresh avatar\nasync getWHOOrganization(){try{const whoData=await this.getOrganization('WorldHealthOrganization');return{id:whoData.id,login:whoData.login,display_name:whoData.name||'World Health Organization',description:whoData.description||'The World Health Organization is a specialized agency of the United Nations responsible for international public health.',avatar_url:whoData.avatar_url,html_url:whoData.html_url,type:'Organization',permissions:{can_create_repositories:true,can_create_private_repositories:true},plan:{name:'Organization',private_repos:'unlimited'},isWHO:true};}catch(error){console.warn('Could not fetch WHO organization data from API, using fallback:',error);// Return hardcoded fallback data\nreturn{id:'who-organization',login:'WorldHealthOrganization',display_name:'World Health Organization',description:'The World Health Organization is a specialized agency of the United Nations responsible for international public health.',avatar_url:'https://avatars.githubusercontent.com/u/12261302?s=200&v=4',html_url:'https://github.com/WorldHealthOrganization',type:'Organization',permissions:{can_create_repositories:true,can_create_private_repositories:true},plan:{name:'Organization',private_repos:'unlimited'},isWHO:true};}}// Get repositories for a user or organization (now filters by SMART Guidelines compatibility)\nasync getRepositories(owner){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'user';let isDemo=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;// Handle demo mode - return demo repositories without requiring authentication\nif(isDemo||owner==='demo-user'){return this.getDemoRepositories(owner);}// Use the new SMART guidelines filtering method\nreturn this.getSmartGuidelinesRepositories(owner,type);}// Get demo repositories for demo mode (no authentication required)\ngetDemoRepositories(owner){const demoRepos=[{id:'demo-smart-anc',name:'smart-anc',full_name:\"\".concat(owner,\"/smart-anc\"),description:'Demo SMART Guidelines Digital Adaptation Kit for Antenatal Care',private:false,owner:{login:owner,id:'demo-owner',avatar_url:\"https://github.com/\".concat(owner,\".png\"),type:'User'},html_url:\"https://github.com/\".concat(owner,\"/smart-anc\"),clone_url:\"https://github.com/\".concat(owner,\"/smart-anc.git\"),language:'FSH',stargazers_count:15,forks_count:3,open_issues_count:2,topics:['who','smart-guidelines','dak','antenatal-care','health'],created_at:'2023-01-15T10:00:00Z',updated_at:'2024-12-15T14:30:00Z',pushed_at:'2024-12-15T14:30:00Z',default_branch:'main',smart_guidelines_compatible:true,isDemo:true},{id:'demo-smart-tb',name:'smart-tb',full_name:\"\".concat(owner,\"/smart-tb\"),description:'Demo SMART Guidelines Digital Adaptation Kit for Tuberculosis Care',private:false,owner:{login:owner,id:'demo-owner',avatar_url:\"https://github.com/\".concat(owner,\".png\"),type:'User'},html_url:\"https://github.com/\".concat(owner,\"/smart-tb\"),clone_url:\"https://github.com/\".concat(owner,\"/smart-tb.git\"),language:'FSH',stargazers_count:8,forks_count:1,open_issues_count:0,topics:['who','smart-guidelines','dak','tuberculosis','health'],created_at:'2023-03-20T15:00:00Z',updated_at:'2024-11-30T09:15:00Z',pushed_at:'2024-11-30T09:15:00Z',default_branch:'main',smart_guidelines_compatible:true,isDemo:true},{id:'demo-smart-ips-pilgrimage',name:'smart-ips-pilgrimage',full_name:\"\".concat(owner,\"/smart-ips-pilgrimage\"),description:'Demo SMART Guidelines International Patient Summary for Pilgrimage',private:false,owner:{login:owner,id:'demo-owner',avatar_url:\"https://github.com/\".concat(owner,\".png\"),type:'User'},html_url:\"https://github.com/\".concat(owner,\"/smart-ips-pilgrimage\"),clone_url:\"https://github.com/\".concat(owner,\"/smart-ips-pilgrimage.git\"),language:'FSH',stargazers_count:12,forks_count:2,open_issues_count:1,topics:['who','smart-guidelines','dak','ips','pilgrimage','health'],created_at:'2023-06-10T12:00:00Z',updated_at:'2024-12-01T16:45:00Z',pushed_at:'2024-12-01T16:45:00Z',default_branch:'main',smart_guidelines_compatible:true,isDemo:true}];return Promise.resolve(demoRepos);}// Check if a repository has sushi-config.yaml with smart.who.int.base dependency\nasync checkSmartGuidelinesCompatibility(owner,repo){let retryCount=arguments.length>2&&arguments[2]!==undefined?arguments[2]:2;if(!this.isAuth()){return{compatible:false,error:'Not authenticated'};}// Check cache first to prevent redundant downloads\nconst cachedResult=repositoryCompatibilityCache.get(owner,repo);if(cachedResult!==null){return{compatible:cachedResult,cached:true};}try{// Try to get sushi-config.yaml from the repository root\nconst{data}=await this.octokit.rest.repos.getContent({owner,repo,path:'sushi-config.yaml'});if(data.type==='file'&&data.content){// Decode base64 content (browser-compatible)\nconst content=decodeURIComponent(escape(atob(data.content)));// Check if the content contains smart.who.int.base in dependencies\nconst isCompatible=content.includes('smart.who.int.base');// Cache the result\nrepositoryCompatibilityCache.set(owner,repo,isCompatible);return{compatible:isCompatible};}// Cache negative result\nrepositoryCompatibilityCache.set(owner,repo,false);return{compatible:false,reason:'No sushi-config.yaml file found'};}catch(error){// If it's a 404 (file not found), retry once more in case of temporary issues\nif(error.status===404&&retryCount>0){console.warn(\"File not found for \".concat(owner,\"/\").concat(repo,\", retrying... (\").concat(retryCount,\" attempts left)\"));// Use shorter delay in test environment\nconst delay=process.env.NODE_ENV==='test'?10:1000;await new Promise(resolve=>setTimeout(resolve,delay));return this.checkSmartGuidelinesCompatibility(owner,repo,retryCount-1);}// For any error (including rate limiting, network errors, or file not found after retries),\n// return error information instead of just logging\nconst errorInfo={compatible:false,error:error.message,errorType:this._categorizeError(error),status:error.status,retryable:this._isRetryableError(error)};console.warn(\"Failed to check \".concat(owner,\"/\").concat(repo,\" for sushi-config.yaml with smart.who.int.base dependency:\"),error.message);// Cache negative result\nrepositoryCompatibilityCache.set(owner,repo,false);return errorInfo;}}// Helper method to categorize errors\n_categorizeError(error){if(error.status===403){if(error.message.includes('rate limit')){return'rate_limit';}return'permission_denied';}if(error.status===404){return'not_found';}if(error.status===401){return'authentication_failed';}if(error.code==='ENOTFOUND'||error.code==='ECONNRESET'){return'network_error';}return'unknown_error';}// Helper method to determine if error is retryable\n_isRetryableError(error){return['rate_limit','network_error'].includes(this._categorizeError(error));}// Get repositories that are SMART guidelines compatible\nasync getSmartGuidelinesRepositories(owner){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'user';if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{let repositories=[];let page=1;let hasMorePages=true;// Fetch all repositories using pagination\nwhile(hasMorePages){let response;if(type==='user'){response=await this.octokit.rest.repos.listForUser({username:owner,sort:'updated',per_page:100,page:page});}else{response=await this.octokit.rest.repos.listForOrg({org:owner,sort:'updated',per_page:100,page:page});}repositories=repositories.concat(response.data);// Check if there are more pages\nhasMorePages=response.data.length===100;page++;}// Check each repository for SMART guidelines compatibility\nconst smartGuidelinesRepos=[];for(const repo of repositories){const compatibilityResult=await this.checkSmartGuidelinesCompatibility(repo.owner.login,repo.name);if(compatibilityResult.compatible){smartGuidelinesRepos.push(_objectSpread(_objectSpread({},repo),{},{smart_guidelines_compatible:true}));}}return smartGuidelinesRepos;}catch(error){console.error('Failed to fetch SMART guidelines repositories:',error);throw error;}}// Get repositories with progressive scanning (for real-time updates)\nasync getSmartGuidelinesRepositoriesProgressive(owner){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'user';let onRepositoryFound=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;let onProgress=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;let onError=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{let repositories=[];let page=1;let hasMorePages=true;// Fetch all repositories using pagination\nwhile(hasMorePages){let response;if(type==='user'){response=await this.octokit.rest.repos.listForUser({username:owner,sort:'updated',per_page:100,page:page});}else{response=await this.octokit.rest.repos.listForOrg({org:owner,sort:'updated',per_page:100,page:page});}repositories=repositories.concat(response.data);// Check if there are more pages\nhasMorePages=response.data.length===100;page++;}// Handle case where user has no repositories\nif(repositories.length===0){console.log('📊 No repositories found for user, completing scan immediately');// Call progress callback to indicate completion\nif(onProgress){onProgress({current:0,total:0,currentRepo:'none',progress:100,completed:true});}return[];}// Track scanning errors for reporting\nconst scanningErrors={rateLimited:[],networkErrors:[],permissionDenied:[],otherErrors:[],totalErrors:0,totalScanned:0};// Process repositories concurrently with rate limiting and enhanced display\nconst processor=async(repo,index)=>{// Add a small delay to make scanning progress visible (similar to demo mode)\nawait new Promise(resolve=>setTimeout(resolve,100+Math.random()*200));const compatibilityResult=await this.checkSmartGuidelinesCompatibility(repo.owner.login,repo.name);scanningErrors.totalScanned++;// Handle the new return format\nif(compatibilityResult.compatible){const smartRepo=_objectSpread(_objectSpread({},repo),{},{smart_guidelines_compatible:true});// Notify that a repository was found\nif(onRepositoryFound){onRepositoryFound(smartRepo);}return smartRepo;}else if(compatibilityResult.error){// Track the error for reporting\nscanningErrors.totalErrors++;const errorInfo={repo:repo.name,error:compatibilityResult.error,errorType:compatibilityResult.errorType,retryable:compatibilityResult.retryable};switch(compatibilityResult.errorType){case'rate_limit':scanningErrors.rateLimited.push(errorInfo);break;case'network_error':scanningErrors.networkErrors.push(errorInfo);break;case'permission_denied':scanningErrors.permissionDenied.push(errorInfo);break;default:scanningErrors.otherErrors.push(errorInfo);}// Report error if callback provided\nif(onError){onError(errorInfo);}}return null;};// Use concurrent processing with max 5 parallel requests\nconst results=await processConcurrently(repositories,processor,{concurrency:5,onProgress:(completed,total,repo,result)=>{// Progress callback for completed items\nif(onProgress){const progressData={current:completed,total:total,currentRepo:repo.name,progress:Math.round(completed/total*100),completed:true,scanningErrors:scanningErrors.totalErrors>0?{totalErrors:scanningErrors.totalErrors,rateLimitedCount:scanningErrors.rateLimited.length,networkErrorCount:scanningErrors.networkErrors.length,hasRetryableErrors:[...scanningErrors.rateLimited,...scanningErrors.networkErrors].some(e=>e.retryable)}:null};onProgress(progressData);}},onItemStart:(repo,index)=>{// Progress callback for started items\nif(onProgress){onProgress({current:index+1,total:repositories.length,currentRepo:repo.name,progress:Math.round((index+1)/repositories.length*100),completed:false,started:true});}}});// Filter out null results and collect smart repositories\nconst validResults=results.filter(result=>result!==null&&!result.error);// Log summary of scanning results\nif(scanningErrors.totalErrors>0){console.warn(\"Repository scanning completed with \".concat(scanningErrors.totalErrors,\" errors out of \").concat(scanningErrors.totalScanned,\" repositories checked:\"));if(scanningErrors.rateLimited.length>0){console.warn(\"- Rate limited: \".concat(scanningErrors.rateLimited.length,\" repositories\"));}if(scanningErrors.networkErrors.length>0){console.warn(\"- Network errors: \".concat(scanningErrors.networkErrors.length,\" repositories\"));}if(scanningErrors.permissionDenied.length>0){console.warn(\"- Permission denied: \".concat(scanningErrors.permissionDenied.length,\" repositories\"));}if(scanningErrors.otherErrors.length>0){console.warn(\"- Other errors: \".concat(scanningErrors.otherErrors.length,\" repositories\"));}}// Return results along with error summary\nreturn{repositories:validResults,scanningErrors:scanningErrors.totalErrors>0?scanningErrors:null};}catch(error){console.error('Failed to fetch SMART guidelines repositories:',error);throw error;}}// Get a specific repository\nasync getRepository(owner,repo){try{// Use authenticated octokit if available, otherwise create a public instance for public repos\nconst octokit=this.isAuth()?this.octokit:new Octokit();const{data}=await octokit.rest.repos.get({owner,repo});return data;}catch(error){console.error('Failed to fetch repository:',error);throw error;}}// Get repository branches\nasync getBranches(owner,repo){try{console.log(\"githubService.getBranches: Fetching branches for \".concat(owner,\"/\").concat(repo));console.log('githubService.getBranches: Authentication status:',this.isAuth());// Use authenticated octokit if available, otherwise create a public instance for public repos\nconst octokit=this.isAuth()?this.octokit:new Octokit();console.log('githubService.getBranches: Using',this.isAuth()?'authenticated':'public','octokit instance');const{data}=await octokit.rest.repos.listBranches({owner,repo,per_page:100});console.log(\"githubService.getBranches: Successfully fetched \".concat(data.length,\" branches\"));return data;}catch(error){console.error('githubService.getBranches: Failed to fetch branches:',error);console.error('githubService.getBranches: Error details:',{status:error.status,message:error.message,owner,repo});throw error;}}// Create a new branch\nasync createBranch(owner,repo,branchName){let fromBranch=arguments.length>3&&arguments[3]!==undefined?arguments[3]:'main';if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{// First get the SHA of the source branch\nconst{data:refData}=await this.octokit.rest.git.getRef({owner,repo,ref:\"heads/\".concat(fromBranch)});// Create the new branch\nconst{data}=await this.octokit.rest.git.createRef({owner,repo,ref:\"refs/heads/\".concat(branchName),sha:refData.object.sha});return data;}catch(error){console.error('Failed to create branch:',error);throw error;}}// Get a specific branch\nasync getBranch(owner,repo,branch){try{// Use authenticated octokit if available, otherwise create a public instance for public repos\nconst octokit=this.isAuth()?this.octokit:new Octokit();const{data}=await octokit.rest.repos.getBranch({owner,repo,branch});return data;}catch(error){console.error('Failed to fetch branch:',error);throw error;}}// GitHub Actions API methods\n// Get workflows for a repository (using GitHub API to include workflow IDs)\nasync getWorkflows(owner,repo){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{// Use GitHub Actions API to get workflows with their IDs\nconst{data}=await this.octokit.rest.actions.listRepoWorkflows({owner,repo});return data.workflows.map(workflow=>({id:workflow.id,// This is the crucial missing piece!\nname:workflow.name,filename:workflow.path.split('/').pop(),// Extract filename from path\npath:workflow.path,state:workflow.state,created_at:workflow.created_at,updated_at:workflow.updated_at,url:workflow.html_url,triggers:['unknown'],// GitHub API doesn't provide trigger info directly\nlastModified:workflow.updated_at}));}catch(error){if(error.status===404){// No workflows or repository not found\nreturn[];}console.error('Failed to fetch workflows:',error);throw error;}}// Get workflow runs for a repository\nasync getWorkflowRuns(owner,repo){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const params={owner,repo,per_page:options.per_page||10,page:options.page||1};if(options.branch){params.branch=options.branch;}if(options.workflow_id){params.workflow_id=options.workflow_id;}const{data}=await this.octokit.rest.actions.listWorkflowRunsForRepo(params);return data;}catch(error){console.error('Failed to fetch workflow runs:',error);throw error;}}// Get workflow runs for a specific workflow\nasync getWorkflowRunsForWorkflow(owner,repo,workflow_id){let options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const params={owner,repo,workflow_id,per_page:options.per_page||10,page:options.page||1};if(options.branch){params.branch=options.branch;}const{data}=await this.octokit.rest.actions.listWorkflowRuns(params);return data;}catch(error){console.error('Failed to fetch workflow runs for workflow:',error);throw error;}}// Trigger a workflow run\nasync triggerWorkflow(owner,repo,workflow_id){let ref=arguments.length>3&&arguments[3]!==undefined?arguments[3]:'main';let inputs=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.actions.createWorkflowDispatch({owner,repo,workflow_id,ref,inputs});return data;}catch(error){console.error('Failed to trigger workflow:',error);throw error;}}// Re-run a workflow\nasync rerunWorkflow(owner,repo,run_id){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.actions.reRunWorkflow({owner,repo,run_id});return data;}catch(error){console.error('Failed to re-run workflow:',error);throw error;}}// Get workflow run logs\nasync getWorkflowRunLogs(owner,repo,run_id){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.actions.downloadWorkflowRunLogs({owner,repo,run_id});return data;}catch(error){console.error('Failed to get workflow run logs:',error);throw error;}}// Approve a workflow run\nasync approveWorkflowRun(owner,repo,run_id){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.actions.approveWorkflowRun({owner,repo,run_id});return data;}catch(error){console.error('Failed to approve workflow run:',error);throw error;}}// Get commit comparison (diff)\nasync getCommitDiff(owner,repo,base,head){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.repos.compareCommits({owner,repo,base,head});return data;}catch(error){console.error('Failed to get commit diff:',error);throw error;}}// Get commit details\nasync getCommit(owner,repo,sha){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.repos.getCommit({owner,repo,ref:sha});return data;}catch(error){console.error('Failed to get commit details:',error);throw error;}}// Releases API methods\n// Get releases for a repository\nasync getReleases(owner,repo){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.repos.listReleases({owner,repo,per_page:options.per_page||10,page:options.page||1});return data;}catch(error){console.error('Failed to fetch releases:',error);throw error;}}// Get latest release\nasync getLatestRelease(owner,repo){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const{data}=await this.octokit.rest.repos.getLatestRelease({owner,repo});return data;}catch(error){console.error('Failed to fetch latest release:',error);throw error;}}// Recursively fetch BPMN files from a directory and its subdirectories\nasync getBpmnFilesRecursive(owner,repo,path){let ref=arguments.length>3&&arguments[3]!==undefined?arguments[3]:'main';let allFiles=arguments.length>4&&arguments[4]!==undefined?arguments[4]:[];try{console.log(\"\\uD83D\\uDD0E githubService.getBpmnFilesRecursive: Searching \".concat(owner,\"/\").concat(repo,\"/\").concat(path,\" (ref: \").concat(ref,\")\"));// Use authenticated octokit if available, otherwise create a public instance\nconst octokit=this.isAuth()?this.octokit:new Octokit();console.log(\"\\uD83D\\uDD10 githubService.getBpmnFilesRecursive: Using \".concat(this.isAuth()?'authenticated':'public',\" octokit\"));const{data}=await octokit.rest.repos.getContent({owner,repo,path,ref});console.log(\"\\uD83D\\uDCE6 githubService.getBpmnFilesRecursive: Received data type: \".concat(Array.isArray(data)?'array':'single file',\", length: \").concat(Array.isArray(data)?data.length:1));// Handle single file response\nif(!Array.isArray(data)){if(data.name.endsWith('.bpmn')){console.log(\"\\uD83D\\uDCC4 githubService.getBpmnFilesRecursive: Found single BPMN file: \".concat(data.name));allFiles.push(data);}return allFiles;}// Handle directory response\nfor(const item of data){if(item.type==='file'&&item.name.endsWith('.bpmn')){console.log(\"\\uD83D\\uDCC4 githubService.getBpmnFilesRecursive: Found BPMN file: \".concat(item.name));allFiles.push(item);}else if(item.type==='dir'){console.log(\"\\uD83D\\uDCC1 githubService.getBpmnFilesRecursive: Found subdirectory: \".concat(item.name,\", recursing...\"));// Recursively search subdirectories\nawait this.getBpmnFilesRecursive(owner,repo,item.path,ref,allFiles);}}console.log(\"\\u2705 githubService.getBpmnFilesRecursive: Completed search of \".concat(path,\", found \").concat(allFiles.length,\" total files so far\"));return allFiles;}catch(error){console.log(\"\\u274C githubService.getBpmnFilesRecursive: Error searching \".concat(path,\":\"),error.status,error.message);// If directory doesn't exist, return empty array (not an error)\nif(error.status===404){return allFiles;}throw error;}}// Get all BPMN files from a repository's business process directories\nasync getBpmnFiles(owner,repo){let ref=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'main';console.log(\"\\uD83D\\uDD0D githubService.getBpmnFiles: Starting search for \".concat(owner,\"/\").concat(repo,\" (ref: \").concat(ref,\")\"));const allBpmnFiles=[];// Search for BPMN files in the specified business process directories\nconst possiblePaths=['input/business-processes','input/business-process'];for(const path of possiblePaths){try{console.log(\"\\uD83D\\uDCC1 githubService.getBpmnFiles: Searching in directory: \".concat(path));const files=await this.getBpmnFilesRecursive(owner,repo,path,ref);console.log(\"\\u2705 githubService.getBpmnFiles: Found \".concat(files.length,\" BPMN files in \").concat(path));allBpmnFiles.push(...files);}catch(error){// Only log warnings for unexpected errors (not 404s which are expected when directories don't exist)\nif(error.status!==404){console.warn(\"\\u274C Could not fetch BPMN files from \".concat(path,\":\"),error.message);}else{console.log(\"\\uD83D\\uDCC2 githubService.getBpmnFiles: Directory \".concat(path,\" not found (404) - this is expected if the directory doesn't exist\"));}// Continue trying other paths\n}}// Remove duplicates based on path (in case both directories exist and have overlapping files)\nconst uniqueFiles=allBpmnFiles.filter((file,index,self)=>index===self.findIndex(f=>f.path===file.path));console.log(\"\\uD83C\\uDFAF githubService.getBpmnFiles: Final result - \".concat(uniqueFiles.length,\" unique BPMN files found\"));console.log(\"\\uD83D\\uDCCB githubService.getBpmnFiles: File list:\",uniqueFiles.map(f=>f.name));return uniqueFiles;}// Get file content from GitHub repository with timeout handling\nasync getFileContent(owner,repo,path){let ref=arguments.length>3&&arguments[3]!==undefined?arguments[3]:'main';const timeoutMs=15000;// 15 second timeout\ntry{console.log(\"\\uD83D\\uDE80 githubService.getFileContent: Starting request for \".concat(owner,\"/\").concat(repo,\"/\").concat(path,\" (ref: \").concat(ref,\")\"));console.log('🔐 githubService.getFileContent: Authentication status:',this.isAuth());console.log('📋 githubService.getFileContent: Request parameters:',{owner,repo,path,ref});// Use authenticated octokit if available, otherwise create a public instance for public repos\nconst octokit=this.isAuth()?this.octokit:new Octokit();console.log('🔧 githubService.getFileContent: Using',this.isAuth()?'authenticated':'public','octokit instance');// Create a promise that rejects after timeout\nconst timeoutPromise=new Promise((_,reject)=>{console.log(\"\\u23F0 githubService.getFileContent: Setting up \".concat(timeoutMs,\"ms timeout\"));setTimeout(()=>{console.error(\"\\u23F0 githubService.getFileContent: Request timed out after \".concat(timeoutMs,\"ms\"));reject(new Error(\"Request timeout after \".concat(timeoutMs,\"ms\")));},timeoutMs);});// Race the GitHub API call against the timeout\nconsole.log('🌐 githubService.getFileContent: Creating GitHub API promise...');const apiPromise=octokit.rest.repos.getContent({owner,repo,path,ref});console.log('📡 githubService.getFileContent: API request initiated, waiting for response...');const startTime=Date.now();const{data}=await Promise.race([apiPromise,timeoutPromise]);const responseTime=Date.now()-startTime;console.log(\"\\u2705 githubService.getFileContent: API response received in \".concat(responseTime,\"ms\"));console.log('📂 githubService.getFileContent: Response data type:',data.type);console.log('📊 githubService.getFileContent: Response details:',{type:data.type,name:data.name,size:data.size,encoding:data.encoding,hasContent:!!data.content});// Handle file content\nif(data.type==='file'&&data.content){// Decode base64 content\nconsole.log('🔧 githubService.getFileContent: Decoding base64 content...');console.log('📊 githubService.getFileContent: Base64 content length:',data.content.length);const content=decodeURIComponent(escape(atob(data.content)));console.log(\"\\u2705 githubService.getFileContent: Successfully fetched and decoded file content\");console.log('📏 githubService.getFileContent: Final content length:',content.length,'characters');console.log('👀 githubService.getFileContent: Content preview (first 200 chars):',content.substring(0,200));return content;}else{console.error('❌ githubService.getFileContent: Invalid response - not a file or no content');console.error('🔍 githubService.getFileContent: Full response data:',JSON.stringify(data,null,2));throw new Error('File not found or is not a file');}}catch(error){var _error$stack;console.error(\"\\uD83D\\uDCA5 githubService.getFileContent: Failed to fetch file content from \".concat(owner,\"/\").concat(repo,\"/\").concat(path,\":\"),error);console.error('🔍 githubService.getFileContent: Error analysis:',{type:typeof error,status:error.status,message:error.message,name:error.name,stack:((_error$stack=error.stack)===null||_error$stack===void 0?void 0:_error$stack.substring(0,500))+'...'});// Provide more specific error messages\nif(error.message.includes('timeout')){console.error('⏰ githubService.getFileContent: Timeout error detected');throw new Error(\"GitHub API request timed out after \".concat(timeoutMs/1000,\" seconds. Please try again.\"));}else if(error.status===403){console.error('🔒 githubService.getFileContent: 403 Forbidden error detected');throw new Error('Access denied. This repository may be private or you may have hit rate limits.');}else if(error.status===404){console.error('🔍 githubService.getFileContent: 404 Not Found error detected');throw new Error('File not found in the repository.');}else if(error.message.includes('rate limit')){console.error('🚦 githubService.getFileContent: Rate limit error detected');throw new Error('GitHub API rate limit exceeded. Please try again later.');}else if(error.message.includes('Network Error')||error.message.includes('Failed to fetch')){console.error('🌐 githubService.getFileContent: Network error detected');throw new Error('Network error occurred. Please check your internet connection and try again.');}console.error('❓ githubService.getFileContent: Unknown error type, re-throwing original error');throw error;}}// Create a commit with multiple files\nasync createCommit(owner,repo,branch,message,files){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{// Get the latest commit SHA\nconst{data:refData}=await this.octokit.rest.git.getRef({owner,repo,ref:\"heads/\".concat(branch)});const latestCommitSha=refData.object.sha;// Get the tree SHA from the latest commit\nconst{data:commitData}=await this.octokit.rest.git.getCommit({owner,repo,commit_sha:latestCommitSha});const baseTreeSha=commitData.tree.sha;// Create blobs for all files\nconst blobs=await Promise.all(files.map(async file=>{const{data:blobData}=await this.octokit.rest.git.createBlob({owner,repo,content:file.content,encoding:'utf-8'});return{path:file.path,mode:'100644',type:'blob',sha:blobData.sha};}));// Create a new tree with the blobs\nconst{data:treeData}=await this.octokit.rest.git.createTree({owner,repo,base_tree:baseTreeSha,tree:blobs});// Create the commit\nconst{data:newCommitData}=await this.octokit.rest.git.createCommit({owner,repo,message,tree:treeData.sha,parents:[latestCommitSha]});// Update the branch reference\nawait this.octokit.rest.git.updateRef({owner,repo,ref:\"heads/\".concat(branch),sha:newCommitData.sha});return{sha:newCommitData.sha,html_url:\"https://github.com/\".concat(owner,\"/\").concat(repo,\"/commit/\").concat(newCommitData.sha),message:newCommitData.message,author:newCommitData.author,committer:newCommitData.committer};}catch(error){console.error('Failed to create commit:',error);throw error;}}// Get recent commits for a repository branch\nasync getRecentCommits(owner,repo){let branch=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'main';let per_page=arguments.length>3&&arguments[3]!==undefined?arguments[3]:5;if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}const startTime=Date.now();this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/commits\"),{sha:branch,per_page});try{const response=await this.octokit.rest.repos.listCommits({owner,repo,sha:branch,per_page});this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/commits\"),response.status,Date.now()-startTime);return response.data.map(commit=>({sha:commit.sha,message:commit.commit.message,author:{name:commit.commit.author.name,email:commit.commit.author.email,date:commit.commit.author.date},committer:{name:commit.commit.committer.name,email:commit.commit.committer.email,date:commit.commit.committer.date},html_url:commit.html_url,stats:commit.stats}));}catch(error){this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/commits\"),error.status||'error',Date.now()-startTime);console.error('Failed to fetch recent commits:',error);throw error;}}// Get open pull requests count\nasync getOpenPullRequestsCount(owner,repo){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}const startTime=Date.now();this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls\"),{state:'open',per_page:1});try{const response=await this.octokit.rest.pulls.list({owner,repo,state:'open',per_page:1});this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls\"),response.status,Date.now()-startTime);// GitHub includes the total count in the response headers\nconst linkHeader=response.headers.link;if(linkHeader&&linkHeader.includes('rel=\"last\"')){const lastPageMatch=linkHeader.match(/page=(\\d+)>; rel=\"last\"/);if(lastPageMatch){return parseInt(lastPageMatch[1],10);}}// Fallback: use the length of returned items (may not be accurate for large counts)\nreturn response.data.length;}catch(error){this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls\"),error.status||'error',Date.now()-startTime);console.error('Failed to fetch pull requests count:',error);throw error;}}// Get pull request for a specific branch (returns first PR only for backward compatibility)\nasync getPullRequestForBranch(owner,repo,branchName){const prs=await this.getPullRequestsForBranch(owner,repo,branchName);return prs&&prs.length>0?prs[0]:null;}// Get all pull requests for a specific branch\nasync getPullRequestsForBranch(owner,repo,branchName){// Use authenticated octokit if available, otherwise create a public instance for public repos\nconst octokit=this.isAuth()?this.octokit:new Octokit();const startTime=Date.now();this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls\"),{state:'open',head:\"\".concat(owner,\":\").concat(branchName)});try{const response=await octokit.rest.pulls.list({owner,repo,state:'open',head:\"\".concat(owner,\":\").concat(branchName),per_page:100// Get up to 100 PRs for a branch\n});this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls\"),response.status,Date.now()-startTime);// Return all matching PRs or empty array if none found\nreturn response.data||[];}catch(error){this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls\"),error.status||'error',Date.now()-startTime);console.error('Failed to fetch pull requests for branch:',error);return[];// Return empty array instead of throwing to allow graceful fallback\n}}// Get pull request comments\nasync getPullRequestComments(owner,repo,pullNumber){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}const startTime=Date.now();this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls/\").concat(pullNumber,\"/comments\"),{});try{const response=await this.octokit.rest.pulls.listReviewComments({owner,repo,pull_number:pullNumber,per_page:100});this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls/\").concat(pullNumber,\"/comments\"),response.status,Date.now()-startTime);return response.data;}catch(error){this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls/\").concat(pullNumber,\"/comments\"),error.status||'error',Date.now()-startTime);console.error('Failed to fetch pull request comments:',error);throw error;}}// Get pull request issue comments (general comments on the PR conversation)\nasync getPullRequestIssueComments(owner,repo,pullNumber){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}const startTime=Date.now();this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/issues/\").concat(pullNumber,\"/comments\"),{});try{const response=await this.octokit.rest.issues.listComments({owner,repo,issue_number:pullNumber,per_page:100});this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/issues/\").concat(pullNumber,\"/comments\"),response.status,Date.now()-startTime);return response.data;}catch(error){this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/issues/\").concat(pullNumber,\"/comments\"),error.status||'error',Date.now()-startTime);console.error('Failed to fetch pull request issue comments:',error);throw error;}}// Create a comment on a pull request\nasync createPullRequestComment(owner,repo,pullNumber,body){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}const startTime=Date.now();this.logger.apiCall('POST',\"/repos/\".concat(owner,\"/\").concat(repo,\"/issues/\").concat(pullNumber,\"/comments\"),{body});try{const response=await this.octokit.rest.issues.createComment({owner,repo,issue_number:pullNumber,body});this.logger.apiResponse('POST',\"/repos/\".concat(owner,\"/\").concat(repo,\"/issues/\").concat(pullNumber,\"/comments\"),response.status,Date.now()-startTime);return response.data;}catch(error){this.logger.apiResponse('POST',\"/repos/\".concat(owner,\"/\").concat(repo,\"/issues/\").concat(pullNumber,\"/comments\"),error.status||'error',Date.now()-startTime);console.error('Failed to create pull request comment:',error);throw error;}}// Get open issues count\nasync getOpenIssuesCount(owner,repo){if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}const startTime=Date.now();this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/issues\"),{state:'open',per_page:1});try{const response=await this.octokit.rest.issues.listForRepo({owner,repo,state:'open',per_page:1});this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/issues\"),response.status,Date.now()-startTime);// GitHub includes the total count in the response headers\nconst linkHeader=response.headers.link;if(linkHeader&&linkHeader.includes('rel=\"last\"')){const lastPageMatch=linkHeader.match(/page=(\\d+)>; rel=\"last\"/);if(lastPageMatch){return parseInt(lastPageMatch[1],10);}}// Fallback: use the length of returned items (may not be accurate for large counts)\nreturn response.data.length;}catch(error){this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/issues\"),error.status||'error',Date.now()-startTime);console.error('Failed to fetch issues count:',error);throw error;}}// Get repository statistics (combined method for efficiency)\nasync getRepositoryStats(owner,repo){let branch=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'main';if(!this.isAuth()){throw new Error('Not authenticated with GitHub');}try{const[recentCommits,openPRsCount,openIssuesCount]=await Promise.allSettled([this.getRecentCommits(owner,repo,branch,1),this.getOpenPullRequestsCount(owner,repo),this.getOpenIssuesCount(owner,repo)]);return{recentCommits:recentCommits.status==='fulfilled'?recentCommits.value:[],openPullRequestsCount:openPRsCount.status==='fulfilled'?openPRsCount.value:0,openIssuesCount:openIssuesCount.status==='fulfilled'?openIssuesCount.value:0,errors:{recentCommits:recentCommits.status==='rejected'?recentCommits.reason:null,openPullRequestsCount:openPRsCount.status==='rejected'?openPRsCount.reason:null,openIssuesCount:openIssuesCount.status==='rejected'?openIssuesCount.reason:null}};}catch(error){console.error('Failed to fetch repository stats:',error);throw error;}}// Get directory contents (supports both authenticated and unauthenticated access)\nasync getDirectoryContents(owner,repo){let path=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';let ref=arguments.length>3&&arguments[3]!==undefined?arguments[3]:'main';try{// Create temporary Octokit instance for unauthenticated access if needed\nconst octokit=this.isAuth()?this.octokit:new Octokit();const{data}=await octokit.rest.repos.getContent({owner,repo,path,ref});if(Array.isArray(data)){return data;}else{throw new Error('Not a directory');}}catch(error){console.error(\"Failed to get directory contents for \".concat(path,\":\"),error);throw error;}}// Update file content (requires authentication)\nasync updateFile(owner,repo,path,content,message){let branch=arguments.length>5&&arguments[5]!==undefined?arguments[5]:'main';if(!this.isAuth()){throw new Error('Authentication required to update files');}try{// First, get the current file to get its SHA\nconst{data:currentFile}=await this.octokit.rest.repos.getContent({owner,repo,path,ref:branch});if(Array.isArray(currentFile)){throw new Error('Path is a directory, not a file');}// Update the file\nconst{data}=await this.octokit.rest.repos.createOrUpdateFileContents({owner,repo,path,message,content:btoa(unescape(encodeURIComponent(content))),sha:currentFile.sha,branch});return data;}catch(error){console.error(\"Failed to update file \".concat(path,\":\"),error);throw error;}}// Get commits for a repository (supports unauthenticated access)\nasync getCommits(owner,repo){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};try{// Create temporary Octokit instance for unauthenticated access if needed\nconst octokit=this.isAuth()?this.octokit:new Octokit();const params={owner,repo,per_page:options.per_page||10,page:options.page||1};if(options.sha){params.sha=options.sha;}if(options.since){params.since=options.since;}if(options.until){params.until=options.until;}const{data}=await octokit.rest.repos.listCommits(params);return data;}catch(error){console.error('Failed to fetch commits:',error);throw error;}}// Get issues for a repository (supports unauthenticated access)\nasync getIssues(owner,repo){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};try{// Create temporary Octokit instance for unauthenticated access if needed\nconst octokit=this.isAuth()?this.octokit:new Octokit();const params={owner,repo,state:options.state||'all',per_page:options.per_page||30,page:options.page||1};if(options.labels){params.labels=options.labels;}if(options.milestone){params.milestone=options.milestone;}const{data}=await octokit.rest.issues.listForRepo(params);return data;}catch(error){console.error('Failed to fetch issues:',error);throw error;}}// Alias method for backward compatibility - delegates to getIssues\nasync getRepositoryIssues(owner,repo){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return this.getIssues(owner,repo,options);}// Get repository forks\nasync getForks(owner,repo){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const startTime=Date.now();this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/forks\"),options);try{// Use the GitHub API to fetch forks, no authentication required for public repos\nconst octokit=this.isAuth()?this.octokit:new Octokit();const params={owner,repo,sort:options.sort||'newest',per_page:options.per_page||100,page:options.page||1};const{data}=await octokit.rest.repos.listForks(params);this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/forks\"),200,Date.now()-startTime);// Return formatted fork data\nreturn data.map(fork=>({id:fork.id,name:fork.name,full_name:fork.full_name,owner:{login:fork.owner.login,avatar_url:fork.owner.avatar_url,html_url:fork.owner.html_url,type:fork.owner.type},description:fork.description,html_url:fork.html_url,clone_url:fork.clone_url,created_at:fork.created_at,updated_at:fork.updated_at,pushed_at:fork.pushed_at,stargazers_count:fork.stargazers_count,forks_count:fork.forks_count,open_issues_count:fork.open_issues_count,default_branch:fork.default_branch,private:fork.private,fork:fork.fork,parent:fork.parent?{full_name:fork.parent.full_name,html_url:fork.parent.html_url}:null}));}catch(error){this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/forks\"),error.status||'error',Date.now()-startTime);console.error('Failed to fetch repository forks:',error);throw error;}}// Get pull requests for a specific repository\nasync getPullRequests(owner,repo){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const startTime=Date.now();this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls\"),options);try{// Use the GitHub API to fetch pull requests, no authentication required for public repos\nconst octokit=this.isAuth()?this.octokit:new Octokit();const params={owner,repo,state:options.state||'open',sort:options.sort||'updated',direction:options.direction||'desc',per_page:options.per_page||30,page:options.page||1};// Add optional filters\nif(options.head){params.head=options.head;}if(options.base){params.base=options.base;}const{data}=await octokit.rest.pulls.list(params);this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls\"),200,Date.now()-startTime);// Return formatted pull request data\nreturn data.map(pr=>({id:pr.id,number:pr.number,title:pr.title,body:pr.body,state:pr.state,locked:pr.locked,user:{login:pr.user.login,avatar_url:pr.user.avatar_url,html_url:pr.user.html_url,type:pr.user.type},created_at:pr.created_at,updated_at:pr.updated_at,closed_at:pr.closed_at,merged_at:pr.merged_at,html_url:pr.html_url,diff_url:pr.diff_url,patch_url:pr.patch_url,head:{ref:pr.head.ref,sha:pr.head.sha,repo:pr.head.repo?{name:pr.head.repo.name,full_name:pr.head.repo.full_name,owner:{login:pr.head.repo.owner.login,avatar_url:pr.head.repo.owner.avatar_url},html_url:pr.head.repo.html_url}:null},base:{ref:pr.base.ref,sha:pr.base.sha,repo:{name:pr.base.repo.name,full_name:pr.base.repo.full_name,owner:{login:pr.base.repo.owner.login,avatar_url:pr.base.repo.owner.avatar_url},html_url:pr.base.repo.html_url}},draft:pr.draft,mergeable:pr.mergeable,mergeable_state:pr.mergeable_state,comments:pr.comments,review_comments:pr.review_comments,commits:pr.commits,additions:pr.additions,deletions:pr.deletions,changed_files:pr.changed_files}));}catch(error){this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/pulls\"),error.status||'error',Date.now()-startTime);console.error('Failed to fetch pull requests:',error);throw error;}}// Logout\nlogout(){this.logger.auth('Logging out and clearing stored token');this.octokit=null;this.isAuthenticated=false;this.tokenType=null;this.permissions=null;// Clear secure token storage\nsecureTokenStorage.clearToken();// Clear branch context on logout\ntry{const{default:branchContextService}=require('../services/branchContextService');branchContextService.clearAllBranchContext();}catch(error){// Service might not be available during testing\nsessionStorage.removeItem('sgex_branch_context');}}// Get repository forks\nasync getRepositoryForks(owner,repo){let options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};const startTime=Date.now();this.logger.debug('Fetching repository forks',{owner,repo,options});try{// Create temporary Octokit instance for unauthenticated access if needed\nconst octokit=this.isAuth()?this.octokit:new Octokit();this.logger.apiCall('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/forks\"),options);const{data}=await octokit.rest.repos.listForks({owner,repo,sort:'newest',// Sort by newest first\nper_page:options.per_page||100,page:options.page||1});const duration=Date.now()-startTime;this.logger.apiResponse('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/forks\"),200,duration,{forkCount:data.length});this.logger.performance('Repository forks fetch',duration);return data;}catch(error){const duration=Date.now()-startTime;this.logger.apiError('GET',\"/repos/\".concat(owner,\"/\").concat(repo,\"/forks\"),error);this.logger.performance('Repository forks fetch (failed)',duration);console.error(\"Failed to fetch forks for \".concat(owner,\"/\").concat(repo,\":\"),error);throw error;}}}// Create a singleton instance\nconst githubService=new GitHubService();export default githubService;","map":{"version":3,"names":["Octokit","processConcurrently","repositoryCompatibilityCache","secureTokenStorage","logger","GitHubService","constructor","octokit","isAuthenticated","permissions","tokenType","getLogger","debug","authenticate","token","startTime","Date","now","auth","tokenProvided","tokenMask","maskToken","validation","validateTokenFormat","isValid","warn","reason","type","stored","storeToken","duration","securelyStored","performance","error","message","console","clearToken","authenticateWithOctokit","octokitInstance","initializeFromStoredToken","migrated","migrateLegacyToken","tokenData","retrieveToken","expires","toISOString","hasStoredToken","hasValidToken","getStoredTokenInfo","getTokenInfo","checkTokenPermissions","isAuth","Error","apiCall","response","request","apiResponse","status","rateLimitStart","rateLimit","rest","get","data","resources","core","hasCore","rateLimitError","user","username","login","apiError","checkRepositoryWritePermissions","owner","repo","currentUser","getCurrentUser","concat","repos","getCollaboratorPermissionLevel","hasWriteAccess","includes","permission","checkRepositoryPermissions","users","getAuthenticated","getUserOrganizations","orgs","listForAuthenticatedUser","getOrganization","orgLogin","org","getUser","getByUsername","getWHOOrganization","whoData","id","display_name","name","description","avatar_url","html_url","can_create_repositories","can_create_private_repositories","plan","private_repos","isWHO","getRepositories","arguments","length","undefined","isDemo","getDemoRepositories","getSmartGuidelinesRepositories","demoRepos","full_name","private","clone_url","language","stargazers_count","forks_count","open_issues_count","topics","created_at","updated_at","pushed_at","default_branch","smart_guidelines_compatible","Promise","resolve","checkSmartGuidelinesCompatibility","retryCount","compatible","cachedResult","cached","getContent","path","content","decodeURIComponent","escape","atob","isCompatible","set","delay","process","env","NODE_ENV","setTimeout","errorInfo","errorType","_categorizeError","retryable","_isRetryableError","code","repositories","page","hasMorePages","listForUser","sort","per_page","listForOrg","smartGuidelinesRepos","compatibilityResult","push","_objectSpread","getSmartGuidelinesRepositoriesProgressive","onRepositoryFound","onProgress","onError","log","current","total","currentRepo","progress","completed","scanningErrors","rateLimited","networkErrors","permissionDenied","otherErrors","totalErrors","totalScanned","processor","index","Math","random","smartRepo","results","concurrency","result","progressData","round","rateLimitedCount","networkErrorCount","hasRetryableErrors","some","e","onItemStart","started","validResults","filter","getRepository","getBranches","listBranches","createBranch","branchName","fromBranch","refData","git","getRef","ref","createRef","sha","object","getBranch","branch","getWorkflows","actions","listRepoWorkflows","workflows","map","workflow","filename","split","pop","state","url","triggers","lastModified","getWorkflowRuns","options","params","workflow_id","listWorkflowRunsForRepo","getWorkflowRunsForWorkflow","listWorkflowRuns","triggerWorkflow","inputs","createWorkflowDispatch","rerunWorkflow","run_id","reRunWorkflow","getWorkflowRunLogs","downloadWorkflowRunLogs","approveWorkflowRun","getCommitDiff","base","head","compareCommits","getCommit","getReleases","listReleases","getLatestRelease","getBpmnFilesRecursive","allFiles","Array","isArray","endsWith","item","getBpmnFiles","allBpmnFiles","possiblePaths","files","uniqueFiles","file","self","findIndex","f","getFileContent","timeoutMs","timeoutPromise","_","reject","apiPromise","race","responseTime","size","encoding","hasContent","substring","JSON","stringify","_error$stack","stack","createCommit","latestCommitSha","commitData","commit_sha","baseTreeSha","tree","blobs","all","blobData","createBlob","mode","treeData","createTree","base_tree","newCommitData","parents","updateRef","author","committer","getRecentCommits","listCommits","commit","email","date","stats","getOpenPullRequestsCount","pulls","list","linkHeader","headers","link","lastPageMatch","match","parseInt","getPullRequestForBranch","prs","getPullRequestsForBranch","getPullRequestComments","pullNumber","listReviewComments","pull_number","getPullRequestIssueComments","issues","listComments","issue_number","createPullRequestComment","body","createComment","getOpenIssuesCount","listForRepo","getRepositoryStats","recentCommits","openPRsCount","openIssuesCount","allSettled","value","openPullRequestsCount","errors","getDirectoryContents","updateFile","currentFile","createOrUpdateFileContents","btoa","unescape","encodeURIComponent","getCommits","since","until","getIssues","labels","milestone","getRepositoryIssues","getForks","listForks","fork","parent","getPullRequests","direction","pr","number","title","locked","closed_at","merged_at","diff_url","patch_url","draft","mergeable","mergeable_state","comments","review_comments","commits","additions","deletions","changed_files","logout","default","branchContextService","require","clearAllBranchContext","sessionStorage","removeItem","getRepositoryForks","forkCount","githubService"],"sources":["/home/runner/work/sgex/sgex/src/services/githubService.js"],"sourcesContent":["import { Octokit } from '@octokit/rest';\nimport { processConcurrently } from '../utils/concurrency';\nimport repositoryCompatibilityCache from '../utils/repositoryCompatibilityCache';\nimport secureTokenStorage from './secureTokenStorage';\nimport logger from '../utils/logger';\n\nclass GitHubService {\n  constructor() {\n    this.octokit = null;\n    this.isAuthenticated = false;\n    this.permissions = null;\n    this.tokenType = null; // 'classic', 'fine-grained', or 'oauth'\n    this.logger = logger.getLogger('GitHubService');\n    this.logger.debug('GitHubService instance created');\n  }\n\n  // Initialize with a GitHub token (supports both OAuth and PAT tokens)\n  authenticate(token) {\n    const startTime = Date.now();\n    this.logger.auth('Starting authentication', { \n      tokenProvided: !!token, \n      tokenMask: token ? secureTokenStorage.maskToken(token) : 'none'\n    });\n    \n    try {\n      // Validate token format using SecureTokenStorage\n      const validation = secureTokenStorage.validateTokenFormat(token);\n      if (!validation.isValid) {\n        this.logger.warn('Token validation failed during authentication', { \n          reason: validation.reason,\n          tokenMask: secureTokenStorage.maskToken(token)\n        });\n        this.isAuthenticated = false;\n        return false;\n      }\n\n      this.octokit = new Octokit({\n        auth: validation.token,\n      });\n      this.isAuthenticated = true;\n      this.tokenType = validation.type;\n      \n      // Store token securely\n      const stored = secureTokenStorage.storeToken(validation.token);\n      if (!stored) {\n        this.logger.warn('Failed to store token securely, authentication will not persist');\n      }\n      \n      const duration = Date.now() - startTime;\n      this.logger.auth('Authentication successful', { \n        duration, \n        tokenType: this.tokenType,\n        tokenMask: secureTokenStorage.maskToken(token),\n        securelyStored: stored\n      });\n      this.logger.performance('GitHub authentication', duration);\n      \n      return true;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      this.logger.auth('Authentication failed', { \n        error: error.message, \n        duration,\n        tokenMask: secureTokenStorage.maskToken(token)\n      });\n      console.error('Failed to authenticate with GitHub:', error);\n      this.isAuthenticated = false;\n      secureTokenStorage.clearToken(); // Clear any partially stored data\n      return false;\n    }\n  }\n\n  // Initialize with an existing Octokit instance (for OAuth flow)\n  authenticateWithOctokit(octokitInstance) {\n    this.logger.auth('Starting OAuth authentication with Octokit instance');\n    \n    try {\n      this.octokit = octokitInstance;\n      this.isAuthenticated = true;\n      this.tokenType = 'oauth';\n      \n      this.logger.auth('OAuth authentication successful', { tokenType: this.tokenType });\n      return true;\n    } catch (error) {\n      this.logger.auth('OAuth authentication failed', { error: error.message });\n      console.error('Failed to authenticate with Octokit instance:', error);\n      this.isAuthenticated = false;\n      return false;\n    }\n  }\n\n  // Initialize authentication from securely stored token\n  initializeFromStoredToken() {\n    this.logger.auth('Attempting to initialize from stored token');\n    \n    try {\n      // First try to migrate any legacy tokens\n      const migrated = secureTokenStorage.migrateLegacyToken();\n      if (migrated) {\n        this.logger.debug('Successfully migrated legacy token to secure storage');\n      }\n\n      // Retrieve token from secure storage\n      const tokenData = secureTokenStorage.retrieveToken();\n      if (!tokenData) {\n        this.logger.debug('No valid stored token found');\n        return false;\n      }\n\n      // Initialize Octokit with stored token\n      this.octokit = new Octokit({\n        auth: tokenData.token,\n      });\n      this.isAuthenticated = true;\n      this.tokenType = tokenData.type;\n      \n      this.logger.auth('Successfully initialized from stored token', {\n        tokenType: this.tokenType,\n        tokenMask: secureTokenStorage.maskToken(tokenData.token),\n        expires: new Date(tokenData.expires).toISOString()\n      });\n      \n      return true;\n    } catch (error) {\n      this.logger.auth('Failed to initialize from stored token', { error: error.message });\n      this.isAuthenticated = false;\n      secureTokenStorage.clearToken();\n      return false;\n    }\n  }\n\n  // Check if there's a valid stored token\n  hasStoredToken() {\n    return secureTokenStorage.hasValidToken();\n  }\n\n  // Get information about stored token\n  getStoredTokenInfo() {\n    return secureTokenStorage.getTokenInfo();\n  }\n\n  // Check token permissions and type\n  async checkTokenPermissions() {\n    if (!this.isAuth()) {\n      const error = new Error('Not authenticated with GitHub');\n      this.logger.error('Token permission check failed - not authenticated');\n      throw error;\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', '/user', null);\n\n    try {\n      // Try to get token info to determine type and permissions\n      const response = await this.octokit.request('GET /user');\n      this.logger.apiResponse('GET', '/user', response.status, Date.now() - startTime);\n      \n      // Check if this is a fine-grained token by trying to access rate limit info\n      try {\n        const rateLimitStart = Date.now();\n        this.logger.apiCall('GET', '/rate_limit', null);\n        const rateLimit = await this.octokit.rest.rateLimit.get();\n        this.logger.apiResponse('GET', '/rate_limit', rateLimit.status, Date.now() - rateLimitStart);\n        \n        // Fine-grained tokens have different rate limit structure\n        this.tokenType = rateLimit.data.resources.core ? 'classic' : 'fine-grained';\n        this.logger.debug('Token type determined', { tokenType: this.tokenType, hasCore: !!rateLimit.data.resources.core });\n      } catch (rateLimitError) {\n        this.tokenType = 'unknown';\n        this.logger.warn('Could not determine token type from rate limit', { error: rateLimitError.message });\n      }\n\n      const permissions = {\n        type: this.tokenType,\n        user: response.data\n      };\n      \n      this.permissions = permissions;\n      this.logger.debug('Token permissions checked successfully', { \n        tokenType: this.tokenType, \n        username: response.data.login \n      });\n      \n      return permissions;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      this.logger.apiError('GET', '/user', error);\n      this.logger.performance('Token permission check (failed)', duration);\n      console.error('Failed to check token permissions:', error);\n      throw error;\n    }\n  }\n\n  // Check if we have write permissions for a specific repository\n  async checkRepositoryWritePermissions(owner, repo) {\n    if (!this.isAuth()) {\n      this.logger.warn('Cannot check repository write permissions - not authenticated', { owner, repo });\n      return false;\n    }\n\n    const startTime = Date.now();\n    this.logger.debug('Checking write permissions for repository', { owner, repo });\n\n    try {\n      // Get current user first\n      const currentUser = await this.getCurrentUser();\n      const username = currentUser.login;\n      \n      this.logger.apiCall('GET', `/repos/${owner}/${repo}/collaborators/${username}/permission`, null);\n      \n      // Try to get repository collaborator permissions\n      const { data } = await this.octokit.rest.repos.getCollaboratorPermissionLevel({\n        owner,\n        repo,\n        username\n      });\n      \n      const duration = Date.now() - startTime;\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/collaborators/${username}/permission`, 200, duration);\n      \n      const hasWriteAccess = ['write', 'admin'].includes(data.permission);\n      this.logger.debug('Repository write permissions checked', { \n        owner, \n        repo, \n        permission: data.permission, \n        hasWriteAccess \n      });\n      \n      return hasWriteAccess;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      this.logger.apiError('GET', `/repos/${owner}/${repo}/collaborators/*/permission`, error);\n      this.logger.performance('Repository write permission check (failed)', duration);\n      \n      // If we can't check permissions, assume we don't have write access\n      console.warn('Could not check repository write permissions:', error);\n      this.logger.warn('Assuming no write access due to permission check failure', { owner, repo, error: error.message });\n      return false;\n    }\n  }\n\n  // Alias method for backward compatibility - delegates to checkRepositoryWritePermissions\n  async checkRepositoryPermissions(owner, repo) {\n    return this.checkRepositoryWritePermissions(owner, repo);\n  }\n\n  // Check if authenticated\n  isAuth() {\n    return this.isAuthenticated && this.octokit !== null;\n  }\n\n  // Get current user data\n  async getCurrentUser() {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.users.getAuthenticated();\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch user data:', error);\n      throw error;\n    }\n  }\n\n  // Get user's organizations\n  async getUserOrganizations() {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.orgs.listForAuthenticatedUser();\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch organizations:', error);\n      throw error;\n    }\n  }\n\n  // Get specific organization data (public data, no auth required)\n  async getOrganization(orgLogin) {\n    try {\n      // Create a temporary Octokit instance for public API calls if we don't have one\n      const octokit = this.octokit || new Octokit();\n      \n      const { data } = await octokit.rest.orgs.get({\n        org: orgLogin\n      });\n      return data;\n    } catch (error) {\n      console.error(`Failed to fetch organization ${orgLogin}:`, error);\n      throw error;\n    }\n  }\n\n  // Get specific user data (public data, no auth required)\n  async getUser(username) {\n    try {\n      // Create a temporary Octokit instance for public API calls if we don't have one\n      const octokit = this.octokit || new Octokit();\n      \n      const { data } = await octokit.rest.users.getByUsername({\n        username\n      });\n      return data;\n    } catch (error) {\n      console.error(`Failed to fetch user ${username}:`, error);\n      throw error;\n    }\n  }\n\n  // Get WHO organization data with fresh avatar\n  async getWHOOrganization() {\n    try {\n      const whoData = await this.getOrganization('WorldHealthOrganization');\n      return {\n        id: whoData.id,\n        login: whoData.login,\n        display_name: whoData.name || 'World Health Organization',\n        description: whoData.description || 'The World Health Organization is a specialized agency of the United Nations responsible for international public health.',\n        avatar_url: whoData.avatar_url,\n        html_url: whoData.html_url,\n        type: 'Organization',\n        permissions: {\n          can_create_repositories: true,\n          can_create_private_repositories: true\n        },\n        plan: {\n          name: 'Organization',\n          private_repos: 'unlimited'\n        },\n        isWHO: true\n      };\n    } catch (error) {\n      console.warn('Could not fetch WHO organization data from API, using fallback:', error);\n      // Return hardcoded fallback data\n      return {\n        id: 'who-organization',\n        login: 'WorldHealthOrganization',\n        display_name: 'World Health Organization',\n        description: 'The World Health Organization is a specialized agency of the United Nations responsible for international public health.',\n        avatar_url: 'https://avatars.githubusercontent.com/u/12261302?s=200&v=4',\n        html_url: 'https://github.com/WorldHealthOrganization',\n        type: 'Organization',\n        permissions: {\n          can_create_repositories: true,\n          can_create_private_repositories: true\n        },\n        plan: {\n          name: 'Organization',\n          private_repos: 'unlimited'\n        },\n        isWHO: true\n      };\n    }\n  }\n\n  // Get repositories for a user or organization (now filters by SMART Guidelines compatibility)\n  async getRepositories(owner, type = 'user', isDemo = false) {\n    // Handle demo mode - return demo repositories without requiring authentication\n    if (isDemo || owner === 'demo-user') {\n      return this.getDemoRepositories(owner);\n    }\n    \n    // Use the new SMART guidelines filtering method\n    return this.getSmartGuidelinesRepositories(owner, type);\n  }\n\n  // Get demo repositories for demo mode (no authentication required)\n  getDemoRepositories(owner) {\n    const demoRepos = [\n      {\n        id: 'demo-smart-anc',\n        name: 'smart-anc',\n        full_name: `${owner}/smart-anc`,\n        description: 'Demo SMART Guidelines Digital Adaptation Kit for Antenatal Care',\n        private: false,\n        owner: {\n          login: owner,\n          id: 'demo-owner',\n          avatar_url: `https://github.com/${owner}.png`,\n          type: 'User'\n        },\n        html_url: `https://github.com/${owner}/smart-anc`,\n        clone_url: `https://github.com/${owner}/smart-anc.git`,\n        language: 'FSH',\n        stargazers_count: 15,\n        forks_count: 3,\n        open_issues_count: 2,\n        topics: ['who', 'smart-guidelines', 'dak', 'antenatal-care', 'health'],\n        created_at: '2023-01-15T10:00:00Z',\n        updated_at: '2024-12-15T14:30:00Z',\n        pushed_at: '2024-12-15T14:30:00Z',\n        default_branch: 'main',\n        smart_guidelines_compatible: true,\n        isDemo: true\n      },\n      {\n        id: 'demo-smart-tb',\n        name: 'smart-tb',\n        full_name: `${owner}/smart-tb`,\n        description: 'Demo SMART Guidelines Digital Adaptation Kit for Tuberculosis Care',\n        private: false,\n        owner: {\n          login: owner,\n          id: 'demo-owner',\n          avatar_url: `https://github.com/${owner}.png`,\n          type: 'User'\n        },\n        html_url: `https://github.com/${owner}/smart-tb`,\n        clone_url: `https://github.com/${owner}/smart-tb.git`,\n        language: 'FSH',\n        stargazers_count: 8,\n        forks_count: 1,\n        open_issues_count: 0,\n        topics: ['who', 'smart-guidelines', 'dak', 'tuberculosis', 'health'],\n        created_at: '2023-03-20T15:00:00Z',\n        updated_at: '2024-11-30T09:15:00Z',\n        pushed_at: '2024-11-30T09:15:00Z',\n        default_branch: 'main',\n        smart_guidelines_compatible: true,\n        isDemo: true\n      },\n      {\n        id: 'demo-smart-ips-pilgrimage',\n        name: 'smart-ips-pilgrimage',\n        full_name: `${owner}/smart-ips-pilgrimage`,\n        description: 'Demo SMART Guidelines International Patient Summary for Pilgrimage',\n        private: false,\n        owner: {\n          login: owner,\n          id: 'demo-owner',\n          avatar_url: `https://github.com/${owner}.png`,\n          type: 'User'\n        },\n        html_url: `https://github.com/${owner}/smart-ips-pilgrimage`,\n        clone_url: `https://github.com/${owner}/smart-ips-pilgrimage.git`,\n        language: 'FSH',\n        stargazers_count: 12,\n        forks_count: 2,\n        open_issues_count: 1,\n        topics: ['who', 'smart-guidelines', 'dak', 'ips', 'pilgrimage', 'health'],\n        created_at: '2023-06-10T12:00:00Z',\n        updated_at: '2024-12-01T16:45:00Z',\n        pushed_at: '2024-12-01T16:45:00Z',\n        default_branch: 'main',\n        smart_guidelines_compatible: true,\n        isDemo: true\n      }\n    ];\n\n    return Promise.resolve(demoRepos);\n  }\n\n  // Check if a repository has sushi-config.yaml with smart.who.int.base dependency\n  async checkSmartGuidelinesCompatibility(owner, repo, retryCount = 2) {\n    if (!this.isAuth()) {\n      return { compatible: false, error: 'Not authenticated' };\n    }\n\n    // Check cache first to prevent redundant downloads\n    const cachedResult = repositoryCompatibilityCache.get(owner, repo);\n    if (cachedResult !== null) {\n      return { compatible: cachedResult, cached: true };\n    }\n\n    try {\n      // Try to get sushi-config.yaml from the repository root\n      const { data } = await this.octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path: 'sushi-config.yaml',\n      });\n\n      if (data.type === 'file' && data.content) {\n        // Decode base64 content (browser-compatible)\n        const content = decodeURIComponent(escape(atob(data.content)));\n        \n        // Check if the content contains smart.who.int.base in dependencies\n        const isCompatible = content.includes('smart.who.int.base');\n        \n        // Cache the result\n        repositoryCompatibilityCache.set(owner, repo, isCompatible);\n        return { compatible: isCompatible };\n      }\n      \n      // Cache negative result\n      repositoryCompatibilityCache.set(owner, repo, false);\n      return { compatible: false, reason: 'No sushi-config.yaml file found' };\n    } catch (error) {\n      // If it's a 404 (file not found), retry once more in case of temporary issues\n      if (error.status === 404 && retryCount > 0) {\n        console.warn(`File not found for ${owner}/${repo}, retrying... (${retryCount} attempts left)`);\n        // Use shorter delay in test environment\n        const delay = process.env.NODE_ENV === 'test' ? 10 : 1000;\n        await new Promise(resolve => setTimeout(resolve, delay));\n        return this.checkSmartGuidelinesCompatibility(owner, repo, retryCount - 1);\n      }\n      \n      // For any error (including rate limiting, network errors, or file not found after retries),\n      // return error information instead of just logging\n      const errorInfo = {\n        compatible: false,\n        error: error.message,\n        errorType: this._categorizeError(error),\n        status: error.status,\n        retryable: this._isRetryableError(error)\n      };\n\n      console.warn(`Failed to check ${owner}/${repo} for sushi-config.yaml with smart.who.int.base dependency:`, error.message);\n      \n      // Cache negative result\n      repositoryCompatibilityCache.set(owner, repo, false);\n      return errorInfo;\n    }\n  }\n\n  // Helper method to categorize errors\n  _categorizeError(error) {\n    if (error.status === 403) {\n      if (error.message.includes('rate limit')) {\n        return 'rate_limit';\n      }\n      return 'permission_denied';\n    }\n    if (error.status === 404) {\n      return 'not_found';\n    }\n    if (error.status === 401) {\n      return 'authentication_failed';\n    }\n    if (error.code === 'ENOTFOUND' || error.code === 'ECONNRESET') {\n      return 'network_error';\n    }\n    return 'unknown_error';\n  }\n\n  // Helper method to determine if error is retryable\n  _isRetryableError(error) {\n    return ['rate_limit', 'network_error'].includes(this._categorizeError(error));\n  }\n\n\n\n  // Get repositories that are SMART guidelines compatible\n  async getSmartGuidelinesRepositories(owner, type = 'user') {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      let repositories = [];\n      let page = 1;\n      let hasMorePages = true;\n\n      // Fetch all repositories using pagination\n      while (hasMorePages) {\n        let response;\n        if (type === 'user') {\n          response = await this.octokit.rest.repos.listForUser({\n            username: owner,\n            sort: 'updated',\n            per_page: 100,\n            page: page,\n          });\n        } else {\n          response = await this.octokit.rest.repos.listForOrg({\n            org: owner,\n            sort: 'updated',\n            per_page: 100,\n            page: page,\n          });\n        }\n\n        repositories = repositories.concat(response.data);\n        \n        // Check if there are more pages\n        hasMorePages = response.data.length === 100;\n        page++;\n      }\n\n      // Check each repository for SMART guidelines compatibility\n      const smartGuidelinesRepos = [];\n      for (const repo of repositories) {\n        const compatibilityResult = await this.checkSmartGuidelinesCompatibility(repo.owner.login, repo.name);\n        if (compatibilityResult.compatible) {\n          smartGuidelinesRepos.push({\n            ...repo,\n            smart_guidelines_compatible: true\n          });\n        }\n      }\n\n      return smartGuidelinesRepos;\n    } catch (error) {\n      console.error('Failed to fetch SMART guidelines repositories:', error);\n      throw error;\n    }\n  }\n\n  // Get repositories with progressive scanning (for real-time updates)\n  async getSmartGuidelinesRepositoriesProgressive(owner, type = 'user', onRepositoryFound = null, onProgress = null, onError = null) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      let repositories = [];\n      let page = 1;\n      let hasMorePages = true;\n\n      // Fetch all repositories using pagination\n      while (hasMorePages) {\n        let response;\n        if (type === 'user') {\n          response = await this.octokit.rest.repos.listForUser({\n            username: owner,\n            sort: 'updated',\n            per_page: 100,\n            page: page,\n          });\n        } else {\n          response = await this.octokit.rest.repos.listForOrg({\n            org: owner,\n            sort: 'updated',\n            per_page: 100,\n            page: page,\n          });\n        }\n\n        repositories = repositories.concat(response.data);\n        \n        // Check if there are more pages\n        hasMorePages = response.data.length === 100;\n        page++;\n      }\n\n      // Handle case where user has no repositories\n      if (repositories.length === 0) {\n        console.log('📊 No repositories found for user, completing scan immediately');\n        // Call progress callback to indicate completion\n        if (onProgress) {\n          onProgress({\n            current: 0,\n            total: 0,\n            currentRepo: 'none',\n            progress: 100,\n            completed: true\n          });\n        }\n        return [];\n      }\n\n      // Track scanning errors for reporting\n      const scanningErrors = {\n        rateLimited: [],\n        networkErrors: [],\n        permissionDenied: [],\n        otherErrors: [],\n        totalErrors: 0,\n        totalScanned: 0\n      };\n\n      // Process repositories concurrently with rate limiting and enhanced display\n      const processor = async (repo, index) => {\n        // Add a small delay to make scanning progress visible (similar to demo mode)\n        await new Promise(resolve => setTimeout(resolve, 100 + Math.random() * 200));\n        \n        const compatibilityResult = await this.checkSmartGuidelinesCompatibility(repo.owner.login, repo.name);\n        scanningErrors.totalScanned++;\n\n        // Handle the new return format\n        if (compatibilityResult.compatible) {\n          const smartRepo = {\n            ...repo,\n            smart_guidelines_compatible: true\n          };\n          \n          // Notify that a repository was found\n          if (onRepositoryFound) {\n            onRepositoryFound(smartRepo);\n          }\n          \n          return smartRepo;\n        } else if (compatibilityResult.error) {\n          // Track the error for reporting\n          scanningErrors.totalErrors++;\n          const errorInfo = {\n            repo: repo.name,\n            error: compatibilityResult.error,\n            errorType: compatibilityResult.errorType,\n            retryable: compatibilityResult.retryable\n          };\n\n          switch (compatibilityResult.errorType) {\n            case 'rate_limit':\n              scanningErrors.rateLimited.push(errorInfo);\n              break;\n            case 'network_error':\n              scanningErrors.networkErrors.push(errorInfo);\n              break;\n            case 'permission_denied':\n              scanningErrors.permissionDenied.push(errorInfo);\n              break;\n            default:\n              scanningErrors.otherErrors.push(errorInfo);\n          }\n\n          // Report error if callback provided\n          if (onError) {\n            onError(errorInfo);\n          }\n        }\n        \n        return null;\n      };\n\n      // Use concurrent processing with max 5 parallel requests\n      const results = await processConcurrently(repositories, processor, {\n        concurrency: 5,\n        onProgress: (completed, total, repo, result) => {\n          // Progress callback for completed items\n          if (onProgress) {\n            const progressData = {\n              current: completed,\n              total: total,\n              currentRepo: repo.name,\n              progress: Math.round((completed / total) * 100),\n              completed: true,\n              scanningErrors: scanningErrors.totalErrors > 0 ? {\n                totalErrors: scanningErrors.totalErrors,\n                rateLimitedCount: scanningErrors.rateLimited.length,\n                networkErrorCount: scanningErrors.networkErrors.length,\n                hasRetryableErrors: [...scanningErrors.rateLimited, ...scanningErrors.networkErrors].some(e => e.retryable)\n              } : null\n            };\n            onProgress(progressData);\n          }\n        },\n        onItemStart: (repo, index) => {\n          // Progress callback for started items\n          if (onProgress) {\n            onProgress({\n              current: index + 1,\n              total: repositories.length,\n              currentRepo: repo.name,\n              progress: Math.round(((index + 1) / repositories.length) * 100),\n              completed: false,\n              started: true\n            });\n          }\n        }\n      });\n\n      // Filter out null results and collect smart repositories\n      const validResults = results.filter(result => result !== null && !result.error);\n      \n      // Log summary of scanning results\n      if (scanningErrors.totalErrors > 0) {\n        console.warn(`Repository scanning completed with ${scanningErrors.totalErrors} errors out of ${scanningErrors.totalScanned} repositories checked:`);\n        if (scanningErrors.rateLimited.length > 0) {\n          console.warn(`- Rate limited: ${scanningErrors.rateLimited.length} repositories`);\n        }\n        if (scanningErrors.networkErrors.length > 0) {\n          console.warn(`- Network errors: ${scanningErrors.networkErrors.length} repositories`);\n        }\n        if (scanningErrors.permissionDenied.length > 0) {\n          console.warn(`- Permission denied: ${scanningErrors.permissionDenied.length} repositories`);\n        }\n        if (scanningErrors.otherErrors.length > 0) {\n          console.warn(`- Other errors: ${scanningErrors.otherErrors.length} repositories`);\n        }\n      }\n\n      // Return results along with error summary\n      return {\n        repositories: validResults,\n        scanningErrors: scanningErrors.totalErrors > 0 ? scanningErrors : null\n      };\n    } catch (error) {\n      console.error('Failed to fetch SMART guidelines repositories:', error);\n      throw error;\n    }\n  }\n\n  // Get a specific repository\n  async getRepository(owner, repo) {\n    try {\n      // Use authenticated octokit if available, otherwise create a public instance for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const { data } = await octokit.rest.repos.get({\n        owner,\n        repo,\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch repository:', error);\n      throw error;\n    }  \n  }\n\n  // Get repository branches\n  async getBranches(owner, repo) {\n    try {\n      console.log(`githubService.getBranches: Fetching branches for ${owner}/${repo}`);\n      console.log('githubService.getBranches: Authentication status:', this.isAuth());\n      \n      // Use authenticated octokit if available, otherwise create a public instance for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      console.log('githubService.getBranches: Using', this.isAuth() ? 'authenticated' : 'public', 'octokit instance');\n      \n      const { data } = await octokit.rest.repos.listBranches({\n        owner,\n        repo,\n        per_page: 100\n      });\n      \n      console.log(`githubService.getBranches: Successfully fetched ${data.length} branches`);\n      return data;\n    } catch (error) {\n      console.error('githubService.getBranches: Failed to fetch branches:', error);\n      console.error('githubService.getBranches: Error details:', {\n        status: error.status,\n        message: error.message,\n        owner,\n        repo\n      });\n      throw error;\n    }\n  }\n\n  // Create a new branch\n  async createBranch(owner, repo, branchName, fromBranch = 'main') {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      // First get the SHA of the source branch\n      const { data: refData } = await this.octokit.rest.git.getRef({\n        owner,\n        repo,\n        ref: `heads/${fromBranch}`\n      });\n\n      // Create the new branch\n      const { data } = await this.octokit.rest.git.createRef({\n        owner,\n        repo,\n        ref: `refs/heads/${branchName}`,\n        sha: refData.object.sha\n      });\n\n      return data;\n    } catch (error) {\n      console.error('Failed to create branch:', error);\n      throw error;\n    }\n  }\n\n  // Get a specific branch\n  async getBranch(owner, repo, branch) {\n    try {\n      // Use authenticated octokit if available, otherwise create a public instance for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const { data } = await octokit.rest.repos.getBranch({\n        owner,\n        repo,\n        branch\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch branch:', error);\n      throw error;\n    }\n  }\n\n  // GitHub Actions API methods\n  \n  // Get workflows for a repository (using GitHub API to include workflow IDs)\n  async getWorkflows(owner, repo) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      // Use GitHub Actions API to get workflows with their IDs\n      const { data } = await this.octokit.rest.actions.listRepoWorkflows({\n        owner,\n        repo\n      });\n\n      return data.workflows.map(workflow => ({\n        id: workflow.id, // This is the crucial missing piece!\n        name: workflow.name,\n        filename: workflow.path.split('/').pop(), // Extract filename from path\n        path: workflow.path,\n        state: workflow.state,\n        created_at: workflow.created_at,\n        updated_at: workflow.updated_at,\n        url: workflow.html_url,\n        triggers: ['unknown'], // GitHub API doesn't provide trigger info directly\n        lastModified: workflow.updated_at\n      }));\n    } catch (error) {\n      if (error.status === 404) {\n        // No workflows or repository not found\n        return [];\n      }\n      console.error('Failed to fetch workflows:', error);\n      throw error;\n    }\n  }\n\n  // Get workflow runs for a repository\n  async getWorkflowRuns(owner, repo, options = {}) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const params = {\n        owner,\n        repo,\n        per_page: options.per_page || 10,\n        page: options.page || 1\n      };\n\n      if (options.branch) {\n        params.branch = options.branch;\n      }\n\n      if (options.workflow_id) {\n        params.workflow_id = options.workflow_id;\n      }\n\n      const { data } = await this.octokit.rest.actions.listWorkflowRunsForRepo(params);\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch workflow runs:', error);\n      throw error;\n    }\n  }\n\n  // Get workflow runs for a specific workflow\n  async getWorkflowRunsForWorkflow(owner, repo, workflow_id, options = {}) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const params = {\n        owner,\n        repo,\n        workflow_id,\n        per_page: options.per_page || 10,\n        page: options.page || 1\n      };\n\n      if (options.branch) {\n        params.branch = options.branch;\n      }\n\n      const { data } = await this.octokit.rest.actions.listWorkflowRuns(params);\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch workflow runs for workflow:', error);\n      throw error;\n    }\n  }\n\n  // Trigger a workflow run\n  async triggerWorkflow(owner, repo, workflow_id, ref = 'main', inputs = {}) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.actions.createWorkflowDispatch({\n        owner,\n        repo,\n        workflow_id,\n        ref,\n        inputs\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to trigger workflow:', error);\n      throw error;\n    }\n  }\n\n  // Re-run a workflow\n  async rerunWorkflow(owner, repo, run_id) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.actions.reRunWorkflow({\n        owner,\n        repo,\n        run_id\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to re-run workflow:', error);\n      throw error;\n    }\n  }\n\n  // Get workflow run logs\n  async getWorkflowRunLogs(owner, repo, run_id) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.actions.downloadWorkflowRunLogs({\n        owner,\n        repo,\n        run_id\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to get workflow run logs:', error);\n      throw error;\n    }\n  }\n\n  // Approve a workflow run\n  async approveWorkflowRun(owner, repo, run_id) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.actions.approveWorkflowRun({\n        owner,\n        repo,\n        run_id\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to approve workflow run:', error);\n      throw error;\n    }\n  }\n\n  // Get commit comparison (diff)\n  async getCommitDiff(owner, repo, base, head) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.repos.compareCommits({\n        owner,\n        repo,\n        base,\n        head\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to get commit diff:', error);\n      throw error;\n    }\n  }\n\n  // Get commit details\n  async getCommit(owner, repo, sha) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.repos.getCommit({\n        owner,\n        repo,\n        ref: sha\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to get commit details:', error);\n      throw error;\n    }\n  }\n\n  // Releases API methods\n\n  // Get releases for a repository\n  async getReleases(owner, repo, options = {}) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.repos.listReleases({\n        owner,\n        repo,\n        per_page: options.per_page || 10,\n        page: options.page || 1\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch releases:', error);\n      throw error;\n    }\n  }\n\n  // Get latest release\n  async getLatestRelease(owner, repo) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.repos.getLatestRelease({\n        owner,\n        repo\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch latest release:', error);\n      throw error;\n    }\n  }\n\n  // Recursively fetch BPMN files from a directory and its subdirectories\n  async getBpmnFilesRecursive(owner, repo, path, ref = 'main', allFiles = []) {\n    try {\n      console.log(`🔎 githubService.getBpmnFilesRecursive: Searching ${owner}/${repo}/${path} (ref: ${ref})`);\n      // Use authenticated octokit if available, otherwise create a public instance\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      console.log(`🔐 githubService.getBpmnFilesRecursive: Using ${this.isAuth() ? 'authenticated' : 'public'} octokit`);\n      \n      const { data } = await octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path,\n        ref\n      });\n\n      console.log(`📦 githubService.getBpmnFilesRecursive: Received data type: ${Array.isArray(data) ? 'array' : 'single file'}, length: ${Array.isArray(data) ? data.length : 1}`);\n\n      // Handle single file response\n      if (!Array.isArray(data)) {\n        if (data.name.endsWith('.bpmn')) {\n          console.log(`📄 githubService.getBpmnFilesRecursive: Found single BPMN file: ${data.name}`);\n          allFiles.push(data);\n        }\n        return allFiles;\n      }\n\n      // Handle directory response\n      for (const item of data) {\n        if (item.type === 'file' && item.name.endsWith('.bpmn')) {\n          console.log(`📄 githubService.getBpmnFilesRecursive: Found BPMN file: ${item.name}`);\n          allFiles.push(item);\n        } else if (item.type === 'dir') {\n          console.log(`📁 githubService.getBpmnFilesRecursive: Found subdirectory: ${item.name}, recursing...`);\n          // Recursively search subdirectories\n          await this.getBpmnFilesRecursive(owner, repo, item.path, ref, allFiles);\n        }\n      }\n\n      console.log(`✅ githubService.getBpmnFilesRecursive: Completed search of ${path}, found ${allFiles.length} total files so far`);\n      return allFiles;\n    } catch (error) {\n      console.log(`❌ githubService.getBpmnFilesRecursive: Error searching ${path}:`, error.status, error.message);\n      // If directory doesn't exist, return empty array (not an error)\n      if (error.status === 404) {\n        return allFiles;\n      }\n      throw error;\n    }\n  }\n\n  // Get all BPMN files from a repository's business process directories\n  async getBpmnFiles(owner, repo, ref = 'main') {\n    console.log(`🔍 githubService.getBpmnFiles: Starting search for ${owner}/${repo} (ref: ${ref})`);\n    const allBpmnFiles = [];\n    \n    // Search for BPMN files in the specified business process directories\n    const possiblePaths = [\n      'input/business-processes',\n      'input/business-process'\n    ];\n\n    for (const path of possiblePaths) {\n      try {\n        console.log(`📁 githubService.getBpmnFiles: Searching in directory: ${path}`);\n        const files = await this.getBpmnFilesRecursive(owner, repo, path, ref);\n        console.log(`✅ githubService.getBpmnFiles: Found ${files.length} BPMN files in ${path}`);\n        allBpmnFiles.push(...files);\n      } catch (error) {\n        // Only log warnings for unexpected errors (not 404s which are expected when directories don't exist)\n        if (error.status !== 404) {\n          console.warn(`❌ Could not fetch BPMN files from ${path}:`, error.message);\n        } else {\n          console.log(`📂 githubService.getBpmnFiles: Directory ${path} not found (404) - this is expected if the directory doesn't exist`);\n        }\n        // Continue trying other paths\n      }\n    }\n\n    // Remove duplicates based on path (in case both directories exist and have overlapping files)\n    const uniqueFiles = allBpmnFiles.filter((file, index, self) => \n      index === self.findIndex(f => f.path === file.path)\n    );\n\n    console.log(`🎯 githubService.getBpmnFiles: Final result - ${uniqueFiles.length} unique BPMN files found`);\n    console.log(`📋 githubService.getBpmnFiles: File list:`, uniqueFiles.map(f => f.name));\n    return uniqueFiles;\n  }\n\n  // Get file content from GitHub repository with timeout handling\n  async getFileContent(owner, repo, path, ref = 'main') {\n    const timeoutMs = 15000; // 15 second timeout\n    \n    try {\n      console.log(`🚀 githubService.getFileContent: Starting request for ${owner}/${repo}/${path} (ref: ${ref})`);\n      console.log('🔐 githubService.getFileContent: Authentication status:', this.isAuth());\n      console.log('📋 githubService.getFileContent: Request parameters:', { owner, repo, path, ref });\n      \n      // Use authenticated octokit if available, otherwise create a public instance for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      console.log('🔧 githubService.getFileContent: Using', this.isAuth() ? 'authenticated' : 'public', 'octokit instance');\n      \n      // Create a promise that rejects after timeout\n      const timeoutPromise = new Promise((_, reject) => {\n        console.log(`⏰ githubService.getFileContent: Setting up ${timeoutMs}ms timeout`);\n        setTimeout(() => {\n          console.error(`⏰ githubService.getFileContent: Request timed out after ${timeoutMs}ms`);\n          reject(new Error(`Request timeout after ${timeoutMs}ms`));\n        }, timeoutMs);\n      });\n      \n      // Race the GitHub API call against the timeout\n      console.log('🌐 githubService.getFileContent: Creating GitHub API promise...');\n      const apiPromise = octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path,\n        ref\n      });\n      \n      console.log('📡 githubService.getFileContent: API request initiated, waiting for response...');\n      const startTime = Date.now();\n      \n      const { data } = await Promise.race([apiPromise, timeoutPromise]);\n      const responseTime = Date.now() - startTime;\n      \n      console.log(`✅ githubService.getFileContent: API response received in ${responseTime}ms`);\n      console.log('📂 githubService.getFileContent: Response data type:', data.type);\n      console.log('📊 githubService.getFileContent: Response details:', {\n        type: data.type,\n        name: data.name,\n        size: data.size,\n        encoding: data.encoding,\n        hasContent: !!data.content\n      });\n\n      // Handle file content\n      if (data.type === 'file' && data.content) {\n        // Decode base64 content\n        console.log('🔧 githubService.getFileContent: Decoding base64 content...');\n        console.log('📊 githubService.getFileContent: Base64 content length:', data.content.length);\n        \n        const content = decodeURIComponent(escape(atob(data.content)));\n        console.log(`✅ githubService.getFileContent: Successfully fetched and decoded file content`);\n        console.log('📏 githubService.getFileContent: Final content length:', content.length, 'characters');\n        console.log('👀 githubService.getFileContent: Content preview (first 200 chars):', content.substring(0, 200));\n        \n        return content;\n      } else {\n        console.error('❌ githubService.getFileContent: Invalid response - not a file or no content');\n        console.error('🔍 githubService.getFileContent: Full response data:', JSON.stringify(data, null, 2));\n        throw new Error('File not found or is not a file');\n      }\n    } catch (error) {\n      console.error(`💥 githubService.getFileContent: Failed to fetch file content from ${owner}/${repo}/${path}:`, error);\n      console.error('🔍 githubService.getFileContent: Error analysis:', {\n        type: typeof error,\n        status: error.status,\n        message: error.message,\n        name: error.name,\n        stack: error.stack?.substring(0, 500) + '...'\n      });\n      \n      // Provide more specific error messages\n      if (error.message.includes('timeout')) {\n        console.error('⏰ githubService.getFileContent: Timeout error detected');\n        throw new Error(`GitHub API request timed out after ${timeoutMs / 1000} seconds. Please try again.`);\n      } else if (error.status === 403) {\n        console.error('🔒 githubService.getFileContent: 403 Forbidden error detected');\n        throw new Error('Access denied. This repository may be private or you may have hit rate limits.');\n      } else if (error.status === 404) {\n        console.error('🔍 githubService.getFileContent: 404 Not Found error detected');\n        throw new Error('File not found in the repository.');\n      } else if (error.message.includes('rate limit')) {\n        console.error('🚦 githubService.getFileContent: Rate limit error detected');\n        throw new Error('GitHub API rate limit exceeded. Please try again later.');\n      } else if (error.message.includes('Network Error') || error.message.includes('Failed to fetch')) {\n        console.error('🌐 githubService.getFileContent: Network error detected');\n        throw new Error('Network error occurred. Please check your internet connection and try again.');\n      }\n      \n      console.error('❓ githubService.getFileContent: Unknown error type, re-throwing original error');\n      throw error;\n    }\n  }\n\n  // Create a commit with multiple files\n  async createCommit(owner, repo, branch, message, files) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      // Get the latest commit SHA\n      const { data: refData } = await this.octokit.rest.git.getRef({\n        owner,\n        repo,\n        ref: `heads/${branch}`\n      });\n      const latestCommitSha = refData.object.sha;\n\n      // Get the tree SHA from the latest commit\n      const { data: commitData } = await this.octokit.rest.git.getCommit({\n        owner,\n        repo,\n        commit_sha: latestCommitSha\n      });\n      const baseTreeSha = commitData.tree.sha;\n\n      // Create blobs for all files\n      const blobs = await Promise.all(\n        files.map(async (file) => {\n          const { data: blobData } = await this.octokit.rest.git.createBlob({\n            owner,\n            repo,\n            content: file.content,\n            encoding: 'utf-8'\n          });\n          return {\n            path: file.path,\n            mode: '100644',\n            type: 'blob',\n            sha: blobData.sha\n          };\n        })\n      );\n\n      // Create a new tree with the blobs\n      const { data: treeData } = await this.octokit.rest.git.createTree({\n        owner,\n        repo,\n        base_tree: baseTreeSha,\n        tree: blobs\n      });\n\n      // Create the commit\n      const { data: newCommitData } = await this.octokit.rest.git.createCommit({\n        owner,\n        repo,\n        message,\n        tree: treeData.sha,\n        parents: [latestCommitSha]\n      });\n\n      // Update the branch reference\n      await this.octokit.rest.git.updateRef({\n        owner,\n        repo,\n        ref: `heads/${branch}`,\n        sha: newCommitData.sha\n      });\n\n      return {\n        sha: newCommitData.sha,\n        html_url: `https://github.com/${owner}/${repo}/commit/${newCommitData.sha}`,\n        message: newCommitData.message,\n        author: newCommitData.author,\n        committer: newCommitData.committer\n      };\n    } catch (error) {\n      console.error('Failed to create commit:', error);\n      throw error;\n    }\n  }\n\n  // Get recent commits for a repository branch\n  async getRecentCommits(owner, repo, branch = 'main', per_page = 5) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/commits`, { sha: branch, per_page });\n\n    try {\n      const response = await this.octokit.rest.repos.listCommits({\n        owner,\n        repo,\n        sha: branch,\n        per_page\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/commits`, response.status, Date.now() - startTime);\n      \n      return response.data.map(commit => ({\n        sha: commit.sha,\n        message: commit.commit.message,\n        author: {\n          name: commit.commit.author.name,\n          email: commit.commit.author.email,\n          date: commit.commit.author.date\n        },\n        committer: {\n          name: commit.commit.committer.name,\n          email: commit.commit.committer.email,\n          date: commit.commit.committer.date\n        },\n        html_url: commit.html_url,\n        stats: commit.stats\n      }));\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/commits`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch recent commits:', error);\n      throw error;\n    }\n  }\n\n  // Get open pull requests count\n  async getOpenPullRequestsCount(owner, repo) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/pulls`, { state: 'open', per_page: 1 });\n\n    try {\n      const response = await this.octokit.rest.pulls.list({\n        owner,\n        repo,\n        state: 'open',\n        per_page: 1\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, response.status, Date.now() - startTime);\n      \n      // GitHub includes the total count in the response headers\n      const linkHeader = response.headers.link;\n      if (linkHeader && linkHeader.includes('rel=\"last\"')) {\n        const lastPageMatch = linkHeader.match(/page=(\\d+)>; rel=\"last\"/);\n        if (lastPageMatch) {\n          return parseInt(lastPageMatch[1], 10);\n        }\n      }\n      \n      // Fallback: use the length of returned items (may not be accurate for large counts)\n      return response.data.length;\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull requests count:', error);\n      throw error;\n    }\n  }\n\n  // Get pull request for a specific branch (returns first PR only for backward compatibility)\n  async getPullRequestForBranch(owner, repo, branchName) {\n    const prs = await this.getPullRequestsForBranch(owner, repo, branchName);\n    return prs && prs.length > 0 ? prs[0] : null;\n  }\n\n  // Get all pull requests for a specific branch\n  async getPullRequestsForBranch(owner, repo, branchName) {\n    // Use authenticated octokit if available, otherwise create a public instance for public repos\n    const octokit = this.isAuth() ? this.octokit : new Octokit();\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/pulls`, { state: 'open', head: `${owner}:${branchName}` });\n\n    try {\n      const response = await octokit.rest.pulls.list({\n        owner,\n        repo,\n        state: 'open',\n        head: `${owner}:${branchName}`,\n        per_page: 100 // Get up to 100 PRs for a branch\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, response.status, Date.now() - startTime);\n      \n      // Return all matching PRs or empty array if none found\n      return response.data || [];\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull requests for branch:', error);\n      return []; // Return empty array instead of throwing to allow graceful fallback\n    }\n  }\n\n  // Get pull request comments\n  async getPullRequestComments(owner, repo, pullNumber) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/pulls/${pullNumber}/comments`, {});\n\n    try {\n      const response = await this.octokit.rest.pulls.listReviewComments({\n        owner,\n        repo,\n        pull_number: pullNumber,\n        per_page: 100\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls/${pullNumber}/comments`, response.status, Date.now() - startTime);\n      return response.data;\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls/${pullNumber}/comments`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull request comments:', error);\n      throw error;\n    }\n  }\n\n  // Get pull request issue comments (general comments on the PR conversation)\n  async getPullRequestIssueComments(owner, repo, pullNumber) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, {});\n\n    try {\n      const response = await this.octokit.rest.issues.listComments({\n        owner,\n        repo,\n        issue_number: pullNumber,\n        per_page: 100\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, response.status, Date.now() - startTime);\n      return response.data;\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull request issue comments:', error);\n      throw error;\n    }\n  }\n\n  // Create a comment on a pull request\n  async createPullRequestComment(owner, repo, pullNumber, body) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('POST', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, { body });\n\n    try {\n      const response = await this.octokit.rest.issues.createComment({\n        owner,\n        repo,\n        issue_number: pullNumber,\n        body\n      });\n\n      this.logger.apiResponse('POST', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, response.status, Date.now() - startTime);\n      return response.data;\n    } catch (error) {\n      this.logger.apiResponse('POST', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to create pull request comment:', error);\n      throw error;\n    }\n  }\n\n  // Get open issues count\n  async getOpenIssuesCount(owner, repo) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/issues`, { state: 'open', per_page: 1 });\n\n    try {\n      const response = await this.octokit.rest.issues.listForRepo({\n        owner,\n        repo,\n        state: 'open',\n        per_page: 1\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/issues`, response.status, Date.now() - startTime);\n      \n      // GitHub includes the total count in the response headers\n      const linkHeader = response.headers.link;\n      if (linkHeader && linkHeader.includes('rel=\"last\"')) {\n        const lastPageMatch = linkHeader.match(/page=(\\d+)>; rel=\"last\"/);\n        if (lastPageMatch) {\n          return parseInt(lastPageMatch[1], 10);\n        }\n      }\n      \n      // Fallback: use the length of returned items (may not be accurate for large counts)\n      return response.data.length;\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/issues`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch issues count:', error);\n      throw error;\n    }\n  }\n\n  // Get repository statistics (combined method for efficiency)\n  async getRepositoryStats(owner, repo, branch = 'main') {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const [recentCommits, openPRsCount, openIssuesCount] = await Promise.allSettled([\n        this.getRecentCommits(owner, repo, branch, 1),\n        this.getOpenPullRequestsCount(owner, repo),\n        this.getOpenIssuesCount(owner, repo)\n      ]);\n\n      return {\n        recentCommits: recentCommits.status === 'fulfilled' ? recentCommits.value : [],\n        openPullRequestsCount: openPRsCount.status === 'fulfilled' ? openPRsCount.value : 0,\n        openIssuesCount: openIssuesCount.status === 'fulfilled' ? openIssuesCount.value : 0,\n        errors: {\n          recentCommits: recentCommits.status === 'rejected' ? recentCommits.reason : null,\n          openPullRequestsCount: openPRsCount.status === 'rejected' ? openPRsCount.reason : null,\n          openIssuesCount: openIssuesCount.status === 'rejected' ? openIssuesCount.reason : null\n        }\n      };\n    } catch (error) {\n      console.error('Failed to fetch repository stats:', error);\n      throw error;\n    }\n  }\n\n  // Get directory contents (supports both authenticated and unauthenticated access)\n  async getDirectoryContents(owner, repo, path = '', ref = 'main') {\n    try {\n      // Create temporary Octokit instance for unauthenticated access if needed\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const { data } = await octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path,\n        ref\n      });\n\n      if (Array.isArray(data)) {\n        return data;\n      } else {\n        throw new Error('Not a directory');\n      }\n    } catch (error) {\n      console.error(`Failed to get directory contents for ${path}:`, error);\n      throw error;\n    }\n  }\n\n  // Update file content (requires authentication)\n  async updateFile(owner, repo, path, content, message, branch = 'main') {\n    if (!this.isAuth()) {\n      throw new Error('Authentication required to update files');\n    }\n\n    try {\n      // First, get the current file to get its SHA\n      const { data: currentFile } = await this.octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path,\n        ref: branch\n      });\n\n      if (Array.isArray(currentFile)) {\n        throw new Error('Path is a directory, not a file');\n      }\n\n      // Update the file\n      const { data } = await this.octokit.rest.repos.createOrUpdateFileContents({\n        owner,\n        repo,\n        path,\n        message,\n        content: btoa(unescape(encodeURIComponent(content))),\n        sha: currentFile.sha,\n        branch\n      });\n\n      return data;\n    } catch (error) {\n      console.error(`Failed to update file ${path}:`, error);\n      throw error;\n    }\n  }\n\n  // Get commits for a repository (supports unauthenticated access)\n  async getCommits(owner, repo, options = {}) {\n    try {\n      // Create temporary Octokit instance for unauthenticated access if needed\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const params = {\n        owner,\n        repo,\n        per_page: options.per_page || 10,\n        page: options.page || 1\n      };\n\n      if (options.sha) {\n        params.sha = options.sha;\n      }\n\n      if (options.since) {\n        params.since = options.since;\n      }\n\n      if (options.until) {\n        params.until = options.until;\n      }\n\n      const { data } = await octokit.rest.repos.listCommits(params);\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch commits:', error);\n      throw error;\n    }\n  }\n\n  // Get issues for a repository (supports unauthenticated access)\n  async getIssues(owner, repo, options = {}) {\n    try {\n      // Create temporary Octokit instance for unauthenticated access if needed\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const params = {\n        owner,\n        repo,\n        state: options.state || 'all',\n        per_page: options.per_page || 30,\n        page: options.page || 1\n      };\n\n      if (options.labels) {\n        params.labels = options.labels;\n      }\n\n      if (options.milestone) {\n        params.milestone = options.milestone;\n      }\n\n      const { data } = await octokit.rest.issues.listForRepo(params);\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch issues:', error);\n      throw error;\n    }\n  }\n\n  // Alias method for backward compatibility - delegates to getIssues\n  async getRepositoryIssues(owner, repo, options = {}) {\n    return this.getIssues(owner, repo, options);\n  }\n\n  // Get repository forks\n  async getForks(owner, repo, options = {}) {\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/forks`, options);\n\n    try {\n      // Use the GitHub API to fetch forks, no authentication required for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const params = {\n        owner,\n        repo,\n        sort: options.sort || 'newest',\n        per_page: options.per_page || 100,\n        page: options.page || 1\n      };\n\n      const { data } = await octokit.rest.repos.listForks(params);\n      \n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/forks`, 200, Date.now() - startTime);\n      \n      // Return formatted fork data\n      return data.map(fork => ({\n        id: fork.id,\n        name: fork.name,\n        full_name: fork.full_name,\n        owner: {\n          login: fork.owner.login,\n          avatar_url: fork.owner.avatar_url,\n          html_url: fork.owner.html_url,\n          type: fork.owner.type\n        },\n        description: fork.description,\n        html_url: fork.html_url,\n        clone_url: fork.clone_url,\n        created_at: fork.created_at,\n        updated_at: fork.updated_at,\n        pushed_at: fork.pushed_at,\n        stargazers_count: fork.stargazers_count,\n        forks_count: fork.forks_count,\n        open_issues_count: fork.open_issues_count,\n        default_branch: fork.default_branch,\n        private: fork.private,\n        fork: fork.fork,\n        parent: fork.parent ? {\n          full_name: fork.parent.full_name,\n          html_url: fork.parent.html_url\n        } : null\n      }));\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/forks`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch repository forks:', error);\n      throw error;\n    }\n  }\n\n  // Get pull requests for a specific repository\n  async getPullRequests(owner, repo, options = {}) {\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/pulls`, options);\n\n    try {\n      // Use the GitHub API to fetch pull requests, no authentication required for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const params = {\n        owner,\n        repo,\n        state: options.state || 'open',\n        sort: options.sort || 'updated',\n        direction: options.direction || 'desc',\n        per_page: options.per_page || 30,\n        page: options.page || 1\n      };\n\n      // Add optional filters\n      if (options.head) {\n        params.head = options.head;\n      }\n      if (options.base) {\n        params.base = options.base;\n      }\n\n      const { data } = await octokit.rest.pulls.list(params);\n      \n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, 200, Date.now() - startTime);\n      \n      // Return formatted pull request data\n      return data.map(pr => ({\n        id: pr.id,\n        number: pr.number,\n        title: pr.title,\n        body: pr.body,\n        state: pr.state,\n        locked: pr.locked,\n        user: {\n          login: pr.user.login,\n          avatar_url: pr.user.avatar_url,\n          html_url: pr.user.html_url,\n          type: pr.user.type\n        },\n        created_at: pr.created_at,\n        updated_at: pr.updated_at,\n        closed_at: pr.closed_at,\n        merged_at: pr.merged_at,\n        html_url: pr.html_url,\n        diff_url: pr.diff_url,\n        patch_url: pr.patch_url,\n        head: {\n          ref: pr.head.ref,\n          sha: pr.head.sha,\n          repo: pr.head.repo ? {\n            name: pr.head.repo.name,\n            full_name: pr.head.repo.full_name,\n            owner: {\n              login: pr.head.repo.owner.login,\n              avatar_url: pr.head.repo.owner.avatar_url\n            },\n            html_url: pr.head.repo.html_url\n          } : null\n        },\n        base: {\n          ref: pr.base.ref,\n          sha: pr.base.sha,\n          repo: {\n            name: pr.base.repo.name,\n            full_name: pr.base.repo.full_name,\n            owner: {\n              login: pr.base.repo.owner.login,\n              avatar_url: pr.base.repo.owner.avatar_url\n            },\n            html_url: pr.base.repo.html_url\n          }\n        },\n        draft: pr.draft,\n        mergeable: pr.mergeable,\n        mergeable_state: pr.mergeable_state,\n        comments: pr.comments,\n        review_comments: pr.review_comments,\n        commits: pr.commits,\n        additions: pr.additions,\n        deletions: pr.deletions,\n        changed_files: pr.changed_files\n      }));\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull requests:', error);\n      throw error;\n    }\n  }\n\n  // Logout\n  logout() {\n    this.logger.auth('Logging out and clearing stored token');\n    \n    this.octokit = null;\n    this.isAuthenticated = false;\n    this.tokenType = null;\n    this.permissions = null;\n    \n    // Clear secure token storage\n    secureTokenStorage.clearToken();\n    \n    // Clear branch context on logout\n    try {\n      const { default: branchContextService } = require('../services/branchContextService');\n      branchContextService.clearAllBranchContext();\n    } catch (error) {\n      // Service might not be available during testing\n      sessionStorage.removeItem('sgex_branch_context');\n    }\n  }\n\n  // Get repository forks\n  async getRepositoryForks(owner, repo, options = {}) {\n    const startTime = Date.now();\n    this.logger.debug('Fetching repository forks', { owner, repo, options });\n\n    try {\n      // Create temporary Octokit instance for unauthenticated access if needed\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      this.logger.apiCall('GET', `/repos/${owner}/${repo}/forks`, options);\n      \n      const { data } = await octokit.rest.repos.listForks({\n        owner,\n        repo,\n        sort: 'newest', // Sort by newest first\n        per_page: options.per_page || 100,\n        page: options.page || 1\n      });\n\n      const duration = Date.now() - startTime;\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/forks`, 200, duration, { forkCount: data.length });\n      this.logger.performance('Repository forks fetch', duration);\n\n      return data;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      this.logger.apiError('GET', `/repos/${owner}/${repo}/forks`, error);\n      this.logger.performance('Repository forks fetch (failed)', duration);\n      console.error(`Failed to fetch forks for ${owner}/${repo}:`, error);\n      throw error;\n    }\n  }\n}\n\n// Create a singleton instance\nconst githubService = new GitHubService();\n\nexport default githubService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}