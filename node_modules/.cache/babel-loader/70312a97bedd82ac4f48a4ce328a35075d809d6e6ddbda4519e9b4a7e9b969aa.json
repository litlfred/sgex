{"ast":null,"code":"import inherits from 'inherits-browser';\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\nimport { is } from '../../../util/ModelUtil';\nimport { getChildLanes } from '../util/LaneUtil';\nimport { isHorizontal } from '../../../util/DiUtil';\nimport { eachElement } from 'diagram-js/lib/util/Elements';\n\n/**\n * @typedef {import('diagram-js/lib/core/EventBus').default} EventBus\n * @typedef {import('../../space-tool/BpmnSpaceTool').default} SpaceTool\n */\n\nvar LOW_PRIORITY = 500;\n\n/**\n * BPMN specific delete lane behavior.\n *\n * @param {EventBus} eventBus\n * @param {SpaceTool} spaceTool\n */\nexport default function DeleteLaneBehavior(eventBus, spaceTool) {\n  CommandInterceptor.call(this, eventBus);\n  function compensateLaneDelete(shape, oldParent) {\n    var isHorizontalLane = isHorizontal(shape);\n    var siblings = getChildLanes(oldParent);\n    var topAffected = [];\n    var bottomAffected = [];\n    var leftAffected = [];\n    var rightAffected = [];\n    eachElement(siblings, function (element) {\n      if (isHorizontalLane) {\n        if (element.y > shape.y) {\n          bottomAffected.push(element);\n        } else {\n          topAffected.push(element);\n        }\n      } else {\n        if (element.x > shape.x) {\n          rightAffected.push(element);\n        } else {\n          leftAffected.push(element);\n        }\n      }\n      return element.children;\n    });\n    if (!siblings.length) {\n      return;\n    }\n    var offset;\n    if (isHorizontalLane) {\n      if (bottomAffected.length && topAffected.length) {\n        offset = shape.height / 2;\n      } else {\n        offset = shape.height;\n      }\n    } else {\n      if (rightAffected.length && leftAffected.length) {\n        offset = shape.width / 2;\n      } else {\n        offset = shape.width;\n      }\n    }\n    var topAdjustments, bottomAdjustments, leftAdjustments, rightAdjustments;\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(topAffected, 'y', offset, shape.y - 10);\n      spaceTool.makeSpace(topAdjustments.movingShapes, topAdjustments.resizingShapes, {\n        x: 0,\n        y: offset\n      }, 's');\n    }\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(bottomAffected, 'y', -offset, shape.y + shape.height + 10);\n      spaceTool.makeSpace(bottomAdjustments.movingShapes, bottomAdjustments.resizingShapes, {\n        x: 0,\n        y: -offset\n      }, 'n');\n    }\n    if (leftAffected.length) {\n      leftAdjustments = spaceTool.calculateAdjustments(leftAffected, 'x', offset, shape.x - 10);\n      spaceTool.makeSpace(leftAdjustments.movingShapes, leftAdjustments.resizingShapes, {\n        x: offset,\n        y: 0\n      }, 'e');\n    }\n    if (rightAffected.length) {\n      rightAdjustments = spaceTool.calculateAdjustments(rightAffected, 'x', -offset, shape.x + shape.width + 10);\n      spaceTool.makeSpace(rightAdjustments.movingShapes, rightAdjustments.resizingShapes, {\n        x: -offset,\n        y: 0\n      }, 'w');\n    }\n  }\n\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n  this.postExecuted('shape.delete', LOW_PRIORITY, function (event) {\n    var context = event.context,\n      hints = context.hints,\n      shape = context.shape,\n      oldParent = context.oldParent;\n\n    // only compensate lane deletes\n    if (!is(shape, 'bpmn:Lane')) {\n      return;\n    }\n\n    // compensate root deletes only\n    if (hints && hints.nested) {\n      return;\n    }\n    compensateLaneDelete(shape, oldParent);\n  });\n}\nDeleteLaneBehavior.$inject = ['eventBus', 'spaceTool'];\ninherits(DeleteLaneBehavior, CommandInterceptor);","map":{"version":3,"names":["inherits","CommandInterceptor","is","getChildLanes","isHorizontal","eachElement","LOW_PRIORITY","DeleteLaneBehavior","eventBus","spaceTool","call","compensateLaneDelete","shape","oldParent","isHorizontalLane","siblings","topAffected","bottomAffected","leftAffected","rightAffected","element","y","push","x","children","length","offset","height","width","topAdjustments","bottomAdjustments","leftAdjustments","rightAdjustments","calculateAdjustments","makeSpace","movingShapes","resizingShapes","postExecuted","event","context","hints","nested","$inject"],"sources":["/home/runner/work/sgex/sgex/node_modules/bpmn-js/lib/features/modeling/behavior/DeleteLaneBehavior.js"],"sourcesContent":["import inherits from 'inherits-browser';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  getChildLanes\n} from '../util/LaneUtil';\n\nimport {\n  isHorizontal\n} from '../../../util/DiUtil';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\n/**\n * @typedef {import('diagram-js/lib/core/EventBus').default} EventBus\n * @typedef {import('../../space-tool/BpmnSpaceTool').default} SpaceTool\n */\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * BPMN specific delete lane behavior.\n *\n * @param {EventBus} eventBus\n * @param {SpaceTool} spaceTool\n */\nexport default function DeleteLaneBehavior(eventBus, spaceTool) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function compensateLaneDelete(shape, oldParent) {\n    var isHorizontalLane = isHorizontal(shape);\n\n    var siblings = getChildLanes(oldParent);\n\n    var topAffected = [];\n    var bottomAffected = [];\n    var leftAffected = [];\n    var rightAffected = [];\n\n    eachElement(siblings, function(element) {\n\n      if (isHorizontalLane) {\n        if (element.y > shape.y) {\n          bottomAffected.push(element);\n        } else {\n          topAffected.push(element);\n        }\n      } else {\n        if (element.x > shape.x) {\n          rightAffected.push(element);\n        } else {\n          leftAffected.push(element);\n        }\n      }\n\n      return element.children;\n    });\n\n    if (!siblings.length) {\n      return;\n    }\n\n    var offset;\n\n    if (isHorizontalLane) {\n      if (bottomAffected.length && topAffected.length) {\n        offset = shape.height / 2;\n      } else {\n        offset = shape.height;\n      }\n    } else {\n      if (rightAffected.length && leftAffected.length) {\n        offset = shape.width / 2;\n      } else {\n        offset = shape.width;\n      }\n    }\n\n    var topAdjustments,\n        bottomAdjustments,\n        leftAdjustments,\n        rightAdjustments;\n\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(\n        topAffected, 'y', offset, shape.y - 10);\n\n      spaceTool.makeSpace(\n        topAdjustments.movingShapes,\n        topAdjustments.resizingShapes,\n        { x: 0, y: offset }, 's');\n    }\n\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(\n        bottomAffected, 'y', -offset, shape.y + shape.height + 10);\n\n      spaceTool.makeSpace(\n        bottomAdjustments.movingShapes,\n        bottomAdjustments.resizingShapes,\n        { x: 0, y: -offset }, 'n');\n    }\n\n    if (leftAffected.length) {\n      leftAdjustments = spaceTool.calculateAdjustments(\n        leftAffected, 'x', offset, shape.x - 10);\n\n      spaceTool.makeSpace(\n        leftAdjustments.movingShapes,\n        leftAdjustments.resizingShapes,\n        { x: offset, y: 0 }, 'e');\n    }\n\n    if (rightAffected.length) {\n      rightAdjustments = spaceTool.calculateAdjustments(\n        rightAffected, 'x', -offset, shape.x + shape.width + 10);\n\n      spaceTool.makeSpace(\n        rightAdjustments.movingShapes,\n        rightAdjustments.resizingShapes,\n        { x: -offset, y: 0 }, 'w');\n    }\n  }\n\n\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n  this.postExecuted('shape.delete', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        oldParent = context.oldParent;\n\n    // only compensate lane deletes\n    if (!is(shape, 'bpmn:Lane')) {\n      return;\n    }\n\n    // compensate root deletes only\n    if (hints && hints.nested) {\n      return;\n    }\n\n    compensateLaneDelete(shape, oldParent);\n  });\n}\n\nDeleteLaneBehavior.$inject = [\n  'eventBus',\n  'spaceTool'\n];\n\ninherits(DeleteLaneBehavior, CommandInterceptor);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}