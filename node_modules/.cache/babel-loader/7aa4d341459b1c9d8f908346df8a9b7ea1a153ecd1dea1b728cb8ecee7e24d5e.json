{"ast":null,"code":"import { assign, filter, forEach, isNumber } from 'min-dash';\nimport { asTRBL, getMid } from '../../layout/LayoutUtil';\nimport { getBBox } from '../../util/Elements';\nimport { getDirection } from './SpaceUtil';\nimport { hasPrimaryModifier, hasSecondaryModifier } from '../../util/Mouse';\nimport { set as setCursor } from '../../util/Cursor';\nimport { selfAndAllChildren } from '../../util/Elements';\nimport { isConnection, isLabel } from '../../util/ModelUtil';\n\n/**\n * @typedef {import('../../core/Types').ShapeLike} Shape\n *\n * @typedef {import('../../core/Canvas').default} Canvas\n * @typedef {import('../dragging/Dragging').default} Dragging\n * @typedef {import('../../core/EventBus').default} EventBus\n * @typedef {import('../modeling/Modeling').default} Modeling\n * @typedef {import('../mouse/Mouse').default} Mouse\n * @typedef {import('../rules/Rules').default} Rules\n * @typedef {import('../tool-manager/ToolManager').default} ToolManager\n *\n * @typedef {import('../../util/Types').Axis} Axis\n * @typedef {import('../../util/Types').Direction} Direction\n * @typedef {import('../../util/Types').Point} Point\n */\n\nvar abs = Math.abs,\n  round = Math.round;\nvar AXIS_TO_DIMENSION = {\n  x: 'width',\n  y: 'height'\n};\nvar CURSOR_CROSSHAIR = 'crosshair';\nvar DIRECTION_TO_TRBL = {\n  n: 'top',\n  w: 'left',\n  s: 'bottom',\n  e: 'right'\n};\nvar HIGH_PRIORITY = 1500;\nvar DIRECTION_TO_OPPOSITE = {\n  n: 's',\n  w: 'e',\n  s: 'n',\n  e: 'w'\n};\nvar PADDING = 20;\n\n/**\n * Add or remove space by moving and resizing elements.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n * @param {ToolManager} toolManager\n * @param {Mouse} mouse\n */\nexport default function SpaceTool(canvas, dragging, eventBus, modeling, rules, toolManager, mouse) {\n  this._canvas = canvas;\n  this._dragging = dragging;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._rules = rules;\n  this._toolManager = toolManager;\n  this._mouse = mouse;\n  var self = this;\n  toolManager.registerTool('space', {\n    tool: 'spaceTool.selection',\n    dragging: 'spaceTool'\n  });\n  eventBus.on('spaceTool.selection.end', function (event) {\n    eventBus.once('spaceTool.selection.ended', function () {\n      self.activateMakeSpace(event.originalEvent);\n    });\n  });\n  eventBus.on('spaceTool.move', HIGH_PRIORITY, function (event) {\n    var context = event.context,\n      initialized = context.initialized;\n    if (!initialized) {\n      initialized = context.initialized = self.init(event, context);\n    }\n    if (initialized) {\n      ensureConstraints(event);\n    }\n  });\n  eventBus.on('spaceTool.end', function (event) {\n    var context = event.context,\n      axis = context.axis,\n      direction = context.direction,\n      movingShapes = context.movingShapes,\n      resizingShapes = context.resizingShapes,\n      start = context.start;\n    if (!context.initialized) {\n      return;\n    }\n    ensureConstraints(event);\n    var delta = {\n      x: 0,\n      y: 0\n    };\n    delta[axis] = round(event['d' + axis]);\n    self.makeSpace(movingShapes, resizingShapes, delta, direction, start);\n    eventBus.once('spaceTool.ended', function (event) {\n      // activate space tool selection after make space\n      self.activateSelection(event.originalEvent, true, true);\n    });\n  });\n}\nSpaceTool.$inject = ['canvas', 'dragging', 'eventBus', 'modeling', 'rules', 'toolManager', 'mouse'];\n\n/**\n * Activate space tool selection.\n *\n * @param {MouseEvent|TouchEvent} event\n * @param {boolean} autoActivate\n * @param {boolean} reactivate\n */\nSpaceTool.prototype.activateSelection = function (event, autoActivate, reactivate) {\n  this._dragging.init(event, 'spaceTool.selection', {\n    autoActivate: autoActivate,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    },\n    trapClick: false\n  });\n};\n\n/**\n * Activate space tool make space.\n *\n * @param {MouseEvent|TouchEvent} event\n */\nSpaceTool.prototype.activateMakeSpace = function (event) {\n  this._dragging.init(event, 'spaceTool', {\n    autoActivate: true,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {}\n    }\n  });\n};\n\n/**\n * Make space.\n *\n * @param {Array<Shape>} movingShapes\n * @param {Array<Shape>} resizingShapes\n * @param {Point} delta\n * @param {Direction} direction\n * @param {number} start\n */\nSpaceTool.prototype.makeSpace = function (movingShapes, resizingShapes, delta, direction, start) {\n  return this._modeling.createSpace(movingShapes, resizingShapes, delta, direction, start);\n};\n\n/**\n * Initialize make space and return true if that was successful.\n *\n * @param {MouseEvent|TouchEvent} event\n * @param {Object} context\n *\n * @return {boolean}\n */\nSpaceTool.prototype.init = function (event, context) {\n  var axis = abs(event.dx) > abs(event.dy) ? 'x' : 'y',\n    delta = event['d' + axis],\n    start = event[axis] - delta;\n  if (abs(delta) < 5) {\n    return false;\n  }\n\n  // invert delta to remove space when moving left\n  if (delta < 0) {\n    delta *= -1;\n  }\n\n  // invert delta to add/remove space when removing/adding space if modifier key is pressed\n  if (hasPrimaryModifier(event)) {\n    delta *= -1;\n  }\n  var direction = getDirection(axis, delta);\n  var root = this._canvas.getRootElement();\n  if (!hasSecondaryModifier(event) && event.hover) {\n    root = event.hover;\n  }\n  var children = [...selfAndAllChildren(root, true), ...(root.attachers || [])];\n  var elements = this.calculateAdjustments(children, axis, delta, start);\n  var minDimensions = this._eventBus.fire('spaceTool.getMinDimensions', {\n    axis: axis,\n    direction: direction,\n    shapes: elements.resizingShapes,\n    start: start\n  });\n  var spaceToolConstraints = getSpaceToolConstraints(elements, axis, direction, start, minDimensions);\n  assign(context, elements, {\n    axis: axis,\n    direction: direction,\n    spaceToolConstraints: spaceToolConstraints,\n    start: start\n  });\n  setCursor('resize-' + (axis === 'x' ? 'ew' : 'ns'));\n  return true;\n};\n\n/**\n * Get elements to be moved and resized.\n *\n * @param {Array<Shape>} elements\n * @param {Axis} axis\n * @param {Point} delta\n * @param {number} start\n *\n * @return {Object}\n */\nSpaceTool.prototype.calculateAdjustments = function (elements, axis, delta, start) {\n  var rules = this._rules;\n  var movingShapes = [],\n    resizingShapes = [];\n  var attachers = [],\n    connections = [];\n  function moveShape(shape) {\n    if (!movingShapes.includes(shape)) {\n      movingShapes.push(shape);\n    }\n    var label = shape.label;\n\n    // move external label if its label target is moving\n    if (label && !movingShapes.includes(label)) {\n      movingShapes.push(label);\n    }\n  }\n  function resizeShape(shape) {\n    if (!resizingShapes.includes(shape)) {\n      resizingShapes.push(shape);\n    }\n  }\n  forEach(elements, function (element) {\n    if (!element.parent || isLabel(element)) {\n      return;\n    }\n\n    // handle connections separately\n    if (isConnection(element)) {\n      connections.push(element);\n      return;\n    }\n    var shapeStart = element[axis],\n      shapeEnd = shapeStart + element[AXIS_TO_DIMENSION[axis]];\n\n    // handle attachers separately\n    if (isAttacher(element) && (delta > 0 && getMid(element)[axis] > start || delta < 0 && getMid(element)[axis] < start)) {\n      attachers.push(element);\n      return;\n    }\n\n    // move shape if its start is after space tool\n    if (delta > 0 && shapeStart > start || delta < 0 && shapeEnd < start) {\n      moveShape(element);\n      return;\n    }\n\n    // resize shape if it's resizable and its start is before and its end is after space tool\n    if (shapeStart < start && shapeEnd > start && rules.allowed('shape.resize', {\n      shape: element\n    })) {\n      resizeShape(element);\n      return;\n    }\n  });\n\n  // move attacher if its host is moving\n  forEach(movingShapes, function (shape) {\n    var attachers = shape.attachers;\n    if (attachers) {\n      forEach(attachers, function (attacher) {\n        moveShape(attacher);\n      });\n    }\n  });\n  var allShapes = movingShapes.concat(resizingShapes);\n\n  // move attacher if its mid is after space tool and its host is moving or resizing\n  forEach(attachers, function (attacher) {\n    var host = attacher.host;\n    if (includes(allShapes, host)) {\n      moveShape(attacher);\n    }\n  });\n  allShapes = movingShapes.concat(resizingShapes);\n\n  // move external label if its label target's (connection) source and target are moving\n  forEach(connections, function (connection) {\n    var source = connection.source,\n      target = connection.target,\n      label = connection.label;\n    if (includes(allShapes, source) && includes(allShapes, target) && label) {\n      moveShape(label);\n    }\n  });\n  return {\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes\n  };\n};\nSpaceTool.prototype.toggle = function () {\n  if (this.isActive()) {\n    return this._dragging.cancel();\n  }\n  var mouseEvent = this._mouse.getLastMoveEvent();\n  this.activateSelection(mouseEvent, !!mouseEvent);\n};\nSpaceTool.prototype.isActive = function () {\n  var context = this._dragging.context();\n  if (context) {\n    return /^spaceTool/.test(context.prefix);\n  }\n  return false;\n};\n\n// helpers //////////\n\nfunction addPadding(trbl) {\n  return {\n    top: trbl.top - PADDING,\n    right: trbl.right + PADDING,\n    bottom: trbl.bottom + PADDING,\n    left: trbl.left - PADDING\n  };\n}\nfunction ensureConstraints(event) {\n  var context = event.context,\n    spaceToolConstraints = context.spaceToolConstraints;\n  if (!spaceToolConstraints) {\n    return;\n  }\n  var x, y;\n  if (isNumber(spaceToolConstraints.left)) {\n    x = Math.max(event.x, spaceToolConstraints.left);\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n  if (isNumber(spaceToolConstraints.right)) {\n    x = Math.min(event.x, spaceToolConstraints.right);\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n  if (isNumber(spaceToolConstraints.top)) {\n    y = Math.max(event.y, spaceToolConstraints.top);\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n  if (isNumber(spaceToolConstraints.bottom)) {\n    y = Math.min(event.y, spaceToolConstraints.bottom);\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n}\nfunction getSpaceToolConstraints(elements, axis, direction, start, minDimensions) {\n  var movingShapes = elements.movingShapes,\n    resizingShapes = elements.resizingShapes;\n  if (!resizingShapes.length) {\n    return;\n  }\n  var spaceToolConstraints = {},\n    min,\n    max;\n  forEach(resizingShapes, function (resizingShape) {\n    var attachers = resizingShape.attachers,\n      children = resizingShape.children;\n    var resizingShapeBBox = asTRBL(resizingShape);\n\n    // find children that are not moving or resizing\n    var nonMovingResizingChildren = filter(children, function (child) {\n      return !isConnection(child) && !isLabel(child) && !includes(movingShapes, child) && !includes(resizingShapes, child);\n    });\n\n    // find children that are moving\n    var movingChildren = filter(children, function (child) {\n      return !isConnection(child) && !isLabel(child) && includes(movingShapes, child);\n    });\n    var minOrMax,\n      nonMovingResizingChildrenBBox,\n      movingChildrenBBox,\n      movingAttachers = [],\n      nonMovingAttachers = [],\n      movingAttachersBBox,\n      movingAttachersConstraint,\n      nonMovingAttachersBBox,\n      nonMovingAttachersConstraint;\n    if (nonMovingResizingChildren.length) {\n      nonMovingResizingChildrenBBox = addPadding(asTRBL(getBBox(nonMovingResizingChildren)));\n      minOrMax = start - resizingShapeBBox[DIRECTION_TO_TRBL[direction]] + nonMovingResizingChildrenBBox[DIRECTION_TO_TRBL[direction]];\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n    if (movingChildren.length) {\n      movingChildrenBBox = addPadding(asTRBL(getBBox(movingChildren)));\n      minOrMax = start - movingChildrenBBox[DIRECTION_TO_TRBL[DIRECTION_TO_OPPOSITE[direction]]] + resizingShapeBBox[DIRECTION_TO_TRBL[DIRECTION_TO_OPPOSITE[direction]]];\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n    if (attachers && attachers.length) {\n      attachers.forEach(function (attacher) {\n        if (includes(movingShapes, attacher)) {\n          movingAttachers.push(attacher);\n        } else {\n          nonMovingAttachers.push(attacher);\n        }\n      });\n      if (movingAttachers.length) {\n        movingAttachersBBox = asTRBL(getBBox(movingAttachers.map(getMid)));\n        movingAttachersConstraint = resizingShapeBBox[DIRECTION_TO_TRBL[DIRECTION_TO_OPPOSITE[direction]]] - (movingAttachersBBox[DIRECTION_TO_TRBL[DIRECTION_TO_OPPOSITE[direction]]] - start);\n      }\n      if (nonMovingAttachers.length) {\n        nonMovingAttachersBBox = asTRBL(getBBox(nonMovingAttachers.map(getMid)));\n        nonMovingAttachersConstraint = nonMovingAttachersBBox[DIRECTION_TO_TRBL[direction]] - (resizingShapeBBox[DIRECTION_TO_TRBL[direction]] - start);\n      }\n      if (direction === 'n') {\n        minOrMax = Math.min(movingAttachersConstraint || Infinity, nonMovingAttachersConstraint || Infinity);\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        minOrMax = Math.min(movingAttachersConstraint || Infinity, nonMovingAttachersConstraint || Infinity);\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        minOrMax = Math.max(movingAttachersConstraint || -Infinity, nonMovingAttachersConstraint || -Infinity);\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        minOrMax = Math.max(movingAttachersConstraint || -Infinity, nonMovingAttachersConstraint || -Infinity);\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n    var resizingShapeMinDimensions = minDimensions && minDimensions[resizingShape.id];\n    if (resizingShapeMinDimensions) {\n      if (direction === 'n') {\n        minOrMax = start + resizingShape[AXIS_TO_DIMENSION[axis]] - resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]];\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        minOrMax = start + resizingShape[AXIS_TO_DIMENSION[axis]] - resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]];\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        minOrMax = start - resizingShape[AXIS_TO_DIMENSION[axis]] + resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]];\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        minOrMax = start - resizingShape[AXIS_TO_DIMENSION[axis]] + resizingShapeMinDimensions[AXIS_TO_DIMENSION[axis]];\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n  });\n  return spaceToolConstraints;\n}\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\nfunction isAttacher(element) {\n  return !!element.host;\n}","map":{"version":3,"names":["assign","filter","forEach","isNumber","asTRBL","getMid","getBBox","getDirection","hasPrimaryModifier","hasSecondaryModifier","set","setCursor","selfAndAllChildren","isConnection","isLabel","abs","Math","round","AXIS_TO_DIMENSION","x","y","CURSOR_CROSSHAIR","DIRECTION_TO_TRBL","n","w","s","e","HIGH_PRIORITY","DIRECTION_TO_OPPOSITE","PADDING","SpaceTool","canvas","dragging","eventBus","modeling","rules","toolManager","mouse","_canvas","_dragging","_eventBus","_modeling","_rules","_toolManager","_mouse","self","registerTool","tool","on","event","once","activateMakeSpace","originalEvent","context","initialized","init","ensureConstraints","axis","direction","movingShapes","resizingShapes","start","delta","makeSpace","activateSelection","$inject","prototype","autoActivate","reactivate","cursor","data","trapClick","createSpace","dx","dy","root","getRootElement","hover","children","attachers","elements","calculateAdjustments","minDimensions","fire","shapes","spaceToolConstraints","getSpaceToolConstraints","connections","moveShape","shape","includes","push","label","resizeShape","element","parent","shapeStart","shapeEnd","isAttacher","allowed","attacher","allShapes","concat","host","connection","source","target","toggle","isActive","cancel","mouseEvent","getLastMoveEvent","test","prefix","addPadding","trbl","top","right","bottom","left","max","min","length","resizingShape","resizingShapeBBox","nonMovingResizingChildren","child","movingChildren","minOrMax","nonMovingResizingChildrenBBox","movingChildrenBBox","movingAttachers","nonMovingAttachers","movingAttachersBBox","movingAttachersConstraint","nonMovingAttachersBBox","nonMovingAttachersConstraint","map","Infinity","resizingShapeMinDimensions","id","array","item","indexOf"],"sources":["/home/runner/work/sgex/sgex/node_modules/diagram-js/lib/features/space-tool/SpaceTool.js"],"sourcesContent":["import {\n  assign,\n  filter,\n  forEach,\n  isNumber\n} from 'min-dash';\n\nimport {\n  asTRBL,\n  getMid\n} from '../../layout/LayoutUtil';\n\nimport { getBBox } from '../../util/Elements';\n\nimport { getDirection } from './SpaceUtil';\n\nimport {\n  hasPrimaryModifier,\n  hasSecondaryModifier\n} from '../../util/Mouse';\n\nimport { set as setCursor } from '../../util/Cursor';\n\nimport { selfAndAllChildren } from '../../util/Elements';\n\nimport {\n  isConnection,\n  isLabel\n} from '../../util/ModelUtil';\n\n/**\n * @typedef {import('../../core/Types').ShapeLike} Shape\n *\n * @typedef {import('../../core/Canvas').default} Canvas\n * @typedef {import('../dragging/Dragging').default} Dragging\n * @typedef {import('../../core/EventBus').default} EventBus\n * @typedef {import('../modeling/Modeling').default} Modeling\n * @typedef {import('../mouse/Mouse').default} Mouse\n * @typedef {import('../rules/Rules').default} Rules\n * @typedef {import('../tool-manager/ToolManager').default} ToolManager\n *\n * @typedef {import('../../util/Types').Axis} Axis\n * @typedef {import('../../util/Types').Direction} Direction\n * @typedef {import('../../util/Types').Point} Point\n */\n\nvar abs = Math.abs,\n    round = Math.round;\n\nvar AXIS_TO_DIMENSION = {\n  x: 'width',\n  y: 'height'\n};\n\nvar CURSOR_CROSSHAIR = 'crosshair';\n\nvar DIRECTION_TO_TRBL = {\n  n: 'top',\n  w: 'left',\n  s: 'bottom',\n  e: 'right'\n};\n\nvar HIGH_PRIORITY = 1500;\n\nvar DIRECTION_TO_OPPOSITE = {\n  n: 's',\n  w: 'e',\n  s: 'n',\n  e: 'w'\n};\n\nvar PADDING = 20;\n\n\n/**\n * Add or remove space by moving and resizing elements.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n * @param {ToolManager} toolManager\n * @param {Mouse} mouse\n */\nexport default function SpaceTool(\n    canvas, dragging, eventBus,\n    modeling, rules, toolManager,\n    mouse) {\n\n  this._canvas = canvas;\n  this._dragging = dragging;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._rules = rules;\n  this._toolManager = toolManager;\n  this._mouse = mouse;\n\n  var self = this;\n\n  toolManager.registerTool('space', {\n    tool: 'spaceTool.selection',\n    dragging: 'spaceTool'\n  });\n\n  eventBus.on('spaceTool.selection.end', function(event) {\n    eventBus.once('spaceTool.selection.ended', function() {\n      self.activateMakeSpace(event.originalEvent);\n    });\n  });\n\n  eventBus.on('spaceTool.move', HIGH_PRIORITY , function(event) {\n    var context = event.context,\n        initialized = context.initialized;\n\n    if (!initialized) {\n      initialized = context.initialized = self.init(event, context);\n    }\n\n    if (initialized) {\n      ensureConstraints(event);\n    }\n  });\n\n  eventBus.on('spaceTool.end', function(event) {\n    var context = event.context,\n        axis = context.axis,\n        direction = context.direction,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes,\n        start = context.start;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    ensureConstraints(event);\n\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    delta[ axis ] = round(event[ 'd' + axis ]);\n\n    self.makeSpace(movingShapes, resizingShapes, delta, direction, start);\n\n    eventBus.once('spaceTool.ended', function(event) {\n\n      // activate space tool selection after make space\n      self.activateSelection(event.originalEvent, true, true);\n    });\n  });\n}\n\nSpaceTool.$inject = [\n  'canvas',\n  'dragging',\n  'eventBus',\n  'modeling',\n  'rules',\n  'toolManager',\n  'mouse'\n];\n\n/**\n * Activate space tool selection.\n *\n * @param {MouseEvent|TouchEvent} event\n * @param {boolean} autoActivate\n * @param {boolean} reactivate\n */\nSpaceTool.prototype.activateSelection = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'spaceTool.selection', {\n    autoActivate: autoActivate,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    },\n    trapClick: false\n  });\n};\n\n/**\n * Activate space tool make space.\n *\n * @param {MouseEvent|TouchEvent} event\n */\nSpaceTool.prototype.activateMakeSpace = function(event) {\n  this._dragging.init(event, 'spaceTool', {\n    autoActivate: true,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {}\n    }\n  });\n};\n\n/**\n * Make space.\n *\n * @param {Array<Shape>} movingShapes\n * @param {Array<Shape>} resizingShapes\n * @param {Point} delta\n * @param {Direction} direction\n * @param {number} start\n */\nSpaceTool.prototype.makeSpace = function(movingShapes, resizingShapes, delta, direction, start) {\n  return this._modeling.createSpace(movingShapes, resizingShapes, delta, direction, start);\n};\n\n/**\n * Initialize make space and return true if that was successful.\n *\n * @param {MouseEvent|TouchEvent} event\n * @param {Object} context\n *\n * @return {boolean}\n */\nSpaceTool.prototype.init = function(event, context) {\n  var axis = abs(event.dx) > abs(event.dy) ? 'x' : 'y',\n      delta = event[ 'd' + axis ],\n      start = event[ axis ] - delta;\n\n  if (abs(delta) < 5) {\n    return false;\n  }\n\n  // invert delta to remove space when moving left\n  if (delta < 0) {\n    delta *= -1;\n  }\n\n  // invert delta to add/remove space when removing/adding space if modifier key is pressed\n  if (hasPrimaryModifier(event)) {\n    delta *= -1;\n  }\n\n  var direction = getDirection(axis, delta);\n\n  var root = this._canvas.getRootElement();\n\n  if (!hasSecondaryModifier(event) && event.hover) {\n    root = event.hover;\n  }\n\n  var children = [\n    ...selfAndAllChildren(root, true),\n    ...(root.attachers || [])\n  ];\n\n  var elements = this.calculateAdjustments(children, axis, delta, start);\n\n  var minDimensions = this._eventBus.fire('spaceTool.getMinDimensions', {\n    axis: axis,\n    direction: direction,\n    shapes: elements.resizingShapes,\n    start: start\n  });\n\n  var spaceToolConstraints = getSpaceToolConstraints(elements, axis, direction, start, minDimensions);\n\n  assign(\n    context,\n    elements,\n    {\n      axis: axis,\n      direction: direction,\n      spaceToolConstraints: spaceToolConstraints,\n      start: start\n    }\n  );\n\n  setCursor('resize-' + (axis === 'x' ? 'ew' : 'ns'));\n\n  return true;\n};\n\n/**\n * Get elements to be moved and resized.\n *\n * @param {Array<Shape>} elements\n * @param {Axis} axis\n * @param {Point} delta\n * @param {number} start\n *\n * @return {Object}\n */\nSpaceTool.prototype.calculateAdjustments = function(elements, axis, delta, start) {\n  var rules = this._rules;\n\n  var movingShapes = [],\n      resizingShapes = [];\n\n  var attachers = [],\n      connections = [];\n\n  function moveShape(shape) {\n    if (!movingShapes.includes(shape)) {\n      movingShapes.push(shape);\n    }\n\n    var label = shape.label;\n\n    // move external label if its label target is moving\n    if (label && !movingShapes.includes(label)) {\n      movingShapes.push(label);\n    }\n  }\n\n  function resizeShape(shape) {\n    if (!resizingShapes.includes(shape)) {\n      resizingShapes.push(shape);\n    }\n  }\n\n  forEach(elements, function(element) {\n    if (!element.parent || isLabel(element)) {\n      return;\n    }\n\n    // handle connections separately\n    if (isConnection(element)) {\n      connections.push(element);\n\n      return;\n    }\n\n    var shapeStart = element[ axis ],\n        shapeEnd = shapeStart + element[ AXIS_TO_DIMENSION[ axis ] ];\n\n    // handle attachers separately\n    if (isAttacher(element)\n      && ((delta > 0 && getMid(element)[ axis ] > start)\n        || (delta < 0 && getMid(element)[ axis ] < start))) {\n      attachers.push(element);\n\n      return;\n    }\n\n    // move shape if its start is after space tool\n    if ((delta > 0 && shapeStart > start)\n      || (delta < 0 && shapeEnd < start)) {\n      moveShape(element);\n\n      return;\n    }\n\n    // resize shape if it's resizable and its start is before and its end is after space tool\n    if (shapeStart < start\n      && shapeEnd > start\n      && rules.allowed('shape.resize', { shape: element })\n    ) {\n      resizeShape(element);\n\n      return;\n    }\n  });\n\n  // move attacher if its host is moving\n  forEach(movingShapes, function(shape) {\n    var attachers = shape.attachers;\n\n    if (attachers) {\n      forEach(attachers, function(attacher) {\n        moveShape(attacher);\n      });\n    }\n  });\n\n  var allShapes = movingShapes.concat(resizingShapes);\n\n  // move attacher if its mid is after space tool and its host is moving or resizing\n  forEach(attachers, function(attacher) {\n    var host = attacher.host;\n\n    if (includes(allShapes, host)) {\n      moveShape(attacher);\n    }\n  });\n\n  allShapes = movingShapes.concat(resizingShapes);\n\n  // move external label if its label target's (connection) source and target are moving\n  forEach(connections, function(connection) {\n    var source = connection.source,\n        target = connection.target,\n        label = connection.label;\n\n    if (includes(allShapes, source)\n      && includes(allShapes, target)\n      && label) {\n      moveShape(label);\n    }\n  });\n\n  return {\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes\n  };\n};\n\nSpaceTool.prototype.toggle = function() {\n\n  if (this.isActive()) {\n    return this._dragging.cancel();\n  }\n\n  var mouseEvent = this._mouse.getLastMoveEvent();\n\n  this.activateSelection(mouseEvent, !!mouseEvent);\n};\n\nSpaceTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  if (context) {\n    return /^spaceTool/.test(context.prefix);\n  }\n\n  return false;\n};\n\n// helpers //////////\n\nfunction addPadding(trbl) {\n  return {\n    top: trbl.top - PADDING,\n    right: trbl.right + PADDING,\n    bottom: trbl.bottom + PADDING,\n    left: trbl.left - PADDING\n  };\n}\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      spaceToolConstraints = context.spaceToolConstraints;\n\n  if (!spaceToolConstraints) {\n    return;\n  }\n\n  var x, y;\n\n  if (isNumber(spaceToolConstraints.left)) {\n    x = Math.max(event.x, spaceToolConstraints.left);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (isNumber(spaceToolConstraints.right)) {\n    x = Math.min(event.x, spaceToolConstraints.right);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (isNumber(spaceToolConstraints.top)) {\n    y = Math.max(event.y, spaceToolConstraints.top);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n\n  if (isNumber(spaceToolConstraints.bottom)) {\n    y = Math.min(event.y, spaceToolConstraints.bottom);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n}\n\nfunction getSpaceToolConstraints(elements, axis, direction, start, minDimensions) {\n  var movingShapes = elements.movingShapes,\n      resizingShapes = elements.resizingShapes;\n\n  if (!resizingShapes.length) {\n    return;\n  }\n\n  var spaceToolConstraints = {},\n      min,\n      max;\n\n  forEach(resizingShapes, function(resizingShape) {\n    var attachers = resizingShape.attachers,\n        children = resizingShape.children;\n\n    var resizingShapeBBox = asTRBL(resizingShape);\n\n    // find children that are not moving or resizing\n    var nonMovingResizingChildren = filter(children, function(child) {\n      return !isConnection(child) &&\n        !isLabel(child) &&\n        !includes(movingShapes, child) &&\n        !includes(resizingShapes, child);\n    });\n\n    // find children that are moving\n    var movingChildren = filter(children, function(child) {\n      return !isConnection(child) && !isLabel(child) && includes(movingShapes, child);\n    });\n\n    var minOrMax,\n        nonMovingResizingChildrenBBox,\n        movingChildrenBBox,\n        movingAttachers = [],\n        nonMovingAttachers = [],\n        movingAttachersBBox,\n        movingAttachersConstraint,\n        nonMovingAttachersBBox,\n        nonMovingAttachersConstraint;\n\n    if (nonMovingResizingChildren.length) {\n      nonMovingResizingChildrenBBox = addPadding(asTRBL(getBBox(nonMovingResizingChildren)));\n\n      minOrMax = start -\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ direction ] ] +\n        nonMovingResizingChildrenBBox[ DIRECTION_TO_TRBL[ direction ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    if (movingChildren.length) {\n      movingChildrenBBox = addPadding(asTRBL(getBBox(movingChildren)));\n\n      minOrMax = start -\n        movingChildrenBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ] +\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    if (attachers && attachers.length) {\n      attachers.forEach(function(attacher) {\n        if (includes(movingShapes, attacher)) {\n          movingAttachers.push(attacher);\n        } else {\n          nonMovingAttachers.push(attacher);\n        }\n      });\n\n      if (movingAttachers.length) {\n        movingAttachersBBox = asTRBL(getBBox(movingAttachers.map(getMid)));\n\n        movingAttachersConstraint = resizingShapeBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ]\n              - (movingAttachersBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ] - start);\n      }\n\n      if (nonMovingAttachers.length) {\n        nonMovingAttachersBBox = asTRBL(getBBox(nonMovingAttachers.map(getMid)));\n\n        nonMovingAttachersConstraint = nonMovingAttachersBBox[ DIRECTION_TO_TRBL[ direction ] ]\n              - (resizingShapeBBox[ DIRECTION_TO_TRBL[ direction ] ] - start);\n      }\n\n      if (direction === 'n') {\n        minOrMax = Math.min(movingAttachersConstraint || Infinity, nonMovingAttachersConstraint || Infinity);\n\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        minOrMax = Math.min(movingAttachersConstraint || Infinity, nonMovingAttachersConstraint || Infinity);\n\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        minOrMax = Math.max(movingAttachersConstraint || -Infinity, nonMovingAttachersConstraint || -Infinity);\n\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        minOrMax = Math.max(movingAttachersConstraint || -Infinity, nonMovingAttachersConstraint || -Infinity);\n\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    var resizingShapeMinDimensions = minDimensions && minDimensions[ resizingShape.id ];\n\n    if (resizingShapeMinDimensions) {\n\n      if (direction === 'n') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n  });\n\n  return spaceToolConstraints;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\nfunction isAttacher(element) {\n  return !!element.host;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}