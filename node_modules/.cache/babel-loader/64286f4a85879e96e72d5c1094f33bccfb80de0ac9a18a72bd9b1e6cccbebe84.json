{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import whoDigitalLibraryService from'../services/whoDigitalLibraryService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const WHODigitalLibrary=_ref=>{let{onReferencesChange}=_ref;const[searchQuery,setSearchQuery]=useState('');const[searchResults,setSearchResults]=useState([]);const[selectedReferences,setSelectedReferences]=useState([]);const[isSearching,setIsSearching]=useState(false);const[currentPage,setCurrentPage]=useState(0);const[totalPages,setTotalPages]=useState(0);const[totalResults,setTotalResults]=useState(0);const[error,setError]=useState(null);const[suggestions,setSuggestions]=useState([]);const[showSuggestions,setShowSuggestions]=useState(false);const[featuredItems,setFeaturedItems]=useState([]);const searchInputRef=useRef(null);// Load featured items on component mount and load references from localStorage\nuseEffect(()=>{const savedReferences=localStorage.getItem('whoDigitalLibraryReferences');if(savedReferences){try{const references=JSON.parse(savedReferences);setSelectedReferences(references);if(onReferencesChange){onReferencesChange(references);}}catch(error){console.error('Error loading saved references:',error);}}loadFeaturedItems();},[onReferencesChange]);// Save references to localStorage whenever they change\nuseEffect(()=>{localStorage.setItem('whoDigitalLibraryReferences',JSON.stringify(selectedReferences));if(onReferencesChange){onReferencesChange(selectedReferences);}},[selectedReferences,onReferencesChange]);const loadFeaturedItems=async()=>{try{const items=await whoDigitalLibraryService.getFeaturedItems(5);setFeaturedItems(items);}catch(error){console.error('Error loading featured items:',error);}};const handleSearch=async function(){let query=arguments.length>0&&arguments[0]!==undefined?arguments[0]:searchQuery;let page=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(!query.trim()){setSearchResults([]);setTotalPages(0);setTotalResults(0);return;}setIsSearching(true);setError(null);try{const results=await whoDigitalLibraryService.search(query,page,10);setSearchResults(results.items);setTotalPages(results.totalPages);setTotalResults(results.totalElements);setCurrentPage(page);// Check if this is demonstration data\nif(results.isDemo){setError('WHO_API_DEMO');// Special error code for demo mode\n}}catch(error){setError(error.message);setSearchResults([]);}finally{setIsSearching(false);}};const handleSearchInputChange=async e=>{const value=e.target.value;setSearchQuery(value);// Get suggestions for autocomplete\nif(value.length>=2){try{const suggestions=await whoDigitalLibraryService.getSuggestions(value);setSuggestions(suggestions);setShowSuggestions(true);}catch(error){console.error('Error getting suggestions:',error);setSuggestions([]);}}else{setSuggestions([]);setShowSuggestions(false);}};const handleSearchSubmit=e=>{e.preventDefault();setShowSuggestions(false);handleSearch();};const handleSuggestionClick=suggestion=>{setSearchQuery(suggestion);setShowSuggestions(false);handleSearch(suggestion);};const handlePageChange=newPage=>{if(newPage>=0&&newPage<totalPages){handleSearch(searchQuery,newPage);}};const addReference=item=>{const isAlreadySelected=selectedReferences.some(ref=>ref.id===item.id);if(!isAlreadySelected){setSelectedReferences(prev=>[...prev,item]);}};const removeReference=itemId=>{setSelectedReferences(prev=>prev.filter(ref=>ref.id!==itemId));};const clearAllReferences=()=>{setSelectedReferences([]);};const formatDate=dateStr=>{if(!dateStr)return'Date not available';if(Array.isArray(dateStr)){dateStr=dateStr[0];}try{const date=new Date(dateStr);return date.getFullYear();}catch(_unused){return dateStr;}};const formatAuthors=creators=>{if(!creators)return'Author not available';if(Array.isArray(creators)){return creators.slice(0,3).join(', ')+(creators.length>3?', et al.':'');}return creators;};const renderSearchResult=item=>/*#__PURE__*/_jsxs(\"div\",{className:\"search-result-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"result-content\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"result-title\",children:item.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"result-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"result-authors\",children:formatAuthors(item.creator)}),/*#__PURE__*/_jsxs(\"span\",{className:\"result-date\",children:[\"(\",formatDate(item.dateIssued),\")\"]}),item.type&&/*#__PURE__*/_jsx(\"span\",{className:\"result-type\",children:item.type})]}),item.abstract&&/*#__PURE__*/_jsx(\"p\",{className:\"result-abstract\",children:item.abstract.length>200?\"\".concat(item.abstract.substring(0,200),\"...\"):item.abstract}),item.subject&&/*#__PURE__*/_jsx(\"div\",{className:\"result-subjects\",children:(Array.isArray(item.subject)?item.subject:[item.subject]).slice(0,3).map((subject,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"subject-tag\",children:subject},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"result-actions\",children:[/*#__PURE__*/_jsx(\"a\",{href:item.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"btn-secondary small\",title:\"View in WHO Digital Library\",children:\"View\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addReference(item),className:\"btn-primary small\",disabled:selectedReferences.some(ref=>ref.id===item.id),children:selectedReferences.some(ref=>ref.id===item.id)?'Added':'Add'})]})]},item.id);const renderSelectedReference=item=>/*#__PURE__*/_jsxs(\"div\",{className:\"selected-reference-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reference-content\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"reference-title\",children:item.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"reference-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"reference-authors\",children:formatAuthors(item.creator)}),/*#__PURE__*/_jsxs(\"span\",{className:\"reference-date\",children:[\"(\",formatDate(item.dateIssued),\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"reference-citation\",children:whoDigitalLibraryService.formatCitation(item,'apa')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"reference-actions\",children:[/*#__PURE__*/_jsx(\"a\",{href:item.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"btn-link small\",title:\"View in WHO Digital Library\",children:\"View\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeReference(item.id),className:\"btn-danger small\",title:\"Remove reference\",children:\"Remove\"})]})]},item.id);return/*#__PURE__*/_jsxs(\"div\",{className:\"who-digital-library\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"library-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"WHO Digital Library\"}),/*#__PURE__*/_jsx(\"p\",{className:\"library-description\",children:\"Search and select references from the WHO Institutional Repository for Health Information (IRIS)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"library-help\",children:/*#__PURE__*/_jsx(\"a\",{href:\"https://iris.who.int/help\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"help-link\",title:\"Get help with WHO Digital Library search\",children:\"\\uD83D\\uDCD6 Search Help & Documentation\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"library-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-number\",children:selectedReferences.length}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Selected\"})]}),totalResults>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"stat\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-number\",children:totalResults.toLocaleString()}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Results\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-section\",children:[/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSearchSubmit,className:\"search-form\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-input-container\",children:[/*#__PURE__*/_jsx(\"input\",{ref:searchInputRef,type:\"text\",value:searchQuery,onChange:handleSearchInputChange,placeholder:\"Search WHO digital library...\",className:\"search-input\",onBlur:()=>setTimeout(()=>setShowSuggestions(false),200),onFocus:()=>suggestions.length>0&&setShowSuggestions(true)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"search-button\",disabled:isSearching,children:isSearching?'Searching...':'Search'}),showSuggestions&&suggestions.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"suggestions-dropdown\",children:suggestions.map((suggestion,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"suggestion-item\",onClick:()=>handleSuggestionClick(suggestion),children:suggestion},index))})]})}),error&&error!=='WHO_API_DEMO'&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Search Error:\"}),\" \",error,(error.includes('CORS policy')||error.includes('restart the development server'))&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-help\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Development Mode:\"}),\" \",error.includes('restart')?'The WHO Digital Library proxy is now configured. Please restart your development server (npm start) to enable API access.':'This error occurs in development mode due to browser security restrictions.']}),/*#__PURE__*/_jsxs(\"p\",{children:[\"For help with WHO Digital Library search, visit: \",' ',/*#__PURE__*/_jsx(\"a\",{href:\"https://iris.who.int/help\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"help-link\",children:\"iris.who.int/help\"})]})]}),error.includes('HTTP 403')&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-help\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"API Access Issue:\"}),\" The WHO Digital Library is currently restricting access to its search API.\"]}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Possible solutions:\"})}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Wait a few minutes and try again (may be temporary rate limiting)\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Try a different, more specific search term\"}),/*#__PURE__*/_jsxs(\"li\",{children:[\"Browse the WHO Digital Library directly: \",/*#__PURE__*/_jsx(\"a\",{href:\"https://iris.who.int\",target:\"_blank\",rel:\"noopener noreferrer\",children:\"iris.who.int\"})]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"For API access guidelines, visit: \",/*#__PURE__*/_jsx(\"a\",{href:\"https://iris.who.int/help\",target:\"_blank\",rel:\"noopener noreferrer\",children:\"iris.who.int/help\"})]})]}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"em\",{children:\"Note: This integration provides direct access to WHO's public API. Access policies and availability are controlled by WHO.\"})})]}),(error.includes('HTTP 429')||error.includes('rate limit'))&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-help\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rate Limit:\"}),\" Too many requests have been made to the WHO Digital Library API.\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"Please wait a few minutes before searching again. You can browse featured items below in the meantime.\"})]})]}),error==='WHO_API_DEMO'&&/*#__PURE__*/_jsxs(\"div\",{className:\"demo-notice\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"demo-notice-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"demo-icon\",children:\"\\uD83D\\uDD27\"}),/*#__PURE__*/_jsx(\"strong\",{children:\"Demonstration Mode\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"The WHO Digital Library API is currently not accessible for direct integration. The results below are demonstration data showing how the feature would work.\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"To search real WHO publications:\"}),\" Visit\",' ',/*#__PURE__*/_jsx(\"a\",{href:\"https://iris.who.int\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"external-link\",children:\"iris.who.int\"}),' ',\"directly.\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"demo-notice-actions\",children:/*#__PURE__*/_jsx(\"a\",{href:\"https://iris.who.int/help\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"help-link\",children:\"\\uD83D\\uDCD6 WHO IRIS Help & Documentation\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"library-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-results-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Search Results\"}),totalResults>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"results-count\",children:[totalResults.toLocaleString(),\" results found\"]})]}),searchResults.length===0&&!isSearching&&searchQuery===''&&/*#__PURE__*/_jsxs(\"div\",{className:\"featured-items\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Featured Items\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Recent publications from the WHO Digital Library:\"}),featuredItems.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"featured-items-grid\",children:featuredItems.map(item=>renderSearchResult(item))}):/*#__PURE__*/_jsx(\"p\",{className:\"no-results\",children:\"Loading featured items...\"})]}),searchResults.length===0&&!isSearching&&searchQuery!==''&&/*#__PURE__*/_jsxs(\"div\",{className:\"no-results\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"No results found for \\\"\",searchQuery,\"\\\"\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"Try different keywords or browse featured items above.\"})]}),isSearching&&/*#__PURE__*/_jsxs(\"div\",{className:\"loading-results\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Searching WHO Digital Library...\"})]}),searchResults.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-results\",children:[searchResults.map(item=>renderSearchResult(item)),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"pagination\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePageChange(currentPage-1),disabled:currentPage===0,className:\"btn-secondary\",children:\"Previous\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"page-info\",children:[\"Page \",currentPage+1,\" of \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePageChange(currentPage+1),disabled:currentPage>=totalPages-1,className:\"btn-secondary\",children:\"Next\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"selected-references-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Selected References\"}),selectedReferences.length>0&&/*#__PURE__*/_jsx(\"button\",{onClick:clearAllReferences,className:\"btn-danger small\",title:\"Clear all references\",children:\"Clear All\"})]}),selectedReferences.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-references\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"No references selected yet.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Search and add references from the WHO Digital Library to build your reference list.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"selected-references\",children:selectedReferences.map(item=>renderSelectedReference(item))})]})]})]});};export default WHODigitalLibrary;","map":{"version":3,"names":["React","useState","useEffect","useRef","whoDigitalLibraryService","jsx","_jsx","jsxs","_jsxs","WHODigitalLibrary","_ref","onReferencesChange","searchQuery","setSearchQuery","searchResults","setSearchResults","selectedReferences","setSelectedReferences","isSearching","setIsSearching","currentPage","setCurrentPage","totalPages","setTotalPages","totalResults","setTotalResults","error","setError","suggestions","setSuggestions","showSuggestions","setShowSuggestions","featuredItems","setFeaturedItems","searchInputRef","savedReferences","localStorage","getItem","references","JSON","parse","console","loadFeaturedItems","setItem","stringify","items","getFeaturedItems","handleSearch","query","arguments","length","undefined","page","trim","results","search","totalElements","isDemo","message","handleSearchInputChange","e","value","target","getSuggestions","handleSearchSubmit","preventDefault","handleSuggestionClick","suggestion","handlePageChange","newPage","addReference","item","isAlreadySelected","some","ref","id","prev","removeReference","itemId","filter","clearAllReferences","formatDate","dateStr","Array","isArray","date","Date","getFullYear","_unused","formatAuthors","creators","slice","join","renderSearchResult","className","children","title","creator","dateIssued","type","abstract","concat","substring","subject","map","index","href","url","rel","onClick","disabled","renderSelectedReference","formatCitation","toLocaleString","onSubmit","onChange","placeholder","onBlur","setTimeout","onFocus","includes"],"sources":["/home/runner/work/sgex/sgex/src/components/WHODigitalLibrary.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport whoDigitalLibraryService from '../services/whoDigitalLibraryService';\n\nconst WHODigitalLibrary = ({ onReferencesChange }) => {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [selectedReferences, setSelectedReferences] = useState([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [currentPage, setCurrentPage] = useState(0);\n  const [totalPages, setTotalPages] = useState(0);\n  const [totalResults, setTotalResults] = useState(0);\n  const [error, setError] = useState(null);\n  const [suggestions, setSuggestions] = useState([]);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [featuredItems, setFeaturedItems] = useState([]);\n  const searchInputRef = useRef(null);\n\n  // Load featured items on component mount and load references from localStorage\n  useEffect(() => {\n    const savedReferences = localStorage.getItem('whoDigitalLibraryReferences');\n    if (savedReferences) {\n      try {\n        const references = JSON.parse(savedReferences);\n        setSelectedReferences(references);\n        if (onReferencesChange) {\n          onReferencesChange(references);\n        }\n      } catch (error) {\n        console.error('Error loading saved references:', error);\n      }\n    }\n    loadFeaturedItems();\n  }, [onReferencesChange]);\n\n  // Save references to localStorage whenever they change\n  useEffect(() => {\n    localStorage.setItem('whoDigitalLibraryReferences', JSON.stringify(selectedReferences));\n    if (onReferencesChange) {\n      onReferencesChange(selectedReferences);\n    }\n  }, [selectedReferences, onReferencesChange]);\n\n  const loadFeaturedItems = async () => {\n    try {\n      const items = await whoDigitalLibraryService.getFeaturedItems(5);\n      setFeaturedItems(items);\n    } catch (error) {\n      console.error('Error loading featured items:', error);\n    }\n  };\n\n  const handleSearch = async (query = searchQuery, page = 0) => {\n    if (!query.trim()) {\n      setSearchResults([]);\n      setTotalPages(0);\n      setTotalResults(0);\n      return;\n    }\n\n    setIsSearching(true);\n    setError(null);\n\n    try {\n      const results = await whoDigitalLibraryService.search(query, page, 10);\n      setSearchResults(results.items);\n      setTotalPages(results.totalPages);\n      setTotalResults(results.totalElements);\n      setCurrentPage(page);\n      \n      // Check if this is demonstration data\n      if (results.isDemo) {\n        setError('WHO_API_DEMO'); // Special error code for demo mode\n      }\n    } catch (error) {\n      setError(error.message);\n      setSearchResults([]);\n    } finally {\n      setIsSearching(false);\n    }\n  };\n\n  const handleSearchInputChange = async (e) => {\n    const value = e.target.value;\n    setSearchQuery(value);\n\n    // Get suggestions for autocomplete\n    if (value.length >= 2) {\n      try {\n        const suggestions = await whoDigitalLibraryService.getSuggestions(value);\n        setSuggestions(suggestions);\n        setShowSuggestions(true);\n      } catch (error) {\n        console.error('Error getting suggestions:', error);\n        setSuggestions([]);\n      }\n    } else {\n      setSuggestions([]);\n      setShowSuggestions(false);\n    }\n  };\n\n  const handleSearchSubmit = (e) => {\n    e.preventDefault();\n    setShowSuggestions(false);\n    handleSearch();\n  };\n\n  const handleSuggestionClick = (suggestion) => {\n    setSearchQuery(suggestion);\n    setShowSuggestions(false);\n    handleSearch(suggestion);\n  };\n\n  const handlePageChange = (newPage) => {\n    if (newPage >= 0 && newPage < totalPages) {\n      handleSearch(searchQuery, newPage);\n    }\n  };\n\n  const addReference = (item) => {\n    const isAlreadySelected = selectedReferences.some(ref => ref.id === item.id);\n    if (!isAlreadySelected) {\n      setSelectedReferences(prev => [...prev, item]);\n    }\n  };\n\n  const removeReference = (itemId) => {\n    setSelectedReferences(prev => prev.filter(ref => ref.id !== itemId));\n  };\n\n  const clearAllReferences = () => {\n    setSelectedReferences([]);\n  };\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return 'Date not available';\n    if (Array.isArray(dateStr)) {\n      dateStr = dateStr[0];\n    }\n    try {\n      const date = new Date(dateStr);\n      return date.getFullYear();\n    } catch {\n      return dateStr;\n    }\n  };\n\n  const formatAuthors = (creators) => {\n    if (!creators) return 'Author not available';\n    if (Array.isArray(creators)) {\n      return creators.slice(0, 3).join(', ') + (creators.length > 3 ? ', et al.' : '');\n    }\n    return creators;\n  };\n\n  const renderSearchResult = (item) => (\n    <div key={item.id} className=\"search-result-item\">\n      <div className=\"result-content\">\n        <h4 className=\"result-title\">{item.title}</h4>\n        <div className=\"result-meta\">\n          <span className=\"result-authors\">{formatAuthors(item.creator)}</span>\n          <span className=\"result-date\">({formatDate(item.dateIssued)})</span>\n          {item.type && <span className=\"result-type\">{item.type}</span>}\n        </div>\n        {item.abstract && (\n          <p className=\"result-abstract\">\n            {item.abstract.length > 200 \n              ? `${item.abstract.substring(0, 200)}...` \n              : item.abstract}\n          </p>\n        )}\n        {item.subject && (\n          <div className=\"result-subjects\">\n            {(Array.isArray(item.subject) ? item.subject : [item.subject])\n              .slice(0, 3)\n              .map((subject, index) => (\n                <span key={index} className=\"subject-tag\">{subject}</span>\n              ))}\n          </div>\n        )}\n      </div>\n      <div className=\"result-actions\">\n        <a \n          href={item.url} \n          target=\"_blank\" \n          rel=\"noopener noreferrer\" \n          className=\"btn-secondary small\"\n          title=\"View in WHO Digital Library\"\n        >\n          View\n        </a>\n        <button \n          onClick={() => addReference(item)}\n          className=\"btn-primary small\"\n          disabled={selectedReferences.some(ref => ref.id === item.id)}\n        >\n          {selectedReferences.some(ref => ref.id === item.id) ? 'Added' : 'Add'}\n        </button>\n      </div>\n    </div>\n  );\n\n  const renderSelectedReference = (item) => (\n    <div key={item.id} className=\"selected-reference-item\">\n      <div className=\"reference-content\">\n        <h5 className=\"reference-title\">{item.title}</h5>\n        <div className=\"reference-meta\">\n          <span className=\"reference-authors\">{formatAuthors(item.creator)}</span>\n          <span className=\"reference-date\">({formatDate(item.dateIssued)})</span>\n        </div>\n        <div className=\"reference-citation\">\n          {whoDigitalLibraryService.formatCitation(item, 'apa')}\n        </div>\n      </div>\n      <div className=\"reference-actions\">\n        <a \n          href={item.url} \n          target=\"_blank\" \n          rel=\"noopener noreferrer\" \n          className=\"btn-link small\"\n          title=\"View in WHO Digital Library\"\n        >\n          View\n        </a>\n        <button \n          onClick={() => removeReference(item.id)}\n          className=\"btn-danger small\"\n          title=\"Remove reference\"\n        >\n          Remove\n        </button>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"who-digital-library\">\n      <div className=\"library-header\">\n        <div className=\"header-content\">\n          <h3>WHO Digital Library</h3>\n          <p className=\"library-description\">\n            Search and select references from the WHO Institutional Repository for Health Information (IRIS)\n          </p>\n          <div className=\"library-help\">\n            <a \n              href=\"https://iris.who.int/help\" \n              target=\"_blank\" \n              rel=\"noopener noreferrer\" \n              className=\"help-link\"\n              title=\"Get help with WHO Digital Library search\"\n            >\n              ðŸ“– Search Help & Documentation\n            </a>\n          </div>\n        </div>\n        <div className=\"library-stats\">\n          <div className=\"stat\">\n            <span className=\"stat-number\">{selectedReferences.length}</span>\n            <span className=\"stat-label\">Selected</span>\n          </div>\n          {totalResults > 0 && (\n            <div className=\"stat\">\n              <span className=\"stat-number\">{totalResults.toLocaleString()}</span>\n              <span className=\"stat-label\">Results</span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"search-section\">\n        <form onSubmit={handleSearchSubmit} className=\"search-form\">\n          <div className=\"search-input-container\">\n            <input\n              ref={searchInputRef}\n              type=\"text\"\n              value={searchQuery}\n              onChange={handleSearchInputChange}\n              placeholder=\"Search WHO digital library...\"\n              className=\"search-input\"\n              onBlur={() => setTimeout(() => setShowSuggestions(false), 200)}\n              onFocus={() => suggestions.length > 0 && setShowSuggestions(true)}\n            />\n            <button \n              type=\"submit\" \n              className=\"search-button\"\n              disabled={isSearching}\n            >\n              {isSearching ? 'Searching...' : 'Search'}\n            </button>\n            \n            {showSuggestions && suggestions.length > 0 && (\n              <div className=\"suggestions-dropdown\">\n                {suggestions.map((suggestion, index) => (\n                  <div\n                    key={index}\n                    className=\"suggestion-item\"\n                    onClick={() => handleSuggestionClick(suggestion)}\n                  >\n                    {suggestion}\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </form>\n\n        {error && error !== 'WHO_API_DEMO' && (\n          <div className=\"error-message\">\n            <strong>Search Error:</strong> {error}\n            {(error.includes('CORS policy') || error.includes('restart the development server')) && (\n              <div className=\"error-help\">\n                <p><strong>Development Mode:</strong> {error.includes('restart') ? \n                  'The WHO Digital Library proxy is now configured. Please restart your development server (npm start) to enable API access.' : \n                  'This error occurs in development mode due to browser security restrictions.'}</p>\n                <p>\n                  For help with WHO Digital Library search, visit: {' '}\n                  <a \n                    href=\"https://iris.who.int/help\" \n                    target=\"_blank\" \n                    rel=\"noopener noreferrer\"\n                    className=\"help-link\"\n                  >\n                    iris.who.int/help\n                  </a>\n                </p>\n              </div>\n            )}\n            {error.includes('HTTP 403') && (\n              <div className=\"error-help\">\n                <p><strong>API Access Issue:</strong> The WHO Digital Library is currently restricting access to its search API.</p>\n                <p><strong>Possible solutions:</strong></p>\n                <ul>\n                  <li>Wait a few minutes and try again (may be temporary rate limiting)</li>\n                  <li>Try a different, more specific search term</li>\n                  <li>Browse the WHO Digital Library directly: <a href=\"https://iris.who.int\" target=\"_blank\" rel=\"noopener noreferrer\">iris.who.int</a></li>\n                  <li>For API access guidelines, visit: <a href=\"https://iris.who.int/help\" target=\"_blank\" rel=\"noopener noreferrer\">iris.who.int/help</a></li>\n                </ul>\n                <p><em>Note: This integration provides direct access to WHO's public API. Access policies and availability are controlled by WHO.</em></p>\n              </div>\n            )}\n            {(error.includes('HTTP 429') || error.includes('rate limit')) && (\n              <div className=\"error-help\">\n                <p><strong>Rate Limit:</strong> Too many requests have been made to the WHO Digital Library API.</p>\n                <p>Please wait a few minutes before searching again. You can browse featured items below in the meantime.</p>\n              </div>\n            )}\n          </div>\n        )}\n\n        {error === 'WHO_API_DEMO' && (\n          <div className=\"demo-notice\">\n            <div className=\"demo-notice-header\">\n              <span className=\"demo-icon\">ðŸ”§</span>\n              <strong>Demonstration Mode</strong>\n            </div>\n            <p>\n              The WHO Digital Library API is currently not accessible for direct integration. \n              The results below are demonstration data showing how the feature would work.\n            </p>\n            <p>\n              <strong>To search real WHO publications:</strong> Visit{' '}\n              <a \n                href=\"https://iris.who.int\" \n                target=\"_blank\" \n                rel=\"noopener noreferrer\"\n                className=\"external-link\"\n              >\n                iris.who.int\n              </a>{' '}\n              directly.\n            </p>\n            <div className=\"demo-notice-actions\">\n              <a \n                href=\"https://iris.who.int/help\" \n                target=\"_blank\" \n                rel=\"noopener noreferrer\"\n                className=\"help-link\"\n              >\n                ðŸ“– WHO IRIS Help & Documentation\n              </a>\n            </div>\n          </div>\n        )}\n      </div>\n\n      <div className=\"library-content\">\n        <div className=\"search-results-section\">\n          <div className=\"section-header\">\n            <h4>Search Results</h4>\n            {totalResults > 0 && (\n              <span className=\"results-count\">\n                {totalResults.toLocaleString()} results found\n              </span>\n            )}\n          </div>\n\n          {searchResults.length === 0 && !isSearching && searchQuery === '' && (\n            <div className=\"featured-items\">\n              <h5>Featured Items</h5>\n              <p>Recent publications from the WHO Digital Library:</p>\n              {featuredItems.length > 0 ? (\n                <div className=\"featured-items-grid\">\n                  {featuredItems.map(item => renderSearchResult(item))}\n                </div>\n              ) : (\n                <p className=\"no-results\">Loading featured items...</p>\n              )}\n            </div>\n          )}\n\n          {searchResults.length === 0 && !isSearching && searchQuery !== '' && (\n            <div className=\"no-results\">\n              <p>No results found for \"{searchQuery}\"</p>\n              <p>Try different keywords or browse featured items above.</p>\n            </div>\n          )}\n\n          {isSearching && (\n            <div className=\"loading-results\">\n              <div className=\"loading-spinner\"></div>\n              <p>Searching WHO Digital Library...</p>\n            </div>\n          )}\n\n          {searchResults.length > 0 && (\n            <div className=\"search-results\">\n              {searchResults.map(item => renderSearchResult(item))}\n              \n              {totalPages > 1 && (\n                <div className=\"pagination\">\n                  <button \n                    onClick={() => handlePageChange(currentPage - 1)}\n                    disabled={currentPage === 0}\n                    className=\"btn-secondary\"\n                  >\n                    Previous\n                  </button>\n                  <span className=\"page-info\">\n                    Page {currentPage + 1} of {totalPages}\n                  </span>\n                  <button \n                    onClick={() => handlePageChange(currentPage + 1)}\n                    disabled={currentPage >= totalPages - 1}\n                    className=\"btn-secondary\"\n                  >\n                    Next\n                  </button>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        <div className=\"selected-references-section\">\n          <div className=\"section-header\">\n            <h4>Selected References</h4>\n            {selectedReferences.length > 0 && (\n              <button \n                onClick={clearAllReferences}\n                className=\"btn-danger small\"\n                title=\"Clear all references\"\n              >\n                Clear All\n              </button>\n            )}\n          </div>\n\n          {selectedReferences.length === 0 ? (\n            <div className=\"no-references\">\n              <p>No references selected yet.</p>\n              <p>Search and add references from the WHO Digital Library to build your reference list.</p>\n            </div>\n          ) : (\n            <div className=\"selected-references\">\n              {selectedReferences.map(item => renderSelectedReference(item))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default WHODigitalLibrary;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}