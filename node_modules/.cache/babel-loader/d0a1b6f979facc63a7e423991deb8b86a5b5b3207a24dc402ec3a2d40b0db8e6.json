{"ast":null,"code":"import React,{useState}from'react';import MDEditor from'@uiw/react-md-editor';import stagingGroundService from'../services/stagingGroundService';import'./PageEditModal.css';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const PageEditModal=_ref=>{let{page,onClose,onSave}=_ref;const[content,setContent]=useState(page!==null&&page!==void 0&&page.content?atob(page.content.content):'');const[isSaving,setIsSaving]=useState(false);if(!page)return null;const handleOverlayClick=e=>{if(e.target===e.currentTarget){onClose();}};const handleSave=async()=>{setIsSaving(true);try{// Save content to staging ground instead of directly to GitHub\nconst success=stagingGroundService.updateFile(page.path,content,{title:page.title,filename:page.filename,tool:'PageEditor',contentType:'markdown'});if(success){// Notify parent that changes were staged successfully\nif(onSave){await onSave(page,content,'staged');}onClose();}else{throw new Error('Failed to save to staging ground');}}catch(error){console.error('Failed to save page:',error);alert('Failed to save page to staging ground. Please try again.');}finally{setIsSaving(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"page-edit-modal-overlay\",onClick:handleOverlayClick,children:/*#__PURE__*/_jsxs(\"div\",{className:\"page-edit-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-edit-modal-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Edit \",page.title]}),/*#__PURE__*/_jsxs(\"div\",{className:\"header-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:onClose,disabled:isSaving,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:handleSave,disabled:isSaving,children:isSaving?'Staging...':'Stage Changes'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"page-edit-modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"page-filename\",children:page.filename}),/*#__PURE__*/_jsx(\"span\",{className:\"page-path\",children:page.path})]}),/*#__PURE__*/_jsx(\"div\",{className:\"md-editor-container\",children:/*#__PURE__*/_jsx(MDEditor,{value:content,onChange:val=>setContent(val||''),preview:\"edit\",height:500,visibleDragBar:false,\"data-color-mode\":\"light\",hideToolbar:isSaving})})]})]})});};export default PageEditModal;","map":{"version":3,"names":["React","useState","MDEditor","stagingGroundService","jsxs","_jsxs","jsx","_jsx","PageEditModal","_ref","page","onClose","onSave","content","setContent","atob","isSaving","setIsSaving","handleOverlayClick","e","target","currentTarget","handleSave","success","updateFile","path","title","filename","tool","contentType","Error","error","console","alert","className","onClick","children","disabled","value","onChange","val","preview","height","visibleDragBar","hideToolbar"],"sources":["/home/runner/work/sgex/sgex/src/components/PageEditModal.js"],"sourcesContent":["import React, { useState } from 'react';\nimport MDEditor from '@uiw/react-md-editor';\nimport stagingGroundService from '../services/stagingGroundService';\nimport './PageEditModal.css';\n\nconst PageEditModal = ({ page, onClose, onSave }) => {\n  const [content, setContent] = useState(page?.content ? atob(page.content.content) : '');\n  const [isSaving, setIsSaving] = useState(false);\n\n  if (!page) return null;\n\n  const handleOverlayClick = (e) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  const handleSave = async () => {\n    setIsSaving(true);\n    try {\n      // Save content to staging ground instead of directly to GitHub\n      const success = stagingGroundService.updateFile(\n        page.path,\n        content,\n        {\n          title: page.title,\n          filename: page.filename,\n          tool: 'PageEditor',\n          contentType: 'markdown'\n        }\n      );\n      \n      if (success) {\n        // Notify parent that changes were staged successfully\n        if (onSave) {\n          await onSave(page, content, 'staged');\n        }\n        onClose();\n      } else {\n        throw new Error('Failed to save to staging ground');\n      }\n    } catch (error) {\n      console.error('Failed to save page:', error);\n      alert('Failed to save page to staging ground. Please try again.');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  return (\n    <div className=\"page-edit-modal-overlay\" onClick={handleOverlayClick}>\n      <div className=\"page-edit-modal\">\n        <div className=\"page-edit-modal-header\">\n          <h2>Edit {page.title}</h2>\n          <div className=\"header-actions\">\n            <button \n              className=\"btn-secondary\"\n              onClick={onClose}\n              disabled={isSaving}\n            >\n              Cancel\n            </button>\n            <button \n              className=\"btn-primary\"\n              onClick={handleSave}\n              disabled={isSaving}\n            >\n              {isSaving ? 'Staging...' : 'Stage Changes'}\n            </button>\n          </div>\n        </div>\n        \n        <div className=\"page-edit-modal-content\">\n          <div className=\"page-info\">\n            <span className=\"page-filename\">{page.filename}</span>\n            <span className=\"page-path\">{page.path}</span>\n          </div>\n          \n          <div className=\"md-editor-container\">\n            <MDEditor\n              value={content}\n              onChange={(val) => setContent(val || '')}\n              preview=\"edit\"\n              height={500}\n              visibleDragBar={false}\n              data-color-mode=\"light\"\n              hideToolbar={isSaving}\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PageEditModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}