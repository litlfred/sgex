{"ast":null,"code":"import inherits from 'inherits-browser';\nimport SpaceTool from 'diagram-js/lib/features/space-tool/SpaceTool';\nimport { getEnclosedElements, getBBox } from 'diagram-js/lib/util/Elements';\nimport { getBusinessObject, is } from '../../util/ModelUtil';\nimport { isHorizontal } from '../../util/DiUtil';\nimport { values } from 'min-dash';\n\n/**\n * @typedef {import('didi').Injector} Injector\n * @typedef {import('diagram-js/lib/core/Canvas').default} Canvas\n *\n * @typedef {import('../../model/Types').Shape} Shape\n *\n * @typedef {import('diagram-js/lib/util/Types').Axis} Axis\n * @typedef {import('diagram-js/lib/util/Types').Point} Point\n */\n\n/**\n * @param {Injector} injector\n * @param {Canvas} canvas\n */\nexport default function BpmnSpaceTool(injector, canvas) {\n  injector.invoke(SpaceTool, this);\n  this._canvas = canvas;\n}\nBpmnSpaceTool.$inject = ['injector', 'canvas'];\ninherits(BpmnSpaceTool, SpaceTool);\n\n/**\n * @param {Shape[]} elements\n * @param {Axis} axis\n * @param {Point} delta\n * @param {number} start\n *\n * @return {Object}\n */\nBpmnSpaceTool.prototype.calculateAdjustments = function (elements, axis, delta, start) {\n  var canvasRoot = this._canvas.getRootElement(),\n    spaceRoot = elements[0] === canvasRoot ? null : elements[0],\n    enclosedArtifacts = [];\n\n  // ensure\n  if (spaceRoot) {\n    enclosedArtifacts = values(getEnclosedElements(canvasRoot.children.filter(child => is(child, 'bpmn:Artifact')), getBBox(spaceRoot)));\n  }\n  const elementsToMove = [...elements, ...enclosedArtifacts];\n  var adjustments = SpaceTool.prototype.calculateAdjustments.call(this, elementsToMove, axis, delta, start);\n\n  // do not resize:\n  //\n  // * text annotations (horizontally/vertically)\n  // * empty horizontal pools (vertically)\n  // * empty vertical pools (horizontally)\n  adjustments.resizingShapes = adjustments.resizingShapes.filter(function (shape) {\n    if (is(shape, 'bpmn:TextAnnotation')) {\n      return false;\n    }\n    if (isCollapsedPool(shape)) {\n      if (axis === 'y' && isHorizontal(shape) || axis === 'x' && !isHorizontal(shape)) {\n        return false;\n      }\n    }\n    return true;\n  });\n  return adjustments;\n};\n\n// helpers ///////////\n\nfunction isCollapsedPool(shape) {\n  return is(shape, 'bpmn:Participant') && !getBusinessObject(shape).processRef;\n}","map":{"version":3,"names":["inherits","SpaceTool","getEnclosedElements","getBBox","getBusinessObject","is","isHorizontal","values","BpmnSpaceTool","injector","canvas","invoke","_canvas","$inject","prototype","calculateAdjustments","elements","axis","delta","start","canvasRoot","getRootElement","spaceRoot","enclosedArtifacts","children","filter","child","elementsToMove","adjustments","call","resizingShapes","shape","isCollapsedPool","processRef"],"sources":["/home/runner/work/sgex/sgex/node_modules/bpmn-js/lib/features/space-tool/BpmnSpaceTool.js"],"sourcesContent":["import inherits from 'inherits-browser';\n\nimport SpaceTool from 'diagram-js/lib/features/space-tool/SpaceTool';\n\nimport { getEnclosedElements, getBBox } from 'diagram-js/lib/util/Elements';\n\nimport { getBusinessObject, is } from '../../util/ModelUtil';\n\nimport { isHorizontal } from '../../util/DiUtil';\nimport { values } from 'min-dash';\n\n/**\n * @typedef {import('didi').Injector} Injector\n * @typedef {import('diagram-js/lib/core/Canvas').default} Canvas\n *\n * @typedef {import('../../model/Types').Shape} Shape\n *\n * @typedef {import('diagram-js/lib/util/Types').Axis} Axis\n * @typedef {import('diagram-js/lib/util/Types').Point} Point\n */\n\n/**\n * @param {Injector} injector\n * @param {Canvas} canvas\n */\nexport default function BpmnSpaceTool(injector, canvas) {\n  injector.invoke(SpaceTool, this);\n\n  this._canvas = canvas;\n}\n\nBpmnSpaceTool.$inject = [\n  'injector',\n  'canvas'\n];\n\ninherits(BpmnSpaceTool, SpaceTool);\n\n/**\n * @param {Shape[]} elements\n * @param {Axis} axis\n * @param {Point} delta\n * @param {number} start\n *\n * @return {Object}\n */\nBpmnSpaceTool.prototype.calculateAdjustments = function(elements, axis, delta, start) {\n\n  var canvasRoot = this._canvas.getRootElement(),\n      spaceRoot = elements[0] === canvasRoot ? null : elements[0],\n      enclosedArtifacts = [];\n\n  // ensure\n  if (spaceRoot) {\n    enclosedArtifacts = values(\n      getEnclosedElements(\n        canvasRoot.children.filter(\n          (child) => is(child, 'bpmn:Artifact')\n        ),\n        getBBox(spaceRoot)\n      )\n    );\n  }\n\n  const elementsToMove = [ ...elements, ...enclosedArtifacts ];\n\n  var adjustments = SpaceTool.prototype.calculateAdjustments.call(this, elementsToMove, axis, delta, start);\n\n  // do not resize:\n  //\n  // * text annotations (horizontally/vertically)\n  // * empty horizontal pools (vertically)\n  // * empty vertical pools (horizontally)\n  adjustments.resizingShapes = adjustments.resizingShapes.filter(function(shape) {\n\n    if (is(shape, 'bpmn:TextAnnotation')) {\n      return false;\n    }\n\n    if (isCollapsedPool(shape)) {\n      if (axis === 'y' && isHorizontal(shape) || axis === 'x' && !isHorizontal(shape)) {\n        return false;\n      }\n    }\n\n    return true;\n  });\n\n  return adjustments;\n};\n\n\n// helpers ///////////\n\nfunction isCollapsedPool(shape) {\n  return is(shape, 'bpmn:Participant') && !getBusinessObject(shape).processRef;\n}"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,kBAAkB;AAEvC,OAAOC,SAAS,MAAM,8CAA8C;AAEpE,SAASC,mBAAmB,EAAEC,OAAO,QAAQ,8BAA8B;AAE3E,SAASC,iBAAiB,EAAEC,EAAE,QAAQ,sBAAsB;AAE5D,SAASC,YAAY,QAAQ,mBAAmB;AAChD,SAASC,MAAM,QAAQ,UAAU;;AAEjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAe,SAASC,aAAaA,CAACC,QAAQ,EAAEC,MAAM,EAAE;EACtDD,QAAQ,CAACE,MAAM,CAACV,SAAS,EAAE,IAAI,CAAC;EAEhC,IAAI,CAACW,OAAO,GAAGF,MAAM;AACvB;AAEAF,aAAa,CAACK,OAAO,GAAG,CACtB,UAAU,EACV,QAAQ,CACT;AAEDb,QAAQ,CAACQ,aAAa,EAAEP,SAAS,CAAC;;AAElC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAO,aAAa,CAACM,SAAS,CAACC,oBAAoB,GAAG,UAASC,QAAQ,EAAEC,IAAI,EAAEC,KAAK,EAAEC,KAAK,EAAE;EAEpF,IAAIC,UAAU,GAAG,IAAI,CAACR,OAAO,CAACS,cAAc,CAAC,CAAC;IAC1CC,SAAS,GAAGN,QAAQ,CAAC,CAAC,CAAC,KAAKI,UAAU,GAAG,IAAI,GAAGJ,QAAQ,CAAC,CAAC,CAAC;IAC3DO,iBAAiB,GAAG,EAAE;;EAE1B;EACA,IAAID,SAAS,EAAE;IACbC,iBAAiB,GAAGhB,MAAM,CACxBL,mBAAmB,CACjBkB,UAAU,CAACI,QAAQ,CAACC,MAAM,CACvBC,KAAK,IAAKrB,EAAE,CAACqB,KAAK,EAAE,eAAe,CACtC,CAAC,EACDvB,OAAO,CAACmB,SAAS,CACnB,CACF,CAAC;EACH;EAEA,MAAMK,cAAc,GAAG,CAAE,GAAGX,QAAQ,EAAE,GAAGO,iBAAiB,CAAE;EAE5D,IAAIK,WAAW,GAAG3B,SAAS,CAACa,SAAS,CAACC,oBAAoB,CAACc,IAAI,CAAC,IAAI,EAAEF,cAAc,EAAEV,IAAI,EAAEC,KAAK,EAAEC,KAAK,CAAC;;EAEzG;EACA;EACA;EACA;EACA;EACAS,WAAW,CAACE,cAAc,GAAGF,WAAW,CAACE,cAAc,CAACL,MAAM,CAAC,UAASM,KAAK,EAAE;IAE7E,IAAI1B,EAAE,CAAC0B,KAAK,EAAE,qBAAqB,CAAC,EAAE;MACpC,OAAO,KAAK;IACd;IAEA,IAAIC,eAAe,CAACD,KAAK,CAAC,EAAE;MAC1B,IAAId,IAAI,KAAK,GAAG,IAAIX,YAAY,CAACyB,KAAK,CAAC,IAAId,IAAI,KAAK,GAAG,IAAI,CAACX,YAAY,CAACyB,KAAK,CAAC,EAAE;QAC/E,OAAO,KAAK;MACd;IACF;IAEA,OAAO,IAAI;EACb,CAAC,CAAC;EAEF,OAAOH,WAAW;AACpB,CAAC;;AAGD;;AAEA,SAASI,eAAeA,CAACD,KAAK,EAAE;EAC9B,OAAO1B,EAAE,CAAC0B,KAAK,EAAE,kBAAkB,CAAC,IAAI,CAAC3B,iBAAiB,CAAC2B,KAAK,CAAC,CAACE,UAAU;AAC9E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}