{"ast":null,"code":"import React,{useState,useCallback,useMemo,useEffect}from'react';import{Prism as SyntaxHighlighter}from'react-syntax-highlighter';import{oneLight}from'react-syntax-highlighter/dist/esm/styles/prism';import githubService from'../services/githubService';import sushiWasmService from'../services/sushiWasmService';import{WasmLoader,performanceMonitor}from'../utils/wasmLoader';import SushiErrorBoundary from'./SushiErrorBoundary';import'./SushiRunner.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SushiRunner=_ref=>{var _repository$owner;let{repository,selectedBranch,profile,stagingFiles=[]}=_ref;const[isExpanded,setIsExpanded]=useState(false);const[isRunning,setIsRunning]=useState(false);const[showModal,setShowModal]=useState(false);const[logs,setLogs]=useState([]);const[generatedFiles,setGeneratedFiles]=useState([]);const[showFileViewer,setShowFileViewer]=useState(false);const[selectedFile,setSelectedFile]=useState(null);const[activeTab,setActiveTab]=useState('logs');const[logLevelToggles,setLogLevelToggles]=useState({info:true,success:true,warning:true,error:true});const[searchText,setSearchText]=useState('');const[sushiConfig,setSushiConfig]=useState(null);const[fshFiles,setFshFiles]=useState([]);const[includeStagingFiles,setIncludeStagingFiles]=useState(false);const[error,setError]=useState(null);const[executionMode,setExecutionMode]=useState('auto');// 'auto', 'wasm', 'javascript'\nconst[wasmSupported,setWasmSupported]=useState(false);const[wasmInitialized,setWasmInitialized]=useState(false);const owner=((_repository$owner=repository.owner)===null||_repository$owner===void 0?void 0:_repository$owner.login)||repository.full_name.split('/')[0];const repoName=repository.name;const addLog=useCallback(function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'info';setLogs(prev=>[...prev,{id:Date.now()+Math.random(),message,type,timestamp:new Date().toISOString()}]);},[]);// Check WebAssembly support on component mount\nuseEffect(()=>{const checkWasmSupport=async()=>{const supported=WasmLoader.isSupported();setWasmSupported(supported);if(supported){addLog('ğŸš€ WebAssembly support detected','success');// Initialize WASM service\ntry{await sushiWasmService.initialize();setWasmInitialized(true);addLog('âœ… SUSHI WebAssembly service initialized','success');}catch(err){addLog(`âš ï¸ WASM initialization failed, falling back to JavaScript: ${err.message}`,'warning');}}else{addLog('âš ï¸ WebAssembly not supported, using JavaScript fallback','warning');}};checkWasmSupport();},[addLog]);const fetchRepositoryFiles=async()=>{try{addLog('ğŸ” Fetching sushi-config.yaml...','info');let config=null;try{const configContent=await githubService.getFileContent(owner,repoName,'sushi-config.yaml',selectedBranch);config=configContent;setSushiConfig(config);addLog('âœ… Found sushi-config.yaml','success');}catch(err){addLog('âš ï¸ sushi-config.yaml not found in repository','warning');}addLog('ğŸ” Scanning input/fsh directory recursively...','info');const fshFiles=[];try{// Recursively scan for FSH files\nconst scanDirectory=async function(dirPath){let depth=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;const maxDepth=5;// Prevent infinite recursion\nif(depth>maxDepth){addLog(`âš ï¸ Maximum directory depth reached for ${dirPath}`,'warning');return;}try{const contents=await githubService.getDirectoryContents(owner,repoName,dirPath,selectedBranch);for(const item of contents){if(item.type==='file'&&item.name.endsWith('.fsh')){try{const fileContent=await githubService.getFileContent(owner,repoName,item.path,selectedBranch);fshFiles.push({name:item.name,path:item.path,content:fileContent});addLog(`ğŸ“„ Found ${item.path}`,'success');}catch(err){addLog(`âŒ Failed to fetch ${item.path}: ${err.message}`,'error');}}else if(item.type==='dir'){// Recursively scan subdirectories\naddLog(`ğŸ“ Scanning subdirectory: ${item.path}`,'info');await scanDirectory(item.path,depth+1);}}}catch(err){addLog(`âš ï¸ Could not scan directory ${dirPath}: ${err.message}`,'warning');}};await scanDirectory('input/fsh');}catch(err){addLog('âš ï¸ input/fsh directory not found or empty','warning');}setFshFiles(fshFiles);addLog(`ğŸ“Š Found ${fshFiles.length} FSH files in repository`,'info');return{config,fshFiles};}catch(err){addLog(`âŒ Error fetching repository files: ${err.message}`,'error');throw err;}};const integrateStagingFiles=repoFshFiles=>{// Start with repository files\nconst integratedFiles=[...repoFshFiles];// Override/add staging files\nstagingFiles.forEach(stagingFile=>{if(stagingFile.path&&stagingFile.path.endsWith('.fsh')){const fileName=stagingFile.path.split('/').pop();const existingIndex=integratedFiles.findIndex(f=>f.name===fileName);if(existingIndex>=0){// Override existing file\nintegratedFiles[existingIndex]={...integratedFiles[existingIndex],content:stagingFile.content,isFromStaging:true};addLog(`ğŸ”„ Overriding ${fileName} with staging version`,'info');}else{// Add new file from staging\nintegratedFiles.push({name:fileName,path:stagingFile.path,content:stagingFile.content,isFromStaging:true});addLog(`â• Adding ${fileName} from staging`,'info');}}});return integratedFiles;};const runSushiInBrowser=async(config,files)=>{try{// Determine execution mode\nconst useWasm=executionMode==='wasm'||executionMode==='auto'&&wasmSupported&&wasmInitialized;const mode=useWasm?'WebAssembly':'JavaScript';addLog(`ğŸš€ Starting FHIR Shorthand compilation using ${mode}...`,'info');// Start performance monitoring\nperformanceMonitor.startTiming('sushi-compilation',useWasm?'wasm':'js');let result;if(useWasm){addLog('ğŸ”§ Using WebAssembly SUSHI engine...','info');result=await runSushiWithWasm(config,files);}else{addLog('âš™ï¸ Using JavaScript fallback engine...','info');result=await runSushiWithJavaScript(config,files);}// End performance monitoring\nconst duration=performanceMonitor.endTiming('sushi-compilation',useWasm?'wasm':'js');addLog(`â±ï¸ Compilation completed in ${duration.toFixed(2)}ms using ${mode}`,'success');return result;}catch(err){addLog(`âŒ Compilation failed: ${err.message}`,'error');// If WASM failed, try JavaScript fallback\nif(executionMode==='auto'&&wasmSupported){addLog('ğŸ”„ Attempting JavaScript fallback...','info');try{return await runSushiWithJavaScript(config,files);}catch(fallbackErr){addLog(`âŒ JavaScript fallback also failed: ${fallbackErr.message}`,'error');throw fallbackErr;}}throw err;}};const runSushiWithWasm=async(config,files)=>{try{addLog('ğŸ“¦ Preparing WebAssembly execution environment...','info');// Use the WASM service\nconst result=await sushiWasmService.runSushi(config,files);if(result.success){addLog(`âœ… WebAssembly compilation successful`,'success');addLog(`ğŸ“Š Generated ${result.files.length} FHIR resources`,'success');// Convert WASM output to the expected format\nconst generatedResources=result.files.map(file=>({type:file.resourceType,filename:file.path,content:file.content,id:file.path.split('.')[0],resourceType:file.resourceType}));setGeneratedFiles(generatedResources);// Log any warnings\nresult.warnings.forEach(warning=>{addLog(`âš ï¸ ${warning}`,'warning');});return{success:true,resourceCount:result.files.length,warnings:result.warnings,errors:result.errors,generatedFiles:generatedResources};}else{// Log errors from WASM compilation\nresult.errors.forEach(error=>{addLog(`âŒ ${error}`,'error');});throw new Error(`WASM compilation failed: ${result.errors.join(', ')}`);}}catch(err){addLog(`ğŸ’¥ WebAssembly execution failed: ${err.message}`,'error');throw err;}};const runSushiWithJavaScript=async(config,files)=>{try{addLog('ğŸš€ Starting FHIR Shorthand compilation...','info');addLog('â„¹ï¸ Using JavaScript FSH processor with enhanced crash prevention','info');// Enhanced memory monitoring with much stricter limits\nconst checkMemoryUsage=()=>{if(performance.memory&&performance.memory.usedJSHeapSize){const memoryMB=performance.memory.usedJSHeapSize/1024/1024;const memoryLimitMB=30;// Much stricter: 30MB hard limit\nconst memoryWarningMB=20;// Warning at 20MB\nif(memoryMB>memoryLimitMB){throw new Error(`Memory limit exceeded: ${memoryMB.toFixed(1)}MB > ${memoryLimitMB}MB. Processing stopped to prevent browser crash.`);}if(memoryMB>memoryWarningMB){addLog(`âš ï¸ High memory usage: ${memoryMB.toFixed(1)}MB (approaching ${memoryLimitMB}MB limit)`,'warning');}return memoryMB;}return 0;};const initialMemory=checkMemoryUsage();addLog(`ğŸ’¾ Initial memory usage: ${initialMemory.toFixed(1)} MB`,'info');// Implement much stricter file size limits to prevent crashes\nconst maxFileSize=1*1024*1024;// Reduced to 1MB per file\nconst maxTotalSize=5*1024*1024;// Reduced to 5MB total\nconst maxFiles=5;// Reduced to maximum 5 files to prevent crashes\nlet totalSize=0;const validFiles=[];for(const file of files.slice(0,maxFiles)){const fileSize=file.content?file.content.length:0;if(fileSize>maxFileSize){addLog(`âŒ Skipping ${file.name}: too large (${(fileSize/1024/1024).toFixed(1)}MB > 1MB limit)`,'error');continue;}if(totalSize+fileSize>maxTotalSize){addLog(`âš ï¸ Stopping file processing: total size limit reached (${(totalSize/1024/1024).toFixed(1)}MB)`,'warning');break;}totalSize+=fileSize;validFiles.push(file);}if(files.length>maxFiles){addLog(`âš ï¸ Limited to first ${maxFiles} files (${files.length} total) to prevent browser crashes`,'warning');}addLog(`ğŸ“Š Processing ${validFiles.length} files (${(totalSize/1024/1024).toFixed(1)}MB total)`,'info');addLog('ğŸ“¦ Loading YAML processing library...','info');const yaml=await import('js-yaml');addLog('âœ… Libraries loaded successfully','success');addLog('ğŸ“ Processing configuration...','info');// Prepare configuration\nlet configObj=null;if(config){try{configObj=typeof config==='string'?yaml.default.load(config):config;addLog(`ğŸ“‹ Package: ${configObj.name||'Unknown'}`,'success');addLog(`ğŸ“‹ Version: ${configObj.version||'Unknown'}`,'success');addLog(`ğŸ“‹ FHIR Version: ${configObj.fhirVersion||'Unknown'}`,'success');}catch(err){addLog(`âš ï¸ Could not parse config: ${err.message}`,'warning');}}else{// Create a default configuration\nconfigObj={name:'browser-generated-ig',version:'1.0.0',fhirVersion:'4.0.1',id:'browser.generated.ig',canonical:'http://example.org/fhir/ig/browser-generated',status:'draft'};addLog('ğŸ“‹ Using default configuration','info');}addLog(`ğŸ” Analyzing ${validFiles.length} FSH files with crash prevention...`,'info');const generatedResources=[];let processedCount=0;const maxResourcesPerFile=3;// Reduced from 5 to 3 resources per file\nconst maxTotalResources=15;// Reduced from 50 to 15 total resources\n// Process files one at a time to prevent memory buildup\nconst chunkSize=1;// Process 1 file at a time for maximum safety\nfor(let i=0;i<validFiles.length;i+=chunkSize){const chunk=validFiles.slice(i,i+chunkSize);for(const file of chunk){addLog(`ğŸ“„ Processing ${file.name} (${processedCount+1}/${validFiles.length})...`,'info');// Enhanced memory check before processing each file\nconst currentMemory=checkMemoryUsage();// Stop if we're approaching memory limits (much stricter threshold)\nif(currentMemory>15){// Reduced from 80MB to 15MB threshold\naddLog(`âš ï¸ Stopping processing due to high memory usage (${currentMemory.toFixed(1)}MB)`,'warning');break;}// Stop if we've reached resource limits\nif(generatedResources.length>=maxTotalResources){addLog(`âš ï¸ Reached maximum resource limit (${maxTotalResources}), stopping processing`,'warning');break;}const content=file.content;// Enhanced FSH parsing with stricter limits\nconst extractFSHDefinitions=content=>{try{const definitions={profiles:[],instances:[],valueSets:[],codeSystems:[],extensions:[]};// Check for empty or invalid content\nif(!content||typeof content!=='string'){return definitions;}// Much stricter line processing limit to prevent memory issues\nconst lines=content.split('\\n');const maxLinesToProcess=500;// Reduced from 1k to 500 lines per file\nif(lines.length>maxLinesToProcess){addLog(`  âš ï¸ File is large (${lines.length} lines). Processing first ${maxLinesToProcess} lines only.`,'warning');}const linesToProcess=lines.slice(0,Math.min(lines.length,maxLinesToProcess));let currentDefinition=null;let currentType=null;let definitionCount=0;const maxDefinitionsPerFile=5;// Reduced from 10 to 5 definitions per file\nfor(let i=0;i<linesToProcess.length&&definitionCount<maxDefinitionsPerFile;i++){const line=linesToProcess[i].trim();// Skip empty lines and comments to improve performance\nif(!line||line.startsWith('//')||line.startsWith('/*')){continue;}// Detect definition types\nif(line.startsWith('Profile:')){if(definitionCount>=maxDefinitionsPerFile)break;currentType='profiles';currentDefinition={name:line.substring(8).trim(),type:'Profile',parent:null,id:null,title:null,description:null,rules:[]};definitionCount++;}else if(line.startsWith('Instance:')){if(definitionCount>=maxDefinitionsPerFile)break;currentType='instances';currentDefinition={name:line.substring(9).trim(),type:'Instance',instanceOf:null,usage:null,title:null,description:null,rules:[]};definitionCount++;}else if(line.startsWith('ValueSet:')){if(definitionCount>=maxDefinitionsPerFile)break;currentType='valueSets';currentDefinition={name:line.substring(9).trim(),type:'ValueSet',id:null,title:null,description:null,rules:[]};definitionCount++;}else if(line.startsWith('CodeSystem:')){if(definitionCount>=maxDefinitionsPerFile)break;currentType='codeSystems';currentDefinition={name:line.substring(11).trim(),type:'CodeSystem',id:null,title:null,description:null,rules:[]};definitionCount++;}else if(line.startsWith('Extension:')){if(definitionCount>=maxDefinitionsPerFile)break;currentType='extensions';currentDefinition={name:line.substring(10).trim(),type:'Extension',id:null,title:null,description:null,rules:[]};definitionCount++;}// Parse properties\nif(currentDefinition){if(line.startsWith('Parent:')){currentDefinition.parent=line.substring(7).trim();}else if(line.startsWith('InstanceOf:')){currentDefinition.instanceOf=line.substring(11).trim();}else if(line.startsWith('Usage:')){currentDefinition.usage=line.substring(6).trim();}else if(line.startsWith('Id:')){currentDefinition.id=line.substring(3).trim();}else if(line.startsWith('Title:')){currentDefinition.title=line.substring(6).trim().replace(/['\"]/g,'');}else if(line.startsWith('Description:')){currentDefinition.description=line.substring(12).trim().replace(/['\"]/g,'');}else if(line.startsWith('* ')){// Much stricter rule limit to prevent memory issues\nif(currentDefinition.rules.length<5){currentDefinition.rules.push(line.substring(2).trim());}}// If we hit a new definition or end of content, save current one\nif(line.includes(':')&&!line.startsWith('* ')&&!line.startsWith('Parent:')&&!line.startsWith('InstanceOf:')&&!line.startsWith('Usage:')&&!line.startsWith('Id:')&&!line.startsWith('Title:')&&!line.startsWith('Description:')||i===linesToProcess.length-1){if(currentDefinition&&currentType&&currentDefinition.name){definitions[currentType].push(currentDefinition);}currentDefinition=null;currentType=null;i--;// Re-process this line for the new definition\n}}}if(definitionCount>=maxDefinitionsPerFile){addLog(`  âš ï¸ Limited to ${maxDefinitionsPerFile} definitions per file to prevent browser crashes`,'warning');}return definitions;}catch(err){addLog(`  âŒ Error parsing FSH content: ${err.message}`,'error');return{profiles:[],instances:[],valueSets:[],codeSystems:[],extensions:[]};}};const definitions=extractFSHDefinitions(content);// Generate FHIR resources with strict memory management\nlet resourcesFromThisFile=0;const remainingResourceSlots=maxTotalResources-generatedResources.length;const maxFromThisFile=Math.min(maxResourcesPerFile,remainingResourceSlots);// Process profiles with strict limits\nfor(const profile of definitions.profiles.slice(0,Math.min(1,maxFromThisFile-resourcesFromThisFile))){if(resourcesFromThisFile>=maxFromThisFile)break;try{const profileId=profile.id||profile.name.toLowerCase().replace(/\\s+/g,'-');const structureDefinition={resourceType:'StructureDefinition',id:profileId,url:`${configObj.canonical}/StructureDefinition/${profileId}`,name:profile.name,title:profile.title||profile.name,status:'draft',fhirVersion:configObj.fhirVersion||'4.0.1',kind:'resource',abstract:false,type:profile.parent==='Patient'?'Patient':profile.parent==='Observation'?'Observation':profile.parent||'DomainResource',baseDefinition:`http://hl7.org/fhir/StructureDefinition/${profile.parent||'DomainResource'}`,derivation:'constraint',description:profile.description||`Profile for ${profile.name}`};// Limit differential elements to prevent memory issues\nif(profile.rules.length>0){structureDefinition.differential={element:profile.rules.slice(0,2).map((rule,index)=>({// Reduced to 2 elements max\nid:`${structureDefinition.type}.${rule.split(' ')[0]}`,path:`${structureDefinition.type}.${rule.split(' ')[0]}`,short:`Rule: ${rule}`}))};}generatedResources.push({type:'StructureDefinition',filename:`StructureDefinition-${profileId}.json`,content:JSON.stringify(structureDefinition,null,2),id:profileId,name:profile.name,title:structureDefinition.title,url:structureDefinition.url});resourcesFromThisFile++;addLog(`  ğŸ“Š Generated StructureDefinition: ${profile.name}`,'success');}catch(err){addLog(`  âŒ Error generating StructureDefinition for ${profile.name}: ${err.message}`,'error');}}// Process instances with strict limits\nfor(const instance of definitions.instances.slice(0,Math.min(1,maxFromThisFile-resourcesFromThisFile))){if(resourcesFromThisFile>=maxFromThisFile)break;try{const instanceId=instance.name.toLowerCase().replace(/\\s+/g,'-');const resourceType=instance.instanceOf==='Patient'?'Patient':instance.instanceOf==='Observation'?'Observation':'Patient';// Default fallback\nconst fhirInstance={resourceType:resourceType,id:instanceId,meta:{profile:instance.instanceOf?[`${configObj.canonical}/StructureDefinition/${instance.instanceOf}`]:undefined}};// Add minimal properties to reduce memory usage\nif(resourceType==='Patient'){fhirInstance.name=[{family:instance.name.split(' ').pop(),given:instance.name.split(' ').slice(0,-1)}];}generatedResources.push({type:resourceType,filename:`${instanceId}.json`,content:JSON.stringify(fhirInstance,null,2),id:instanceId,resourceType:resourceType});resourcesFromThisFile++;addLog(`  ğŸ“Š Generated ${resourceType} instance: ${instance.name}`,'success');}catch(err){addLog(`  âŒ Error generating instance for ${instance.name}: ${err.message}`,'error');}}// Process ValueSets and CodeSystems with even stricter limits\nfor(const vs of definitions.valueSets.slice(0,Math.min(1,maxFromThisFile-resourcesFromThisFile))){if(resourcesFromThisFile>=maxFromThisFile)break;try{const vsId=vs.id||vs.name.toLowerCase().replace(/\\s+/g,'-');const valueSet={resourceType:'ValueSet',id:vsId,url:`${configObj.canonical}/ValueSet/${vsId}`,name:vs.name,title:vs.title||vs.name,status:'draft',description:vs.description||`ValueSet for ${vs.name}`,compose:{include:[{system:'http://example.org/codes',concept:[{code:'example1',display:'Example Code 1'}]}]}};generatedResources.push({type:'ValueSet',filename:`ValueSet-${vsId}.json`,content:JSON.stringify(valueSet,null,2),id:vsId,name:vs.name,title:valueSet.title,url:valueSet.url});resourcesFromThisFile++;addLog(`  ğŸ“Š Generated ValueSet: ${vs.name}`,'success');}catch(err){addLog(`  âŒ Error generating ValueSet for ${vs.name}: ${err.message}`,'error');}}if(file.isFromStaging){addLog(`  ğŸ—ï¸ File from staging ground`,'info');}processedCount++;// Clear file content from memory immediately after processing\nfile.content=null;// Force garbage collection more frequently\nif(window.gc&&typeof window.gc==='function'){window.gc();}}// Yield control for longer periods between chunks to prevent blocking\nawait new Promise(resolve=>setTimeout(resolve,200));// Increased to 200ms delay between files\n// Enhanced memory monitoring after each file\nconst memoryAfterChunk=checkMemoryUsage();addLog(`ğŸ’¾ Memory after file: ${memoryAfterChunk.toFixed(1)} MB (processed ${Math.min(i+chunkSize,validFiles.length)}/${validFiles.length})`,'info');// Break if memory is getting too high (much lower threshold)\nif(memoryAfterChunk>20){addLog(`âš ï¸ Stopping processing due to high memory usage`,'warning');break;}}// Set generated files\nsetGeneratedFiles(generatedResources);// Final memory check\nconst finalMemory=checkMemoryUsage();addLog(`ğŸ’¾ Final memory usage: ${finalMemory.toFixed(1)} MB`,'info');addLog('âœ¨ FSH compilation completed with crash prevention!','success');addLog(`ğŸ“¦ Generated ${generatedResources.length} FHIR resources total (limited for stability)`,'success');// Check for staging files\nconst stagingCount=validFiles.filter(f=>f.isFromStaging).length;if(stagingCount>0){addLog(`ğŸ—ï¸ ${stagingCount} file(s) from staging ground included`,'info');}// Handle edge cases\nif(validFiles.length===0){addLog('âš ï¸ No FSH files found or all files too large to process safely','warning');}if(!config){addLog('âš ï¸ No sushi-config.yaml found - used default configuration','warning');}// Safety warnings\nif(generatedResources.length>=maxTotalResources){addLog(`âš ï¸ Output limited to ${maxTotalResources} resources to prevent browser crashes`,'warning');}if(validFiles.length<files.length){addLog(`âš ï¸ ${files.length-validFiles.length} files skipped due to size limits`,'warning');}return{success:true,resourceCount:generatedResources.length,warnings:[],errors:[],generatedFiles:generatedResources};}catch(err){addLog(`âŒ Compilation failed: ${err.message}`,'error');// Log additional error details if available\nif(err.stack){console.error('Compilation error stack:',err.stack);}throw err;}};const handleRunSushi=async function(){let withStagingFiles=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;setIsRunning(true);setShowModal(true);setLogs([]);setGeneratedFiles([]);setActiveTab('logs');setError(null);setIncludeStagingFiles(withStagingFiles);try{addLog('ğŸ Starting SUSHI client-side execution...','info');if(withStagingFiles&&stagingFiles.length>0){addLog(`ğŸ—‚ï¸ Including ${stagingFiles.length} staging files`,'info');}// Fetch repository files\nconst{config,fshFiles:repoFiles}=await fetchRepositoryFiles();// Integrate staging files if requested\nconst finalFiles=withStagingFiles?integrateStagingFiles(repoFiles):repoFiles;if(withStagingFiles){addLog(`ğŸ“Š Final file count: ${finalFiles.length} FSH files`,'info');}// Run SUSHI\nawait runSushiInBrowser(config,finalFiles);addLog('ğŸ‰ SUSHI execution completed successfully!','success');}catch(err){setError(err.message);addLog(`ğŸ’¥ Execution failed: ${err.message}`,'error');}finally{setIsRunning(false);}};const toggleLogLevel=useCallback(level=>{setLogLevelToggles(prev=>({...prev,[level]:!prev[level]}));},[]);const clearLogs=useCallback(()=>{setLogs([]);setGeneratedFiles([]);setActiveTab('logs');setLogLevelToggles({info:true,success:true,warning:true,error:true});setSearchText('');},[]);const copyAllLogs=useCallback(async()=>{const logText=logs.map(log=>`[${new Date(log.timestamp).toLocaleTimeString()}] ${log.message}`).join('\\n');try{await navigator.clipboard.writeText(logText);}catch(err){console.error('Failed to copy logs:',err);}},[logs]);const copyLogMessage=useCallback(async message=>{try{await navigator.clipboard.writeText(message);}catch(err){console.error('Failed to copy log message:',err);}},[]);// Function to detect and create links for files mentioned in log messages\nconst parseLogMessage=useCallback((message,logId)=>{// More precise regex to find valid file paths - must be preceded by whitespace or start of line\n// and must be a complete path (not part of a longer word)\nconst filePathRegex=/(?:^|\\s)((?:input\\/fsh\\/[a-zA-Z0-9_/-]*\\/)?[a-zA-Z0-9_.-]+\\.(?:fsh|yaml|yml|json))(?=\\s|$|[.,!])/g;const matches=[...message.matchAll(filePathRegex)];if(matches.length===0){return/*#__PURE__*/_jsx(\"span\",{children:message});}let lastIndex=0;const elements=[];let elementCounter=0;// Add counter for unique keys\nmatches.forEach((match,index)=>{const fullMatch=match[0];const filePath=match[1];const matchIndex=match.index;// Add text before the match\nif(matchIndex>lastIndex){elements.push(/*#__PURE__*/_jsx(\"span\",{children:message.substring(lastIndex,matchIndex)},`${logId}-text-${elementCounter++}`));}// Add the leading whitespace if present\nconst leadingWhitespace=fullMatch.substring(0,fullMatch.indexOf(filePath));if(leadingWhitespace){elements.push(/*#__PURE__*/_jsx(\"span\",{children:leadingWhitespace},`${logId}-ws-${elementCounter++}`));}// Determine link type based on file location and validate the file exists\nconst createFileLink=(path,text,keyIndex)=>{// Check if file exists in our known file lists to avoid creating invalid links\nconst isKnownRepoFile=fshFiles.some(f=>f.path===path);const isFromStaging=stagingFiles.some(f=>f.path&&(f.path===path||f.path.endsWith(`/${path.split('/').pop()}`)));const isSushiConfig=path==='sushi-config.yaml';// Only create links for files we know exist\nif(!isKnownRepoFile&&!isFromStaging&&!isSushiConfig){// File not found in our known files, return as plain text\nreturn/*#__PURE__*/_jsx(\"span\",{className:\"file-mention\",children:text},`${logId}-text-${keyIndex}`);}if(isFromStaging){// Link to staging ground\nreturn/*#__PURE__*/_jsxs(\"span\",{className:\"file-link staging-link\",title:\"File from Staging Ground\",children:[\"\\uD83D\\uDCDD \",text]},`${logId}-staging-${keyIndex}`);}else if(path.startsWith('input/fsh/')){// Determine DAK component based on directory structure\nconst getDakComponentLink=fshPath=>{const pathParts=fshPath.split('/');if(pathParts.length>2){const subDir=pathParts[2];switch(subDir){case'profiles':return{component:'Profiles',icon:'ğŸ‘¤'};case'examples':return{component:'Examples',icon:'ğŸ“‹'};case'valuesets':return{component:'ValueSets',icon:'ğŸ“Š'};case'codesystems':return{component:'CodeSystems',icon:'ğŸ”¢'};case'extensions':return{component:'Extensions',icon:'ğŸ”§'};default:return{component:'FSH Files',icon:'ğŸ“„'};}}return{component:'FSH Files',icon:'ğŸ“„'};};const dakInfo=getDakComponentLink(path);return/*#__PURE__*/_jsxs(\"span\",{className:\"file-link dak-link\",title:`View in DAK ${dakInfo.component}`,children:[dakInfo.icon,\" \",text]},`${logId}-dak-${keyIndex}`);}else{// Link to GitHub source for valid repository files\nconst githubUrl=`https://github.com/${owner}/${repoName}/blob/${selectedBranch}/${path}`;return/*#__PURE__*/_jsxs(\"a\",{href:githubUrl,target:\"_blank\",rel:\"noopener noreferrer\",className:\"file-link github-link\",title:\"Open in GitHub\",children:[\"\\uD83D\\uDD17 \",text]},`${logId}-github-${keyIndex}`);}};elements.push(createFileLink(filePath,filePath,elementCounter++));lastIndex=matchIndex+fullMatch.length;});// Add remaining text\nif(lastIndex<message.length){elements.push(/*#__PURE__*/_jsx(\"span\",{children:message.substring(lastIndex)},`${logId}-text-end-${elementCounter++}`));}return/*#__PURE__*/_jsx(\"span\",{children:elements});},[owner,repoName,selectedBranch,stagingFiles,fshFiles]);// Optimized filtered logs with useMemo to prevent unnecessary re-computations\nconst filteredLogs=useMemo(()=>{return logs.filter(log=>{// Filter by log level toggles\nconst isLevelEnabled=logLevelToggles[log.type];// Filter by search text\nconst matchesSearch=searchText===''||log.message.toLowerCase().includes(searchText.toLowerCase());return isLevelEnabled&&matchesSearch;});},[logs,logLevelToggles,searchText]);// Separate component for log controls to prevent re-renders\nconst LogControls=/*#__PURE__*/React.memo(_ref2=>{let{logLevelToggles,onToggleLogLevel,searchText,onSearchChange,filteredCount,totalCount}=_ref2;const handleSearchChange=useCallback(e=>{onSearchChange(e.target.value);},[onSearchChange]);return/*#__PURE__*/_jsxs(\"div\",{className:\"log-controls\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"log-level-toggles\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"toggle-group-label\",children:\"Show levels:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"toggle-buttons\",children:[{key:'info',label:'Info',icon:'â„¹ï¸'},{key:'success',label:'Success',icon:'âœ…'},{key:'warning',label:'Warning',icon:'âš ï¸'},{key:'error',label:'Error',icon:'âŒ'}].map(_ref3=>{let{key,label,icon}=_ref3;return/*#__PURE__*/_jsxs(\"button\",{className:`log-toggle-btn ${logLevelToggles[key]?'active':'inactive'}`,onClick:()=>onToggleLogLevel(key),title:`Toggle ${label} messages`,children:[icon,\" \",label]},key);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"log-search-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"log-search\",children:\"Search logs:\"}),/*#__PURE__*/_jsx(\"input\",{id:\"log-search\",type:\"text\",value:searchText,onChange:handleSearchChange,placeholder:\"Search log messages...\",className:\"log-search-input\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"log-stats\",children:searchText||Object.values(logLevelToggles).some(v=>!v)?/*#__PURE__*/_jsxs(\"span\",{children:[\"Showing \",filteredCount,\" of \",totalCount,\" logs\"]}):/*#__PURE__*/_jsxs(\"span\",{children:[totalCount,\" logs\"]})})]});});const handleSearchChange=useCallback(value=>{setSearchText(value);},[]);const viewFile=useCallback(file=>{setSelectedFile(file);setShowFileViewer(true);},[]);const closeFileViewer=useCallback(()=>{setShowFileViewer(false);setSelectedFile(null);},[]);const getResourceTypeIcon=type=>{switch(type){case'StructureDefinition':return'ğŸ—ï¸';case'Patient':return'ğŸ‘¤';case'ValueSet':return'ğŸ“Š';case'CodeSystem':return'ğŸ”¢';case'Organization':return'ğŸ¢';case'Practitioner':return'ğŸ‘¨â€âš•ï¸';case'Observation':return'ğŸ“‹';default:return'ğŸ“„';}};const FileViewerModal=()=>{if(!selectedFile)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"file-viewer-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"file-viewer-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"file-viewer-header\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[getResourceTypeIcon(selectedFile.type),\" \",selectedFile.filename]}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-viewer-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigator.clipboard.writeText(selectedFile.content),className:\"copy-file-btn\",title:\"Copy file content to clipboard\",children:\"\\uD83D\\uDCCB Copy\"}),/*#__PURE__*/_jsx(\"button\",{onClick:closeFileViewer,className:\"close-file-viewer-btn\",children:\"\\u2715\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"file-viewer-content\",children:/*#__PURE__*/_jsx(SyntaxHighlighter,{language:\"json\",style:oneLight,showLineNumbers:true,wrapLines:true,customStyle:{fontSize:'14px',lineHeight:'1.4',maxHeight:'70vh',overflow:'auto'},children:selectedFile.content})}),/*#__PURE__*/_jsx(\"div\",{className:\"file-viewer-footer\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"file-info\",children:[\"Resource Type: \",selectedFile.type,\" | Size: \",(selectedFile.content.length/1024).toFixed(1),\" KB\"]})})]})});};const LogModal=()=>/*#__PURE__*/_jsx(\"div\",{className:\"sushi-modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sushi-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sushi-modal-header\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"\\uD83C\\uDF63 SUSHI Client-Side Execution\",includeStagingFiles&&/*#__PURE__*/_jsx(\"span\",{className:\"staging-badge\",children:\"+ Staging\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:copyAllLogs,className:\"copy-all-btn\",disabled:logs.length===0,title:\"Copy all logs to clipboard\",children:\"\\uD83D\\uDCCB Copy All\"}),/*#__PURE__*/_jsx(\"button\",{onClick:clearLogs,className:\"clear-logs-btn\",disabled:isRunning,children:\"\\uD83D\\uDDD1\\uFE0F Clear\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowModal(false),className:\"close-modal-btn\",children:\"\\u2715\"})]})]}),/*#__PURE__*/_jsx(LogControls,{logLevelToggles:logLevelToggles,onToggleLogLevel:toggleLogLevel,searchText:searchText,onSearchChange:handleSearchChange,filteredCount:filteredLogs.length,totalCount:logs.length}),generatedFiles.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"modal-section-toggle\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"toggle-options\",children:[/*#__PURE__*/_jsx(\"button\",{className:`toggle-btn ${activeTab==='logs'?'active':''}`,onClick:()=>setActiveTab('logs'),children:\"\\uD83D\\uDCC4 Logs & Messages\"}),/*#__PURE__*/_jsx(\"button\",{className:`toggle-btn ${activeTab==='files'?'active':''}`,onClick:()=>setActiveTab('files'),children:\"\\uD83D\\uDCE6 Generated Resources\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"section-info\",children:activeTab==='logs'?/*#__PURE__*/_jsxs(\"span\",{className:\"info-text\",children:[logs.length,\" log entries \\u2022 Use toggles to filter by level\"]}):/*#__PURE__*/_jsxs(\"span\",{className:\"info-text\",children:[generatedFiles.length,\" FHIR resources generated\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sushi-modal-content\",children:[(activeTab==='logs'||generatedFiles.length===0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"log-container\",children:[filteredLogs.map(log=>/*#__PURE__*/_jsxs(\"div\",{className:`log-entry log-${log.type}`,children:[/*#__PURE__*/_jsx(\"span\",{className:\"log-timestamp\",children:new Date(log.timestamp).toLocaleTimeString()}),/*#__PURE__*/_jsx(\"span\",{className:\"log-message\",children:parseLogMessage(log.message,log.id)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>copyLogMessage(log.message),className:\"copy-log-btn\",title:\"Copy this message to clipboard\",children:\"\\uD83D\\uDCCB\"})]},log.id)),isRunning&&/*#__PURE__*/_jsxs(\"div\",{className:\"log-entry log-running\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"log-timestamp\",children:new Date().toLocaleTimeString()}),/*#__PURE__*/_jsxs(\"span\",{className:\"log-message\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"spinner\",children:\"\\u23F3\"}),\" Processing...\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"copy-log-btn-placeholder\"})]}),filteredLogs.length===0&&!isRunning&&logs.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"log-placeholder\",children:\"No logs match the current filter criteria...\"}),logs.length===0&&!isRunning&&/*#__PURE__*/_jsx(\"div\",{className:\"log-placeholder\",children:\"Logs will appear here during SUSHI execution...\"}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-summary\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u274C Execution Error\"}),/*#__PURE__*/_jsx(\"p\",{children:error})]})]}),activeTab==='files'&&generatedFiles.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"generated-files-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"generated-files-section\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"\\uD83D\\uDCE6 Generated FHIR Resources (\",generatedFiles.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"generated-files-grid\",children:generatedFiles.map((file,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"generated-file-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"file-card-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"file-icon\",children:getResourceTypeIcon(file.type)}),/*#__PURE__*/_jsx(\"span\",{className:\"file-name\",children:file.filename})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-card-details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"file-type\",children:file.type}),/*#__PURE__*/_jsxs(\"span\",{className:\"file-size\",children:[(file.content.length/1024).toFixed(1),\" KB\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-card-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>viewFile(file),className:\"view-file-btn\",title:\"View resource content\",children:\"\\uD83D\\uDC41\\uFE0F View\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigator.clipboard.writeText(file.content),className:\"copy-file-btn\",title:\"Copy to clipboard\",children:\"\\uD83D\\uDCCB\"})]})]},index))}),/*#__PURE__*/_jsxs(\"div\",{className:\"fhir-viewer-suggestions\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"\\uD83D\\uDCA1 Enhanced FHIR Viewing Options\"}),/*#__PURE__*/_jsx(\"p\",{children:\"For better FHIR resource visualization, consider these viewers:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"FHIR Tree Viewer:\"}),\" \",/*#__PURE__*/_jsx(\"code\",{children:\"npm install @types/fhir\"}),\" + custom tree renderer\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"FHIR Path Viewer:\"}),\" \",/*#__PURE__*/_jsx(\"code\",{children:\"npm install fhirpath\"}),\" for interactive querying\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"FHIR UI:\"}),\" \",/*#__PURE__*/_jsx(\"code\",{children:\"npm install @asymmetrik/fhir-kit-client\"}),\" with UI components\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"HL7 FHIR Viewer:\"}),\" Integration with official HL7 FHIR viewers\"]})]})]})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sushi-modal-footer\",children:/*#__PURE__*/_jsx(\"div\",{className:\"execution-info\",children:isRunning?/*#__PURE__*/_jsx(\"span\",{className:\"status-running\",children:\"\\uD83D\\uDD04 Running SUSHI...\"}):logs.length>0?/*#__PURE__*/_jsx(\"span\",{className:\"status-complete\",children:\"\\u2705 Execution complete\"}):/*#__PURE__*/_jsx(\"span\",{className:\"status-ready\",children:\"\\uD83C\\uDF63 Ready to run SUSHI\"})})})]})});return/*#__PURE__*/_jsx(SushiErrorBoundary,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"sushi-runner-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:`sushi-status-bar ${isExpanded?'expanded':'collapsed'}`,onClick:()=>setIsExpanded(!isExpanded),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"status-bar-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"status-icon\",children:\"\\uD83C\\uDF63\"}),/*#__PURE__*/_jsx(\"span\",{className:\"status-title\",children:\"SUSHI (FHIR Shorthand)\"}),/*#__PURE__*/_jsx(\"span\",{className:\"expand-icon\",children:isExpanded?'â–¼':'â–¶'})]}),!isExpanded&&/*#__PURE__*/_jsx(\"div\",{className:\"status-summary\",children:\"Client-side FHIR Implementation Guide compilation\"})]}),isExpanded&&/*#__PURE__*/_jsxs(\"div\",{className:\"sushi-controls\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sushi-description\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Run SUSHI (FHIR Shorthand) compilation directly in your browser to generate FHIR Implementation Guide resources from FSH files.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"execution-options\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"execution-mode-selector\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u2699\\uFE0F Execution Mode\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mode-options\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"mode-option\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"executionMode\",value:\"auto\",checked:executionMode==='auto',onChange:e=>setExecutionMode(e.target.value)}),/*#__PURE__*/_jsxs(\"span\",{className:\"mode-label\",children:[\"\\uD83E\\uDD16 Auto (WebAssembly when available)\",wasmSupported&&wasmInitialized&&/*#__PURE__*/_jsx(\"span\",{className:\"wasm-badge\",children:\"WASM Ready\"})]})]}),wasmSupported&&/*#__PURE__*/_jsxs(\"label\",{className:\"mode-option\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"executionMode\",value:\"wasm\",checked:executionMode==='wasm',onChange:e=>setExecutionMode(e.target.value),disabled:!wasmInitialized}),/*#__PURE__*/_jsxs(\"span\",{className:\"mode-label\",children:[\"\\uD83D\\uDE80 WebAssembly (High Performance)\",!wasmInitialized&&/*#__PURE__*/_jsx(\"span\",{className:\"loading-badge\",children:\"Initializing...\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"mode-option\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"executionMode\",value:\"javascript\",checked:executionMode==='javascript',onChange:e=>setExecutionMode(e.target.value)}),/*#__PURE__*/_jsx(\"span\",{className:\"mode-label\",children:\"\\u2699\\uFE0F JavaScript (Fallback)\"})]})]}),!wasmSupported&&/*#__PURE__*/_jsx(\"div\",{className:\"wasm-not-supported\",children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u26A0\\uFE0F WebAssembly is not supported in this browser. JavaScript fallback will be used.\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"option-group\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\uD83D\\uDCC2 Repository Files Only\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Compile using sushi-config.yaml and input/fsh files from the GitHub repository (\",selectedBranch,\" branch).\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"run-sushi-btn primary\",onClick:()=>handleRunSushi(false),disabled:isRunning,children:isRunning?'â³ Running...':'ğŸš€ Run SUSHI'})]}),stagingFiles.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"option-group\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\uD83C\\uDFD7\\uFE0F Repository + Staging Files\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Compile using repository files, with staging ground files (\",stagingFiles.length,\" files) overriding any repository files with the same name.\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"run-sushi-btn secondary\",onClick:()=>handleRunSushi(true),disabled:isRunning,children:isRunning?'â³ Running...':'ğŸš€ Run SUSHI + Staging'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sushi-status\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"status-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Execution:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:wasmSupported&&wasmInitialized?'ğŸš€ WebAssembly Ready':'âš™ï¸ JavaScript'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"status-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Config:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:sushiConfig?'âœ… Found':'â“ Unknown'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"status-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"FSH Files:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[fshFiles.length,\" in repository\"]})]}),stagingFiles.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"status-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:\"Staging:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"value\",children:[stagingFiles.filter(f=>f.path&&f.path.endsWith('.fsh')).length,\" FSH files\"]})]})]})]}),showModal&&/*#__PURE__*/_jsx(LogModal,{}),showFileViewer&&/*#__PURE__*/_jsx(FileViewerModal,{})]})});};export default SushiRunner;","map":{"version":3,"names":["React","useState","useCallback","useMemo","useEffect","Prism","SyntaxHighlighter","oneLight","githubService","sushiWasmService","WasmLoader","performanceMonitor","SushiErrorBoundary","jsx","_jsx","jsxs","_jsxs","SushiRunner","_ref","_repository$owner","repository","selectedBranch","profile","stagingFiles","isExpanded","setIsExpanded","isRunning","setIsRunning","showModal","setShowModal","logs","setLogs","generatedFiles","setGeneratedFiles","showFileViewer","setShowFileViewer","selectedFile","setSelectedFile","activeTab","setActiveTab","logLevelToggles","setLogLevelToggles","info","success","warning","error","searchText","setSearchText","sushiConfig","setSushiConfig","fshFiles","setFshFiles","includeStagingFiles","setIncludeStagingFiles","setError","executionMode","setExecutionMode","wasmSupported","setWasmSupported","wasmInitialized","setWasmInitialized","owner","login","full_name","split","repoName","name","addLog","message","type","arguments","length","undefined","prev","id","Date","now","Math","random","timestamp","toISOString","checkWasmSupport","supported","isSupported","initialize","err","fetchRepositoryFiles","config","configContent","getFileContent","scanDirectory","dirPath","depth","maxDepth","contents","getDirectoryContents","item","endsWith","fileContent","path","push","content","integrateStagingFiles","repoFshFiles","integratedFiles","forEach","stagingFile","fileName","pop","existingIndex","findIndex","f","isFromStaging","runSushiInBrowser","files","useWasm","mode","startTiming","result","runSushiWithWasm","runSushiWithJavaScript","duration","endTiming","toFixed","fallbackErr","runSushi","generatedResources","map","file","resourceType","filename","warnings","resourceCount","errors","Error","join","checkMemoryUsage","performance","memory","usedJSHeapSize","memoryMB","memoryLimitMB","memoryWarningMB","initialMemory","maxFileSize","maxTotalSize","maxFiles","totalSize","validFiles","slice","fileSize","yaml","configObj","default","load","version","fhirVersion","canonical","status","processedCount","maxResourcesPerFile","maxTotalResources","chunkSize","i","chunk","currentMemory","extractFSHDefinitions","definitions","profiles","instances","valueSets","codeSystems","extensions","lines","maxLinesToProcess","linesToProcess","min","currentDefinition","currentType","definitionCount","maxDefinitionsPerFile","line","trim","startsWith","substring","parent","title","description","rules","instanceOf","usage","replace","includes","resourcesFromThisFile","remainingResourceSlots","maxFromThisFile","profileId","toLowerCase","structureDefinition","url","kind","abstract","baseDefinition","derivation","differential","element","rule","index","short","JSON","stringify","instance","instanceId","fhirInstance","meta","family","given","vs","vsId","valueSet","compose","include","system","concept","code","display","window","gc","Promise","resolve","setTimeout","memoryAfterChunk","finalMemory","stagingCount","filter","stack","console","handleRunSushi","withStagingFiles","repoFiles","finalFiles","toggleLogLevel","level","clearLogs","copyAllLogs","logText","log","toLocaleTimeString","navigator","clipboard","writeText","copyLogMessage","parseLogMessage","logId","filePathRegex","matches","matchAll","children","lastIndex","elements","elementCounter","match","fullMatch","filePath","matchIndex","leadingWhitespace","indexOf","createFileLink","text","keyIndex","isKnownRepoFile","some","isSushiConfig","className","getDakComponentLink","fshPath","pathParts","subDir","component","icon","dakInfo","githubUrl","href","target","rel","filteredLogs","isLevelEnabled","matchesSearch","LogControls","memo","_ref2","onToggleLogLevel","onSearchChange","filteredCount","totalCount","handleSearchChange","e","value","key","label","_ref3","onClick","htmlFor","onChange","placeholder","Object","values","v","viewFile","closeFileViewer","getResourceTypeIcon","FileViewerModal","language","style","showLineNumbers","wrapLines","customStyle","fontSize","lineHeight","maxHeight","overflow","LogModal","disabled","checked"],"sources":["/home/runner/work/sgex/sgex/src/components/SushiRunner.js"],"sourcesContent":["import React, { useState, useCallback, useMemo, useEffect } from 'react';\nimport { Prism as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport { oneLight } from 'react-syntax-highlighter/dist/esm/styles/prism';\nimport githubService from '../services/githubService';\nimport sushiWasmService from '../services/sushiWasmService';\nimport { WasmLoader, performanceMonitor } from '../utils/wasmLoader';\nimport SushiErrorBoundary from './SushiErrorBoundary';\nimport './SushiRunner.css';\n\nconst SushiRunner = ({ repository, selectedBranch, profile, stagingFiles = [] }) => {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [isRunning, setIsRunning] = useState(false);\n  const [showModal, setShowModal] = useState(false);\n  const [logs, setLogs] = useState([]);\n  const [generatedFiles, setGeneratedFiles] = useState([]);\n  const [showFileViewer, setShowFileViewer] = useState(false);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [activeTab, setActiveTab] = useState('logs');\n  const [logLevelToggles, setLogLevelToggles] = useState({\n    info: true,\n    success: true,\n    warning: true,\n    error: true\n  });\n  const [searchText, setSearchText] = useState('');\n  const [sushiConfig, setSushiConfig] = useState(null);\n  const [fshFiles, setFshFiles] = useState([]);\n  const [includeStagingFiles, setIncludeStagingFiles] = useState(false);\n  const [error, setError] = useState(null);\n  const [executionMode, setExecutionMode] = useState('auto'); // 'auto', 'wasm', 'javascript'\n  const [wasmSupported, setWasmSupported] = useState(false);\n  const [wasmInitialized, setWasmInitialized] = useState(false);\n\n  const owner = repository.owner?.login || repository.full_name.split('/')[0];\n  const repoName = repository.name;\n\n  const addLog = useCallback((message, type = 'info') => {\n    setLogs(prev => [...prev, {\n      id: Date.now() + Math.random(),\n      message,\n      type,\n      timestamp: new Date().toISOString()\n    }]);\n  }, []);\n\n  // Check WebAssembly support on component mount\n  useEffect(() => {\n    const checkWasmSupport = async () => {\n      const supported = WasmLoader.isSupported();\n      setWasmSupported(supported);\n      \n      if (supported) {\n        addLog('ğŸš€ WebAssembly support detected', 'success');\n        \n        // Initialize WASM service\n        try {\n          await sushiWasmService.initialize();\n          setWasmInitialized(true);\n          addLog('âœ… SUSHI WebAssembly service initialized', 'success');\n        } catch (err) {\n          addLog(`âš ï¸ WASM initialization failed, falling back to JavaScript: ${err.message}`, 'warning');\n        }\n      } else {\n        addLog('âš ï¸ WebAssembly not supported, using JavaScript fallback', 'warning');\n      }\n    };\n\n    checkWasmSupport();\n  }, [addLog]);\n\n  const fetchRepositoryFiles = async () => {\n    try {\n      addLog('ğŸ” Fetching sushi-config.yaml...', 'info');\n      \n      let config = null;\n      try {\n        const configContent = await githubService.getFileContent(\n          owner, \n          repoName, \n          'sushi-config.yaml', \n          selectedBranch\n        );\n        config = configContent;\n        setSushiConfig(config);\n        addLog('âœ… Found sushi-config.yaml', 'success');\n      } catch (err) {\n        addLog('âš ï¸ sushi-config.yaml not found in repository', 'warning');\n      }\n\n      addLog('ğŸ” Scanning input/fsh directory recursively...', 'info');\n      \n      const fshFiles = [];\n      try {\n        // Recursively scan for FSH files\n        const scanDirectory = async (dirPath, depth = 0) => {\n          const maxDepth = 5; // Prevent infinite recursion\n          if (depth > maxDepth) {\n            addLog(`âš ï¸ Maximum directory depth reached for ${dirPath}`, 'warning');\n            return;\n          }\n\n          try {\n            const contents = await githubService.getDirectoryContents(\n              owner,\n              repoName,\n              dirPath,\n              selectedBranch\n            );\n            \n            for (const item of contents) {\n              if (item.type === 'file' && item.name.endsWith('.fsh')) {\n                try {\n                  const fileContent = await githubService.getFileContent(\n                    owner,\n                    repoName,\n                    item.path,\n                    selectedBranch\n                  );\n                  fshFiles.push({\n                    name: item.name,\n                    path: item.path,\n                    content: fileContent\n                  });\n                  addLog(`ğŸ“„ Found ${item.path}`, 'success');\n                } catch (err) {\n                  addLog(`âŒ Failed to fetch ${item.path}: ${err.message}`, 'error');\n                }\n              } else if (item.type === 'dir') {\n                // Recursively scan subdirectories\n                addLog(`ğŸ“ Scanning subdirectory: ${item.path}`, 'info');\n                await scanDirectory(item.path, depth + 1);\n              }\n            }\n          } catch (err) {\n            addLog(`âš ï¸ Could not scan directory ${dirPath}: ${err.message}`, 'warning');\n          }\n        };\n\n        await scanDirectory('input/fsh');\n      } catch (err) {\n        addLog('âš ï¸ input/fsh directory not found or empty', 'warning');\n      }\n\n      setFshFiles(fshFiles);\n      addLog(`ğŸ“Š Found ${fshFiles.length} FSH files in repository`, 'info');\n      \n      return { config, fshFiles };\n    } catch (err) {\n      addLog(`âŒ Error fetching repository files: ${err.message}`, 'error');\n      throw err;\n    }\n  };\n\n  const integrateStagingFiles = (repoFshFiles) => {\n    // Start with repository files\n    const integratedFiles = [...repoFshFiles];\n    \n    // Override/add staging files\n    stagingFiles.forEach(stagingFile => {\n      if (stagingFile.path && stagingFile.path.endsWith('.fsh')) {\n        const fileName = stagingFile.path.split('/').pop();\n        const existingIndex = integratedFiles.findIndex(f => f.name === fileName);\n        \n        if (existingIndex >= 0) {\n          // Override existing file\n          integratedFiles[existingIndex] = {\n            ...integratedFiles[existingIndex],\n            content: stagingFile.content,\n            isFromStaging: true\n          };\n          addLog(`ğŸ”„ Overriding ${fileName} with staging version`, 'info');\n        } else {\n          // Add new file from staging\n          integratedFiles.push({\n            name: fileName,\n            path: stagingFile.path,\n            content: stagingFile.content,\n            isFromStaging: true\n          });\n          addLog(`â• Adding ${fileName} from staging`, 'info');\n        }\n      }\n    });\n\n    return integratedFiles;\n  };\n\n  const runSushiInBrowser = async (config, files) => {\n    try {\n      // Determine execution mode\n      const useWasm = executionMode === 'wasm' || \n                     (executionMode === 'auto' && wasmSupported && wasmInitialized);\n      \n      const mode = useWasm ? 'WebAssembly' : 'JavaScript';\n      addLog(`ğŸš€ Starting FHIR Shorthand compilation using ${mode}...`, 'info');\n      \n      // Start performance monitoring\n      performanceMonitor.startTiming('sushi-compilation', useWasm ? 'wasm' : 'js');\n      \n      let result;\n      \n      if (useWasm) {\n        addLog('ğŸ”§ Using WebAssembly SUSHI engine...', 'info');\n        result = await runSushiWithWasm(config, files);\n      } else {\n        addLog('âš™ï¸ Using JavaScript fallback engine...', 'info');\n        result = await runSushiWithJavaScript(config, files);\n      }\n      \n      // End performance monitoring\n      const duration = performanceMonitor.endTiming('sushi-compilation', useWasm ? 'wasm' : 'js');\n      addLog(`â±ï¸ Compilation completed in ${duration.toFixed(2)}ms using ${mode}`, 'success');\n      \n      return result;\n      \n    } catch (err) {\n      addLog(`âŒ Compilation failed: ${err.message}`, 'error');\n      \n      // If WASM failed, try JavaScript fallback\n      if (executionMode === 'auto' && wasmSupported) {\n        addLog('ğŸ”„ Attempting JavaScript fallback...', 'info');\n        try {\n          return await runSushiWithJavaScript(config, files);\n        } catch (fallbackErr) {\n          addLog(`âŒ JavaScript fallback also failed: ${fallbackErr.message}`, 'error');\n          throw fallbackErr;\n        }\n      }\n      \n      throw err;\n    }\n  };\n\n  const runSushiWithWasm = async (config, files) => {\n    try {\n      addLog('ğŸ“¦ Preparing WebAssembly execution environment...', 'info');\n      \n      // Use the WASM service\n      const result = await sushiWasmService.runSushi(config, files);\n      \n      if (result.success) {\n        addLog(`âœ… WebAssembly compilation successful`, 'success');\n        addLog(`ğŸ“Š Generated ${result.files.length} FHIR resources`, 'success');\n        \n        // Convert WASM output to the expected format\n        const generatedResources = result.files.map(file => ({\n          type: file.resourceType,\n          filename: file.path,\n          content: file.content,\n          id: file.path.split('.')[0],\n          resourceType: file.resourceType\n        }));\n        \n        setGeneratedFiles(generatedResources);\n        \n        // Log any warnings\n        result.warnings.forEach(warning => {\n          addLog(`âš ï¸ ${warning}`, 'warning');\n        });\n        \n        return {\n          success: true,\n          resourceCount: result.files.length,\n          warnings: result.warnings,\n          errors: result.errors,\n          generatedFiles: generatedResources\n        };\n      } else {\n        // Log errors from WASM compilation\n        result.errors.forEach(error => {\n          addLog(`âŒ ${error}`, 'error');\n        });\n        \n        throw new Error(`WASM compilation failed: ${result.errors.join(', ')}`);\n      }\n      \n    } catch (err) {\n      addLog(`ğŸ’¥ WebAssembly execution failed: ${err.message}`, 'error');\n      throw err;\n    }\n  };\n\n  const runSushiWithJavaScript = async (config, files) => {\n    try {\n      addLog('ğŸš€ Starting FHIR Shorthand compilation...', 'info');\n      \n      addLog('â„¹ï¸ Using JavaScript FSH processor with enhanced crash prevention', 'info');\n      \n      // Enhanced memory monitoring with much stricter limits\n      const checkMemoryUsage = () => {\n        if (performance.memory && performance.memory.usedJSHeapSize) {\n          const memoryMB = (performance.memory.usedJSHeapSize / 1024 / 1024);\n          const memoryLimitMB = 30; // Much stricter: 30MB hard limit\n          const memoryWarningMB = 20; // Warning at 20MB\n          \n          if (memoryMB > memoryLimitMB) {\n            throw new Error(`Memory limit exceeded: ${memoryMB.toFixed(1)}MB > ${memoryLimitMB}MB. Processing stopped to prevent browser crash.`);\n          }\n          \n          if (memoryMB > memoryWarningMB) {\n            addLog(`âš ï¸ High memory usage: ${memoryMB.toFixed(1)}MB (approaching ${memoryLimitMB}MB limit)`, 'warning');\n          }\n          \n          return memoryMB;\n        }\n        return 0;\n      };\n      \n      const initialMemory = checkMemoryUsage();\n      addLog(`ğŸ’¾ Initial memory usage: ${initialMemory.toFixed(1)} MB`, 'info');\n      \n      // Implement much stricter file size limits to prevent crashes\n      const maxFileSize = 1 * 1024 * 1024; // Reduced to 1MB per file\n      const maxTotalSize = 5 * 1024 * 1024; // Reduced to 5MB total\n      const maxFiles = 5; // Reduced to maximum 5 files to prevent crashes\n      \n      let totalSize = 0;\n      const validFiles = [];\n      \n      for (const file of files.slice(0, maxFiles)) {\n        const fileSize = file.content ? file.content.length : 0;\n        \n        if (fileSize > maxFileSize) {\n          addLog(`âŒ Skipping ${file.name}: too large (${(fileSize / 1024 / 1024).toFixed(1)}MB > 1MB limit)`, 'error');\n          continue;\n        }\n        \n        if (totalSize + fileSize > maxTotalSize) {\n          addLog(`âš ï¸ Stopping file processing: total size limit reached (${(totalSize / 1024 / 1024).toFixed(1)}MB)`, 'warning');\n          break;\n        }\n        \n        totalSize += fileSize;\n        validFiles.push(file);\n      }\n      \n      if (files.length > maxFiles) {\n        addLog(`âš ï¸ Limited to first ${maxFiles} files (${files.length} total) to prevent browser crashes`, 'warning');\n      }\n      \n      addLog(`ğŸ“Š Processing ${validFiles.length} files (${(totalSize / 1024 / 1024).toFixed(1)}MB total)`, 'info');\n      \n      addLog('ğŸ“¦ Loading YAML processing library...', 'info');\n      const yaml = await import('js-yaml');\n      addLog('âœ… Libraries loaded successfully', 'success');\n      \n      addLog('ğŸ“ Processing configuration...', 'info');\n      \n      // Prepare configuration\n      let configObj = null;\n      if (config) {\n        try {\n          configObj = typeof config === 'string' ? yaml.default.load(config) : config;\n          addLog(`ğŸ“‹ Package: ${configObj.name || 'Unknown'}`, 'success');\n          addLog(`ğŸ“‹ Version: ${configObj.version || 'Unknown'}`, 'success');\n          addLog(`ğŸ“‹ FHIR Version: ${configObj.fhirVersion || 'Unknown'}`, 'success');\n        } catch (err) {\n          addLog(`âš ï¸ Could not parse config: ${err.message}`, 'warning');\n        }\n      } else {\n        // Create a default configuration\n        configObj = {\n          name: 'browser-generated-ig',\n          version: '1.0.0',\n          fhirVersion: '4.0.1',\n          id: 'browser.generated.ig',\n          canonical: 'http://example.org/fhir/ig/browser-generated',\n          status: 'draft'\n        };\n        addLog('ğŸ“‹ Using default configuration', 'info');\n      }\n\n      addLog(`ğŸ” Analyzing ${validFiles.length} FSH files with crash prevention...`, 'info');\n      \n      const generatedResources = [];\n      let processedCount = 0;\n      const maxResourcesPerFile = 3; // Reduced from 5 to 3 resources per file\n      const maxTotalResources = 15; // Reduced from 50 to 15 total resources\n      \n      // Process files one at a time to prevent memory buildup\n      const chunkSize = 1; // Process 1 file at a time for maximum safety\n      \n      for (let i = 0; i < validFiles.length; i += chunkSize) {\n        const chunk = validFiles.slice(i, i + chunkSize);\n        \n        for (const file of chunk) {\n          addLog(`ğŸ“„ Processing ${file.name} (${processedCount + 1}/${validFiles.length})...`, 'info');\n          \n          // Enhanced memory check before processing each file\n          const currentMemory = checkMemoryUsage();\n          \n          // Stop if we're approaching memory limits (much stricter threshold)\n          if (currentMemory > 15) { // Reduced from 80MB to 15MB threshold\n            addLog(`âš ï¸ Stopping processing due to high memory usage (${currentMemory.toFixed(1)}MB)`, 'warning');\n            break;\n          }\n          \n          // Stop if we've reached resource limits\n          if (generatedResources.length >= maxTotalResources) {\n            addLog(`âš ï¸ Reached maximum resource limit (${maxTotalResources}), stopping processing`, 'warning');\n            break;\n          }\n          \n          const content = file.content;\n          \n          // Enhanced FSH parsing with stricter limits\n          const extractFSHDefinitions = (content) => {\n            try {\n              const definitions = {\n                profiles: [],\n                instances: [],\n                valueSets: [],\n                codeSystems: [],\n                extensions: []\n              };\n              \n              // Check for empty or invalid content\n              if (!content || typeof content !== 'string') {\n                return definitions;\n              }\n              \n              // Much stricter line processing limit to prevent memory issues\n              const lines = content.split('\\n');\n              const maxLinesToProcess = 500; // Reduced from 1k to 500 lines per file\n              \n              if (lines.length > maxLinesToProcess) {\n                addLog(`  âš ï¸ File is large (${lines.length} lines). Processing first ${maxLinesToProcess} lines only.`, 'warning');\n              }\n              \n              const linesToProcess = lines.slice(0, Math.min(lines.length, maxLinesToProcess));\n              \n              let currentDefinition = null;\n              let currentType = null;\n              let definitionCount = 0;\n              const maxDefinitionsPerFile = 5; // Reduced from 10 to 5 definitions per file\n              \n              for (let i = 0; i < linesToProcess.length && definitionCount < maxDefinitionsPerFile; i++) {\n                const line = linesToProcess[i].trim();\n                \n                // Skip empty lines and comments to improve performance\n                if (!line || line.startsWith('//') || line.startsWith('/*')) {\n                  continue;\n                }\n                \n                // Detect definition types\n                if (line.startsWith('Profile:')) {\n                  if (definitionCount >= maxDefinitionsPerFile) break;\n                  currentType = 'profiles';\n                  currentDefinition = {\n                    name: line.substring(8).trim(),\n                    type: 'Profile',\n                    parent: null,\n                    id: null,\n                    title: null,\n                    description: null,\n                    rules: []\n                  };\n                  definitionCount++;\n                } else if (line.startsWith('Instance:')) {\n                  if (definitionCount >= maxDefinitionsPerFile) break;\n                  currentType = 'instances';\n                  currentDefinition = {\n                    name: line.substring(9).trim(),\n                    type: 'Instance',\n                    instanceOf: null,\n                    usage: null,\n                    title: null,\n                    description: null,\n                    rules: []\n                  };\n                  definitionCount++;\n                } else if (line.startsWith('ValueSet:')) {\n                  if (definitionCount >= maxDefinitionsPerFile) break;\n                  currentType = 'valueSets';\n                  currentDefinition = {\n                    name: line.substring(9).trim(),\n                    type: 'ValueSet',\n                    id: null,\n                    title: null,\n                    description: null,\n                    rules: []\n                  };\n                  definitionCount++;\n                } else if (line.startsWith('CodeSystem:')) {\n                  if (definitionCount >= maxDefinitionsPerFile) break;\n                  currentType = 'codeSystems';\n                  currentDefinition = {\n                    name: line.substring(11).trim(),\n                    type: 'CodeSystem',\n                    id: null,\n                    title: null,\n                    description: null,\n                    rules: []\n                  };\n                  definitionCount++;\n                } else if (line.startsWith('Extension:')) {\n                  if (definitionCount >= maxDefinitionsPerFile) break;\n                  currentType = 'extensions';\n                  currentDefinition = {\n                    name: line.substring(10).trim(),\n                    type: 'Extension',\n                    id: null,\n                    title: null,\n                    description: null,\n                    rules: []\n                  };\n                  definitionCount++;\n                }\n                \n                // Parse properties\n                if (currentDefinition) {\n                  if (line.startsWith('Parent:')) {\n                    currentDefinition.parent = line.substring(7).trim();\n                  } else if (line.startsWith('InstanceOf:')) {\n                    currentDefinition.instanceOf = line.substring(11).trim();\n                  } else if (line.startsWith('Usage:')) {\n                    currentDefinition.usage = line.substring(6).trim();\n                  } else if (line.startsWith('Id:')) {\n                    currentDefinition.id = line.substring(3).trim();\n                  } else if (line.startsWith('Title:')) {\n                    currentDefinition.title = line.substring(6).trim().replace(/['\"]/g, '');\n                  } else if (line.startsWith('Description:')) {\n                    currentDefinition.description = line.substring(12).trim().replace(/['\"]/g, '');\n                  } else if (line.startsWith('* ')) {\n                    // Much stricter rule limit to prevent memory issues\n                    if (currentDefinition.rules.length < 5) {\n                      currentDefinition.rules.push(line.substring(2).trim());\n                    }\n                  }\n                  \n                  // If we hit a new definition or end of content, save current one\n                  if ((line.includes(':') && !line.startsWith('* ') && \n                       !line.startsWith('Parent:') && !line.startsWith('InstanceOf:') &&\n                       !line.startsWith('Usage:') && !line.startsWith('Id:') &&\n                       !line.startsWith('Title:') && !line.startsWith('Description:')) ||\n                      i === linesToProcess.length - 1) {\n                    \n                    if (currentDefinition && currentType && currentDefinition.name) {\n                      definitions[currentType].push(currentDefinition);\n                    }\n                    currentDefinition = null;\n                    currentType = null;\n                    i--; // Re-process this line for the new definition\n                  }\n                }\n              }\n              \n              if (definitionCount >= maxDefinitionsPerFile) {\n                addLog(`  âš ï¸ Limited to ${maxDefinitionsPerFile} definitions per file to prevent browser crashes`, 'warning');\n              }\n              \n              return definitions;\n            } catch (err) {\n              addLog(`  âŒ Error parsing FSH content: ${err.message}`, 'error');\n              return {\n                profiles: [],\n                instances: [],\n                valueSets: [],\n                codeSystems: [],\n                extensions: []\n              };\n            }\n          };\n          \n          const definitions = extractFSHDefinitions(content);\n          \n          // Generate FHIR resources with strict memory management\n          let resourcesFromThisFile = 0;\n          const remainingResourceSlots = maxTotalResources - generatedResources.length;\n          const maxFromThisFile = Math.min(maxResourcesPerFile, remainingResourceSlots);\n          \n          // Process profiles with strict limits\n          for (const profile of definitions.profiles.slice(0, Math.min(1, maxFromThisFile - resourcesFromThisFile))) {\n            if (resourcesFromThisFile >= maxFromThisFile) break;\n            \n            try {\n              const profileId = profile.id || profile.name.toLowerCase().replace(/\\s+/g, '-');\n              const structureDefinition = {\n                resourceType: 'StructureDefinition',\n                id: profileId,\n                url: `${configObj.canonical}/StructureDefinition/${profileId}`,\n                name: profile.name,\n                title: profile.title || profile.name,\n                status: 'draft',\n                fhirVersion: configObj.fhirVersion || '4.0.1',\n                kind: 'resource',\n                abstract: false,\n                type: profile.parent === 'Patient' ? 'Patient' : \n                       profile.parent === 'Observation' ? 'Observation' :\n                       profile.parent || 'DomainResource',\n                baseDefinition: `http://hl7.org/fhir/StructureDefinition/${profile.parent || 'DomainResource'}`,\n                derivation: 'constraint',\n                description: profile.description || `Profile for ${profile.name}`\n              };\n              \n              // Limit differential elements to prevent memory issues\n              if (profile.rules.length > 0) {\n                structureDefinition.differential = {\n                  element: profile.rules.slice(0, 2).map((rule, index) => ({ // Reduced to 2 elements max\n                    id: `${structureDefinition.type}.${rule.split(' ')[0]}`,\n                    path: `${structureDefinition.type}.${rule.split(' ')[0]}`,\n                    short: `Rule: ${rule}`\n                  }))\n                };\n              }\n              \n              generatedResources.push({\n                type: 'StructureDefinition',\n                filename: `StructureDefinition-${profileId}.json`,\n                content: JSON.stringify(structureDefinition, null, 2),\n                id: profileId,\n                name: profile.name,\n                title: structureDefinition.title,\n                url: structureDefinition.url\n              });\n              \n              resourcesFromThisFile++;\n              addLog(`  ğŸ“Š Generated StructureDefinition: ${profile.name}`, 'success');\n            } catch (err) {\n              addLog(`  âŒ Error generating StructureDefinition for ${profile.name}: ${err.message}`, 'error');\n            }\n          }\n          \n          // Process instances with strict limits\n          for (const instance of definitions.instances.slice(0, Math.min(1, maxFromThisFile - resourcesFromThisFile))) {\n            if (resourcesFromThisFile >= maxFromThisFile) break;\n            \n            try {\n              const instanceId = instance.name.toLowerCase().replace(/\\s+/g, '-');\n              const resourceType = instance.instanceOf === 'Patient' ? 'Patient' :\n                                 instance.instanceOf === 'Observation' ? 'Observation' :\n                                 'Patient'; // Default fallback\n                                 \n              const fhirInstance = {\n                resourceType: resourceType,\n                id: instanceId,\n                meta: {\n                  profile: instance.instanceOf ? [`${configObj.canonical}/StructureDefinition/${instance.instanceOf}`] : undefined\n                }\n              };\n              \n              // Add minimal properties to reduce memory usage\n              if (resourceType === 'Patient') {\n                fhirInstance.name = [{\n                  family: instance.name.split(' ').pop(),\n                  given: instance.name.split(' ').slice(0, -1)\n                }];\n              }\n              \n              generatedResources.push({\n                type: resourceType,\n                filename: `${instanceId}.json`,\n                content: JSON.stringify(fhirInstance, null, 2),\n                id: instanceId,\n                resourceType: resourceType\n              });\n              \n              resourcesFromThisFile++;\n              addLog(`  ğŸ“Š Generated ${resourceType} instance: ${instance.name}`, 'success');\n            } catch (err) {\n              addLog(`  âŒ Error generating instance for ${instance.name}: ${err.message}`, 'error');\n            }\n          }\n          \n          // Process ValueSets and CodeSystems with even stricter limits\n          for (const vs of definitions.valueSets.slice(0, Math.min(1, maxFromThisFile - resourcesFromThisFile))) {\n            if (resourcesFromThisFile >= maxFromThisFile) break;\n            \n            try {\n              const vsId = vs.id || vs.name.toLowerCase().replace(/\\s+/g, '-');\n              const valueSet = {\n                resourceType: 'ValueSet',\n                id: vsId,\n                url: `${configObj.canonical}/ValueSet/${vsId}`,\n                name: vs.name,\n                title: vs.title || vs.name,\n                status: 'draft',\n                description: vs.description || `ValueSet for ${vs.name}`,\n                compose: {\n                  include: [{\n                    system: 'http://example.org/codes',\n                    concept: [\n                      { code: 'example1', display: 'Example Code 1' }\n                    ]\n                  }]\n                }\n              };\n              \n              generatedResources.push({\n                type: 'ValueSet',\n                filename: `ValueSet-${vsId}.json`,\n                content: JSON.stringify(valueSet, null, 2),\n                id: vsId,\n                name: vs.name,\n                title: valueSet.title,\n                url: valueSet.url\n              });\n              \n              resourcesFromThisFile++;\n              addLog(`  ğŸ“Š Generated ValueSet: ${vs.name}`, 'success');\n            } catch (err) {\n              addLog(`  âŒ Error generating ValueSet for ${vs.name}: ${err.message}`, 'error');\n            }\n          }\n          \n          if (file.isFromStaging) {\n            addLog(`  ğŸ—ï¸ File from staging ground`, 'info');\n          }\n          \n          processedCount++;\n          \n          // Clear file content from memory immediately after processing\n          file.content = null;\n          \n          // Force garbage collection more frequently\n          if (window.gc && typeof window.gc === 'function') {\n            window.gc();\n          }\n        }\n        \n        // Yield control for longer periods between chunks to prevent blocking\n        await new Promise(resolve => setTimeout(resolve, 200)); // Increased to 200ms delay between files\n        \n        // Enhanced memory monitoring after each file\n        const memoryAfterChunk = checkMemoryUsage();\n        addLog(`ğŸ’¾ Memory after file: ${memoryAfterChunk.toFixed(1)} MB (processed ${Math.min(i + chunkSize, validFiles.length)}/${validFiles.length})`, 'info');\n        \n        // Break if memory is getting too high (much lower threshold)\n        if (memoryAfterChunk > 20) {\n          addLog(`âš ï¸ Stopping processing due to high memory usage`, 'warning');\n          break;\n        }\n      }\n\n      // Set generated files\n      setGeneratedFiles(generatedResources);\n      \n      // Final memory check\n      const finalMemory = checkMemoryUsage();\n      addLog(`ğŸ’¾ Final memory usage: ${finalMemory.toFixed(1)} MB`, 'info');\n      \n      addLog('âœ¨ FSH compilation completed with crash prevention!', 'success');\n      addLog(`ğŸ“¦ Generated ${generatedResources.length} FHIR resources total (limited for stability)`, 'success');\n      \n      // Check for staging files\n      const stagingCount = validFiles.filter(f => f.isFromStaging).length;\n      if (stagingCount > 0) {\n        addLog(`ğŸ—ï¸ ${stagingCount} file(s) from staging ground included`, 'info');\n      }\n      \n      // Handle edge cases\n      if (validFiles.length === 0) {\n        addLog('âš ï¸ No FSH files found or all files too large to process safely', 'warning');\n      }\n      \n      if (!config) {\n        addLog('âš ï¸ No sushi-config.yaml found - used default configuration', 'warning');\n      }\n      \n      // Safety warnings\n      if (generatedResources.length >= maxTotalResources) {\n        addLog(`âš ï¸ Output limited to ${maxTotalResources} resources to prevent browser crashes`, 'warning');\n      }\n      \n      if (validFiles.length < files.length) {\n        addLog(`âš ï¸ ${files.length - validFiles.length} files skipped due to size limits`, 'warning');\n      }\n\n      return {\n        success: true,\n        resourceCount: generatedResources.length,\n        warnings: [],\n        errors: [],\n        generatedFiles: generatedResources\n      };\n      \n    } catch (err) {\n      addLog(`âŒ Compilation failed: ${err.message}`, 'error');\n      \n      // Log additional error details if available\n      if (err.stack) {\n        console.error('Compilation error stack:', err.stack);\n      }\n      \n      throw err;\n    }\n  };\n\n  const handleRunSushi = async (withStagingFiles = false) => {\n    setIsRunning(true);\n    setShowModal(true);\n    setLogs([]);\n    setGeneratedFiles([]);\n    setActiveTab('logs');\n    setError(null);\n    setIncludeStagingFiles(withStagingFiles);\n\n    try {\n      addLog('ğŸ Starting SUSHI client-side execution...', 'info');\n      \n      if (withStagingFiles && stagingFiles.length > 0) {\n        addLog(`ğŸ—‚ï¸ Including ${stagingFiles.length} staging files`, 'info');\n      }\n\n      // Fetch repository files\n      const { config, fshFiles: repoFiles } = await fetchRepositoryFiles();\n      \n      // Integrate staging files if requested\n      const finalFiles = withStagingFiles ? \n        integrateStagingFiles(repoFiles) : \n        repoFiles;\n\n      if (withStagingFiles) {\n        addLog(`ğŸ“Š Final file count: ${finalFiles.length} FSH files`, 'info');\n      }\n\n      // Run SUSHI\n      await runSushiInBrowser(config, finalFiles);\n      \n      addLog('ğŸ‰ SUSHI execution completed successfully!', 'success');\n      \n    } catch (err) {\n      setError(err.message);\n      addLog(`ğŸ’¥ Execution failed: ${err.message}`, 'error');\n    } finally {\n      setIsRunning(false);\n    }\n  };\n\n  const toggleLogLevel = useCallback((level) => {\n    setLogLevelToggles(prev => ({\n      ...prev,\n      [level]: !prev[level]\n    }));\n  }, []);\n\n  const clearLogs = useCallback(() => {\n    setLogs([]);\n    setGeneratedFiles([]);\n    setActiveTab('logs');\n    setLogLevelToggles({\n      info: true,\n      success: true,\n      warning: true,\n      error: true\n    });\n    setSearchText('');\n  }, []);\n\n  const copyAllLogs = useCallback(async () => {\n    const logText = logs.map(log => \n      `[${new Date(log.timestamp).toLocaleTimeString()}] ${log.message}`\n    ).join('\\n');\n    \n    try {\n      await navigator.clipboard.writeText(logText);\n    } catch (err) {\n      console.error('Failed to copy logs:', err);\n    }\n  }, [logs]);\n\n  const copyLogMessage = useCallback(async (message) => {\n    try {\n      await navigator.clipboard.writeText(message);\n    } catch (err) {\n      console.error('Failed to copy log message:', err);\n    }\n  }, []);\n\n  // Function to detect and create links for files mentioned in log messages\n  const parseLogMessage = useCallback((message, logId) => {\n    // More precise regex to find valid file paths - must be preceded by whitespace or start of line\n    // and must be a complete path (not part of a longer word)\n    const filePathRegex = /(?:^|\\s)((?:input\\/fsh\\/[a-zA-Z0-9_/-]*\\/)?[a-zA-Z0-9_.-]+\\.(?:fsh|yaml|yml|json))(?=\\s|$|[.,!])/g;\n    const matches = [...message.matchAll(filePathRegex)];\n    \n    if (matches.length === 0) {\n      return <span>{message}</span>;\n    }\n    \n    let lastIndex = 0;\n    const elements = [];\n    let elementCounter = 0; // Add counter for unique keys\n    \n    matches.forEach((match, index) => {\n      const fullMatch = match[0];\n      const filePath = match[1];\n      const matchIndex = match.index;\n      \n      // Add text before the match\n      if (matchIndex > lastIndex) {\n        elements.push(\n          <span key={`${logId}-text-${elementCounter++}`}>\n            {message.substring(lastIndex, matchIndex)}\n          </span>\n        );\n      }\n      \n      // Add the leading whitespace if present\n      const leadingWhitespace = fullMatch.substring(0, fullMatch.indexOf(filePath));\n      if (leadingWhitespace) {\n        elements.push(\n          <span key={`${logId}-ws-${elementCounter++}`}>\n            {leadingWhitespace}\n          </span>\n        );\n      }\n      \n      // Determine link type based on file location and validate the file exists\n      const createFileLink = (path, text, keyIndex) => {\n        // Check if file exists in our known file lists to avoid creating invalid links\n        const isKnownRepoFile = fshFiles.some(f => f.path === path);\n        const isFromStaging = stagingFiles.some(f => f.path && (f.path === path || f.path.endsWith(`/${path.split('/').pop()}`)));\n        const isSushiConfig = path === 'sushi-config.yaml';\n        \n        // Only create links for files we know exist\n        if (!isKnownRepoFile && !isFromStaging && !isSushiConfig) {\n          // File not found in our known files, return as plain text\n          return (\n            <span key={`${logId}-text-${keyIndex}`} className=\"file-mention\">\n              {text}\n            </span>\n          );\n        }\n        \n        if (isFromStaging) {\n          // Link to staging ground\n          return (\n            <span key={`${logId}-staging-${keyIndex}`} className=\"file-link staging-link\" title=\"File from Staging Ground\">\n              ğŸ“ {text}\n            </span>\n          );\n        } else if (path.startsWith('input/fsh/')) {\n          // Determine DAK component based on directory structure\n          const getDakComponentLink = (fshPath) => {\n            const pathParts = fshPath.split('/');\n            if (pathParts.length > 2) {\n              const subDir = pathParts[2];\n              switch (subDir) {\n                case 'profiles':\n                  return { component: 'Profiles', icon: 'ğŸ‘¤' };\n                case 'examples':\n                  return { component: 'Examples', icon: 'ğŸ“‹' };\n                case 'valuesets':\n                  return { component: 'ValueSets', icon: 'ğŸ“Š' };\n                case 'codesystems':\n                  return { component: 'CodeSystems', icon: 'ğŸ”¢' };\n                case 'extensions':\n                  return { component: 'Extensions', icon: 'ğŸ”§' };\n                default:\n                  return { component: 'FSH Files', icon: 'ğŸ“„' };\n              }\n            }\n            return { component: 'FSH Files', icon: 'ğŸ“„' };\n          };\n          \n          const dakInfo = getDakComponentLink(path);\n          return (\n            <span key={`${logId}-dak-${keyIndex}`} className=\"file-link dak-link\" title={`View in DAK ${dakInfo.component}`}>\n              {dakInfo.icon} {text}\n            </span>\n          );\n        } else {\n          // Link to GitHub source for valid repository files\n          const githubUrl = `https://github.com/${owner}/${repoName}/blob/${selectedBranch}/${path}`;\n          return (\n            <a \n              key={`${logId}-github-${keyIndex}`}\n              href={githubUrl} \n              target=\"_blank\" \n              rel=\"noopener noreferrer\" \n              className=\"file-link github-link\"\n              title=\"Open in GitHub\"\n            >\n              ğŸ”— {text}\n            </a>\n          );\n        }\n      };\n      \n      elements.push(createFileLink(filePath, filePath, elementCounter++));\n      lastIndex = matchIndex + fullMatch.length;\n    });\n    \n    // Add remaining text\n    if (lastIndex < message.length) {\n      elements.push(\n        <span key={`${logId}-text-end-${elementCounter++}`}>\n          {message.substring(lastIndex)}\n        </span>\n      );\n    }\n    \n    return <span>{elements}</span>;\n  }, [owner, repoName, selectedBranch, stagingFiles, fshFiles]);\n\n  // Optimized filtered logs with useMemo to prevent unnecessary re-computations\n  const filteredLogs = useMemo(() => {\n    return logs.filter(log => {\n      // Filter by log level toggles\n      const isLevelEnabled = logLevelToggles[log.type];\n      \n      // Filter by search text\n      const matchesSearch = searchText === '' || \n        log.message.toLowerCase().includes(searchText.toLowerCase());\n      \n      return isLevelEnabled && matchesSearch;\n    });\n  }, [logs, logLevelToggles, searchText]);\n\n  // Separate component for log controls to prevent re-renders\n  const LogControls = React.memo(({ \n    logLevelToggles, \n    onToggleLogLevel, \n    searchText, \n    onSearchChange, \n    filteredCount, \n    totalCount \n  }) => {\n    const handleSearchChange = useCallback((e) => {\n      onSearchChange(e.target.value);\n    }, [onSearchChange]);\n\n    return (\n      <div className=\"log-controls\">\n        <div className=\"log-level-toggles\">\n          <label className=\"toggle-group-label\">Show levels:</label>\n          <div className=\"toggle-buttons\">\n            {[\n              { key: 'info', label: 'Info', icon: 'â„¹ï¸' },\n              { key: 'success', label: 'Success', icon: 'âœ…' },\n              { key: 'warning', label: 'Warning', icon: 'âš ï¸' },\n              { key: 'error', label: 'Error', icon: 'âŒ' }\n            ].map(({ key, label, icon }) => (\n              <button\n                key={key}\n                className={`log-toggle-btn ${logLevelToggles[key] ? 'active' : 'inactive'}`}\n                onClick={() => onToggleLogLevel(key)}\n                title={`Toggle ${label} messages`}\n              >\n                {icon} {label}\n              </button>\n            ))}\n          </div>\n        </div>\n        \n        <div className=\"log-search-group\">\n          <label htmlFor=\"log-search\">Search logs:</label>\n          <input\n            id=\"log-search\"\n            type=\"text\"\n            value={searchText}\n            onChange={handleSearchChange}\n            placeholder=\"Search log messages...\"\n            className=\"log-search-input\"\n          />\n        </div>\n        \n        <div className=\"log-stats\">\n          {searchText || Object.values(logLevelToggles).some(v => !v) ? (\n            <span>Showing {filteredCount} of {totalCount} logs</span>\n          ) : (\n            <span>{totalCount} logs</span>\n          )}\n        </div>\n      </div>\n    );\n  });\n\n  const handleSearchChange = useCallback((value) => {\n    setSearchText(value);\n  }, []);\n\n  const viewFile = useCallback((file) => {\n    setSelectedFile(file);\n    setShowFileViewer(true);\n  }, []);\n\n  const closeFileViewer = useCallback(() => {\n    setShowFileViewer(false);\n    setSelectedFile(null);\n  }, []);\n\n  const getResourceTypeIcon = (type) => {\n    switch (type) {\n      case 'StructureDefinition': return 'ğŸ—ï¸';\n      case 'Patient': return 'ğŸ‘¤';\n      case 'ValueSet': return 'ğŸ“Š';\n      case 'CodeSystem': return 'ğŸ”¢';\n      case 'Organization': return 'ğŸ¢';\n      case 'Practitioner': return 'ğŸ‘¨â€âš•ï¸';\n      case 'Observation': return 'ğŸ“‹';\n      default: return 'ğŸ“„';\n    }\n  };\n\n  const FileViewerModal = () => {\n    if (!selectedFile) return null;\n\n    return (\n      <div className=\"file-viewer-overlay\">\n        <div className=\"file-viewer-modal\">\n          <div className=\"file-viewer-header\">\n            <h3>\n              {getResourceTypeIcon(selectedFile.type)} {selectedFile.filename}\n            </h3>\n            <div className=\"file-viewer-actions\">\n              <button\n                onClick={() => navigator.clipboard.writeText(selectedFile.content)}\n                className=\"copy-file-btn\"\n                title=\"Copy file content to clipboard\"\n              >\n                ğŸ“‹ Copy\n              </button>\n              <button\n                onClick={closeFileViewer}\n                className=\"close-file-viewer-btn\"\n              >\n                âœ•\n              </button>\n            </div>\n          </div>\n          <div className=\"file-viewer-content\">\n            <SyntaxHighlighter\n              language=\"json\"\n              style={oneLight}\n              showLineNumbers={true}\n              wrapLines={true}\n              customStyle={{\n                fontSize: '14px',\n                lineHeight: '1.4',\n                maxHeight: '70vh',\n                overflow: 'auto'\n              }}\n            >\n              {selectedFile.content}\n            </SyntaxHighlighter>\n          </div>\n          <div className=\"file-viewer-footer\">\n            <span className=\"file-info\">\n              Resource Type: {selectedFile.type} | \n              Size: {(selectedFile.content.length / 1024).toFixed(1)} KB\n            </span>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  const LogModal = () => (\n    <div className=\"sushi-modal-overlay\">\n      <div className=\"sushi-modal\">\n        <div className=\"sushi-modal-header\">\n          <h3>\n            ğŸ£ SUSHI Client-Side Execution \n            {includeStagingFiles && <span className=\"staging-badge\">+ Staging</span>}\n          </h3>\n          <div className=\"modal-actions\">\n            <button \n              onClick={copyAllLogs}\n              className=\"copy-all-btn\"\n              disabled={logs.length === 0}\n              title=\"Copy all logs to clipboard\"\n            >\n              ğŸ“‹ Copy All\n            </button>\n            <button \n              onClick={clearLogs}\n              className=\"clear-logs-btn\"\n              disabled={isRunning}\n            >\n              ğŸ—‘ï¸ Clear\n            </button>\n            <button \n              onClick={() => setShowModal(false)}\n              className=\"close-modal-btn\"\n            >\n              âœ•\n            </button>\n          </div>\n        </div>\n        \n        <LogControls\n          logLevelToggles={logLevelToggles}\n          onToggleLogLevel={toggleLogLevel}\n          searchText={searchText}\n          onSearchChange={handleSearchChange}\n          filteredCount={filteredLogs.length}\n          totalCount={logs.length}\n        />\n        \n        {generatedFiles.length > 0 && (\n          <div className=\"modal-section-toggle\">\n            <div className=\"toggle-options\">\n              <button \n                className={`toggle-btn ${activeTab === 'logs' ? 'active' : ''}`}\n                onClick={() => setActiveTab('logs')}\n              >\n                ğŸ“„ Logs & Messages\n              </button>\n              <button \n                className={`toggle-btn ${activeTab === 'files' ? 'active' : ''}`}\n                onClick={() => setActiveTab('files')}\n              >\n                ğŸ“¦ Generated Resources\n              </button>\n            </div>\n            <div className=\"section-info\">\n              {activeTab === 'logs' ? (\n                <span className=\"info-text\">{logs.length} log entries â€¢ Use toggles to filter by level</span>\n              ) : (\n                <span className=\"info-text\">{generatedFiles.length} FHIR resources generated</span>\n              )}\n            </div>\n          </div>\n        )}\n        \n        <div className=\"sushi-modal-content\">\n          {(activeTab === 'logs' || generatedFiles.length === 0) && (\n            <div className=\"log-container\">\n              {filteredLogs.map(log => (\n                <div key={log.id} className={`log-entry log-${log.type}`}>\n                  <span className=\"log-timestamp\">\n                    {new Date(log.timestamp).toLocaleTimeString()}\n                  </span>\n                  <span className=\"log-message\">\n                    {parseLogMessage(log.message, log.id)}\n                  </span>\n                  <button \n                    onClick={() => copyLogMessage(log.message)}\n                    className=\"copy-log-btn\"\n                    title=\"Copy this message to clipboard\"\n                  >\n                    ğŸ“‹\n                  </button>\n                </div>\n              ))}\n              \n              {isRunning && (\n                <div className=\"log-entry log-running\">\n                  <span className=\"log-timestamp\">\n                    {new Date().toLocaleTimeString()}\n                  </span>\n                  <span className=\"log-message\">\n                    <span className=\"spinner\">â³</span> Processing...\n                  </span>\n                  <div className=\"copy-log-btn-placeholder\"></div>\n                </div>\n              )}\n              \n              {filteredLogs.length === 0 && !isRunning && logs.length > 0 && (\n                <div className=\"log-placeholder\">\n                  No logs match the current filter criteria...\n                </div>\n              )}\n              \n              {logs.length === 0 && !isRunning && (\n                <div className=\"log-placeholder\">\n                  Logs will appear here during SUSHI execution...\n                </div>\n              )}\n              \n              {error && (\n                <div className=\"error-summary\">\n                  <h4>âŒ Execution Error</h4>\n                  <p>{error}</p>\n                </div>\n              )}\n            </div>\n          )}\n          \n          {activeTab === 'files' && generatedFiles.length > 0 && (\n            <div className=\"generated-files-container\">\n              <div className=\"generated-files-section\">\n                <h4>ğŸ“¦ Generated FHIR Resources ({generatedFiles.length})</h4>\n                <div className=\"generated-files-grid\">\n                  {generatedFiles.map((file, index) => (\n                    <div key={index} className=\"generated-file-card\">\n                      <div className=\"file-card-header\">\n                        <span className=\"file-icon\">{getResourceTypeIcon(file.type)}</span>\n                        <span className=\"file-name\">{file.filename}</span>\n                      </div>\n                      <div className=\"file-card-details\">\n                        <span className=\"file-type\">{file.type}</span>\n                        <span className=\"file-size\">\n                          {(file.content.length / 1024).toFixed(1)} KB\n                        </span>\n                      </div>\n                      <div className=\"file-card-actions\">\n                        <button\n                          onClick={() => viewFile(file)}\n                          className=\"view-file-btn\"\n                          title=\"View resource content\"\n                        >\n                          ğŸ‘ï¸ View\n                        </button>\n                        <button\n                          onClick={() => navigator.clipboard.writeText(file.content)}\n                          className=\"copy-file-btn\"\n                          title=\"Copy to clipboard\"\n                        >\n                          ğŸ“‹\n                        </button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                <div className=\"fhir-viewer-suggestions\">\n                  <h5>ğŸ’¡ Enhanced FHIR Viewing Options</h5>\n                  <p>For better FHIR resource visualization, consider these viewers:</p>\n                  <ul>\n                    <li><strong>FHIR Tree Viewer:</strong> <code>npm install @types/fhir</code> + custom tree renderer</li>\n                    <li><strong>FHIR Path Viewer:</strong> <code>npm install fhirpath</code> for interactive querying</li>\n                    <li><strong>FHIR UI:</strong> <code>npm install @asymmetrik/fhir-kit-client</code> with UI components</li>\n                    <li><strong>HL7 FHIR Viewer:</strong> Integration with official HL7 FHIR viewers</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n        \n        <div className=\"sushi-modal-footer\">\n          <div className=\"execution-info\">\n            {isRunning ? (\n              <span className=\"status-running\">ğŸ”„ Running SUSHI...</span>\n            ) : logs.length > 0 ? (\n              <span className=\"status-complete\">âœ… Execution complete</span>\n            ) : (\n              <span className=\"status-ready\">ğŸ£ Ready to run SUSHI</span>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n\n  return (\n    <SushiErrorBoundary>\n      <div className=\"sushi-runner-section\">\n        <div \n          className={`sushi-status-bar ${isExpanded ? 'expanded' : 'collapsed'}`}\n          onClick={() => setIsExpanded(!isExpanded)}\n        >\n          <div className=\"status-bar-header\">\n            <span className=\"status-icon\">ğŸ£</span>\n            <span className=\"status-title\">SUSHI (FHIR Shorthand)</span>\n            <span className=\"expand-icon\">{isExpanded ? 'â–¼' : 'â–¶'}</span>\n          </div>\n          \n          {!isExpanded && (\n            <div className=\"status-summary\">\n              Client-side FHIR Implementation Guide compilation\n            </div>\n          )}\n        </div>\n\n        {isExpanded && (\n          <div className=\"sushi-controls\">\n            <div className=\"sushi-description\">\n              <p>\n                Run SUSHI (FHIR Shorthand) compilation directly in your browser to generate \n                FHIR Implementation Guide resources from FSH files.\n              </p>\n            </div>\n\n            <div className=\"execution-options\">\n              <div className=\"execution-mode-selector\">\n                <h4>âš™ï¸ Execution Mode</h4>\n                <div className=\"mode-options\">\n                  <label className=\"mode-option\">\n                    <input \n                      type=\"radio\" \n                      name=\"executionMode\" \n                      value=\"auto\" \n                      checked={executionMode === 'auto'}\n                      onChange={(e) => setExecutionMode(e.target.value)}\n                    />\n                    <span className=\"mode-label\">\n                      ğŸ¤– Auto (WebAssembly when available)\n                      {wasmSupported && wasmInitialized && <span className=\"wasm-badge\">WASM Ready</span>}\n                    </span>\n                  </label>\n                  \n                  {wasmSupported && (\n                    <label className=\"mode-option\">\n                      <input \n                        type=\"radio\" \n                        name=\"executionMode\" \n                        value=\"wasm\" \n                        checked={executionMode === 'wasm'}\n                        onChange={(e) => setExecutionMode(e.target.value)}\n                        disabled={!wasmInitialized}\n                      />\n                      <span className=\"mode-label\">\n                        ğŸš€ WebAssembly (High Performance)\n                        {!wasmInitialized && <span className=\"loading-badge\">Initializing...</span>}\n                      </span>\n                    </label>\n                  )}\n                  \n                  <label className=\"mode-option\">\n                    <input \n                      type=\"radio\" \n                      name=\"executionMode\" \n                      value=\"javascript\" \n                      checked={executionMode === 'javascript'}\n                      onChange={(e) => setExecutionMode(e.target.value)}\n                    />\n                    <span className=\"mode-label\">\n                      âš™ï¸ JavaScript (Fallback)\n                    </span>\n                  </label>\n                </div>\n                \n                {!wasmSupported && (\n                  <div className=\"wasm-not-supported\">\n                    <p>âš ï¸ WebAssembly is not supported in this browser. JavaScript fallback will be used.</p>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"option-group\">\n                <h4>ğŸ“‚ Repository Files Only</h4>\n                <p>\n                  Compile using sushi-config.yaml and input/fsh files from the GitHub repository ({selectedBranch} branch).\n                </p>\n                <button\n                  className=\"run-sushi-btn primary\"\n                  onClick={() => handleRunSushi(false)}\n                  disabled={isRunning}\n                >\n                  {isRunning ? 'â³ Running...' : 'ğŸš€ Run SUSHI'}\n                </button>\n              </div>\n\n              {stagingFiles.length > 0 && (\n                <div className=\"option-group\">\n                  <h4>ğŸ—ï¸ Repository + Staging Files</h4>\n                  <p>\n                    Compile using repository files, with staging ground files ({stagingFiles.length} files) \n                    overriding any repository files with the same name.\n                  </p>\n                  <button\n                    className=\"run-sushi-btn secondary\"\n                    onClick={() => handleRunSushi(true)}\n                    disabled={isRunning}\n                  >\n                    {isRunning ? 'â³ Running...' : 'ğŸš€ Run SUSHI + Staging'}\n                  </button>\n                </div>\n              )}\n            </div>\n\n            <div className=\"sushi-status\">\n              <div className=\"status-item\">\n                <span className=\"label\">Execution:</span>\n                <span className=\"value\">\n                  {wasmSupported && wasmInitialized ? 'ğŸš€ WebAssembly Ready' : 'âš™ï¸ JavaScript'}\n                </span>\n              </div>\n              <div className=\"status-item\">\n                <span className=\"label\">Config:</span>\n                <span className=\"value\">{sushiConfig ? 'âœ… Found' : 'â“ Unknown'}</span>\n              </div>\n              <div className=\"status-item\">\n                <span className=\"label\">FSH Files:</span>\n                <span className=\"value\">{fshFiles.length} in repository</span>\n              </div>\n              {stagingFiles.length > 0 && (\n                <div className=\"status-item\">\n                  <span className=\"label\">Staging:</span>\n                  <span className=\"value\">{stagingFiles.filter(f => f.path && f.path.endsWith('.fsh')).length} FSH files</span>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n\n        {showModal && <LogModal />}\n        {showFileViewer && <FileViewerModal />}\n      </div>\n    </SushiErrorBoundary>\n  );\n};\n\nexport default SushiRunner;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}