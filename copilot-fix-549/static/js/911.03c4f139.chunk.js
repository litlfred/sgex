"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[911],{13333:(e,s,i)=>{i.d(s,{hX:()=>t});const t=function(e,s,i){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((e=>!!(null!==e&&void 0!==e&&e.ctrlKey||null!==e&&void 0!==e&&e.metaKey))(e)){const e=(e=>{const s="/sgex/copilot-fix-549",i=window.location.origin,t=e.startsWith("/")?e.slice(1):e;return s?`${i}${s.endsWith("/")?s:s+"/"}${t}`:`${i}/${t}`})(s);window.open(e,"_blank","noopener,noreferrer")}else t?i(s,{state:t}):i(s)}},30911:(e,s,i)=>{i.r(s),i.d(s,{default:()=>W});var t=i(65043),n=i(76712),a=i(93071),r=i(88691),o=i(61247),l=i(22392),c=i(55661),d=i(77003),h=i.n(d),m=i(80483),u=i.n(m);const p=i(44131);const g=new class{constructor(){this.validators=new Map,this.initializeSchemaValidator(),this.initializeDefaultValidators()}initializeSchemaValidator(){this.ajv=new(h())({allErrors:!0,verbose:!0}),u()(this.ajv),this.sushiConfigValidator=this.ajv.compile(p)}initializeDefaultValidators(){this.addValidator("xml","xml-well-formed",{level:"error",description:"XML files must be well-formed",validator:this.validateXMLWellFormed.bind(this)}),this.addValidator("bpmn","xml-well-formed",{level:"error",description:"BPMN files must be well-formed XML",validator:this.validateXMLWellFormed.bind(this)}),this.addValidator("bpmn","bpmn-namespace",{level:"error",description:"BPMN files must use correct BPMN 2.0 namespace",validator:this.validateBPMNNamespace.bind(this)}),this.addValidator("bpmn","has-start-event",{level:"warning",description:"BPMN process should have at least one start event",validator:this.validateBPMNStartEvent.bind(this)}),this.addValidator("dmn","xml-well-formed",{level:"error",description:"DMN files must be well-formed XML",validator:this.validateXMLWellFormed.bind(this)}),this.addValidator("dmn","dmn-namespace",{level:"error",description:"DMN files must use correct DMN 1.3 namespace",validator:this.validateDMNNamespace.bind(this)}),this.addValidator("json","json-valid",{level:"error",description:"JSON files must be valid JSON",validator:this.validateJSONSyntax.bind(this)}),this.addValidator("json","fhir-resource-type",{level:"info",description:"FHIR resources should have valid resourceType",validator:this.validateFHIRResourceType.bind(this)}),this.addValidator("*","file-size-limit",{level:"warning",description:"Files should be under 1MB for optimal performance",validator:this.validateFileSize.bind(this)}),this.addValidator("*","filename-conventions",{level:"info",description:"Files should follow naming conventions",validator:this.validateFilenameConventions.bind(this)}),this.addValidator("yaml","sushi-config-valid",{level:"error",description:"sushi-config.yaml must be valid and contain required fields",validator:this.validateSushiConfig.bind(this)})}addValidator(e,s,i){this.validators.has(e)||this.validators.set(e,new Map),this.validators.get(e).set(s,i)}removeValidator(e,s){this.validators.has(e)&&this.validators.get(e).delete(s)}async validateFile(e,s){const i=[],t=this.getFileExtension(e),n=this.getFileName(e),a=this.validators.get(t)||new Map,r=this.validators.get("*")||new Map;for(const[l,c]of a)try{const t=await c.validator(e,s,n);t&&i.push({validatorId:l,level:c.level,description:c.description,...t})}catch(o){i.push({validatorId:l,level:"error",description:"Validator execution failed",message:o.message,filePath:e})}for(const[l,c]of r)try{const t=await c.validator(e,s,n);t&&i.push({validatorId:l,level:c.level,description:c.description,...t})}catch(o){i.push({validatorId:l,level:"error",description:"Validator execution failed",message:o.message,filePath:e})}return i}async validateStagingGround(e){const s={summary:{error:0,warning:0,info:0},files:{},validatedAt:Date.now()};for(const i of e.files){const e=await this.validateFile(i.path,i.content);s.files[i.path]=e,e.forEach(e=>{"error"===e.level?s.summary.error++:"warning"===e.level?s.summary.warning++:"info"===e.level&&s.summary.info++})}return s}async canSave(e){return 0===(await this.validateStagingGround(e)).summary.error}async validateXMLWellFormed(e,s){try{const i=new DOMParser,t=i.parseFromString(s,"text/xml").querySelector("parsererror");return t?{message:"XML is not well-formed: "+t.textContent,filePath:e}:null}catch(i){return{message:"Failed to parse XML: "+i.message,filePath:e}}}async validateBPMNNamespace(e,s){return s.includes('xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"')?null:{message:"BPMN file missing correct BPMN 2.0 namespace declaration",filePath:e,suggestion:'Add xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" to root element'}}async validateBPMNStartEvent(e,s){return s.includes("<startEvent")||s.includes("<bpmn:startEvent")?null:{message:"BPMN process should contain at least one start event",filePath:e,suggestion:"Add a start event to begin the process flow"}}async validateDMNNamespace(e,s){return s.includes('xmlns:dmn="https://www.omg.org/spec/DMN/20191111/MODEL/"')?null:{message:"DMN file missing correct DMN 1.3 namespace declaration",filePath:e,suggestion:'Add xmlns:dmn="https://www.omg.org/spec/DMN/20191111/MODEL/" to root element'}}async validateJSONSyntax(e,s){try{return JSON.parse(s),null}catch(i){return{message:"Invalid JSON syntax: "+i.message,filePath:e}}}async validateFHIRResourceType(e,s){try{const i=JSON.parse(s),t=["StructureDefinition","ValueSet","CodeSystem","ConceptMap","Questionnaire","PlanDefinition","ActivityDefinition","Measure","Library","ImplementationGuide","Bundle","Patient","Practitioner"];return i.resourceType&&!t.includes(i.resourceType)?{message:`Unknown FHIR resourceType: ${i.resourceType}`,filePath:e,suggestion:"Verify the resourceType is correct for FHIR R4"}:null}catch(i){return null}}async validateFileSize(e,s){const i=new Blob([s]).size;return i>1048576?{message:`File size (${(i/1024/1024).toFixed(1)}MB) exceeds recommended limit of 1MB`,filePath:e,suggestion:"Consider breaking large files into smaller components"}:null}async validateFilenameConventions(e,s){const i=this.getFileName(e),t=[];return i.includes(" ")&&t.push("avoid spaces in filenames"),/[<>:"|?*]/.test(i)&&t.push('avoid special characters (<>:"|?*)'),i.length>100&&t.push("filename is very long (>100 characters)"),t.length>0?{message:`Filename convention issues: ${t.join(", ")}`,filePath:e,suggestion:"Use lowercase letters, numbers, hyphens, and underscores"}:null}async validateSushiConfig(e,s){if(!e.endsWith("sushi-config.yaml"))return null;try{let t;try{t=c.default.load(s)}catch(i){return{message:`Invalid YAML syntax: ${i.message}`,filePath:e,suggestion:"Fix YAML syntax errors and ensure proper indentation"}}if(!t||"object"!==typeof t)return{message:"sushi-config.yaml must contain a valid YAML object",filePath:e,suggestion:"Ensure the file contains proper YAML object structure"};if(!this.sushiConfigValidator(t)){const s=this.sushiConfigValidator.errors;return{message:`sushi-config.yaml validation errors: ${s.map(e=>{var s,i;let t=`${e.instancePath?e.instancePath.replace("/",""):(null===(s=e.params)||void 0===s?void 0:s.missingProperty)||"root"}: ${e.message}`;return null!==(i=e.params)&&void 0!==i&&i.allowedValues&&(t+=` (allowed: ${e.params.allowedValues.join(", ")})`),t}).join("; ")}`,filePath:e,suggestion:"Review the sushi-config.yaml specification at https://fshschool.org/docs/sushi/configuration/",details:s}}const n=this.validateWHOSmartGuidelines(t);return n||null}catch(t){return{message:"Failed to validate sushi-config.yaml: "+t.message,filePath:e,suggestion:"Check file format and content structure"}}}validateWHOSmartGuidelines(e){const s=[];return e.dependencies&&e.dependencies["smart.who.int.base"]||s.push("missing smart.who.int.base dependency (required for WHO DAK compliance)"),e.canonical&&e.canonical.includes("smart.who.int")&&(e.id.startsWith("smart.who.int")||s.push('id should start with "smart.who.int" when using WHO canonical URL')),e.canonical&&e.canonical.includes("smart.who.int")&&(e.publisher&&e.publisher.toLowerCase().includes("world health organization")||s.push('publisher should include "World Health Organization" for WHO guidelines'),e.jurisdiction&&Array.isArray(e.jurisdiction)||s.push("jurisdiction should be specified for WHO guidelines")),s.length>0?{message:`WHO SMART Guidelines compliance issues: ${s.join(", ")}`,filePath:"sushi-config.yaml",suggestion:"Ensure compliance with WHO SMART Guidelines requirements"}:null}getFileExtension(e){const s=e.split(".");return s.length>1?s[s.length-1].toLowerCase():""}getFileName(e){return e.split("/").pop()||e}formatValidationResults(e){const s={canSave:0===e.summary.error,summary:e.summary,files:[]};return Object.entries(e.files).forEach(e=>{let[i,t]=e;t.length>0&&s.files.push({path:i,issues:t.map(e=>({level:e.level,message:e.message,description:e.description,suggestion:e.suggestion}))})}),s}getValidationSummary(e){return{error:e.summary.error,warning:e.summary.warning,info:e.summary.info,canSave:0===e.summary.error,hasIssues:e.summary.error+e.summary.warning+e.summary.info>0}}};var f=i(70579);const v=e=>{var s,i;let{isOpen:n,onClose:r,stagingGround:o,validation:c,repository:d,selectedBranch:h,hasWriteAccess:m,onSaveSuccess:u}=e;const[p,v]=(0,t.useState)(""),[y,x]=(0,t.useState)(!1),[b,j]=(0,t.useState)(!1),[w,N]=(0,t.useState)(null),[S,k]=(0,t.useState)(!1);if((0,t.useEffect)(()=>{n&&(v((null===o||void 0===o?void 0:o.message)||""),x(!1),j(!1),N(null),k(!1))},[n,o]),!n)return null;const C=c?g.getValidationSummary(c):null,$=!C||(C.canSave||y),F=!!C&&C.error>0,M=e=>409===e.status?"Conflict detected. The branch has been updated since you started. Please refresh and try again.":403===e.status?"Permission denied. Check that your token has write access to this repository.":404===e.status?"Repository or branch not found. Please verify the repository exists and you have access.":e.message?e.message:"An unexpected error occurred while saving. Please try again.",I=e=>{switch(e){case"error":return"\ud83d\udd34";case"warning":return"\ud83d\udfe1";case"info":return"\ud83d\udfe2";default:return"\u2753"}};return(0,f.jsx)("div",{className:"save-dialog-overlay",children:(0,f.jsxs)("div",{className:"save-dialog",children:[(0,f.jsxs)("div",{className:"dialog-header",children:[(0,f.jsx)("h3",{children:"\ud83d\udcbe Save Changes"}),(0,f.jsx)("button",{className:"dialog-close",onClick:r,disabled:b,children:"\xd7"})]}),(0,f.jsxs)("div",{className:"dialog-content",children:[(0,f.jsxs)("div",{className:"save-summary",children:[(0,f.jsxs)("h4",{children:["Files to be committed (",(null===o||void 0===o||null===(s=o.files)||void 0===s?void 0:s.length)||0,"):"]}),(0,f.jsx)("div",{className:"files-list",children:null===o||void 0===o||null===(i=o.files)||void 0===i?void 0:i.map((e,s)=>(0,f.jsxs)("div",{className:"file-item",children:[(0,f.jsx)("span",{className:"file-icon",children:"\ud83d\udcc4"}),(0,f.jsx)("span",{className:"file-path",children:e.path}),(0,f.jsxs)("span",{className:"file-size",children:[(new Blob([e.content]).size/1024).toFixed(1)," KB"]}),(0,f.jsx)("button",{className:"remove-file-btn",onClick:s=>{var i;s.stopPropagation(),i=e.path,window.confirm(`Are you sure you want to remove "${i}" from staging? This cannot be undone.`)&&l.A.removeFile(i)},title:`Remove ${e.path} from staging`,disabled:b,children:"\ud83d\uddd1\ufe0f"})]},s))})]}),C&&(0,f.jsxs)("div",{className:"validation-section",children:[(0,f.jsx)("div",{className:"validation-summary "+(C.hasIssues?"has-issues":"clean"),onClick:()=>k(!S),children:(0,f.jsxs)("div",{className:"validation-header",children:[(0,f.jsx)("h4",{children:"\ud83d\udea6 Validation Status"}),(0,f.jsxs)("div",{className:"validation-badges",children:[C.error>0&&(0,f.jsxs)("span",{className:"validation-badge error",children:["\ud83d\udd34 ",C.error]}),C.warning>0&&(0,f.jsxs)("span",{className:"validation-badge warning",children:["\ud83d\udfe1 ",C.warning]}),C.info>0&&(0,f.jsxs)("span",{className:"validation-badge info",children:["\ud83d\udfe2 ",C.info]}),!C.hasIssues&&(0,f.jsx)("span",{className:"validation-badge success",children:"\u2705 All clear"})]}),(0,f.jsx)("span",{className:"expand-icon "+(S?"expanded":""),children:"\u25bc"})]})}),S&&c&&(0,f.jsx)("div",{className:"validation-details",children:Object.entries(c.files).map(e=>{let[s,i]=e;return i.length>0&&(0,f.jsxs)("div",{className:"file-validation",children:[(0,f.jsxs)("h5",{children:["\ud83d\udcc4 ",s]}),(0,f.jsx)("div",{className:"validation-issues",children:i.map((e,s)=>(0,f.jsxs)("div",{className:`validation-issue ${e.level}`,children:[(0,f.jsx)("span",{className:"issue-icon",children:I(e.level)}),(0,f.jsxs)("div",{className:"issue-content",children:[(0,f.jsx)("div",{className:"issue-message",children:e.message}),e.suggestion&&(0,f.jsxs)("div",{className:"issue-suggestion",children:["\ud83d\udca1 ",e.suggestion]})]})]},s))})]},s)})}),F&&(0,f.jsxs)("div",{className:"override-section",children:[(0,f.jsxs)("label",{className:"override-checkbox",children:[(0,f.jsx)("input",{type:"checkbox",checked:y,onChange:e=>x(e.target.checked)}),(0,f.jsx)("span",{className:"checkmark"}),"Override validation errors and save anyway"]}),(0,f.jsx)("p",{className:"override-warning",children:"\u26a0\ufe0f Saving with validation errors may cause issues with your DAK. Only enable this if you're sure about your changes."})]})]}),(0,f.jsxs)("div",{className:"commit-message-section",children:[(0,f.jsx)("label",{htmlFor:"commit-message",children:(0,f.jsx)("h4",{children:"\u270d\ufe0f Commit Message"})}),(0,f.jsx)("textarea",{id:"commit-message",className:"commit-message-input",value:p,onChange:e=>v(e.target.value),placeholder:"Describe your changes...",rows:3,disabled:b,required:!0}),(0,f.jsx)("div",{className:"commit-tips",children:(0,f.jsxs)("p",{children:["\ud83d\udca1 ",(0,f.jsx)("strong",{children:"Tip:"})," Write a clear, descriptive message about what you changed and why."]})})]}),w&&(0,f.jsx)("div",{className:"error-section",children:(0,f.jsxs)("div",{className:"error-message",children:[(0,f.jsx)("span",{className:"error-icon",children:"\u274c"}),w]})}),(0,f.jsxs)("div",{className:"repo-info",children:[(0,f.jsxs)("div",{className:"info-item",children:[(0,f.jsx)("span",{className:"info-label",children:"Repository:"}),(0,f.jsx)("span",{className:"info-value",children:null===d||void 0===d?void 0:d.full_name})]}),(0,f.jsxs)("div",{className:"info-item",children:[(0,f.jsx)("span",{className:"info-label",children:"Branch:"}),(0,f.jsx)("span",{className:"info-value",children:h})]}),(0,f.jsxs)("div",{className:"info-item",children:[(0,f.jsx)("span",{className:"info-label",children:"Access:"}),(0,f.jsx)("span",{className:"info-value "+(m?"write":"read"),children:m?"\u270f\ufe0f Write":"\ud83d\udc41\ufe0f Read-only"})]})]})]}),(0,f.jsxs)("div",{className:"dialog-actions",children:[(0,f.jsx)("button",{className:"action-btn secondary",onClick:r,disabled:b,children:"Cancel"}),(0,f.jsx)("button",{className:"action-btn primary",onClick:async()=>{if(p.trim())if(m)if(!F||y){j(!0),N(null);try{var e;const s=(null===(e=d.owner)||void 0===e?void 0:e.login)||d.full_name.split("/")[0];if(d.isDemo||d.owner&&"demo-user"===d.owner.login)return await new Promise(e=>setTimeout(e,2e3)),void u({sha:"demo-commit-sha",message:p,url:`https://github.com/${d.full_name}/commit/demo-commit-sha`});const i=await a.A.createCommit(s,d.name,h,p.trim(),o.files);u({sha:i.sha,message:p,url:i.html_url})}catch(s){console.error("Error saving changes:",s),N(M(s))}finally{j(!1)}}else N("Cannot save with validation errors. Enable override option to proceed anyway.");else N("You need write permissions to save changes");else N("Commit message is required")},disabled:!$||!p.trim()||b||!m,children:b?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("span",{className:"saving-spinner",children:"\u23f3"}),"Saving..."]}):(0,f.jsx)(f.Fragment,{children:"\ud83d\udcbe Save Changes"})})]})]})})},y=e=>{let{repository:s,selectedBranch:i,hasWriteAccess:n,profile:a,onStagingFilesChange:r}=e;const[o,c]=(0,t.useState)(null),[d,h]=(0,t.useState)(null),[m,u]=(0,t.useState)(!1),[p,y]=(0,t.useState)(null),[x,b]=(0,t.useState)(!1),j=(0,t.useCallback)(async()=>{u(!0),y(null);try{const e=l.A.getStagingGround();c(e),r&&r(e.files||[]),e.files.length>0&&await w(e)}catch(e){y("Failed to load staging ground data"),console.error("Error loading staging ground:",e)}finally{u(!1)}},[r]);(0,t.useEffect)(()=>{if(s&&i){l.A.initialize(s,i),j();return l.A.addListener(e=>{c(e),w(e),r&&r(e.files||[])})}},[s,i,j,r]);const w=async e=>{if(e&&0!==e.files.length)try{const s=await g.validateStagingGround(e);h(s)}catch(s){console.error("Error validating staging ground:",s),h(null)}else h(null)},N=d?g.getValidationSummary(d):{error:0,warning:0,info:0,canSave:!0},S=o&&o.files.length>0,k=o?o.files.length:0;return(0,f.jsxs)("div",{className:"staging-ground-section",children:[(0,f.jsxs)("div",{className:"section-header",children:[(0,f.jsxs)("h3",{className:"section-title",children:[(0,f.jsx)("span",{className:"section-icon",children:"\ud83d\udcdd"}),"Staging Ground",S&&(0,f.jsxs)("span",{className:"files-badge",children:[k," file",1!==k?"s":""]})]}),(0,f.jsx)("p",{className:"section-description",children:"Changes made through DAK component editors are staged here before being committed to the repository. Review and commit your changes when ready."})]}),(0,f.jsx)("div",{className:"staging-content",children:m?(0,f.jsxs)("div",{className:"loading-indicator",children:[(0,f.jsx)("span",{className:"loading-spinner",children:"\u23f3"}),"Loading staging ground..."]}):p?(0,f.jsxs)("div",{className:"error-message",children:[(0,f.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),p]}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:"staging-status-bar",children:[(0,f.jsx)("div",{className:"status-indicators",children:(0,f.jsxs)("div",{className:"validation-stoplight",children:[(0,f.jsxs)("div",{className:"stoplight-indicator error "+(0===N.error?"lit":""),children:["\ud83d\udd34",N.error>0&&(0,f.jsx)("span",{className:"indicator-badge",children:N.error})]}),(0,f.jsxs)("div",{className:"stoplight-indicator warning "+(0===N.warning?"lit":""),children:["\ud83d\udfe1",N.warning>0&&(0,f.jsx)("span",{className:"indicator-badge",children:N.warning})]}),(0,f.jsxs)("div",{className:"stoplight-indicator info "+(0===N.info?"lit":""),children:["\ud83d\udfe2",N.info>0&&(0,f.jsx)("span",{className:"indicator-badge",children:N.info})]})]})}),(0,f.jsx)("button",{className:"save-btn "+(S&&N.canSave?"":"disabled"),onClick:()=>{n?b(!0):alert("You need write permissions to save changes to this repository.")},disabled:!S||!n,title:S?n?N.canSave?"Save changes to repository":"Fix validation errors first":"Write access required":"No changes to save",children:"\ud83d\udcbe Save Changes"})]}),(0,f.jsxs)("div",{className:"staging-files-section",children:[(0,f.jsx)("h4",{children:"\ud83d\udcc1 Changed Files"}),S?(0,f.jsxs)("div",{className:"changed-files",children:[(o&&o.files?o.files.map(e=>({path:e.path,size:new Blob([e.content]).size,lastModified:e.timestamp})):[]).map((e,s)=>(0,f.jsxs)("div",{className:"file-item",children:[(0,f.jsxs)("div",{className:"file-info",children:[(0,f.jsx)("span",{className:"file-icon",children:"\ud83d\udcc4"}),(0,f.jsx)("span",{className:"file-path",children:e.path})]}),(0,f.jsxs)("div",{className:"file-meta",children:[(0,f.jsxs)("span",{className:"file-size",children:[(e.size/1024).toFixed(1)," KB"]}),(0,f.jsx)("span",{className:"file-time",children:new Date(e.lastModified).toLocaleTimeString()}),(0,f.jsx)("button",{className:"remove-file-btn",onClick:s=>{var i;s.stopPropagation(),i=e.path,window.confirm(`Are you sure you want to remove "${i}" from staging? This cannot be undone.`)&&l.A.removeFile(i)},title:`Remove ${e.path} from staging`,children:"\ud83d\uddd1\ufe0f"})]})]},s)),(0,f.jsx)("div",{className:"file-actions",children:(0,f.jsx)("button",{className:"action-btn secondary small",onClick:()=>{window.confirm("Are you sure you want to discard all changes? This cannot be undone.")&&l.A.clearStagingGround()},children:"\ud83d\uddd1\ufe0f Clear All Changes"})})]}):(0,f.jsxs)("div",{className:"no-changes",children:[(0,f.jsx)("p",{children:"No changes in staging ground"}),(0,f.jsx)("p",{className:"help-text",children:"Changes made through DAK component editors will appear here before being saved to the repository."})]})]}),S&&o.message&&(0,f.jsxs)("div",{className:"commit-message-section",children:[(0,f.jsx)("h4",{children:"\u270d\ufe0f Commit Message"}),(0,f.jsx)("div",{className:"commit-preview",children:(0,f.jsx)("p",{children:o.message})})]})]})}),(0,f.jsx)(v,{isOpen:x,onClose:()=>b(!1),stagingGround:o,validation:d,repository:s,selectedBranch:i,hasWriteAccess:n,onSaveSuccess:e=>{b(!1),l.A.clearStagingGround(),alert(`Changes saved successfully! Commit: ${e.sha.substring(0,7)}`)}})]})};var x=i(93821),b=i(15328);class j{constructor(){this.files=new Map,this.directories=new Set,this.maxMemoryUsage=20971520,this.currentMemoryUsage=0}writeFile(e,s){const i=e.startsWith("/")?e.substring(1):e,t=(new TextEncoder).encode(s).length;if(this.currentMemoryUsage+t>this.maxMemoryUsage)throw new Error(`Memory limit exceeded. Cannot store file ${i} (${(t/1024/1024).toFixed(1)}MB)`);const n=i.split("/");for(let r=0;r<n.length-1;r++){const e=n.slice(0,r+1).join("/");this.directories.add(e)}const a=(new TextEncoder).encode(s);if(this.files.has(i)){const e=this.files.get(i);this.currentMemoryUsage-=e.length}return this.files.set(i,a),this.currentMemoryUsage+=a.length,!0}readFile(e){const s=e.startsWith("/")?e.substring(1):e,i=this.files.get(s);if(!i)return null;return(new TextDecoder).decode(i)}exists(e){const s=e.startsWith("/")?e.substring(1):e;return this.files.has(s)||this.directories.has(s)}listDirectory(e){const s=e.startsWith("/")?e.substring(1):e,i=s?`${s}/`:"",t=[];for(const n of this.files.keys())if(n.startsWith(i)){const e=n.substring(i.length);e.includes("/")||t.push({name:e,type:"file",path:n})}for(const n of this.directories)if(n.startsWith(i)){const e=n.substring(i.length);e.includes("/")||t.push({name:e,type:"directory",path:n})}return t}clear(){this.files.clear(),this.directories.clear(),this.currentMemoryUsage=0}getMemoryUsage(){return{used:this.currentMemoryUsage,limit:this.maxMemoryUsage,percentage:this.currentMemoryUsage/this.maxMemoryUsage*100}}}const w=new class{constructor(){this.wasmModule=null,this.fs=new j,this.isInitialized=!1,this.initializationPromise=null}async initialize(){return this.isInitialized?this.wasmModule:(this.initializationPromise||(this.initializationPromise=this._loadWasmModule()),this.initializationPromise)}async _loadWasmModule(){try{const e=await this._importSushiLibrary();return this.wasmModule=e,this.isInitialized=!0,this.wasmModule}catch(e){throw console.error("Failed to load SUSHI WASM module:",e),new Error(`SUSHI WASM initialization failed: ${e.message}`)}}async _importSushiLibrary(){return console.log("Creating fallback SUSHI implementation for browser environment"),{ccall:this._createFallbackCCall.bind(this),FS:{writeFile:this.fs.writeFile.bind(this.fs),readFile:this.fs.readFile.bind(this.fs),exists:this.fs.exists.bind(this.fs)}}}_createFallbackCCall(){return(e,s,i,t)=>{if("runSushi"===e)return this._runFallbackCompilation(t[0]);throw new Error(`Unsupported WASM function: ${e}`)}}async _runFallbackCompilation(e){const s=[],t=[],n=[];try{const e=this._getAllFshFiles(),r=this.fs.readFile("sushi-config.yaml");let o={name:"browser-generated-ig",version:"1.0.0",fhirVersion:"4.0.1",canonical:"http://example.org/fhir/ig/browser-generated"};if(r)try{o=(await Promise.resolve().then(i.bind(i,55661))).default.load(r)}catch(a){n.push(`Failed to parse sushi-config.yaml: ${a.message}`)}else n.push("No sushi-config.yaml found, using default configuration");for(const{content:i}of e){const e=this._extractFSHDefinitions(i),t=this._generateFHIRResources(e,o);s.push(...t)}return{success:!0,files:s,errors:t,warnings:n}}catch(r){return{success:!1,files:[],errors:[r.message],warnings:n}}}_getAllFshFiles(){var e=this;const s=[],i=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const n=e.fs.listDirectory(t);for(const a of n)if("file"===a.type&&a.name.endsWith(".fsh")){const i=e.fs.readFile(a.path);i&&s.push({path:a.path,content:i})}else"directory"===a.type&&i(a.path)};return i("input/fsh"),s}_extractFSHDefinitions(e){const s={profiles:[],instances:[],valueSets:[],codeSystems:[],extensions:[]},i=e.split("\n");let t=null,n=null;for(let a=0;a<i.length;a++){const e=i[a].trim();e.startsWith("Profile:")?(n="profiles",t={name:e.substring(8).trim(),type:"Profile",parent:null,id:null,title:null,description:null,rules:[]}):e.startsWith("Instance:")?(n="instances",t={name:e.substring(9).trim(),type:"Instance",instanceOf:null,usage:null,title:null,description:null,rules:[]}):e.startsWith("ValueSet:")?(n="valueSets",t={name:e.substring(9).trim(),type:"ValueSet",id:null,title:null,description:null,rules:[]}):e.startsWith("CodeSystem:")?(n="codeSystems",t={name:e.substring(11).trim(),type:"CodeSystem",id:null,title:null,description:null,rules:[]}):e.startsWith("Extension:")&&(n="extensions",t={name:e.substring(10).trim(),type:"Extension",id:null,title:null,description:null,rules:[]}),t&&(e.startsWith("Parent:")?t.parent=e.substring(7).trim():e.startsWith("InstanceOf:")?t.instanceOf=e.substring(11).trim():e.startsWith("Usage:")?t.usage=e.substring(6).trim():e.startsWith("Id:")?t.id=e.substring(3).trim():e.startsWith("Title:")?t.title=e.substring(6).trim().replace(/['"]/g,""):e.startsWith("Description:")?t.description=e.substring(12).trim().replace(/['"]/g,""):e.startsWith("* ")&&t.rules.push(e.substring(2).trim()),(!e.includes(":")||e.startsWith("* ")||e.startsWith("Parent:")||e.startsWith("InstanceOf:")||e.startsWith("Usage:")||e.startsWith("Id:")||e.startsWith("Title:")||e.startsWith("Description:"))&&a!==i.length-1||(t&&n&&t.name&&s[n].push(t),t=null,n=null,a--))}return s}_generateFHIRResources(e,s){const i=[];return e.profiles.forEach(e=>{const t=e.id||e.name.toLowerCase().replace(/\s+/g,"-"),n={resourceType:"StructureDefinition",id:t,url:`${s.canonical}/StructureDefinition/${t}`,name:e.name,title:e.title||e.name,status:"draft",fhirVersion:s.fhirVersion||"4.0.1",kind:"resource",abstract:!1,type:"Patient"===e.parent?"Patient":"Observation"===e.parent?"Observation":e.parent||"DomainResource",baseDefinition:`http://hl7.org/fhir/StructureDefinition/${e.parent||"DomainResource"}`,derivation:"constraint",description:e.description||`Profile for ${e.name}`};e.rules.length>0&&(n.differential={element:e.rules.map((e,s)=>({id:`${n.type}.${e.split(" ")[0]}`,path:`${n.type}.${e.split(" ")[0]}`,short:`Rule: ${e}`}))}),i.push({path:`StructureDefinition-${t}.json`,content:JSON.stringify(n,null,2),resourceType:"StructureDefinition"})}),e.instances.forEach(e=>{const t=e.name.toLowerCase().replace(/\s+/g,"-"),n="Patient"===e.instanceOf?"Patient":"Observation"===e.instanceOf?"Observation":"Patient",a={resourceType:n,id:t,meta:{profile:e.instanceOf?[`${s.canonical}/StructureDefinition/${e.instanceOf}`]:void 0}};"Patient"===n&&(a.name=[{family:e.name.split(" ").pop(),given:e.name.split(" ").slice(0,-1)}]),i.push({path:`${t}.json`,content:JSON.stringify(a,null,2),resourceType:n})}),e.valueSets.forEach(e=>{const t=e.id||e.name.toLowerCase().replace(/\s+/g,"-"),n={resourceType:"ValueSet",id:t,url:`${s.canonical}/ValueSet/${t}`,name:e.name,title:e.title||e.name,status:"draft",description:e.description||`ValueSet for ${e.name}`,compose:{include:[{system:"http://example.org/codes",concept:[{code:"example1",display:"Example Code 1"},{code:"example2",display:"Example Code 2"}]}]}};i.push({path:`ValueSet-${t}.json`,content:JSON.stringify(n,null,2),resourceType:"ValueSet"})}),e.codeSystems.forEach(e=>{const t=e.id||e.name.toLowerCase().replace(/\s+/g,"-"),n={resourceType:"CodeSystem",id:t,url:`${s.canonical}/CodeSystem/${t}`,name:e.name,title:e.title||e.name,status:"draft",content:"complete",description:e.description||`CodeSystem for ${e.name}`,concept:[{code:"concept1",display:"Concept 1"},{code:"concept2",display:"Concept 2"}]};i.push({path:`CodeSystem-${t}.json`,content:JSON.stringify(n,null,2),resourceType:"CodeSystem"})}),i}async runSushi(e,s){this.isInitialized||await this.initialize(),this.fs.clear();const t=s.reduce((e,s)=>{var i;return e+((null===(i=s.content)||void 0===i?void 0:i.length)||0)},0);if(t>15728640)throw new Error(`Input files too large (${(t/1024/1024).toFixed(1)}MB). Consider processing fewer files at once.`);try{if(e){const s="string"===typeof e?e:(await Promise.resolve().then(i.bind(i,55661))).default.dump(e);this.fs.writeFile("sushi-config.yaml",s)}for(const e of s){const s=e.path||`input/fsh/${e.name}`;e.content&&e.content.length>2097152?console.warn(`Skipping large file ${e.name} (${(e.content.length/1024/1024).toFixed(1)}MB)`):this.fs.writeFile(s,e.content||"")}const t=this.wasmModule.ccall("runSushi","string",["string"],["/workspace"]);return"string"===typeof t?JSON.parse(t):t}catch(n){throw this.fs.clear(),n}}};class N{constructor(){this.loadedModules=new Map,this.loadingPromises=new Map}async loadModule(e,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.loadedModules.has(e))return this.loadedModules.get(e);if(this.loadingPromises.has(e))return this.loadingPromises.get(e);const t=this._loadModuleInternal(s,i);this.loadingPromises.set(e,t);try{const s=await t;return this.loadedModules.set(e,s),this.loadingPromises.delete(e),s}catch(n){throw this.loadingPromises.delete(e),n}}async _loadModuleInternal(e,s){let i;if(e instanceof ArrayBuffer)i=e;else{if("string"!==typeof e)throw new Error("Invalid WASM source: must be URL string or ArrayBuffer");{const s=await fetch(e);if(!s.ok)throw new Error(`Failed to fetch WASM module: ${s.statusText}`);i=await s.arrayBuffer()}}const t=await WebAssembly.compile(i);return await WebAssembly.instantiate(t,s)}static isSupported(){return"object"===typeof WebAssembly&&"function"===typeof WebAssembly.instantiate}static getSupportInfo(){const e={basic:"object"===typeof WebAssembly,streaming:"function"===typeof WebAssembly.instantiateStreaming,threads:"undefined"!==typeof SharedArrayBuffer,simd:!1};try{e.simd="undefined"!==typeof WebAssembly.v128}catch(s){e.simd=!1}return e}clearCache(){this.loadedModules.clear(),this.loadingPromises.clear()}unloadModule(e){this.loadedModules.delete(e),this.loadingPromises.delete(e)}}new N;const S=new class{constructor(){this.metrics=new Map}startTiming(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";const i=`${e}-${s}`;this.metrics.set(i,{startTime:performance.now(),implementation:s,operationName:e})}endTiming(e){const s=`${e}-${arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown"}`,i=this.metrics.get(s);if(!i)return console.warn(`No timing started for ${s}`),0;const t=performance.now()-i.startTime;return i.duration=t,i.endTime=performance.now(),t}getComparison(e){const s=`${e}-js`,i=`${e}-wasm`,t=this.metrics.get(s),n=this.metrics.get(i);if(!t||!n)return null;const a=t.duration/n.duration;return{javascript:{duration:t.duration,implementation:"JavaScript"},webassembly:{duration:n.duration,implementation:"WebAssembly"},speedup:a,winner:a>1?"WebAssembly":"JavaScript",improvement:a>1?`${(100*(a-1)).toFixed(1)}% faster`:`${(100*(1-a)).toFixed(1)}% slower`}}getAllMetrics(){return Array.from(this.metrics.values())}clear(){this.metrics.clear()}};class k extends t.Component{constructor(e){super(e),this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null,memoryInfo:null})},this.state={hasError:!1,error:null,errorInfo:null,memoryInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,s){const i=performance.memory?{used:(performance.memory.usedJSHeapSize/1024/1024).toFixed(1),total:(performance.memory.totalJSHeapSize/1024/1024).toFixed(1),limit:(performance.memory.jsHeapSizeLimit/1024/1024).toFixed(1)}:null;if(this.setState({error:e,errorInfo:s,memoryInfo:i}),console.error("SUSHI Error Boundary caught an error:",e,s),window.gc&&"function"===typeof window.gc)try{window.gc()}catch(t){console.warn("Manual garbage collection failed:",t)}}render(){return this.state.hasError?(0,f.jsx)("div",{className:"sushi-error-boundary",children:(0,f.jsxs)("div",{className:"error-content",children:[(0,f.jsx)("h3",{children:"\ud83c\udf63 SUSHI Processing Error"}),(0,f.jsx)("p",{children:"Something went wrong during FHIR Shorthand compilation. This may be due to:"}),(0,f.jsxs)("ul",{children:[(0,f.jsx)("li",{children:"Large FSH files causing memory issues"}),(0,f.jsx)("li",{children:"Complex FSH syntax that exceeded processing limits"}),(0,f.jsx)("li",{children:"Browser memory constraints"}),(0,f.jsx)("li",{children:"Incompatible FSH definitions"})]}),this.state.memoryInfo&&(0,f.jsxs)("div",{className:"memory-info",children:[(0,f.jsx)("h4",{children:"\ud83d\udcbe Memory Usage"}),(0,f.jsxs)("p",{children:["Used: ",this.state.memoryInfo.used," MB / Total: ",this.state.memoryInfo.total," MB / Limit: ",this.state.memoryInfo.limit," MB"]})]}),(0,f.jsxs)("div",{className:"error-suggestions",children:[(0,f.jsx)("h4",{children:"\ud83d\udca1 Suggestions to Resolve"}),(0,f.jsxs)("ul",{children:[(0,f.jsx)("li",{children:"Try processing fewer FSH files at once"}),(0,f.jsx)("li",{children:"Split large FSH files into smaller ones"}),(0,f.jsx)("li",{children:"Refresh the page to clear memory"}),(0,f.jsx)("li",{children:"Use a browser with more available memory"}),(0,f.jsx)("li",{children:"Close other browser tabs to free up memory"})]})]}),(0,f.jsxs)("div",{className:"error-actions",children:[(0,f.jsx)("button",{onClick:this.handleReset,className:"reset-btn",children:"\ud83d\udd04 Try Again"}),(0,f.jsx)("button",{onClick:()=>window.location.reload(),className:"reload-btn",children:"\ud83d\ude80 Reload Page"})]}),!1]})}):this.props.children}}const C=k,$=e=>{var s;let{repository:n,selectedBranch:r,profile:o,stagingFiles:l=[]}=e;const[c,d]=(0,t.useState)(!1),[h,m]=(0,t.useState)(!1),[u,p]=(0,t.useState)(!1),[g,v]=(0,t.useState)([]),[y,j]=(0,t.useState)([]),[k,$]=(0,t.useState)(!1),[F,M]=(0,t.useState)(null),[I,A]=(0,t.useState)("logs"),[P,W]=(0,t.useState)({info:!0,success:!0,warning:!0,error:!0}),[H,D]=(0,t.useState)(""),[L,R]=(0,t.useState)(null),[T,E]=(0,t.useState)([]),[O,B]=(0,t.useState)(!1),[_,V]=(0,t.useState)(null),[G,U]=(0,t.useState)("auto"),[z,J]=(0,t.useState)(!1),[q,K]=(0,t.useState)(!1),X=(null===(s=n.owner)||void 0===s?void 0:s.login)||n.full_name.split("/")[0],Y=n.name,Z=(0,t.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";v(i=>[...i,{id:Date.now()+Math.random(),message:e,type:s,timestamp:(new Date).toISOString()}])},[]);(0,t.useEffect)(()=>{(async()=>{const e=N.isSupported();if(J(e),e){Z("\ud83d\ude80 WebAssembly support detected","success");try{await w.initialize(),K(!0),Z("\u2705 SUSHI WebAssembly service initialized","success")}catch(s){Z(`\u26a0\ufe0f WASM initialization failed, falling back to JavaScript: ${s.message}`,"warning")}}else Z("\u26a0\ufe0f WebAssembly not supported, using JavaScript fallback","warning")})()},[Z]);const Q=async(e,s)=>{try{Z("\ud83d\udce6 Preparing WebAssembly execution environment...","info");const i=await w.runSushi(e,s);if(i.success){Z("\u2705 WebAssembly compilation successful","success"),Z(`\ud83d\udcca Generated ${i.files.length} FHIR resources`,"success");const e=i.files.map(e=>({type:e.resourceType,filename:e.path,content:e.content,id:e.path.split(".")[0],resourceType:e.resourceType}));return j(e),i.warnings.forEach(e=>{Z(`\u26a0\ufe0f ${e}`,"warning")}),{success:!0,resourceCount:i.files.length,warnings:i.warnings,errors:i.errors,generatedFiles:e}}throw i.errors.forEach(e=>{Z(`\u274c ${e}`,"error")}),new Error(`WASM compilation failed: ${i.errors.join(", ")}`)}catch(i){throw Z(`\ud83d\udca5 WebAssembly execution failed: ${i.message}`,"error"),i}},ee=async(e,s)=>{try{Z("\ud83d\ude80 Starting FHIR Shorthand compilation...","info"),Z("\u2139\ufe0f Using JavaScript FSH processor with enhanced crash prevention","info");const n=()=>{if(performance.memory&&performance.memory.usedJSHeapSize){const e=performance.memory.usedJSHeapSize/1024/1024,s=30,i=20;if(e>s)throw new Error(`Memory limit exceeded: ${e.toFixed(1)}MB > ${s}MB. Processing stopped to prevent browser crash.`);return e>i&&Z(`\u26a0\ufe0f High memory usage: ${e.toFixed(1)}MB (approaching ${s}MB limit)`,"warning"),e}return 0},a=n();Z(`\ud83d\udcbe Initial memory usage: ${a.toFixed(1)} MB`,"info");const r=1048576,o=5242880,l=5;let c=0;const d=[];for(const e of s.slice(0,l)){const s=e.content?e.content.length:0;if(s>r)Z(`\u274c Skipping ${e.name}: too large (${(s/1024/1024).toFixed(1)}MB > 1MB limit)`,"error");else{if(c+s>o){Z(`\u26a0\ufe0f Stopping file processing: total size limit reached (${(c/1024/1024).toFixed(1)}MB)`,"warning");break}c+=s,d.push(e)}}s.length>l&&Z(`\u26a0\ufe0f Limited to first ${l} files (${s.length} total) to prevent browser crashes`,"warning"),Z(`\ud83d\udcca Processing ${d.length} files (${(c/1024/1024).toFixed(1)}MB total)`,"info"),Z("\ud83d\udce6 Loading YAML processing library...","info");const h=await Promise.resolve().then(i.bind(i,55661));Z("\u2705 Libraries loaded successfully","success"),Z("\ud83d\udcdd Processing configuration...","info");let m=null;if(e)try{m="string"===typeof e?h.default.load(e):e,Z(`\ud83d\udccb Package: ${m.name||"Unknown"}`,"success"),Z(`\ud83d\udccb Version: ${m.version||"Unknown"}`,"success"),Z(`\ud83d\udccb FHIR Version: ${m.fhirVersion||"Unknown"}`,"success")}catch(t){Z(`\u26a0\ufe0f Could not parse config: ${t.message}`,"warning")}else m={name:"browser-generated-ig",version:"1.0.0",fhirVersion:"4.0.1",id:"browser.generated.ig",canonical:"http://example.org/fhir/ig/browser-generated",status:"draft"},Z("\ud83d\udccb Using default configuration","info");Z(`\ud83d\udd0d Analyzing ${d.length} FSH files with crash prevention...`,"info");const u=[];let p=0;const g=3,f=15,v=1;for(let e=0;e<d.length;e+=v){const s=d.slice(e,e+v);for(const e of s){Z(`\ud83d\udcc4 Processing ${e.name} (${p+1}/${d.length})...`,"info");const s=n();if(s>15){Z(`\u26a0\ufe0f Stopping processing due to high memory usage (${s.toFixed(1)}MB)`,"warning");break}if(u.length>=f){Z(`\u26a0\ufe0f Reached maximum resource limit (${f}), stopping processing`,"warning");break}const i=e.content,a=e=>{try{const s={profiles:[],instances:[],valueSets:[],codeSystems:[],extensions:[]};if(!e||"string"!==typeof e)return s;const i=e.split("\n"),t=500;i.length>t&&Z(`  \u26a0\ufe0f File is large (${i.length} lines). Processing first ${t} lines only.`,"warning");const n=i.slice(0,Math.min(i.length,t));let a=null,r=null,o=0;const l=5;for(let e=0;e<n.length&&o<l;e++){const i=n[e].trim();if(i&&!i.startsWith("//")&&!i.startsWith("/*")){if(i.startsWith("Profile:")){if(o>=l)break;r="profiles",a={name:i.substring(8).trim(),type:"Profile",parent:null,id:null,title:null,description:null,rules:[]},o++}else if(i.startsWith("Instance:")){if(o>=l)break;r="instances",a={name:i.substring(9).trim(),type:"Instance",instanceOf:null,usage:null,title:null,description:null,rules:[]},o++}else if(i.startsWith("ValueSet:")){if(o>=l)break;r="valueSets",a={name:i.substring(9).trim(),type:"ValueSet",id:null,title:null,description:null,rules:[]},o++}else if(i.startsWith("CodeSystem:")){if(o>=l)break;r="codeSystems",a={name:i.substring(11).trim(),type:"CodeSystem",id:null,title:null,description:null,rules:[]},o++}else if(i.startsWith("Extension:")){if(o>=l)break;r="extensions",a={name:i.substring(10).trim(),type:"Extension",id:null,title:null,description:null,rules:[]},o++}a&&(i.startsWith("Parent:")?a.parent=i.substring(7).trim():i.startsWith("InstanceOf:")?a.instanceOf=i.substring(11).trim():i.startsWith("Usage:")?a.usage=i.substring(6).trim():i.startsWith("Id:")?a.id=i.substring(3).trim():i.startsWith("Title:")?a.title=i.substring(6).trim().replace(/['"]/g,""):i.startsWith("Description:")?a.description=i.substring(12).trim().replace(/['"]/g,""):i.startsWith("* ")&&a.rules.length<5&&a.rules.push(i.substring(2).trim()),(!i.includes(":")||i.startsWith("* ")||i.startsWith("Parent:")||i.startsWith("InstanceOf:")||i.startsWith("Usage:")||i.startsWith("Id:")||i.startsWith("Title:")||i.startsWith("Description:"))&&e!==n.length-1||(a&&r&&a.name&&s[r].push(a),a=null,r=null,e--))}}return o>=l&&Z(`  \u26a0\ufe0f Limited to ${l} definitions per file to prevent browser crashes`,"warning"),s}catch(t){return Z(`  \u274c Error parsing FSH content: ${t.message}`,"error"),{profiles:[],instances:[],valueSets:[],codeSystems:[],extensions:[]}}},r=a(i);let o=0;const l=f-u.length,c=Math.min(g,l);for(const e of r.profiles.slice(0,Math.min(1,c-o))){if(o>=c)break;try{const s=e.id||e.name.toLowerCase().replace(/\s+/g,"-"),i={resourceType:"StructureDefinition",id:s,url:`${m.canonical}/StructureDefinition/${s}`,name:e.name,title:e.title||e.name,status:"draft",fhirVersion:m.fhirVersion||"4.0.1",kind:"resource",abstract:!1,type:"Patient"===e.parent?"Patient":"Observation"===e.parent?"Observation":e.parent||"DomainResource",baseDefinition:`http://hl7.org/fhir/StructureDefinition/${e.parent||"DomainResource"}`,derivation:"constraint",description:e.description||`Profile for ${e.name}`};e.rules.length>0&&(i.differential={element:e.rules.slice(0,2).map((e,s)=>({id:`${i.type}.${e.split(" ")[0]}`,path:`${i.type}.${e.split(" ")[0]}`,short:`Rule: ${e}`}))}),u.push({type:"StructureDefinition",filename:`StructureDefinition-${s}.json`,content:JSON.stringify(i,null,2),id:s,name:e.name,title:i.title,url:i.url}),o++,Z(`  \ud83d\udcca Generated StructureDefinition: ${e.name}`,"success")}catch(t){Z(`  \u274c Error generating StructureDefinition for ${e.name}: ${t.message}`,"error")}}for(const e of r.instances.slice(0,Math.min(1,c-o))){if(o>=c)break;try{const s=e.name.toLowerCase().replace(/\s+/g,"-"),i="Patient"===e.instanceOf?"Patient":"Observation"===e.instanceOf?"Observation":"Patient",t={resourceType:i,id:s,meta:{profile:e.instanceOf?[`${m.canonical}/StructureDefinition/${e.instanceOf}`]:void 0}};"Patient"===i&&(t.name=[{family:e.name.split(" ").pop(),given:e.name.split(" ").slice(0,-1)}]),u.push({type:i,filename:`${s}.json`,content:JSON.stringify(t,null,2),id:s,resourceType:i}),o++,Z(`  \ud83d\udcca Generated ${i} instance: ${e.name}`,"success")}catch(t){Z(`  \u274c Error generating instance for ${e.name}: ${t.message}`,"error")}}for(const e of r.valueSets.slice(0,Math.min(1,c-o))){if(o>=c)break;try{const s=e.id||e.name.toLowerCase().replace(/\s+/g,"-"),i={resourceType:"ValueSet",id:s,url:`${m.canonical}/ValueSet/${s}`,name:e.name,title:e.title||e.name,status:"draft",description:e.description||`ValueSet for ${e.name}`,compose:{include:[{system:"http://example.org/codes",concept:[{code:"example1",display:"Example Code 1"}]}]}};u.push({type:"ValueSet",filename:`ValueSet-${s}.json`,content:JSON.stringify(i,null,2),id:s,name:e.name,title:i.title,url:i.url}),o++,Z(`  \ud83d\udcca Generated ValueSet: ${e.name}`,"success")}catch(t){Z(`  \u274c Error generating ValueSet for ${e.name}: ${t.message}`,"error")}}e.isFromStaging&&Z("  \ud83c\udfd7\ufe0f File from staging ground","info"),p++,e.content=null,window.gc&&"function"===typeof window.gc&&window.gc()}await new Promise(e=>setTimeout(e,200));const i=n();if(Z(`\ud83d\udcbe Memory after file: ${i.toFixed(1)} MB (processed ${Math.min(e+v,d.length)}/${d.length})`,"info"),i>20){Z("\u26a0\ufe0f Stopping processing due to high memory usage","warning");break}}j(u);const y=n();Z(`\ud83d\udcbe Final memory usage: ${y.toFixed(1)} MB`,"info"),Z("\u2728 FSH compilation completed with crash prevention!","success"),Z(`\ud83d\udce6 Generated ${u.length} FHIR resources total (limited for stability)`,"success");const x=d.filter(e=>e.isFromStaging).length;return x>0&&Z(`\ud83c\udfd7\ufe0f ${x} file(s) from staging ground included`,"info"),0===d.length&&Z("\u26a0\ufe0f No FSH files found or all files too large to process safely","warning"),e||Z("\u26a0\ufe0f No sushi-config.yaml found - used default configuration","warning"),u.length>=f&&Z(`\u26a0\ufe0f Output limited to ${f} resources to prevent browser crashes`,"warning"),d.length<s.length&&Z(`\u26a0\ufe0f ${s.length-d.length} files skipped due to size limits`,"warning"),{success:!0,resourceCount:u.length,warnings:[],errors:[],generatedFiles:u}}catch(t){throw Z(`\u274c Compilation failed: ${t.message}`,"error"),t.stack&&console.error("Compilation error stack:",t.stack),t}},se=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];m(!0),p(!0),v([]),j([]),A("logs"),V(null),B(e);try{Z("\ud83c\udfc1 Starting SUSHI client-side execution...","info"),e&&l.length>0&&Z(`\ud83d\uddc2\ufe0f Including ${l.length} staging files`,"info");const{config:s,fshFiles:i}=await(async()=>{try{Z("\ud83d\udd0d Fetching sushi-config.yaml...","info");let s=null;try{s=await a.A.getFileContent(X,Y,"sushi-config.yaml",r),R(s),Z("\u2705 Found sushi-config.yaml","success")}catch(e){Z("\u26a0\ufe0f sushi-config.yaml not found in repository","warning")}Z("\ud83d\udd0d Scanning input/fsh directory recursively...","info");const i=[];try{const s=async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n>5)Z(`\u26a0\ufe0f Maximum directory depth reached for ${t}`,"warning");else try{const o=await a.A.getDirectoryContents(X,Y,t,r);for(const t of o)if("file"===t.type&&t.name.endsWith(".fsh"))try{const e=await a.A.getFileContent(X,Y,t.path,r);i.push({name:t.name,path:t.path,content:e}),Z(`\ud83d\udcc4 Found ${t.path}`,"success")}catch(e){Z(`\u274c Failed to fetch ${t.path}: ${e.message}`,"error")}else"dir"===t.type&&(Z(`\ud83d\udcc1 Scanning subdirectory: ${t.path}`,"info"),await s(t.path,n+1))}catch(e){Z(`\u26a0\ufe0f Could not scan directory ${t}: ${e.message}`,"warning")}};await s("input/fsh")}catch(e){Z("\u26a0\ufe0f input/fsh directory not found or empty","warning")}return E(i),Z(`\ud83d\udcca Found ${i.length} FSH files in repository`,"info"),{config:s,fshFiles:i}}catch(e){throw Z(`\u274c Error fetching repository files: ${e.message}`,"error"),e}})(),t=e?(e=>{const s=[...e];return l.forEach(e=>{if(e.path&&e.path.endsWith(".fsh")){const i=e.path.split("/").pop(),t=s.findIndex(e=>e.name===i);t>=0?(s[t]={...s[t],content:e.content,isFromStaging:!0},Z(`\ud83d\udd04 Overriding ${i} with staging version`,"info")):(s.push({name:i,path:e.path,content:e.content,isFromStaging:!0}),Z(`\u2795 Adding ${i} from staging`,"info"))}}),s})(i):i;e&&Z(`\ud83d\udcca Final file count: ${t.length} FSH files`,"info"),await(async(e,s)=>{try{const i="wasm"===G||"auto"===G&&z&&q,t=i?"WebAssembly":"JavaScript";let n;Z(`\ud83d\ude80 Starting FHIR Shorthand compilation using ${t}...`,"info"),S.startTiming("sushi-compilation",i?"wasm":"js"),i?(Z("\ud83d\udd27 Using WebAssembly SUSHI engine...","info"),n=await Q(e,s)):(Z("\u2699\ufe0f Using JavaScript fallback engine...","info"),n=await ee(e,s));const a=S.endTiming("sushi-compilation",i?"wasm":"js");return Z(`\u23f1\ufe0f Compilation completed in ${a.toFixed(2)}ms using ${t}`,"success"),n}catch(i){if(Z(`\u274c Compilation failed: ${i.message}`,"error"),"auto"===G&&z){Z("\ud83d\udd04 Attempting JavaScript fallback...","info");try{return await ee(e,s)}catch(t){throw Z(`\u274c JavaScript fallback also failed: ${t.message}`,"error"),t}}throw i}})(s,t),Z("\ud83c\udf89 SUSHI execution completed successfully!","success")}catch(s){V(s.message),Z(`\ud83d\udca5 Execution failed: ${s.message}`,"error")}finally{m(!1)}},ie=(0,t.useCallback)(e=>{W(s=>({...s,[e]:!s[e]}))},[]),te=(0,t.useCallback)(()=>{v([]),j([]),A("logs"),W({info:!0,success:!0,warning:!0,error:!0}),D("")},[]),ne=(0,t.useCallback)(async()=>{const e=g.map(e=>`[${new Date(e.timestamp).toLocaleTimeString()}] ${e.message}`).join("\n");try{await navigator.clipboard.writeText(e)}catch(s){console.error("Failed to copy logs:",s)}},[g]),ae=(0,t.useCallback)(async e=>{try{await navigator.clipboard.writeText(e)}catch(s){console.error("Failed to copy log message:",s)}},[]),re=(0,t.useCallback)((e,s)=>{const i=[...e.matchAll(/(?:^|\s)((?:input\/fsh\/[a-zA-Z0-9_/-]*\/)?[a-zA-Z0-9_.-]+\.(?:fsh|yaml|yml|json))(?=\s|$|[.,!])/g)];if(0===i.length)return(0,f.jsx)("span",{children:e});let t=0;const n=[];let a=0;return i.forEach((i,o)=>{const c=i[0],d=i[1],h=i.index;h>t&&n.push((0,f.jsx)("span",{children:e.substring(t,h)},`${s}-text-${a++}`));const m=c.substring(0,c.indexOf(d));m&&n.push((0,f.jsx)("span",{children:m},`${s}-ws-${a++}`));n.push(((e,i,t)=>{const n=T.some(s=>s.path===e),a=l.some(s=>s.path&&(s.path===e||s.path.endsWith(`/${e.split("/").pop()}`)));if(!n&&!a&&!("sushi-config.yaml"===e))return(0,f.jsx)("span",{className:"file-mention",children:i},`${s}-text-${t}`);if(a)return(0,f.jsxs)("span",{className:"file-link staging-link",title:"File from Staging Ground",children:["\ud83d\udcdd ",i]},`${s}-staging-${t}`);if(e.startsWith("input/fsh/")){const n=(e=>{const s=e.split("/");if(s.length>2){switch(s[2]){case"profiles":return{component:"Profiles",icon:"\ud83d\udc64"};case"examples":return{component:"Examples",icon:"\ud83d\udccb"};case"valuesets":return{component:"ValueSets",icon:"\ud83d\udcca"};case"codesystems":return{component:"CodeSystems",icon:"\ud83d\udd22"};case"extensions":return{component:"Extensions",icon:"\ud83d\udd27"};default:return{component:"FSH Files",icon:"\ud83d\udcc4"}}}return{component:"FSH Files",icon:"\ud83d\udcc4"}})(e);return(0,f.jsxs)("span",{className:"file-link dak-link",title:`View in DAK ${n.component}`,children:[n.icon," ",i]},`${s}-dak-${t}`)}{const n=`https://github.com/${X}/${Y}/blob/${r}/${e}`;return(0,f.jsxs)("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"file-link github-link",title:"Open in GitHub",children:["\ud83d\udd17 ",i]},`${s}-github-${t}`)}})(d,d,a++)),t=h+c.length}),t<e.length&&n.push((0,f.jsx)("span",{children:e.substring(t)},`${s}-text-end-${a++}`)),(0,f.jsx)("span",{children:n})},[X,Y,r,l,T]),oe=(0,t.useMemo)(()=>g.filter(e=>{const s=P[e.type],i=""===H||e.message.toLowerCase().includes(H.toLowerCase());return s&&i}),[g,P,H]),le=t.memo(e=>{let{logLevelToggles:s,onToggleLogLevel:i,searchText:n,onSearchChange:a,filteredCount:r,totalCount:o}=e;const l=(0,t.useCallback)(e=>{a(e.target.value)},[a]);return(0,f.jsxs)("div",{className:"log-controls",children:[(0,f.jsxs)("div",{className:"log-level-toggles",children:[(0,f.jsx)("label",{className:"toggle-group-label",children:"Show levels:"}),(0,f.jsx)("div",{className:"toggle-buttons",children:[{key:"info",label:"Info",icon:"\u2139\ufe0f"},{key:"success",label:"Success",icon:"\u2705"},{key:"warning",label:"Warning",icon:"\u26a0\ufe0f"},{key:"error",label:"Error",icon:"\u274c"}].map(e=>{let{key:t,label:n,icon:a}=e;return(0,f.jsxs)("button",{className:"log-toggle-btn "+(s[t]?"active":"inactive"),onClick:()=>i(t),title:`Toggle ${n} messages`,children:[a," ",n]},t)})})]}),(0,f.jsxs)("div",{className:"log-search-group",children:[(0,f.jsx)("label",{htmlFor:"log-search",children:"Search logs:"}),(0,f.jsx)("input",{id:"log-search",type:"text",value:n,onChange:l,placeholder:"Search log messages...",className:"log-search-input"})]}),(0,f.jsx)("div",{className:"log-stats",children:n||Object.values(s).some(e=>!e)?(0,f.jsxs)("span",{children:["Showing ",r," of ",o," logs"]}):(0,f.jsxs)("span",{children:[o," logs"]})})]})}),ce=(0,t.useCallback)(e=>{D(e)},[]),de=(0,t.useCallback)(e=>{M(e),$(!0)},[]),he=(0,t.useCallback)(()=>{$(!1),M(null)},[]),me=e=>{switch(e){case"StructureDefinition":return"\ud83c\udfd7\ufe0f";case"Patient":return"\ud83d\udc64";case"ValueSet":return"\ud83d\udcca";case"CodeSystem":return"\ud83d\udd22";case"Organization":return"\ud83c\udfe2";case"Practitioner":return"\ud83d\udc68\u200d\u2695\ufe0f";case"Observation":return"\ud83d\udccb";default:return"\ud83d\udcc4"}},ue=()=>F?(0,f.jsx)("div",{className:"file-viewer-overlay",children:(0,f.jsxs)("div",{className:"file-viewer-modal",children:[(0,f.jsxs)("div",{className:"file-viewer-header",children:[(0,f.jsxs)("h3",{children:[me(F.type)," ",F.filename]}),(0,f.jsxs)("div",{className:"file-viewer-actions",children:[(0,f.jsx)("button",{onClick:()=>navigator.clipboard.writeText(F.content),className:"copy-file-btn",title:"Copy file content to clipboard",children:"\ud83d\udccb Copy"}),(0,f.jsx)("button",{onClick:he,className:"close-file-viewer-btn",children:"\u2715"})]})]}),(0,f.jsx)("div",{className:"file-viewer-content",children:(0,f.jsx)(x.A,{language:"json",style:b.A,showLineNumbers:!0,wrapLines:!0,customStyle:{fontSize:"14px",lineHeight:"1.4",maxHeight:"70vh",overflow:"auto"},children:F.content})}),(0,f.jsx)("div",{className:"file-viewer-footer",children:(0,f.jsxs)("span",{className:"file-info",children:["Resource Type: ",F.type," | Size: ",(F.content.length/1024).toFixed(1)," KB"]})})]})}):null,pe=()=>(0,f.jsx)("div",{className:"sushi-modal-overlay",children:(0,f.jsxs)("div",{className:"sushi-modal",children:[(0,f.jsxs)("div",{className:"sushi-modal-header",children:[(0,f.jsxs)("h3",{children:["\ud83c\udf63 SUSHI Client-Side Execution",O&&(0,f.jsx)("span",{className:"staging-badge",children:"+ Staging"})]}),(0,f.jsxs)("div",{className:"modal-actions",children:[(0,f.jsx)("button",{onClick:ne,className:"copy-all-btn",disabled:0===g.length,title:"Copy all logs to clipboard",children:"\ud83d\udccb Copy All"}),(0,f.jsx)("button",{onClick:te,className:"clear-logs-btn",disabled:h,children:"\ud83d\uddd1\ufe0f Clear"}),(0,f.jsx)("button",{onClick:()=>p(!1),className:"close-modal-btn",children:"\u2715"})]})]}),(0,f.jsx)(le,{logLevelToggles:P,onToggleLogLevel:ie,searchText:H,onSearchChange:ce,filteredCount:oe.length,totalCount:g.length}),y.length>0&&(0,f.jsxs)("div",{className:"modal-section-toggle",children:[(0,f.jsxs)("div",{className:"toggle-options",children:[(0,f.jsx)("button",{className:"toggle-btn "+("logs"===I?"active":""),onClick:()=>A("logs"),children:"\ud83d\udcc4 Logs & Messages"}),(0,f.jsx)("button",{className:"toggle-btn "+("files"===I?"active":""),onClick:()=>A("files"),children:"\ud83d\udce6 Generated Resources"})]}),(0,f.jsx)("div",{className:"section-info",children:"logs"===I?(0,f.jsxs)("span",{className:"info-text",children:[g.length," log entries \u2022 Use toggles to filter by level"]}):(0,f.jsxs)("span",{className:"info-text",children:[y.length," FHIR resources generated"]})})]}),(0,f.jsxs)("div",{className:"sushi-modal-content",children:[("logs"===I||0===y.length)&&(0,f.jsxs)("div",{className:"log-container",children:[oe.map(e=>(0,f.jsxs)("div",{className:`log-entry log-${e.type}`,children:[(0,f.jsx)("span",{className:"log-timestamp",children:new Date(e.timestamp).toLocaleTimeString()}),(0,f.jsx)("span",{className:"log-message",children:re(e.message,e.id)}),(0,f.jsx)("button",{onClick:()=>ae(e.message),className:"copy-log-btn",title:"Copy this message to clipboard",children:"\ud83d\udccb"})]},e.id)),h&&(0,f.jsxs)("div",{className:"log-entry log-running",children:[(0,f.jsx)("span",{className:"log-timestamp",children:(new Date).toLocaleTimeString()}),(0,f.jsxs)("span",{className:"log-message",children:[(0,f.jsx)("span",{className:"spinner",children:"\u23f3"})," Processing..."]}),(0,f.jsx)("div",{className:"copy-log-btn-placeholder"})]}),0===oe.length&&!h&&g.length>0&&(0,f.jsx)("div",{className:"log-placeholder",children:"No logs match the current filter criteria..."}),0===g.length&&!h&&(0,f.jsx)("div",{className:"log-placeholder",children:"Logs will appear here during SUSHI execution..."}),_&&(0,f.jsxs)("div",{className:"error-summary",children:[(0,f.jsx)("h4",{children:"\u274c Execution Error"}),(0,f.jsx)("p",{children:_})]})]}),"files"===I&&y.length>0&&(0,f.jsx)("div",{className:"generated-files-container",children:(0,f.jsxs)("div",{className:"generated-files-section",children:[(0,f.jsxs)("h4",{children:["\ud83d\udce6 Generated FHIR Resources (",y.length,")"]}),(0,f.jsx)("div",{className:"generated-files-grid",children:y.map((e,s)=>(0,f.jsxs)("div",{className:"generated-file-card",children:[(0,f.jsxs)("div",{className:"file-card-header",children:[(0,f.jsx)("span",{className:"file-icon",children:me(e.type)}),(0,f.jsx)("span",{className:"file-name",children:e.filename})]}),(0,f.jsxs)("div",{className:"file-card-details",children:[(0,f.jsx)("span",{className:"file-type",children:e.type}),(0,f.jsxs)("span",{className:"file-size",children:[(e.content.length/1024).toFixed(1)," KB"]})]}),(0,f.jsxs)("div",{className:"file-card-actions",children:[(0,f.jsx)("button",{onClick:()=>de(e),className:"view-file-btn",title:"View resource content",children:"\ud83d\udc41\ufe0f View"}),(0,f.jsx)("button",{onClick:()=>navigator.clipboard.writeText(e.content),className:"copy-file-btn",title:"Copy to clipboard",children:"\ud83d\udccb"})]})]},s))}),(0,f.jsxs)("div",{className:"fhir-viewer-suggestions",children:[(0,f.jsx)("h5",{children:"\ud83d\udca1 Enhanced FHIR Viewing Options"}),(0,f.jsx)("p",{children:"For better FHIR resource visualization, consider these viewers:"}),(0,f.jsxs)("ul",{children:[(0,f.jsxs)("li",{children:[(0,f.jsx)("strong",{children:"FHIR Tree Viewer:"})," ",(0,f.jsx)("code",{children:"npm install @types/fhir"})," + custom tree renderer"]}),(0,f.jsxs)("li",{children:[(0,f.jsx)("strong",{children:"FHIR Path Viewer:"})," ",(0,f.jsx)("code",{children:"npm install fhirpath"})," for interactive querying"]}),(0,f.jsxs)("li",{children:[(0,f.jsx)("strong",{children:"FHIR UI:"})," ",(0,f.jsx)("code",{children:"npm install @asymmetrik/fhir-kit-client"})," with UI components"]}),(0,f.jsxs)("li",{children:[(0,f.jsx)("strong",{children:"HL7 FHIR Viewer:"})," Integration with official HL7 FHIR viewers"]})]})]})]})})]}),(0,f.jsx)("div",{className:"sushi-modal-footer",children:(0,f.jsx)("div",{className:"execution-info",children:h?(0,f.jsx)("span",{className:"status-running",children:"\ud83d\udd04 Running SUSHI..."}):g.length>0?(0,f.jsx)("span",{className:"status-complete",children:"\u2705 Execution complete"}):(0,f.jsx)("span",{className:"status-ready",children:"\ud83c\udf63 Ready to run SUSHI"})})})]})});return(0,f.jsx)(C,{children:(0,f.jsxs)("div",{className:"sushi-runner-section",children:[(0,f.jsxs)("div",{className:"sushi-status-bar "+(c?"expanded":"collapsed"),onClick:()=>d(!c),children:[(0,f.jsxs)("div",{className:"status-bar-header",children:[(0,f.jsx)("span",{className:"status-icon",children:"\ud83c\udf63"}),(0,f.jsx)("span",{className:"status-title",children:"SUSHI (FHIR Shorthand)"}),(0,f.jsx)("span",{className:"expand-icon",children:c?"\u25bc":"\u25b6"})]}),!c&&(0,f.jsx)("div",{className:"status-summary",children:"Client-side FHIR Implementation Guide compilation"})]}),c&&(0,f.jsxs)("div",{className:"sushi-controls",children:[(0,f.jsx)("div",{className:"sushi-description",children:(0,f.jsx)("p",{children:"Run SUSHI (FHIR Shorthand) compilation directly in your browser to generate FHIR Implementation Guide resources from FSH files."})}),(0,f.jsxs)("div",{className:"execution-options",children:[(0,f.jsxs)("div",{className:"execution-mode-selector",children:[(0,f.jsx)("h4",{children:"\u2699\ufe0f Execution Mode"}),(0,f.jsxs)("div",{className:"mode-options",children:[(0,f.jsxs)("label",{className:"mode-option",children:[(0,f.jsx)("input",{type:"radio",name:"executionMode",value:"auto",checked:"auto"===G,onChange:e=>U(e.target.value)}),(0,f.jsxs)("span",{className:"mode-label",children:["\ud83e\udd16 Auto (WebAssembly when available)",z&&q&&(0,f.jsx)("span",{className:"wasm-badge",children:"WASM Ready"})]})]}),z&&(0,f.jsxs)("label",{className:"mode-option",children:[(0,f.jsx)("input",{type:"radio",name:"executionMode",value:"wasm",checked:"wasm"===G,onChange:e=>U(e.target.value),disabled:!q}),(0,f.jsxs)("span",{className:"mode-label",children:["\ud83d\ude80 WebAssembly (High Performance)",!q&&(0,f.jsx)("span",{className:"loading-badge",children:"Initializing..."})]})]}),(0,f.jsxs)("label",{className:"mode-option",children:[(0,f.jsx)("input",{type:"radio",name:"executionMode",value:"javascript",checked:"javascript"===G,onChange:e=>U(e.target.value)}),(0,f.jsx)("span",{className:"mode-label",children:"\u2699\ufe0f JavaScript (Fallback)"})]})]}),!z&&(0,f.jsx)("div",{className:"wasm-not-supported",children:(0,f.jsx)("p",{children:"\u26a0\ufe0f WebAssembly is not supported in this browser. JavaScript fallback will be used."})})]}),(0,f.jsxs)("div",{className:"option-group",children:[(0,f.jsx)("h4",{children:"\ud83d\udcc2 Repository Files Only"}),(0,f.jsxs)("p",{children:["Compile using sushi-config.yaml and input/fsh files from the GitHub repository (",r," branch)."]}),(0,f.jsx)("button",{className:"run-sushi-btn primary",onClick:()=>se(!1),disabled:h,children:h?"\u23f3 Running...":"\ud83d\ude80 Run SUSHI"})]}),l.length>0&&(0,f.jsxs)("div",{className:"option-group",children:[(0,f.jsx)("h4",{children:"\ud83c\udfd7\ufe0f Repository + Staging Files"}),(0,f.jsxs)("p",{children:["Compile using repository files, with staging ground files (",l.length," files) overriding any repository files with the same name."]}),(0,f.jsx)("button",{className:"run-sushi-btn secondary",onClick:()=>se(!0),disabled:h,children:h?"\u23f3 Running...":"\ud83d\ude80 Run SUSHI + Staging"})]})]}),(0,f.jsxs)("div",{className:"sushi-status",children:[(0,f.jsxs)("div",{className:"status-item",children:[(0,f.jsx)("span",{className:"label",children:"Execution:"}),(0,f.jsx)("span",{className:"value",children:z&&q?"\ud83d\ude80 WebAssembly Ready":"\u2699\ufe0f JavaScript"})]}),(0,f.jsxs)("div",{className:"status-item",children:[(0,f.jsx)("span",{className:"label",children:"Config:"}),(0,f.jsx)("span",{className:"value",children:L?"\u2705 Found":"\u2753 Unknown"})]}),(0,f.jsxs)("div",{className:"status-item",children:[(0,f.jsx)("span",{className:"label",children:"FSH Files:"}),(0,f.jsxs)("span",{className:"value",children:[T.length," in repository"]})]}),l.length>0&&(0,f.jsxs)("div",{className:"status-item",children:[(0,f.jsx)("span",{className:"label",children:"Staging:"}),(0,f.jsxs)("span",{className:"value",children:[l.filter(e=>e.path&&e.path.endsWith(".fsh")).length," FSH files"]})]})]})]}),u&&(0,f.jsx)(pe,{}),k&&(0,f.jsx)(ue,{})]})})},F=e=>{var s;let{profile:i,repository:n,selectedBranch:r,hasWriteAccess:o}=e;const[l,c]=(0,t.useState)([]),[d,h]=(0,t.useState)([]),[m,u]=(0,t.useState)({}),[p,g]=(0,t.useState)(!0),[v,x]=(0,t.useState)(null),[b,j]=(0,t.useState)([]),w=(null===(s=n.owner)||void 0===s?void 0:s.login)||n.full_name.split("/")[0],N=n.name;(0,t.useEffect)(()=>{(async()=>{try{if(g(!0),x(null),null!==i&&void 0!==i&&i.isDemo){c([{name:"main",commit:{sha:"abc123"}},{name:"feature/updates",commit:{sha:"def456"}},{name:"dev",commit:{sha:"ghi789"}}]);h([{id:"pages-build",name:"Deploy to GitHub Pages",triggers:["push","manual"]}]);const e={main:{status:"completed",conclusion:"success",html_url:`https://github.com/${w}/${N}/actions/runs/123456`,updated_at:(new Date).toISOString()},"feature/updates":{status:"completed",conclusion:"action_required",html_url:`https://github.com/${w}/${N}/actions/runs/123457`,updated_at:(new Date).toISOString()},dev:{status:"completed",conclusion:"failure",html_url:`https://github.com/${w}/${N}/actions/runs/123458`,updated_at:(new Date).toISOString()}};return u(e),void g(!1)}const s=(await a.A.getBranches(w,N)).filter(e=>"gh-pages"!==e.name);c(s);const t=await a.A.getWorkflows(w,N);h(t);const n=t.find(e=>e.name.toLowerCase().includes("build")||e.name.toLowerCase().includes("publish")||e.name.toLowerCase().includes("pages"));if(n&&n.id){const i={};for(const t of s)try{const e=await a.A.getWorkflowRunsForWorkflow(w,N,n.id,{branch:t.name,per_page:1});e.length>0&&(i[t.name]=e[0])}catch(e){console.warn(`Could not fetch workflow runs for branch ${t.name}:`,e)}u(i)}else n&&!n.id&&console.warn("Found workflow but missing ID:",n);g(!1)}catch(e){console.error("Error fetching publication data:",e),x("Failed to load publication data"),g(!1)}})()},[w,N,null===i||void 0===i?void 0:i.isDemo]);return p?(0,f.jsx)("div",{className:"publications-loading",children:(0,f.jsxs)("div",{className:"loading-content",children:[(0,f.jsx)("h3",{children:"Loading Publications..."}),(0,f.jsx)("p",{children:"Fetching branch and workflow information..."})]})}):v?(0,f.jsx)("div",{className:"publications-error",children:(0,f.jsxs)("div",{className:"error-content",children:[(0,f.jsx)("h3",{children:"Error Loading Publications"}),(0,f.jsx)("p",{children:v})]})}):(0,f.jsxs)("div",{className:"publications-section",children:[(0,f.jsx)($,{repository:n,selectedBranch:r,profile:i,stagingFiles:b}),(0,f.jsx)(y,{repository:n,selectedBranch:r,hasWriteAccess:o,profile:i,onStagingFilesChange:j}),(0,f.jsxs)("div",{className:"section-header",children:[(0,f.jsx)("h3",{className:"section-title",children:"Published DAK Content"}),(0,f.jsx)("p",{className:"section-description",children:"Access published Implementation Guide content for this DAK repository. Each branch is published automatically via GitHub Actions to GitHub Pages."})]}),(0,f.jsx)("div",{className:"publications-grid",children:l.map(e=>{const s=e.name===n.default_branch||"main"===e.name,t=(r=e.name)===n.default_branch||"main"===r?`https://${w}.github.io/${N}/`:`https://${w}.github.io/${N}/branches/${r}/`;var r;const l=(e=>{const s=m[e];if(!s)return{icon:"\u26aa",title:"No recent workflow runs",link:null};const i=s.status,t=s.conclusion;return"in_progress"===i||"queued"===i?{icon:"\ud83d\udd04",title:"Workflow running",link:s.html_url,className:"running"}:"success"===t?{icon:"\u2705",title:"Last build successful",link:s.html_url,className:"success"}:"failure"===t?{icon:"\u274c",title:"Last build failed",link:s.html_url,className:"failure"}:"action_required"===t?{icon:"\u23f3",title:"Workflow requires approval",link:s.html_url,className:"approval-required"}:{icon:"\u26a0\ufe0f",title:`Build ${t||i}`,link:s.html_url,className:"warning"}})(e.name);return(0,f.jsxs)("div",{className:"publication-card "+(s?"main-branch":""),children:[(0,f.jsxs)("div",{className:"publication-header",children:[(0,f.jsxs)("div",{className:"branch-info",children:[(0,f.jsx)("span",{className:"branch-icon",children:"\ud83c\udf3f"}),(0,f.jsx)("span",{className:"branch-name",children:e.name}),s&&(0,f.jsx)("span",{className:"main-badge",children:"MAIN"})]}),(0,f.jsx)("div",{className:"workflow-status",children:l.link?(0,f.jsx)("a",{href:l.link,target:"_blank",rel:"noopener noreferrer",className:`status-icon ${l.className||""}`,title:l.title,children:l.icon}):(0,f.jsx)("span",{className:`status-icon ${l.className||""}`,title:l.title,children:l.icon})})]}),(0,f.jsxs)("div",{className:"publication-content",children:[(0,f.jsxs)("div",{className:"publication-url",children:[(0,f.jsx)("label",{children:"Published at:"}),(0,f.jsxs)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"publication-link",children:[t,(0,f.jsx)("span",{className:"external-link",children:"\u2197"})]})]}),(0,f.jsxs)("div",{className:"publication-actions",children:[(0,f.jsx)("button",{className:"restart-workflow-btn",onClick:()=>(async e=>{if(null!==i&&void 0!==i&&i.isDemo)return void alert(`Demo Mode: Workflow restart simulated for branch: ${e}`);const s=d.find(e=>e.name.toLowerCase().includes("build")||e.name.toLowerCase().includes("publish")||e.name.toLowerCase().includes("pages"));if(s){if(!s.id)return alert("Workflow found but missing ID - cannot restart"),void console.warn("Workflow missing ID:",s);try{await a.A.triggerWorkflow(w,N,s.id,e),alert(`Workflow restarted for branch: ${e}`),setTimeout(()=>{window.location.reload()},2e3)}catch(t){console.error("Error restarting workflow:",t),alert("Failed to restart workflow. Please check your permissions.")}}else alert("No suitable workflow found to restart")})(e.name),disabled:!o,title:o?"Restart build workflow for this branch":"Write permissions required",children:"\ud83d\udd04 Rebuild"}),(0,f.jsx)("a",{href:`https://github.com/${w}/${N}/tree/${e.name}`,target:"_blank",rel:"noopener noreferrer",className:"view-source-btn",title:"View source code for this branch",children:"\ud83d\udc41\ufe0f View Source"})]})]})]},e.name)})}),0===l.length&&(0,f.jsx)("div",{className:"no-branches",children:(0,f.jsx)("p",{children:"No publishable branches found (excluding gh-pages)."})})]})};var M=i(29615),I=i(13333);const A=e=>{let{profile:s,repository:i,selectedBranch:n}=e;const r=(0,M.Zp)(),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)([]),[h,m]=(0,t.useState)(!0),[u,p]=(0,t.useState)(null),[g,v]=(0,t.useState)(null),y=t.useCallback(()=>i?`sgex_fork_status_${i.full_name}`:null,[i]);(0,t.useEffect)(()=>{const e=y();if(e){const s=sessionStorage.getItem(e);null!==s&&l(JSON.parse(s))}},[y]);(0,t.useEffect)(()=>{(async()=>{if(i){m(!0),p(null);try{let s=i;if(!i.parent&&(!0===i.fork||void 0===i.fork))try{s=await a.A.getRepository(i.owner.login,i.name)}catch(e){console.warn("Could not fetch full repository details:",e)}s.fork&&s.parent&&v(s.parent);const t=await a.A.getRepositoryForks(i.owner.login,i.name);d(t)}catch(s){console.error("Error fetching repository information:",s),p(s.message)}finally{m(!1)}}})()},[i]);const x=e=>`/dashboard/${e.owner.login}/${e.name}/${e.default_branch||"main"}`,b=e=>{if(!g)return;const s=x(g),i={profile:{login:g.owner.login,name:g.owner.login,avatar_url:g.owner.avatar_url,type:g.owner.type},repository:g,selectedBranch:g.default_branch||"main"};(0,I.hX)(e,s,r,i)};return!i||h?(0,f.jsx)("div",{className:"fork-status-bar loading",children:(0,f.jsxs)("div",{className:"fork-status-header",children:[(0,f.jsxs)("div",{className:"fork-badge-placeholder",children:[(0,f.jsx)("span",{className:"fork-icon",children:"\ud83c\udf74"}),(0,f.jsx)("span",{className:"fork-count",children:"..."})]}),(0,f.jsx)("span",{className:"fork-status-title",children:"Loading repository info..."})]})}):u?(0,f.jsx)("div",{className:"fork-status-bar error",children:(0,f.jsxs)("div",{className:"fork-status-header",children:[(0,f.jsxs)("div",{className:"fork-badge",children:[(0,f.jsx)("span",{className:"fork-icon",children:"\ud83c\udf74"}),(0,f.jsx)("span",{className:"fork-count",children:"?"})]}),(0,f.jsx)("span",{className:"fork-status-title",children:"Unable to load repository info"})]})}):(0,f.jsxs)("div",{className:"fork-status-bar "+(o?"expanded":"collapsed"),children:[(0,f.jsxs)("div",{className:"fork-status-header",onClick:()=>{const e=!o;l(e);const s=y();s&&sessionStorage.setItem(s,JSON.stringify(e))},children:[(0,f.jsxs)("div",{className:"fork-badge",children:[(0,f.jsx)("span",{className:"fork-icon",children:"\ud83c\udf74"}),(0,f.jsx)("span",{className:"fork-count",children:c.length})]}),(0,f.jsx)("span",{className:"fork-status-title",children:g?(0,f.jsxs)(f.Fragment,{children:["Fork of"," ",(0,f.jsxs)("span",{className:"parent-repo-link",onClick:e=>{e.stopPropagation(),b(e)},children:[g.owner.login,"/",g.name]}),c.length>0&&(0,f.jsxs)(f.Fragment,{children:[" \u2022 ",c.length," fork",1!==c.length?"s":""]})]}):(0,f.jsxs)(f.Fragment,{children:[c.length," fork",1!==c.length?"s":""," of ",(null===i||void 0===i?void 0:i.name)||"repository"]})}),(0,f.jsx)("button",{className:"fork-toggle-btn","aria-label":o?"Collapse":"Expand",children:(0,f.jsx)("span",{className:"toggle-icon "+(o?"expanded":""),children:"\u25bc"})})]}),o&&(0,f.jsxs)("div",{className:"fork-list",children:[g&&(0,f.jsxs)("div",{className:"parent-section",children:[(0,f.jsx)("h4",{className:"section-title",children:"Parent Repository"}),(0,f.jsxs)("div",{className:"fork-item parent-item",onClick:e=>b(e),children:[(0,f.jsx)("div",{className:"fork-avatar",children:(0,f.jsx)("img",{src:g.owner.avatar_url,alt:g.owner.login,className:"fork-owner-avatar"})}),(0,f.jsxs)("div",{className:"fork-info",children:[(0,f.jsxs)("div",{className:"fork-name",children:[(0,f.jsxs)("strong",{children:[g.owner.login,"/",g.name]}),(0,f.jsx)("span",{className:"parent-badge",children:"Parent"})]}),(0,f.jsx)("div",{className:"fork-description",children:g.description||"No description available"}),(0,f.jsxs)("div",{className:"fork-stats",children:[(0,f.jsxs)("span",{className:"fork-stat",children:["\u2b50 ",g.stargazers_count]}),(0,f.jsxs)("span",{className:"fork-stat",children:["\ud83d\udcdd ",g.open_issues_count," issues"]}),(0,f.jsxs)("span",{className:"fork-stat",children:["\ud83d\udcc5 Updated ",new Date(g.updated_at).toLocaleDateString()]})]})]}),(0,f.jsx)("div",{className:"fork-actions",children:(0,f.jsx)("span",{className:"fork-link-hint",children:"Click to view DAK \u2192"})})]})]}),0===c.length?!g&&(0,f.jsx)("div",{className:"no-forks",children:(0,f.jsx)("p",{children:"No forks found for this repository."})}):(0,f.jsxs)("div",{className:"forks-section",children:[g&&(0,f.jsxs)("h4",{className:"section-title",children:["Forks (",c.length,")"]}),(0,f.jsx)("div",{className:"fork-items",children:c.map(e=>(0,f.jsxs)("div",{className:"fork-item",onClick:s=>((e,s)=>{const i=x(s),t={profile:{login:s.owner.login,name:s.owner.login,avatar_url:s.owner.avatar_url,type:s.owner.type},repository:s,selectedBranch:s.default_branch||"main"};(0,I.hX)(e,i,r,t)})(s,e),children:[(0,f.jsx)("div",{className:"fork-avatar",children:(0,f.jsx)("img",{src:e.owner.avatar_url,alt:e.owner.login,className:"fork-owner-avatar"})}),(0,f.jsxs)("div",{className:"fork-info",children:[(0,f.jsx)("div",{className:"fork-name",children:(0,f.jsxs)("strong",{children:[e.owner.login,"/",e.name]})}),(0,f.jsx)("div",{className:"fork-description",children:e.description||"No description available"}),(0,f.jsxs)("div",{className:"fork-stats",children:[(0,f.jsxs)("span",{className:"fork-stat",children:["\u2b50 ",e.stargazers_count]}),(0,f.jsxs)("span",{className:"fork-stat",children:["\ud83d\udcdd ",e.open_issues_count," issues"]}),(0,f.jsxs)("span",{className:"fork-stat",children:["\ud83d\udcc5 Updated ",new Date(e.updated_at).toLocaleDateString()]})]})]}),(0,f.jsx)("div",{className:"fork-actions",children:(0,f.jsx)("span",{className:"fork-link-hint",children:"Click to view DAK \u2192"})})]},e.id))})]})]})]})},P=()=>{const{profile:e,repository:s,branch:i,navigate:l}=(0,n.oc)(),[c,d]=(0,t.useState)(!1),[h,m]=(0,t.useState)(!1),[u,p]=(0,t.useState)("core"),[g,v]=(0,t.useState)({});(0,t.useEffect)(()=>{(async()=>{if(s&&a.A.isAuth())try{const e=await a.A.checkRepositoryPermissions(s.owner.login,s.name);d(e)}catch(e){console.error("Error checking repository permissions:",e),d(!1)}else d(!1)})()},[s]),(0,t.useEffect)(()=>{e&&s&&i&&r.default.setBranchContext(e.login,s.name,i)},[e,s,i]),(0,t.useEffect)(()=>{(async()=>{if(s&&a.A.isAuth())try{const e=await a.A.getRepositoryIssues(s.owner.login,s.name),i={};e.forEach(e=>{e.labels.forEach(e=>{i[e.name]=(i[e.name]||0)+1})}),v(i)}catch(e){console.warn("Could not fetch issue counts:",e)}})()},[s]);const y=t=>{e&&s&&l(`/${t}/${e.login}/${s.name}/${i}`,{state:{profile:e,repository:s,selectedBranch:i}})},x=[{id:"health-interventions",title:"Health Interventions and Recommendations",description:"Clinical guidelines and health intervention specifications that define evidence-based care recommendations",icon:"\ud83d\udcd6",path:"health-interventions",level:"Level 2: Core Components",color:"#0078d4"},{id:"generic-personas",title:"Generic Personas",description:"Standardized user roles and actor definitions that represent different types of healthcare workers and patients",icon:"\ud83d\udc65",path:"actor-editor",level:"Level 2: Core Components",color:"#107c10"},{id:"user-scenarios",title:"User Scenarios",description:"Narrative descriptions of how different personas interact with the system in specific healthcare contexts",icon:"\ud83d\udcdd",path:"user-scenarios",level:"Level 2: Core Components",color:"#881798"},{id:"business-processes",title:"Generic Business Processes and Workflows",description:"BPMN workflows and business process definitions that model clinical workflows and care pathways",icon:"\ud83d\udd04",path:"business-process-selection",level:"Level 2: Core Components",color:"#d13438"},{id:"core-data-elements",title:"Core Data Elements",description:"Essential data structures and terminology needed for clinical data capture and exchange",icon:"\ud83d\uddc3\ufe0f",path:"core-data-dictionary-viewer",level:"Level 2: Core Components",color:"#ff8c00"},{id:"decision-support",title:"Decision-Support Logic",description:"DMN decision tables and clinical decision support rules that encode clinical logic",icon:"\ud83c\udfaf",path:"decision-support-logic",level:"Level 2: Core Components",color:"#00bcf2"},{id:"program-indicators",title:"Program Indicators",description:"Performance indicators and measurement definitions for monitoring and evaluation",icon:"\ud83d\udcca",path:"program-indicators",level:"Level 2: Core Components",color:"#498205"},{id:"functional-requirements",title:"Functional and Non-Functional Requirements",description:"System requirements specifications that define capabilities and constraints",icon:"\u2699\ufe0f",path:"functional-requirements",level:"Level 2: Core Components",color:"#6b69d6"},{id:"testing",title:"Testing",description:"Feature files and test scenarios for validating the DAK implementation",icon:"\ud83e\uddea",path:"testing-viewer",level:"Level 2: Core Components",color:"#8b5cf6"},{id:"terminology",title:"Terminology",description:"Code systems, value sets, and concept maps",icon:"\ud83c\udff7\ufe0f",path:"terminology",level:"Level 3: Technical Implementation",color:"#ff8c00"},{id:"profiles",title:"FHIR Profiles",description:"FHIR resource profiles and constraints",icon:"\ud83d\udd27",path:"profiles",level:"Level 3: Technical Implementation",color:"#00bcf2"},{id:"extensions",title:"FHIR Extensions",description:"Custom FHIR extensions and modifications",icon:"\ud83e\udde9",path:"extensions",level:"Level 3: Technical Implementation",color:"#498205"},{id:"test-data",title:"Test Data & Examples",description:"Sample data and testing resources",icon:"\ud83e\uddea",path:"test-data",level:"Level 3: Technical Implementation",color:"#8b5cf6"}],b=x.filter(e=>e.level.includes("Level 2: Core Components")),j=x.filter(e=>e.level.includes("Level 3: Technical Implementation"));return(0,f.jsxs)("div",{className:"dak-dashboard",children:[(0,f.jsx)("div",{className:"dashboard-header",children:(0,f.jsxs)("div",{className:"dashboard-title",children:[(0,f.jsxs)("h1",{children:[null===s||void 0===s?void 0:s.name," Dashboard"]}),(0,f.jsxs)("p",{className:"dashboard-subtitle",children:["Digital Adaptation Kit for ",(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.login)]})]})}),(0,f.jsx)(A,{profile:e,repository:s,selectedBranch:i}),s&&(0,f.jsx)(o.A,{repository:s,profile:e,selectedBranch:i,issueCounts:g}),(0,f.jsxs)("div",{className:"tab-navigation",children:[(0,f.jsxs)("button",{className:"tab-button "+("core"===u?"active":""),onClick:()=>p("core"),children:[(0,f.jsx)("span",{className:"tab-icon",children:"\u2b50"}),(0,f.jsx)("span",{className:"tab-text",children:"9 Core Components"})]}),(0,f.jsxs)("button",{className:"tab-button "+("additional"===u?"active":""),onClick:()=>p("additional"),children:[(0,f.jsx)("span",{className:"tab-icon",children:"\ud83d\udd27"}),(0,f.jsxs)("span",{className:"tab-text",children:["Additional Components (",j.length,")"]})]}),(0,f.jsxs)("button",{className:"tab-button "+("publications"===u?"active":""),onClick:()=>p("publications"),children:[(0,f.jsx)("span",{className:"tab-icon",children:"\ud83d\udcda"}),(0,f.jsx)("span",{className:"tab-text",children:"Publications"})]})]}),(0,f.jsxs)("div",{className:"dashboard-content",children:["core"===u&&(0,f.jsx)("div",{className:"components-grid core-components",children:b.map(e=>(0,f.jsxs)("div",{className:"component-card",onClick:()=>y(e.path),children:[(0,f.jsx)("div",{className:"component-icon",children:e.icon}),(0,f.jsx)("h3",{children:e.title}),(0,f.jsx)("p",{children:e.description}),g[e.id]>0&&(0,f.jsxs)("div",{className:"issue-badge",children:[g[e.id]," issues"]})]},e.id))}),"additional"===u&&(0,f.jsx)("div",{className:"components-grid additional-components",children:j.map(e=>(0,f.jsxs)("div",{className:"component-card",onClick:()=>y(e.path),children:[(0,f.jsx)("div",{className:"component-icon",children:e.icon}),(0,f.jsx)("h3",{children:e.title}),(0,f.jsx)("p",{children:e.description}),g[e.id]>0&&(0,f.jsxs)("div",{className:"issue-badge",children:[g[e.id]," issues"]})]},e.id))}),"publications"===u&&(0,f.jsx)("div",{className:"publications-section",children:(0,f.jsx)(F,{repository:s,profile:e,selectedBranch:i,onNavigate:()=>{e&&s&&l(`/publications/${e.login}/${s.name}/${i}`,{state:{profile:e,repository:s,selectedBranch:i}})}})})]}),h&&(0,f.jsxs)("div",{className:"permission-dialog",children:[(0,f.jsx)("div",{className:"dialog-overlay",onClick:()=>m(!1)}),(0,f.jsxs)("div",{className:"dialog-content",children:[(0,f.jsx)("h3",{children:"Repository Permissions"}),(0,f.jsxs)("p",{children:["You have ",c?"write":"read-only"," access to this repository.",!c&&" You can view content but cannot make changes."]}),(0,f.jsx)("button",{onClick:()=>m(!1),children:"Got it"})]})]})]})},W=()=>(0,f.jsx)(n.Mx,{pageName:"dashboard",children:(0,f.jsx)(P,{})})},44131:e=>{e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://sgex.org/schemas/sushi-config.json","title":"SUSHI Configuration Schema","description":"JSON Schema for validating sushi-config.yaml files used in FHIR Implementation Guides","type":"object","required":["id","canonical","name","status","publisher","version"],"properties":{"id":{"type":"string","pattern":"^[a-z0-9]+(\\\\.[a-z0-9]+)*$","description":"The unique identifier for the Implementation Guide (IG). Must be lowercase alphanumeric with dots."},"canonical":{"type":"string","format":"uri","description":"The canonical URL for the Implementation Guide"},"name":{"type":"string","minLength":1,"description":"The human-readable name of the Implementation Guide"},"title":{"type":"string","description":"The title of the Implementation Guide (optional, defaults to name)"},"description":{"type":"string","description":"A description of the Implementation Guide"},"status":{"type":"string","enum":["draft","active","retired","unknown"],"description":"The publication status of the Implementation Guide"},"version":{"type":"string","pattern":"^\\\\d+\\\\.\\\\d+\\\\.\\\\d+(-[a-zA-Z0-9]+)?$","description":"The version of the Implementation Guide (semantic versioning)"},"fhirVersion":{"type":"string","enum":["4.0.1","4.3.0","5.0.0"],"default":"4.0.1","description":"The version of FHIR to use"},"copyrightYear":{"type":"integer","minimum":1900,"maximum":3000,"description":"The copyright year"},"releaseLabel":{"type":"string","description":"Label for the release"},"publisher":{"type":"string","minLength":1,"description":"The publisher of the Implementation Guide"},"contact":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string"},"telecom":{"type":"array","items":{"type":"object","properties":{"system":{"type":"string","enum":["phone","fax","email","pager","url","sms","other"]},"value":{"type":"string"},"use":{"type":"string","enum":["home","work","temp","old","mobile"]}}}}}},"description":"Contact information for the Implementation Guide"},"license":{"type":"string","enum":["not-open-source","0BSD","AAL","Abstyles","Adobe-2006","Adobe-Glyph","ADSL","AFL-1.1","CC0-1.0"],"description":"The license under which the Implementation Guide is published"},"jurisdiction":{"type":"array","items":{"type":"object","properties":{"coding":{"type":"array","items":{"type":"object","properties":{"system":{"type":"string","format":"uri"},"code":{"type":"string"},"display":{"type":"string"}}}}}},"description":"Jurisdiction for the Implementation Guide"},"dependencies":{"type":"object","properties":{"smart.who.int.base":{"oneOf":[{"type":"string"},{"type":"object","properties":{"id":{"type":"string"},"version":{"type":"string"}}}],"description":"WHO SMART Guidelines base dependency (required for WHO DAK compliance)"}},"additionalProperties":{"oneOf":[{"type":"string"},{"type":"object","properties":{"id":{"type":"string"},"version":{"type":"string"},"uri":{"type":"string","format":"uri"},"reason":{"type":"string"}}}]},"description":"Dependencies on other Implementation Guides"},"global":{"type":"object","additionalProperties":{"type":"string"},"description":"Global profiles applied across the IG"},"groups":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"},"resources":{"type":"array","items":{"type":"string"}}}},"description":"Resource groupings for the IG"},"resources":{"type":"object","additionalProperties":{"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"},"exampleBoolean":{"type":"boolean"},"exampleCanonical":{"type":"string","format":"uri"}}},"description":"Resource definitions and metadata"},"pages":{"type":"object","additionalProperties":{"oneOf":[{"type":"string"},{"type":"object","properties":{"nameUrl":{"type":"string"},"title":{"type":"string"},"generation":{"type":"string","enum":["html","markdown","xml","generated"]}}}]},"description":"Page definitions for the IG"},"parameters":{"type":"object","additionalProperties":{"oneOf":[{"type":"string"},{"type":"boolean"},{"type":"number"}]},"description":"Parameters for IG generation"},"copyrightLabel":{"type":"string","description":"Copyright label for the IG"},"packageId":{"type":"string","description":"Package identifier (defaults to id)"},"menu":{"type":"object","additionalProperties":true,"description":"Menu structure for the IG"},"history":{"type":"object","properties":{"package-id":{"type":"string"},"canonical":{"type":"string","format":"uri"},"title":{"type":"string"},"introduction":{"type":"string"}},"description":"History configuration for the IG"},"indexPageContent":{"type":"string","description":"Content for the index page"},"FSHOnly":{"type":"boolean","description":"Flag to indicate if this is a FSH-only project"},"applyExtensionMetadataToRoot":{"type":"boolean","description":"Whether to apply extension metadata to root"},"instanceOptions":{"type":"object","properties":{"setMetaProfile":{"type":"string","enum":["always","never","inline-only","standalone-only"]},"setId":{"type":"string","enum":["always","standalone-only"]},"manualSliceOrdering":{"type":"boolean"}},"description":"Options for instance processing"}},"allOf":[{"if":{"properties":{"dependencies":{"type":"object","not":{"properties":{"smart.who.int.base":true},"required":["smart.who.int.base"]}}}},"then":{"properties":{"_whoSmartGuidelinesNote":{"const":"This IG is not WHO SMART Guidelines compliant. Add smart.who.int.base dependency for DAK compliance."}}}}]}')}}]);
//# sourceMappingURL=911.03c4f139.chunk.js.map