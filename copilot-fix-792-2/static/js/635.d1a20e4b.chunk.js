"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[635],{1932:(e,t,s)=>{s.d(t,{Rb:()=>n,hX:()=>o});const n=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(e=>"/"===e.pathname||""===e.pathname)(t)?null!==s&&void 0!==s&&s.current?s.current.focus():window.dispatchEvent(new CustomEvent("focusPATInput")):e("/",{state:{focusPATInput:!0}})},o=function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((e=>!!(null!==e&&void 0!==e&&e.ctrlKey||null!==e&&void 0!==e&&e.metaKey))(e)){const e=(e=>{const t="/sgex/copilot-fix-792-2",s=window.location.origin,n=e.startsWith("/")?e.slice(1):e;if(!t)return"".concat(s,"/").concat(n);const o=t.endsWith("/")?t:t+"/";return"".concat(s).concat(o).concat(n)})(t);window.open(e,"_blank","noopener,noreferrer")}else n?s(t,{state:n}):s(t)}},15429:(e,t,s)=>{s.d(t,{A:()=>a});var n=s(29946),o=s(85571);const a=new class{constructor(){this.storageKey="sgex_tracked_items",this.logger=o.A.getLogger("IssueTrackingService"),this.syncInterval=null,this.syncIntervalMs=3e5}_getStorageKey(){return this.storageKey}_getStoredData(){try{const e=localStorage.getItem(this._getStorageKey());return e?JSON.parse(e):{trackedItems:{}}}catch(e){return this.logger.error("Failed to parse stored tracking data:",e),{trackedItems:{}}}}_saveStoredData(e){try{return localStorage.setItem(this._getStorageKey(),JSON.stringify(e)),!0}catch(t){return this.logger.error("Failed to save tracking data:",t),!1}}async _getCurrentUsername(){if(!n.A.isAuth())return null;try{return(await n.A.getCurrentUser()).login}catch(e){return this.logger.error("Failed to get current user:",e),null}}async getTrackedItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!e&&(e=await this._getCurrentUsername(),!e))return{issues:[],pullRequests:[]};const t=this._getStoredData().trackedItems[e]||{issues:[],pullRequests:[]};return{issues:t.issues||[],pullRequests:t.pullRequests||[]}}async addTrackedIssue(e){const t=await this._getCurrentUsername();if(!t)return this.logger.warn("Cannot track issue: user not authenticated"),!1;const s=this._getStoredData();s.trackedItems[t]||(s.trackedItems[t]={issues:[],pullRequests:[]});if(s.trackedItems[t].issues.find(t=>t.id===e.id||t.number===e.number))return this.logger.debug("Issue already tracked:",e.number),!0;const n={id:e.id,number:e.number,title:e.title,html_url:e.html_url,created_at:e.created_at||(new Date).toISOString(),repository:e.repository||"litlfred/sgex",state:e.state||"open",labels:e.labels||[],trackedAt:(new Date).toISOString()};s.trackedItems[t].issues.push(n);const o=this._saveStoredData(s);return o&&(this.logger.info("Issue tracked successfully:",n.number),this.startBackgroundSync(),this._findRelatedPRs(t,n)),o}async addTrackedPR(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const s=await this._getCurrentUsername();if(!s)return this.logger.warn("Cannot track PR: user not authenticated"),!1;const n=this._getStoredData();n.trackedItems[s]||(n.trackedItems[s]={issues:[],pullRequests:[]});const o=n.trackedItems[s].pullRequests.find(t=>t.id===e.id||t.number===e.number);if(o)return t.length>0&&(o.linkedIssues=[...new Set([...o.linkedIssues||[],...t])],this._saveStoredData(n)),!0;const a={id:e.id,number:e.number,title:e.title,html_url:e.html_url,created_at:e.created_at||(new Date).toISOString(),repository:e.repository||"litlfred/sgex",state:e.state||"open",linkedIssues:t,trackedAt:(new Date).toISOString()};n.trackedItems[s].pullRequests.push(a);const r=this._saveStoredData(n);return r&&this.logger.info("PR tracked successfully:",a.number),r}async removeTrackedIssue(e){const t=await this._getCurrentUsername();if(!t)return!1;const s=this._getStoredData();if(!s.trackedItems[t]||!s.trackedItems[t].issues)return!1;const n=s.trackedItems[t].issues.length;return s.trackedItems[t].issues=s.trackedItems[t].issues.filter(t=>t.number!==e),s.trackedItems[t].issues.length<n&&(this._saveStoredData(s),this.logger.info("Issue untracked:",e),!0)}async removeTrackedPR(e){const t=await this._getCurrentUsername();if(!t)return!1;const s=this._getStoredData();if(!s.trackedItems[t]||!s.trackedItems[t].pullRequests)return!1;const n=s.trackedItems[t].pullRequests.length;return s.trackedItems[t].pullRequests=s.trackedItems[t].pullRequests.filter(t=>t.number!==e),s.trackedItems[t].pullRequests.length<n&&(this._saveStoredData(s),this.logger.info("PR untracked:",e),!0)}async getTrackedCounts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=await this.getTrackedItems(e);return{issues:t.issues.length,pullRequests:t.pullRequests.length,total:t.issues.length+t.pullRequests.length}}async _findRelatedPRs(e,t){if(n.A.isAuth())try{const[e,s]=t.repository.split("/");if(!e||!s)return;const o="is:pr repo:".concat(e,"/").concat(s," ").concat(t.number),a=await n.A.searchPullRequests(o);if(a&&a.items&&a.items.length>0)for(const n of a.items){const e="".concat(n.title," ").concat(n.body||"").toLowerCase(),s=["#".concat(t.number),"issue ".concat(t.number),"fixes #".concat(t.number),"closes #".concat(t.number),"resolves #".concat(t.number)];s.some(t=>e.includes(t.toLowerCase()))&&await this.addTrackedPR({id:n.id,number:n.number,title:n.title,html_url:n.html_url,created_at:n.created_at,repository:t.repository,state:n.state},[t.number])}}catch(s){this.logger.error("Failed to find related PRs:",s)}}async syncTrackedItems(){if(!n.A.isAuth())return;const e=await this._getCurrentUsername();if(!e)return;const t=await this.getTrackedItems(e);let s=!1;for(const a of t.issues)try{const[e,t]=a.repository.split("/");if(!e||!t)continue;const o=await n.A.getIssue(e,t,a.number);o&&o.state!==a.state&&(a.state=o.state,s=!0)}catch(o){this.logger.debug("Failed to sync issue ".concat(a.number,":"),o)}for(const a of t.pullRequests)try{const[e,t]=a.repository.split("/");if(!e||!t)continue;const o=await n.A.getPullRequest(e,t,a.number);o&&o.state!==a.state&&(a.state=o.state,s=!0)}catch(o){this.logger.debug("Failed to sync PR ".concat(a.number,":"),o)}if(s){const s=this._getStoredData();s.trackedItems[e]=t,this._saveStoredData(s),this.logger.info("Tracked items synced successfully")}}startBackgroundSync(){this.syncInterval||(this.syncInterval=setInterval(()=>{this.syncTrackedItems().catch(e=>{this.logger.error("Background sync failed:",e)})},this.syncIntervalMs),this.logger.debug("Background sync started"))}stopBackgroundSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,this.logger.debug("Background sync stopped"))}async clearTrackedItems(){const e=await this._getCurrentUsername();if(!e)return!1;const t=this._getStoredData();return!!t.trackedItems[e]&&(delete t.trackedItems[e],this._saveStoredData(t),this.logger.info("All tracked items cleared for user:",e),!0)}clearAllData(){localStorage.removeItem(this._getStorageKey()),this.stopBackgroundSync(),this.logger.info("All tracking data cleared")}}},18354:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});const n=new class{constructor(){this.storageKey="sgex_branch_context"}getRepositoryKey(e){var t,s;if(!e||!e.name)return null;const n=(null===(t=e.owner)||void 0===t?void 0:t.login)||(null===(s=e.full_name)||void 0===s?void 0:s.split("/")[0]);return n?"".concat(n,"/").concat(e.name):null}getSelectedBranch(e){if(!e)return null;try{const t=this.getBranchContext();return t[this.getRepositoryKey(e)]||null}catch(t){return console.warn("Failed to get branch context:",t),null}}setSelectedBranch(e,t){if(e&&t)try{const s=this.getBranchContext();s[this.getRepositoryKey(e)]=t,this.setBranchContext(s)}catch(s){console.warn("Failed to set branch context:",s)}}clearRepositoryBranch(e){if(e)try{const t=this.getBranchContext();delete t[this.getRepositoryKey(e)],this.setBranchContext(t)}catch(t){console.warn("Failed to clear repository branch context:",t)}}clearAllBranchContext(){try{sessionStorage.removeItem(this.storageKey)}catch(e){console.warn("Failed to clear branch context:",e)}}getBranchContext(){try{const e=sessionStorage.getItem(this.storageKey);return e?JSON.parse(e):{}}catch(e){return console.warn("Failed to parse branch context from storage:",e),{}}}setBranchContext(e){try{sessionStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){console.warn("Failed to save branch context to storage:",t)}}getDefaultBranchName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e?t.some(e=>"main"===e.name)?"main":e.default_branch&&t.some(t=>t.name===e.default_branch)?e.default_branch:t.length>0?t[0].name:"main":"main"}hasBranchContext(e){return null!==this.getSelectedBranch(e)}getBranchDisplayInfo(e){const t=this.getSelectedBranch(e);if(!t)return null;const s=t===((null===e||void 0===e?void 0:e.default_branch)||"main");return{branch:t,isDefault:s,displayText:s?"".concat(t," (default)"):t}}}},25345:(e,t,s)=>{s.d(t,{A:()=>w});var n=s(9950),o=s(67818),a=s(88259),r=s(89379),i=s(29946),c=s(15429),l=s(38659);let d=null;const u=new class{constructor(){this.templates=new Map,this.templateCache=new Map}async fetchIssueTemplates(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"litlfred",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sgex";try{const s=await this._fetchTemplatesFromDirectory(e,t,".github/ISSUE_TEMPLATE"),n="".concat(e,"/").concat(t);return this.templateCache.set(n,{templates:s,fetchedAt:Date.now()}),s}catch(s){return console.warn("Failed to fetch issue templates:",s),this._getDefaultTemplates()}}async _fetchTemplatesFromDirectory(e,t,s){const n=[];try{const a=(await i.A.getDirectoryContents(e,t,s)).filter(e=>"file"===e.type&&(e.name.endsWith(".yml")||e.name.endsWith(".yaml"))&&"config.yml"!==e.name);for(const s of a)try{const o=await i.A.getFileContent(e,t,s.path),a=await this._parseIssueTemplate(o,s.name);a&&n.push(a)}catch(o){console.warn("Failed to parse template ".concat(s.name,":"),o)}return n}catch(o){return console.warn("Failed to fetch templates from ".concat(s,":"),o),[]}}async _parseIssueTemplate(e,t){try{const s=(await(0,l.cb)()).load(e);if(!s||!s.name||!s.body)return console.warn("Invalid template structure in ".concat(t)),null;const n=this._getTemplateType(t);return{id:t.replace(/\.(yml|yaml)$/,""),name:s.name,description:s.description||"",title:s.title||"",labels:s.labels||[],body:s.body||[],filename:t,type:n}}catch(s){return console.error("Failed to parse YAML template ".concat(t,":"),s),null}}_getTemplateType(e){const t=e.toLowerCase();return t.includes("bug")?"bug":t.includes("feature")?"feature":t.includes("question")?"question":t.includes("documentation")?"documentation":"general"}getDefaultTemplates(){return this._getDefaultTemplates()}_getDefaultTemplates(){return[{id:"bug_report",name:"Bug Report",description:"File a bug report to help us improve",title:"[Bug]: ",labels:["bug"],type:"bug",body:[{type:"textarea",id:"what-happened",attributes:{label:"What happened?",description:"A clear description of what the bug is."},validations:{required:!0}},{type:"textarea",id:"expected",attributes:{label:"Expected behavior",description:"What did you expect to happen?"},validations:{required:!0}},{type:"textarea",id:"steps",attributes:{label:"Steps to reproduce",description:"Steps to reproduce the behavior",placeholder:"1. Go to '...'\n2. Click on '....'\n3. See error"},validations:{required:!0}}]},{id:"feature_request",name:"Feature Request",description:"Suggest an idea for this project",title:"[Feature]: ",labels:["enhancement"],type:"feature",body:[{type:"textarea",id:"description",attributes:{label:"Feature Description",description:"A clear description of what you want to happen."},validations:{required:!0}},{type:"textarea",id:"use-case",attributes:{label:"Use Case",description:"Describe the use case and why this feature would be beneficial."},validations:{required:!0}}]},{id:"question",name:"Question",description:"Ask for help or clarification about SGEX Workbench",title:"[Question]: ",labels:["question"],type:"question",body:[{type:"textarea",id:"question",attributes:{label:"Your Question",description:"What would you like to know?"},validations:{required:!0}},{type:"textarea",id:"context",attributes:{label:"Context",description:"What were you trying to do when this question came up?"},validations:{required:!1}}]}]}async getTemplates(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"litlfred",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sgex",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="".concat(e,"/").concat(t),o=this.templateCache.get(n);return!s&&o&&Date.now()-o.fetchedAt<36e5?o.templates:await this.fetchIssueTemplates(e,t)}generateIssueBody(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r="";for(const c of e.body)if("markdown"===c.type)r+="".concat(c.attributes.value,"\n\n");else if(c.id&&t[c.id]){var i;const e=(null===(i=c.attributes)||void 0===i?void 0:i.label)||c.id,s=t[c.id];r+="## ".concat(e,"\n\n").concat(s,"\n\n")}if(a&&(r+="## Screenshot\n\n*A screenshot has been captured and will be attached to this issue.*\n\n"),s&&n){const e=this._truncateConsoleOutput(n);r+="## Console Output\n\n```\n".concat(e,"\n```\n\n")}return r+=this._generateContextualInfo(o),r.trim()}_truncateConsoleOutput(e){const t=32768;if(e.length<=t)return e;const s=e.substring(0,t);return"".concat(s,"\n\n... (output truncated to ").concat(t," characters)")}_generateContextualInfo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={environment:{userAgent:navigator.userAgent,url:window.location.href,timestamp:(new Date).toISOString(),viewport:{width:window.innerWidth,height:window.innerHeight},screen:{width:window.screen.width,height:window.screen.height},language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},sgexContext:this._extractSGEXContext(e)};return"## Environment & Context\n\n```json\n".concat(JSON.stringify(t,null,2),"\n```")}_extractSGEXContext(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={page:{id:e.pageId||this._detectCurrentPage(),url:window.location.href,pathname:window.location.pathname},authentication:{isAuthenticated:this._isUserAuthenticated(),authMode:this._getAuthenticationMode()}};return e.repository&&(t.repository={name:e.repository.name||e.repository,owner:e.repository.owner||e.repository.split("/")[0],branch:e.branch||"unknown"}),e.selectedDak&&(t.dak={name:e.selectedDak.name,description:e.selectedDak.description,compliance:e.selectedDak.compliance}),e.component&&(t.component={type:e.component,isEditing:e.isEditing||!1}),e.profile&&(t.profile={login:e.profile.login,type:e.profile.type}),void 0!==e.hasQuestionnaires&&(t.features=t.features||{},t.features.hasQuestionnaires=e.hasQuestionnaires),void 0!==e.selectedReferencesCount&&(t.features=t.features||{},t.features.selectedReferencesCount=e.selectedReferencesCount),t}_detectCurrentPage(){const e=window.location.pathname.split("/").filter(Boolean);return e.length>0?e[e.length-1]||"unknown":"root"}_isUserAuthenticated(){try{return!!(localStorage.getItem("github_token")||sessionStorage.getItem("github_token")||window.githubToken)}catch(e){return!1}}_getAuthenticationMode(){return this._isUserAuthenticated()?"authenticated":"localhost"===window.location.hostname||window.location.hostname.includes("127.0.0.1")?"local_development":"demo_mode"}async takeScreenshot(){try{return"getDisplayMedia"in navigator.mediaDevices?await this._takeScreenshotWithScreenCapture():"html2canvas"in window?await this._takeScreenshotWithHtml2Canvas():(console.warn("Screenshot functionality not available in this browser"),null)}catch(e){return console.warn("Failed to take screenshot:",e),null}}async _takeScreenshotWithScreenCapture(){try{const e=await navigator.mediaDevices.getDisplayMedia({video:{mediaSource:"screen"}}),t=document.createElement("video");return t.srcObject=e,t.play(),new Promise((s,n)=>{t.onloadedmetadata=()=>{const n=document.createElement("canvas");n.width=t.videoWidth,n.height=t.videoHeight;n.getContext("2d").drawImage(t,0,0),e.getTracks().forEach(e=>e.stop()),n.toBlob(s,"image/png")},t.onerror=n})}catch(e){return console.warn("Screen capture failed:",e),null}}async _takeScreenshotWithHtml2Canvas(){try{if(await(async()=>{if(!d){const e=await s.e(52).then(s.t.bind(s,81052,23));d=e.default}return d})(),"function"!==typeof d)return console.warn("html2canvas not available"),null;const e=await d(document.body,{height:window.innerHeight,width:window.innerWidth,scrollX:0,scrollY:0});return new Promise(t=>{e.toBlob(t,"image/png")})}catch(e){return console.warn("html2canvas screenshot failed:",e),null}}captureConsoleOutput(){const e=[],t={};return["log","warn","error","info","debug"].forEach(e=>{t[e]=console[e]}),["log","warn","error","info","debug"].forEach(s=>{console[s]=function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];t[s].apply(console,o);const r=(new Date).toISOString(),i=o.map(e=>"object"===typeof e?JSON.stringify(e):String(e)).join(" ");e.push("[".concat(r,"] ").concat(s.toUpperCase(),": ").concat(i))}}),{stop:()=>(Object.keys(t).forEach(e=>{console[e]=t[e]}),e.join("\n")),getLogs:()=>e.join("\n")}}async submitIssue(e,t,s,n){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;try{const h=(s.title||"")+(n.title||"Issue submitted via SGEX"),g=this.generateIssueBody(s,n,o,a,l,d),p=await i.A.createIssue(e,t,h,g,s.labels||[],[]);if(p.success&&p.issue&&i.A.isAuth())try{await c.A.addTrackedIssue((0,r.A)((0,r.A)({},p.issue),{},{repository:"".concat(e,"/").concat(t)}))}catch(u){console.warn("Failed to track created issue:",u)}return d&&p.success&&p.issue&&console.log("Screenshot captured but attachment upload not yet implemented"),p}catch(h){return console.error("Failed to submit issue:",h),{success:!1,error:{message:h.message,type:"submission_error"}}}}generateIssueUrl(e,t,s,n){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;const c=new URLSearchParams;s.filename&&c.set("template",s.filename),s.labels&&s.labels.length>0&&c.set("labels",s.labels.join(","));const l=(s.title||"")+(n.title||"");if(l&&c.set("title",l),s.filename&&s.body){for(const t of s.body)t.id&&n[t.id]&&c.set(t.id,n[t.id]);if(o&&a){const e=this._truncateConsoleOutput(a),t="console-output";c.set(t,"```\n".concat(e,"\n```"))}const e=this._generateContextualInfo(r);c.set("context-info",e),i&&c.set("screenshot-note","A screenshot was captured and will be manually attached to this issue.")}else{const e=this.generateIssueBody(s,n,o,a,r,i);if(e){const t=2e3,s=e.length>t?e.substring(0,t)+"\n\n... (content truncated, please add remaining details)":e;c.set("body",s)}}return"https://github.com/".concat(e,"/").concat(t,"/issues/new?").concat(c.toString())}clearCache(){this.templateCache.clear()}};var h=s(44414);const g=e=>{let{screenshotBlob:t,onSave:s,onCancel:o,isOpen:a}=e;const r=(0,n.useRef)(null),[i,c]=(0,n.useState)(!1),[l,d]=(0,n.useState)("draw"),[u,g]=(0,n.useState)("#ff0000"),[p,m]=(0,n.useState)(3),[f,b]=(0,n.useState)(null),[w,y]=(0,n.useState)(null),[v,k]=(0,n.useState)(null),[x,S]=(0,n.useState)(!1),[N,A]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(t&&a){const e=new Image;return e.onload=()=>{b(e);const t=r.current;if(t){t.width=e.width,t.height=e.height;const s=t.getContext("2d");s.drawImage(e,0,0),A(s.getImageData(0,0,t.width,t.height))}},e.src=URL.createObjectURL(t),()=>{URL.revokeObjectURL(e.src)}}},[t,a]);const C=(0,n.useCallback)(e=>{const t=r.current,s=t.getBoundingClientRect(),n=t.width/s.width,o=t.height/s.height;return{x:(e.clientX-s.left)*n,y:(e.clientY-s.top)*o}},[]),j=(0,n.useCallback)(e=>{const t=r.current.getContext("2d"),s=C(e);"crop"===l?(y(s),k(s),S(!0)):"draw"!==l&&"highlight"!==l||(c(!0),t.beginPath(),t.moveTo(s.x,s.y),"highlight"===l?(t.globalAlpha=.3,t.globalCompositeOperation="source-over"):(t.globalAlpha=1,t.globalCompositeOperation="source-over"),t.strokeStyle=u,t.lineWidth="highlight"===l?3*p:p,t.lineCap="round",t.lineJoin="round")},[l,C,u,p]),_=(0,n.useCallback)(e=>{const t=r.current,s=t.getContext("2d"),n=C(e);if("crop"===l&&x){k(n),s.clearRect(0,0,t.width,t.height),f&&s.drawImage(f,0,0);const e=Math.min(w.x,n.x),o=Math.min(w.y,n.y),a=Math.abs(n.x-w.x),r=Math.abs(n.y-w.y);s.strokeStyle="#000000",s.lineWidth=2,s.setLineDash([5,5]),s.strokeRect(e,o,a,r),s.setLineDash([])}else"draw"!==l&&"highlight"!==l||!i||(s.lineTo(n.x,n.y),s.stroke())},[l,x,w,i,C,f]),T=(0,n.useCallback)(()=>{if("crop"===l&&x)S(!1);else if("draw"===l||"highlight"===l){c(!1);r.current.getContext("2d").globalAlpha=1}},[l,x]);return a&&t?(0,h.jsx)("div",{className:"screenshot-editor-overlay",children:(0,h.jsxs)("div",{className:"screenshot-editor",children:[(0,h.jsxs)("div",{className:"screenshot-editor-header",children:[(0,h.jsx)("h3",{children:"Edit Screenshot"}),(0,h.jsx)("button",{className:"close-btn",onClick:o,"aria-label":"Close screenshot editor",children:"\xd7"})]}),(0,h.jsxs)("div",{className:"screenshot-editor-content",children:[(0,h.jsxs)("div",{className:"screenshot-toolbar",children:[(0,h.jsxs)("div",{className:"tool-group",children:[(0,h.jsx)("label",{children:"Tool:"}),(0,h.jsx)("button",{className:"tool-btn ".concat("draw"===l?"active":""),onClick:()=>d("draw"),children:"Draw"}),(0,h.jsx)("button",{className:"tool-btn ".concat("highlight"===l?"active":""),onClick:()=>d("highlight"),children:"Highlight"}),(0,h.jsx)("button",{className:"tool-btn ".concat("crop"===l?"active":""),onClick:()=>d("crop"),children:"Crop"})]}),("draw"===l||"highlight"===l)&&(0,h.jsxs)("div",{className:"tool-group",children:[(0,h.jsx)("label",{children:"Color:"}),(0,h.jsx)("div",{className:"color-palette",children:["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#ffffff","#000000","#ffa500","#800080"].map(e=>(0,h.jsx)("button",{className:"color-btn ".concat(u===e?"active":""),style:{backgroundColor:e},onClick:()=>g(e),"aria-label":"Select ".concat(e," color")},e))})]}),("draw"===l||"highlight"===l)&&(0,h.jsxs)("div",{className:"tool-group",children:[(0,h.jsx)("label",{children:"Size:"}),(0,h.jsx)("input",{type:"range",min:"1",max:"10",value:p,onChange:e=>m(parseInt(e.target.value)),className:"size-slider"}),(0,h.jsxs)("span",{className:"size-value",children:[p,"px"]})]}),"crop"===l&&w&&v&&(0,h.jsx)("div",{className:"tool-group",children:(0,h.jsx)("button",{className:"action-btn primary",onClick:()=>{if(!w||!v)return;const e=r.current,t=e.getContext("2d"),s=Math.min(w.x,v.x),n=Math.min(w.y,v.y),o=Math.abs(v.x-w.x),a=Math.abs(v.y-w.y);if(o>0&&a>0){const r=t.getImageData(s,n,o,a);e.width=o,e.height=a,t.putImageData(r,0,0),y(null),k(null),d("draw")}},children:"Apply Crop"})}),(0,h.jsx)("div",{className:"tool-group",children:(0,h.jsx)("button",{className:"action-btn secondary",onClick:()=>{if(N&&f){const e=r.current,t=e.getContext("2d");e.width=f.width,e.height=f.height,t.putImageData(N,0,0),y(null),k(null),d("draw")}},children:"Reset"})})]}),(0,h.jsx)("div",{className:"canvas-container",children:(0,h.jsx)("canvas",{ref:r,className:"screenshot-canvas",onMouseDown:j,onMouseMove:_,onMouseUp:T,onMouseLeave:T})}),(0,h.jsxs)("div",{className:"editor-instructions",children:["draw"===l&&(0,h.jsx)("p",{children:"Click and drag to draw on the screenshot"}),"highlight"===l&&(0,h.jsx)("p",{children:"Click and drag to highlight areas (semi-transparent)"}),"crop"===l&&(0,h.jsx)("p",{children:'Click and drag to select an area to crop, then click "Apply Crop"'})]})]}),(0,h.jsxs)("div",{className:"screenshot-editor-footer",children:[(0,h.jsx)("button",{className:"action-btn secondary",onClick:o,children:"Cancel"}),(0,h.jsx)("button",{className:"action-btn primary",onClick:()=>{r.current.toBlob(e=>{s(e)},"image/png")},children:"Save & Use"})]})]})}):null},p=e=>{let{onClose:t,contextData:s={}}=e;const[o,a]=(0,n.useState)([]),[c,l]=(0,n.useState)(null),[d,p]=(0,n.useState)({}),[m,f]=(0,n.useState)(!1),[b,w]=(0,n.useState)(!1),[y,v]=(0,n.useState)(!0),[k,x]=(0,n.useState)(!1),[S,N]=(0,n.useState)(!1),[A,C]=(0,n.useState)(null),[j,_]=(0,n.useState)(null),[T,I]=(0,n.useState)(null),[R,E]=(0,n.useState)(null),[D,P]=(0,n.useState)(null),[F,G]=(0,n.useState)(!1),[H,O]=(0,n.useState)(!1),[L,B]=(0,n.useState)(!1),[M,U]=(0,n.useState)(null);(0,n.useEffect)(()=>{q()},[]),(0,n.useEffect)(()=>{const e=u.captureConsoleOutput();return I(e),()=>{e.stop()}},[]),(0,n.useEffect)(()=>{if(o.length>0&&!c){const e=o.find(e=>"bug"===e.type)||o[0];l(e),f("bug"===e.type)}},[o,c]);const q=async()=>{try{v(!0);const e=await u.getTemplates();a(e)}catch(e){console.error("Failed to load templates:",e),C("Failed to load bug report templates. Using defaults."),a(u.getDefaultTemplates())}finally{v(!1)}},K=(e,t)=>{p(s=>(0,r.A)((0,r.A)({},s),{},{[e]:t}))},W=async()=>{G(!0),C(null);try{const e=await u.takeScreenshot();if(e){U(e),E(e);const t=URL.createObjectURL(e);P(t),w(!0)}else C("Screenshot capture is not supported in this browser or was denied by the user.")}catch(e){console.error("Failed to take screenshot:",e),C("Failed to capture screenshot: "+e.message)}finally{G(!1)}};(0,n.useEffect)(()=>()=>{D&&URL.revokeObjectURL(D)},[D]);return y?(0,h.jsxs)("div",{className:"bug-report-form",children:[(0,h.jsxs)("div",{className:"form-header",children:[(0,h.jsx)("h3",{children:"Loading Bug Report Templates..."}),(0,h.jsx)("button",{className:"close-btn",onClick:t,"aria-label":"Close bug report form",children:"\xd7"})]}),(0,h.jsx)("div",{className:"loading-spinner",children:"Loading..."})]}):null!==j&&void 0!==j&&j.urlOpened?(0,h.jsxs)("div",{className:"bug-report-form",children:[(0,h.jsxs)("div",{className:"form-header",children:[(0,h.jsx)("h3",{children:"Issue Form Opened"}),(0,h.jsx)("button",{className:"close-btn",onClick:t,"aria-label":"Close bug report form",children:"\xd7"})]}),(0,h.jsx)("div",{className:"success-message",children:(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{children:"\u2705 Your issue form has been opened in a new tab."}),(0,h.jsx)("p",{children:"Please complete and submit the form in the GitHub tab to create your issue."}),(0,h.jsx)("p",{children:"If the tab didn't open, you can access it here:"}),(0,h.jsx)("a",{href:j.fallbackUrl,target:"_blank",rel:"noopener noreferrer",className:"issue-link",children:"Open Issue Form"})]})})]}):S&&null!==j&&void 0!==j&&j.success?(0,h.jsxs)("div",{className:"bug-report-form",children:[(0,h.jsxs)("div",{className:"form-header",children:[(0,h.jsx)("h3",{children:"Issue Submitted Successfully!"}),(0,h.jsx)("button",{className:"close-btn",onClick:t,"aria-label":"Close bug report form",children:"\xd7"})]}),(0,h.jsx)("div",{className:"success-message",children:j.manual?(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{children:"\u2705 Your issue has been opened in a new tab."}),(0,h.jsx)("p",{children:"If the tab didn't open, you can access it here:"}),(0,h.jsx)("a",{href:j.fallbackUrl,target:"_blank",rel:"noopener noreferrer",className:"issue-link",children:"Open Issue Form"})]}):(0,h.jsxs)("div",{children:[(0,h.jsxs)("p",{children:["\u2705 Issue #",null===(z=j.issue)||void 0===z?void 0:z.number," has been created successfully!"]}),(0,h.jsxs)("a",{href:null===(X=j.issue)||void 0===X?void 0:X.html_url,target:"_blank",rel:"noopener noreferrer",className:"issue-link",children:["View Issue #",null===(V=j.issue)||void 0===V?void 0:V.number]})]})})]}):(0,h.jsxs)("div",{className:"bug-report-form",children:[(0,h.jsxs)("div",{className:"form-header",children:[(0,h.jsx)("h3",{children:"Report an Issue"}),(0,h.jsx)("button",{className:"close-btn",onClick:t,"aria-label":"Close bug report form",children:"\xd7"})]}),A&&(0,h.jsx)("div",{className:"error-message",children:(0,h.jsxs)("p",{children:["\u26a0\ufe0f ",A]})}),(null===j||void 0===j?void 0:j.error)&&"popup_blocked"===j.error.type&&(0,h.jsxs)("div",{className:"error-message",children:[(0,h.jsx)("p",{children:"\u26a0\ufe0f Pop-up blocked. Please allow pop-ups or use the link below:"}),(0,h.jsx)("div",{children:(0,h.jsx)("a",{href:j.fallbackUrl,target:"_blank",rel:"noopener noreferrer",className:"fallback-link",children:"Open GitHub Issue Form"})})]}),(0,h.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),c){x(!0),C(null);try{const e=m&&T?T.getLogs():"",o=b?R:null;if(i.A.isAuthenticated){const n=await u.submitIssue("litlfred","sgex",c,d,m,e,s,o);var t;if(_(n),n.success)N(!0);else C((null===(t=n.error)||void 0===t?void 0:t.message)||"Failed to submit issue")}else{const t=u.generateIssueUrl("litlfred","sgex",c,d,m,e,s,o);try{const e=window.open(t,"_blank");!e||e.closed?_({success:!1,fallbackUrl:t,error:{type:"popup_blocked"}}):_({success:!0,fallbackUrl:t,manual:!0,urlOpened:!0})}catch(n){_({success:!1,fallbackUrl:t,error:{type:"popup_blocked"}})}}}catch(o){console.error("Failed to submit bug report:",o),C(o.message)}finally{x(!1)}}else C("Please select a template")},className:"report-form",children:[(0,h.jsxs)("div",{className:"form-field",children:[(0,h.jsxs)("label",{htmlFor:"template-select",className:"field-label",children:["Issue Type ",(0,h.jsx)("span",{className:"required",children:"*"})]}),(0,h.jsxs)("select",{id:"template-select",className:"field-input select-input",value:(null===c||void 0===c?void 0:c.id)||"",onChange:e=>{(e=>{l(e),p({}),f("bug"===e.type),w("bug"===e.type)})(o.find(t=>t.id===e.target.value))},required:!0,children:[(0,h.jsx)("option",{value:"",children:"Select issue type..."}),o.map(e=>(0,h.jsxs)("option",{value:e.id,children:[e.name," - ",e.description]},e.id))]})]}),(0,h.jsx)("div",{className:"form-field",children:(0,h.jsxs)("label",{className:"checkbox-label console-option",children:[(0,h.jsx)("input",{type:"checkbox",className:"checkbox-input",checked:m,onChange:e=>f(e.target.checked)}),"Include JavaScript console output in report",(0,h.jsx)("span",{className:"checkbox-help",children:"(Recommended for bug reports - helps developers debug issues)"})]})}),(0,h.jsxs)("div",{className:"form-field",children:[(0,h.jsxs)("label",{className:"checkbox-label screenshot-option",children:[(0,h.jsx)("input",{type:"checkbox",className:"checkbox-input",checked:b,onChange:e=>w(e.target.checked)}),"Include screenshot of current page",(0,h.jsx)("span",{className:"checkbox-help",children:"(Recommended for bug reports - helps visualize the issue)"})]}),b&&(0,h.jsx)("div",{className:"screenshot-controls",children:R?(0,h.jsxs)("div",{className:"screenshot-preview",children:[(0,h.jsx)("img",{src:D,alt:"Screenshot preview",className:"screenshot-image"}),(0,h.jsxs)("div",{className:"screenshot-actions",children:[(0,h.jsx)("button",{type:"button",className:"screenshot-btn secondary",onClick:()=>{B(!0)},children:"Edit"}),(0,h.jsx)("button",{type:"button",className:"screenshot-btn secondary",onClick:W,disabled:F,children:F?"Capturing...":"Retake"}),(0,h.jsx)("button",{type:"button",className:"screenshot-btn danger",onClick:()=>{D&&URL.revokeObjectURL(D),E(null),U(null),P(null),w(!1)},children:"Remove"})]})]}):(0,h.jsx)("button",{type:"button",className:"screenshot-btn secondary",onClick:W,disabled:F,children:F?"Capturing...":"Take Screenshot"})})]}),(0,h.jsxs)("div",{className:"form-field",children:[(0,h.jsxs)("label",{className:"context-preview-label",children:["Contextual Information",(0,h.jsxs)("button",{type:"button",className:"context-toggle-btn",onClick:()=>O(!H),children:[H?"Hide":"Show"," Context Details"]})]}),(0,h.jsx)("p",{className:"field-description",children:"This information will be automatically included to help developers understand the context of your report."}),H&&(0,h.jsxs)("div",{className:"context-preview",children:[(0,h.jsxs)("div",{className:"context-section",children:[(0,h.jsx)("h4",{children:"Page Context"}),(0,h.jsxs)("ul",{children:[(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"Current Page:"})," ",s.pageId||"Unknown"]}),(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"URL:"})," ",window.location.href]}),(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"Authentication:"})," ",i.A.isAuthenticated?"Authenticated":"Demo Mode"]})]})]}),s.repository&&(0,h.jsxs)("div",{className:"context-section",children:[(0,h.jsx)("h4",{children:"Repository Context"}),(0,h.jsxs)("ul",{children:[(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"Repository:"})," ",s.repository.name||s.repository]}),(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"Branch:"})," ",s.branch||"Unknown"]})]})]}),s.selectedDak&&(0,h.jsxs)("div",{className:"context-section",children:[(0,h.jsx)("h4",{children:"DAK Context"}),(0,h.jsxs)("ul",{children:[(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"DAK Name:"})," ",s.selectedDak.name]}),s.selectedDak.description&&(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"Description:"})," ",s.selectedDak.description]})]})]}),s.component&&(0,h.jsxs)("div",{className:"context-section",children:[(0,h.jsx)("h4",{children:"Component Context"}),(0,h.jsxs)("ul",{children:[(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"Component:"})," ",s.component]}),void 0!==s.isEditing&&(0,h.jsxs)("li",{children:[(0,h.jsx)("strong",{children:"Editing Mode:"})," ",s.isEditing?"Yes":"No"]})]})]})]})]}),c&&(0,h.jsx)("div",{className:"template-fields",children:c.body.map(e=>(e=>{const{id:t,type:s,attributes:n={},validations:o={}}=e,{label:a,description:r,placeholder:i,options:c}=n,{required:l}=o;if("markdown"===s)return(0,h.jsx)("div",{className:"form-field markdown-field",children:(0,h.jsx)("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n.value}})},t||Math.random());const u=t||"field_".concat(Math.random());switch(s){case"textarea":return(0,h.jsxs)("div",{className:"form-field",children:[(0,h.jsxs)("label",{htmlFor:u,className:"field-label",children:[a,l&&(0,h.jsx)("span",{className:"required",children:"*"})]}),r&&(0,h.jsx)("p",{className:"field-description",children:r}),(0,h.jsx)("textarea",{id:u,className:"field-input textarea-input",placeholder:i,value:d[u]||"",onChange:e=>K(u,e.target.value),required:l,rows:4})]},u);case"input":return(0,h.jsxs)("div",{className:"form-field",children:[(0,h.jsxs)("label",{htmlFor:u,className:"field-label",children:[a,l&&(0,h.jsx)("span",{className:"required",children:"*"})]}),r&&(0,h.jsx)("p",{className:"field-description",children:r}),(0,h.jsx)("input",{id:u,type:"text",className:"field-input text-input",placeholder:i,value:d[u]||"",onChange:e=>K(u,e.target.value),required:l})]},u);case"dropdown":return(0,h.jsxs)("div",{className:"form-field",children:[(0,h.jsxs)("label",{htmlFor:u,className:"field-label",children:[a,l&&(0,h.jsx)("span",{className:"required",children:"*"})]}),r&&(0,h.jsx)("p",{className:"field-description",children:r}),(0,h.jsxs)("select",{id:u,className:"field-input select-input",value:d[u]||"",onChange:e=>K(u,e.target.value),required:l,children:[(0,h.jsx)("option",{value:"",children:"Select an option..."}),null===c||void 0===c?void 0:c.map((e,t)=>(0,h.jsx)("option",{value:e.value||e,children:e.label||e},t))]})]},u);case"checkboxes":return(0,h.jsx)("div",{className:"form-field",children:(0,h.jsxs)("fieldset",{className:"checkbox-fieldset",children:[(0,h.jsxs)("legend",{className:"field-label",children:[a,l&&(0,h.jsx)("span",{className:"required",children:"*"})]}),r&&(0,h.jsx)("p",{className:"field-description",children:r}),null===c||void 0===c?void 0:c.map((e,t)=>{var s;return(0,h.jsxs)("label",{className:"checkbox-label",children:[(0,h.jsx)("input",{type:"checkbox",className:"checkbox-input",checked:(null===(s=d[u])||void 0===s?void 0:s.includes(e.value||e))||!1,onChange:t=>{const s=e.value||e,n=d[u]||[],o=t.target.checked?[...n,s]:n.filter(e=>e!==s);K(u,o)}}),e.label||e]},t)})]})},u);default:return(0,h.jsx)("div",{className:"form-field",children:(0,h.jsxs)("p",{className:"unsupported-field",children:["Unsupported field type: ",s]})},u)}})(e))}),(0,h.jsxs)("div",{className:"form-actions",children:[(0,h.jsx)("button",{type:"submit",className:"submit-btn primary",disabled:k||!c,children:k?"Opening...":i.A.isAuthenticated?"Submit Issue":"Open in GitHub"}),(0,h.jsx)("button",{type:"button",className:"cancel-btn secondary",onClick:t,children:"Cancel"}),c&&!(null!==j&&void 0!==j&&j.urlOpened)&&(0,h.jsx)("a",{href:(()=>{if(!c)return"";const e=m&&T?T.getLogs():"",t=b?R:null;return u.generateIssueUrl("litlfred","sgex",c,d,m,e,s,t)})(),target:"_blank",rel:"noopener noreferrer",className:"fallback-btn tertiary",children:"Open in GitHub"})]}),(0,h.jsx)("div",{className:"auth-status",children:i.A.isAuthenticated?(0,h.jsx)("p",{className:"auth-info authenticated",children:"\u2705 Authenticated - Issues will be submitted directly to GitHub"}):(0,h.jsx)("p",{className:"auth-info not-authenticated",children:"\u2139\ufe0f Not authenticated - Issue will open in GitHub for manual submission"})})]}),(0,h.jsx)(g,{screenshotBlob:M,onSave:e=>{E(e),D&&URL.revokeObjectURL(D);const t=URL.createObjectURL(e);P(t),B(!1)},onCancel:()=>{B(!1)},isOpen:L})]});var z,X,V};var m=s(26987),f=s(95388);const b=e=>{let{tutorialId:t,onClose:s,contextData:r={}}=e;const{t:i}=(0,o.Bd)(),[c,l]=(0,n.useState)(null),[d,u]=(0,n.useState)(0),[g,p]=(0,n.useState)({}),[b,w]=(0,n.useState)(!0),[y,v]=(0,n.useState)(!1),k=(0,a.A)("sgex-mascot.png");(0,n.useEffect)(()=>{if(t){const e=m.A.getTutorial(t);if(e){l(e);const s=m.A.loadTutorialProgress(t,r);s&&s.state&&(u(s.state.currentStepIndex||0),p(s.state.context||{}))}w(!1)}},[t,r]),(0,n.useEffect)(()=>{c&&d>=0&&m.A.saveTutorialProgress(t,{currentStepIndex:d,context:g},r)},[c,t,d,g,r]);const x=e=>{e.target===e.currentTarget&&s()},S=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!c)return;let n=d;if("next"===e){const e=m.A.processStep(c,d,t,g);if(e.isComplete)return void s();n=void 0!==e.stepIndex?e.stepIndex+1:d+1,e.context&&p(e.context)}else"previous"===e?n=Math.max(0,d-1):"number"===typeof e&&(n=e);u(n),v(!1)};return b?(0,h.jsx)("div",{className:"enhanced-tutorial-overlay",onClick:x,children:(0,h.jsx)("div",{className:"enhanced-tutorial-modal",children:(0,h.jsxs)("div",{className:"tutorial-loading",children:[(0,h.jsx)("img",{src:k,alt:(0,f.lm)(i,f.ld.MASCOT_HELPER,"SGEX Helper"),className:"loading-mascot"}),(0,h.jsx)("p",{children:"Loading tutorial..."})]})})}):c?(0,h.jsx)("div",{className:"enhanced-tutorial-overlay",onClick:x,children:(0,h.jsxs)("div",{className:"enhanced-tutorial-modal",children:[(0,h.jsxs)("div",{className:"tutorial-modal-header",children:[(0,h.jsxs)("div",{className:"tutorial-title-section",children:[c.badge&&(0,h.jsx)("img",{src:c.badge,alt:"",className:"tutorial-badge",role:"presentation"}),(0,h.jsxs)("div",{className:"tutorial-title-info",children:[(0,h.jsx)("h2",{children:c.title}),c.description&&(0,h.jsx)("p",{className:"tutorial-description",children:c.description})]})]}),(0,h.jsx)("button",{className:"tutorial-close-btn",onClick:s,"aria-label":"Close tutorial",children:"\xd7"})]}),(0,h.jsx)("div",{className:"tutorial-modal-content",children:(()=>{if(!c||!c.steps||d>=c.steps.length)return null;const e=c.steps[d],t=(m.A.processStep(c,d,null,g),e.branches&&e.branches.length>0);return(0,h.jsxs)("div",{className:"enhanced-tutorial-step",children:[(0,h.jsxs)("div",{className:"tutorial-header",children:[(0,h.jsx)("h3",{children:e.title}),(0,h.jsxs)("div",{className:"step-counter",children:[(0,h.jsx)("span",{className:"current-step",children:d+1}),(0,h.jsx)("span",{className:"step-separator",children:"of"}),(0,h.jsx)("span",{className:"total-steps",children:c.steps.length})]})]}),(0,h.jsxs)("div",{className:"tutorial-content",children:[(0,h.jsx)("div",{className:"step-content",dangerouslySetInnerHTML:{__html:e.content}}),t&&(0,h.jsx)("div",{className:"tutorial-choices",children:(0,h.jsx)("div",{className:"choices-container",children:e.branches.map((e,t)=>(0,h.jsxs)("button",{className:"choice-btn",onClick:()=>{return t=e.choice,void S("next",t);var t},"aria-describedby":"choice-desc-".concat(t),children:[(0,h.jsx)("span",{className:"choice-label",children:e.label}),e.description&&(0,h.jsx)("span",{id:"choice-desc-".concat(t),className:"choice-description",children:e.description})]},t))})})]}),(0,h.jsxs)("div",{className:"tutorial-controls",children:[(0,h.jsxs)("button",{onClick:()=>S("previous"),disabled:0===d,className:"nav-btn nav-btn-prev","aria-label":"Previous step",children:[(0,h.jsx)("span",{className:"nav-icon",children:"\u2190"}),(0,h.jsx)("span",{className:"nav-label",children:"Previous"})]}),(0,h.jsx)("div",{className:"step-indicators",children:c.steps.map((e,t)=>(0,h.jsx)("button",{className:"step-dot ".concat(t===d?"active":""," ").concat(t<d?"completed":""),onClick:()=>S(t),"aria-label":"Go to step ".concat(t+1,": ").concat(c.steps[t].title),title:c.steps[t].title},t))}),!t&&(0,h.jsxs)("button",{onClick:()=>S("next"),disabled:d>=c.steps.length-1,className:"nav-btn nav-btn-next","aria-label":"Next step",children:[(0,h.jsx)("span",{className:"nav-label",children:d>=c.steps.length-1?"Complete":"Next"}),(0,h.jsx)("span",{className:"nav-icon",children:"\u2192"})]})]})]})})()})]})}):(0,h.jsx)("div",{className:"enhanced-tutorial-overlay",onClick:x,children:(0,h.jsx)("div",{className:"enhanced-tutorial-modal",children:(0,h.jsxs)("div",{className:"tutorial-error",children:[(0,h.jsx)("img",{src:k,alt:(0,f.lm)(i,f.ld.MASCOT_HELPER,"SGEX Helper"),className:"error-mascot"}),(0,h.jsx)("h3",{children:"Tutorial Not Found"}),(0,h.jsx)("p",{children:"The requested tutorial could not be found."}),(0,h.jsx)("button",{onClick:s,className:"error-close-btn",children:"Close"})]})})})},w=e=>{let{topic:t,helpTopic:s,contextData:r,onClose:i,tutorialId:c}=e;const{t:l}=(0,o.Bd)(),[d,u]=(0,n.useState)(!1),[g,w]=(0,n.useState)(0),[y,v]=(0,n.useState)(!1),[k,x]=(0,n.useState)(!1),[S,N]=(0,n.useState)(c);(0,n.useEffect)(()=>{if(c){if(m.A.getTutorial(c))return N(c),void x(!0)}if(s&&"slideshow"===s.type&&s.id){const e=m.A.convertHelpTopicToTutorial(s);if(e)return m.A.registerTutorial("legacy-".concat(s.id),e),N("legacy-".concat(s.id)),void x(!0)}},[c,s]);const A=(0,a.A)("sgex-mascot.png");(0,n.useEffect)(()=>{const e=(e,t)=>{var s;const n=new URLSearchParams(t);r.pageId&&n.set("sgex_page",r.pageId);const o=window.location.href;return n.set("sgex_current_url",o),null!==(s=r.selectedDak)&&void 0!==s&&s.name&&n.set("sgex_selected_dak",r.selectedDak.name),"".concat(e,"?").concat(n.toString())};return window.helpModalInstance={openSgexIssue:t=>{if("bug"===t)return void v(!0);let s={};switch(t){case"feature":s.template="feature_request.yml",s.labels="enhancement";break;case"question":s.template="question.yml",s.labels="question";break;case"documentation":s.template="documentation.yml",s.labels="documentation";break;case"blank":s.labels="blank-issue";break;default:s.labels="needs-triage"}const n=e("https://github.com/litlfred/sgex/issues/new",s);try{const e=window.open(n,"_blank");var o,a;if(!e||e.closed)null===(o=window.helpModalInstance)||void 0===o||null===(a=o.showFallbackInstructions)||void 0===a||a.call(o,"github-blocked",n,t);else setTimeout(()=>{try{var s,o;if(e.closed||!e.location||"about:blank"===e.location.href)e.close(),null===(s=window.helpModalInstance)||void 0===s||null===(o=s.showFallbackInstructions)||void 0===o||o.call(s,"github-blocked",n,t)}catch(a){}},1e3)}catch(c){var r,i;console.warn("Failed to open GitHub issue:",c),null===(r=window.helpModalInstance)||void 0===r||null===(i=r.showFallbackInstructions)||void 0===i||i.call(r,"github-blocked",n,t)}},openDakIssue:t=>{const s=r.repository||r.selectedDak;if(!s)return void console.warn("No DAK repository specified for feedback");const n="https://github.com/".concat(s.owner,"/").concat(s.name,"/issues/new");let o={};switch(t){case"bug":o.template="dak_bug_report.yml",o.labels="bug,dak-issue";break;case"improvement":o.template="dak_feature_request.yml",o.labels="enhancement,dak-improvement";break;case"content":o.template="dak_content_error.yml",o.labels="content-issue,clinical-content";break;case"question":o.template="dak_question.yml",o.labels="question,dak-question";break;case"blank":o.labels="blank-issue,dak-feedback";break;default:o.labels="dak-feedback"}s.name&&(o.sgex_dak_repository="".concat(s.owner,"/").concat(s.name));const a=e(n,o);try{const e=window.open(a,"_blank");var i,c;if(!e||e.closed)null===(i=window.helpModalInstance)||void 0===i||null===(c=i.showFallbackInstructions)||void 0===c||c.call(i,"github-blocked",a,"dak-".concat(t));else setTimeout(()=>{try{var s,n;if(e.closed||!e.location||"about:blank"===e.location.href)e.close(),null===(s=window.helpModalInstance)||void 0===s||null===(n=s.showFallbackInstructions)||void 0===n||n.call(s,"github-blocked",a,"dak-".concat(t))}catch(o){}},1e3)}catch(u){var l,d;console.warn("Failed to open DAK issue:",u),null===(l=window.helpModalInstance)||void 0===l||null===(d=l.showFallbackInstructions)||void 0===d||d.call(l,"github-blocked",a,"dak-".concat(t))}},showFallbackInstructions:(e,t,s)=>{const n={"github-blocked":{title:"GitHub Access Required",message:'\n              <div class="help-fallback-notice">\n                <h4>\ud83d\udd17 GitHub Link Blocked</h4>\n                <p>It looks like GitHub access is restricted in your current environment.</p>\n                <h5>To report this issue:</h5>\n                <ol>\n                  <li>Copy the link below</li>\n                  <li>Open it in a browser with GitHub access</li>\n                  <li>Fill out the issue template</li>\n                </ol>\n                <div class="fallback-url">\n                  <strong>Link to copy:</strong><br>\n                  <textarea readonly onclick="this.select()" style="width: 100%; height: 60px; margin: 5px 0; padding: 5px; font-family: monospace; font-size: 12px;">'.concat(t,'</textarea>\n                </div>\n                <p><em>\ud83d\udca1 Tip: You can also email us at <a href="mailto:smart@who.int">smart@who.int</a> with your issue details.</em></p>\n              </div>\n            ')}}[e]||{title:"External Link Issue",message:"<p>Unable to open external link. Please copy and visit: <br><code>".concat(t,"</code></p>")},o=document.querySelector(".help-fallback-overlay");o&&o.remove();const a=document.createElement("div");a.className="help-fallback-overlay",a.style.cssText="\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0, 0, 0, 0.7);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          z-index: 10000;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n        ";const r=document.createElement("div");r.style.cssText="\n          background: var(--who-card-bg, white);\n          border-radius: 8px;\n          padding: 20px;\n          max-width: 500px;\n          max-height: 80vh;\n          overflow-y: auto;\n          position: relative;\n          box-shadow: 0 10px 25px rgba(0,0,0,0.3);\n        ",r.innerHTML='\n          <button onclick="this.closest(\'.help-fallback-overlay\').remove()" style="\n            position: absolute;\n            top: 10px;\n            right: 15px;\n            background: none;\n            border: none;\n            font-size: 24px;\n            cursor: pointer;\n            color: var(--who-text-secondary, #666);\n          ">\xd7</button>\n          <h3 style="margin-top: 0; color: var(--who-text-primary, #333);">'.concat(n.title,'</h3>\n          <div style="color: var(--who-text-primary, #555); line-height: 1.5;">').concat(n.message,"</div>\n        "),a.appendChild(r),document.body.appendChild(a),a.addEventListener("click",e=>{e.target===a&&a.remove()}),setTimeout(()=>{document.body.contains(a)&&a.remove()},3e4)}},()=>{delete window.helpModalInstance}},[r]);const C=e=>{e.target===e.currentTarget&&i()},j=()=>{g>0&&w(g-1)},_=()=>{null!==s&&void 0!==s&&s.content&&g<s.content.length-1&&w(g+1)},T=()=>{if(null===s||void 0===s||!s.content||"slideshow"!==s.type)return null;const e=s.content,t=e[g];let n=t.content;return"provide-dak-feedback"===s.id&&(n=n.replace(/onclick="this\.openDakIssue\('([^']+)'\)"/g,"onclick=\"window.helpModalInstance?.openDakIssue('$1')\"")),(0,h.jsxs)("div",{className:"help-slideshow",children:[(0,h.jsxs)("div",{className:"slideshow-header",children:[(0,h.jsx)("h3",{children:t.title}),(0,h.jsxs)("div",{className:"slide-counter",children:[g+1," of ",e.length]})]}),(0,h.jsx)("div",{className:"slideshow-content",dangerouslySetInnerHTML:{__html:n}}),(0,h.jsxs)("div",{className:"slideshow-controls",children:[(0,h.jsx)("button",{onClick:j,disabled:0===g,className:"slide-nav-btn",children:"\u2190 Previous"}),(0,h.jsx)("div",{className:"slide-dots",children:e.map((e,t)=>(0,h.jsx)("button",{className:"slide-dot ".concat(t===g?"active":""),onClick:()=>w(t),"aria-label":"Go to slide ".concat(t+1)},t))}),(0,h.jsx)("button",{onClick:_,disabled:g===e.length-1,className:"slide-nav-btn",children:"Next \u2192"})]})]})},{title:I,content:R}=(()=>{if(s)return{title:s.title,content:"slideshow"===s.type?T():(0,h.jsx)("div",{className:"help-content",children:(0,h.jsxs)("div",{className:"mascot-message",children:[(0,h.jsx)("img",{src:A,alt:(0,f.lm)(l,f.ld.MASCOT_HELPER,"SGEX Helper"),className:"help-mascot"}),(0,h.jsx)("div",{className:"message-bubble",children:(0,h.jsx)("div",{dangerouslySetInnerHTML:{__html:s.content}})})]})})};switch(t){case"github-token":case"pat-help":return{title:"GitHub Authentication Help",content:(0,h.jsx)("div",{className:"help-content",children:(0,h.jsxs)("div",{className:"mascot-message",children:[(0,h.jsx)("img",{src:A,alt:(0,f.lm)(l,f.ld.MASCOT_HELPER,"SGEX Helper"),className:"help-mascot"}),(0,h.jsxs)("div",{className:"message-bubble",children:[(0,h.jsx)("p",{children:"SGEX Workbench uses GitHub Personal Access Tokens for secure authentication!"}),(0,h.jsx)("p",{children:(0,h.jsx)("strong",{children:"How it works:"})}),(0,h.jsxs)("ul",{children:[(0,h.jsx)("li",{children:"Create a Personal Access Token in your GitHub settings"}),(0,h.jsx)("li",{children:"Enter the token in the login form"}),(0,h.jsx)("li",{children:"SGEX will securely connect to your GitHub repositories"}),(0,h.jsx)("li",{children:"No backend server required - works entirely in your browser!"})]}),(0,h.jsx)("p",{children:"This approach ensures compliance with our no-backend requirement while keeping your data secure."}),(0,h.jsx)("p",{children:"If you're having trouble, please use the menu above to get additional support."})]})]})})};default:return{title:"SGEX Workbench Help",content:(0,h.jsx)("div",{className:"help-content",children:(0,h.jsxs)("div",{className:"mascot-message",children:[(0,h.jsx)("img",{src:A,alt:(0,f.lm)(l,f.ld.MASCOT_HELPER,"SGEX Helper"),className:"help-mascot"}),(0,h.jsxs)("div",{className:"message-bubble",children:[(0,h.jsx)("p",{children:"Hi! I'm here to help you with the SGEX Workbench."}),(0,h.jsx)("p",{children:"Use the menu in the top right to get additional support options."})]})]})})}}})();return k&&S?(0,h.jsx)(b,{tutorialId:S,onClose:()=>{x(!1),N(null),i()},contextData:r}):y?(0,h.jsx)("div",{className:"help-modal-overlay bug-report-overlay",onClick:C,children:(0,h.jsx)(p,{onClose:()=>{v(!1),i()},contextData:r})}):(0,h.jsx)("div",{className:"help-modal-overlay",onClick:C,children:(0,h.jsxs)("div",{className:"help-modal",children:[(0,h.jsxs)("div",{className:"help-modal-header",children:[(0,h.jsx)("h2",{children:I}),(0,h.jsxs)("div",{className:"help-modal-actions",children:[(0,h.jsxs)("button",{className:"hamburger-menu-btn",onClick:()=>{u(!d)},"aria-label":"More options",children:[(0,h.jsx)("span",{}),(0,h.jsx)("span",{}),(0,h.jsx)("span",{})]}),(0,h.jsx)("button",{className:"close-btn",onClick:i,"aria-label":"Close help",children:"\xd7"})]}),d&&(0,h.jsxs)("div",{className:"help-menu-dropdown",children:[(0,h.jsxs)("button",{onClick:()=>{window.open("/sgex/docs/overview","_blank")},className:"menu-item",children:[(0,h.jsx)("span",{className:"menu-icon",children:"\ud83d\udcd6"}),"Documentation"]}),(0,h.jsxs)("button",{onClick:()=>{v(!0)},className:"menu-item",children:[(0,h.jsx)("img",{src:"/sgex/bug-report-icon.svg",alt:(0,f.lm)(l,f.ld.ICON_BUG_REPORT,"Bug Report"),className:"menu-icon"}),"File Bug Report"]}),r.repository&&(0,h.jsxs)("button",{onClick:()=>{var e;r.repository&&(null!==(e=window.helpModalInstance)&&void 0!==e&&e.openDakIssue&&window.helpModalInstance.openDakIssue("content"))},className:"menu-item",children:[(0,h.jsx)("span",{className:"menu-icon",children:"\ud83d\udcdd"}),"Provide DAK Feedback"]}),(0,h.jsxs)("button",{onClick:()=>{const e=(null===s||void 0===s?void 0:s.title)||t,n=encodeURIComponent("SGEX Workbench Support: ".concat(e)),o=encodeURIComponent("\nHello SMART Guidelines Team,\n\nI need assistance with the SGEX Workbench.\n\nTopic: ".concat(e,"\nPage: ").concat(window.location.pathname,"\n\nPlease describe your question or issue:\n\n\nBest regards,\n    ").trim());window.open("mailto:smart@who.int?subject=".concat(n,"&body=").concat(o))},className:"menu-item",children:[(0,h.jsx)("span",{className:"menu-icon",children:"\ud83d\udce7"}),"Email Support"]})]})]}),(0,h.jsx)("div",{className:"help-modal-content",children:R})]})})}},26987:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(89379);const o=new class{constructor(){this.tutorials=new Map,this.categories={"getting-started":"Getting Started",authentication:"Authentication","dak-management":"DAK Management","content-editing":"Content Editing",collaboration:"Collaboration",troubleshooting:"Troubleshooting"},this.initializeBuiltInTutorials()}registerTutorial(e,t){if(!/^[a-zA-Z0-9-]+$/.test(e))throw new Error("Invalid tutorial ID format: ".concat(e,". Must contain only alphanumeric characters and dashes."));this.validateTutorialDefinition(t),this.tutorials.set(e,(0,n.A)((0,n.A)({id:e},t),{},{registeredAt:(new Date).toISOString()}))}getTutorial(e){return this.tutorials.get(e)||null}getTutorialsForPage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=[];for(const[,n]of this.tutorials)n.pages&&n.pages.includes(e)&&this.isTutorialApplicable(n,t)&&s.push(n);return s.sort((e,t)=>(e.priority||0)-(t.priority||0))}getTutorialsByCategory(e){const t=[];for(const[,s]of this.tutorials)s.category===e&&t.push(s);return t.sort((e,t)=>(e.title||"").localeCompare(t.title||""))}getCategories(){return(0,n.A)({},this.categories)}processStep(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e||!e.steps||t>=e.steps.length)return{step:null,isComplete:!0};const o=e.steps[t];if(o.branches&&s){const t=o.branches.find(e=>e.choice===s);if(t&&(t.updateContext&&Object.assign(n,t.updateContext),void 0!==t.targetStep))return{step:e.steps[t.targetStep]||null,stepIndex:t.targetStep,isComplete:t.targetStep>=e.steps.length,context:n}}return{step:o,stepIndex:t,isComplete:!1,hasNext:t+1<e.steps.length,hasPrevious:t>0,context:n}}validateTutorialDefinition(e){const t=["title","steps"];for(const s of t)if(!e[s])throw new Error("Tutorial definition missing required field: ".concat(s));if(!Array.isArray(e.steps)||0===e.steps.length)throw new Error("Tutorial must have at least one step");e.steps.forEach((e,t)=>{if(!e.title||!e.content)throw new Error("Step ".concat(t," missing required title or content"));if(e.branches){if(!Array.isArray(e.branches))throw new Error("Step ".concat(t," branches must be an array"));e.branches.forEach((e,s)=>{if(!e.choice||!e.label)throw new Error("Step ".concat(t," branch ").concat(s," missing choice or label"))})}})}isTutorialApplicable(e,t){return!(e.requiresAuth&&!t.isAuthenticated)&&(!(e.requiresDak&&!t.repository)&&(!e.condition||"function"!==typeof e.condition||e.condition(t)))}initializeBuiltInTutorials(){this.registerTutorial("github-pat-setup",{title:"How to Create a GitHub Personal Access Token",description:"Step-by-step guide to creating and configuring GitHub Personal Access Tokens for SGEX",category:"authentication",pages:["landing-page-unauthenticated","welcome","pat-login","pat-setup-instructions"],priority:1,badge:"/sgex/cat-paw-lock-icon.svg",steps:[{title:"Step 1: Go to GitHub Settings",content:'\n            <p>Navigate to your GitHub account settings:</p>\n            <ol>\n              <li>Click your profile picture in the top right</li>\n              <li>Select "Settings" from the dropdown</li>\n              <li>Go to "Developer settings" \u2192 "Personal access tokens"</li>\n              <li>Choose "Fine-grained tokens" (recommended) or "Tokens (classic)"</li>\n            </ol>\n            <div class="help-tip">\n              <strong>\ud83d\udca1 Tip:</strong> Fine-grained tokens provide better security with repository-specific access.\n            </div>\n          '},{title:"Step 2: Generate New Token",content:'\n            <p>Create your new token:</p>\n            <ol>\n              <li>Click "Generate new token"</li>\n              <li>Give it a descriptive name like "SGEX Workbench"</li>\n              <li>Set expiration (90 days recommended)</li>\n              <li>Select repository access (specific repos or all)</li>\n            </ol>\n            <div class="help-warning">\n              <strong>\u26a0\ufe0f Important:</strong> You\'ll only see the token once, so copy it immediately!\n            </div>\n          '},{title:"Step 3: Set Required Permissions",content:"\n            <h4>Which token type are you creating?</h4>\n            <p>The permissions needed depend on your token type:</p>\n          ",branches:[{choice:"fine-grained",label:"\ud83c\udfaf Fine-grained Token (Recommended)",targetStep:3},{choice:"classic",label:"\ud83d\udd27 Classic Token",targetStep:4}]},{title:"Fine-grained Token Permissions",content:'\n            <p>For <strong>fine-grained tokens</strong>, enable these permissions:</p>\n            <ul>\n              <li><strong>Contents:</strong> Read and Write</li>\n              <li><strong>Metadata:</strong> Read</li>\n              <li><strong>Pull requests:</strong> Read and Write</li>\n            </ul>\n            <div class="help-tip">\n              <strong>\ud83d\udd12 Security:</strong> Fine-grained tokens provide better security with minimal permissions.\n            </div>\n          ',next:5},{title:"Classic Token Permissions",content:'\n            <p>For <strong>classic tokens</strong>, select these scopes:</p>\n            <ul>\n              <li><strong>repo</strong> - Full control of private repositories</li>\n              <li><strong>read:org</strong> - Read org and team membership</li>\n            </ul>\n            <div class="help-tip">\n              <strong>\ud83d\udcdd Note:</strong> Classic tokens have broader permissions but simpler setup.\n            </div>\n          ',next:5},{title:"Step 4: Use Your Token",content:'\n            <p>Now you can authenticate with SGEX:</p>\n            <ol>\n              <li>Copy your newly generated token</li>\n              <li>Paste it into the login form</li>\n              <li>Click "Sign in with Personal Access Token"</li>\n            </ol>\n            <div class="help-tip">\n              <strong>\ud83d\udd12 Security:</strong> Your token is stored securely in your browser and never shared with servers.\n            </div>\n          '}]}),this.registerTutorial("dak-components-overview",{title:"Understanding DAK Components",description:"Learn about the 8 core components of WHO SMART Guidelines Digital Adaptation Kits",category:"dak-management",pages:["dak-dashboard"],priority:1,steps:[{title:"WHO SMART Guidelines DAK Components",content:'\n            <p>Digital Adaptation Kits (DAKs) contain 8 core components organized in two levels:</p>\n            <h4>Level 2: Business Logic & Processes</h4>\n            <ul>\n              <li><strong>Business Processes:</strong> BPMN workflows</li>\n              <li><strong>Decision Support Logic:</strong> DMN decision tables</li>\n              <li><strong>Indicators & Measures:</strong> Performance metrics</li>\n              <li><strong>Data Entry Forms:</strong> Structured questionnaires</li>\n            </ul>\n            <h4>Level 3: Technical Implementation</h4>\n            <ul>\n              <li><strong>Terminology:</strong> Code systems and value sets</li>\n              <li><strong>FHIR Profiles:</strong> Resource structure definitions</li>\n              <li><strong>FHIR Extensions:</strong> Custom data elements</li>\n              <li><strong>Test Data & Examples:</strong> Sample data for validation</li>\n            </ul>\n            <div class="help-tip">\n              <strong>\ud83d\udca1 Tip:</strong> Start with Level 2 components to define business logic, then move to Level 3 for technical implementation.\n            </div>\n          '},{title:"Where to Start?",content:"\n            <h4>What would you like to focus on first?</h4>\n            <p>Choose your primary interest to continue with specific guidance:</p>\n          ",branches:[{choice:"business-logic",label:"\ud83d\udccb Business Logic & Clinical Workflows",targetStep:2},{choice:"technical-implementation",label:"\u2699\ufe0f Technical Implementation & FHIR",targetStep:4},{choice:"overview-complete",label:"\u2705 Just wanted an overview, I'm good to go!",targetStep:6}]},{title:"Business Logic Components",content:'\n            <p>Business logic components define <em>what</em> your DAK does:</p>\n            <h4>\ud83d\udd04 Business Processes</h4>\n            <p>Define clinical workflows and care processes using BPMN diagrams.</p>\n            <h4>\ud83e\udde0 Decision Support Logic</h4>\n            <p>Create decision tables and rules using DMN notation.</p>\n            <h4>\ud83d\udcca Indicators & Measures</h4>\n            <p>Define performance metrics and measurement criteria.</p>\n            <h4>\ud83d\udcdd Data Entry Forms</h4>\n            <p>Design structured questionnaires for data collection.</p>\n            <div class="help-tip">\n              <strong>\ud83c\udfaf Best Practice:</strong> Start with business processes to map out your clinical workflow, then add decision logic and forms.\n            </div>\n          ',next:5},{title:"Getting Started with Business Logic",content:'\n            <h4>Recommended starting order:</h4>\n            <ol>\n              <li><strong>Business Processes:</strong> Map your clinical workflow first</li>\n              <li><strong>Data Entry Forms:</strong> Design forms for data collection points</li>\n              <li><strong>Decision Support Logic:</strong> Add decision rules and logic</li>\n              <li><strong>Indicators & Measures:</strong> Define success metrics</li>\n            </ol>\n            <div class="help-tip">\n              <strong>\ud83d\udca1 Next Steps:</strong> Click on "Business Processes" in the dashboard to start creating your first workflow diagram.\n            </div>\n          ',next:6},{title:"Technical Implementation Components",content:'\n            <p>Technical components define <em>how</em> your DAK integrates with systems:</p>\n            <h4>\ud83c\udff7\ufe0f Terminology</h4>\n            <p>Define code systems, value sets, and concept mappings.</p>\n            <h4>\ud83d\udccb FHIR Profiles</h4>\n            <p>Structure definitions for healthcare data resources.</p>\n            <h4>\ud83d\udd27 FHIR Extensions</h4>\n            <p>Custom data elements and extensions to FHIR.</p>\n            <h4>\ud83e\uddea Test Data & Examples</h4>\n            <p>Sample data and test cases for validation.</p>\n            <div class="help-tip">\n              <strong>\ud83c\udfaf Best Practice:</strong> Define terminology first, then create profiles, extensions, and test data.\n            </div>\n          ',next:5},{title:"Getting Started with Technical Implementation",content:'\n            <h4>Recommended starting order:</h4>\n            <ol>\n              <li><strong>Terminology:</strong> Define your code systems and value sets</li>\n              <li><strong>FHIR Profiles:</strong> Create resource structure definitions</li>\n              <li><strong>FHIR Extensions:</strong> Add custom data elements as needed</li>\n              <li><strong>Test Data & Examples:</strong> Create validation examples</li>\n            </ol>\n            <div class="help-tip">\n              <strong>\ud83d\udca1 Next Steps:</strong> Click on "Terminology" in the dashboard to start defining your code systems and value sets.\n            </div>\n          '},{title:"You're Ready to Go!",content:'\n            <p>Great! You now understand the DAK component structure:</p>\n            <ul>\n              <li>\u2705 Know the 8 core DAK components</li>\n              <li>\u2705 Understand Level 2 vs Level 3 distinction</li>\n              <li>\u2705 Ready to start building your DAK</li>\n            </ul>\n            <div class="help-tip">\n              <strong>\ud83d\ude80 Pro Tip:</strong> Use the contextual help on each component page for specific guidance as you work.\n            </div>\n          '}]}),this.registerTutorial("tutorial-framework-demo",{title:"Enhanced Tutorial System Demo",description:"Demonstration of the new branching tutorial capabilities in SGEX",category:"getting-started",pages:["dak-dashboard","landing-page-authenticated"],priority:0,badge:"/sgex/cat-paw-icon.svg",steps:[{title:"Welcome to Enhanced Tutorials!",content:'\n            <p>\ud83c\udf89 Welcome to the new enhanced tutorial system in SGEX Workbench!</p>\n            <p>This tutorial demonstrates the new features:</p>\n            <ul>\n              <li><strong>Branching Logic:</strong> Choose your own path through tutorials</li>\n              <li><strong>Progress Tracking:</strong> Your progress is automatically saved</li>\n              <li><strong>Interactive Choices:</strong> Click buttons to make decisions</li>\n              <li><strong>Contextual Content:</strong> Tutorials adapt to your current workflow</li>\n            </ul>\n            <div class="help-tip">\n              <strong>\ud83d\ude80 New Feature:</strong> This tutorial system supports conditional navigation based on user choices!\n            </div>\n          '},{title:"Choose Your Learning Path",content:"\n            <p>Let's demonstrate branching logic! What would you like to learn about?</p>\n            <h4>Select your area of interest:</h4>\n          ",branches:[{choice:"tutorial-features",label:"\ud83d\udd27 Tutorial System Features",description:"Learn about the capabilities of the new tutorial framework"},{choice:"accessibility-features",label:"\u267f Accessibility & Standards",description:"Discover how tutorials support accessibility and internationalization"},{choice:"developer-features",label:"\ud83d\udc69\u200d\ud83d\udcbb Developer Integration",description:"See how developers can create and integrate new tutorials"}]},{title:"Tutorial System Features",content:'\n            <p>You chose to learn about tutorial features! Here\'s what makes this system powerful:</p>\n            <h4>\ud83c\udfaf Key Features</h4>\n            <ul>\n              <li><strong>Branching Navigation:</strong> Users can choose different paths through content</li>\n              <li><strong>Progress Persistence:</strong> Tutorial state is saved automatically</li>\n              <li><strong>Context Awareness:</strong> Tutorials adapt based on current page and user state</li>\n              <li><strong>Category Organization:</strong> Tutorials are organized by topic and difficulty</li>\n              <li><strong>Responsive Design:</strong> Works perfectly on desktop and mobile</li>\n            </ul>\n            <div class="help-tip">\n              <strong>\ud83d\udca1 Implementation:</strong> Tutorials use alphanumeric IDs with dashes for easy identification and management.\n            </div>\n          ',next:5},{title:"Accessibility & Standards Compliance",content:'\n            <p>You chose accessibility! Great choice - SGEX tutorials are built with standards in mind:</p>\n            <h4>\u267f Accessibility Features</h4>\n            <ul>\n              <li><strong>WCAG 2.1 AA Compliance:</strong> Proper color contrast and keyboard navigation</li>\n              <li><strong>Screen Reader Support:</strong> Semantic HTML and ARIA labels</li>\n              <li><strong>Keyboard Navigation:</strong> Full keyboard support for all interactions</li>\n              <li><strong>Focus Management:</strong> Clear focus indicators and logical tab order</li>\n            </ul>\n            <h4>\ud83c\udf0d Internationalization</h4>\n            <ul>\n              <li><strong>i18n Ready:</strong> All content supports translation</li>\n              <li><strong>RTL Support:</strong> Right-to-left languages supported</li>\n              <li><strong>Default Locale:</strong> en_US with fallback support</li>\n            </ul>\n            <div class="help-tip">\n              <strong>\ud83c\udfc6 Standards:</strong> Follows WHO Enterprise Architecture guidelines for healthcare applications.\n            </div>\n          ',next:5},{title:"Developer Integration Guide",content:'\n            <p>You chose the developer path! Here\'s how to integrate tutorials into your components:</p>\n            <h4>\ud83d\udc69\u200d\ud83d\udcbb Integration Methods</h4>\n            <ul>\n              <li><strong>TutorialManager:</strong> Higher-order component for page-level tutorial management</li>\n              <li><strong>TutorialLauncher:</strong> Button component to launch specific tutorials</li>\n              <li><strong>useTutorials Hook:</strong> React hook for functional components</li>\n              <li><strong>Direct Service:</strong> Import tutorialService for advanced usage</li>\n            </ul>\n            <div class="help-tip">\n              <strong>\ud83d\udee0\ufe0f Code Example:</strong><br>\n              <code>import { TutorialLauncher } from \'../components/TutorialManager\';</code><br>\n              <code>&lt;TutorialLauncher tutorialId="my-tutorial" /&gt;</code>\n            </div>\n          ',next:5},{title:"Tutorial Complete!",content:"\n            <p>\ud83c\udf8a Congratulations! You've experienced the enhanced tutorial system!</p>\n            <h4>What You've Learned</h4>\n            <ul>\n              <li>\u2705 How branching logic works in tutorials</li>\n              <li>\u2705 The key features available to content creators</li>\n              <li>\u2705 Accessibility and internationalization support</li>\n              <li>\u2705 Developer integration options</li>\n            </ul>\n            <h4>\ud83d\ude80 Next Steps</h4>\n            <p>Now you can:</p>\n            <ul>\n              <li>Create your own tutorials using the framework</li>\n              <li>Use the TutorialManager components in your pages</li>\n              <li>Explore other tutorials available in the system</li>\n            </ul>\n            <div class=\"help-tip\">\n              <strong>\ud83d\udca1 Tip:</strong> Look for the contextual help button on any page to access page-specific tutorials!\n            </div>\n          "}]})}convertHelpTopicToTutorial(e){return e&&"slideshow"===e.type?{id:e.id,title:e.title,description:"Converted from help topic: ".concat(e.title),category:"legacy",badge:e.badge,steps:e.content.map(e=>({title:e.title,content:e.content}))}:null}getTutorialStateKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"sgex_tutorial_".concat(e)+(t.repository?"_".concat(t.repository.owner,"_").concat(t.repository.name):"")}saveTutorialProgress(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const n=this.getTutorialStateKey(e,s),o={tutorialId:e,state:t,lastAccessed:(new Date).toISOString(),contextData:{page:s.pageId,repository:s.repository?"".concat(s.repository.owner,"/").concat(s.repository.name):null}};localStorage.setItem(n,JSON.stringify(o))}catch(n){console.warn("Failed to save tutorial progress:",n)}}loadTutorialProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const s=this.getTutorialStateKey(e,t),n=localStorage.getItem(s);if(n)return JSON.parse(n)}catch(s){console.warn("Failed to load tutorial progress:",s)}return null}}},29166:(e,t,s)=>{s.d(t,{A:()=>x});var n=s(89379),o=s(9950),a=s(67818),r=s(61115),i=(s(26987),s(29473)),c=s(18354),l=s(85571);const d=new class{constructor(){this.logger=l.A.getLogger("CacheManagementService")}clearAllCache(){try{this.logger.info("Starting complete cache clear operation");const e=i.A.clearAllCaches();return this.logger.debug("Repository cache cleared",{success:e}),c.default.clearAllBranchContext(),this.logger.debug("Branch context cleared"),this.clearAllStagingGrounds(),this.logger.debug("Staging ground data cleared"),this.clearOtherSGEXData(),this.logger.debug("Other SGEX data cleared"),this.logger.info("Complete cache clear operation completed successfully"),!0}catch(e){return this.logger.error("Error during cache clear operation",{error:e.message}),console.error("Error clearing cache:",e),!1}}clearAllStagingGrounds(){try{const e=Object.keys(localStorage);e.filter(e=>e.startsWith("sgex_staging_")).forEach(e=>{localStorage.removeItem(e),this.logger.debug("Removed staging ground",{key:e})});return e.filter(e=>e.startsWith("sgex_staging_history_")).forEach(e=>{localStorage.removeItem(e),this.logger.debug("Removed staging ground history",{key:e})}),!0}catch(e){return this.logger.error("Error clearing staging grounds",{error:e.message}),console.warn("Error clearing staging grounds:",e),!1}}clearOtherSGEXData(){try{const e=Object.keys(localStorage);e.filter(e=>e.startsWith("sgex_")&&!e.startsWith("sgex_repo_cache_")&&!e.startsWith("sgex_staging_")).forEach(e=>{localStorage.removeItem(e),this.logger.debug("Removed other SGEX data",{key:e})});const t=Object.keys(sessionStorage);return t.filter(e=>e.startsWith("sgex_")&&"sgex_branch_context"!==e).forEach(e=>{sessionStorage.removeItem(e),this.logger.debug("Removed SGEX session data",{key:e})}),!0}catch(e){return this.logger.error("Error clearing other SGEX data",{error:e.message}),console.warn("Error clearing other SGEX data:",e),!1}}getCacheInfo(){try{const t={repositoryCache:{count:0,keys:[]},branchContext:{hasData:!1,repositoryCount:0},stagingGround:{count:0,keys:[]},other:{count:0,keys:[]}},s=Object.keys(localStorage);t.repositoryCache.keys=s.filter(e=>e.startsWith("sgex_repo_cache_")),t.repositoryCache.count=t.repositoryCache.keys.length,t.stagingGround.keys=s.filter(e=>e.startsWith("sgex_staging_")||e.startsWith("sgex_staging_history_")),t.stagingGround.count=t.stagingGround.keys.length,t.other.keys=s.filter(e=>e.startsWith("sgex_")&&!e.startsWith("sgex_repo_cache_")&&!e.startsWith("sgex_staging_")),t.other.count=t.other.keys.length;try{const e=sessionStorage.getItem("sgex_branch_context");if(e){const s=JSON.parse(e);t.branchContext.hasData=!0,t.branchContext.repositoryCount=Object.keys(s).length}}catch(e){}return t}catch(t){return this.logger.error("Error getting cache info",{error:t.message}),null}}getUncommittedWork(){try{const e=[],t=Object.keys(localStorage);return t.filter(e=>e.startsWith("sgex_staging_")&&!e.includes("_history_")).forEach(t=>{try{const s=JSON.parse(localStorage.getItem(t));if(s&&s.files&&s.files.length>0){const n=t.replace("sgex_staging_","").split("_"),o=n.pop(),a=n.join("_");e.push({repository:a,branch:o,fileCount:s.files.length,lastModified:s.timestamp?new Date(s.timestamp):null,message:s.message||""})}}catch(s){}}),e}catch(e){return this.logger.error("Error checking uncommitted work",{error:e.message}),[]}}};var u=s(15429),h=s(29946),g=s(25345),p=s(44414);const m=e=>{let{onClose:t}=e;const[s,n]=(0,o.useState)({issues:[],pullRequests:[]}),[a,r]=(0,o.useState)(!0),[i,c]=(0,o.useState)(null),[l,d]=(0,o.useState)("issues"),[g,m]=(0,o.useState)(!1);(0,o.useEffect)(()=>{f()},[]);const f=async()=>{try{r(!0),c(null);const e=await u.A.getTrackedItems();n(e)}catch(e){console.error("Failed to load tracked items:",e),c("Failed to load tracked items")}finally{r(!1)}},b=e=>new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),w=e=>{switch(e){case"open":return"#28a745";case"closed":return"#cb2431";case"merged":return"#6f42c1";default:return"#6a737d"}};return a?(0,p.jsx)("div",{className:"tracked-items-modal-overlay",children:(0,p.jsxs)("div",{className:"tracked-items-modal",children:[(0,p.jsxs)("div",{className:"tracked-items-header",children:[(0,p.jsx)("h2",{children:"Tracked Items"}),(0,p.jsx)("button",{onClick:t,className:"tracked-items-close",children:"\xd7"})]}),(0,p.jsxs)("div",{className:"tracked-items-loading",children:[(0,p.jsx)("div",{className:"loading-spinner"}),(0,p.jsx)("p",{children:"Loading tracked items..."})]})]})}):(0,p.jsx)("div",{className:"tracked-items-modal-overlay",children:(0,p.jsxs)("div",{className:"tracked-items-modal",children:[(0,p.jsxs)("div",{className:"tracked-items-header",children:[(0,p.jsx)("h2",{children:"Tracked Items"}),(0,p.jsxs)("div",{className:"tracked-items-header-actions",children:[h.A.isAuth()&&(0,p.jsxs)("button",{onClick:async()=>{if(h.A.isAuth())try{m(!0),await u.A.syncTrackedItems(),await f()}catch(e){console.error("Failed to sync tracked items:",e),c("Failed to sync tracked items")}finally{m(!1)}else c("Authentication required to sync items")},className:"tracked-items-sync",disabled:g,title:"Sync with GitHub to update status",children:[g?"\ud83d\udd04":"\u21bb"," ",g?"Syncing...":"Sync"]}),(0,p.jsx)("button",{onClick:t,className:"tracked-items-close",children:"\xd7"})]})]}),i&&(0,p.jsxs)("div",{className:"tracked-items-error",children:[i,(0,p.jsx)("button",{onClick:()=>c(null),children:"\xd7"})]}),(0,p.jsxs)("div",{className:"tracked-items-tabs",children:[(0,p.jsxs)("button",{className:"tracked-items-tab ".concat("issues"===l?"active":""),onClick:()=>d("issues"),children:["Issues (",s.issues.length,")"]}),(0,p.jsxs)("button",{className:"tracked-items-tab ".concat("pullRequests"===l?"active":""),onClick:()=>d("pullRequests"),children:["Pull Requests (",s.pullRequests.length,")"]})]}),(0,p.jsxs)("div",{className:"tracked-items-content",children:["issues"===l&&(0,p.jsx)("div",{className:"tracked-items-list",children:0===s.issues.length?(0,p.jsxs)("div",{className:"tracked-items-empty",children:[(0,p.jsx)("p",{children:"No tracked issues yet."}),(0,p.jsx)("p",{children:"Issues you create while authenticated will appear here."})]}):s.issues.map(e=>(0,p.jsxs)("div",{className:"tracked-item",children:[(0,p.jsxs)("div",{className:"tracked-item-header",children:[(0,p.jsx)("div",{className:"tracked-item-title",children:(0,p.jsxs)("a",{href:e.html_url,target:"_blank",rel:"noopener noreferrer",className:"tracked-item-link",children:["#",e.number," ",e.title]})}),(0,p.jsxs)("div",{className:"tracked-item-actions",children:[(0,p.jsx)("span",{className:"tracked-item-state",style:{backgroundColor:w(e.state)},children:e.state}),(0,p.jsx)("button",{onClick:()=>(async e=>{try{await u.A.removeTrackedIssue(e),await f()}catch(t){console.error("Failed to remove tracked issue:",t),c("Failed to remove tracked issue")}})(e.number),className:"tracked-item-remove",title:"Stop tracking this issue",children:"\xd7"})]})]}),(0,p.jsxs)("div",{className:"tracked-item-meta",children:[(0,p.jsx)("span",{className:"tracked-item-repo",children:e.repository}),(0,p.jsxs)("span",{className:"tracked-item-date",children:["Created ",b(e.created_at)]})]}),e.labels&&e.labels.length>0&&(0,p.jsx)("div",{className:"tracked-item-labels",children:e.labels.map((e,t)=>(0,p.jsx)("span",{className:"tracked-item-label",style:{backgroundColor:"#".concat(e.color)},children:e.name},t))})]},e.id))}),"pullRequests"===l&&(0,p.jsx)("div",{className:"tracked-items-list",children:0===s.pullRequests.length?(0,p.jsxs)("div",{className:"tracked-items-empty",children:[(0,p.jsx)("p",{children:"No tracked pull requests yet."}),(0,p.jsx)("p",{children:"PRs related to your tracked issues will appear here automatically."})]}):s.pullRequests.map(e=>(0,p.jsxs)("div",{className:"tracked-item",children:[(0,p.jsxs)("div",{className:"tracked-item-header",children:[(0,p.jsx)("div",{className:"tracked-item-title",children:(0,p.jsxs)("a",{href:e.html_url,target:"_blank",rel:"noopener noreferrer",className:"tracked-item-link",children:["#",e.number," ",e.title]})}),(0,p.jsxs)("div",{className:"tracked-item-actions",children:[(0,p.jsx)("span",{className:"tracked-item-state",style:{backgroundColor:w(e.state)},children:e.state}),(0,p.jsx)("button",{onClick:()=>(async e=>{try{await u.A.removeTrackedPR(e),await f()}catch(t){console.error("Failed to remove tracked PR:",t),c("Failed to remove tracked PR")}})(e.number),className:"tracked-item-remove",title:"Stop tracking this PR",children:"\xd7"})]})]}),(0,p.jsxs)("div",{className:"tracked-item-meta",children:[(0,p.jsx)("span",{className:"tracked-item-repo",children:e.repository}),(0,p.jsxs)("span",{className:"tracked-item-date",children:["Created ",b(e.created_at)]})]}),e.linkedIssues&&e.linkedIssues.length>0&&(0,p.jsxs)("div",{className:"tracked-item-linked",children:["Linked to issues: ",e.linkedIssues.map(e=>"#".concat(e)).join(", ")]})]},e.id))})]}),(0,p.jsx)("div",{className:"tracked-items-footer",children:(0,p.jsxs)("p",{className:"tracked-items-help",children:["Items are tracked locally in your browser.",h.A.isAuth()?" Use sync to update status from GitHub.":" Login to sync status with GitHub."]})})]})})},f=[{code:"en",name:"language.english",flag:"\ud83c\uddfa\ud83c\uddf8"},{code:"fr",name:"language.french",flag:"\ud83c\uddeb\ud83c\uddf7"},{code:"es",name:"language.spanish",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"ar",name:"language.arabic",flag:"\ud83c\uddf8\ud83c\udde6"},{code:"zh",name:"language.chinese",flag:"\ud83c\udde8\ud83c\uddf3"},{code:"ru",name:"language.russian",flag:"\ud83c\uddf7\ud83c\uddfa"}],b=[{code:"de",name:"Deutsch",englishName:"German",flag:"\ud83c\udde9\ud83c\uddea"},{code:"it",name:"Italiano",englishName:"Italian",flag:"\ud83c\uddee\ud83c\uddf9"},{code:"pt",name:"Portugu\xeas",englishName:"Portuguese",flag:"\ud83c\uddf5\ud83c\uddf9"},{code:"nl",name:"Nederlands",englishName:"Dutch",flag:"\ud83c\uddf3\ud83c\uddf1"},{code:"sv",name:"Svenska",englishName:"Swedish",flag:"\ud83c\uddf8\ud83c\uddea"},{code:"no",name:"Norsk",englishName:"Norwegian",flag:"\ud83c\uddf3\ud83c\uddf4"},{code:"da",name:"Dansk",englishName:"Danish",flag:"\ud83c\udde9\ud83c\uddf0"},{code:"fi",name:"Suomi",englishName:"Finnish",flag:"\ud83c\uddeb\ud83c\uddee"},{code:"pl",name:"Polski",englishName:"Polish",flag:"\ud83c\uddf5\ud83c\uddf1"},{code:"cs",name:"\u010ce\u0161tina",englishName:"Czech",flag:"\ud83c\udde8\ud83c\uddff"},{code:"sk",name:"Sloven\u010dina",englishName:"Slovak",flag:"\ud83c\uddf8\ud83c\uddf0"},{code:"hu",name:"Magyar",englishName:"Hungarian",flag:"\ud83c\udded\ud83c\uddfa"},{code:"ro",name:"Rom\xe2n\u0103",englishName:"Romanian",flag:"\ud83c\uddf7\ud83c\uddf4"},{code:"bg",name:"\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438",englishName:"Bulgarian",flag:"\ud83c\udde7\ud83c\uddec"},{code:"hr",name:"Hrvatski",englishName:"Croatian",flag:"\ud83c\udded\ud83c\uddf7"},{code:"el",name:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",englishName:"Greek",flag:"\ud83c\uddec\ud83c\uddf7"},{code:"sr",name:"\u0421\u0440\u043f\u0441\u043a\u0438",englishName:"Serbian",flag:"\ud83c\uddf7\ud83c\uddf8"},{code:"sl",name:"Sloven\u0161\u010dina",englishName:"Slovenian",flag:"\ud83c\uddf8\ud83c\uddee"},{code:"lv",name:"Latvie\u0161u",englishName:"Latvian",flag:"\ud83c\uddf1\ud83c\uddfb"},{code:"lt",name:"Lietuvi\u0173",englishName:"Lithuanian",flag:"\ud83c\uddf1\ud83c\uddf9"},{code:"et",name:"Eesti",englishName:"Estonian",flag:"\ud83c\uddea\ud83c\uddea"},{code:"mt",name:"Malti",englishName:"Maltese",flag:"\ud83c\uddf2\ud83c\uddf9"},{code:"is",name:"\xcdslenska",englishName:"Icelandic",flag:"\ud83c\uddee\ud83c\uddf8"},{code:"ga",name:"Gaeilge",englishName:"Irish",flag:"\ud83c\uddee\ud83c\uddea"},{code:"cy",name:"Cymraeg",englishName:"Welsh",flag:"\ud83c\udff4"},{code:"eu",name:"Euskera",englishName:"Basque",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"ca",name:"Catal\xe0",englishName:"Catalan",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"gl",name:"Galego",englishName:"Galician",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"tr",name:"T\xfcrk\xe7e",englishName:"Turkish",flag:"\ud83c\uddf9\ud83c\uddf7"},{code:"he",name:"\u05e2\u05d1\u05e8\u05d9\u05ea",englishName:"Hebrew",flag:"\ud83c\uddee\ud83c\uddf1"},{code:"fa",name:"\u0641\u0627\u0631\u0633\u06cc",englishName:"Persian",flag:"\ud83c\uddee\ud83c\uddf7"},{code:"ur",name:"\u0627\u0631\u062f\u0648",englishName:"Urdu",flag:"\ud83c\uddf5\ud83c\uddf0"},{code:"ku",name:"Kurd\xee",englishName:"Kurdish",flag:"\ud83c\uddf9\ud83c\uddf7"},{code:"az",name:"Az\u0259rbaycan",englishName:"Azerbaijani",flag:"\ud83c\udde6\ud83c\uddff"},{code:"hy",name:"\u0540\u0561\u0575\u0565\u0580\u0565\u0576",englishName:"Armenian",flag:"\ud83c\udde6\ud83c\uddf2"},{code:"ka",name:"\u10e5\u10d0\u10e0\u10d7\u10e3\u10da\u10d8",englishName:"Georgian",flag:"\ud83c\uddec\ud83c\uddea"},{code:"ja",name:"\u65e5\u672c\u8a9e",englishName:"Japanese",flag:"\ud83c\uddef\ud83c\uddf5"},{code:"ko",name:"\ud55c\uad6d\uc5b4",englishName:"Korean",flag:"\ud83c\uddf0\ud83c\uddf7"},{code:"hi",name:"\u0939\u093f\u0928\u094d\u0926\u0940",englishName:"Hindi",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"th",name:"\u0e44\u0e17\u0e22",englishName:"Thai",flag:"\ud83c\uddf9\ud83c\udded"},{code:"vi",name:"Ti\u1ebfng Vi\u1ec7t",englishName:"Vietnamese",flag:"\ud83c\uddfb\ud83c\uddf3"},{code:"bn",name:"\u09ac\u09be\u0982\u09b2\u09be",englishName:"Bengali",flag:"\ud83c\udde7\ud83c\udde9"},{code:"ta",name:"\u0ba4\u0bae\u0bbf\u0bb4\u0bcd",englishName:"Tamil",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"te",name:"\u0c24\u0c46\u0c32\u0c41\u0c17\u0c41",englishName:"Telugu",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"ml",name:"\u0d2e\u0d32\u0d2f\u0d3e\u0d33\u0d02",englishName:"Malayalam",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"kn",name:"\u0c95\u0ca8\u0ccd\u0ca8\u0ca1",englishName:"Kannada",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"gu",name:"\u0a97\u0ac1\u0a9c\u0ab0\u0abe\u0aa4\u0ac0",englishName:"Gujarati",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"mr",name:"\u092e\u0930\u093e\u0920\u0940",englishName:"Marathi",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"pa",name:"\u0a2a\u0a70\u0a1c\u0a3e\u0a2c\u0a40",englishName:"Punjabi",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"or",name:"\u0b13\u0b21\u0b3c\u0b3f\u0b06",englishName:"Odia",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"as",name:"\u0985\u09b8\u09ae\u09c0\u09af\u09bc\u09be",englishName:"Assamese",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"ne",name:"\u0928\u0947\u092a\u093e\u0932\u0940",englishName:"Nepali",flag:"\ud83c\uddf3\ud83c\uddf5"},{code:"si",name:"\u0dc3\u0dd2\u0d82\u0dc4\u0dbd",englishName:"Sinhala",flag:"\ud83c\uddf1\ud83c\uddf0"},{code:"my",name:"\u1019\u103c\u1014\u103a\u1019\u102c",englishName:"Myanmar",flag:"\ud83c\uddf2\ud83c\uddf2"},{code:"km",name:"\u1781\u17d2\u1798\u17c2\u179a",englishName:"Khmer",flag:"\ud83c\uddf0\ud83c\udded"},{code:"lo",name:"\u0ea5\u0eb2\u0ea7",englishName:"Lao",flag:"\ud83c\uddf1\ud83c\udde6"},{code:"mn",name:"\u041c\u043e\u043d\u0433\u043e\u043b",englishName:"Mongolian",flag:"\ud83c\uddf2\ud83c\uddf3"},{code:"bo",name:"\u0f56\u0f7c\u0f51\u0f0b\u0f61\u0f72\u0f42",englishName:"Tibetan",flag:"\ud83c\udde8\ud83c\uddf3"},{code:"dz",name:"\u0f62\u0fab\u0f7c\u0f44\u0f0b\u0f41",englishName:"Dzongkha",flag:"\ud83c\udde7\ud83c\uddf9"},{code:"id",name:"Bahasa Indonesia",englishName:"Indonesian",flag:"\ud83c\uddee\ud83c\udde9"},{code:"ms",name:"Bahasa Melayu",englishName:"Malay",flag:"\ud83c\uddf2\ud83c\uddfe"},{code:"tl",name:"Filipino",englishName:"Filipino",flag:"\ud83c\uddf5\ud83c\udded"},{code:"ceb",name:"Cebuano",englishName:"Cebuano",flag:"\ud83c\uddf5\ud83c\udded"},{code:"jv",name:"Basa Jawa",englishName:"Javanese",flag:"\ud83c\uddee\ud83c\udde9"},{code:"sw",name:"Kiswahili",englishName:"Swahili",flag:"\ud83c\uddf0\ud83c\uddea"},{code:"am",name:"\u12a0\u121b\u122d\u129b",englishName:"Amharic",flag:"\ud83c\uddea\ud83c\uddf9"},{code:"yo",name:"Yor\xf9b\xe1",englishName:"Yoruba",flag:"\ud83c\uddf3\ud83c\uddec"},{code:"ig",name:"Igbo",englishName:"Igbo",flag:"\ud83c\uddf3\ud83c\uddec"},{code:"ha",name:"Hausa",englishName:"Hausa",flag:"\ud83c\uddf3\ud83c\uddec"},{code:"zu",name:"isiZulu",englishName:"Zulu",flag:"\ud83c\uddff\ud83c\udde6"},{code:"af",name:"Afrikaans",englishName:"Afrikaans",flag:"\ud83c\uddff\ud83c\udde6"},{code:"xh",name:"isiXhosa",englishName:"Xhosa",flag:"\ud83c\uddff\ud83c\udde6"},{code:"st",name:"Sesotho",englishName:"Sotho",flag:"\ud83c\uddf1\ud83c\uddf8"},{code:"tn",name:"Setswana",englishName:"Tswana",flag:"\ud83c\udde7\ud83c\uddfc"},{code:"ss",name:"SiSwati",englishName:"Swati",flag:"\ud83c\uddf8\ud83c\uddff"},{code:"ve",name:"Tshiven\u1e13a",englishName:"Venda",flag:"\ud83c\uddff\ud83c\udde6"},{code:"ts",name:"Xitsonga",englishName:"Tsonga",flag:"\ud83c\uddff\ud83c\udde6"},{code:"sn",name:"ChiShona",englishName:"Shona",flag:"\ud83c\uddff\ud83c\uddfc"},{code:"ny",name:"ChiChe\u0175a",englishName:"Chewa",flag:"\ud83c\uddf2\ud83c\uddfc"},{code:"rw",name:"Kinyarwanda",englishName:"Kinyarwanda",flag:"\ud83c\uddf7\ud83c\uddfc"},{code:"rn",name:"Kirundi",englishName:"Kirundi",flag:"\ud83c\udde7\ud83c\uddee"},{code:"lg",name:"Luganda",englishName:"Luganda",flag:"\ud83c\uddfa\ud83c\uddec"},{code:"so",name:"Soomaali",englishName:"Somali",flag:"\ud83c\uddf8\ud83c\uddf4"},{code:"om",name:"Afaan Oromoo",englishName:"Oromo",flag:"\ud83c\uddea\ud83c\uddf9"},{code:"ti",name:"\u1275\u130d\u122d\u129b",englishName:"Tigrinya",flag:"\ud83c\uddea\ud83c\uddf7"},{code:"qu",name:"Quechua",englishName:"Quechua",flag:"\ud83c\uddf5\ud83c\uddea"},{code:"gn",name:"Guaran\xed",englishName:"Guarani",flag:"\ud83c\uddf5\ud83c\uddfe"},{code:"ay",name:"Aymar\xe1",englishName:"Aymara",flag:"\ud83c\udde7\ud83c\uddf4"},{code:"mi",name:"Te Reo M\u0101ori",englishName:"Maori",flag:"\ud83c\uddf3\ud83c\uddff"},{code:"sm",name:"Gagana Samoa",englishName:"Samoan",flag:"\ud83c\uddfc\ud83c\uddf8"},{code:"to",name:"Lea Faka-Tonga",englishName:"Tongan",flag:"\ud83c\uddf9\ud83c\uddf4"},{code:"fj",name:"Na Vosa Vakaviti",englishName:"Fijian",flag:"\ud83c\uddeb\ud83c\uddef"},{code:"fo",name:"F\xf8royskt",englishName:"Faroese",flag:"\ud83c\uddeb\ud83c\uddf4"},{code:"kl",name:"Kalaallisut",englishName:"Greenlandic",flag:"\ud83c\uddec\ud83c\uddf1"},{code:"se",name:"Davvis\xe1megiella",englishName:"Northern Sami",flag:"\ud83c\uddf3\ud83c\uddf4"},{code:"eo",name:"Esperanto",englishName:"Esperanto",flag:"\ud83c\udf0d"},{code:"la",name:"Latina",englishName:"Latin",flag:"\ud83c\uddfb\ud83c\udde6"},{code:"sa",name:"\u0938\u0902\u0938\u094d\u0915\u0943\u0924\u092e\u094d",englishName:"Sanskrit",flag:"\ud83c\uddee\ud83c\uddf3"}],w=e=>{let{className:t=""}=e;const{i18n:s,t:r}=(0,a.Bd)(),[i,c]=(0,o.useState)(!1),[l,d]=(0,o.useState)(""),[u,h]=(0,o.useState)(()=>{const e=localStorage.getItem("sgex-selected-languages");return e?JSON.parse(e):f.map(e=>e.code)}),g=(0,o.useMemo)(()=>{const e=[...f];return u.forEach(t=>{if(!f.some(e=>e.code===t)){const s=b.find(e=>e.code===t);s&&e.push({code:s.code,name:s.name,englishName:s.englishName,flag:s.flag})}}),e.map(e=>(0,n.A)((0,n.A)({},e),{},{name:f.some(t=>t.code===e.code)?r(e.name):e.name}))},[u,r]),m=(0,o.useMemo)(()=>{if(!l)return[];const e=l.toLowerCase();return b.filter(t=>!u.includes(t.code)&&(t.name.toLowerCase().includes(e)||t.englishName.toLowerCase().includes(e)||t.code.toLowerCase().includes(e))).slice(0,10)},[l,u]),w=g.find(e=>e.code===s.language)||g[0];return(0,p.jsxs)("div",{className:"language-selector ".concat(t),children:[(0,p.jsxs)("button",{className:"language-toggle",onClick:()=>c(!i),"aria-label":r("language.select"),title:r("language.select"),children:[(0,p.jsx)("span",{className:"language-icon",children:"\ud83d\udc3e\ud83c\udfa7"}),(0,p.jsx)("span",{className:"language-name",children:null===w||void 0===w?void 0:w.name}),(0,p.jsx)("span",{className:"dropdown-arrow ".concat(i?"open":""),children:"\u25bc"})]}),i&&(0,p.jsxs)("div",{className:"language-dropdown",children:[g.map(e=>(0,p.jsxs)("button",{className:"language-option ".concat(s.language===e.code?"active":""),onClick:()=>{return t=e.code,s.changeLanguage(t),c(!1),void d("");var t},children:[(0,p.jsx)("span",{className:"language-flag",children:e.flag}),(0,p.jsx)("span",{className:"language-name",children:e.name}),s.language===e.code&&(0,p.jsx)("span",{className:"language-checkmark",children:"\u2713"})]},e.code)),(0,p.jsxs)("div",{className:"language-search-section",children:[(0,p.jsx)("div",{className:"language-search-divider"}),(0,p.jsx)("div",{className:"language-search-input",children:(0,p.jsx)("input",{type:"text",placeholder:r("language.search"),value:l,onChange:e=>{d(e.target.value)},className:"language-search",autoFocus:!1})}),m.map(e=>(0,p.jsxs)("button",{className:"language-option language-option-addable",onClick:()=>(e=>{const t=[...u,e];h(t),localStorage.setItem("sgex-selected-languages",JSON.stringify(t)),s.changeLanguage(e),c(!1),d("")})(e.code),children:[(0,p.jsx)("span",{className:"language-flag",children:e.flag}),(0,p.jsxs)("span",{className:"language-name",children:[e.name,e.englishName!==e.name&&(0,p.jsxs)("span",{className:"language-english-name",children:[" (",e.englishName,")"]})]}),(0,p.jsx)("span",{className:"language-add-icon",children:"+"})]},e.code)),l&&0===m.length&&(0,p.jsxs)("div",{className:"language-no-results",children:['No languages found for "',l,'"']})]})]})]})};var y=s(88259),v=s(6947),k=s(95388);const x=e=>{let{pageId:t,helpContent:s,position:i="bottom-right",contextData:c={},notificationBadge:l=!1}=e;const{t:f,i18n:b}=(0,a.Bd)(),[x,S]=(0,o.useState)(!1),[N,A]=(0,o.useState)(!1),[C,j]=(0,o.useState)(null),[_,T]=(0,o.useState)("dark"===(0,v.zy)()),[I,R]=(0,o.useState)(!1),[E,D]=(0,o.useState)(!1),[P,F]=(0,o.useState)(!1),[G,H]=(0,o.useState)(0),[O,L]=(0,o.useState)(!1),B=(0,y.A)("sgex-mascot.png");(0,o.useEffect)(()=>{const e=(0,v.zy)();T("dark"===e)},[]),(0,o.useEffect)(()=>{const e=b.language||"en",t=["ar","he","fa"].includes(e);document.documentElement.dir=t?"rtl":"ltr",document.documentElement.lang=e},[b.language]),(0,o.useEffect)(()=>{const e=async()=>{const e=h.A.isAuth();if(L(e),e)try{const e=await u.A.getTrackedCounts();H(e.total)}catch(t){console.warn("Failed to get tracked items count:",t),H(0)}else H(0)};e();const t=setInterval(e,3e4);return()=>clearInterval(t)},[]),(0,o.useEffect)(()=>(O?u.A.startBackgroundSync():u.A.stopBackgroundSync(),()=>{u.A.stopBackgroundSync()}),[O]);const M=()=>{const e=(0,v.OD)();T("dark"===e)},U=[...t?r.A.getHelpTopicsForPage(t,c):[],...O&&G>0?[{id:"tracked-items",title:"Tracked Items (".concat(G,")"),badge:"/sgex/cat-paw-icon.svg",type:"action",action:()=>F(!0),notificationBadge:G}]:[],...O&&0===G?[{id:"tracked-items-empty",title:"Tracked Items",badge:"/sgex/cat-paw-icon.svg",type:"action",action:()=>F(!0)}]:[]],q=async()=>{if(!I){R(!0),D(!1);try{d.clearAllCache()?(D(!0),setTimeout(()=>{D(!1)},3e3)):(console.error("Failed to clear cache"),alert("Failed to clear cache. Please try again."))}catch(e){console.error("Error clearing cache:",e),alert("Error clearing cache. Please try again.")}finally{R(!1)}}};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"contextual-help-mascot ".concat(i),children:[(0,p.jsxs)("div",{className:"mascot-container",onMouseEnter:()=>{N||S(!0)},onMouseLeave:()=>{N||S(!1)},onClick:()=>{A(!N),S(!N||x)},children:[(0,p.jsx)("img",{src:B,alt:(0,k.lm)(f,k.ld.MASCOT_HELPER,"SGEX Helper"),className:"mascot-icon"}),(l||O&&G>0)&&(0,p.jsx)("div",{className:"notification-badge",children:O&&G>0?G:"!"}),!l&&!(O&&G>0)&&(0,p.jsx)("div",{className:"question-bubble ".concat(x?"help-open":""),children:"?"})]}),x&&(0,p.jsxs)("div",{className:"help-thought-bubble",children:[(0,p.jsxs)("div",{className:"bubble-content",children:[N&&(0,p.jsx)("button",{className:"close-bubble-btn",onClick:()=>{S(!1),A(!1)},"aria-label":"Close help",children:"\xd7"}),(0,p.jsx)("div",{className:"help-text",children:U.length>0?(0,p.jsxs)("div",{className:"help-topics-list",children:[(0,p.jsx)("h4",{children:f("help.title")}),U.map(e=>(0,p.jsxs)("button",{className:"help-topic-btn",onClick:()=>(e=>{if(e.tutorialId)return j((0,n.A)((0,n.A)({},e),{},{type:"enhanced-tutorial"})),S(!1),void A(!1);"action"===e.type&&e.action?(e.action(),S(!1),A(!1)):(j(e),S(!1),A(!1))})(e),children:[e.badge&&(0,p.jsx)("img",{src:e.badge,alt:"",className:"help-topic-badge"}),(0,p.jsx)("span",{className:"help-topic-title",children:e.title}),e.notificationBadge&&(0,p.jsx)("span",{className:"help-topic-notification-badge",children:e.notificationBadge})]},e.id)),(0,p.jsx)("div",{className:"help-menu-divider"}),(0,p.jsx)(w,{className:"help-menu-language-selector"}),(0,p.jsx)("div",{className:"help-menu-divider"}),(0,p.jsxs)("button",{className:"help-theme-toggle-btn ".concat(_?"dark":"light"),onClick:M,"aria-label":f("theme.toggle"),title:f("theme.toggle"),children:[(0,p.jsx)("span",{className:"theme-icon",children:_?"\ud83c\udf1e":"\ud83c\udf19"}),(0,p.jsx)("span",{className:"theme-label",children:_?f("theme.switchToLight","Light Mode"):f("theme.switchToDark","Dark Mode")})]}),(0,p.jsx)("div",{className:"help-menu-divider"}),(0,p.jsx)("div",{className:"help-menu-cache-section",children:E?(0,p.jsx)("div",{className:"cache-success-message",children:"\u2705 Cache cleared successfully!"}):(0,p.jsx)("button",{className:"help-cache-btn",onClick:q,disabled:I,title:"Clear all cached data including repository info, branch context, and staging ground data",children:I?"\ud83d\udd04 Clearing...":"\ud83d\uddd1\ufe0f Flush Cache"})})]}):(0,p.jsxs)("div",{children:[s,(0,p.jsx)("div",{className:"help-menu-divider"}),(0,p.jsx)(w,{className:"help-menu-language-selector"}),(0,p.jsx)("div",{className:"help-menu-divider"}),(0,p.jsxs)("button",{className:"help-theme-toggle-btn ".concat(_?"dark":"light"),onClick:M,"aria-label":f("theme.toggle"),title:f("theme.toggle"),children:[(0,p.jsx)("span",{className:"theme-icon",children:_?"\ud83c\udf1e":"\ud83c\udf19"}),(0,p.jsx)("span",{className:"theme-label",children:_?f("theme.switchToLight","Light Mode"):f("theme.switchToDark","Dark Mode")})]}),(0,p.jsx)("div",{className:"help-menu-divider"}),(0,p.jsx)("div",{className:"help-menu-cache-section",children:E?(0,p.jsx)("div",{className:"cache-success-message",children:"\u2705 Cache cleared successfully!"}):(0,p.jsx)("button",{className:"help-cache-btn",onClick:q,disabled:I,title:"Clear all cached data including repository info, branch context, and staging ground data",children:I?"\ud83d\udd04 Clearing...":"\ud83d\uddd1\ufe0f Flush Cache"})})]})})]}),(0,p.jsx)("div",{className:"bubble-tail"})]})]}),C&&(0,p.jsx)(g.A,{helpTopic:C,tutorialId:"enhanced-tutorial"===C.type?C.tutorialId:null,contextData:c,onClose:()=>{j(null)}}),P&&(0,p.jsx)(m,{onClose:()=>F(!1)})]})}},29473:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(85571);const o=new class{constructor(){this.CACHE_KEY_PREFIX="sgex_repo_cache_",this.CACHE_EXPIRY_HOURS=24,this.logger=n.A.getLogger("RepositoryCacheService"),this.logger.debug("RepositoryCacheService initialized",{cacheExpiryHours:this.CACHE_EXPIRY_HOURS})}getCacheKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n="".concat(this.CACHE_KEY_PREFIX).concat(t,"_").concat(e);return s?"".concat(n,"_").concat(s):n}isStale(e){return Date.now()-e>60*this.CACHE_EXPIRY_HOURS*60*1e3}getCachedRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{var n;const o=this.getCacheKey(e,t,s);this.logger.cache("get",o);const a=localStorage.getItem(o);if(!a)return this.logger.cache("miss",o,"No cached data found"),null;const r=JSON.parse(a);return this.isStale(r.timestamp)?(this.logger.cache("expired",o,{age:Date.now()-r.timestamp}),localStorage.removeItem(o),null):(this.logger.cache("hit",o,{repositoryCount:(null===(n=r.repositories)||void 0===n?void 0:n.length)||0,age:Date.now()-r.timestamp}),{repositories:r.repositories,timestamp:r.timestamp,owner:r.owner,type:r.type})}catch(o){const n=this.getCacheKey(e,t,s);return this.logger.error("Error reading repository cache",{cacheKey:n,error:o.message}),console.warn("Error reading repository cache:",o),null}}setCachedRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",s=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";try{const o=this.getCacheKey(e,t,n),a={repositories:s,timestamp:Date.now(),owner:e,type:t};return this.logger.cache("set",o,{repositoryCount:(null===s||void 0===s?void 0:s.length)||0,owner:e,type:t}),localStorage.setItem(o,JSON.stringify(a)),!0}catch(o){const s=this.getCacheKey(e,t,n);return this.logger.error("Error caching repositories",{cacheKey:s,error:o.message}),console.warn("Error caching repositories:",o),!1}}clearCache(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";try{const s=this.getCacheKey(e,t);return this.logger.cache("clear",s,{owner:e,type:t}),localStorage.removeItem(s),!0}catch(s){const n=this.getCacheKey(e,t);return this.logger.error("Error clearing repository cache",{cacheKey:n,error:s.message}),console.warn("Error clearing repository cache:",s),!1}}clearAllCaches(){try{return Object.keys(localStorage).forEach(e=>{e.startsWith(this.CACHE_KEY_PREFIX)&&localStorage.removeItem(e)}),!0}catch(e){return console.warn("Error clearing all repository caches:",e),!1}}getCacheInfo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const n=this.getCachedRepositories(e,t,s);if(!n)return{exists:!1,stale:!0};const o=Date.now()-n.timestamp,a=Math.round(o/36e5);return{exists:!0,stale:this.isStale(n.timestamp),age:o,ageHours:a,repositoryCount:n.repositories.length,timestamp:new Date(n.timestamp).toISOString()}}}},29946:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(89379),o=s(38659);async function a(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{concurrency:n=5,onProgress:o=null,onItemComplete:a=null,onItemStart:r=null}=s;if(!e||0===e.length)return[];const i=new Array(e.length),c=e.length;let l=0;const d=e.map((e,t)=>({item:e,index:t})),u=Array(Math.min(n,e.length)).fill().map(()=>(async()=>{for(;d.length>0;){const{item:s,index:n}=d.shift();r&&r(s,n);try{const e=await t(s,n);i[n]=e,l++,o&&o(l,c,s,e),a&&a(s,e,null)}catch(e){i[n]={error:e,item:s},l++,o&&o(l,c,s,null),a&&a(s,null,e)}}})());return await Promise.all(u),i}const r=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;this.cache=new Map,this.ttl=60*e*1e3}_getCacheKey(e,t){return"".concat(e,"/").concat(t)}_isValid(e){return Date.now()-e.timestamp<this.ttl}get(e,t){const s=this._getCacheKey(e,t),n=this.cache.get(s);return n?this._isValid(n)?n.compatible:(this.cache.delete(s),null):null}set(e,t,s){const n=this._getCacheKey(e,t);this.cache.set(n,{compatible:s,timestamp:Date.now()})}clear(){this.cache.clear()}cleanup(){const e=Date.now();for(const[t,s]of this.cache.entries())e-s.timestamp>=this.ttl&&this.cache.delete(t)}getStats(){return this.cleanup(),{size:this.cache.size,ttlMinutes:this.ttl/6e4,entries:Array.from(this.cache.entries()).map(e=>{let[t,s]=e;return{repository:t,compatible:s.compatible,ageMinutes:Math.round((Date.now()-s.timestamp)/6e4)}})}}};var i=s(85571);const c=new class{constructor(){this.logger=i.A.getLogger("SecureTokenStorage"),this.storageKey="sgex_secure_token",this.expirationHours=24,this.logger.debug("SecureTokenStorage instance created")}generateBrowserFingerprint(){const e=document.createElement("canvas"),t=e.getContext("2d");t.textBaseline="top",t.font="14px Arial",t.fillText("Browser fingerprint",2,2);const s=[navigator.userAgent,navigator.language,window.screen.width+"x"+window.screen.height,window.screen.colorDepth,(new Date).getTimezoneOffset(),e.toDataURL()].join("|");let n=0;for(let o=0;o<s.length;o++){n=(n<<5)-n+s.charCodeAt(o),n&=n}return Math.abs(n).toString(36)}xorCipher(e,t){let s="";for(let n=0;n<e.length;n++)s+=String.fromCharCode(e.charCodeAt(n)^t.charCodeAt(n%t.length));return s}validateTokenFormat(e){if(!e||"string"!==typeof e)return{isValid:!1,type:"invalid",reason:"Token is empty or not a string"};const t=e.trim();return t.match(/^ghp_[A-Za-z0-9]{36}$/)?{isValid:!0,type:"classic",token:t}:t.match(/^github_pat_[A-Za-z0-9]{22}_[A-Za-z0-9]{59}$/)?{isValid:!0,type:"fine-grained",token:t}:t.match(/^gho_[A-Za-z0-9]{36}$/)?{isValid:!0,type:"oauth",token:t}:t.match(/^[a-fA-F0-9]{40}$/)?{isValid:!0,type:"legacy",token:t}:{isValid:!1,type:"invalid",reason:"Token does not match expected GitHub PAT format"}}maskToken(e){if(!e||"string"!==typeof e)return"[INVALID_TOKEN]";const t=e.trim();return t.length<8?"[INVALID_TOKEN]":"".concat(t.substring(0,4)).concat("*".repeat(t.length-8)).concat(t.substring(t.length-4))}storeToken(e){try{this.logger.debug("Starting secure token storage");const t=this.validateTokenFormat(e);if(!t.isValid)return this.logger.warn("Token validation failed",{reason:t.reason,tokenMask:this.maskToken(e)}),!1;this.logger.debug("Token validation successful",{type:t.type,tokenMask:this.maskToken(e)});const s=this.generateBrowserFingerprint(),n="sgex_".concat(s,"_").concat(Date.now().toString(36)),o=this.xorCipher(t.token,n),a={token:btoa(o),key:btoa(n),type:t.type,created:Date.now(),expires:Date.now()+60*this.expirationHours*60*1e3,fingerprint:s};return sessionStorage.setItem(this.storageKey,JSON.stringify(a)),localStorage.removeItem("github_token"),sessionStorage.removeItem("github_token"),this.logger.debug("Token stored securely",{type:t.type,expires:new Date(a.expires).toISOString(),tokenMask:this.maskToken(e)}),!0}catch(t){return this.logger.error("Failed to store token securely",{error:t.message,tokenMask:this.maskToken(e)}),!1}}retrieveToken(){try{this.logger.debug("Attempting to retrieve secure token");const e=sessionStorage.getItem(this.storageKey);if(!e)return this.logger.debug("No secure token found in storage"),null;const t=JSON.parse(e);if(Date.now()>t.expires)return this.logger.warn("Stored token has expired"),this.clearToken(),null;const s=this.generateBrowserFingerprint();if(t.fingerprint!==s)return this.logger.warn("Browser fingerprint mismatch - possible security issue"),this.clearToken(),null;const n=atob(t.key),o=atob(t.token),a=this.xorCipher(o,n),r=this.validateTokenFormat(a);return r.isValid?(this.logger.debug("Token retrieved and decrypted successfully",{type:t.type,expires:new Date(t.expires).toISOString(),tokenMask:this.maskToken(a)}),{token:r.token,type:t.type,created:t.created,expires:t.expires}):(this.logger.error("Decrypted token failed validation"),this.clearToken(),null)}catch(e){return this.logger.error("Failed to retrieve secure token",{error:e.message}),this.clearToken(),null}}hasValidToken(){try{const e=sessionStorage.getItem(this.storageKey);if(!e)return!1;const t=JSON.parse(e);if(Date.now()>t.expires)return this.clearToken(),!1;const s=this.generateBrowserFingerprint();return t.fingerprint===s||(this.clearToken(),!1)}catch(e){return this.logger.error("Error checking token validity",{error:e.message}),this.clearToken(),!1}}clearToken(){this.logger.debug("Clearing secure token storage"),sessionStorage.removeItem(this.storageKey),sessionStorage.removeItem("github_token"),localStorage.removeItem("github_token")}getTokenInfo(){try{const e=sessionStorage.getItem(this.storageKey);if(!e)return null;const t=JSON.parse(e),s=t.expires-Date.now();return{type:t.type,created:new Date(t.created),expires:new Date(t.expires),timeRemaining:Math.max(0,s),isExpired:s<=0,isValid:this.hasValidToken()}}catch(e){return this.logger.error("Error getting token info",{error:e.message}),null}}migrateLegacyToken(){try{const e=sessionStorage.getItem("github_token")||localStorage.getItem("github_token");if(!e)return this.logger.debug("No legacy token found for migration"),!1;this.logger.debug("Migrating legacy token to secure storage");return this.storeToken(e)?(sessionStorage.removeItem("github_token"),localStorage.removeItem("github_token"),this.logger.debug("Legacy token migration completed successfully"),!0):(this.logger.error("Failed to migrate legacy token"),!1)}catch(e){return this.logger.error("Error during legacy token migration",{error:e.message}),!1}}};const l=new class{constructor(){this.octokit=null,this.isAuthenticated=!1,this.permissions=null,this.tokenType=null,this.logger=i.A.getLogger("GitHubService"),this.logger.debug("GitHubService instance created")}async createOctokitInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new(await(0,o.sN)())(e?{auth:e}:{})}async authenticate(e){const t=Date.now();this.logger.auth("Starting authentication",{tokenProvided:!!e,tokenMask:e?c.maskToken(e):"none"});try{const s=c.validateTokenFormat(e);if(!s.isValid)return this.logger.warn("Token validation failed during authentication",{reason:s.reason,tokenMask:c.maskToken(e)}),this.isAuthenticated=!1,!1;this.octokit=await this.createOctokitInstance(s.token),this.isAuthenticated=!0,this.tokenType=s.type;const n=c.storeToken(s.token);n||this.logger.warn("Failed to store token securely, authentication will not persist");const o=Date.now()-t;return this.logger.auth("Authentication successful",{duration:o,tokenType:this.tokenType,tokenMask:c.maskToken(e),securelyStored:n}),this.logger.performance("GitHub authentication",o),!0}catch(s){const n=Date.now()-t;return this.logger.auth("Authentication failed",{error:s.message,duration:n,tokenMask:c.maskToken(e)}),console.error("Failed to authenticate with GitHub:",s),this.isAuthenticated=!1,c.clearToken(),!1}}authenticateWithOctokit(e){this.logger.auth("Starting OAuth authentication with Octokit instance");try{return this.octokit=e,this.isAuthenticated=!0,this.tokenType="oauth",this.logger.auth("OAuth authentication successful",{tokenType:this.tokenType}),!0}catch(t){return this.logger.auth("OAuth authentication failed",{error:t.message}),console.error("Failed to authenticate with Octokit instance:",t),this.isAuthenticated=!1,!1}}async initializeFromStoredToken(){this.logger.auth("Attempting to initialize from stored token");try{c.migrateLegacyToken()&&this.logger.debug("Successfully migrated legacy token to secure storage");const e=c.retrieveToken();return e?(this.octokit=await this.createOctokitInstance(e.token),this.isAuthenticated=!0,this.tokenType=e.type,this.logger.auth("Successfully initialized from stored token",{tokenType:this.tokenType,tokenMask:c.maskToken(e.token),expires:new Date(e.expires).toISOString()}),!0):(this.logger.debug("No valid stored token found"),!1)}catch(e){return this.logger.auth("Failed to initialize from stored token",{error:e.message}),this.isAuthenticated=!1,c.clearToken(),!1}}hasStoredToken(){return c.hasValidToken()}getStoredTokenInfo(){return c.getTokenInfo()}async checkTokenPermissions(){if(!this.isAuth()){const e=new Error("Not authenticated with GitHub");throw this.logger.error("Token permission check failed - not authenticated"),e}const e=Date.now();this.logger.apiCall("GET","/user",null);try{const s=await this.octokit.request("GET /user");this.logger.apiResponse("GET","/user",s.status,Date.now()-e);try{const e=Date.now();this.logger.apiCall("GET","/rate_limit",null);const t=await this.octokit.rest.rateLimit.get();this.logger.apiResponse("GET","/rate_limit",t.status,Date.now()-e),this.tokenType=t.data.resources.core?"classic":"fine-grained",this.logger.debug("Token type determined",{tokenType:this.tokenType,hasCore:!!t.data.resources.core})}catch(t){this.tokenType="unknown",this.logger.warn("Could not determine token type from rate limit",{error:t.message})}const n={type:this.tokenType,user:s.data};return this.permissions=n,this.logger.debug("Token permissions checked successfully",{tokenType:this.tokenType,username:s.data.login}),n}catch(s){const t=Date.now()-e;throw this.logger.apiError("GET","/user",s),this.logger.performance("Token permission check (failed)",t),console.error("Failed to check token permissions:",s),s}}async checkRepositoryWritePermissions(e,t){if(!this.isAuth())return this.logger.warn("Cannot check repository write permissions - not authenticated",{owner:e,repo:t}),!1;const s=Date.now();this.logger.debug("Checking write permissions for repository",{owner:e,repo:t});try{const n=(await this.getCurrentUser()).login;this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/collaborators/").concat(n,"/permission"),null);const{data:o}=await this.octokit.rest.repos.getCollaboratorPermissionLevel({owner:e,repo:t,username:n}),a=Date.now()-s;this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/collaborators/").concat(n,"/permission"),200,a);const r=["write","maintain","admin"].includes(o.permission);return this.logger.debug("Repository write permissions checked",{owner:e,repo:t,permission:o.permission,hasWriteAccess:r,supportedLevels:["write","maintain","admin"]}),r}catch(a){var n,o;const r=Date.now()-s;return this.logger.apiError("GET","/repos/".concat(e,"/").concat(t,"/collaborators/*/permission"),a),this.logger.performance("Repository write permission check (failed)",r),console.warn("Could not check repository write permissions for ".concat(e,"/").concat(t,":"),{error:a.message,status:a.status,statusText:null===(n=a.response)||void 0===n?void 0:n.statusText,headers:null===(o=a.response)||void 0===o?void 0:o.headers}),this.logger.warn("Assuming no write access due to permission check failure",{owner:e,repo:t,error:a.message,status:a.status,userGuidance:"Check if your Personal Access Token has the required scopes: repo (classic) or Contents+Pull requests (fine-grained)"}),!1}}async checkRepositoryPermissions(e,t){return this.checkRepositoryWritePermissions(e,t)}async checkCommentPermissions(e,t){if(!this.isAuth())return this.logger.warn("Cannot check comment permissions - not authenticated",{owner:e,repo:t}),!1;const s=Date.now();this.logger.debug("Checking comment permissions for repository",{owner:e,repo:t});try{this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/issues"),{per_page:1}),await this.octokit.rest.issues.listForRepo({owner:e,repo:t,per_page:1,state:"all"});const n=Date.now()-s;return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues"),200,n),this.logger.debug("Issues endpoint accessible - comment permissions likely available",{owner:e,repo:t}),!0}catch(n){const o=Date.now()-s;return this.logger.apiError("GET","/repos/".concat(e,"/").concat(t,"/issues"),n),this.logger.performance("Comment permission check (failed)",o),403===n.status||401===n.status?(this.logger.warn("Token does not have permission to access issues/comments",{owner:e,repo:t,error:n.message,status:n.status}),!1):(this.logger.warn("Could not determine comment permissions, assuming available",{owner:e,repo:t,error:n.message}),!0)}}isAuth(){return this.isAuthenticated&&null!==this.octokit}async getCurrentUser(){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:e}=await this.octokit.rest.users.getAuthenticated();return e}catch(e){throw console.error("Failed to fetch user data:",e),e}}async getUserOrganizations(){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:e}=await this.octokit.rest.orgs.listForAuthenticatedUser();return e}catch(e){throw console.error("Failed to fetch organizations:",e),e}}async getOrganization(e){try{const t=this.octokit||await this.createOctokitInstance(),{data:s}=await t.rest.orgs.get({org:e});return s}catch(t){throw console.error("Failed to fetch organization ".concat(e,":"),t),t}}async getUser(e){try{const t=this.octokit||await this.createOctokitInstance(),{data:s}=await t.rest.users.getByUsername({username:e});return s}catch(t){throw console.error("Failed to fetch user ".concat(e,":"),t),t}}async getPublicRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";try{const s=this.octokit||await this.createOctokitInstance();let n=[],o=1,a=!0;for(;a;){let r;r="user"===t?await s.rest.repos.listForUser({username:e,sort:"updated",per_page:100,page:o}):await s.rest.repos.listForOrg({org:e,sort:"updated",per_page:100,page:o}),n=n.concat(r.data),a=100===r.data.length,o++}return n}catch(s){throw console.error("Failed to fetch public repositories for ".concat(e,":"),s),s}}async getWHOOrganization(){try{const e=await this.getOrganization("WorldHealthOrganization");return{id:e.id,login:e.login,display_name:e.name||"World Health Organization",description:e.description||"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:e.avatar_url,html_url:e.html_url,type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0}}catch(e){return console.warn("Could not fetch WHO organization data from API, using fallback:",e),{id:"who-organization",login:"WorldHealthOrganization",display_name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0}}}async checkRateLimit(){try{const e=this.octokit||await this.createOctokitInstance(),{data:t}=await e.rest.rateLimit.get();return{core:{limit:t.rate.limit,remaining:t.rate.remaining,reset:t.rate.reset,used:t.rate.used},search:{limit:t.search.limit,remaining:t.search.remaining,reset:t.search.reset,used:t.search.used},isAuthenticated:this.isAuthenticated}}catch(e){return console.warn("Could not check rate limit:",e),{core:{limit:this.isAuthenticated?5e3:60,remaining:0,reset:Date.now()+36e5,used:this.isAuthenticated?5e3:60},search:{limit:this.isAuthenticated?30:10,remaining:0,reset:Date.now()+6e4,used:this.isAuthenticated?30:10},isAuthenticated:this.isAuthenticated}}}async shouldSkipApiCalls(){if(this.isAuthenticated)return!1;try{const e=(await this.checkRateLimit()).core.remaining;return e<10&&(console.warn("\ud83d\udeab Rate limit protection: Only ".concat(e," API calls remaining, skipping compatibility checks")),!0)}catch(e){return console.warn("\u26a0\ufe0f Cannot check rate limits, enabling conservative mode"),!this.isAuthenticated}}async getRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";return this.getSmartGuidelinesRepositories(e,t)}async checkSmartGuidelinesCompatibility(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=r.get(e,t);if(null!==n)return{compatible:n,cached:!0};if(!this.isAuthenticated)try{if(await this.shouldSkipApiCalls())return console.warn("\u26a1 Skipping compatibility check for ".concat(e,"/").concat(t," due to rate limit protection")),{compatible:!1,skipped:!0,reason:"Rate limit protection - API call skipped"}}catch(o){console.warn("Could not check rate limits, proceeding with API call:",o)}try{const s=this.octokit||await this.createOctokitInstance(),{data:n}=await s.rest.repos.getContent({owner:e,repo:t,path:"sushi-config.yaml"});if("file"===n.type&&n.content){const s=decodeURIComponent(escape(atob(n.content))).includes("smart.who.int.base");return r.set(e,t,s),{compatible:s}}return r.set(e,t,!1),{compatible:!1,reason:"No sushi-config.yaml file found"}}catch(a){if(404===a.status&&s>0){console.warn("File not found for ".concat(e,"/").concat(t,", retrying... (").concat(s," attempts left)"));const n=1e3;return await new Promise(e=>setTimeout(e,n)),this.checkSmartGuidelinesCompatibility(e,t,s-1)}if(403===a.status&&a.message.includes("SAML enforcement")&&this.octokit){console.log("SAML-protected repository ".concat(e,"/").concat(t,", trying public API fallback"));try{const s=await this.createOctokitInstance(),{data:n}=await s.rest.repos.getContent({owner:e,repo:t,path:"sushi-config.yaml"});if("file"===n.type&&n.content){const s=decodeURIComponent(escape(atob(n.content)));return s.includes("smart.who.int.base")?(console.log("Repository ".concat(e,"/").concat(t," is compatible via public API despite SAML protection")),r.set(e,t,!0),{compatible:!0,reason:"SMART Guidelines DAK (SAML-protected, verified via public API)",requiresAuthentication:!0}):(r.set(e,t,!1),{compatible:!1,reason:"No smart.who.int.base dependency found (via public API)"})}}catch(i){console.warn("Public API fallback also failed for ".concat(e,"/").concat(t,":"),i.message)}}const n={compatible:!1,error:a.message,errorType:this._categorizeError(a),status:a.status,retryable:this._isRetryableError(a)};return console.warn("Failed to check ".concat(e,"/").concat(t," for sushi-config.yaml with smart.who.int.base dependency:"),a.message),r.set(e,t,!1),n}}_categorizeError(e){return 403===e.status?e.message.includes("rate limit")?"rate_limit":"permission_denied":404===e.status?"not_found":401===e.status?"authentication_failed":"ENOTFOUND"===e.code||"ECONNRESET"===e.code?"network_error":"unknown_error"}_isRetryableError(e){return["rate_limit","network_error"].includes(this._categorizeError(e))}async getSmartGuidelinesRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let o=[];if(this.isAuth()){let s=1,n=!0;for(;n;){let a;a="user"===t?await this.octokit.rest.repos.listForUser({username:e,sort:"updated",per_page:100,page:s}):await this.octokit.rest.repos.listForOrg({org:e,sort:"updated",per_page:100,page:s}),o=o.concat(a.data),n=100===a.data.length,s++}}else o=await this.getPublicRepositories(e,t);if(s)return console.log("\u26a1 Skipping compatibility checks for ".concat(o.length," repositories to avoid rate limiting")),o.map(e=>(0,n.A)((0,n.A)({},e),{},{smart_guidelines_compatible:!0}));const a=[];for(const e of o){(await this.checkSmartGuidelinesCompatibility(e.owner.login,e.name)).compatible&&a.push((0,n.A)((0,n.A)({},e),{},{smart_guidelines_compatible:!0}))}return a}catch(o){throw console.error("Failed to fetch SMART guidelines repositories:",o),o}}async getSmartGuidelinesRepositoriesProgressive(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;try{let i=[],c=1,l=!0;if(this.isAuth())for(;l;){let s;s="user"===t?await this.octokit.rest.repos.listForUser({username:e,sort:"updated",per_page:100,page:c}):await this.octokit.rest.repos.listForOrg({org:e,sort:"updated",per_page:100,page:c}),i=i.concat(s.data),l=100===s.data.length,c++}else i=await this.getPublicRepositories(e,t);if(0===i.length)return console.log("\ud83d\udcca No repositories found for user, completing scan immediately"),o&&o({current:0,total:0,currentRepo:"none",progress:100,completed:!0}),[];const d={rateLimited:[],networkErrors:[],permissionDenied:[],otherErrors:[],totalErrors:0,totalScanned:0},u=async(e,t)=>{await new Promise(e=>setTimeout(e,100+200*Math.random()));const o=await this.checkSmartGuidelinesCompatibility(e.owner.login,e.name);if(d.totalScanned++,o.compatible){const t=(0,n.A)((0,n.A)({},e),{},{smart_guidelines_compatible:!0});return s&&s(t),t}if(o.error){d.totalErrors++;const t={repo:e.name,error:o.error,errorType:o.errorType,retryable:o.retryable};switch(o.errorType){case"rate_limit":d.rateLimited.push(t);break;case"network_error":d.networkErrors.push(t);break;case"permission_denied":d.permissionDenied.push(t);break;default:d.otherErrors.push(t)}r&&r(t)}return null},h=(await a(i,u,{concurrency:5,onProgress:(e,t,s,n)=>{if(o){const n={current:e,total:t,currentRepo:s.name,progress:Math.round(e/t*100),completed:!0,scanningErrors:d.totalErrors>0?{totalErrors:d.totalErrors,rateLimitedCount:d.rateLimited.length,networkErrorCount:d.networkErrors.length,hasRetryableErrors:[...d.rateLimited,...d.networkErrors].some(e=>e.retryable)}:null};o(n)}},onItemStart:(e,t)=>{o&&o({current:t+1,total:i.length,currentRepo:e.name,progress:Math.round((t+1)/i.length*100),completed:!1,started:!0})}})).filter(e=>null!==e&&!e.error);return d.totalErrors>0&&(console.warn("Repository scanning completed with ".concat(d.totalErrors," errors out of ").concat(d.totalScanned," repositories checked:")),d.rateLimited.length>0&&console.warn("- Rate limited: ".concat(d.rateLimited.length," repositories")),d.networkErrors.length>0&&console.warn("- Network errors: ".concat(d.networkErrors.length," repositories")),d.permissionDenied.length>0&&console.warn("- Permission denied: ".concat(d.permissionDenied.length," repositories")),d.otherErrors.length>0&&console.warn("- Other errors: ".concat(d.otherErrors.length," repositories"))),{repositories:h,scanningErrors:d.totalErrors>0?d:null}}catch(i){throw console.error("Failed to fetch SMART guidelines repositories:",i),i}}async getRepository(e,t){try{const s=this.isAuth()?this.octokit:await this.createOctokitInstance(),{data:n}=await s.rest.repos.get({owner:e,repo:t});return n}catch(s){throw console.error("Failed to fetch repository:",s),s}}async getBranches(e,t){try{console.log("githubService.getBranches: Fetching branches for ".concat(e,"/").concat(t)),console.log("githubService.getBranches: Authentication status:",this.isAuth());const s=this.isAuth()?this.octokit:await this.createOctokitInstance();console.log("githubService.getBranches: Using",this.isAuth()?"authenticated":"public","octokit instance");const{data:n}=await s.rest.repos.listBranches({owner:e,repo:t,per_page:100});return console.log("githubService.getBranches: Successfully fetched ".concat(n.length," branches")),n}catch(s){throw console.error("githubService.getBranches: Failed to fetch branches:",s),console.error("githubService.getBranches: Error details:",{status:s.status,message:s.message,owner:e,repo:t}),s}}async createBranch(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main";if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:o}=await this.octokit.rest.git.getRef({owner:e,repo:t,ref:"heads/".concat(n)}),{data:a}=await this.octokit.rest.git.createRef({owner:e,repo:t,ref:"refs/heads/".concat(s),sha:o.object.sha});return a}catch(o){throw console.error("Failed to create branch:",o),o}}async getBranch(e,t,s){try{const n=this.isAuth()?this.octokit:await this.createOctokitInstance(),{data:o}=await n.rest.repos.getBranch({owner:e,repo:t,branch:s});return o}catch(n){throw console.error("Failed to fetch branch:",n),n}}async getWorkflows(e,t){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:s}=await this.octokit.rest.actions.listRepoWorkflows({owner:e,repo:t});return s.workflows.map(e=>({id:e.id,name:e.name,filename:e.path.split("/").pop(),path:e.path,state:e.state,created_at:e.created_at,updated_at:e.updated_at,url:e.html_url,triggers:["unknown"],lastModified:e.updated_at}))}catch(s){if(404===s.status)return[];throw console.error("Failed to fetch workflows:",s),s}}async getWorkflowRuns(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const n={owner:e,repo:t,per_page:s.per_page||10,page:s.page||1};s.branch&&(n.branch=s.branch),s.workflow_id&&(n.workflow_id=s.workflow_id);const{data:o}=await this.octokit.rest.actions.listWorkflowRunsForRepo(n);return o}catch(n){throw console.error("Failed to fetch workflow runs:",n),n}}async getWorkflowRunsForWorkflow(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const o={owner:e,repo:t,workflow_id:s,per_page:n.per_page||10,page:n.page||1};n.branch&&(o.branch=n.branch);const{data:a}=await this.octokit.rest.actions.listWorkflowRuns(o);return a}catch(o){throw console.error("Failed to fetch workflow runs for workflow:",o),o}}async triggerWorkflow(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:a}=await this.octokit.rest.actions.createWorkflowDispatch({owner:e,repo:t,workflow_id:s,ref:n,inputs:o});return a}catch(a){throw console.error("Failed to trigger workflow:",a),a}}async rerunWorkflow(e,t,s){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.actions.reRunWorkflow({owner:e,repo:t,run_id:s});return n}catch(n){throw console.error("Failed to re-run workflow:",n),n}}async getWorkflowRunLogs(e,t,s){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.actions.downloadWorkflowRunLogs({owner:e,repo:t,run_id:s});return n}catch(n){throw console.error("Failed to get workflow run logs:",n),n}}async approveWorkflowRun(e,t,s){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.actions.approveWorkflowRun({owner:e,repo:t,run_id:s});return n}catch(n){throw console.error("Failed to approve workflow run:",n),n}}async getCommitDiff(e,t,s,n){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:o}=await this.octokit.rest.repos.compareCommits({owner:e,repo:t,base:s,head:n});return o}catch(o){throw console.error("Failed to get commit diff:",o),o}}async getCommit(e,t,s){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.repos.getCommit({owner:e,repo:t,ref:s});return n}catch(n){throw console.error("Failed to get commit details:",n),n}}async getReleases(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.repos.listReleases({owner:e,repo:t,per_page:s.per_page||10,page:s.page||1});return n}catch(n){throw console.error("Failed to fetch releases:",n),n}}async getLatestRelease(e,t){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:s}=await this.octokit.rest.repos.getLatestRelease({owner:e,repo:t});return s}catch(s){throw console.error("Failed to fetch latest release:",s),s}}async getBpmnFilesRecursive(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];try{console.log("\ud83d\udd0e githubService.getBpmnFilesRecursive: Searching ".concat(e,"/").concat(t,"/").concat(s," (ref: ").concat(n,")"));const a=this.isAuth()?this.octokit:await this.createOctokitInstance();console.log("\ud83d\udd10 githubService.getBpmnFilesRecursive: Using ".concat(this.isAuth()?"authenticated":"public"," octokit"));const{data:r}=await a.rest.repos.getContent({owner:e,repo:t,path:s,ref:n});if(console.log("\ud83d\udce6 githubService.getBpmnFilesRecursive: Received data type: ".concat(Array.isArray(r)?"array":"single file",", length: ").concat(Array.isArray(r)?r.length:1)),!Array.isArray(r))return r.name.endsWith(".bpmn")&&(console.log("\ud83d\udcc4 githubService.getBpmnFilesRecursive: Found single BPMN file: ".concat(r.name)),o.push(r)),o;for(const s of r)"file"===s.type&&s.name.endsWith(".bpmn")?(console.log("\ud83d\udcc4 githubService.getBpmnFilesRecursive: Found BPMN file: ".concat(s.name)),o.push(s)):"dir"===s.type&&(console.log("\ud83d\udcc1 githubService.getBpmnFilesRecursive: Found subdirectory: ".concat(s.name,", recursing...")),await this.getBpmnFilesRecursive(e,t,s.path,n,o));return console.log("\u2705 githubService.getBpmnFilesRecursive: Completed search of ".concat(s,", found ").concat(o.length," total files so far")),o}catch(a){if(console.log("\u274c githubService.getBpmnFilesRecursive: Error searching ".concat(s,":"),a.status,a.message),404===a.status)return o;throw a}}async getBpmnFiles(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";console.log("\ud83d\udd0d githubService.getBpmnFiles: Starting search for ".concat(e,"/").concat(t," (ref: ").concat(s,")"));const n=[],o=["input/business-processes","input/business-process"];for(const i of o)try{console.log("\ud83d\udcc1 githubService.getBpmnFiles: Searching in directory: ".concat(i));const o=await this.getBpmnFilesRecursive(e,t,i,s);console.log("\u2705 githubService.getBpmnFiles: Found ".concat(o.length," BPMN files in ").concat(i)),n.push(...o)}catch(r){404!==r.status?console.warn("\u274c Could not fetch BPMN files from ".concat(i,":"),r.message):console.log("\ud83d\udcc2 githubService.getBpmnFiles: Directory ".concat(i," not found (404) - this is expected if the directory doesn't exist"))}const a=n.filter((e,t,s)=>t===s.findIndex(t=>t.path===e.path));return console.log("\ud83c\udfaf githubService.getBpmnFiles: Final result - ".concat(a.length," unique BPMN files found")),console.log("\ud83d\udccb githubService.getBpmnFiles: File list:",a.map(e=>e.name)),a}async getFileContent(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main";const o=15e3;try{console.log("\ud83d\ude80 githubService.getFileContent: Starting request for ".concat(e,"/").concat(t,"/").concat(s," (ref: ").concat(n,")")),console.log("\ud83d\udd10 githubService.getFileContent: Authentication status:",this.isAuth()),console.log("\ud83d\udccb githubService.getFileContent: Request parameters:",{owner:e,repo:t,path:s,ref:n});const a=this.isAuth()?this.octokit:await this.createOctokitInstance();console.log("\ud83d\udd27 githubService.getFileContent: Using",this.isAuth()?"authenticated":"public","octokit instance");const r=new Promise((e,t)=>{console.log("\u23f0 githubService.getFileContent: Setting up ".concat(o,"ms timeout")),setTimeout(()=>{console.error("\u23f0 githubService.getFileContent: Request timed out after ".concat(o,"ms")),t(new Error("Request timeout after ".concat(o,"ms")))},o)});console.log("\ud83c\udf10 githubService.getFileContent: Creating GitHub API promise...");const i=a.rest.repos.getContent({owner:e,repo:t,path:s,ref:n});console.log("\ud83d\udce1 githubService.getFileContent: API request initiated, waiting for response...");const c=Date.now(),{data:l}=await Promise.race([i,r]),d=Date.now()-c;if(console.log("\u2705 githubService.getFileContent: API response received in ".concat(d,"ms")),console.log("\ud83d\udcc2 githubService.getFileContent: Response data type:",l.type),console.log("\ud83d\udcca githubService.getFileContent: Response details:",{type:l.type,name:l.name,size:l.size,encoding:l.encoding,hasContent:!!l.content}),"file"===l.type&&l.content){console.log("\ud83d\udd27 githubService.getFileContent: Decoding base64 content..."),console.log("\ud83d\udcca githubService.getFileContent: Base64 content length:",l.content.length);const e=decodeURIComponent(escape(atob(l.content)));return console.log("\u2705 githubService.getFileContent: Successfully fetched and decoded file content"),console.log("\ud83d\udccf githubService.getFileContent: Final content length:",e.length,"characters"),console.log("\ud83d\udc40 githubService.getFileContent: Content preview (first 200 chars):",e.substring(0,200)),e}throw console.error("\u274c githubService.getFileContent: Invalid response - not a file or no content"),console.error("\ud83d\udd0d githubService.getFileContent: Full response data:",JSON.stringify(l,null,2)),new Error("File not found or is not a file")}catch(r){var a;if(console.error("\ud83d\udca5 githubService.getFileContent: Failed to fetch file content from ".concat(e,"/").concat(t,"/").concat(s,":"),r),console.error("\ud83d\udd0d githubService.getFileContent: Error analysis:",{type:typeof r,status:r.status,message:r.message,name:r.name,stack:(null===(a=r.stack)||void 0===a?void 0:a.substring(0,500))+"..."}),r.message.includes("timeout"))throw console.error("\u23f0 githubService.getFileContent: Timeout error detected"),new Error("GitHub API request timed out after ".concat(15," seconds. Please try again."));if(403===r.status)throw console.error("\ud83d\udd12 githubService.getFileContent: 403 Forbidden error detected"),new Error("Access denied. This repository may be private or you may have hit rate limits.");if(404===r.status)throw console.error("\ud83d\udd0d githubService.getFileContent: 404 Not Found error detected"),new Error("File not found in the repository.");if(r.message.includes("rate limit"))throw console.error("\ud83d\udea6 githubService.getFileContent: Rate limit error detected"),new Error("GitHub API rate limit exceeded. Please try again later.");if(r.message.includes("Network Error")||r.message.includes("Failed to fetch"))throw console.error("\ud83c\udf10 githubService.getFileContent: Network error detected"),new Error("Network error occurred. Please check your internet connection and try again.");throw console.error("\u2753 githubService.getFileContent: Unknown error type, re-throwing original error"),r}}async createCommit(e,t,s,n,o){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:a}=await this.octokit.rest.git.getRef({owner:e,repo:t,ref:"heads/".concat(s)}),r=a.object.sha,{data:i}=await this.octokit.rest.git.getCommit({owner:e,repo:t,commit_sha:r}),c=i.tree.sha,l=await Promise.all(o.map(async s=>{const{data:n}=await this.octokit.rest.git.createBlob({owner:e,repo:t,content:s.content,encoding:"utf-8"});return{path:s.path,mode:"100644",type:"blob",sha:n.sha}})),{data:d}=await this.octokit.rest.git.createTree({owner:e,repo:t,base_tree:c,tree:l}),{data:u}=await this.octokit.rest.git.createCommit({owner:e,repo:t,message:n,tree:d.sha,parents:[r]});return await this.octokit.rest.git.updateRef({owner:e,repo:t,ref:"heads/".concat(s),sha:u.sha}),{sha:u.sha,html_url:"https://github.com/".concat(e,"/").concat(t,"/commit/").concat(u.sha),message:u.message,author:u.author,committer:u.committer}}catch(a){throw console.error("Failed to create commit:",a),a}}async getRecentCommits(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;if(!this.isAuth())throw new Error("Not authenticated with GitHub");const o=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/commits"),{sha:s,per_page:n});try{const a=await this.octokit.rest.repos.listCommits({owner:e,repo:t,sha:s,per_page:n});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/commits"),a.status,Date.now()-o),a.data.map(e=>({sha:e.sha,message:e.commit.message,author:{name:e.commit.author.name,email:e.commit.author.email,date:e.commit.author.date},committer:{name:e.commit.committer.name,email:e.commit.committer.email,date:e.commit.committer.date},html_url:e.html_url,stats:e.stats}))}catch(a){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/commits"),a.status||"error",Date.now()-o),console.error("Failed to fetch recent commits:",a),a}}async getOpenPullRequestsCount(e,t){if(!this.isAuth())throw new Error("Not authenticated with GitHub");const s=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls"),{state:"open",per_page:1});try{const n=await this.octokit.rest.pulls.list({owner:e,repo:t,state:"open",per_page:1});this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),n.status,Date.now()-s);const o=n.headers.link;if(o&&o.includes('rel="last"')){const e=o.match(/page=(\d+)>; rel="last"/);if(e)return parseInt(e[1],10)}return n.data.length}catch(n){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),n.status||"error",Date.now()-s),console.error("Failed to fetch pull requests count:",n),n}}async getPullRequestForBranch(e,t,s){const n=await this.getPullRequestsForBranch(e,t,s);return n&&n.length>0?n[0]:null}async getPullRequestsForBranch(e,t,s){const n=this.isAuth()?this.octokit:await this.createOctokitInstance(),o=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls"),{state:"open",head:"".concat(e,":").concat(s)});try{const a=await n.rest.pulls.list({owner:e,repo:t,state:"open",head:"".concat(e,":").concat(s),per_page:100});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),a.status,Date.now()-o),a.data||[]}catch(a){return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),a.status||"error",Date.now()-o),console.error("Failed to fetch pull requests for branch:",a),[]}}async getPullRequestComments(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;const a=this.isAuth()?this.octokit:await this.createOctokitInstance(),r=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s,"/comments"),{page:n,per_page:o});try{const i=await a.rest.pulls.listReviewComments({owner:e,repo:t,pull_number:s,page:n,per_page:o});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s,"/comments"),i.status,Date.now()-r),i.data}catch(i){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s,"/comments"),i.status||"error",Date.now()-r),console.error("Failed to fetch pull request comments:",i),i}}async getPullRequestIssueComments(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;const a=this.isAuth()?this.octokit:await this.createOctokitInstance(),r=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(s,"/comments"),{page:n,per_page:o});try{const i=await a.rest.issues.listComments({owner:e,repo:t,issue_number:s,page:n,per_page:o});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(s,"/comments"),i.status,Date.now()-r),i.data}catch(i){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(s,"/comments"),i.status||"error",Date.now()-r),console.error("Failed to fetch pull request issue comments:",i),i}}async createPullRequestComment(e,t,s,n){if(!this.isAuth())throw new Error("Not authenticated with GitHub");const o=Date.now();this.logger.apiCall("POST","/repos/".concat(e,"/").concat(t,"/issues/").concat(s,"/comments"),{body:n});try{const a=await this.octokit.rest.issues.createComment({owner:e,repo:t,issue_number:s,body:n});return this.logger.apiResponse("POST","/repos/".concat(e,"/").concat(t,"/issues/").concat(s,"/comments"),a.status,Date.now()-o),a.data}catch(a){throw this.logger.apiResponse("POST","/repos/".concat(e,"/").concat(t,"/issues/").concat(s,"/comments"),a.status||"error",Date.now()-o),console.error("Failed to create pull request comment:",a),a}}async getPullRequestTimeline(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;const a=this.isAuth()?this.octokit:await this.createOctokitInstance(),r=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(s,"/timeline"),{page:n,per_page:o});try{const i=await a.rest.issues.listEventsForTimeline({owner:e,repo:t,issue_number:s,page:n,per_page:o});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(s,"/timeline"),i.status,Date.now()-r),i.data}catch(i){return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(s,"/timeline"),i.status||"error",Date.now()-r),console.debug("Failed to fetch pull request timeline:",i),[]}}async mergePullRequest(e,t,s){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!this.isAuth())throw new Error("Not authenticated with GitHub");const a=Date.now();this.logger.apiCall("PUT","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s,"/merge"),o);try{const r=(0,n.A)({owner:e,repo:t,pull_number:s,commit_title:o.commit_title,commit_message:o.commit_message,merge_method:o.merge_method||"merge"},o),i=await this.octokit.rest.pulls.merge(r);return this.logger.apiResponse("PUT","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s,"/merge"),i.status,Date.now()-a),i.data}catch(r){throw this.logger.apiResponse("PUT","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s,"/merge"),r.status||"error",Date.now()-a),console.error("Failed to merge pull request:",r),r}}async checkPullRequestMergePermissions(e,t,s){if(!this.isAuth())return this.logger.warn("Cannot check PR merge permissions - not authenticated",{owner:e,repo:t,pullNumber:s}),!1;try{const n=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s),{});const o=await this.octokit.rest.pulls.get({owner:e,repo:t,pull_number:s});this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s),o.status,Date.now()-n);const a=o.data;if("open"!==a.state)return this.logger.debug("PR not mergeable - not open",{owner:e,repo:t,pullNumber:s,state:a.state}),!1;if(a.draft)return this.logger.debug("PR not mergeable - is draft",{owner:e,repo:t,pullNumber:s}),!1;return!!await this.checkRepositoryWritePermissions(e,t)||(this.logger.debug("PR not mergeable - no write access",{owner:e,repo:t,pullNumber:s}),!1)}catch(n){return this.logger.warn("Error checking PR merge permissions",{owner:e,repo:t,pullNumber:s,error:n.message}),!1}}async getOpenIssuesCount(e,t){if(!this.isAuth())throw new Error("Not authenticated with GitHub");const s=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/issues"),{state:"open",per_page:1});try{const n=await this.octokit.rest.issues.listForRepo({owner:e,repo:t,state:"open",per_page:1});this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues"),n.status,Date.now()-s);const o=n.headers.link;if(o&&o.includes('rel="last"')){const e=o.match(/page=(\d+)>; rel="last"/);if(e)return parseInt(e[1],10)}return n.data.length}catch(n){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues"),n.status||"error",Date.now()-s),console.error("Failed to fetch issues count:",n),n}}async getRepositoryStats(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const[n,o,a]=await Promise.allSettled([this.getRecentCommits(e,t,s,1),this.getOpenPullRequestsCount(e,t),this.getOpenIssuesCount(e,t)]);return{recentCommits:"fulfilled"===n.status?n.value:[],openPullRequestsCount:"fulfilled"===o.status?o.value:0,openIssuesCount:"fulfilled"===a.status?a.value:0,errors:{recentCommits:"rejected"===n.status?n.reason:null,openPullRequestsCount:"rejected"===o.status?o.reason:null,openIssuesCount:"rejected"===a.status?a.reason:null}}}catch(n){throw console.error("Failed to fetch repository stats:",n),n}}async getDirectoryContents(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main";try{const o=this.isAuth()?this.octokit:await this.createOctokitInstance(),{data:a}=await o.rest.repos.getContent({owner:e,repo:t,path:s,ref:n});if(Array.isArray(a))return a;throw new Error("Not a directory")}catch(o){throw console.error("Failed to get directory contents for ".concat(s,":"),o),o}}async updateFile(e,t,s,n,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"main";if(!this.isAuth())throw new Error("Authentication required to update files");try{const{data:r}=await this.octokit.rest.repos.getContent({owner:e,repo:t,path:s,ref:a});if(Array.isArray(r))throw new Error("Path is a directory, not a file");const{data:i}=await this.octokit.rest.repos.createOrUpdateFileContents({owner:e,repo:t,path:s,message:o,content:btoa(unescape(encodeURIComponent(n))),sha:r.sha,branch:a});return i}catch(r){throw console.error("Failed to update file ".concat(s,":"),r),r}}async getCommits(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const n=this.isAuth()?this.octokit:await this.createOctokitInstance(),o={owner:e,repo:t,per_page:s.per_page||10,page:s.page||1};s.sha&&(o.sha=s.sha),s.since&&(o.since=s.since),s.until&&(o.until=s.until);const{data:a}=await n.rest.repos.listCommits(o);return a}catch(n){throw console.error("Failed to fetch commits:",n),n}}async getIssues(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const n=this.isAuth()?this.octokit:await this.createOctokitInstance(),o={owner:e,repo:t,state:s.state||"all",per_page:s.per_page||30,page:s.page||1};s.labels&&(o.labels=s.labels),s.milestone&&(o.milestone=s.milestone);const{data:a}=await n.rest.issues.listForRepo(o);return a}catch(n){throw console.error("Failed to fetch issues:",n),n}}async getRepositoryIssues(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getIssues(e,t,s)}async getForks(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/forks"),s);try{const o=this.isAuth()?this.octokit:await this.createOctokitInstance(),a={owner:e,repo:t,sort:s.sort||"newest",per_page:s.per_page||100,page:s.page||1},{data:r}=await o.rest.repos.listForks(a);return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/forks"),200,Date.now()-n),r.map(e=>({id:e.id,name:e.name,full_name:e.full_name,owner:{login:e.owner.login,avatar_url:e.owner.avatar_url,html_url:e.owner.html_url,type:e.owner.type},description:e.description,html_url:e.html_url,clone_url:e.clone_url,created_at:e.created_at,updated_at:e.updated_at,pushed_at:e.pushed_at,stargazers_count:e.stargazers_count,forks_count:e.forks_count,open_issues_count:e.open_issues_count,default_branch:e.default_branch,private:e.private,fork:e.fork,parent:e.parent?{full_name:e.parent.full_name,html_url:e.parent.html_url}:null}))}catch(o){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/forks"),o.status||"error",Date.now()-n),console.error("Failed to fetch repository forks:",o),o}}async getPullRequests(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls"),s);try{const o=this.isAuth()?this.octokit:await this.createOctokitInstance(),a={owner:e,repo:t,state:s.state||"open",sort:s.sort||"updated",direction:s.direction||"desc",per_page:s.per_page||30,page:s.page||1};s.head&&(a.head=s.head),s.base&&(a.base=s.base);const{data:r}=await o.rest.pulls.list(a);return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),200,Date.now()-n),r.map(e=>({id:e.id,number:e.number,title:e.title,body:e.body,state:e.state,locked:e.locked,user:{login:e.user.login,avatar_url:e.user.avatar_url,html_url:e.user.html_url,type:e.user.type},created_at:e.created_at,updated_at:e.updated_at,closed_at:e.closed_at,merged_at:e.merged_at,html_url:e.html_url,diff_url:e.diff_url,patch_url:e.patch_url,head:{ref:e.head.ref,sha:e.head.sha,repo:e.head.repo?{name:e.head.repo.name,full_name:e.head.repo.full_name,owner:{login:e.head.repo.owner.login,avatar_url:e.head.repo.owner.avatar_url},html_url:e.head.repo.html_url}:null},base:{ref:e.base.ref,sha:e.base.sha,repo:{name:e.base.repo.name,full_name:e.base.repo.full_name,owner:{login:e.base.repo.owner.login,avatar_url:e.base.repo.owner.avatar_url},html_url:e.base.repo.html_url}},draft:e.draft,mergeable:e.mergeable,mergeable_state:e.mergeable_state,comments:e.comments,review_comments:e.review_comments,commits:e.commits,additions:e.additions,deletions:e.deletions,changed_files:e.changed_files}))}catch(o){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),o.status||"error",Date.now()-n),console.error("Failed to fetch pull requests:",o),o}}async createIssue(e,t,s,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];if(!this.isAuth())throw new Error("Authentication required to create issues");const r=Date.now();this.logger.apiCall("POST","/repos/".concat(e,"/").concat(t,"/issues"),{title:s,bodyLength:null===n||void 0===n?void 0:n.length,labels:o,assignees:a});try{const i={owner:e,repo:t,title:s,body:n};o.length>0&&(i.labels=o),a.length>0&&(i.assignees=a);const c=await this.octokit.rest.issues.create(i);return this.logger.apiResponse("POST","/repos/".concat(e,"/").concat(t,"/issues"),c.status,Date.now()-r),{success:!0,issue:{id:c.data.id,number:c.data.number,title:c.data.title,body:c.data.body,html_url:c.data.html_url,state:c.data.state,created_at:c.data.created_at,user:{login:c.data.user.login,avatar_url:c.data.user.avatar_url},labels:c.data.labels.map(e=>({name:e.name,color:e.color}))}}}catch(i){return this.logger.apiResponse("POST","/repos/".concat(e,"/").concat(t,"/issues"),i.status||"error",Date.now()-r),console.error("Failed to create issue:",i),{success:!1,error:{message:i.message,status:i.status,type:403===i.status?"permission_denied":422===i.status?"validation_error":404===i.status?"repository_not_found":"unknown_error"}}}}async getIssue(e,t,s){if(!this.isAuth())throw new Error("Authentication required to get issue details");const n=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(s));try{const o=await this.octokit.rest.issues.get({owner:e,repo:t,issue_number:s});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(s),o.status,Date.now()-n),{id:o.data.id,number:o.data.number,title:o.data.title,body:o.data.body,html_url:o.data.html_url,state:o.data.state,created_at:o.data.created_at,updated_at:o.data.updated_at,closed_at:o.data.closed_at,user:{login:o.data.user.login,avatar_url:o.data.user.avatar_url},labels:o.data.labels.map(e=>({name:e.name,color:e.color}))}}catch(o){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(s),o.status||"error",Date.now()-n),console.error("Failed to get issue:",o),o}}async getPullRequest(e,t,s){if(!this.isAuth())throw new Error("Authentication required to get pull request details");const n=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s));try{const o=await this.octokit.rest.pulls.get({owner:e,repo:t,pull_number:s});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s),o.status,Date.now()-n),{id:o.data.id,number:o.data.number,title:o.data.title,body:o.data.body,html_url:o.data.html_url,state:o.data.state,created_at:o.data.created_at,updated_at:o.data.updated_at,closed_at:o.data.closed_at,merged_at:o.data.merged_at,user:{login:o.data.user.login,avatar_url:o.data.user.avatar_url},head:{ref:o.data.head.ref,sha:o.data.head.sha},base:{ref:o.data.base.ref,sha:o.data.base.sha}}}catch(o){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(s),o.status||"error",Date.now()-n),console.error("Failed to get pull request:",o),o}}async searchPullRequests(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isAuth())throw new Error("Authentication required to search pull requests");const s=Date.now();this.logger.apiCall("GET","/search/issues",{query:e,type:"pr"});try{const n=await this.octokit.rest.search.issuesAndPullRequests({q:e,sort:t.sort||"created",order:t.order||"desc",per_page:t.per_page||30,page:t.page||1});return this.logger.apiResponse("GET","/search/issues",n.status,Date.now()-s),{total_count:n.data.total_count,incomplete_results:n.data.incomplete_results,items:n.data.items.map(e=>({id:e.id,number:e.number,title:e.title,body:e.body,html_url:e.html_url,state:e.state,created_at:e.created_at,updated_at:e.updated_at,closed_at:e.closed_at,user:{login:e.user.login,avatar_url:e.user.avatar_url},repository:e.repository_url?{name:e.repository_url.split("/").slice(-1)[0],full_name:e.repository_url.split("/").slice(-2).join("/")}:null}))}}catch(n){throw this.logger.apiResponse("GET","/search/issues",n.status||"error",Date.now()-s),console.error("Failed to search pull requests:",n),n}}logout(){this.logger.auth("Logging out and clearing stored token"),this.octokit=null,this.isAuthenticated=!1,this.tokenType=null,this.permissions=null,c.clearToken();try{const{default:e}=s(18354);e.clearAllBranchContext()}catch(e){sessionStorage.removeItem("sgex_branch_context")}}async getRepositoryForks(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Date.now();this.logger.debug("Fetching repository forks",{owner:e,repo:t,options:s});try{const o=this.isAuth()?this.octokit:await this.createOctokitInstance();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/forks"),s);const{data:a}=await o.rest.repos.listForks({owner:e,repo:t,sort:"newest",per_page:s.per_page||100,page:s.page||1}),r=Date.now()-n;return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/forks"),200,r,{forkCount:a.length}),this.logger.performance("Repository forks fetch",r),a}catch(o){const s=Date.now()-n;throw this.logger.apiError("GET","/repos/".concat(e,"/").concat(t,"/forks"),o),this.logger.performance("Repository forks fetch (failed)",s),console.error("Failed to fetch forks for ".concat(e,"/").concat(t,":"),o),o}}}},51635:(e,t,s)=>{s.d(t,{ox:()=>ee,Mx:()=>B,oc:()=>U,HX:()=>M});var n=s(9950),o=s(89379),a=s(91018),r=s(29946),i=s(88498);const c=new class{constructor(){this.storageKey="sgex-profile-subscriptions",this.whoProfile="WorldHealthOrganization"}getSubscriptions(){try{const e=localStorage.getItem(this.storageKey),t=e?JSON.parse(e):[];return t.find(e=>e.login===this.whoProfile)||(t.unshift({login:this.whoProfile,name:"World Health Organization",avatar_url:"https://github.com/".concat(this.whoProfile,".png"),type:"Organization",isPermanent:!0,addedAt:(new Date).toISOString()}),this.saveSubscriptions(t)),t}catch(e){return console.warn("Error reading profile subscriptions from localStorage:",e),[{login:this.whoProfile,name:"World Health Organization",avatar_url:"https://github.com/".concat(this.whoProfile,".png"),type:"Organization",isPermanent:!0,addedAt:(new Date).toISOString()}]}}saveSubscriptions(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){throw console.error("Error saving profile subscriptions to localStorage:",t),t}}addSubscription(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||!e.login)throw new Error("Profile must have a login property");const s=this.getSubscriptions(),n=s.findIndex(t=>t.login===e.login);if(-1!==n)return s[n]=(0,o.A)((0,o.A)((0,o.A)({},s[n]),e),{},{isPermanent:s[n].isPermanent||t,lastUpdated:(new Date).toISOString()}),this.saveSubscriptions(s),s[n];const a={login:e.login,name:e.name||e.login,avatar_url:e.avatar_url||"https://github.com/".concat(e.login,".png"),type:e.type||"User",isPermanent:t,addedAt:(new Date).toISOString(),lastUpdated:(new Date).toISOString()};return s.push(a),this.saveSubscriptions(s),a}removeSubscription(e){if(!e)return!1;try{const t=this.getSubscriptions(),s=t.findIndex(t=>t.login===e);if(-1===s)return!1;return t[s].isPermanent?(console.warn("Cannot remove permanent profile: ".concat(e)),!1):(t.splice(s,1),this.saveSubscriptions(t),!0)}catch(t){return console.error("Error removing profile subscription:",t),!1}}isSubscribed(e){if(!e)return!1;return this.getSubscriptions().some(t=>t.login===e)}getSubscription(e){if(!e)return null;return this.getSubscriptions().find(t=>t.login===e)||null}ensureCurrentUserSubscribed(e){if(!e||!e.login)return;const t=this.getSubscription(e.login);t?t.isPermanent||this.addSubscription((0,o.A)((0,o.A)((0,o.A)({},t),e),{},{isPermanent:!0}),!0):this.addSubscription((0,o.A)((0,o.A)({},e),{},{isPermanent:!0}),!0)}autoAddVisitedProfile(e){e&&e.login&&(this.isSubscribed(e.login)||e.isDemo||this.addSubscription(e,!1))}getSubscriptionsSorted(){return this.getSubscriptions().sort((e,t)=>{if(e.login===this.whoProfile)return-1;if(t.login===this.whoProfile)return 1;const s=e.name||e.login,n=t.name||t.login;return s.localeCompare(n)})}getSubscriptionsForSelection(){return this.getSubscriptionsSorted().map(e=>(0,o.A)((0,o.A)({},e),{},{displayName:e.name||e.login,isRemovable:!e.isPermanent}))}updateSubscription(e,t){if(!e||!t)return!1;try{const s=this.getSubscriptions(),n=s.findIndex(t=>t.login===e);return-1!==n&&(s[n]=(0,o.A)((0,o.A)((0,o.A)({},s[n]),t),{},{login:e,lastUpdated:(new Date).toISOString()}),this.saveSubscriptions(s),!0)}catch(s){return console.error("Error updating subscription:",s),!1}}clearSubscriptions(){try{const e={login:this.whoProfile,name:"World Health Organization",avatar_url:"https://github.com/".concat(this.whoProfile,".png"),type:"Organization",isPermanent:!0,addedAt:(new Date).toISOString()};this.saveSubscriptions([e])}catch(e){console.error("Error clearing subscriptions:",e)}}exportSubscriptions(){const e=this.getSubscriptions();return JSON.stringify(e,null,2)}importSubscriptions(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const s=JSON.parse(e);if(!Array.isArray(s))throw new Error("Invalid subscription format");let n;if(t){const e=[...this.getSubscriptions()];s.forEach(t=>{const s=e.findIndex(e=>e.login===t.login);-1!==s?e[s]=(0,o.A)((0,o.A)({},t),{},{isPermanent:e[s].isPermanent||t.isPermanent}):e.push(t)}),n=e}else n=s;return n.find(e=>e.login===this.whoProfile)||n.unshift({login:this.whoProfile,name:"World Health Organization",avatar_url:"https://github.com/".concat(this.whoProfile,".png"),type:"Organization",isPermanent:!0,addedAt:(new Date).toISOString()}),this.saveSubscriptions(n),!0}catch(s){return console.error("Error importing subscriptions:",s),!1}}};var l=s(44414);const d="top-level",u="user",h="dak",g="asset",p=(0,n.createContext)(null),m=()=>{const e=(0,n.useContext)(p);return e||(console.error("usePage: PageContext is null - component not wrapped in PageProvider"),{pageName:"unknown",user:null,profile:null,repository:null,branch:null,asset:null,type:"top-level",loading:!1,error:null,isAuthenticated:!1,navigate:()=>{},params:{},location:{pathname:"/"}})},f=e=>{const{user:t,repo:s}=e;return e["*"]?g:t&&s?h:t?u:d},b=e=>{let{children:t,pageName:s}=e;const m=(0,a.g)(),b=(0,a.zy)(),w=(0,a.Zp)(),[y,v]=(0,n.useState)({type:f(m),pageName:s,loading:!1,error:null,user:null,profile:null,repository:null,branch:null,asset:null,isAuthenticated:r.A.isAuth()}),{user:k,repo:x}=m,S=m["*"];(0,n.useEffect)(()=>{(y.type!==d&&k||y.type===d)&&(async()=>{try{var e,t,n;v(e=>(0,o.A)((0,o.A)({},e),{},{loading:!0,error:null}));let d=null===(e=b.state)||void 0===e?void 0:e.profile,p=null===(t=b.state)||void 0===t?void 0:t.repository,f=(null===(n=b.state)||void 0===n?void 0:n.selectedBranch)||m.branch;if(y.type===h||y.type===g){var a;if(!d&&k)if(r.A.isAuth())try{d=await r.A.getUser(k)}catch(l){if("dashboard"===s||s.includes("editor")||s.includes("viewer")||y.type===h||y.type===g)return void v(e=>(0,o.A)((0,o.A)({},e),{},{loading:!1,error:"User '".concat(k,"' not found or not accessible. Please check the username and try again."),user:k,repository:x?{name:x,owner:{login:k},html_url:"https://github.com/".concat(k,"/").concat(x),isNotFound:!0}:null,branch:m.branch||"main"}));throw new Error("User '".concat(k,"' not found or not accessible."))}else d={login:k,name:k.charAt(0).toUpperCase()+k.slice(1),avatar_url:"https://github.com/".concat(k,".png"),type:"User"};if(!p&&k&&x)if(r.A.isAuth())try{if(p=await r.A.getRepository(k,x),!await i.A.validateDAKRepository(k,x,f||p.default_branch)){if("dashboard"===s||s.includes("editor")||s.includes("viewer")||y.type===h||y.type===g)return void v(e=>(0,o.A)((0,o.A)({},e),{},{loading:!1,error:"Repository '".concat(k,"/").concat(x,"' is not a valid DAK repository. This repository may not contain WHO SMART Guidelines content."),user:k,profile:d,repository:(0,o.A)((0,o.A)({},p),{},{isInvalidDAK:!0}),branch:f||p.default_branch}));throw new Error("Repository '".concat(k,"/").concat(x,"' is not a valid DAK repository."))}}catch(l){if("dashboard"===s||s.includes("editor")||s.includes("viewer")||y.type===h||y.type===g)return void v(e=>(0,o.A)((0,o.A)({},e),{},{loading:!1,error:"Repository '".concat(k,"/").concat(x,"' not found or not accessible. Please check the repository name and your access permissions."),user:k,profile:d,repository:{name:x,owner:{login:k},html_url:"https://github.com/".concat(k,"/").concat(x),isNotFound:!0},branch:f||"main"}));throw new Error("Repository '".concat(k,"/").concat(x,"' not found or not accessible."))}else p={name:x,full_name:"".concat(k,"/").concat(x),owner:{login:k},default_branch:f||"main",html_url:"https://github.com/".concat(k,"/").concat(x)};if(f=f||(null===(a=p)||void 0===a?void 0:a.default_branch)||"main",y.type===g&&S)try{await r.A.getFileContent(k,x,S,f)}catch(l){if("asset"===s||s.includes("editor")||s.includes("viewer"))return void v(e=>(0,o.A)((0,o.A)({},e),{},{loading:!1,error:"Asset '".concat(S,"' not found in repository '").concat(k,"/").concat(x,"'. The file may have been moved or deleted."),user:k,profile:d,repository:p,branch:f,asset:S}));throw new Error("Asset '".concat(S,"' not found in repository."))}}if(y.type===u&&!d&&k)if(r.A.isAuth())try{d=await r.A.getUser(k)}catch(l){return void v(e=>(0,o.A)((0,o.A)({},e),{},{loading:!1,error:"User '".concat(k,"' not found or not accessible. Please check the username and try again."),user:k}))}else d={login:k,name:k.charAt(0).toUpperCase()+k.slice(1),avatar_url:"https://github.com/".concat(k,".png"),type:"User"};v(e=>(0,o.A)((0,o.A)({},e),{},{loading:!1,user:k,profile:d,repository:p,branch:f,asset:S,isAuthenticated:r.A.isAuth()}));const w=async()=>{try{const e=await r.A.getCurrentUser();e&&c.ensureCurrentUserSubscribed(e)}catch(e){console.debug("Could not fetch current user for subscriptions:",e)}d&&r.A.isAuth()&&(y.type===u||y.type===h||y.type===g)&&c.autoAddVisitedProfile(d)};r.A.isAuth()&&w()}catch(d){console.error("Page data loading error:",d),v(e=>(0,o.A)((0,o.A)({},e),{},{loading:!1,error:d.message}))}})()},[k,x,m.branch,S,y.type,b.state,w,s]),(0,n.useEffect)(()=>{const e=setInterval(()=>{const e=r.A.isAuth();e!==y.isAuthenticated&&v(t=>(0,o.A)((0,o.A)({},t),{},{isAuthenticated:e}))},1e3);return()=>clearInterval(e)},[y.isAuthenticated]);const N=(0,o.A)((0,o.A)({},y),{},{navigate:w,params:m,location:b});return(0,l.jsx)(p.Provider,{value:N,children:t})};var w=s(85571);const y="authenticated",v="unauthenticated",k="read",x="write",S="none";const N=new class{constructor(){this.logger=w.A.getLogger("UserAccessService"),this.currentUser=null,this.userType=v,this.permissions=new Map,this.listeners=new Set}async initialize(){this.logger.info("Initializing user access service"),await this.detectUserType(),this.notifyListeners()}async detectUserType(){try{r.A.isAuth()?(this.userType=y,this.currentUser=await r.A.getCurrentUser()):(this.userType=v,this.currentUser=null),this.logger.info("User type detected",{userType:this.userType,hasUser:!!this.currentUser})}catch(e){this.logger.error("Error detecting user type",{error:e.message}),this.userType=v,this.currentUser=null}}getUserType(){return this.userType}getCurrentUser(){return this.currentUser}isAuthenticated(){return this.userType===y}isUnauthenticated(){return this.userType===v}async getRepositoryAccess(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";const n="".concat(e,"/").concat(t,"/").concat(s);if(this.permissions.has(n))return this.permissions.get(n);let o=S;try{if(this.userType===v)o=k;else if(this.userType===y){const s=await this.checkGitHubReadAccess(e,t);await this.checkGitHubWriteAccess(e,t)?o=x:s&&(o=k)}}catch(a){this.logger.error("Error checking repository access",{owner:e,repo:t,branch:s,error:a.message}),o=k}return this.permissions.set(n,o),this.logger.debug("Repository access determined",{owner:e,repo:t,branch:s,access:o,userType:this.userType}),o}async checkGitHubReadAccess(e,t){try{return await r.A.getRepository(e,t),!0}catch(s){return!1}}async checkGitHubWriteAccess(e,t){try{return await r.A.hasRepositoryWriteAccess(e,t)}catch(s){return!1}}async canSaveToGitHub(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";if(this.userType!==y)return!1;return await this.getRepositoryAccess(e,t,s)===x}canSaveLocal(){return!0}getUIBehavior(){const e={showEditFeatures:!0,showSaveToGitHub:!0,showSaveLocal:!0,confirmBeforeSave:!0,allowCreateNew:!0,showAccessBadges:!0};switch(this.userType){case v:return(0,o.A)((0,o.A)({},e),{},{showEditFeatures:!1,showSaveToGitHub:!1,allowCreateNew:!1});case y:return e;default:return(0,o.A)((0,o.A)({},e),{},{showEditFeatures:!1,showSaveToGitHub:!1,allowCreateNew:!1})}}async getAccessBadge(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";const n=await this.getRepositoryAccess(e,t,s),o={[x]:{text:"Write Access",icon:"\u270f\ufe0f",color:"green",description:"You can edit and save changes to this repository"},[k]:{text:"Read Only",icon:"\ud83d\udc41\ufe0f",color:"blue",description:"You can view this repository but cannot save changes"},[S]:{text:"No Access",icon:"\ud83d\udeab",color:"red",description:"You do not have access to this repository"}};return o[n]||o[S]}clearPermissionsCache(){this.permissions.clear(),this.logger.debug("Permissions cache cleared")}addListener(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){const e={userType:this.userType,currentUser:this.currentUser,isAuthenticated:this.isAuthenticated(),uiBehavior:this.getUIBehavior()};this.listeners.forEach(t=>{try{t(e)}catch(s){this.logger.error("Error in access service listener",{error:s.message})}})}handleAuthChange(){this.clearPermissionsCache(),this.initialize()}};const A=new class{constructor(){this.storageKey="sgex-bookmarks"}getBookmarks(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}catch(e){return console.warn("Error reading bookmarks from localStorage:",e),[]}}saveBookmarks(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){throw console.error("Error saving bookmarks to localStorage:",t),t}}generateBookmarkTitle(e,t){const{user:s,repository:n,branch:o,asset:a}=t;if(a&&s&&n){const e=n.name||n,t=o||"main";return"".concat(a," in DAK: ").concat(s,"/").concat(e,"/").concat(t)}if(s&&n&&o){const e=n.name||n;return"DAK: ".concat(s,"/").concat(e,"/").concat(o)}if(s&&n){const e=n.name||n;return"DAK: ".concat(s,"/").concat(e)}return s?"".concat(e,": ").concat(s):e}addBookmark(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.getBookmarks(),a=n.findIndex(e=>e.url===t);if(-1!==a)n[a]=(0,o.A)((0,o.A)({},n[a]),{},{title:this.generateBookmarkTitle(e,s),pageName:e,context:s,lastUpdated:(new Date).toISOString()});else{const o={id:Date.now().toString(),title:this.generateBookmarkTitle(e,s),url:t,pageName:e,context:s,createdAt:(new Date).toISOString(),lastUpdated:(new Date).toISOString()};n.push(o)}return this.saveBookmarks(n),n[a]||n[n.length-1]}removeBookmark(e){try{const t=this.getBookmarks(),s=t.filter(t=>t.id!==e);return s.length!==t.length&&(this.saveBookmarks(s),!0)}catch(t){return console.error("Error removing bookmark:",t),!1}}isBookmarked(e){return this.getBookmarks().some(t=>t.url===e)}getBookmarkByUrl(e){return this.getBookmarks().find(t=>t.url===e)||null}getBookmarksGroupedByPage(){const e=this.getBookmarks(),t={};e.forEach(e=>{const s=e.pageName||"Other";t[s]||(t[s]=[]),t[s].push(e)}),Object.keys(t).forEach(e=>{t[e].sort((e,t)=>e.title.localeCompare(t.title))});return Object.keys(t).sort().map(e=>({pageName:e,bookmarks:t[e]}))}clearBookmarks(){try{localStorage.removeItem(this.storageKey)}catch(e){console.error("Error clearing bookmarks:",e)}}exportBookmarks(){const e=this.getBookmarks();return JSON.stringify(e,null,2)}importBookmarks(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const s=JSON.parse(e);if(!Array.isArray(s))throw new Error("Invalid bookmark format");if(t){const e=[...this.getBookmarks()];s.forEach(t=>{const s=e.findIndex(e=>e.url===t.url);-1!==s?e[s]=t:e.push(t)}),this.saveBookmarks(e)}else this.saveBookmarks(s);return!0}catch(s){return console.error("Error importing bookmarks:",s),!1}}};const C=new class{constructor(){this.baseURL="https://api.github.com",this.owner="litlfred",this.repo="sgex",this.workflowFileName="pages.yml"}setToken(e){this.token=e}getHeaders(){const e={Accept:"application/vnd.github.v3+json","Content-Type":"application/json"};return this.token&&(e.Authorization="token ".concat(this.token)),e}async getWorkflowId(){try{const e=await fetch("".concat(this.baseURL,"/repos/").concat(this.owner,"/").concat(this.repo,"/actions/workflows"),{headers:this.getHeaders()});if(!e.ok)throw new Error("Failed to fetch workflows: ".concat(e.status));const t=await e.json();console.debug("Available workflows:",t.workflows.map(e=>({name:e.name,path:e.path})));const s=t.workflows.find(e=>e.path.includes("branch-deployment.yml")||e.name.includes("Deploy Feature Branch")||e.path.includes("landing-page-deployment.yml")||e.name.includes("Deploy Landing Page")||e.path.includes(this.workflowFileName)||e.name.includes("Multi-Branch GitHub Pages Deployment"));return console.debug("Selected workflow:",s?{name:s.name,path:s.path,id:s.id}:"None found"),s?s.id:null}catch(e){return console.error("Error fetching workflow ID:",e),null}}async getLatestWorkflowRun(e){try{console.debug("Looking for workflow runs for branch: ".concat(e));const t="main"===e,s=t?"Deploy Landing Page":"Deploy Feature Branch",n=await fetch("".concat(this.baseURL,"/repos/").concat(this.owner,"/").concat(this.repo,"/actions/workflows"),{headers:this.getHeaders()});if(!n.ok)throw new Error("Failed to fetch workflows: ".concat(n.status));const o=await n.json();let a;if(console.debug("Available workflows:",o.workflows.map(e=>({name:e.name,path:e.path}))),a=t?o.workflows.find(e=>e.name.includes("Deploy Landing Page")||e.path.includes("landing-page-deployment.yml")):o.workflows.find(e=>e.name.includes("Deploy Feature Branch")||e.path.includes("branch-deployment.yml")),!a)return console.debug("No ".concat(s," workflow found for branch ").concat(e)),null;console.debug("Using workflow: ".concat(a.name," (ID: ").concat(a.id,") for branch ").concat(e));const r=await fetch("".concat(this.baseURL,"/repos/").concat(this.owner,"/").concat(this.repo,"/actions/workflows/").concat(a.id,"/runs?branch=").concat(encodeURIComponent(e),"&per_page=5"),{headers:this.getHeaders()});if(!r.ok)throw new Error("Failed to fetch workflow runs: ".concat(r.status));const i=await r.json();if(console.debug("Found ".concat(i.workflow_runs.length," workflow runs for branch ").concat(e)),i.workflow_runs.length>0){const e=i.workflow_runs[0];return console.debug("Latest run: ".concat(e.status,"/").concat(e.conclusion," at ").concat(e.created_at)),e}return null}catch(t){return console.error("Error fetching latest workflow run for branch ".concat(e,":"),t),null}}async getWorkflowStatusForBranches(e){const t={};for(const n of e)try{const e=await this.getLatestWorkflowRun(n);t[n]=this.parseWorkflowStatus(e)}catch(s){console.error("Error getting workflow status for branch ".concat(n,":"),s),t[n]={status:"unknown",conclusion:null,url:null,runId:null,createdAt:null}}return t}parseWorkflowStatus(e){if(!e)return{status:"not_started",conclusion:null,url:null,runId:null,createdAt:null,displayStatus:"Not Started",badgeClass:"not-started",icon:"\u26aa"};const t=e.status,s=e.conclusion;let n,o,a;return"in_progress"===t||"queued"===t||"pending"===t?(n="In Progress",o="in-progress",a="\ud83d\udfe1"):"waiting"===t?(n="Awaiting Approval",o="waiting",a="\ud83d\udfe0"):"requested"===t?(n="Requested",o="requested",a="\ud83d\udd35"):"completed"===t?"success"===s?(n="Succeeded",o="succeeded",a="\ud83d\udfe2"):"failure"===s||"cancelled"===s||"timed_out"===s?(n="Failed",o="failed",a="\ud83d\udd34"):"action_required"===s?(n="Action Required",o="action-required",a="\ud83d\udfe0"):(n="Completed",o="completed",a="\ud83d\udfe6"):(n="Unknown",o="unknown",a="\u26ab"),{status:t,conclusion:s,url:e.html_url,runId:e.id,createdAt:new Date(e.created_at),displayStatus:n,badgeClass:o,icon:a}}async triggerWorkflow(e){try{if(!this.token)throw new Error("Authentication required to trigger workflows");console.debug("Triggering workflow for branch: ".concat(e));const t="main"===e,s=await fetch("".concat(this.baseURL,"/repos/").concat(this.owner,"/").concat(this.repo,"/actions/workflows"),{headers:this.getHeaders()});if(!s.ok)throw new Error("Failed to fetch workflows: ".concat(s.status));const n=await s.json();let o;if(o=t?n.workflows.find(e=>e.name.includes("Deploy Landing Page")||e.path.includes("landing-page-deployment.yml")):n.workflows.find(e=>e.name.includes("Deploy Feature Branch")||e.path.includes("branch-deployment.yml")),!o)throw new Error("No deployment workflow found for branch ".concat(e));console.debug("Triggering workflow: ".concat(o.name," (ID: ").concat(o.id,") for branch ").concat(e));const a=await fetch("".concat(this.baseURL,"/repos/").concat(this.owner,"/").concat(this.repo,"/actions/workflows/").concat(o.id,"/dispatches"),{method:"POST",headers:this.getHeaders(),body:JSON.stringify({ref:e,inputs:{branch:e}})});if(!a.ok){const t=await a.text();throw console.error("Workflow trigger failed:",{status:a.status,statusText:a.statusText,error:t,branch:e,workflowId:o.id}),new Error("Failed to trigger workflow: ".concat(a.status," ").concat(a.statusText," - ").concat(t))}return console.debug("Successfully triggered workflow for branch ".concat(e)),!0}catch(t){return console.error("Error triggering workflow for branch ".concat(e,":"),t),!1}}getActionsURL(){return"https://github.com/".concat(this.owner,"/").concat(this.repo,"/actions")}async getWorkflowURL(){try{const e=await this.getWorkflowId();return e?"https://github.com/".concat(this.owner,"/").concat(this.repo,"/actions/workflows/").concat(e):this.getActionsURL()}catch(e){return console.error("Error getting workflow URL:",e),this.getActionsURL()}}async checkWorkflowTriggerPermissions(){try{if(!this.token)return!1;return!!(await fetch("".concat(this.baseURL,"/repos/").concat(this.owner,"/").concat(this.repo,"/actions/workflows"),{headers:this.getHeaders()})).ok}catch(e){return console.debug("Cannot check workflow trigger permissions:",e),!1}}async checkWorkflowApprovalPermissions(){try{if(!this.token)return!1;return(await fetch("".concat(this.baseURL,"/repos/").concat(this.owner,"/").concat(this.repo,"/actions/runs?status=waiting"),{headers:this.getHeaders()})).ok}catch(e){return console.debug("Cannot check workflow approval permissions:",e),!1}}async approveWorkflowRun(e){try{if(!this.token)throw new Error("Authentication required to approve workflow runs");console.debug("Approving workflow run: ".concat(e));const t=await fetch("".concat(this.baseURL,"/repos/").concat(this.owner,"/").concat(this.repo,"/actions/runs/").concat(e,"/approve"),{method:"POST",headers:this.getHeaders()});if(!t.ok){const s=await t.text();throw console.error("Workflow approval failed:",{status:t.status,statusText:t.statusText,error:s,runId:e}),new Error("Failed to approve workflow run: ".concat(t.status," ").concat(t.statusText," - ").concat(s))}return console.debug("Successfully approved workflow run ".concat(e)),!0}catch(t){return console.error("Error approving workflow run ".concat(e,":"),t),!1}}isAuthenticated(){return!!this.token}},j=e=>{let{workflowStatus:t,branchName:s,onTriggerWorkflow:o,onApproveWorkflow:a,isAuthenticated:r,canTriggerWorkflows:i=!1,canApproveWorkflows:c=!1,isLoading:d=!1}=e;const[u,h]=(0,n.useState)(!1),[g,p]=(0,n.useState)(!1);return d?(0,l.jsxs)("div",{className:"workflow-status-section",children:[(0,l.jsx)("div",{className:"workflow-status-header",children:(0,l.jsx)("h4",{className:"workflow-status-title",children:"\u2699\ufe0f Build Status"})}),(0,l.jsx)("div",{className:"workflow-loading",children:"Loading workflow status..."})]}):t?(0,l.jsxs)("div",{className:"workflow-status-section",children:[(0,l.jsx)("div",{className:"workflow-status-header",children:(0,l.jsx)("h4",{className:"workflow-status-title",children:"\u2699\ufe0f Build Status"})}),(0,l.jsxs)("div",{className:"workflow-status-container",children:[(0,l.jsxs)("div",{className:"workflow-status-info",children:[t.url?(0,l.jsxs)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"workflow-status-badge ".concat(t.badgeClass),children:[(0,l.jsx)("span",{children:t.icon}),t.displayStatus]}):(0,l.jsxs)("span",{className:"workflow-status-badge ".concat(t.badgeClass),children:[(0,l.jsx)("span",{children:t.icon}),t.displayStatus]}),t.createdAt&&(0,l.jsx)("span",{className:"workflow-status-details",children:(m=t.createdAt,m?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(m):"")})]}),(0,l.jsxs)("div",{className:"workflow-actions",children:[r&&i&&(0,l.jsx)("button",{onClick:async()=>{if(r&&!u&&o&&i){h(!0);try{await o(s)}finally{h(!1)}}},disabled:u,className:"workflow-trigger-btn",title:"Trigger build for ".concat(s),children:u?(0,l.jsx)(l.Fragment,{children:"\u23f3 Starting..."}):(0,l.jsx)(l.Fragment,{children:"\ud83d\udd04 Trigger Build"})}),r&&c&&"waiting"===(null===t||void 0===t?void 0:t.status)&&(0,l.jsx)("button",{onClick:async()=>{if(r&&!g&&a&&c&&null!==t&&void 0!==t&&t.runId){p(!0);try{await a(t.runId)}finally{p(!1)}}},disabled:g,className:"workflow-approve-btn",title:"Approve workflow run for ".concat(s),children:g?(0,l.jsx)(l.Fragment,{children:"\u23f3 Approving..."}):(0,l.jsx)(l.Fragment,{children:"\u2705 Approve Run"})}),(null===t||void 0===t?void 0:t.url)&&(0,l.jsx)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"workflow-link",children:"\ud83d\udccb View Log"})]})]})]}):(0,l.jsxs)("div",{className:"workflow-status-section",children:[(0,l.jsx)("div",{className:"workflow-status-header",children:(0,l.jsx)("h4",{className:"workflow-status-title",children:"\u2699\ufe0f Build Status"})}),(0,l.jsx)("div",{className:"workflow-error",children:"Unable to load workflow status"})]});var m};var _=s(38659);const T=(0,n.lazy)(()=>Promise.all([s.e(738),s.e(845),s.e(383),s.e(743)]).then(s.bind(s,25743))),I=()=>{const[e,t]=(0,n.useState)(null),[s,a]=(0,n.useState)([]),[i,c]=(0,n.useState)(!0),[d,u]=(0,n.useState)(null),[h,g]=(0,n.useState)(!1),[p,m]=(0,n.useState)(!1),[f,b]=(0,n.useState)([]),[w,y]=(0,n.useState)(!1),[v,k]=(0,n.useState)(""),[x,S]=(0,n.useState)(!1),[N,A]=(0,n.useState)(null),[I,R]=(0,n.useState)(new Set),[E,D]=(0,n.useState)(!1),[P,F]=(0,n.useState)(!1),[G,H]=(0,n.useState)(null),[O,L]=(0,n.useState)(!1),[B,M]=(0,n.useState)(null),[U,q]=(0,n.useState)(null),[K,W]=(0,n.useState)(null),[z,X]=(0,n.useState)(null),[V,Y]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{const[e,t,s]=await Promise.all([(0,_.hP)(),(0,_.ef)(),(0,_.k$)()]);W(()=>e),X(t),Y(()=>s)}catch(d){console.error("Failed to load markdown components:",d)}})()},[]);const[J,Q]=(0,n.useState)(!1),[Z,$]=(0,n.useState)(!0),[ee,te]=(0,n.useState)(!1),[se,ne]=(0,n.useState)(!1),[oe,ae]=(0,n.useState)(!1),[re,ie]=(0,n.useState)(!1),[ce,le]=(0,n.useState)(1),[de,ue]=(0,n.useState)([]),[he,ge]=(0,n.useState)(!1),[pe,me]=(0,n.useState)(5),[fe,be]=(0,n.useState)(!0),we=(0,n.useRef)(null),ye=(0,n.useRef)(null),ve=(0,n.useRef)(null);(0,n.useEffect)(()=>{(async()=>{try{c(!0),u(null);const s=ke();if(!s||"main"===s)return void c(!1);t({name:s,safeName:s.replace(/\//g,"-")});try{const e=await xe(s);e&&e.length>0&&a(e)}catch(e){console.debug("Could not fetch PR info:",e)}c(!1)}catch(s){console.error("Error detecting branch:",s),u(s.message),c(!1)}})()},[]),(0,n.useEffect)(()=>{const e=e=>{we.current&&!we.current.contains(e.target)&&(p&&m(!1),g(!1))};if(h)return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[h,p]),(0,n.useEffect)(()=>()=>{ye.current&&(clearInterval(ye.current),ye.current=null),ve.current&&(clearInterval(ve.current),ve.current=null)},[]),(0,n.useEffect)(()=>{h||(ye.current&&(clearInterval(ye.current),ye.current=null),ve.current&&(clearInterval(ve.current),ve.current=null),le(1),me(5))},[h]);const ke=()=>"copilot/fix-792-2",xe=async e=>{try{const t="litlfred",s="sgex";return await r.A.getPullRequestsForBranch(t,s,e)}catch(d){return console.debug("Failed to fetch PR info:",d),[]}},Se=async function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];try{y(!0);const i=30,[c,l,d]=await Promise.all([r.A.getPullRequestComments(e,t,s,n,i).catch(()=>[]),r.A.getPullRequestIssueComments(e,t,s,n,i).catch(()=>[]),fe?r.A.getPullRequestTimeline(e,t,s,n,i).catch(()=>[]):Promise.resolve([])]),u=[...c.map(e=>(0,o.A)((0,o.A)({},e),{},{type:"review"})),...l.map(e=>(0,o.A)((0,o.A)({},e),{},{type:"issue"}))].sort((e,t)=>new Date(t.created_at)-new Date(e.created_at)),h=d.filter(e=>["committed","reviewed","merged","closed","reopened","labeled","unlabeled","head_ref_force_pushed","ready_for_review","convert_to_draft"].includes(e.event)).map(e=>{const t=e.actor||e.author||{login:"github",avatar_url:"https://github.com/github.png"},s=(0,o.A)({login:t.login||"github",avatar_url:t.avatar_url||"https://github.com/github.png"},t);return(0,o.A)((0,o.A)({},e),{},{type:"timeline",created_at:e.created_at||e.submitted_at,user:s,body:Ne(e)})});if(a){const e=new Set(de.map(e=>e.id)),t=u.filter(t=>!e.has(t.id)),s=h.filter(t=>!e.has(t.id)),n=[...t,...s].sort((e,t)=>new Date(t.created_at)-new Date(e.created_at)),o=[...de,...n];ue(o);const a=Math.min(o.length,pe+i);me(a),b(o.slice(0,a))}else{const e=[...u,...h].sort((e,t)=>new Date(t.created_at)-new Date(e.created_at));ue(e);const t=Math.min(5,e.length);me(t),b(e.slice(0,t))}return ge(u.length===i),u}catch(d){return console.debug("Failed to fetch comments:",d),[]}finally{y(!1)}},Ne=e=>{var t,s,n;switch(e.event){case"committed":return"\ud83d\udce6 Pushed ".concat(e.sha?e.sha.substring(0,7):"commit",": ").concat(e.message||"No commit message");case"reviewed":const o=e.state&&"string"===typeof e.state?e.state.toLowerCase():"reviewed";return"".concat("approved"===o?"\u2705":"changes_requested"===o?"\u274c":"\ud83d\udcac"," ").concat("approved"===o?"Approved":"changes_requested"===o?"Requested changes":"Reviewed"," this pull request");case"merged":return"\ud83d\udd00 Merged this pull request";case"closed":return"\u274c Closed this pull request";case"reopened":return"\ud83d\udd04 Reopened this pull request";case"labeled":return"\ud83c\udff7\ufe0f Added label: ".concat((null===(t=e.label)||void 0===t?void 0:t.name)||"unknown");case"unlabeled":return"\ud83c\udff7\ufe0f Removed label: ".concat((null===(s=e.label)||void 0===s?void 0:s.name)||"unknown");case"head_ref_force_pushed":return"\ud83d\udd04 Force-pushed to ".concat(e.ref||"branch");case"ready_for_review":return"\u2705 Marked as ready for review";case"convert_to_draft":return"\ud83d\udcdd Converted to draft";default:return"\ud83d\udccb ".concat((null===(n=e.event)||void 0===n?void 0:n.replace(/_/g," "))||"unknown event")}},Ae=async e=>{try{L(!0),r.A.isAuth()&&r.A.token&&C.setToken(r.A.token);const t=await C.getLatestWorkflowRun(e),s=C.parseWorkflowStatus(t);H(s)}catch(d){console.debug("Failed to fetch workflow status:",d),H(null)}finally{L(!1)}},Ce=async e=>{try{if(!r.A.isAuth())return console.warn("Authentication required to trigger workflows"),!1;C.setToken(r.A.token);const t=await C.triggerWorkflow(e);return t&&setTimeout(()=>{Ae(e)},2e3),t}catch(d){return console.error("Failed to trigger workflow:",d),!1}},je=async t=>{try{if(!r.A.isAuth())return console.warn("Authentication required to approve workflows"),!1;C.setToken(r.A.token);const s=await C.approveWorkflowRun(t);return s&&setTimeout(()=>{null!==e&&void 0!==e&&e.name&&Ae(e.name)},2e3),s}catch(d){return console.error("Failed to approve workflow:",d),!1}},_e=e=>{ve.current&&clearInterval(ve.current),ve.current=setInterval(async()=>{try{const t=null===G||void 0===G?void 0:G.status;await Ae(e),null!==G&&void 0!==G&&G.status&&G.status!==t&&console.debug("Workflow status changed from ".concat(t," to ").concat(G.status))}catch(d){console.debug("Failed to auto-refresh workflow status:",d)}},3e4)},Te=e=>{const t=new Set(I);t.has(e)?t.delete(e):t.add(e),R(t)},Ie=async()=>{if(v.trim()&&r.A.isAuth()&&!x&&Z)try{S(!0),A("submitting");const t="litlfred",n="sgex";if(console.debug("Submitting comment:",{authenticated:r.A.isAuth(),hasToken:!!r.A.token,commentLength:v.trim().length,prInfo:(null===s||void 0===s?void 0:s.length)||0,canComment:Z}),s&&s.length>0){const o=s[0];console.debug("Submitting to PR:",o.number);try{const e=await r.A.createPullRequestComment(t,n,o.number,v.trim());console.debug("Comment submitted successfully:",e),A("success"),await Se(t,n,o.number,1,!1),e&&e.id&&(M(e.id),setTimeout(()=>M(null),3e3)),k(""),F(!1),setTimeout(()=>A(null),3e3)}catch(e){console.error("GitHub API comment submission error:",{error:e,message:e.message,status:e.status,response:e.response});let t="Failed to submit comment. ";e.message.includes("401")?t+="Authentication failed - please check your token.":e.message.includes("403")||e.message.includes("Resource not accessible by personal access token")?(t+='Your personal access token does not have permission to create comments. Please use a token with "repo" or "public_repo" scope.',$(!1)):e.message.includes("404")?t+="Pull request not found.":e.message.includes("422")?t+="Invalid comment format.":t+="Please try again.",A({type:"error",message:t}),setTimeout(()=>A(null),7e3)}}else console.warn("No PR info available for comment submission"),A({type:"error",message:"No pull request found to comment on."}),setTimeout(()=>A(null),5e3)}catch(d){console.error("Unexpected error during comment submission:",d),A({type:"error",message:"Unexpected error occurred. Please try again."}),setTimeout(()=>A(null),5e3)}finally{S(!1)}},Re=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;if(!e)return"";const s=e.split("\n");return s.length<=t?e:s.slice(0,t).join("\n")+"..."},Ee=e=>{if(!e||!z)return e||"";if("function"!==typeof z.sanitize)return console.warn("DOMPurify.sanitize is not available, returning unsanitized content"),e;return z.sanitize(e,{ALLOWED_TAGS:["p","br","strong","b","em","i","code","pre","blockquote","h1","h2","h3","h4","h5","h6","ul","ol","li","a","img","hr","del","ins","mark","small","sub","sup","table","thead","tbody","tfoot","tr","th","td","div","span"],ALLOWED_ATTR:["href","src","alt","title","class","id","style","align","colspan","rowspan","width","height","target","rel"],KEEP_CONTENT:!0,ALLOW_DATA_ATTR:!1})},De=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return e.length<=t?e:e.substring(0,t)+"..."},Pe=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Fe=async(t,n)=>{if(n&&(n.stopPropagation(),n.preventDefault()),t&&t.html_url&&!h){g(!0),m(!0);const n="litlfred",o="sgex";if(await Se(n,o,t.number,1,!1),await(async(e,t)=>{if(!r.A.isAuth())return $(!1),te(!1),ne(!1),void ae(!1);try{const n=await r.A.checkCommentPermissions(e,t);$(n),C.setToken(r.A.token);const[o,a]=await Promise.all([C.checkWorkflowTriggerPermissions(),C.checkWorkflowApprovalPermissions()]);if(te(o),ne(a),s&&s.length>0){const n=await r.A.checkPullRequestMergePermissions(e,t,s[0].number);ae(n)}else ae(!1)}catch(d){console.debug("Error checking permissions:",d),$(!1),te(!1),ne(!1),ae(!1)}})(n,o),r.A.isAuth()&&Z)try{await r.A.checkRepositoryWritePermissions(n,o)&&!v.includes("@copilot")&&k("@copilot ")}catch(d){console.debug("Could not check collaborator status:",d)}if(r.A.isAuth())try{const e=await(async(e,t,s)=>{try{if(!r.A.isAuth())return null;const n=(await r.A.getPullRequestIssueComments(e,t,s)).filter(e=>"copilot"===e.user.login||e.user.login.includes("copilot")||e.body.includes("@copilot")||e.body.includes("copilot session")||e.body.includes("GitHub Copilot"));if(n.length>0){const o=n[0];let a=null;const r=/https:\/\/github\.com\/[^/]+\/[^/]+\/pull\/\d+\/agent-sessions\/[a-f0-9-]+/gi;for(const e of n){const t=e.body.match(r);if(t){a=t[0];break}}return a||(a="https://github.com/".concat(e,"/").concat(t,"/pull/").concat(s,"/agent-sessions")),{hasActiveCopilot:!0,latestActivity:o.created_at,sessionUrl:a,commentUrl:"https://github.com/".concat(e,"/").concat(t,"/pull/").concat(s,"#issuecomment-").concat(o.id),commentsCount:n.length,latestComment:o}}return{hasActiveCopilot:!1,commentsCount:0}}catch(d){return console.debug("Failed to fetch copilot session info:",d),null}})(n,o,t.number);q(e)}catch(d){console.debug("Could not fetch copilot session info:",d)}null!==e&&void 0!==e&&e.name&&(await Ae(e.name),_e(e.name)),((e,t,s)=>{ye.current&&clearInterval(ye.current),ye.current=setInterval(async()=>{try{const n=await Se(e,t,s,1,!1);if(n.length>0&&f.length>0){n[0].id!==f[0].id&&console.debug("New comments detected, refreshing...")}}catch(d){console.debug("Failed to auto-refresh comments:",d)}},6e4)})(n,o,t.number)}else t&&t.html_url&&h&&window.open(t.html_url,"_blank")},Ge=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return e.length<=t?e:e.substring(0,t)+"..."};return i||d||!e?null:(0,l.jsxs)("div",{className:"preview-badge-container",ref:we,children:[s&&s.length>0?(0,l.jsxs)(l.Fragment,{children:[s.map((e,t)=>(0,l.jsx)("div",{className:"preview-badge clickable ".concat(h?"expanded":""," ").concat(p?"sticky":""),onClick:t=>Fe(e,t),title:h?"Click to view PR: ".concat(e.title):"Click to expand for comments: ".concat(e.title),children:(0,l.jsxs)("div",{className:"badge-content",children:[(0,l.jsx)("span",{className:"badge-label",children:"PR:"}),(0,l.jsxs)("span",{className:"badge-branch",children:["#",e.number]}),(0,l.jsx)("span",{className:"badge-separator",children:"|"}),(0,l.jsx)("span",{className:"badge-pr-title",children:Ge(e.title)}),(0,l.jsx)("span",{className:"badge-expand-icon",children:h?"\u25bc":"\u25b6"})]})},e.id)),h&&(0,l.jsxs)("div",{className:"preview-badge-expanded",children:[(0,l.jsxs)("div",{className:"expanded-header",children:[(0,l.jsxs)("div",{className:"pr-info",children:[(0,l.jsx)("h3",{children:(0,l.jsxs)("a",{href:s[0].html_url,target:"_blank",rel:"noopener noreferrer",children:["#",s[0].number,": ",s[0].title]})}),(0,l.jsxs)("div",{className:"pr-meta",children:[(0,l.jsx)("span",{className:"pr-state","data-state":s[0].state,children:s[0].state}),(0,l.jsxs)("span",{className:"pr-author",children:["by ",(0,l.jsx)("a",{href:s[0].user.html_url,target:"_blank",rel:"noopener noreferrer",className:"pr-author-link",children:s[0].user.login})]})]})]}),(0,l.jsx)("button",{className:"close-button",onClick:e=>{e.stopPropagation(),g(!1),m(!1)},title:"Close expanded view",children:"\xd7"})]}),r.A.isAuth()&&(0,l.jsxs)("div",{className:"comment-form",children:[(0,l.jsx)("h4",{children:"Add Comment"}),!Z&&(0,l.jsxs)("div",{className:"comment-disabled-notice",children:[(0,l.jsx)("strong",{children:"\ud83d\udca1 Comments disabled:"}),' Your personal access token does not have permission to create comments. Please use a token with "repo" or "public_repo" scope to enable commenting.']}),N&&(0,l.jsx)("div",{className:"comment-status comment-status-".concat("string"===typeof N?N:N.type),children:"string"===typeof N?(0,l.jsxs)(l.Fragment,{children:["submitting"===N&&"\u23f3 Submitting comment...","success"===N&&"\u2705 Comment submitted successfully!"]}):(0,l.jsx)(l.Fragment,{children:"error"===N.type&&"\u274c ".concat(N.message)})}),P?(0,l.jsxs)("div",{className:"comment-form-advanced",children:[(0,l.jsx)("div",{className:"markdown-editor-container",children:(0,l.jsx)(n.Suspense,{fallback:(0,l.jsx)("div",{className:"loading-spinner",children:"Loading editor..."}),children:(0,l.jsx)(T,{value:v,onChange:e=>k(e||""),preview:"edit",height:300,visibleDragBar:!1,"data-color-mode":"light",hideToolbar:x||!Z})})}),(0,l.jsxs)("div",{className:"comment-form-actions",children:[(0,l.jsx)("button",{className:"btn-secondary",onClick:()=>F(!1),disabled:x||!Z,children:"Simple Editor"}),(0,l.jsx)("button",{className:"submit-comment",onClick:Ie,disabled:!v.trim()||x||!Z,children:x?"Submitting...":"Comment"})]})]}):(0,l.jsxs)("div",{className:"comment-form-simple",children:[(0,l.jsx)("textarea",{value:v,onChange:e=>k(e.target.value),placeholder:Z?"Write a comment... (Click 'Advanced Editor' for markdown preview)":"Comment form disabled - token permissions required",rows:3,disabled:x||!Z}),(0,l.jsxs)("div",{className:"comment-form-actions",children:[(0,l.jsx)("button",{className:"advanced-editor-btn",onClick:()=>F(!0),disabled:x||!Z,children:"\ud83d\udcdd Advanced Editor"}),(0,l.jsx)("button",{className:"submit-comment",onClick:Ie,disabled:!v.trim()||x||!Z,children:x?"Submitting...":"Comment"})]})]})]}),s[0].body&&(0,l.jsxs)("div",{className:"pr-description",children:[(0,l.jsx)("h4",{children:"Description"}),(0,l.jsxs)("div",{className:"pr-body",children:[(0,l.jsx)("div",{className:"markdown-content",children:K&&V?(0,l.jsx)(K,{rehypePlugins:[V],children:Ee(E?s[0].body:Re(s[0].body))}):(0,l.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:Ee(E?s[0].body:Re(s[0].body))})}),s[0].body.split("\n").length>6&&(0,l.jsx)("button",{className:"description-toggle",onClick:()=>{D(!E)},children:E?"Show less":"Show more"})]})]}),(null===e||void 0===e?void 0:e.name)&&(0,l.jsx)("div",{className:"workflow-status-wrapper",children:(0,l.jsx)(j,{workflowStatus:G,branchName:e.name,onTriggerWorkflow:Ce,onApproveWorkflow:je,isAuthenticated:r.A.isAuth(),canTriggerWorkflows:ee,canApproveWorkflows:se,isLoading:O})}),s&&s.length>0&&"open"===s[0].state&&(0,l.jsxs)("div",{className:"pr-actions-wrapper",children:[(0,l.jsx)("h4",{children:"\ud83d\udd00 Pull Request Actions"}),(0,l.jsxs)("div",{className:"pr-actions-container",children:[(0,l.jsx)("div",{className:"pr-actions-info",children:(0,l.jsxs)("span",{className:"pr-actions-status",children:["PR #",s[0].number," is ready for actions"]})}),(0,l.jsxs)("div",{className:"pr-actions-buttons",children:[r.A.isAuth()&&oe&&(0,l.jsx)("button",{onClick:()=>(async(t,n,o)=>{if(!r.A.isAuth()||re||!oe)return!1;ie(!0);try{const i=s.find(e=>e.number===o),c="Merge PR #".concat(o,": ").concat((null===i||void 0===i?void 0:i.title)||"Pull Request"),l="Merges pull request #".concat(o,"\n\n").concat((null===i||void 0===i?void 0:i.body)||"").trim(),u=await r.A.mergePullRequest(t,n,o,{commit_title:c,commit_message:l,merge_method:"merge"});return console.debug("PR merged successfully:",u),setTimeout(async()=>{try{const t=await xe(null===e||void 0===e?void 0:e.name);t&&t.length>0&&a(t)}catch(d){console.debug("Could not refresh PR status after merge:",d)}},2e3),!0}catch(d){console.error("Failed to merge PR:",d);let t="Failed to merge PR";return 403===d.status?t="Permission denied: Your Personal Access Token may not have sufficient permissions to merge PRs":404===d.status?t="PR not found or repository access denied":405===d.status?t="Merge not allowed: Check branch protection rules or PR requirements":409===d.status&&(t="Merge conflict: PR cannot be automatically merged"),console.warn("User guidance:",t),!1}finally{ie(!1)}})("litlfred","sgex",s[0].number),disabled:re,className:"pr-merge-btn",title:"Merge PR #".concat(s[0].number),children:re?(0,l.jsx)(l.Fragment,{children:"\u23f3 Merging..."}):(0,l.jsx)(l.Fragment,{children:"\ud83d\udd00 Merge PR"})}),!r.A.isAuth()&&(0,l.jsx)("span",{className:"pr-actions-note",children:"\ud83d\udd12 Sign in to access PR actions"}),r.A.isAuth()&&!oe&&(0,l.jsx)("span",{className:"pr-actions-note",children:"\u26a0\ufe0f You don't have permission to merge this PR"})]})]})]}),U&&(0,l.jsxs)("div",{className:"copilot-session-wrapper",children:[(0,l.jsx)("h4",{children:"\ud83e\udd16 GitHub Copilot Activity"}),U.hasActiveCopilot?(0,l.jsxs)("div",{className:"copilot-session-active",children:[(0,l.jsxs)("div",{className:"copilot-session-info",children:[(0,l.jsx)("span",{className:"copilot-status",children:"\u2705 Active Copilot session detected"}),(0,l.jsxs)("span",{className:"copilot-activity",children:["Last activity: ",Pe(U.latestActivity)]}),(0,l.jsxs)("span",{className:"copilot-comments-count",children:[U.commentsCount," copilot comment(s) found"]})]}),(0,l.jsxs)("div",{className:"copilot-session-actions",children:[(0,l.jsx)("a",{href:U.sessionUrl,target:"_blank",rel:"noopener noreferrer",className:"copilot-session-link",children:"\ud83d\udd17 View Agent Session"}),U.commentUrl&&(0,l.jsx)("a",{href:U.commentUrl,target:"_blank",rel:"noopener noreferrer",className:"copilot-comment-link",children:"\ud83d\udcac Latest Comment"}),(0,l.jsx)("button",{className:"copilot-session-toggle",onClick:()=>Q(!J),children:J?"\ud83d\udcdd Hide Session":"\ud83d\udc41\ufe0f Watch Session"})]}),J&&U.latestComment&&(0,l.jsxs)("div",{className:"copilot-session-modal",children:[(0,l.jsxs)("div",{className:"copilot-session-header",children:[(0,l.jsx)("strong",{children:"Latest Copilot Activity"}),(0,l.jsx)("span",{className:"copilot-comment-date",children:Pe(U.latestComment.created_at)})]}),(0,l.jsxs)("div",{className:"copilot-session-content",children:[(0,l.jsxs)("div",{className:"copilot-comment-author",children:[(0,l.jsx)("img",{src:U.latestComment.user.avatar_url,alt:U.latestComment.user.login,className:"copilot-avatar"}),(0,l.jsx)("a",{href:U.latestComment.user.html_url,target:"_blank",rel:"noopener noreferrer",className:"copilot-username",children:U.latestComment.user.login})]}),(0,l.jsx)("div",{className:"copilot-comment-body",children:(0,l.jsx)("div",{className:"markdown-content",children:K&&V?(0,l.jsx)(K,{rehypePlugins:[V],children:Ee(U.latestComment.body)}):(0,l.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:Ee(U.latestComment.body)})})})]})]})]}):(0,l.jsxs)("div",{className:"copilot-session-inactive",children:[(0,l.jsx)("span",{className:"copilot-status",children:"\u26aa No active Copilot session detected"}),(0,l.jsx)("span",{className:"copilot-hint",children:"Start a conversation with @copilot to begin a session"})]})]}),(0,l.jsxs)("div",{className:"comments-section",children:[(0,l.jsxs)("div",{className:"comments-header",children:[(0,l.jsxs)("h4",{children:["Recent Comments & Updates (",de.length>0?"".concat(pe,"/").concat(de.length):"0",")"]}),(0,l.jsx)("div",{className:"comments-controls",children:(0,l.jsxs)("label",{className:"status-updates-toggle",children:[(0,l.jsx)("input",{type:"checkbox",checked:fe,onChange:e=>{be(e.target.checked),s&&s.length>0&&Se("litlfred","sgex",s[0].number,1,!1)}}),(0,l.jsx)("span",{className:"checkbox-label",children:"\ud83d\udccb Show status updates"})]})})]}),w?(0,l.jsx)("div",{className:"loading",children:"Loading comments..."}):0===f.length?(0,l.jsx)("div",{className:"no-comments",children:"No comments yet"}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"comments-list",children:f.map(e=>{const t=I.has(e.id),s=e.body&&e.body.length>200,n=B===e.id,o=((e,t)=>{const s=new Set;if(e.body&&"string"===typeof e.body){const t=e.body.match(/@(\w+)/g);t&&t.forEach(e=>{const t=e.substring(1);t&&"string"===typeof t&&s.add(t)})}const n=t.filter(t=>t&&t.created_at&&e&&e.created_at&&new Date(t.created_at)>new Date(e.created_at));return n.forEach(t=>{if(t.body&&"string"===typeof t.body&&e.user&&e.user.login&&"string"===typeof e.user.login&&t.user&&t.user.login&&"string"===typeof t.user.login&&t.body.toLowerCase().includes("@".concat(e.user.login.toLowerCase()))&&s.add(t.user.login),e.body&&"string"===typeof e.body&&t.body&&"string"===typeof t.body&&t.user&&t.user.login&&"string"===typeof t.user.login){const n=e.body.toLowerCase().split(" ").filter(e=>e.length>3);n.length>0&&n.some(s=>t.body.toLowerCase().includes(s)&&t.user.login!==e.user.login)&&s.add(t.user.login)}}),(e.body&&"string"===typeof e.body&&e.body.toLowerCase().includes("copilot")||e.user&&e.user.login&&"string"===typeof e.user.login&&e.user.login.toLowerCase().includes("copilot"))&&s.add("copilot"),n.some(t=>t.user&&t.user.login&&"string"===typeof t.user.login&&t.user.login.toLowerCase().includes("copilot")||t.body&&"string"===typeof t.body&&e.user&&e.user.login&&"string"===typeof e.user.login&&t.body.toLowerCase().includes("@".concat(e.user.login.toLowerCase())))&&s.add("copilot"),e.user&&e.user.login&&"string"===typeof e.user.login&&s.delete(e.user.login),Array.from(s)})(e,f);return(0,l.jsxs)("div",{className:"comment ".concat("timeline"===e.type?"comment-timeline":""," ").concat(n?"comment-new-glow":""),children:[(0,l.jsxs)("div",{className:"comment-header",children:[(0,l.jsx)("img",{src:e.user.avatar_url,alt:e.user.login,className:"comment-avatar"}),(0,l.jsx)("a",{href:e.user.html_url,target:"_blank",rel:"noopener noreferrer",className:"comment-author",children:e.user.login}),(0,l.jsx)("span",{className:"comment-date",children:Pe(e.created_at)}),(0,l.jsx)("span",{className:"comment-type ".concat("timeline"===e.type?"comment-type-timeline":""),children:"timeline"===e.type?"status":e.type}),"timeline"!==e.type&&o.length>0&&(0,l.jsx)("div",{className:"comment-viewers",children:o.map((e,t)=>{const s="string"===typeof e?e:String(e||""),n=s&&s.toLowerCase().includes("copilot");return(0,l.jsxs)("span",{className:"viewer-badge ".concat(n?"viewer-badge-copilot":"viewer-badge-user"),title:"".concat(s," is looking at this comment"),children:[n?"\ud83d\udc41\ufe0f":"\ud83d\udc40"," ",s]},t)})})]}),(0,l.jsx)("div",{className:"comment-body",children:"timeline"===e.type?(0,l.jsx)("div",{className:"comment-timeline-body",children:(0,l.jsx)("div",{className:"timeline-content",children:e.body})}):s&&!t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"comment-preview",children:(0,l.jsx)("div",{className:"markdown-content",children:K&&V?(0,l.jsx)(K,{rehypePlugins:[V],children:Ee(De(e.body))}):(0,l.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:Ee(De(e.body))})})}),(0,l.jsx)("button",{className:"comment-toggle",onClick:()=>Te(e.id),children:"Show more"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"comment-full",children:(0,l.jsx)("div",{className:"markdown-content",children:K&&V?(0,l.jsx)(K,{rehypePlugins:[V],children:Ee(e.body)}):(0,l.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:Ee(e.body)})})}),s&&(0,l.jsx)("button",{className:"comment-toggle",onClick:()=>Te(e.id),children:"Show less"})]})})]},e.id)})}),(de.length>pe||he)&&(0,l.jsx)("div",{className:"comments-load-more",children:(0,l.jsx)("button",{className:"load-more-btn",onClick:async()=>{if(!s||0===s.length||w)return;const e=s[0];if(pe<de.length){const e=Math.min(de.length,pe+5);return me(e),void b(de.slice(0,e))}if(he){const t=ce+1;le(t),await Se("litlfred","sgex",e.number,t,!0)}},disabled:w,children:w?"Loading...":de.length>pe?"Show More Comments (".concat(de.length-pe," already loaded)"):"Load More Comments..."})})]})]}),(0,l.jsx)("div",{className:"expanded-footer",children:(0,l.jsx)("a",{href:s[0].html_url,target:"_blank",rel:"noopener noreferrer",className:"github-link",children:"View PR on GitHub \u2192"})})]})]}):(0,l.jsx)("div",{className:"preview-badge clickable ".concat(h?"expanded":""," ").concat(p?"sticky":""),onClick:async t=>{s&&s.length>0||(t.stopPropagation(),t.preventDefault(),p?(m(!1),g(!1)):(m(!0),g(!0),null!==e&&void 0!==e&&e.name&&(await Ae(e.name),_e(e.name))))},onMouseEnter:()=>{p||s&&0!==s.length||g(!0)},onMouseLeave:()=>{p||s&&0!==s.length||g(!1)},title:p?"Click to collapse":h?"Click to keep expanded":"\ud83d\udd0d Hover for branch details, click to pin: ".concat(e.name),children:(0,l.jsxs)("div",{className:"badge-content",children:[(0,l.jsx)("span",{className:"badge-label",children:"Preview:"}),(0,l.jsx)("span",{className:"badge-branch",children:e.name}),(0,l.jsx)("span",{className:"badge-expand-icon",children:h?"\u25bc":"\u25b6"})]})}),h&&(!s||0===s.length)&&(0,l.jsxs)("div",{className:"preview-badge-expanded",children:[(0,l.jsxs)("div",{className:"expanded-header",children:[(0,l.jsxs)("div",{className:"pr-info",children:[(0,l.jsxs)("h3",{children:["Preview Branch: ",e.name]}),(0,l.jsxs)("div",{className:"pr-meta",children:[(0,l.jsx)("span",{className:"pr-state","data-state":"unknown",children:"No PR found"}),(0,l.jsx)("span",{className:"pr-author",children:"Branch preview"})]})]}),(0,l.jsx)("button",{className:"close-button",onClick:e=>{e.stopPropagation(),g(!1),m(!1)},title:"Close expanded view",children:"\xd7"})]}),(0,l.jsxs)("div",{className:"pr-description",children:[(0,l.jsx)("h4",{children:"Branch Information"}),(0,l.jsxs)("div",{className:"pr-body",children:["This is a preview deployment from the ",(0,l.jsx)("code",{children:e.name})," branch.",(0,l.jsxs)("div",{style:{marginTop:"0.5rem"},children:[(0,l.jsx)("strong",{children:"Preview URL:"})," ",(0,l.jsxs)("code",{children:[window.location.origin,window.location.pathname]})]}),r.A.isAuth()?(0,l.jsx)("div",{style:{marginTop:"0.5rem",color:"#28a745"},children:"\u2705 Authenticated - You can view full PR details when available."}):(0,l.jsxs)("div",{style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"#f0f8ff",border:"1px solid #bee5eb",borderRadius:"4px"},children:[(0,l.jsx)("strong",{children:"\ud83d\udca1 Tip:"})," Sign in to GitHub to view pull request details, comments, and contribute to this branch."]})]})]}),(0,l.jsx)("div",{className:"workflow-status-wrapper",children:(0,l.jsx)(j,{workflowStatus:G,branchName:e.name,onTriggerWorkflow:Ce,onApproveWorkflow:je,isAuthenticated:r.A.isAuth(),canTriggerWorkflows:ee,canApproveWorkflows:se,isLoading:O})}),(0,l.jsx)("div",{className:"expanded-footer",children:(0,l.jsx)("a",{href:"https://github.com/litlfred/sgex/tree/".concat(e.name),target:"_blank",rel:"noopener noreferrer",className:"github-link",children:"View Branch on GitHub \u2192"})})]})]})};var R=s(1932);const E=()=>{const{pageName:e,profile:t,repository:s,branch:o,asset:i,isAuthenticated:c,navigate:d}=m(),u=(0,a.zy)(),[h,g]=(0,n.useState)(!1),[p,f]=(0,n.useState)(!1),[b,w]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(c){(async()=>{try{const e=N.getCurrentUser();if(e)w(e);else{const e=await r.A.getCurrentUser();w(e)}}catch(e){console.debug("Could not fetch authenticated user:",e)}})()}else w(null)},[c]);const y=()=>{(0,R.Rb)(d,u)},v=e=>{A.removeBookmark(e),f(!1),setTimeout(()=>f(!0),50)},k=A.getBookmarkByUrl(window.location.pathname),x=A.getBookmarksGroupedByPage();return(0,l.jsxs)("header",{className:"page-header",children:[(0,l.jsxs)("div",{className:"page-header-left",children:[(0,l.jsxs)("button",{className:"sgex-logo",onClick:y,onKeyDown:e=>"Enter"===e.key||" "===e.key?y():null,style:{border:"none",background:"none",padding:0,cursor:"pointer"},children:[(0,l.jsx)("h1",{children:"SGEX Workbench"}),(0,l.jsx)("p",{className:"subtitle",children:"WHO SMART Guidelines Exchange"})]}),(0,l.jsx)(I,{})]}),(0,l.jsx)("div",{className:"page-header-right",children:(c||null!==t&&void 0!==t&&t.isDemo)&&b?(0,l.jsxs)("div",{className:"user-controls",children:[(0,l.jsxs)("button",{className:"user-info",onClick:()=>g(!h),onKeyDown:e=>("Enter"===e.key||" "===e.key)&&g(!h),style:{border:"none",background:"none",padding:0,cursor:"pointer",display:"flex",alignItems:"center"},children:[(0,l.jsx)("img",{src:b.avatar_url,alt:"User avatar",className:"user-avatar"}),(0,l.jsx)("span",{className:"user-name",children:b.name||b.login}),(0,l.jsx)("span",{className:"dropdown-arrow",children:"\u25bc"})]}),h&&(0,l.jsxs)("div",{className:"user-dropdown",children:[(0,l.jsxs)("button",{className:"dropdown-item",onClick:()=>{null!==b&&void 0!==b&&b.html_url?window.open(b.html_url,"_blank"):null!==b&&void 0!==b&&b.login&&window.open("https://github.com/".concat(b.login),"_blank")},children:[(0,l.jsx)("svg",{className:"github-icon",viewBox:"0 0 16 16",width:"16",height:"16",children:(0,l.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})}),"GitHub Profile"]}),k?(0,l.jsx)("button",{className:"dropdown-item bookmark-action",onClick:()=>v(k.id),children:"\u2b50 Remove Bookmark"}):(0,l.jsx)("button",{className:"dropdown-item bookmark-action",onClick:()=>{const t={user:null===b||void 0===b?void 0:b.login,repository:s,branch:o,asset:i},n=window.location.pathname;A.addBookmark(e,n,t),f(!1)},children:"\u2606 Add Bookmark"}),(0,l.jsxs)("div",{className:"bookmarks-section",children:[(0,l.jsxs)("button",{className:"dropdown-item bookmarks-header",onClick:()=>f(!p),onKeyDown:e=>("Enter"===e.key||" "===e.key)&&f(!p),children:["\ud83d\udcd6 Bookmarks",(0,l.jsx)("span",{className:"dropdown-arrow",children:p?"\u25b2":"\u25bc"})]}),p&&(0,l.jsx)("div",{className:"bookmarks-dropdown",children:x.length>0?(0,l.jsx)("div",{className:"bookmarks-list",children:x.map(e=>(0,l.jsxs)("div",{className:"bookmark-group",children:[(0,l.jsx)("div",{className:"bookmark-group-header",children:e.pageName}),e.bookmarks.map(e=>(0,l.jsxs)("div",{className:"bookmark-item",children:[(0,l.jsx)("button",{className:"bookmark-link",onClick:()=>(e=>{d(e.url),f(!1)})(e),title:e.url,children:e.title}),(0,l.jsx)("button",{className:"bookmark-remove",onClick:()=>v(e.id),title:"Remove bookmark",children:"\xd7"})]},e.id))]},e.pageName))}):(0,l.jsx)("div",{className:"no-bookmarks",children:"No bookmarks yet"})})]}),(0,l.jsx)("button",{className:"dropdown-item logout-btn",onClick:()=>{r.A.logout(),d("/")},children:"Logout"})]})]}):(0,l.jsx)("button",{className:"login-btn",onClick:y,onKeyDown:e=>("Enter"===e.key||" "===e.key)&&y(),"aria-label":"Navigate to login page",children:"Login"})})]})},D=e=>{let{owner:t,repo:s,branch:o="main",className:a=""}=e;const[r,i]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0),[u,h]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=!0;const n=async()=>{if(t&&s)try{d(!0);const n=await N.getAccessBadge(t,s,o);e&&(i(n),d(!1))}catch(n){console.error("Error loading access badge:",n),e&&(i({text:"Unknown",icon:"\u2753",color:"gray",description:"Unable to determine access level"}),d(!1))}else d(!1)};n();const a=N.addListener(()=>{n()});return()=>{e=!1,a()}},[t,s,o]),c?(0,l.jsxs)("div",{className:"access-badge loading ".concat(a),children:[(0,l.jsx)("span",{className:"access-badge-icon",children:"\u23f3"}),(0,l.jsx)("span",{className:"access-badge-text",children:"Loading..."})]}):r?(0,l.jsxs)("div",{className:"access-badge ".concat(r.color," ").concat(a),onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),title:r.description,children:[(0,l.jsx)("span",{className:"access-badge-icon",role:"img","aria-label":r.text,children:r.icon}),(0,l.jsx)("span",{className:"access-badge-text",children:r.text}),u&&(0,l.jsx)("div",{className:"access-badge-tooltip",children:(0,l.jsxs)("div",{className:"tooltip-content",children:[(0,l.jsx)("strong",{children:r.text}),(0,l.jsx)("p",{children:r.description}),s&&(0,l.jsxs)("small",{children:["Repository: ",t,"/",s]})]})})]}):null},P=e=>{var t;let{customBreadcrumbs:s}=e;const{type:o,pageName:a,profile:i,repository:c,branch:d,navigate:p}=m(),[f,b]=(0,n.useState)([]),[w,y]=(0,n.useState)(!1),[v,k]=(0,n.useState)(""),[x,S]=(0,n.useState)(!1);(0,n.useEffect)(()=>{const e=e=>{w&&!e.target.closest(".page-context-branch-selector")&&(y(!1),k(""))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[w]),(0,n.useEffect)(()=>{(async()=>{if(!c||o!==h&&o!==g)b([]);else try{var e,t;S(!0);const s=(null===(e=c.owner)||void 0===e?void 0:e.login)||(null===(t=c.full_name)||void 0===t?void 0:t.split("/")[0]),n=(await r.A.getBranches(s,c.name)).sort((e,t)=>e.name.localeCompare(t.name));b(n)}catch(s){console.error("Failed to fetch branches for context:",s),b([])}finally{S(!1)}})()},[c,o]);const N=f.filter(e=>e.name.toLowerCase().includes(v.toLowerCase())),A=(()=>{if(s&&s.length>0)return s;const e=[];if(e.push({label:"Home",path:"/",onClick:()=>p("/")}),o!==u&&o!==h&&o!==g||!i||e.push({label:"Select Repository",path:"/dak-selection/".concat(i.login),onClick:()=>p("/dak-selection/".concat(i.login),{state:{profile:i}})}),(o===h||o===g)&&c){var t,n;const s=d&&"main"!==d?"/".concat(d):"",o=(null===(t=c.owner)||void 0===t?void 0:t.login)||(null===(n=c.full_name)||void 0===n?void 0:n.split("/")[0]);o&&e.push({label:"DAK Components",path:"/dashboard/".concat(o,"/").concat(c.name).concat(s),onClick:()=>p("/dashboard/".concat(o,"/").concat(c.name).concat(s))})}const r={landing:"Home","landing-unauthenticated":"Home",repositories:"Select Repository","dak-selection":"Select DAK","dak-action":"Choose DAK Action",dashboard:"DAK Components","dak-dashboard":"DAK Components","actor-editor":"Actor Definitions","component-editor":"Component Editor","bpmn-viewer":"Business Process Viewer","bpmn-editor":"Business Process Editor","decision-support-logic":"Decision Support Logic","core-data-dictionary-viewer":"Core Data Dictionary","testing-viewer":"Testing","pages-manager":"Pages",documentation:"Documentation"}[a]||a;return 0!==e.length&&e[e.length-1].label===r||e.push({label:r,current:!0}),e})();return!i&&!c&&A.length<=1?null:(0,l.jsx)("div",{className:"page-context-container",children:(0,l.jsxs)("div",{className:"page-context-content",children:[i&&(0,l.jsx)("img",{src:i.avatar_url,alt:"".concat(i.login," avatar"),className:"page-context-avatar"}),(0,l.jsxs)("div",{className:"page-context-info",children:[(0,l.jsxs)("div",{className:"page-context-row page-context-user-repo",children:[i&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"page-context-profile",onClick:()=>{null!==i&&void 0!==i&&i.html_url?window.open(i.html_url,"_blank"):null!==i&&void 0!==i&&i.login&&window.open("https://github.com/".concat(i.login),"_blank")},children:i.login}),c&&(0,l.jsx)("span",{className:"page-context-separator",children:"/"})]}),c&&(0,l.jsx)("span",{className:"page-context-repo",children:c.name}),d&&(o===h||o===g)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"page-context-separator",children:"@"}),(0,l.jsxs)("div",{className:"page-context-branch-selector",children:[(0,l.jsxs)("button",{className:"page-context-branch-btn",onClick:()=>y(!w),title:"Switch branch",children:[(0,l.jsx)("span",{className:"branch-icon",children:"\ud83c\udf3f"}),d,(0,l.jsx)("span",{className:"branch-dropdown-arrow",children:w?"\u25b2":"\u25bc"})]}),w&&(0,l.jsxs)("div",{className:"branch-dropdown",children:[(0,l.jsx)("div",{className:"branch-search",children:(0,l.jsx)("input",{type:"text",placeholder:"Search branches...",value:v,onChange:e=>k(e.target.value),className:"branch-search-input",autoFocus:!1})}),(0,l.jsx)("div",{className:"branch-list",children:x?(0,l.jsx)("div",{className:"branch-item loading",children:"Loading branches..."}):N.length>0?N.map(e=>(0,l.jsxs)("button",{className:"branch-item ".concat(e.name===d?"current":""),onClick:()=>(e=>{const t=window.location.pathname.split("/");t.length>=5&&(5===t.length?t.push(e):t[5]=e,p(t.join("/"))),y(!1),k("")})(e.name),children:[(0,l.jsx)("span",{className:"branch-icon",children:"\ud83c\udf3f"}),e.name,e.name===d&&(0,l.jsx)("span",{className:"current-badge",children:"current"})]},e.name)):(0,l.jsx)("div",{className:"branch-item no-results",children:v?"No branches found":"No branches available"})})]})]})]})]}),A.length>1&&(0,l.jsx)("nav",{className:"page-context-row page-context-breadcrumbs","aria-label":"Breadcrumb navigation",children:(0,l.jsx)("ol",{className:"breadcrumb-list",children:A.map((e,t)=>(0,l.jsx)("li",{className:"breadcrumb-item",children:e.current?(0,l.jsx)("span",{className:"breadcrumb-current","aria-current":"page",children:e.label}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{className:"breadcrumb-link",onClick:()=>e.onClick?e.onClick():p(e.path),"aria-label":"Navigate to ".concat(e.label),children:e.label}),(0,l.jsx)("span",{className:"breadcrumb-separator","aria-hidden":"true",children:"\u203a"})]})},t))})})]}),(o===h||o===g)&&c&&(0,l.jsxs)("div",{className:"page-context-actions",children:[(0,l.jsx)(D,{owner:(null===(t=c.owner)||void 0===t?void 0:t.login)||(null===i||void 0===i?void 0:i.login),repo:c.name,branch:d,className:"context-access-badge"}),(0,l.jsxs)("button",{className:"context-btn github-repo-btn",onClick:()=>{null!==c&&void 0!==c&&c.html_url&&window.open(c.html_url,"_blank")},title:"Open repository on GitHub",children:[(0,l.jsx)("svg",{className:"github-icon",viewBox:"0 0 16 16",width:"16",height:"16",children:(0,l.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})}),"Repository"]})]})]})})};var F=s(29166),G=s(88259);const H=e=>{let{error:t,onRetry:s}=e;const o=m(),a=o.pageName,[r,i]=(0,n.useState)(!1),c=(0,G.A)("sgex-mascot.png"),[d,u]=(0,n.useState)(""),h=(()=>{var e;const s=t.toLowerCase(),n=null===o||void 0===o?void 0:o.user,a=null===o||void 0===o||null===(e=o.repository)||void 0===e?void 0:e.name;if(s.includes("not found")||s.includes("not accessible")){if(s.includes("user"))return{title:"User Not Found",message:"The user ".concat(n?"'".concat(n,"'"):"in the URL"," could not be found on GitHub."),suggestions:["Check the spelling of the username","Verify the user account exists on GitHub","Try searching for the user on GitHub.com"],icon:"\ud83d\udc64"};if(s.includes("repository"))return{title:"Repository Not Found",message:"The repository ".concat(n&&a?"'".concat(n,"/").concat(a,"'"):"in the URL"," could not be accessed."),suggestions:["Check the spelling of the repository name","Verify the repository exists and is public","If it's a private repository, make sure you have access","Try visiting the repository directly on GitHub.com"],icon:"\ud83d\udcc1"}}return s.includes("not a valid dak")||s.includes("invalid dak")?{title:"Not a DAK Repository",message:"The repository ".concat(n&&a?"'".concat(n,"/").concat(a,"'"):"in the URL"," doesn't appear to contain WHO SMART Guidelines content."),suggestions:["Verify this is a WHO SMART Guidelines Digital Adaptation Kit","Check if the repository has a sushi-config.yaml file","Look for smart.who.int.base dependencies in the configuration","Try browsing other DAK repositories for examples"],icon:"\ud83d\udccb"}:s.includes("asset")&&s.includes("not found")?{title:"File Not Found",message:"The requested file could not be found in the repository.",suggestions:["Check if the file path is correct","Verify the file exists in the current branch","The file may have been moved or deleted","Try browsing the repository to find the correct path"],icon:"\ud83d\udcc4"}:{title:"Something Went Wrong",message:t,suggestions:["Try refreshing the page","Check your internet connection","The service may be temporarily unavailable"],icon:"\u26a0\ufe0f"}})();return(0,l.jsx)("div",{className:"error-handler",children:(0,l.jsxs)("div",{className:"error-content",children:[(0,l.jsx)("div",{className:"error-mascot-container",children:(0,l.jsx)(F.A,{helpContent:(0,l.jsx)("div",{className:"error-help-content",children:(0,l.jsxs)("div",{className:"error-mascot-large",children:[(0,l.jsx)("img",{src:c,alt:"SGEX Helper",className:"large-mascot-icon"}),(0,l.jsxs)("div",{className:"mascot-speech-bubble",children:[(0,l.jsx)("div",{className:"speech-content",children:"I'm sorry! Something went wrong."}),(0,l.jsx)("div",{className:"speech-tail"})]})]})}),position:"center"})}),(0,l.jsxs)("div",{className:"error-details",children:[(0,l.jsxs)("h2",{children:[h.icon," ",h.title]}),(0,l.jsx)("p",{className:"error-message",children:h.message}),h.suggestions&&(0,l.jsxs)("div",{className:"error-suggestions",children:[(0,l.jsx)("h3",{children:"\ud83d\udca1 Suggestions:"}),(0,l.jsx)("ul",{children:h.suggestions.map((e,t)=>(0,l.jsx)("li",{children:e},t))})]}),(0,l.jsxs)("div",{className:"error-actions",children:[(0,l.jsx)("button",{className:"error-btn primary",onClick:()=>{s?s():window.location.reload()},children:"\ud83d\udd04 Try Again"}),(0,l.jsx)("button",{className:"error-btn secondary",onClick:()=>{window.location.href="/sgex/"},children:"\ud83c\udfe0 Go Home"})]}),(0,l.jsxs)("div",{className:"bug-report-section",children:[(0,l.jsx)("h3",{children:"Help us improve SGEX"}),(0,l.jsx)("p",{children:"If this error persists, please let us know what happened:"}),(0,l.jsxs)("div",{className:"user-explanation",children:[(0,l.jsx)("label",{htmlFor:"user-explanation",children:"What were you trying to do when this error occurred?"}),(0,l.jsx)("textarea",{id:"user-explanation",value:d,onChange:e=>u(e.target.value),placeholder:"Please describe what you were doing when the error occurred...",rows:4})]}),r?(0,l.jsxs)("div",{className:"bug-report-sent",children:[(0,l.jsx)("span",{className:"success-icon",children:"\u2705"}),"Thank you! A bug report has been opened. We'll investigate this issue."]}):(0,l.jsx)("button",{className:"bug-report-btn",onClick:()=>{const e=(()=>{const e=encodeURIComponent("User should not have reached this page"),s=encodeURIComponent("\n**Error Information:**\n- Page: ".concat(a,"\n- URL: ").concat(window.location.href,"\n- Error: ").concat(t,"\n- Timestamp: ").concat((new Date).toISOString(),"\n- User Agent: ").concat(navigator.userAgent,"\n\n**Context:**\n- Browser: ").concat(navigator.userAgent,"\n- Viewport: ").concat(window.innerWidth,"x").concat(window.innerHeight,"\n- Referrer: ").concat(document.referrer||"Direct access","\n\n**User Explanation:**\n").concat(d||"No additional details provided","\n\n**Steps to Reproduce:**\n1. Navigate to: ").concat(window.location.href,"\n2. [Please add any additional steps]\n\n**Expected Behavior:**\nThe page should load without errors.\n\n**Actual Behavior:**\n").concat(t,"\n    "));return"https://github.com/litlfred/sgex/issues/new?title=".concat(e,"&body=").concat(s,"&labels=bug,user-error")})();window.open(e,"_blank"),i(!0)},children:"\ud83d\udce7 Send Bug Report"})]}),(0,l.jsx)("div",{className:"error-context",children:(0,l.jsxs)("details",{children:[(0,l.jsx)("summary",{children:"Technical Details"}),(0,l.jsxs)("div",{className:"technical-details",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Page:"})," ",a]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"URL:"})," ",window.location.href]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Error:"})," ",t]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Timestamp:"})," ",(new Date).toISOString()]})]})]})})]})]})})};class O extends n.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e.message}}componentDidCatch(e,t){console.error("PageLayout caught an error:",e,t)}render(){return this.state.hasError?(0,l.jsx)("div",{className:"page-layout-error",children:(0,l.jsx)(H,{error:this.state.error,onRetry:()=>{this.setState({hasError:!1,error:null}),window.location.reload()}})}):this.props.children}}const L=e=>{let{children:t,showHeader:s=!0,showMascot:n=!0,showBreadcrumbs:o=!0,customBreadcrumbs:a}=e;const{loading:r,error:i,pageName:c}=m();return r?(0,l.jsxs)("div",{className:"page-layout",children:[s&&(0,l.jsx)(E,{}),(0,l.jsx)("main",{className:"page-main",children:(0,l.jsxs)("div",{className:"page-loading",children:[(0,l.jsx)("div",{className:"loading-spinner"}),(0,l.jsx)("p",{children:"Loading..."})]})}),n&&(0,l.jsx)(F.A,{pageId:"".concat(c,"-loading"),position:"bottom-right"})]}):i?(0,l.jsxs)("div",{className:"page-layout",children:[s&&(0,l.jsx)(E,{}),(0,l.jsx)("main",{className:"page-main",children:(0,l.jsx)(H,{error:i,onRetry:()=>window.location.reload()})})]}):(0,l.jsxs)("div",{className:"page-layout",children:[s&&(0,l.jsx)(E,{}),(0,l.jsx)(P,{customBreadcrumbs:o?a:[]}),(0,l.jsxs)("main",{className:"page-main",children:[t,n&&(0,l.jsx)(F.A,{pageId:c,position:"bottom-right",contextData:{}})]})]})},B=e=>{let{children:t,pageName:s,showHeader:n=!0,showMascot:o=!0,showBreadcrumbs:a=!0,customBreadcrumbs:r}=e;return(0,l.jsx)(O,{children:(0,l.jsx)(b,{pageName:s,children:(0,l.jsx)(L,{showHeader:n,showMascot:o,showBreadcrumbs:a,customBreadcrumbs:r,children:t})})})},M=()=>{const{type:e,user:t,profile:s,repository:n,branch:o,asset:a,params:r,navigate:i}=m();return{type:e,user:t,profile:s,repository:n,branch:o,asset:a,params:r,updateBranch:t=>{if(e===h||e===g){const e=window.location.pathname.split("/");e.length>=5&&(5===e.length?e.push(t):e[5]=t,i(e.join("/")))}},navigateToUser:e=>{i("/".concat(r.page||"dak-action","/").concat(e))},navigateToDAK:function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";i("/".concat(r.page||"dashboard","/").concat(e,"/").concat(t,"/").concat(s))},navigateToAsset:(e,t,s,n)=>{i("/".concat(r.page||"editor","/").concat(e,"/").concat(t,"/").concat(s,"/").concat(n))},navigate:i}},U=()=>{try{const e=M();if(!e.loading&&e.type!==h&&e.type!==g)throw new Error("useDAKParams can only be used on DAK or Asset pages. Current page type: ".concat(e.type));return{user:e.user,profile:e.profile,repository:e.repository,branch:e.branch,asset:e.asset,updateBranch:e.updateBranch,navigate:e.navigate}}catch(e){if(e.message.includes("usePage must be used within a PageProvider"))return console.log("useDAKParams: PageProvider not ready yet, returning empty data"),{user:null,profile:null,repository:null,branch:null,asset:null,updateBranch:()=>{},navigate:()=>{}};throw e}};var q=s(80045);const K=e=>{let{hasChanges:t=!1,isSavingLocal:s=!1,isSavingGitHub:n=!1,canSaveToGitHub:o=!1,localSaveSuccess:a=!1,githubSaveSuccess:r=!1,savedLocally:i=!1,onSaveLocal:c,onSaveGitHub:d,showLocalButton:u=!0,showGitHubButton:h=!0,buttonSize:g="medium",layout:p="horizontal"}=e;const m=!t||s||a,f=!t||n||r||!o,b=["save-buttons-container","layout-".concat(p),"size-".concat(g)].join(" "),w=(e,t,s)=>{const n=["save-button","save-button-".concat(e)];return t&&n.push("disabled"),s&&n.push("success"),n.join(" ")};return(0,l.jsxs)("div",{className:b,children:[u&&(0,l.jsxs)("button",{className:w("local",m,a),onClick:c,disabled:m,title:t?a?"Changes saved to local storage":s?"Saving to local storage...":"Save changes to browser local storage":"No changes to save",children:[(0,l.jsx)("span",{className:"button-icon",children:"\ud83d\udcbe"}),(0,l.jsx)("span",{className:"button-text",children:a?"Saved Locally \u2713":s?"Saving...":"Save Local"})]}),h&&o&&(0,l.jsxs)("button",{className:w("github",f,r),onClick:d,disabled:f,title:t?r?"Changes committed to GitHub":n?"Committing to GitHub...":"Commit changes to GitHub repository":"No changes to save",children:[(0,l.jsx)("span",{className:"button-icon",children:"\ud83d\udce4"}),(0,l.jsx)("span",{className:"button-text",children:r?"Committed \u2713":n?"Committing...":"Save to GitHub"})]}),h&&!o&&(0,l.jsxs)("div",{className:"github-unavailable",children:[(0,l.jsx)("span",{className:"unavailable-icon",children:"\ud83d\udd12"}),(0,l.jsx)("span",{className:"unavailable-text",children:"GitHub save unavailable"}),(0,l.jsx)("small",{children:"Login required for GitHub access"})]}),i&&(0,l.jsxs)("div",{className:"local-storage-indicator",children:[(0,l.jsx)("span",{className:"local-icon",children:"\ud83d\udcbe"}),(0,l.jsx)("span",{className:"local-text",children:"Local version available"})]})]})},W=e=>{let{isOpen:t=!1,commitMessage:s="",setCommitMessage:o,onCommit:a,onCancel:r,isSaving:i=!1,fileName:c="",suggestedMessage:d=""}=e;const u=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(t&&u.current)if(u.current.focus(),s||d||!c)d&&!s&&o(d);else{const e="Update ".concat(c);o(e)}},[t,s,d,c,o]);return t?(0,l.jsx)("div",{className:"commit-dialog-overlay",onClick:e=>{e.target!==e.currentTarget||i||r()},role:"presentation",children:(0,l.jsxs)("div",{className:"commit-dialog",onKeyDown:e=>{"Escape"!==e.key||i?"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&s.trim()&&!i&&a(s.trim()):r()},role:"dialog","aria-labelledby":"commit-dialog-title","aria-modal":"true",children:[(0,l.jsxs)("div",{className:"commit-dialog-header",children:[(0,l.jsx)("h3",{id:"commit-dialog-title",children:"Commit Changes to GitHub"}),(0,l.jsx)("button",{className:"close-button",onClick:r,disabled:i,"aria-label":"Close dialog",children:"\u2715"})]}),(0,l.jsxs)("div",{className:"commit-dialog-content",children:[c&&(0,l.jsxs)("div",{className:"file-info",children:[(0,l.jsx)("span",{className:"file-icon",children:"\ud83d\udcc4"}),(0,l.jsx)("span",{className:"file-name",children:c})]}),(0,l.jsxs)("div",{className:"commit-message-section",children:[(0,l.jsx)("label",{htmlFor:"commit-message",className:"commit-message-label",children:"Commit Message *"}),(0,l.jsx)("textarea",{id:"commit-message",ref:u,className:"commit-message-input",value:s,onChange:e=>o(e.target.value),placeholder:"Describe the changes you made...",rows:4,disabled:i,required:!0}),(0,l.jsx)("div",{className:"commit-message-help",children:(0,l.jsx)("small",{children:"Describe what changes you made and why. This will be visible in the repository's commit history."})})]}),(0,l.jsx)("div",{className:"commit-guidelines",children:(0,l.jsxs)("details",{children:[(0,l.jsx)("summary",{children:"Commit Message Guidelines"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Use clear, descriptive language"}),(0,l.jsx)("li",{children:"Start with a verb (Add, Update, Fix, Remove, etc.)"}),(0,l.jsx)("li",{children:"Keep the first line under 72 characters"}),(0,l.jsx)("li",{children:"Add details in additional lines if needed"})]})]})})]}),(0,l.jsxs)("div",{className:"commit-dialog-footer",children:[(0,l.jsxs)("div",{className:"dialog-actions",children:[(0,l.jsx)("button",{className:"btn btn-secondary",onClick:r,disabled:i,children:"Cancel"}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>{s.trim()&&!i&&a(s.trim())},disabled:!s.trim()||i,children:i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"spinner"}),"Committing..."]}):"Commit Changes"})]}),(0,l.jsx)("div",{className:"keyboard-shortcut",children:(0,l.jsxs)("small",{children:["Press ",(0,l.jsx)("kbd",{children:"Ctrl+Enter"})," to commit or ",(0,l.jsx)("kbd",{children:"Esc"})," to cancel"]})})]})]})}):null};var z=s(57561);const X="local",V="github",Y="success",J="error",Q="permission_denied";const Z=new class{constructor(){this.logger=w.A.getLogger("DataAccessLayer"),this.pendingOperations=new Map,this.assetCache=new Map}async initialize(e,t){this.logger.info("Initializing data access layer",{repository:null===e||void 0===e?void 0:e.full_name,branch:t}),z.A.initialize(e,t),await N.initialize()}async getAsset(e,t,s,n){const o="".concat(e,"/").concat(t,"/").concat(s,"/").concat(n);try{if("none"===await N.getRepositoryAccess(e,t,s))throw new Error("No access to this repository");const a=z.A.getStagingGround().files.find(e=>e.path===n);if(a)return this.logger.debug("Asset loaded from staging ground",{assetPath:n}),{content:a.content,source:"local",metadata:a.metadata,hasLocalChanges:!0};const i=await r.A.getFileContent(e,t,n,s);return this.assetCache.set(o,i),this.logger.debug("Asset loaded from GitHub",{assetPath:n,source:"github"}),{content:i,source:"github",hasLocalChanges:!1}}catch(a){throw this.logger.error("Error getting asset",{owner:e,repo:t,branch:s,assetPath:n,error:a.message}),a}}async saveAssetLocal(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const n=N.getUserType();if(z.A.updateFile(e,t,(0,o.A)((0,o.A)({},s),{},{savedBy:n,saveTarget:X})))return this.logger.info("Asset saved to local storage",{assetPath:e,userType:n}),{result:Y,message:"Changes saved to local staging area",target:X};throw new Error("Failed to save to local storage")}catch(n){return this.logger.error("Error saving asset locally",{assetPath:e,error:n.message}),{result:J,message:"Failed to save locally: ".concat(n.message),target:X}}}async saveAssetGitHub(e,t,s,n,o,a){try{const g=N.getUserType();if(!await N.canSaveToGitHub(e,t,s))return"unauthenticated"===g?{result:Q,message:"Please authenticate to save changes to GitHub.",target:V}:{result:Q,message:"You do not have write access to this repository.",target:V};const p=await r.A.updateFileContent(e,t,n,o,a,s);if(p.success){var i,c,l,d,u,h;z.A.removeFile(n);const o="".concat(e,"/").concat(t,"/").concat(s,"/").concat(n);return this.assetCache.delete(o),this.logger.info("Asset saved to GitHub",{owner:e,repo:t,branch:s,assetPath:n,commit:null===(i=p.data)||void 0===i||null===(c=i.commit)||void 0===c?void 0:c.sha}),{result:Y,message:"Changes successfully committed to GitHub",target:V,commitSha:null===(l=p.data)||void 0===l||null===(d=l.commit)||void 0===d?void 0:d.sha,commitUrl:null===(u=p.data)||void 0===u||null===(h=u.commit)||void 0===h?void 0:h.html_url}}throw new Error(p.error||"GitHub commit failed")}catch(g){return this.logger.error("Error saving asset to GitHub",{owner:e,repo:t,branch:s,assetPath:n,error:g.message}),{result:J,message:"Failed to save to GitHub: ".concat(g.message),target:V}}}async getSaveOptions(e,t,s){const n=N.getUserType(),o=await N.canSaveToGitHub(e,t,s),a=N.canSaveLocal(),r=N.getUIBehavior();return{canSaveLocal:a,canSaveGitHub:o,showSaveLocal:r.showSaveLocal,showSaveGitHub:r.showSaveToGitHub,confirmBeforeSave:r.confirmBeforeSave,userType:n,restrictions:this.getSaveRestrictions(n,o)}}getSaveRestrictions(e,t){switch(e){case"unauthenticated":return{localMessage:"Changes will be saved to your browser only",githubMessage:"Please authenticate to save to GitHub",githubDisabled:!0};case"demo":return{localMessage:"Changes will be saved to your browser only",githubMessage:"Demo users cannot save to GitHub",githubDisabled:!0};case"authenticated":return t?{localMessage:"Save changes to staging area",githubMessage:"Commit changes to GitHub repository",githubDisabled:!1}:{localMessage:"Changes will be saved to your browser only",githubMessage:"You do not have write access to this repository",githubDisabled:!0};default:return{localMessage:"Local saves only",githubMessage:"GitHub saves not available",githubDisabled:!0}}}getStagingGroundStatus(){return z.A.getStatus()}clearStagingGround(){return z.A.clearStagingGround()}getChangedFiles(){return z.A.getStagingGround().files}hasLocalChanges(e){return z.A.getStagingGround().files.some(t=>t.path===e)}async createAsset(e,t,s,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(!N.getUIBehavior().allowCreateNew)throw new Error("Current user type cannot create new assets");return this.saveAssetLocal(n,a,(0,o.A)((0,o.A)({},r),{},{isNew:!0,createdAt:Date.now()}))}async batchSaveLocal(e){const t=[];for(const s of e){const e=await this.saveAssetLocal(s.path,s.content,s.metadata);t.push((0,o.A)((0,o.A)({},e),{},{path:s.path}))}return{success:t.every(e=>e.result===Y),results:t}}async getAccessInfo(e,t,s){const[n,o,a]=await Promise.all([N.getRepositoryAccess(e,t,s),N.getAccessBadge(e,t,s),this.getSaveOptions(e,t,s)]);return{access:n,badge:o,saveOptions:a,userType:N.getUserType()}}},$=["children","pageName","file","repository","branch","content","originalContent","hasChanges","onSave","onContentChange","customSaveToGitHub","showSaveButtons","saveButtonsPosition"],ee=e=>{let{children:t,pageName:s,file:a,repository:r,branch:i,content:c,originalContent:d,hasChanges:u=!1,onSave:h,onContentChange:g,customSaveToGitHub:p,showSaveButtons:m=!0,saveButtonsPosition:f="top"}=e,b=(0,q.A)(e,$);const[w,y]=(0,n.useState)(!1),[v,k]=(0,n.useState)(!1),[x,S]=(0,n.useState)(null),[N,A]=(0,n.useState)(!1),[C,j]=(0,n.useState)(!1),[_,T]=(0,n.useState)(null),[I,R]=(0,n.useState)(!1),[E,D]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{if(r)try{var e;const t=await Z.getSaveOptions(null===(e=r.owner)||void 0===e?void 0:e.login,r.name,i);T(t)}catch(t){console.error("Error loading save options:",t)}})()},[r,i]);const P=(null===_||void 0===_?void 0:_.canSaveGitHub)&&(null===_||void 0===_?void 0:_.showSaveGitHub),F=(0,n.useCallback)(async()=>{if(u&&null!==a&&void 0!==a&&a.path)try{var e;y(!0),S(null),A(!1);const t=await Z.saveAssetLocal(a.path,c,{repository:(null===r||void 0===r?void 0:r.full_name)||"".concat(null===r||void 0===r||null===(e=r.owner)||void 0===e?void 0:e.login,"/").concat(null===r||void 0===r?void 0:r.name),branch:i||(null===r||void 0===r?void 0:r.default_branch)||"main",fileName:a.name,timestamp:(new Date).toISOString()});if("success"!==t.result)throw new Error(t.message||"Failed to save to local storage");A(!0),h&&h(c,"local"),setTimeout(()=>{A(!1)},3e3)}catch(t){console.error("Error saving file locally:",t),S("Failed to save locally: ".concat(t.message))}finally{y(!1)}},[u,a,c,r,i,h]),G=(0,n.useCallback)(()=>{u&&P&&(S(null),R(!0))},[u,P]),H=(0,n.useCallback)(async e=>{if(e.trim()&&null!==a&&void 0!==a&&a.path)try{var t;if(k(!0),S(null),j(!1),p){if(!await p(e.trim()))throw new Error("Custom save function failed");return j(!0),R(!1),D(""),h&&h(c,"github"),void setTimeout(()=>{j(!1)},3e3)}const s=await Z.saveAssetGitHub(null===r||void 0===r||null===(t=r.owner)||void 0===t?void 0:t.login,null===r||void 0===r?void 0:r.name,i,a.path,c,e.trim());if("success"!==s.result){let e=s.message;throw"demo_mode_blocked"===s.result?e="Demo users cannot save to GitHub. You can save changes locally instead.":"permission_denied"===s.result&&(e="You do not have permission to save to this repository."),new Error(e)}j(!0),R(!1),D(""),h&&h(c,"github"),setTimeout(()=>{j(!1)},3e3)}catch(s){console.error("Error saving file to GitHub:",s),S("Failed to save to GitHub: ".concat(s.message))}finally{k(!1)}},[a,c,r,i,h,p]),O=(0,n.useCallback)(()=>{R(!1),D("")},[]),L={hasChanges:u,isSavingLocal:w,isSavingGitHub:v,canSaveToGitHub:P,localSaveSuccess:N,githubSaveSuccess:C,onSaveLocal:F,onSaveGitHub:G};return(0,l.jsx)(B,(0,o.A)((0,o.A)({pageName:s},b),{},{children:(0,l.jsxs)("div",{className:"asset-editor-layout",children:[m&&("top"===f||"both"===f)&&(0,l.jsx)("div",{className:"save-buttons-top",children:(0,l.jsx)(K,(0,o.A)({},L))}),x&&(0,l.jsxs)("div",{className:"asset-editor-error",children:[(0,l.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),x,(0,l.jsx)("button",{className:"btn-link error-dismiss",onClick:()=>S(null),children:"\u2715"})]}),N&&(0,l.jsxs)("div",{className:"asset-editor-success",children:[(0,l.jsx)("span",{className:"success-icon",children:"\u2705"}),"Changes saved locally successfully!"]}),C&&(0,l.jsxs)("div",{className:"asset-editor-success",children:[(0,l.jsx)("span",{className:"success-icon",children:"\u2705"}),"Changes committed to GitHub successfully!"]}),(0,l.jsx)("div",{className:"asset-editor-content",children:t}),m&&("bottom"===f||"both"===f)&&(0,l.jsx)("div",{className:"save-buttons-bottom",children:(0,l.jsx)(K,(0,o.A)({},L))}),I&&(0,l.jsx)(W,{isOpen:I,commitMessage:E,setCommitMessage:D,onCommit:H,onCancel:O,isSaving:v,fileName:null===a||void 0===a?void 0:a.name})]})}))};s(62141);const te=["toolDefinition"],se="viewer",ne="editor",oe="dashboard",ae="utility";class re{constructor(e){this.id=e.id,this.name=e.name,this.title=e.title||e.name,this.description=e.description,this.type=e.type||ae,this.route=e.route||"/".concat(this.id),this.icon=e.icon,this.category=e.category||"general",this.requiresAuth=!1!==e.requiresAuth,this.supportsDemo=!1!==e.supportsDemo,this.requiresDAK=e.requiresDAK||!1,this.assetTypes=e.assetTypes||[],this.assetPattern=e.assetPattern,this.viewerComponent=e.viewerComponent,this.editorComponent=e.editorComponent,this.dashboardComponent=e.dashboardComponent,this.onInit=e.onInit,this.onAssetLoad=e.onAssetLoad,this.onAssetSave=e.onAssetSave,this.onError=e.onError}supportsAsset(e){var t;return!(null!==(t=this.assetTypes)&&void 0!==t&&t.length||this.assetPattern)||(this.assetPattern?new RegExp(this.assetPattern).test(e):this.assetTypes.some(t=>e.includes(t)))}async canAccess(){return!this.requiresAuth||!N.isUnauthenticated()}createComponent(){const e=this;return function(t){return(0,l.jsx)(ie,(0,o.A)({toolDefinition:e},t))}}}const ie=e=>{let{toolDefinition:t}=e,s=(0,q.A)(e,te);const a=M(),[r,i]=n.useState({loading:!0,error:null,canAccess:!1,assets:[],content:null}),c=n.useCallback(async()=>{try{i(e=>(0,o.A)((0,o.A)({},e),{},{loading:!0,error:null}));if(!await t.canAccess())throw new Error("Access denied: This tool requires ".concat(t.requiresAuth?"authentication":"different user type"));a.repository&&await Z.initialize(a.repository,a.branch);let s=[],n=null;if(a.asset&&(t.type===se||t.type===ne)){if(!t.supportsAsset(a.asset))throw new Error("This tool does not support asset type: ".concat(a.asset));{var e;const t=await Z.getAsset(a.user,null===(e=a.repository)||void 0===e?void 0:e.name,a.branch,a.asset);s=[(0,o.A)({path:a.asset},t)],n=t.content}}t.onInit&&await t.onInit({pageParams:a,assets:s,content:n}),i({loading:!1,error:null,canAccess:!0,assets:s,content:n})}catch(s){console.error("Error initializing tool ".concat(t.id,":"),s),i({loading:!1,error:s.message,canAccess:!1,assets:[],content:null}),t.onError&&t.onError(s,{pageParams:a})}},[t,a]);n.useEffect(()=>{c()},[c]);const d=async(e,s)=>{if(a.asset)try{let n;if("local"===s)n=await Z.saveAssetLocal(a.asset,e);else if("github"===s)throw new Error("GitHub save requires commit message - use handleGitHubSave instead");return t.onAssetSave&&await t.onAssetSave({asset:a.asset,content:e,saveType:s,result:n,pageParams:a}),n}catch(n){throw console.error("Error saving asset in tool ".concat(t.id,":"),n),n}},u=async(e,s)=>{if(a.asset)try{var n;const o=await Z.saveAssetGitHub(a.user,null===(n=a.repository)||void 0===n?void 0:n.name,a.branch,a.asset,e,s);return t.onAssetSave&&await t.onAssetSave({asset:a.asset,content:e,saveType:"github",result:o,commitMessage:s,pageParams:a}),o}catch(o){throw console.error("Error saving asset to GitHub in tool ".concat(t.id,":"),o),o}};if(r.loading)return(0,l.jsx)(B,{pageName:t.id,children:(0,l.jsxs)("div",{className:"tool-loading",children:[(0,l.jsxs)("h2",{children:["Loading ",t.title,"..."]}),(0,l.jsx)("p",{children:"Initializing tool and checking access permissions."})]})});if(r.error||!r.canAccess)return(0,l.jsx)(B,{pageName:t.id,children:(0,l.jsxs)("div",{className:"tool-error",children:[(0,l.jsxs)("h2",{children:["Cannot Access ",t.title]}),(0,l.jsx)("p",{children:r.error||"Access denied"}),(0,l.jsx)("button",{onClick:()=>window.history.back(),children:"Go Back"})]})});return(()=>{const e=(0,o.A)({toolDefinition:t,pageParams:a,toolState:r,onAssetSave:d,onGitHubSave:u},s);switch(t.type){case ne:if(t.editorComponent){const s=t.editorComponent;var n;return a.asset&&r.assets.length>0?(0,l.jsx)(ee,{pageName:t.id,file:{name:a.asset,path:a.asset},repository:a.repository,branch:a.branch,content:r.content,originalContent:null===(n=r.assets[0])||void 0===n?void 0:n.content,hasChanges:!1,onSave:d,onContentChange:e=>{i(t=>(0,o.A)((0,o.A)({},t),{},{content:e}))},children:(0,l.jsx)(s,(0,o.A)({},e))}):(0,l.jsx)(B,{pageName:t.id,children:(0,l.jsx)(s,(0,o.A)({},e))})}break;case se:if(t.viewerComponent){const s=t.viewerComponent;return(0,l.jsx)(B,{pageName:t.id,children:(0,l.jsx)(s,(0,o.A)({},e))})}break;case oe:if(t.dashboardComponent){const s=t.dashboardComponent;return(0,l.jsx)(B,{pageName:t.id,children:(0,l.jsx)(s,(0,o.A)({},e))})}break;default:const s=t.viewerComponent||t.editorComponent||t.dashboardComponent;if(s)return(0,l.jsx)(B,{pageName:t.id,children:(0,l.jsx)(s,(0,o.A)({},e))})}return(0,l.jsx)(B,{pageName:t.id,children:(0,l.jsxs)("div",{className:"tool-fallback",children:[(0,l.jsx)("h1",{children:t.title}),(0,l.jsx)("p",{children:t.description}),(0,l.jsx)("p",{children:"No component defined for this tool."})]})})})()};new class{constructor(){this.tools=new Map}register(e){const t=new re(e);return this.tools.set(t.id,t),t}get(e){return this.tools.get(e)}getAll(){return Array.from(this.tools.values())}getByCategory(e){return this.getAll().filter(t=>t.category===e)}getByAssetType(e){return this.getAll().filter(t=>t.supportsAsset(e))}async getAccessibleTools(){const e=this.getAll(),t=[];for(const s of e)await s.canAccess()&&t.push(s);return t}}},57561:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(80045),o=s(89379);const a=["savedAt"];const r=new class{constructor(){this.listeners=new Set,this.currentRepository=null,this.currentBranch=null}initialize(e,t){this.currentRepository=e,this.currentBranch=t,this.notifyListeners()}getStorageKey(){if(!this.currentRepository||!this.currentBranch)throw new Error("Staging ground not initialized");return"sgex_staging_".concat(this.currentRepository.full_name,"_").concat(this.currentBranch)}getStagingGround(){try{const e=this.getStorageKey(),t=localStorage.getItem(e);return t?JSON.parse(t):this.createEmptyStagingGround()}catch(e){return console.warn("Error reading staging ground from localStorage:",e),this.createEmptyStagingGround()}}createEmptyStagingGround(){var e;return{message:"",files:[],timestamp:Date.now(),branch:this.currentBranch,repository:null===(e=this.currentRepository)||void 0===e?void 0:e.full_name}}saveStagingGround(e){try{var t;const s=this.getStorageKey();return e.timestamp=Date.now(),e.branch=this.currentBranch,e.repository=null===(t=this.currentRepository)||void 0===t?void 0:t.full_name,localStorage.setItem(s,JSON.stringify(e)),this.saveToHistory(e),this.notifyListeners(),!0}catch(s){return console.error("Error saving staging ground to localStorage:",s),!1}}updateFile(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.getStagingGround(),a=n.files.findIndex(t=>t.path===e),r={path:e,content:t,metadata:(0,o.A)((0,o.A)({},s),{},{lastModified:Date.now()}),timestamp:Date.now()};return a>=0?n.files[a]=r:n.files.push(r),this.saveStagingGround(n)}removeFile(e){const t=this.getStagingGround();return t.files=t.files.filter(t=>t.path!==e),this.saveStagingGround(t)}updateCommitMessage(e){const t=this.getStagingGround();return t.message=e,this.saveStagingGround(t)}hasChanges(){return this.getStagingGround().files.length>0}getChangedFilesCount(){return this.getStagingGround().files.length}clearStagingGround(){const e=this.createEmptyStagingGround();return this.saveStagingGround(e)}saveToHistory(e){try{const t="".concat(this.getStorageKey(),"_history"),s=this.getHistory();s.push((0,o.A)((0,o.A)({},e),{},{savedAt:Date.now()}));const n=s.slice(-10);localStorage.setItem(t,JSON.stringify(n))}catch(t){console.warn("Error saving to history:",t)}}getHistory(){try{const e="".concat(this.getStorageKey(),"_history"),t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch(e){return console.warn("Error reading history:",e),[]}}rollbackToSave(e){const t=this.getHistory().find(t=>t.savedAt===e);if(!t)throw new Error("Save not found in history");const{savedAt:s}=t,o=(0,n.A)(t,a);return this.saveStagingGround(o)}exportStagingGround(){var e;return{current:this.getStagingGround(),history:this.getHistory(),exportedAt:Date.now(),repository:null===(e=this.currentRepository)||void 0===e?void 0:e.full_name,branch:this.currentBranch}}importStagingGround(e){var t;if(!e.current||!e.repository||!e.branch)throw new Error("Invalid export data format");if(e.repository!==(null===(t=this.currentRepository)||void 0===t?void 0:t.full_name)||e.branch!==this.currentBranch)throw new Error("Export data is for different repository or branch");if(this.saveStagingGround(e.current),e.history)try{const t="".concat(this.getStorageKey(),"_history");localStorage.setItem(t,JSON.stringify(e.history))}catch(s){console.warn("Error importing history:",s)}return!0}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6048e5;try{const s=Date.now(),n=[];for(let o=0;o<localStorage.length;o++){const a=localStorage.key(o);if(a&&a.startsWith("sgex_staging_"))try{const t=JSON.parse(localStorage.getItem(a));t.timestamp&&s-t.timestamp>e&&(n.push(a),n.push("".concat(a,"_history")))}catch(t){n.push(a)}}return n.forEach(e=>{localStorage.removeItem(e)}),n.length}catch(t){return console.error("Error during cleanup:",t),0}}addListener(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){const e=this.getStagingGround();this.listeners.forEach(t=>{try{t(e)}catch(s){console.error("Error in staging ground listener:",s)}})}contributeFiles(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Array.isArray(e)||(e=[e]);let s=!0;const n=[];return e.forEach(e=>{if(!e.path||!e.content)return n.push({path:e.path,success:!1,error:"Missing path or content"}),void(s=!1);const a=this.updateFile(e.path,e.content,(0,o.A)((0,o.A)({},t),{},{source:t.tool||"unknown",contributedAt:Date.now()}));n.push({path:e.path,success:a}),a||(s=!1)}),{success:s,results:n}}getStatus(){var e;const t=this.getStagingGround();return{hasChanges:this.hasChanges(),filesCount:this.getChangedFilesCount(),lastModified:t.timestamp,branch:this.currentBranch,repository:null===(e=this.currentRepository)||void 0===e?void 0:e.full_name}}}},61115:(e,t,s)=>{s.d(t,{A:()=>n});const n=new class{constructor(){this.universalTopics={documentation:{id:"sgex-documentation",title:"View Documentation",badge:"/sgex/cat-paw-info-icon.svg",type:"action",action:()=>{const e=window.location.pathname;let t="";if(e.includes("/sgex")){const s=e.split("/"),n=s.indexOf("sgex");-1!==n&&(t=s.length>n+2&&s[n+1]&&!["dashboard","docs","select_profile","dak-action","dak-selection"].includes(s[n+1])?"/".concat(s.slice(1,n+2).join("/")):"/".concat(s.slice(1,n+1).join("/")))}window.location.href="".concat(t,"/docs/overview")},content:'\n          <p>Access comprehensive documentation and guides for using SGEX Workbench.</p>\n          <div class="help-tip">\n            <strong>\ud83d\udcd6 Available Documentation:</strong> Requirements, Architecture, DAK Components, User Guides, and more.\n          </div>\n        '},workflows:{id:"sgex-workflows",title:"View Deployment Workflows",badge:"/sgex/cat-paw-workflow-icon.svg",type:"action",action:()=>{window.open("".concat("https://github.com/litlfred/sgex","/actions"),"_blank")},content:'\n          <p>Access GitHub Actions workflows for automated deployment and quality checks.</p>\n          <div class="help-tip">\n            <strong>\ud83d\udd04 Available Workflows:</strong> Branch deployment, landing page deployment, PR feedback, security scanning, and compliance checks.\n          </div>\n          <div class="workflow-links">\n            <h4>\ud83d\ude80 Deployment Workflows:</h4>\n            <ul>\n              <li><a href="https://github.com/litlfred/sgex/blob/main/.github/workflows/branch-deployment.yml" target="_blank">Branch Deployment</a> - Deploy feature branches for preview</li>\n              <li><a href="https://github.com/litlfred/sgex/blob/main/.github/workflows/landing-page-deployment.yml" target="_blank">Landing Page Deployment</a> - Deploy main app to production</li>\n            </ul>\n            <h4>\ud83d\udee1\ufe0f Quality & Security Workflows:</h4>\n            <ul>\n              <li><a href="https://github.com/litlfred/sgex/blob/main/.github/workflows/framework-compliance.yml" target="_blank">Framework Compliance</a> - Code quality and standards</li>\n              <li><a href="https://github.com/litlfred/sgex/blob/main/.github/workflows/dependency-security.yml" target="_blank">Security Scanning</a> - Dependency vulnerability checks</li>\n            </ul>\n            <h4>\ud83d\udcac Feedback Workflows:</h4>\n            <ul>\n              <li><a href="https://github.com/litlfred/sgex/blob/main/.github/workflows/pr-commit-feedback.yml" target="_blank">PR Commit Feedback</a> - Real-time PR status updates</li>\n              <li><a href="https://github.com/litlfred/sgex/blob/main/.github/workflows/review.yml" target="_blank">Review Deployment</a> - Auto-deploy on approval</li>\n            </ul>\n          </div>\n        '},bugReport:{id:"report-sgex-bug",title:"Report a SGeX bug",badge:"/sgex/cat-paw-bug-icon.svg",type:"slideshow",content:[{title:"Report a Bug or Issue",content:'\n              <p>Help us improve SGeX by reporting bugs and issues:</p>\n              <h4>What type of issue are you experiencing?</h4>\n              <div class="bug-report-options">\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'bug\')">\n                  \ud83d\udc1b Bug Report - Something isn\'t working correctly\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'feature\')">\n                  \u2728 Feature Request - Suggest a new feature or improvement\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'question\')">\n                  \u2753 Question - Ask for help or clarification\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'documentation\')">\n                  \ud83d\udcda Documentation Issue - Report problems with documentation\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'blank\')">\n                  \ud83d\udcdd Blank Issue - Create an issue without a template\n                </button>\n              </div>\n              <div class="help-tip">\n                <strong>\ud83d\udca1 Tip:</strong> Please provide as much detail as possible including steps to reproduce, expected behavior, and actual behavior.\n              </div>\n              <div class="help-fallback">\n                <strong>\ud83d\udd17 Can\'t access GitHub?</strong> If the buttons above don\'t work in your environment:\n                <ol>\n                  <li>Email us directly at <a href="mailto:smart@who.int?subject=SGEX Bug Report">smart@who.int</a></li>\n                  <li>Or visit <a href="https://github.com/litlfred/sgex/issues/new" target="_blank">github.com/litlfred/sgex/issues/new</a> manually</li>\n                </ol>\n              </div>\n            '}]},dakFeedback:{id:"provide-dak-feedback",title:"Provide DAK Feedback",type:"slideshow",content:[{title:"Provide Feedback on this DAK",content:'\n              <p>Share feedback about this Digital Adaptation Kit (DAK):</p>\n              <h4>What type of feedback do you have?</h4>\n              <div class="bug-report-options">\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'content\')">\n                  \ud83d\udcdd Report DAK Content Error - Problems with clinical content or logic\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'bug\')">\n                  \ud83d\udc1b DAK Bug - Issue with this specific DAK content\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'improvement\')">\n                  \ud83d\udcc8 DAK Improvement - Suggest enhancements to this DAK\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'question\')">\n                  \u2753 DAK Question - Ask about this DAK\'s implementation\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'blank\')">\n                  \ud83d\udcdd Blank DAK Issue - Create an issue without a template\n                </button>\n              </div>\n              <div class="help-tip">\n                <strong>\ud83d\udca1 Note:</strong> This will open an issue in the selected DAK repository for targeted feedback.\n              </div>\n            '}]}},this.helpTopics={"landing-page-unauthenticated":[{id:"github-pat-setup",title:"How to Create a GitHub Personal Access Token",badge:"/sgex/cat-paw-lock-icon.svg",type:"slideshow",content:[{title:"Step 1: Go to GitHub Settings",content:'\n                <p>Navigate to your GitHub account settings:</p>\n                <ol>\n                  <li>Click your profile picture in the top right</li>\n                  <li>Select "Settings" from the dropdown</li>\n                  <li>Go to "Developer settings" \u2192 "Personal access tokens"</li>\n                  <li>Choose "Fine-grained tokens" (recommended) or "Tokens (classic)"</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> Fine-grained tokens provide better security with repository-specific access.\n                </div>\n              '},{title:"Step 2: Generate New Token",content:'\n                <p>Create your new token:</p>\n                <ol>\n                  <li>Click "Generate new token"</li>\n                  <li>Give it a descriptive name like "SGEX Workbench"</li>\n                  <li>Set expiration (90 days recommended)</li>\n                  <li>Select repository access (specific repos or all)</li>\n                </ol>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Important:</strong> You\'ll only see the token once, so copy it immediately!\n                </div>\n              '},{title:"Step 3: Set Required Permissions",content:"\n                <p>For <strong>fine-grained tokens</strong>, enable:</p>\n                <ul>\n                  <li><strong>Contents:</strong> Read and Write</li>\n                  <li><strong>Metadata:</strong> Read</li>\n                  <li><strong>Pull requests:</strong> Read and Write</li>\n                </ul>\n                <p>For <strong>classic tokens</strong>, select:</p>\n                <ul>\n                  <li><strong>repo</strong> - Full control of private repositories</li>\n                  <li><strong>read:org</strong> - Read org and team membership</li>\n                </ul>\n              "},{title:"Step 4: Use Your Token",content:'\n                <p>Now you can authenticate with SGEX:</p>\n                <ol>\n                  <li>Copy your newly generated token</li>\n                  <li>Paste it into the login form</li>\n                  <li>Click "Sign in with Personal Access Token"</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udd12 Security:</strong> Your token is stored securely in your browser and never shared with servers.\n                </div>\n              '}]}],"landing-page-authenticated":[{id:"profile-selection",title:"Selecting Your Profile or Organization",type:"slideshow",content:[{title:"Understanding Profile Types",content:'\n                <p>SGEX shows different types of profiles:</p>\n                <ul>\n                  <li><strong>Personal:</strong> Your individual GitHub repositories</li>\n                  <li><strong>Organization:</strong> Repositories belonging to organizations you\'re a member of</li>\n                  <li><strong>WHO Official:</strong> World Health Organization repositories (always available)</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> DAK count badges show how many SMART Guidelines repositories were found.\n                </div>\n              '}]}],"dak-action-selection":[{id:"choosing-dak-action",title:"Choosing Your DAK Action",type:"slideshow",content:[{title:"Understanding DAK Actions",content:'\n                <p>Choose the right action for your workflow:</p>\n                <ul>\n                  <li><strong>Edit Existing DAK:</strong> Modify an existing repository you have write access to</li>\n                  <li><strong>Fork and Edit:</strong> Create your own copy of a repository to work on</li>\n                  <li><strong>Create New DAK:</strong> Start a brand new DAK repository from scratch</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> If you\'re not sure, start with "Edit Existing DAK" if you have permissions, or "Fork and Edit" to experiment safely.\n                </div>\n              '}]}],"documentation-viewer":[{id:"navigation-help",title:"Navigating Documentation",type:"slideshow",content:[{title:"Using the Documentation Viewer",content:'\n                <p>The documentation viewer provides easy access to all project information:</p>\n                <ul>\n                  <li>Use the sidebar menu to navigate between sections</li>\n                  <li>Use the dropdown to quickly jump to any document</li>\n                  <li>Click "Back" to return to the previous page</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udcd6 Available Documentation:</strong> Requirements, Architecture, DAK Components, and more.\n                </div>\n              '}]}],"dak-dashboard":[{id:"dak-components-overview",title:"Understanding DAK Components",type:"slideshow",content:[{title:"WHO SMART Guidelines DAK Components",content:"\n                <p>Digital Adaptation Kits (DAKs) contain 8 core components organized in two levels:</p>\n                <h4>Level 2: Business Logic & Processes</h4>\n                <ul>\n                  <li><strong>Business Processes:</strong> BPMN workflows</li>\n                  <li><strong>Decision Support Logic:</strong> DMN decision tables</li>\n                  <li><strong>Indicators & Measures:</strong> Performance metrics</li>\n                  <li><strong>Data Entry Forms:</strong> Structured questionnaires</li>\n                </ul>\n                <h4>Level 3: Technical Implementation</h4>\n                <ul>\n                  <li><strong>Terminology:</strong> Code systems and value sets</li>\n                  <li><strong>FHIR Profiles:</strong> Resource structure definitions</li>\n                  <li><strong>FHIR Extensions:</strong> Custom data elements</li>\n                  <li><strong>Test Data & Examples:</strong> Sample data for validation</li>\n                </ul>\n              "}]}],"dak-selection":[{id:"choosing-dak-repository",title:"Selecting the Right DAK Repository",type:"slideshow",content:[{title:"Understanding DAK Repository Types",content:'\n                <p>Choose the right repository based on your workflow:</p>\n                <ul>\n                  <li><strong>Published DAKs:</strong> Official WHO repositories with complete implementations</li>\n                  <li><strong>Community DAKs:</strong> Community-maintained repositories with adaptations</li>\n                  <li><strong>Template DAKs:</strong> Starting templates for creating new DAKs</li>\n                  <li><strong>Private DAKs:</strong> Your private repositories or organization-specific DAKs</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> Look for the "SMART Guidelines" badge to ensure compatibility.\n                </div>\n              '}]}],"organization-selection":[{id:"selecting-organization",title:"Choosing an Organization",type:"slideshow",content:[{title:"Organization vs Personal Account",content:'\n                <p>Decide where to create or fork your DAK:</p>\n                <ul>\n                  <li><strong>Personal Account:</strong> For individual development and experimentation</li>\n                  <li><strong>Organization Account:</strong> For team collaboration and official implementations</li>\n                  <li><strong>WHO Official:</strong> Only for authorized WHO contributors</li>\n                </ul>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Important:</strong> Make sure you have the necessary permissions for the selected organization.\n                </div>\n              '}]}],"bpmn-editor":[{id:"using-bpmn-editor",title:"Using the BPMN Editor",type:"slideshow",content:[{title:"BPMN Business Process Modeling",content:'\n                <p>The BPMN editor helps you create and modify business process workflows:</p>\n                <ul>\n                  <li><strong>Drag and Drop:</strong> Use the palette to add process elements</li>\n                  <li><strong>Connect Elements:</strong> Click and drag to create sequence flows</li>\n                  <li><strong>Properties Panel:</strong> Configure element properties and conditions</li>\n                  <li><strong>Validation:</strong> The editor highlights errors and warnings</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> BPMN processes define the clinical workflow and decision logic for your DAK.\n                </div>\n              '}]}],"questionnaire-editor":[{id:"using-questionnaire-editor",title:"Using the FHIR Questionnaire Editor",badge:"/sgex/cat-paw-icon.svg",type:"slideshow",content:[{title:"FHIR Questionnaire Overview",content:'\n                <p>The FHIR Questionnaire editor helps you create and modify structured data collection forms:</p>\n                <ul>\n                  <li><strong>Visual Editor:</strong> Uses LHC-Forms for intuitive questionnaire design</li>\n                  <li><strong>FHIR Compliant:</strong> Generates standard FHIR R4 Questionnaire resources</li>\n                  <li><strong>Multilingual:</strong> Support for multiple languages and translations</li>\n                  <li><strong>Preview Mode:</strong> Test questionnaires as they would appear to users</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udccb File Location:</strong> Questionnaires are stored in <code>input/questionnaires/*.json</code>\n                </div>\n              '},{title:"Creating New Questionnaires",content:'\n                <p>To create a new FHIR Questionnaire:</p>\n                <ol>\n                  <li>Click "Create New Questionnaire" on the main screen</li>\n                  <li>A template questionnaire will be loaded in the editor</li>\n                  <li>Modify the questionnaire structure using the visual interface</li>\n                  <li>Add questions, sections, and response options</li>\n                  <li>Set validation rules and conditional logic</li>\n                </ol>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Remember:</strong> Save your work regularly using "Save to Staging" or "Commit to GitHub"\n                </div>\n              '},{title:"Editing Existing Questionnaires",content:'\n                <p>To modify existing questionnaires:</p>\n                <ol>\n                  <li>Select a questionnaire from the list</li>\n                  <li>The questionnaire will load in the LHC-Forms editor</li>\n                  <li>Make your changes using the visual interface</li>\n                  <li>Preview the form to test user experience</li>\n                  <li>Save changes when satisfied</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> Use the staging framework to test changes before committing to GitHub\n                </div>\n              '},{title:"Internationalization Support",content:'\n                <p>The questionnaire editor supports multiple languages:</p>\n                <ul>\n                  <li><strong>Language Selection:</strong> Use the language dropdown to switch between languages</li>\n                  <li><strong>Translations:</strong> Add translations for all text fields</li>\n                  <li><strong>FHIR Extensions:</strong> Uses standard FHIR translation extensions</li>\n                  <li><strong>Preview:</strong> Test questionnaires in different languages</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83c\udf0d Best Practice:</strong> Always provide translations for your target implementation languages\n                </div>\n              '}]},{id:"questionnaire-management",title:"Managing Questionnaire Assets",badge:"/sgex/cat-paw-file-icon.svg",type:"slideshow",content:[{title:"File Organization",content:'\n                <p>FHIR Questionnaires are organized as follows:</p>\n                <ul>\n                  <li><strong>Location:</strong> <code>input/questionnaires/</code> directory</li>\n                  <li><strong>Format:</strong> JSON files following FHIR R4 Questionnaire schema</li>\n                  <li><strong>Naming:</strong> Use descriptive names like <code>patient-registration.json</code></li>\n                  <li><strong>Validation:</strong> All files are validated against FHIR schema</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udcc1 Convention:</strong> Use kebab-case filenames for consistency\n                </div>\n              '},{title:"Version Control Integration",content:'\n                <p>The questionnaire editor integrates with GitHub for version control:</p>\n                <ul>\n                  <li><strong>Staging:</strong> Save changes locally before committing</li>\n                  <li><strong>Commits:</strong> Create meaningful commit messages</li>\n                  <li><strong>Branches:</strong> Work on different branches for features</li>\n                  <li><strong>History:</strong> Track changes and revert if needed</li>\n                </ul>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Important:</strong> Always test questionnaires before committing to main branch\n                </div>\n              '}]}],"component-editor":[{id:"component-editor-overview",title:"Understanding the Component Editor",type:"slideshow",content:[{title:"DAK Component Types",content:"\n                <p>The component editor provides specialized interfaces for different DAK components:</p>\n                <h4>Business Logic Components</h4>\n                <ul>\n                  <li><strong>Business Processes:</strong> BPMN workflow editor</li>\n                  <li><strong>Decision Logic:</strong> DMN decision table editor</li>\n                  <li><strong>Forms:</strong> Structured questionnaire builder</li>\n                </ul>\n                <h4>Technical Components</h4>\n                <ul>\n                  <li><strong>FHIR Resources:</strong> Profile and extension definitions</li>\n                  <li><strong>Terminology:</strong> Code systems and value sets</li>\n                  <li><strong>Test Data:</strong> Example data and test cases</li>\n                </ul>\n              "}]}],"pat-login":[{id:"pat-authentication-help",title:"Using Personal Access Tokens",badge:"/sgex/cat-paw-lock-icon.svg",type:"slideshow",content:[{title:"Why Personal Access Tokens?",content:'\n                <p>SGEX uses GitHub Personal Access Tokens (PATs) for secure authentication:</p>\n                <ul>\n                  <li><strong>No Backend Required:</strong> Works entirely in your browser</li>\n                  <li><strong>Fine-grained Control:</strong> Choose which repositories to access</li>\n                  <li><strong>Enhanced Security:</strong> Can be easily rotated and revoked</li>\n                  <li><strong>Privacy Focused:</strong> Your token never leaves your browser</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udd12 Security:</strong> SGEX stores your token locally and never transmits it to any server.\n                </div>\n              '}]}],"pat-setup-instructions":[{id:"detailed-pat-setup",title:"Detailed PAT Setup Guide",badge:"/sgex/cat-paw-lock-icon.svg",type:"slideshow",content:[{title:"Token Type Comparison",content:"\n                <p>GitHub offers two types of Personal Access Tokens:</p>\n                <h4>Fine-grained Tokens (Recommended)</h4>\n                <ul>\n                  <li>Repository-specific access control</li>\n                  <li>Better security with minimal permissions</li>\n                  <li>More granular permission settings</li>\n                  <li>Shorter default expiration times</li>\n                </ul>\n                <h4>Classic Tokens</h4>\n                <ul>\n                  <li>Broader scope-based permissions</li>\n                  <li>Simpler permission model</li>\n                  <li>Longer expiration options</li>\n                  <li>Works with all GitHub integrations</li>\n                </ul>\n              "}]}],welcome:[{id:"github-pat-setup",title:"How to Create a GitHub Personal Access Token",badge:"/sgex/cat-paw-lock-icon.svg",type:"slideshow",content:[{title:"Step 1: Go to GitHub Settings",content:'\n                <p>Navigate to your GitHub account settings:</p>\n                <ol>\n                  <li>Click your profile picture in the top right</li>\n                  <li>Select "Settings" from the dropdown</li>\n                  <li>Go to "Developer settings" \u2192 "Personal access tokens"</li>\n                  <li>Choose "Fine-grained tokens" (recommended) or "Tokens (classic)"</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> Fine-grained tokens provide better security with repository-specific access.\n                </div>\n              '},{title:"Step 2: Generate New Token",content:'\n                <p>Create your new token:</p>\n                <ol>\n                  <li>Click "Generate new token"</li>\n                  <li>Give it a descriptive name like "SGEX Workbench"</li>\n                  <li>Set expiration (90 days recommended)</li>\n                  <li>Select repository access (specific repos or all)</li>\n                </ol>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Important:</strong> You\'ll only see the token once, so copy it immediately!\n                </div>\n              '},{title:"Step 3: Set Required Permissions",content:"\n                <p>For <strong>fine-grained tokens</strong>, enable:</p>\n                <ul>\n                  <li><strong>Contents:</strong> Read and Write</li>\n                  <li><strong>Metadata:</strong> Read</li>\n                  <li><strong>Pull requests:</strong> Read and Write</li>\n                </ul>\n                <p>For <strong>classic tokens</strong>, select:</p>\n                <ul>\n                  <li><strong>repo</strong> - Full control of private repositories</li>\n                  <li><strong>read:org</strong> - Read org and team membership</li>\n                </ul>\n              "},{title:"Step 4: Use Your Token",content:'\n                <p>Now you can authenticate with SGEX:</p>\n                <ol>\n                  <li>Copy your newly generated token</li>\n                  <li>Paste it into the login form</li>\n                  <li>Click "Sign in with Personal Access Token"</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udd12 Security:</strong> Your token is stored securely in your browser and never shared with servers.\n                </div>\n              '}]}],"dak-configuration":[{id:"dak-configuration-guide",title:"Configuring Your DAK",type:"slideshow",content:[{title:"Understanding DAK Configuration",content:"\n                <p>When creating a new DAK, you need to configure both repository and FHIR settings:</p>\n                <h4>Repository Configuration</h4>\n                <ul>\n                  <li><strong>Repository Name:</strong> GitHub repository identifier (lowercase with hyphens)</li>\n                  <li><strong>Description:</strong> Brief description of your DAK's purpose</li>\n                  <li><strong>Topics:</strong> Tags that help others discover your DAK</li>\n                  <li><strong>Visibility:</strong> Public repositories are discoverable by the community</li>\n                </ul>\n                <h4>FHIR Implementation Guide Settings</h4>\n                <ul>\n                  <li><strong>IG ID:</strong> Unique identifier for your Implementation Guide</li>\n                  <li><strong>Name:</strong> Technical name used in code generation</li>\n                  <li><strong>Title:</strong> Human-readable title for documentation</li>\n                  <li><strong>Publisher:</strong> Organization responsible for the DAK</li>\n                </ul>\n              "}]}],"core-data-dictionary-viewer":[{id:"core-data-dictionary-help",title:"Understanding Core Data Dictionary",badge:"/sgex/cat-paw-info-icon.svg",type:"slideshow",content:[{title:"What is the Core Data Dictionary?",content:'\n                <p>The Core Data Dictionary (Component 2) contains the data elements required throughout the different points of the workflow. These data elements are mapped to the International Classification of Diseases version 11 (ICD-11) codes and other established concept mapping standards to ensure the data dictionary is compatible with other digital systems.</p>\n                <h4>Purpose: System Design and Interoperability</h4>\n                <p>To know which data elements need to be logged and how they map to other standard terminologies (e.g. ICD, Systematized Nomenclature of Medicine [SNOMED]) for interoperability with other standards-based systems.</p>\n                <h4>FHIR FSH Source Files</h4>\n                <ul>\n                  <li><strong>CodeSystems:</strong> Define custom codes and concepts used in your DAK</li>\n                  <li><strong>ValueSets:</strong> Specify allowed values for clinical data elements</li>\n                  <li><strong>ConceptMaps:</strong> Map between different terminology systems including ICD-11 and SNOMED</li>\n                  <li><strong>Logical Models:</strong> Define data structures for clinical workflows</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Location:</strong> FSH files are stored in the <code>input/fsh/</code> directory of your repository.\n                </div>\n              '},{title:"GitHub Pages Integration",content:'\n                <p>When GitHub Pages is configured, your FSH files are automatically compiled into HTML documentation:</p>\n                <h4>Published Artifacts</h4>\n                <ul>\n                  <li><strong>Code Systems:</strong> Browse and search your custom terminologies</li>\n                  <li><strong>Value Sets:</strong> View allowed values with descriptions</li>\n                  <li><strong>Logical Models:</strong> Interactive data structure documentation</li>\n                  <li><strong>Concept Maps:</strong> Visual mapping between terminologies</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\u26a1 URL Pattern:</strong> Main branch publishes to <code>user.github.io/repo</code>, feature branches to <code>user.github.io/repo/branches/branch-name</code>\n                </div>\n              '}]},{id:"github-pages-setup",title:"Setting Up GitHub Pages",badge:"/sgex/cat-paw-settings-icon.svg",type:"slideshow",content:[{title:"Enable GitHub Pages for Your DAK",content:'\n                <p>Follow these steps to enable automatic publishing of your Implementation Guide:</p>\n                <h4>Step 1: Repository Settings</h4>\n                <ol>\n                  <li>Go to your repository on GitHub</li>\n                  <li>Click on the <strong>Settings</strong> tab</li>\n                  <li>Scroll down to <strong>Pages</strong> in the left sidebar</li>\n                  <li>Under <strong>Source</strong>, select <strong>GitHub Actions</strong></li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udccb Note:</strong> Your repository must contain a valid FHIR Implementation Guide structure with <code>sushi-config.yaml</code>\n                </div>\n              '},{title:"Configure IG Publisher Workflow",content:'\n                <p>Set up the automated publishing workflow:</p>\n                <h4>Step 2: GitHub Actions</h4>\n                <ol>\n                  <li>Create <code>.github/workflows/</code> directory in your repository</li>\n                  <li>Add an IG Publisher workflow file (e.g., <code>publish.yml</code>)</li>\n                  <li>Configure the workflow to run on push to main branch</li>\n                  <li>Include steps to build and deploy the Implementation Guide</li>\n                </ol>\n                <h4>Step 3: Verify Publishing</h4>\n                <ul>\n                  <li>Check the <strong>Actions</strong> tab for workflow status</li>\n                  <li>Once successful, visit your GitHub Pages URL</li>\n                  <li>Verify that artifacts are accessible from the Core Data Dictionary viewer</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udd17 Reference:</strong> See the <a href="https://smart.who.int/ig-starter-kit/v1.0.0/ig_setup.html#ghpages-build" target="_blank">WHO IG Starter Kit</a> for detailed setup instructions.\n                </div>\n              '}]}],"business-process-selection":[{id:"business-process-help",title:"Understanding Business Processes",badge:"/sgex/cat-paw-workflow-icon.svg",type:"slideshow",content:[{title:"What are Business Processes?",content:'\n                <p>Business Processes (Component 5) define the clinical workflows and care processes in your DAK:</p>\n                <h4>BPMN 2.0 Diagrams</h4>\n                <ul>\n                  <li><strong>Clinical Workflows:</strong> Step-by-step patient care processes</li>\n                  <li><strong>Decision Points:</strong> Where clinical decisions are made</li>\n                  <li><strong>Task Assignments:</strong> Who performs each step in the workflow</li>\n                  <li><strong>Data Flows:</strong> How information moves through the process</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Standard:</strong> Uses BPMN 2.0 (Business Process Model and Notation) for workflow modeling\n                </div>\n              '},{title:"Working with BPMN Files",content:'\n                <p>Business process diagrams are stored as BPMN XML files in your repository:</p>\n                <h4>File Management</h4>\n                <ul>\n                  <li><strong>Location:</strong> Typically stored in <code>input/models/</code> or <code>input/bpmn/</code></li>\n                  <li><strong>Format:</strong> BPMN 2.0 XML standard format</li>\n                  <li><strong>Editing:</strong> Use the built-in BPMN editor or external tools</li>\n                  <li><strong>Validation:</strong> Automatic validation against BPMN 2.0 schema</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udd27 Tools:</strong> SGeX includes an integrated BPMN editor for creating and modifying workflow diagrams\n                </div>\n              '}]}],"pages-manager":[{id:"page-content-help",title:"Managing Page Content",badge:"/sgex/cat-paw-document-icon.svg",type:"slideshow",content:[{title:"What is Page Content?",content:'\n                <p>Page Content represents the narrative documentation and educational materials in your DAK:</p>\n                <h4>Content Types</h4>\n                <ul>\n                  <li><strong>Clinical Guidelines:</strong> Evidence-based care recommendations</li>\n                  <li><strong>User Guides:</strong> Instructions for healthcare workers</li>\n                  <li><strong>Training Materials:</strong> Educational content and scenarios</li>\n                  <li><strong>Reference Documentation:</strong> Technical specifications and background</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Format:</strong> Content is typically authored in Markdown format for easy editing and version control\n                </div>\n              '},{title:"Content Organization",content:'\n                <p>Page content is organized to support different user needs and workflows:</p>\n                <h4>Structure</h4>\n                <ul>\n                  <li><strong>Pages Directory:</strong> Main content files organized by topic</li>\n                  <li><strong>Assets:</strong> Images, diagrams, and multimedia content</li>\n                  <li><strong>Templates:</strong> Reusable content patterns and layouts</li>\n                  <li><strong>Navigation:</strong> Menus and linking between related content</li>\n                </ul>\n                <h4>Publishing</h4>\n                <ul>\n                  <li><strong>GitHub Pages:</strong> Automatic publishing of content as web pages</li>\n                  <li><strong>FHIR IG:</strong> Integration with Implementation Guide publishing</li>\n                  <li><strong>Version Control:</strong> Track changes and collaborate on content</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udcdd Best Practice:</strong> Use clear headings, bullet points, and visual elements to make content accessible to healthcare workers\n                </div>\n              '}]}]}}getHelpTopicsForPage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[...this.helpTopics[e]||[],...this.getUniversalTopics(t)]}getUniversalTopics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[this.universalTopics.documentation,this.universalTopics.bugReport];return(e.selectedDak||e.repository)&&t.push(this.universalTopics.dakFeedback),t}getHelpTopic(e){for(const t of Object.values(this.helpTopics)){const s=t.find(t=>t.id===e);if(s)return s}return null}hasHelpTopics(e){return!0}addHelpTopicToPage(e,t){this.helpTopics[e]||(this.helpTopics[e]=[]),this.helpTopics[e].push(t)}getAvailablePages(){return Object.keys(this.helpTopics)}openDakIssue(e,t){if(!t)return void console.warn("No DAK repository specified for feedback");let s="https://github.com/".concat(t.owner,"/").concat(t.name,"/issues/new");switch(e){case"bug":s+="?template=bug_report.md&labels=bug,dak-issue";break;case"improvement":s+="?template=feature_request.md&labels=enhancement,dak-improvement";break;case"content":s+="?labels=content-issue,clinical-content";break;case"question":s+="?template=question.md&labels=question,dak-question";break;default:s+="?labels=dak-feedback"}window.open(s,"_blank")}}},62141:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(89379);const o=new class{constructor(){this.storageKey="sgex_feature_files",this.metadataKey="sgex_feature_files_metadata"}getAllLocalChanges(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):{}}catch(e){return console.error("Error reading local changes:",e),{}}}getLocalContent(e){return this.getAllLocalChanges()[e]||null}saveLocal(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const o=this.getAllLocalChanges();o[e]=t,localStorage.setItem(this.storageKey,JSON.stringify(o));const a=this.getAllMetadata();return a[e]=(0,n.A)((0,n.A)({},s),{},{lastModified:(new Date).toISOString(),originalPath:e}),localStorage.setItem(this.metadataKey,JSON.stringify(a)),!0}catch(o){return console.error("Error saving to localStorage:",o),!1}}removeLocal(e){try{const t=this.getAllLocalChanges();delete t[e],localStorage.setItem(this.storageKey,JSON.stringify(t));const s=this.getAllMetadata();return delete s[e],localStorage.setItem(this.metadataKey,JSON.stringify(s)),!0}catch(t){return console.error("Error removing from localStorage:",t),!1}}getAllMetadata(){try{const e=localStorage.getItem(this.metadataKey);return e?JSON.parse(e):{}}catch(e){return console.error("Error reading metadata:",e),{}}}getMetadata(e){return this.getAllMetadata()[e]||null}hasLocalChanges(){const e=this.getAllLocalChanges();return Object.keys(e).length>0}getLocalChangesCount(){const e=this.getAllLocalChanges();return Object.keys(e).length}exportLocalChanges(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"json";const t=this.getAllLocalChanges(),s=this.getAllMetadata();if("json"===e){const e={exported:(new Date).toISOString(),version:"1.0",changes:t,metadata:s};return new Blob([JSON.stringify(e,null,2)],{type:"application/json"})}throw new Error("Export format '".concat(e,"' not supported"))}importLocalChanges(e){try{const t=JSON.parse(e);if(!t.changes||!t.metadata)throw new Error("Invalid import data format");const s=this.getAllLocalChanges(),o=this.getAllMetadata(),a=(0,n.A)((0,n.A)({},s),t.changes),r=(0,n.A)((0,n.A)({},o),t.metadata);return localStorage.setItem(this.storageKey,JSON.stringify(a)),localStorage.setItem(this.metadataKey,JSON.stringify(r)),!0}catch(t){return console.error("Error importing local changes:",t),!1}}clearAllLocalChanges(){localStorage.removeItem(this.storageKey),localStorage.removeItem(this.metadataKey)}getStorageInfo(){const e=this.getAllLocalChanges(),t=this.getAllMetadata(),s=JSON.stringify(e).length,n=JSON.stringify(t).length,o=s+n;return{fileCount:Object.keys(e).length,totalSize:o,changesSize:s,metadataSize:n,formattedSize:this.formatBytes(o)}}formatBytes(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}}},88259:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(9950);const o=e=>{const[t,s]=(0,n.useState)(e);return(0,n.useEffect)(()=>{const t=()=>{const t=document.body.classList.contains("theme-dark"),n="/sgex/copilot-fix-792-2",o=e.startsWith("/")?e.slice(1):e;let a;if(t){const e=o.replace(/\.png$/,"_grey_tabby.png");a=n?"".concat(n,"/").concat(e):"/".concat(e)}else a=n?"".concat(n,"/").concat(o):"/".concat(o);s(a)};t();const n=new MutationObserver(e=>{e.forEach(e=>{"attributes"===e.type&&"class"===e.attributeName&&t()})});return n.observe(document.body,{attributes:!0,attributeFilter:["class"]}),()=>{n.disconnect()}},[e]),t}},88498:(e,t,s)=>{s.d(t,{A:()=>a});var n=s(29946),o=s(38659);const a=new class{async validateDAKRepository(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";try{const n=await this.checkRepositoryExists(e,t),a=await this.fetchSushiConfig(e,t,s);if(!a)return n?(console.log("Repository ".concat(e,"/").concat(t," exists on GitHub - allowing access even without sushi-config.yaml")),!0):(console.log("No sushi-config.yaml found in ".concat(e,"/").concat(t," and repository doesn't exist")),!1);const r=(await(0,o.cb)()).load(a);if(!r||"object"!==typeof r)return n?(console.log("Invalid YAML format in sushi-config.yaml for ".concat(e,"/").concat(t," but repository exists - allowing access")),!0):(console.log("Invalid YAML format in sushi-config.yaml for ".concat(e,"/").concat(t)),!1);if(!r.dependencies||"object"!==typeof r.dependencies)return n?(console.log("No dependencies section found in sushi-config.yaml for ".concat(e,"/").concat(t," but repository exists - allowing access")),!0):(console.log("No dependencies section found in sushi-config.yaml for ".concat(e,"/").concat(t)),!1);return"smart.who.int.base"in r.dependencies?(console.log("Valid DAK repository found: ".concat(e,"/").concat(t," (has smart.who.int.base dependency)")),!0):n?(console.log("Repository ".concat(e,"/").concat(t," has sushi-config.yaml but missing smart.who.int.base dependency - allowing access since repository exists")),!0):(console.log("Repository ".concat(e,"/").concat(t," has sushi-config.yaml but missing smart.who.int.base dependency")),!1)}catch(n){return console.log("Error validating DAK repository ".concat(e,"/").concat(t,":"),n.message),!1}}async checkRepositoryExists(e,t){try{const s=n.A.isAuth()?n.A.octokit:null;return s?(await s.rest.repos.get({owner:e,repo:t}),console.log("Repository ".concat(e,"/").concat(t," exists on GitHub")),!0):(console.log("Cannot check repository existence for ".concat(e,"/").concat(t," - not authenticated")),!1)}catch(s){return 404===s.status?(console.log("Repository ".concat(e,"/").concat(t," does not exist on GitHub")),!1):(console.log("Error checking repository existence for ".concat(e,"/").concat(t,":"),s.message,"- assuming it might exist"),!0)}}async fetchSushiConfig(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";try{const a=n.A.isAuth()?n.A.octokit:null;if(!a)return console.log("Cannot fetch sushi-config.yaml for ".concat(e,"/").concat(t," - not authenticated")),null;const r="main"===s?["main","master"]:[s];for(const s of r)try{const{data:n}=await a.rest.repos.getContent({owner:e,repo:t,path:"sushi-config.yaml",ref:s});if("file"===n.type&&n.content){const o=decodeURIComponent(escape(atob(n.content)));return console.log("Found sushi-config.yaml in ".concat(e,"/").concat(t," on branch ").concat(s)),o}}catch(o){console.log("sushi-config.yaml not found on branch ".concat(s," for ").concat(e,"/").concat(t,":"),404===o.status?"File not found":o.message);continue}return null}catch(a){return console.log("Error fetching sushi-config.yaml for ".concat(e,"/").concat(t,":"),a.message),null}}validateDemoDAKRepository(e,t){if(!e||!t||e.includes("/")||t.includes("/"))return console.log("Demo mode: Invalid repository format ".concat(e,"/").concat(t)),!1;const s=/^[a-zA-Z0-9._-]+$/;if(!s.test(e)||!s.test(t))return console.log("Demo mode: Invalid characters in repository name ".concat(e,"/").concat(t)),!1;const n="".concat(e,"/").concat(t);return console.log("Demo mode: ".concat(n," accepted as valid DAK repository (proper org/repo format)")),!0}}},95388:(e,t,s)=>{s.d(t,{ld:()=>n,lm:()=>o,yl:()=>a});const n={MASCOT_HELPER:"altText.mascot.helper",MASCOT_ICON:"altText.mascot.icon",MASCOT_EXAMINING:"altText.mascot.examining",MASCOT_CELEBRATING:"altText.mascot.celebrating",MASCOT_CODING:"altText.mascot.coding",MASCOT_COMMUNITY:"altText.mascot.community",AVATAR_USER:"altText.avatar.user",AVATAR_ORGANIZATION:"altText.avatar.organization",AVATAR_PERSONAL:"altText.avatar.personal",AVATAR_PROFILE:"altText.avatar.profile",ICON_SGEX:"altText.icon.sgex",ICON_BUG_REPORT:"altText.icon.bugReport",ICON_SECURITY:"altText.icon.security",ICON_ACTION:"altText.icon.action",ICON_DAK_COMPONENT:"altText.icon.dakComponent",IMAGE_AUTHORING:"altText.image.authoring",IMAGE_COLLABORATION:"altText.image.collaboration",IMAGE_WORKFLOW:"altText.image.workflow",LOGO_SGEX:"altText.logo.sgex",LOGO_WHO:"altText.logo.who"};function o(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{const o=e(t,n);return o===t?s:o}catch(o){return console.warn("Alt text translation failed for key: ".concat(t),o),s}}function a(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"user";if(!t)return o(e,n.AVATAR_PROFILE,"Profile avatar");const a=t.name||t.display_name||t.login;return o(e,"organization"===s?n.AVATAR_ORGANIZATION:n.AVATAR_USER,"".concat(a," avatar"),{name:a})}}}]);