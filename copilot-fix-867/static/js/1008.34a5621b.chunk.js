"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[1008],{81008:(e,s,r)=>{r.r(s),r.d(s,{default:()=>l});var a=r(9950),i=r(85001),c=r(29946),n=r(29473),t=r(51635),o=r(44414);const l=()=>{var e;const s=(0,i.zy)(),r=(0,i.Zp)(),{user:l}=(0,i.g)(),[d,p]=(0,a.useState)([]),[h,g]=(0,a.useState)(!0),[m,u]=(0,a.useState)(null),[x,j]=(0,a.useState)(null===(e=s.state)||void 0===e?void 0:e.profile);(0,a.useEffect)(()=>{(async()=>{if(l&&!x)try{if(c.A.isAuth()){const e=await c.A.getUser(l);j(e)}else j({login:l,name:l.charAt(0).toUpperCase()+l.slice(1),avatar_url:"https://github.com/".concat(l,".png"),type:"User"})}catch(m){console.error("Error fetching user profile:",m),r("/",{state:{warningMessage:"User '".concat(l,"' not found or not accessible.")}})}})()},[l,x,r]);const N=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g(!0),u(null);try{const r=x.type;if(!e){let e=null;try{e=n.A.getCachedRepositories(x.login,r)}catch(s){console.warn("Error accessing repository cache:",s)}if(e)return console.log("Using cached repositories for ".concat(x.login," (").concat(r,")")),p(e.repositories),void g(!1)}console.log("Fetching fresh repositories for ".concat(x.login," (").concat(r,")"));const a=await c.A.getRepositories(x.login,r);try{n.A.setCachedRepositories(x.login,r,a)}catch(s){console.warn("Error caching repositories:",s)}p(a)}catch(m){console.error("Error fetching repositories:",m),u("Failed to fetch repositories. Please check your connection and try again.")}finally{g(!1)}},[x]);(0,a.useEffect)(()=>{x||l?x&&N():r("/")},[x,l,r,N]);return(0,o.jsx)(t.Mx,{pageName:"repository-selection",children:x?(0,o.jsxs)("div",{className:"repo-content",children:[(0,o.jsxs)("div",{className:"breadcrumb",children:[(0,o.jsx)("button",{onClick:()=>r("/"),className:"breadcrumb-link",children:"Select Profile"}),(0,o.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,o.jsx)("span",{className:"breadcrumb-current",children:"Select Repository"})]}),(0,o.jsx)("div",{className:"repo-main",children:(0,o.jsxs)("div",{className:"repo-selection",children:[(0,o.jsx)("h2",{children:"Select DAK Repository"}),(0,o.jsx)("p",{children:"Choose a repository containing WHO SMART Guidelines Digital Adaptation Kit content:"}),h?(0,o.jsxs)("div",{className:"loading",children:[(0,o.jsx)("div",{className:"spinner"}),(0,o.jsx)("p",{children:"Loading repositories..."})]}):m?(0,o.jsxs)("div",{className:"error-state",children:[(0,o.jsx)("h3",{children:"Error loading repositories"}),(0,o.jsx)("p",{children:m}),(0,o.jsx)("button",{onClick:()=>N(!0),className:"retry-btn",children:"Try Again"})]}):0===d.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("h3",{children:"No DAK repositories found"}),(0,o.jsx)("p",{children:"No repositories found with DAK-related topics or keywords. Create a new repository or add topics like 'who', 'smart-guidelines', 'dak', or 'health' to existing repositories."})]}):(0,o.jsx)("div",{className:"repo-grid",children:d.map(e=>{return(0,o.jsxs)("div",{className:"repo-card",onClick:()=>(e=>{r("/dashboard/".concat(e.owner.login,"/").concat(e.name),{state:{profile:x,repository:e}})})(e),children:[(0,o.jsxs)("div",{className:"repo-header-info",children:[(0,o.jsx)("h3",{children:e.name}),(0,o.jsxs)("div",{className:"repo-meta",children:[e.private&&(0,o.jsx)("span",{className:"private-badge",children:"Private"}),e.language&&(0,o.jsx)("span",{className:"language-badge",children:e.language})]})]}),(0,o.jsx)("p",{className:"repo-description",children:e.description||"No description available"}),(0,o.jsxs)("div",{className:"repo-topics",children:[(e.topics||[]).slice(0,3).map(e=>(0,o.jsx)("span",{className:"topic-tag",children:e},e)),(e.topics||[]).length>3&&(0,o.jsxs)("span",{className:"topic-more",children:["+",(e.topics||[]).length-3," more"]})]}),(0,o.jsxs)("div",{className:"repo-stats",children:[(0,o.jsxs)("div",{className:"stat",children:[(0,o.jsx)("span",{className:"stat-icon",children:"\u2b50"}),(0,o.jsx)("span",{children:e.stargazers_count||0})]}),(0,o.jsxs)("div",{className:"stat",children:[(0,o.jsx)("span",{className:"stat-icon",children:"\ud83c\udf74"}),(0,o.jsx)("span",{children:e.forks_count||0})]}),(0,o.jsxs)("div",{className:"stat",children:[(0,o.jsx)("span",{className:"stat-icon",children:"\ud83d\udcc5"}),(0,o.jsxs)("span",{children:["Updated ",(s=e.updated_at,new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]})]})]})]},e.id);var s})})]})})]}):(0,o.jsx)("div",{children:"Redirecting..."})})}}}]);