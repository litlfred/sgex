"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[956],{3956:(e,a,i)=>{i.r(a),i.d(a,{default:()=>l});var n=i(5043),t=i(9615),s=i(3071),r=i(6712),o=i(579);const l=()=>{var e;const a=(0,t.zy)(),i=(0,t.Zp)(),[l,c]=(0,n.useState)([]),[d,p]=(0,n.useState)(null),[h,g]=(0,n.useState)(!0),[u,m]=(0,n.useState)(null),[v,_]=(0,n.useState)(!0),{profile:b,sourceRepository:x,action:j}=a.state||{},y=()=>{switch(j){case"fork":return{title:"Select Destination for Fork",description:`Choose where to create a fork of "${null===x||void 0===x?void 0:x.name}".`,buttonText:"Fork Repository",nextRoute:"/dashboard"};case"create":return{title:"Select Destination for New DAK",description:`Choose where to create your new DAK based on "${null===x||void 0===x?void 0:x.name}".`,buttonText:"Continue to Configuration",nextRoute:"/dak-configuration"};default:return{title:"Select Organization",description:"Choose an organization for your DAK.",buttonText:"Continue",nextRoute:"/dashboard"}}},z=(0,n.useCallback)(async()=>{g(!0),m(null);try{let a=[];a=s.A.isAuth()?await s.A.getUserOrganizations():await N();try{const e=await s.A.getWHOOrganization(),i=a.findIndex(e=>"WorldHealthOrganization"===e.login);i>=0?a[i]={...a[i],...e}:a.unshift(e)}catch(e){console.warn("Could not fetch WHO organization data, using fallback:",e);const i={id:"who-organization",login:"WorldHealthOrganization",display_name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0};a.some(e=>"WorldHealthOrganization"===e.login)||a.unshift(i)}c(a)}catch(u){console.error("Error fetching organizations:",u),m("Failed to fetch organizations. Please check your connection and try again.");try{const e=await N();c(e)}catch(a){c([{id:"who-organization",login:"WorldHealthOrganization",display_name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0}])}}finally{g(!1)}},[]),N=async()=>{try{return[await s.A.getWHOOrganization(),{id:1,login:"my-health-org",display_name:"My Health Organization",description:"Healthcare technology organization focused on digital health solutions",avatar_url:"https://avatars.githubusercontent.com/u/1?s=200&v=4",html_url:"https://github.com/my-health-org",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Team",private_repos:10}},{id:2,login:"global-health-initiative",display_name:"Global Health Initiative",description:"International organization working on global health standards",avatar_url:"https://avatars.githubusercontent.com/u/2?s=200&v=4",html_url:"https://github.com/global-health-initiative",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!1},plan:{name:"Free",private_repos:0}}]}catch(u){return console.warn("Could not fetch WHO data for mock organizations, using fallback:",u),[{id:"who-organization",login:"WorldHealthOrganization",display_name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0},{id:1,login:"my-health-org",display_name:"My Health Organization",description:"Healthcare technology organization focused on digital health solutions",avatar_url:"https://avatars.githubusercontent.com/u/1?s=200&v=4",html_url:"https://github.com/my-health-org",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Team",private_repos:10}},{id:2,login:"global-health-initiative",display_name:"Global Health Initiative",description:"International organization working on global health standards",avatar_url:"https://avatars.githubusercontent.com/u/2?s=200&v=4",html_url:"https://github.com/global-health-initiative",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!1},plan:{name:"Free",private_repos:0}}]}};(0,n.useEffect)(()=>{b&&x&&j?z():i("/")},[b,x,j,i,z]);if(!b||!x||!j)return(0,o.jsx)(r.Mx,{pageName:"organization-selection",children:(0,o.jsx)("div",{children:"Redirecting..."})});const f=y(),O=[];return v&&O.push({...b,type:"User",display_name:b.name||b.login,description:"Your personal GitHub account",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},isPersonal:!0}),O.push(...l),(0,o.jsx)(r.Mx,{pageName:"organization-selection",children:(0,o.jsxs)("div",{className:"org-content",children:[(0,o.jsxs)("div",{className:"breadcrumb",children:[(0,o.jsx)("button",{onClick:()=>i("/"),className:"breadcrumb-link",children:"Select Profile"}),(0,o.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,o.jsx)("button",{onClick:()=>i("/dak-action",{state:{profile:b}}),className:"breadcrumb-link",children:"Choose DAK Action"}),(0,o.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,o.jsx)("button",{onClick:()=>{i(`/dak-selection/${b.login}`,{state:{profile:b,action:j}})},className:"breadcrumb-link",children:"Select DAK"}),(0,o.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,o.jsx)("span",{className:"breadcrumb-current",children:"Select Organization"})]}),(0,o.jsxs)("div",{className:"org-main",children:[(0,o.jsxs)("div",{className:"org-intro",children:[(0,o.jsx)("h2",{children:f.title}),(0,o.jsx)("p",{children:f.description}),x&&(0,o.jsxs)("div",{className:"source-repo-info",children:[(0,o.jsx)("span",{className:"repo-label",children:"Source Repository:"}),(0,o.jsxs)("div",{className:"repo-badge",children:[(0,o.jsx)("span",{className:"repo-name",children:x.name}),(0,o.jsxs)("span",{className:"repo-owner",children:["@",null===(e=x.full_name)||void 0===e?void 0:e.split("/")[0]]})]})]})]}),(0,o.jsxs)("div",{className:"options-section",children:[(0,o.jsx)("div",{className:"include-personal",children:(0,o.jsxs)("label",{className:"checkbox-label",children:[(0,o.jsx)("input",{type:"checkbox",checked:v,onChange:e=>_(e.target.checked)}),(0,o.jsx)("span",{children:"Include my personal account as an option"})]})}),h?(0,o.jsxs)("div",{className:"loading",children:[(0,o.jsx)("div",{className:"spinner"}),(0,o.jsx)("p",{children:"Loading organizations..."})]}):u?(0,o.jsxs)("div",{className:"error-state",children:[(0,o.jsx)("h3",{children:"Error loading organizations"}),(0,o.jsx)("p",{children:u}),(0,o.jsx)("button",{onClick:z,className:"retry-btn",children:"Try Again"})]}):0===O.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("h3",{children:"No organizations available"}),(0,o.jsx)("p",{children:"Enable personal account option or join organizations to see options here."})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"org-grid",children:O.map(e=>{var a,i,n,t;return(0,o.jsxs)("div",{className:`org-card ${(null===d||void 0===d?void 0:d.id)===e.id&&(null===d||void 0===d?void 0:d.type)===e.type?"selected":""} ${e.isPersonal?"personal":""} ${e.isWHO?"who-org":""}`,onClick:()=>(e=>{p(e)})(e),children:[(0,o.jsxs)("div",{className:"org-header-info",children:[(0,o.jsx)("img",{src:e.avatar_url||`https://github.com/${e.login}.png`,alt:`${e.display_name||e.login} avatar`,className:"org-avatar"}),(0,o.jsxs)("div",{className:"org-details",children:[(0,o.jsx)("h3",{children:e.display_name||e.login}),(0,o.jsxs)("p",{className:"org-login",children:["@",e.login]}),e.isPersonal&&(0,o.jsx)("span",{className:"personal-badge",children:"Personal"}),e.isWHO&&(0,o.jsx)("span",{className:"who-badge",children:"WHO Official"})]})]}),(0,o.jsx)("p",{className:"org-description",children:e.description||"No description available"}),(0,o.jsxs)("div",{className:"org-permissions",children:[(0,o.jsxs)("div",{className:"permission-item",children:[(0,o.jsx)("span",{className:"permission-icon "+(null!==(a=e.permissions)&&void 0!==a&&a.can_create_repositories?"allowed":"denied"),children:null!==(i=e.permissions)&&void 0!==i&&i.can_create_repositories?"\u2713":"\u2717"}),(0,o.jsx)("span",{children:"Create repositories"})]}),(0,o.jsxs)("div",{className:"permission-item",children:[(0,o.jsx)("span",{className:"permission-icon "+(null!==(n=e.permissions)&&void 0!==n&&n.can_create_private_repositories?"allowed":"denied"),children:null!==(t=e.permissions)&&void 0!==t&&t.can_create_private_repositories?"\u2713":"\u2717"}),(0,o.jsx)("span",{children:"Create private repositories"})]})]}),e.plan&&(0,o.jsxs)("div",{className:"org-plan",children:[(0,o.jsxs)("span",{className:"plan-name",children:[e.plan.name," Plan"]}),void 0!==e.plan.private_repos&&(0,o.jsxs)("span",{className:"plan-repos",children:[e.plan.private_repos," private repos"]})]}),(null===d||void 0===d?void 0:d.id)===e.id&&(null===d||void 0===d?void 0:d.type)===e.type&&(0,o.jsx)("div",{className:"selection-indicator",children:(0,o.jsx)("span",{children:"\u2713 Selected"})})]},`${e.type}-${e.id}`)})}),(0,o.jsx)("div",{className:"org-footer",children:(0,o.jsx)("button",{className:"continue-btn",onClick:()=>{if(!d)return void alert("Please select an organization to continue");const e=y();"fork"===j?i(e.nextRoute,{state:{profile:b,repository:{...x,full_name:`${d.login}/${x.name}`,html_url:`https://github.com/${d.login}/${x.name}`,owner:d},sourceRepository:x,destinationOrganization:d,action:j}}):"create"===j&&i(e.nextRoute,{state:{profile:b,templateRepository:x,destinationOrganization:d,action:j}})},disabled:!d,children:f.buttonText})})]})]})]})]})})}}}]);
//# sourceMappingURL=956.f753214c.chunk.js.map