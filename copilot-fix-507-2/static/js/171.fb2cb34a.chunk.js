"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[171],{2171:(e,s,i)=>{i.r(s),i.d(s,{default:()=>v});var a=i(5043),n=i(6712),t=i(3071),l=i(8691),r=i(1247),o=i(2392);const c=new class{constructor(){this.validators=new Map,this.initializeDefaultValidators()}initializeDefaultValidators(){this.addValidator("xml","xml-well-formed",{level:"error",description:"XML files must be well-formed",validator:this.validateXMLWellFormed.bind(this)}),this.addValidator("bpmn","xml-well-formed",{level:"error",description:"BPMN files must be well-formed XML",validator:this.validateXMLWellFormed.bind(this)}),this.addValidator("bpmn","bpmn-namespace",{level:"error",description:"BPMN files must use correct BPMN 2.0 namespace",validator:this.validateBPMNNamespace.bind(this)}),this.addValidator("bpmn","has-start-event",{level:"warning",description:"BPMN process should have at least one start event",validator:this.validateBPMNStartEvent.bind(this)}),this.addValidator("dmn","xml-well-formed",{level:"error",description:"DMN files must be well-formed XML",validator:this.validateXMLWellFormed.bind(this)}),this.addValidator("dmn","dmn-namespace",{level:"error",description:"DMN files must use correct DMN 1.3 namespace",validator:this.validateDMNNamespace.bind(this)}),this.addValidator("json","json-valid",{level:"error",description:"JSON files must be valid JSON",validator:this.validateJSONSyntax.bind(this)}),this.addValidator("json","fhir-resource-type",{level:"info",description:"FHIR resources should have valid resourceType",validator:this.validateFHIRResourceType.bind(this)}),this.addValidator("*","file-size-limit",{level:"warning",description:"Files should be under 1MB for optimal performance",validator:this.validateFileSize.bind(this)}),this.addValidator("*","filename-conventions",{level:"info",description:"Files should follow naming conventions",validator:this.validateFilenameConventions.bind(this)}),this.addValidator("yaml","sushi-config-valid",{level:"error",description:"sushi-config.yaml must be valid and contain required fields",validator:this.validateSushiConfig.bind(this)})}addValidator(e,s,i){this.validators.has(e)||this.validators.set(e,new Map),this.validators.get(e).set(s,i)}removeValidator(e,s){this.validators.has(e)&&this.validators.get(e).delete(s)}async validateFile(e,s){const i=[],a=this.getFileExtension(e),n=this.getFileName(e),t=this.validators.get(a)||new Map,l=this.validators.get("*")||new Map;for(const[o,c]of t)try{const a=await c.validator(e,s,n);a&&i.push({validatorId:o,level:c.level,description:c.description,...a})}catch(r){i.push({validatorId:o,level:"error",description:"Validator execution failed",message:r.message,filePath:e})}for(const[o,c]of l)try{const a=await c.validator(e,s,n);a&&i.push({validatorId:o,level:c.level,description:c.description,...a})}catch(r){i.push({validatorId:o,level:"error",description:"Validator execution failed",message:r.message,filePath:e})}return i}async validateStagingGround(e){const s={summary:{error:0,warning:0,info:0},files:{},validatedAt:Date.now()};for(const i of e.files){const e=await this.validateFile(i.path,i.content);s.files[i.path]=e,e.forEach(e=>{"error"===e.level?s.summary.error++:"warning"===e.level?s.summary.warning++:"info"===e.level&&s.summary.info++})}return s}async canSave(e){return 0===(await this.validateStagingGround(e)).summary.error}async validateXMLWellFormed(e,s){try{const i=new DOMParser,a=i.parseFromString(s,"text/xml").querySelector("parsererror");return a?{message:"XML is not well-formed: "+a.textContent,filePath:e}:null}catch(i){return{message:"Failed to parse XML: "+i.message,filePath:e}}}async validateBPMNNamespace(e,s){return s.includes('xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"')?null:{message:"BPMN file missing correct BPMN 2.0 namespace declaration",filePath:e,suggestion:'Add xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" to root element'}}async validateBPMNStartEvent(e,s){return s.includes("<startEvent")||s.includes("<bpmn:startEvent")?null:{message:"BPMN process should contain at least one start event",filePath:e,suggestion:"Add a start event to begin the process flow"}}async validateDMNNamespace(e,s){return s.includes('xmlns:dmn="https://www.omg.org/spec/DMN/20191111/MODEL/"')?null:{message:"DMN file missing correct DMN 1.3 namespace declaration",filePath:e,suggestion:'Add xmlns:dmn="https://www.omg.org/spec/DMN/20191111/MODEL/" to root element'}}async validateJSONSyntax(e,s){try{return JSON.parse(s),null}catch(i){return{message:"Invalid JSON syntax: "+i.message,filePath:e}}}async validateFHIRResourceType(e,s){try{const i=JSON.parse(s),a=["StructureDefinition","ValueSet","CodeSystem","ConceptMap","Questionnaire","PlanDefinition","ActivityDefinition","Measure","Library","ImplementationGuide","Bundle","Patient","Practitioner"];return i.resourceType&&!a.includes(i.resourceType)?{message:`Unknown FHIR resourceType: ${i.resourceType}`,filePath:e,suggestion:"Verify the resourceType is correct for FHIR R4"}:null}catch(i){return null}}async validateFileSize(e,s){const i=new Blob([s]).size;return i>1048576?{message:`File size (${(i/1024/1024).toFixed(1)}MB) exceeds recommended limit of 1MB`,filePath:e,suggestion:"Consider breaking large files into smaller components"}:null}async validateFilenameConventions(e,s){const i=this.getFileName(e),a=[];return i.includes(" ")&&a.push("avoid spaces in filenames"),/[<>:"|?*]/.test(i)&&a.push('avoid special characters (<>:"|?*)'),i.length>100&&a.push("filename is very long (>100 characters)"),a.length>0?{message:`Filename convention issues: ${a.join(", ")}`,filePath:e,suggestion:"Use lowercase letters, numbers, hyphens, and underscores"}:null}async validateSushiConfig(e,s){if(!e.endsWith("sushi-config.yaml"))return null;try{const i=s.split("\n"),a=i.some(e=>e.trim().startsWith("name:")),n=i.some(e=>e.trim().startsWith("id:")),t=i.some(e=>e.trim().startsWith("dependencies:")),l=[];return a||l.push('missing "name" field'),n||l.push('missing "id" field'),t||l.push('missing "dependencies" section'),l.length>0?{message:`sushi-config.yaml validation issues: ${l.join(", ")}`,filePath:e,suggestion:"Ensure required fields are present for FHIR IG"}:null}catch(i){return{message:"Failed to validate sushi-config.yaml: "+i.message,filePath:e}}}getFileExtension(e){const s=e.split(".");return s.length>1?s[s.length-1].toLowerCase():""}getFileName(e){return e.split("/").pop()||e}formatValidationResults(e){const s={canSave:0===e.summary.error,summary:e.summary,files:[]};return Object.entries(e.files).forEach(e=>{let[i,a]=e;a.length>0&&s.files.push({path:i,issues:a.map(e=>({level:e.level,message:e.message,description:e.description,suggestion:e.suggestion}))})}),s}getValidationSummary(e){return{error:e.summary.error,warning:e.summary.warning,info:e.summary.info,canSave:0===e.summary.error,hasIssues:e.summary.error+e.summary.warning+e.summary.info>0}}};var d=i(579);const m=e=>{var s,i;let{isOpen:n,onClose:l,stagingGround:r,validation:m,repository:h,selectedBranch:u,hasWriteAccess:p,onSaveSuccess:v}=e;const[g,f]=(0,a.useState)(""),[x,b]=(0,a.useState)(!1),[N,j]=(0,a.useState)(!1),[w,y]=(0,a.useState)(null),[C,S]=(0,a.useState)(!1);if((0,a.useEffect)(()=>{n&&(f((null===r||void 0===r?void 0:r.message)||""),b(!1),j(!1),y(null),S(!1))},[n,r]),!n)return null;const k=m?c.getValidationSummary(m):null,F=!k||(k.canSave||x),M=!!k&&k.error>0,P=e=>409===e.status?"Conflict detected. The branch has been updated since you started. Please refresh and try again.":403===e.status?"Permission denied. Check that your token has write access to this repository.":404===e.status?"Repository or branch not found. Please verify the repository exists and you have access.":e.message?e.message:"An unexpected error occurred while saving. Please try again.",A=e=>{switch(e){case"error":return"\ud83d\udd34";case"warning":return"\ud83d\udfe1";case"info":return"\ud83d\udfe2";default:return"\u2753"}};return(0,d.jsx)("div",{className:"save-dialog-overlay",children:(0,d.jsxs)("div",{className:"save-dialog",children:[(0,d.jsxs)("div",{className:"dialog-header",children:[(0,d.jsx)("h3",{children:"\ud83d\udcbe Save Changes"}),(0,d.jsx)("button",{className:"dialog-close",onClick:l,disabled:N,children:"\xd7"})]}),(0,d.jsxs)("div",{className:"dialog-content",children:[(0,d.jsxs)("div",{className:"save-summary",children:[(0,d.jsxs)("h4",{children:["Files to be committed (",(null===r||void 0===r||null===(s=r.files)||void 0===s?void 0:s.length)||0,"):"]}),(0,d.jsx)("div",{className:"files-list",children:null===r||void 0===r||null===(i=r.files)||void 0===i?void 0:i.map((e,s)=>(0,d.jsxs)("div",{className:"file-item",children:[(0,d.jsx)("span",{className:"file-icon",children:"\ud83d\udcc4"}),(0,d.jsx)("span",{className:"file-path",children:e.path}),(0,d.jsxs)("span",{className:"file-size",children:[(new Blob([e.content]).size/1024).toFixed(1)," KB"]}),(0,d.jsx)("button",{className:"remove-file-btn",onClick:s=>{var i;s.stopPropagation(),i=e.path,window.confirm(`Are you sure you want to remove "${i}" from staging? This cannot be undone.`)&&o.A.removeFile(i)},title:`Remove ${e.path} from staging`,disabled:N,children:"\ud83d\uddd1\ufe0f"})]},s))})]}),k&&(0,d.jsxs)("div",{className:"validation-section",children:[(0,d.jsx)("div",{className:"validation-summary "+(k.hasIssues?"has-issues":"clean"),onClick:()=>S(!C),children:(0,d.jsxs)("div",{className:"validation-header",children:[(0,d.jsx)("h4",{children:"\ud83d\udea6 Validation Status"}),(0,d.jsxs)("div",{className:"validation-badges",children:[k.error>0&&(0,d.jsxs)("span",{className:"validation-badge error",children:["\ud83d\udd34 ",k.error]}),k.warning>0&&(0,d.jsxs)("span",{className:"validation-badge warning",children:["\ud83d\udfe1 ",k.warning]}),k.info>0&&(0,d.jsxs)("span",{className:"validation-badge info",children:["\ud83d\udfe2 ",k.info]}),!k.hasIssues&&(0,d.jsx)("span",{className:"validation-badge success",children:"\u2705 All clear"})]}),(0,d.jsx)("span",{className:"expand-icon "+(C?"expanded":""),children:"\u25bc"})]})}),C&&m&&(0,d.jsx)("div",{className:"validation-details",children:Object.entries(m.files).map(e=>{let[s,i]=e;return i.length>0&&(0,d.jsxs)("div",{className:"file-validation",children:[(0,d.jsxs)("h5",{children:["\ud83d\udcc4 ",s]}),(0,d.jsx)("div",{className:"validation-issues",children:i.map((e,s)=>(0,d.jsxs)("div",{className:`validation-issue ${e.level}`,children:[(0,d.jsx)("span",{className:"issue-icon",children:A(e.level)}),(0,d.jsxs)("div",{className:"issue-content",children:[(0,d.jsx)("div",{className:"issue-message",children:e.message}),e.suggestion&&(0,d.jsxs)("div",{className:"issue-suggestion",children:["\ud83d\udca1 ",e.suggestion]})]})]},s))})]},s)})}),M&&(0,d.jsxs)("div",{className:"override-section",children:[(0,d.jsxs)("label",{className:"override-checkbox",children:[(0,d.jsx)("input",{type:"checkbox",checked:x,onChange:e=>b(e.target.checked)}),(0,d.jsx)("span",{className:"checkmark"}),"Override validation errors and save anyway"]}),(0,d.jsx)("p",{className:"override-warning",children:"\u26a0\ufe0f Saving with validation errors may cause issues with your DAK. Only enable this if you're sure about your changes."})]})]}),(0,d.jsxs)("div",{className:"commit-message-section",children:[(0,d.jsx)("label",{htmlFor:"commit-message",children:(0,d.jsx)("h4",{children:"\u270d\ufe0f Commit Message"})}),(0,d.jsx)("textarea",{id:"commit-message",className:"commit-message-input",value:g,onChange:e=>f(e.target.value),placeholder:"Describe your changes...",rows:3,disabled:N,required:!0}),(0,d.jsx)("div",{className:"commit-tips",children:(0,d.jsxs)("p",{children:["\ud83d\udca1 ",(0,d.jsx)("strong",{children:"Tip:"})," Write a clear, descriptive message about what you changed and why."]})})]}),w&&(0,d.jsx)("div",{className:"error-section",children:(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsx)("span",{className:"error-icon",children:"\u274c"}),w]})}),(0,d.jsxs)("div",{className:"repo-info",children:[(0,d.jsxs)("div",{className:"info-item",children:[(0,d.jsx)("span",{className:"info-label",children:"Repository:"}),(0,d.jsx)("span",{className:"info-value",children:null===h||void 0===h?void 0:h.full_name})]}),(0,d.jsxs)("div",{className:"info-item",children:[(0,d.jsx)("span",{className:"info-label",children:"Branch:"}),(0,d.jsx)("span",{className:"info-value",children:u})]}),(0,d.jsxs)("div",{className:"info-item",children:[(0,d.jsx)("span",{className:"info-label",children:"Access:"}),(0,d.jsx)("span",{className:"info-value "+(p?"write":"read"),children:p?"\u270f\ufe0f Write":"\ud83d\udc41\ufe0f Read-only"})]})]})]}),(0,d.jsxs)("div",{className:"dialog-actions",children:[(0,d.jsx)("button",{className:"action-btn secondary",onClick:l,disabled:N,children:"Cancel"}),(0,d.jsx)("button",{className:"action-btn primary",onClick:async()=>{if(g.trim())if(p)if(!M||x){j(!0),y(null);try{var e;const s=(null===(e=h.owner)||void 0===e?void 0:e.login)||h.full_name.split("/")[0];if(h.isDemo||h.owner&&"demo-user"===h.owner.login)return await new Promise(e=>setTimeout(e,2e3)),void v({sha:"demo-commit-sha",message:g,url:`https://github.com/${h.full_name}/commit/demo-commit-sha`});const i=await t.A.createCommit(s,h.name,u,g.trim(),r.files);v({sha:i.sha,message:g,url:i.html_url})}catch(s){console.error("Error saving changes:",s),y(P(s))}finally{j(!1)}}else y("Cannot save with validation errors. Enable override option to proceed anyway.");else y("You need write permissions to save changes");else y("Commit message is required")},disabled:!F||!g.trim()||N||!p,children:N?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"saving-spinner",children:"\u23f3"}),"Saving..."]}):(0,d.jsx)(d.Fragment,{children:"\ud83d\udcbe Save Changes"})})]})]})})},h=e=>{let{repository:s,selectedBranch:i,hasWriteAccess:n,profile:t}=e;const[l,r]=(0,a.useState)(null),[h,u]=(0,a.useState)(null),[p,v]=(0,a.useState)(!1),[g,f]=(0,a.useState)(null),[x,b]=(0,a.useState)(!1),N=(0,a.useCallback)(async()=>{v(!0),f(null);try{const e=o.A.getStagingGround();r(e),e.files.length>0&&await j(e)}catch(e){f("Failed to load staging ground data"),console.error("Error loading staging ground:",e)}finally{v(!1)}},[]);(0,a.useEffect)(()=>{if(s&&i){o.A.initialize(s,i),N();return o.A.addListener(e=>{r(e),j(e)})}},[s,i,N]);const j=async e=>{if(e&&0!==e.files.length)try{const s=await c.validateStagingGround(e);u(s)}catch(s){console.error("Error validating staging ground:",s),u(null)}else u(null)},w=h?c.getValidationSummary(h):{error:0,warning:0,info:0,canSave:!0},y=l&&l.files.length>0,C=l?l.files.length:0;return(0,d.jsxs)("div",{className:"staging-ground-section",children:[(0,d.jsxs)("div",{className:"section-header",children:[(0,d.jsxs)("h3",{className:"section-title",children:[(0,d.jsx)("span",{className:"section-icon",children:"\ud83d\udcdd"}),"Staging Ground",y&&(0,d.jsxs)("span",{className:"files-badge",children:[C," file",1!==C?"s":""]})]}),(0,d.jsx)("p",{className:"section-description",children:"Changes made through DAK component editors are staged here before being committed to the repository. Review and commit your changes when ready."})]}),(0,d.jsx)("div",{className:"staging-content",children:p?(0,d.jsxs)("div",{className:"loading-indicator",children:[(0,d.jsx)("span",{className:"loading-spinner",children:"\u23f3"}),"Loading staging ground..."]}):g?(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),g]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"staging-status-bar",children:[(0,d.jsx)("div",{className:"status-indicators",children:(0,d.jsxs)("div",{className:"validation-stoplight",children:[(0,d.jsxs)("div",{className:"stoplight-indicator error "+(0===w.error?"lit":""),children:["\ud83d\udd34",w.error>0&&(0,d.jsx)("span",{className:"indicator-badge",children:w.error})]}),(0,d.jsxs)("div",{className:"stoplight-indicator warning "+(0===w.warning?"lit":""),children:["\ud83d\udfe1",w.warning>0&&(0,d.jsx)("span",{className:"indicator-badge",children:w.warning})]}),(0,d.jsxs)("div",{className:"stoplight-indicator info "+(0===w.info?"lit":""),children:["\ud83d\udfe2",w.info>0&&(0,d.jsx)("span",{className:"indicator-badge",children:w.info})]})]})}),(0,d.jsx)("button",{className:"save-btn "+(y&&w.canSave?"":"disabled"),onClick:()=>{n?b(!0):alert("You need write permissions to save changes to this repository.")},disabled:!y||!n,title:y?n?w.canSave?"Save changes to repository":"Fix validation errors first":"Write access required":"No changes to save",children:"\ud83d\udcbe Save Changes"})]}),(0,d.jsxs)("div",{className:"staging-files-section",children:[(0,d.jsx)("h4",{children:"\ud83d\udcc1 Changed Files"}),y?(0,d.jsxs)("div",{className:"changed-files",children:[(l&&l.files?l.files.map(e=>({path:e.path,size:new Blob([e.content]).size,lastModified:e.timestamp})):[]).map((e,s)=>(0,d.jsxs)("div",{className:"file-item",children:[(0,d.jsxs)("div",{className:"file-info",children:[(0,d.jsx)("span",{className:"file-icon",children:"\ud83d\udcc4"}),(0,d.jsx)("span",{className:"file-path",children:e.path})]}),(0,d.jsxs)("div",{className:"file-meta",children:[(0,d.jsxs)("span",{className:"file-size",children:[(e.size/1024).toFixed(1)," KB"]}),(0,d.jsx)("span",{className:"file-time",children:new Date(e.lastModified).toLocaleTimeString()}),(0,d.jsx)("button",{className:"remove-file-btn",onClick:s=>{var i;s.stopPropagation(),i=e.path,window.confirm(`Are you sure you want to remove "${i}" from staging? This cannot be undone.`)&&o.A.removeFile(i)},title:`Remove ${e.path} from staging`,children:"\ud83d\uddd1\ufe0f"})]})]},s)),(0,d.jsx)("div",{className:"file-actions",children:(0,d.jsx)("button",{className:"action-btn secondary small",onClick:()=>{window.confirm("Are you sure you want to discard all changes? This cannot be undone.")&&o.A.clearStagingGround()},children:"\ud83d\uddd1\ufe0f Clear All Changes"})})]}):(0,d.jsxs)("div",{className:"no-changes",children:[(0,d.jsx)("p",{children:"No changes in staging ground"}),(0,d.jsx)("p",{className:"help-text",children:"Changes made through DAK component editors will appear here before being saved to the repository."})]})]}),y&&l.message&&(0,d.jsxs)("div",{className:"commit-message-section",children:[(0,d.jsx)("h4",{children:"\u270d\ufe0f Commit Message"}),(0,d.jsx)("div",{className:"commit-preview",children:(0,d.jsx)("p",{children:l.message})})]})]})}),(0,d.jsx)(m,{isOpen:x,onClose:()=>b(!1),stagingGround:l,validation:h,repository:s,selectedBranch:i,hasWriteAccess:n,onSaveSuccess:e=>{b(!1),o.A.clearStagingGround(),alert(`Changes saved successfully! Commit: ${e.sha.substring(0,7)}`)}})]})},u=e=>{var s;let{profile:i,repository:n,selectedBranch:l,hasWriteAccess:r}=e;const[o,c]=(0,a.useState)([]),[m,u]=(0,a.useState)([]),[p,v]=(0,a.useState)({}),[g,f]=(0,a.useState)(!0),[x,b]=(0,a.useState)(null),N=(null===(s=n.owner)||void 0===s?void 0:s.login)||n.full_name.split("/")[0],j=n.name;(0,a.useEffect)(()=>{(async()=>{try{if(f(!0),b(null),null!==i&&void 0!==i&&i.isDemo){c([{name:"main",commit:{sha:"abc123"}},{name:"feature/updates",commit:{sha:"def456"}},{name:"dev",commit:{sha:"ghi789"}}]);u([{id:"pages-build",name:"Deploy to GitHub Pages",triggers:["push","manual"]}]);const e={main:{status:"completed",conclusion:"success",html_url:`https://github.com/${N}/${j}/actions/runs/123456`,updated_at:(new Date).toISOString()},"feature/updates":{status:"completed",conclusion:"action_required",html_url:`https://github.com/${N}/${j}/actions/runs/123457`,updated_at:(new Date).toISOString()},dev:{status:"completed",conclusion:"failure",html_url:`https://github.com/${N}/${j}/actions/runs/123458`,updated_at:(new Date).toISOString()}};return v(e),void f(!1)}const s=(await t.A.getBranches(N,j)).filter(e=>"gh-pages"!==e.name);c(s);const a=await t.A.getWorkflows(N,j);u(a);const n=a.find(e=>e.name.toLowerCase().includes("build")||e.name.toLowerCase().includes("publish")||e.name.toLowerCase().includes("pages"));if(n){const i={};for(const a of s)try{const e=await t.A.getWorkflowRunsForWorkflow(N,j,n.id,{branch:a.name,per_page:1});e.length>0&&(i[a.name]=e[0])}catch(e){console.warn(`Could not fetch workflow runs for branch ${a.name}:`,e)}v(i)}f(!1)}catch(e){console.error("Error fetching publication data:",e),b("Failed to load publication data"),f(!1)}})()},[N,j,null===i||void 0===i?void 0:i.isDemo]);return g?(0,d.jsx)("div",{className:"publications-loading",children:(0,d.jsxs)("div",{className:"loading-content",children:[(0,d.jsx)("h3",{children:"Loading Publications..."}),(0,d.jsx)("p",{children:"Fetching branch and workflow information..."})]})}):x?(0,d.jsx)("div",{className:"publications-error",children:(0,d.jsxs)("div",{className:"error-content",children:[(0,d.jsx)("h3",{children:"Error Loading Publications"}),(0,d.jsx)("p",{children:x})]})}):(0,d.jsxs)("div",{className:"publications-section",children:[(0,d.jsx)(h,{repository:n,selectedBranch:l,hasWriteAccess:r,profile:i}),(0,d.jsxs)("div",{className:"section-header",children:[(0,d.jsx)("h3",{className:"section-title",children:"Published DAK Content"}),(0,d.jsx)("p",{className:"section-description",children:"Access published Implementation Guide content for this DAK repository. Each branch is published automatically via GitHub Actions to GitHub Pages."})]}),(0,d.jsx)("div",{className:"publications-grid",children:o.map(e=>{const s=e.name===n.default_branch||"main"===e.name,a=(l=e.name)===n.default_branch||"main"===l?`https://${N}.github.io/${j}/`:`https://${N}.github.io/${j}/branches/${l}/`;var l;const o=(e=>{const s=p[e];if(!s)return{icon:"\u26aa",title:"No recent workflow runs",link:null};const i=s.status,a=s.conclusion;return"in_progress"===i||"queued"===i?{icon:"\ud83d\udd04",title:"Workflow running",link:s.html_url,className:"running"}:"success"===a?{icon:"\u2705",title:"Last build successful",link:s.html_url,className:"success"}:"failure"===a?{icon:"\u274c",title:"Last build failed",link:s.html_url,className:"failure"}:"action_required"===a?{icon:"\u23f3",title:"Workflow requires approval",link:s.html_url,className:"approval-required"}:{icon:"\u26a0\ufe0f",title:`Build ${a||i}`,link:s.html_url,className:"warning"}})(e.name);return(0,d.jsxs)("div",{className:"publication-card "+(s?"main-branch":""),children:[(0,d.jsxs)("div",{className:"publication-header",children:[(0,d.jsxs)("div",{className:"branch-info",children:[(0,d.jsx)("span",{className:"branch-icon",children:"\ud83c\udf3f"}),(0,d.jsx)("span",{className:"branch-name",children:e.name}),s&&(0,d.jsx)("span",{className:"main-badge",children:"MAIN"})]}),(0,d.jsx)("div",{className:"workflow-status",children:o.link?(0,d.jsx)("a",{href:o.link,target:"_blank",rel:"noopener noreferrer",className:`status-icon ${o.className||""}`,title:o.title,children:o.icon}):(0,d.jsx)("span",{className:`status-icon ${o.className||""}`,title:o.title,children:o.icon})})]}),(0,d.jsxs)("div",{className:"publication-content",children:[(0,d.jsxs)("div",{className:"publication-url",children:[(0,d.jsx)("label",{children:"Published at:"}),(0,d.jsxs)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"publication-link",children:[a,(0,d.jsx)("span",{className:"external-link",children:"\u2197"})]})]}),(0,d.jsxs)("div",{className:"publication-actions",children:[(0,d.jsx)("button",{className:"restart-workflow-btn",onClick:()=>(async e=>{if(null!==i&&void 0!==i&&i.isDemo)return void alert(`Demo Mode: Workflow restart simulated for branch: ${e}`);const s=m.find(e=>e.name.toLowerCase().includes("build")||e.name.toLowerCase().includes("publish")||e.name.toLowerCase().includes("pages"));if(s)try{await t.A.triggerWorkflow(N,j,s.id,e),alert(`Workflow restarted for branch: ${e}`),setTimeout(()=>{window.location.reload()},2e3)}catch(a){console.error("Error restarting workflow:",a),alert("Failed to restart workflow. Please check your permissions.")}else alert("No suitable workflow found to restart")})(e.name),disabled:!r,title:r?"Restart build workflow for this branch":"Write permissions required",children:"\ud83d\udd04 Rebuild"}),(0,d.jsx)("a",{href:`https://github.com/${N}/${j}/tree/${e.name}`,target:"_blank",rel:"noopener noreferrer",className:"view-source-btn",title:"View source code for this branch",children:"\ud83d\udc41\ufe0f View Source"})]})]})]},e.name)})}),0===o.length&&(0,d.jsx)("div",{className:"no-branches",children:(0,d.jsx)("p",{children:"No publishable branches found (excluding gh-pages)."})})]})},p=()=>{const{profile:e,repository:s,branch:i,navigate:o}=(0,n.oc)(),[c,m]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),[v,g]=(0,a.useState)("core"),[f,x]=(0,a.useState)({});(0,a.useEffect)(()=>{(async()=>{if(s&&t.A.isAuth())try{const e=await t.A.checkRepositoryPermissions(s.owner.login,s.name);m(e)}catch(e){console.error("Error checking repository permissions:",e),m(!1)}else m(!1)})()},[s]),(0,a.useEffect)(()=>{e&&s&&i&&l.default.setBranchContext(e.login,s.name,i)},[e,s,i]),(0,a.useEffect)(()=>{(async()=>{if(s&&t.A.isAuth())try{const e=await t.A.getRepositoryIssues(s.owner.login,s.name),i={};e.forEach(e=>{e.labels.forEach(e=>{i[e.name]=(i[e.name]||0)+1})}),x(i)}catch(e){console.warn("Could not fetch issue counts:",e)}})()},[s]);const b=a=>{e&&s&&o(`/${a}/${e.login}/${s.name}/${i}`,{state:{profile:e,repository:s,selectedBranch:i}})},N=[{id:"health-interventions",title:"Health Interventions and Recommendations",description:"Clinical guidelines and health intervention specifications that define evidence-based care recommendations",icon:"\ud83d\udcd6",path:"health-interventions",level:"Level 2: Core Components",color:"#0078d4"},{id:"generic-personas",title:"Generic Personas",description:"Standardized user roles and actor definitions that represent different types of healthcare workers and patients",icon:"\ud83d\udc65",path:"actor-editor",level:"Level 2: Core Components",color:"#107c10"},{id:"user-scenarios",title:"User Scenarios",description:"Narrative descriptions of how different personas interact with the system in specific healthcare contexts",icon:"\ud83d\udcdd",path:"user-scenarios",level:"Level 2: Core Components",color:"#881798"},{id:"business-processes",title:"Generic Business Processes and Workflows",description:"BPMN workflows and business process definitions that model clinical workflows and care pathways",icon:"\ud83d\udd04",path:"business-process-selection",level:"Level 2: Core Components",color:"#d13438"},{id:"core-data-elements",title:"Core Data Elements",description:"Essential data structures and terminology needed for clinical data capture and exchange",icon:"\ud83d\uddc3\ufe0f",path:"core-data-dictionary-viewer",level:"Level 2: Core Components",color:"#ff8c00"},{id:"decision-support",title:"Decision-Support Logic",description:"DMN decision tables and clinical decision support rules that encode clinical logic",icon:"\ud83c\udfaf",path:"decision-support-logic",level:"Level 2: Core Components",color:"#00bcf2"},{id:"program-indicators",title:"Program Indicators",description:"Performance indicators and measurement definitions for monitoring and evaluation",icon:"\ud83d\udcca",path:"program-indicators",level:"Level 2: Core Components",color:"#498205"},{id:"functional-requirements",title:"Functional and Non-Functional Requirements",description:"System requirements specifications that define capabilities and constraints",icon:"\u2699\ufe0f",path:"functional-requirements",level:"Level 2: Core Components",color:"#6b69d6"},{id:"testing",title:"Testing",description:"Feature files and test scenarios for validating the DAK implementation",icon:"\ud83e\uddea",path:"testing-viewer",level:"Level 2: Core Components",color:"#8b5cf6"},{id:"terminology",title:"Terminology",description:"Code systems, value sets, and concept maps",icon:"\ud83c\udff7\ufe0f",path:"terminology",level:"Level 3: Technical Implementation",color:"#ff8c00"},{id:"profiles",title:"FHIR Profiles",description:"FHIR resource profiles and constraints",icon:"\ud83d\udd27",path:"profiles",level:"Level 3: Technical Implementation",color:"#00bcf2"},{id:"extensions",title:"FHIR Extensions",description:"Custom FHIR extensions and modifications",icon:"\ud83e\udde9",path:"extensions",level:"Level 3: Technical Implementation",color:"#498205"},{id:"test-data",title:"Test Data & Examples",description:"Sample data and testing resources",icon:"\ud83e\uddea",path:"test-data",level:"Level 3: Technical Implementation",color:"#8b5cf6"},{id:"questionnaire-editor",title:"FHIR Questionnaires",description:"Structured questionnaires and forms for data collection using FHIR standard",icon:"\ud83d\udccb",path:"questionnaire-editor",level:"Level 3: Technical Implementation",color:"#17a2b8"}],j=N.filter(e=>e.level.includes("Level 2: Core Components")),w=N.filter(e=>e.level.includes("Level 3: Technical Implementation"));return(0,d.jsxs)("div",{className:"dak-dashboard",children:[(0,d.jsx)("div",{className:"dashboard-header",children:(0,d.jsxs)("div",{className:"dashboard-title",children:[(0,d.jsxs)("h1",{children:[null===s||void 0===s?void 0:s.name," Dashboard"]}),(0,d.jsxs)("p",{className:"dashboard-subtitle",children:["Digital Adaptation Kit for ",(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.login)]})]})}),s&&(0,d.jsx)(r.A,{repository:s,profile:e,selectedBranch:i,issueCounts:f}),(0,d.jsxs)("div",{className:"tab-navigation",children:[(0,d.jsxs)("button",{className:"tab-button "+("core"===v?"active":""),onClick:()=>g("core"),children:[(0,d.jsx)("span",{className:"tab-icon",children:"\u2b50"}),(0,d.jsx)("span",{className:"tab-text",children:"9 Core Components"})]}),(0,d.jsxs)("button",{className:"tab-button "+("additional"===v?"active":""),onClick:()=>g("additional"),children:[(0,d.jsx)("span",{className:"tab-icon",children:"\ud83d\udd27"}),(0,d.jsxs)("span",{className:"tab-text",children:["Additional Components (",w.length,")"]})]}),(0,d.jsxs)("button",{className:"tab-button "+("publications"===v?"active":""),onClick:()=>g("publications"),children:[(0,d.jsx)("span",{className:"tab-icon",children:"\ud83d\udcda"}),(0,d.jsx)("span",{className:"tab-text",children:"Publications"})]})]}),(0,d.jsxs)("div",{className:"dashboard-content",children:["core"===v&&(0,d.jsx)("div",{className:"components-grid core-components",children:j.map(e=>(0,d.jsxs)("div",{className:"component-card",onClick:()=>b(e.path),children:[(0,d.jsx)("div",{className:"component-icon",children:e.icon}),(0,d.jsx)("h3",{children:e.title}),(0,d.jsx)("p",{children:e.description}),f[e.id]>0&&(0,d.jsxs)("div",{className:"issue-badge",children:[f[e.id]," issues"]})]},e.id))}),"additional"===v&&(0,d.jsx)("div",{className:"components-grid additional-components",children:w.map(e=>(0,d.jsxs)("div",{className:"component-card",onClick:()=>b(e.path),children:[(0,d.jsx)("div",{className:"component-icon",children:e.icon}),(0,d.jsx)("h3",{children:e.title}),(0,d.jsx)("p",{children:e.description}),f[e.id]>0&&(0,d.jsxs)("div",{className:"issue-badge",children:[f[e.id]," issues"]})]},e.id))}),"publications"===v&&(0,d.jsx)("div",{className:"publications-section",children:(0,d.jsx)(u,{repository:s,profile:e,selectedBranch:i,onNavigate:()=>{e&&s&&o(`/publications/${e.login}/${s.name}/${i}`,{state:{profile:e,repository:s,selectedBranch:i}})}})})]}),h&&(0,d.jsxs)("div",{className:"permission-dialog",children:[(0,d.jsx)("div",{className:"dialog-overlay",onClick:()=>p(!1)}),(0,d.jsxs)("div",{className:"dialog-content",children:[(0,d.jsx)("h3",{children:"Repository Permissions"}),(0,d.jsxs)("p",{children:["You have ",c?"write":"read-only"," access to this repository.",!c&&" You can view content but cannot make changes."]}),(0,d.jsx)("button",{onClick:()=>p(!1),children:"Got it"})]})]})]})},v=()=>(0,d.jsx)(n.Mx,{pageName:"dashboard",children:(0,d.jsx)(p,{})})}}]);
//# sourceMappingURL=171.fb2cb34a.chunk.js.map