"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[816],{8816:(e,s,r)=>{r.r(s),r.d(s,{default:()=>l});var i=r(5043),a=r(9615),o=r(3071),n=r(5240),t=r(6712),c=r(579);const l=()=>{var e;const s=(0,a.zy)(),r=(0,a.Zp)(),{user:l}=(0,a.g)(),[d,p]=(0,i.useState)([]),[h,g]=(0,i.useState)(!0),[m,x]=(0,i.useState)(null),[u,j]=(0,i.useState)(null===(e=s.state)||void 0===e?void 0:e.profile);(0,i.useEffect)(()=>{(async()=>{if(l&&!u)try{if(o.A.isAuth()){const e=await o.A.getUser(l);j(e)}else j({login:l,name:l.charAt(0).toUpperCase()+l.slice(1),avatar_url:`https://github.com/${l}.png`,type:"User",isDemo:!0})}catch(m){console.error("Error fetching user profile:",m),r("/",{state:{warningMessage:`User '${l}' not found or not accessible.`}})}})()},[l,u,r]);const N=(0,i.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g(!0),x(null);try{const r=u.type;if(!e){let e=null;try{e=n.A.getCachedRepositories(u.login,r)}catch(s){console.warn("Error accessing repository cache:",s)}if(e)return console.log(`Using cached repositories for ${u.login} (${r})`),p(e.repositories),void g(!1)}console.log(`Fetching fresh repositories for ${u.login} (${r})`);const i=await o.A.getRepositories(u.login,r,u.isDemo);try{n.A.setCachedRepositories(u.login,r,i)}catch(s){console.warn("Error caching repositories:",s)}p(i)}catch(m){console.error("Error fetching repositories:",m),x("Failed to fetch repositories. Please check your connection and try again.")}finally{g(!1)}},[u]);(0,i.useEffect)(()=>{u||l?u&&N():r("/")},[u,l,r,N]);return u?(0,c.jsx)(t.Mx,{pageName:"repository-selection",children:(0,c.jsxs)("div",{className:"repo-content",children:[(0,c.jsxs)("div",{className:"breadcrumb",children:[(0,c.jsx)("button",{onClick:()=>r("/"),className:"breadcrumb-link",children:"Select Profile"}),(0,c.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,c.jsx)("span",{className:"breadcrumb-current",children:"Select Repository"})]}),(0,c.jsx)("div",{className:"repo-main",children:(0,c.jsxs)("div",{className:"repo-selection",children:[(0,c.jsx)("h2",{children:"Select DAK Repository"}),(0,c.jsx)("p",{children:"Choose a repository containing WHO SMART Guidelines Digital Adaptation Kit content:"}),h?(0,c.jsxs)("div",{className:"loading",children:[(0,c.jsx)("div",{className:"spinner"}),(0,c.jsx)("p",{children:"Loading repositories..."})]}):m?(0,c.jsxs)("div",{className:"error-state",children:[(0,c.jsx)("h3",{children:"Error loading repositories"}),(0,c.jsx)("p",{children:m}),(0,c.jsx)("button",{onClick:()=>N(!0),className:"retry-btn",children:"Try Again"})]}):0===d.length?(0,c.jsxs)("div",{className:"empty-state",children:[(0,c.jsx)("h3",{children:"No DAK repositories found"}),(0,c.jsx)("p",{children:"No repositories found with DAK-related topics or keywords. Create a new repository or add topics like 'who', 'smart-guidelines', 'dak', or 'health' to existing repositories."})]}):(0,c.jsx)("div",{className:"repo-grid",children:d.map(e=>{return(0,c.jsxs)("div",{className:"repo-card",onClick:()=>(e=>{r(`/dashboard/${e.owner.login}/${e.name}`,{state:{profile:u,repository:e}})})(e),children:[(0,c.jsxs)("div",{className:"repo-header-info",children:[(0,c.jsx)("h3",{children:e.name}),(0,c.jsxs)("div",{className:"repo-meta",children:[e.private&&(0,c.jsx)("span",{className:"private-badge",children:"Private"}),e.language&&(0,c.jsx)("span",{className:"language-badge",children:e.language})]})]}),(0,c.jsx)("p",{className:"repo-description",children:e.description||"No description available"}),(0,c.jsxs)("div",{className:"repo-topics",children:[(e.topics||[]).slice(0,3).map(e=>(0,c.jsx)("span",{className:"topic-tag",children:e},e)),(e.topics||[]).length>3&&(0,c.jsxs)("span",{className:"topic-more",children:["+",(e.topics||[]).length-3," more"]})]}),(0,c.jsxs)("div",{className:"repo-stats",children:[(0,c.jsxs)("div",{className:"stat",children:[(0,c.jsx)("span",{className:"stat-icon",children:"\u2b50"}),(0,c.jsx)("span",{children:e.stargazers_count||0})]}),(0,c.jsxs)("div",{className:"stat",children:[(0,c.jsx)("span",{className:"stat-icon",children:"\ud83c\udf74"}),(0,c.jsx)("span",{children:e.forks_count||0})]}),(0,c.jsxs)("div",{className:"stat",children:[(0,c.jsx)("span",{className:"stat-icon",children:"\ud83d\udcc5"}),(0,c.jsxs)("span",{children:["Updated ",(s=e.updated_at,new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]})]})]})]},e.id);var s})})]})})]})}):(0,c.jsx)(t.Mx,{pageName:"repository-selection",children:(0,c.jsx)("div",{children:"Redirecting..."})})}}}]);
//# sourceMappingURL=816.3d25d449.chunk.js.map