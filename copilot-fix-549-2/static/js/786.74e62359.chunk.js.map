{"version":3,"file":"static/js/786.74e62359.chunk.js","mappings":"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","sources":["services/helpContentService.js","services/profileSubscriptionService.js","components/framework/PageProvider.js","utils/themeUtils.js","services/userAccessService.js","services/bookmarkService.js","components/PreviewBadge.js","components/framework/PageHeader.js","components/framework/AccessBadge.js","components/framework/PageContext.js","components/framework/ErrorHandler.js","components/framework/PageLayout.js","components/framework/usePageParams.js","components/framework/SaveButtonsContainer.js","components/framework/CommitMessageDialog.js","services/dataAccessLayer.js","components/framework/AssetEditorLayout.js","components/framework/useAssetSave.js","components/framework/ToolDefinition.js","services/cacheManagementService.js","components/LanguageSelector.js","components/ContextualHelpMascot.js","hooks/useThemeImage.js","components/HelpModal.js","services/repositoryCacheService.js","services/localStorageService.js","services/dakValidationService.js"],"sourcesContent":["// Help Content Service - Provides page-specific help topics and content\nclass HelpContentService {\n  constructor() {\n    // Universal help topics that appear on all pages\n    this.universalTopics = {\n      documentation: {\n        id: 'sgex-documentation',\n        title: 'View Documentation',\n        badge: '/sgex/cat-paw-info-icon.svg',\n        type: 'action',\n        action: () => {\n          // Navigate to documentation viewer in the same window\n          const currentPath = window.location.pathname;\n          \n          // Check if we're in a feature branch deployment\n          // Feature branch URLs have the pattern: /sgex/branch-name/page-path\n          // Main branch URLs have the pattern: /sgex/page-path\n          let basePath = '';\n          if (currentPath.includes('/sgex')) {\n            const pathParts = currentPath.split('/');\n            const sgexIndex = pathParts.indexOf('sgex');\n            \n            if (sgexIndex !== -1) {\n              // Check if this is a feature branch (has additional path segment after /sgex)\n              if (pathParts.length > sgexIndex + 2 && \n                  pathParts[sgexIndex + 1] && \n                  !['dashboard', 'docs', 'select_profile', 'dak-action', 'dak-selection'].includes(pathParts[sgexIndex + 1])) {\n                // Feature branch: /sgex/branch-name\n                basePath = `/${pathParts.slice(1, sgexIndex + 2).join('/')}`;\n              } else {\n                // Main branch: /sgex\n                basePath = `/${pathParts.slice(1, sgexIndex + 1).join('/')}`;\n              }\n            }\n          }\n          \n          window.location.href = `${basePath}/docs/overview`;\n        },\n        content: `\n          <p>Access comprehensive documentation and guides for using SGEX Workbench.</p>\n          <div class=\"help-tip\">\n            <strong>📖 Available Documentation:</strong> Requirements, Architecture, DAK Components, User Guides, and more.\n          </div>\n        `\n      },\n      bugReport: {\n        id: 'report-sgex-bug',\n        title: 'Report a SGeX bug',\n        badge: '/sgex/cat-paw-bug-icon.svg',\n        type: 'slideshow',\n        content: [\n          {\n            title: 'Report a Bug or Issue',\n            content: `\n              <p>Help us improve SGeX by reporting bugs and issues:</p>\n              <h4>What type of issue are you experiencing?</h4>\n              <div class=\"bug-report-options\">\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('bug')\">\n                  🐛 Bug Report - Something isn't working correctly\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('feature')\">\n                  ✨ Feature Request - Suggest a new feature or improvement\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('question')\">\n                  ❓ Question - Ask for help or clarification\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('documentation')\">\n                  📚 Documentation Issue - Report problems with documentation\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('blank')\">\n                  📝 Blank Issue - Create an issue without a template\n                </button>\n              </div>\n              <div class=\"help-tip\">\n                <strong>💡 Tip:</strong> Please provide as much detail as possible including steps to reproduce, expected behavior, and actual behavior.\n              </div>\n              <div class=\"help-fallback\">\n                <strong>🔗 Can't access GitHub?</strong> If the buttons above don't work in your environment:\n                <ol>\n                  <li>Email us directly at <a href=\"mailto:smart@who.int?subject=SGEX Bug Report\">smart@who.int</a></li>\n                  <li>Or visit <a href=\"https://github.com/litlfred/sgex/issues/new\" target=\"_blank\">github.com/litlfred/sgex/issues/new</a> manually</li>\n                </ol>\n              </div>\n            `\n          }\n        ]\n      },\n      dakFeedback: {\n        id: 'provide-dak-feedback',\n        title: 'Provide DAK Feedback',\n        type: 'slideshow',\n        content: [\n          {\n            title: 'Provide Feedback on this DAK',\n            content: `\n              <p>Share feedback about this Digital Adaptation Kit (DAK):</p>\n              <h4>What type of feedback do you have?</h4>\n              <div class=\"bug-report-options\">\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('content')\">\n                  📝 Report DAK Content Error - Problems with clinical content or logic\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('bug')\">\n                  🐛 DAK Bug - Issue with this specific DAK content\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('improvement')\">\n                  📈 DAK Improvement - Suggest enhancements to this DAK\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('question')\">\n                  ❓ DAK Question - Ask about this DAK's implementation\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('blank')\">\n                  📝 Blank DAK Issue - Create an issue without a template\n                </button>\n              </div>\n              <div class=\"help-tip\">\n                <strong>💡 Note:</strong> This will open an issue in the selected DAK repository for targeted feedback.\n              </div>\n            `\n          }\n        ]\n      }\n    };\n\n    this.helpTopics = {\n      'landing-page-unauthenticated': [\n        {\n          id: 'github-pat-setup',\n          title: 'How to Create a GitHub Personal Access Token',\n          badge: '/sgex/cat-paw-lock-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Step 1: Go to GitHub Settings',\n              content: `\n                <p>Navigate to your GitHub account settings:</p>\n                <ol>\n                  <li>Click your profile picture in the top right</li>\n                  <li>Select \"Settings\" from the dropdown</li>\n                  <li>Go to \"Developer settings\" → \"Personal access tokens\"</li>\n                  <li>Choose \"Fine-grained tokens\" (recommended) or \"Tokens (classic)\"</li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> Fine-grained tokens provide better security with repository-specific access.\n                </div>\n              `\n            },\n            {\n              title: 'Step 2: Generate New Token',\n              content: `\n                <p>Create your new token:</p>\n                <ol>\n                  <li>Click \"Generate new token\"</li>\n                  <li>Give it a descriptive name like \"SGEX Workbench\"</li>\n                  <li>Set expiration (90 days recommended)</li>\n                  <li>Select repository access (specific repos or all)</li>\n                </ol>\n                <div class=\"help-warning\">\n                  <strong>⚠️ Important:</strong> You'll only see the token once, so copy it immediately!\n                </div>\n              `\n            },\n            {\n              title: 'Step 3: Set Required Permissions',\n              content: `\n                <p>For <strong>fine-grained tokens</strong>, enable:</p>\n                <ul>\n                  <li><strong>Contents:</strong> Read and Write</li>\n                  <li><strong>Metadata:</strong> Read</li>\n                  <li><strong>Pull requests:</strong> Read and Write</li>\n                </ul>\n                <p>For <strong>classic tokens</strong>, select:</p>\n                <ul>\n                  <li><strong>repo</strong> - Full control of private repositories</li>\n                  <li><strong>read:org</strong> - Read org and team membership</li>\n                </ul>\n              `\n            },\n            {\n              title: 'Step 4: Use Your Token',\n              content: `\n                <p>Now you can authenticate with SGEX:</p>\n                <ol>\n                  <li>Copy your newly generated token</li>\n                  <li>Paste it into the login form</li>\n                  <li>Click \"Sign in with Personal Access Token\"</li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>🔒 Security:</strong> Your token is stored securely in your browser and never shared with servers.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'landing-page-authenticated': [\n        {\n          id: 'profile-selection',\n          title: 'Selecting Your Profile or Organization',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Understanding Profile Types',\n              content: `\n                <p>SGEX shows different types of profiles:</p>\n                <ul>\n                  <li><strong>Personal:</strong> Your individual GitHub repositories</li>\n                  <li><strong>Organization:</strong> Repositories belonging to organizations you're a member of</li>\n                  <li><strong>WHO Official:</strong> World Health Organization repositories (always available)</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> DAK count badges show how many SMART Guidelines repositories were found.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'dak-action-selection': [\n        {\n          id: 'choosing-dak-action',\n          title: 'Choosing Your DAK Action',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Understanding DAK Actions',\n              content: `\n                <p>Choose the right action for your workflow:</p>\n                <ul>\n                  <li><strong>Edit Existing DAK:</strong> Modify an existing repository you have write access to</li>\n                  <li><strong>Fork and Edit:</strong> Create your own copy of a repository to work on</li>\n                  <li><strong>Create New DAK:</strong> Start a brand new DAK repository from scratch</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> If you're not sure, start with \"Edit Existing DAK\" if you have permissions, or \"Fork and Edit\" to experiment safely.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'documentation-viewer': [\n        {\n          id: 'navigation-help',\n          title: 'Navigating Documentation',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Using the Documentation Viewer',\n              content: `\n                <p>The documentation viewer provides easy access to all project information:</p>\n                <ul>\n                  <li>Use the sidebar menu to navigate between sections</li>\n                  <li>Use the dropdown to quickly jump to any document</li>\n                  <li>Click \"Back\" to return to the previous page</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>📖 Available Documentation:</strong> Requirements, Architecture, DAK Components, and more.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'dak-dashboard': [\n        {\n          id: 'dak-components-overview',\n          title: 'Understanding DAK Components',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'WHO SMART Guidelines DAK Components',\n              content: `\n                <p>Digital Adaptation Kits (DAKs) contain 8 core components organized in two levels:</p>\n                <h4>Level 2: Business Logic & Processes</h4>\n                <ul>\n                  <li><strong>Business Processes:</strong> BPMN workflows</li>\n                  <li><strong>Decision Support Logic:</strong> DMN decision tables</li>\n                  <li><strong>Indicators & Measures:</strong> Performance metrics</li>\n                  <li><strong>Data Entry Forms:</strong> Structured questionnaires</li>\n                </ul>\n                <h4>Level 3: Technical Implementation</h4>\n                <ul>\n                  <li><strong>Terminology:</strong> Code systems and value sets</li>\n                  <li><strong>FHIR Profiles:</strong> Resource structure definitions</li>\n                  <li><strong>FHIR Extensions:</strong> Custom data elements</li>\n                  <li><strong>Test Data & Examples:</strong> Sample data for validation</li>\n                </ul>\n              `\n            }\n          ]\n        }\n      ],\n      'dak-selection': [\n        {\n          id: 'choosing-dak-repository',\n          title: 'Selecting the Right DAK Repository',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Understanding DAK Repository Types',\n              content: `\n                <p>Choose the right repository based on your workflow:</p>\n                <ul>\n                  <li><strong>Published DAKs:</strong> Official WHO repositories with complete implementations</li>\n                  <li><strong>Community DAKs:</strong> Community-maintained repositories with adaptations</li>\n                  <li><strong>Template DAKs:</strong> Starting templates for creating new DAKs</li>\n                  <li><strong>Private DAKs:</strong> Your private repositories or organization-specific DAKs</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> Look for the \"SMART Guidelines\" badge to ensure compatibility.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'organization-selection': [\n        {\n          id: 'selecting-organization',\n          title: 'Choosing an Organization',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Organization vs Personal Account',\n              content: `\n                <p>Decide where to create or fork your DAK:</p>\n                <ul>\n                  <li><strong>Personal Account:</strong> For individual development and experimentation</li>\n                  <li><strong>Organization Account:</strong> For team collaboration and official implementations</li>\n                  <li><strong>WHO Official:</strong> Only for authorized WHO contributors</li>\n                </ul>\n                <div class=\"help-warning\">\n                  <strong>⚠️ Important:</strong> Make sure you have the necessary permissions for the selected organization.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'bpmn-editor': [\n        {\n          id: 'using-bpmn-editor',\n          title: 'Using the BPMN Editor',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'BPMN Business Process Modeling',\n              content: `\n                <p>The BPMN editor helps you create and modify business process workflows:</p>\n                <ul>\n                  <li><strong>Drag and Drop:</strong> Use the palette to add process elements</li>\n                  <li><strong>Connect Elements:</strong> Click and drag to create sequence flows</li>\n                  <li><strong>Properties Panel:</strong> Configure element properties and conditions</li>\n                  <li><strong>Validation:</strong> The editor highlights errors and warnings</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> BPMN processes define the clinical workflow and decision logic for your DAK.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'questionnaire-editor': [\n        {\n          id: 'using-questionnaire-editor',\n          title: 'Using the FHIR Questionnaire Editor',\n          badge: '/sgex/cat-paw-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'FHIR Questionnaire Overview',\n              content: `\n                <p>The FHIR Questionnaire editor helps you create and modify structured data collection forms:</p>\n                <ul>\n                  <li><strong>Visual Editor:</strong> Uses LHC-Forms for intuitive questionnaire design</li>\n                  <li><strong>FHIR Compliant:</strong> Generates standard FHIR R4 Questionnaire resources</li>\n                  <li><strong>Multilingual:</strong> Support for multiple languages and translations</li>\n                  <li><strong>Preview Mode:</strong> Test questionnaires as they would appear to users</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>📋 File Location:</strong> Questionnaires are stored in <code>input/questionnaires/*.json</code>\n                </div>\n              `\n            },\n            {\n              title: 'Creating New Questionnaires',\n              content: `\n                <p>To create a new FHIR Questionnaire:</p>\n                <ol>\n                  <li>Click \"Create New Questionnaire\" on the main screen</li>\n                  <li>A template questionnaire will be loaded in the editor</li>\n                  <li>Modify the questionnaire structure using the visual interface</li>\n                  <li>Add questions, sections, and response options</li>\n                  <li>Set validation rules and conditional logic</li>\n                </ol>\n                <div class=\"help-warning\">\n                  <strong>⚠️ Remember:</strong> Save your work regularly using \"Save to Staging\" or \"Commit to GitHub\"\n                </div>\n              `\n            },\n            {\n              title: 'Editing Existing Questionnaires',\n              content: `\n                <p>To modify existing questionnaires:</p>\n                <ol>\n                  <li>Select a questionnaire from the list</li>\n                  <li>The questionnaire will load in the LHC-Forms editor</li>\n                  <li>Make your changes using the visual interface</li>\n                  <li>Preview the form to test user experience</li>\n                  <li>Save changes when satisfied</li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> Use the staging framework to test changes before committing to GitHub\n                </div>\n              `\n            },\n            {\n              title: 'Internationalization Support',\n              content: `\n                <p>The questionnaire editor supports multiple languages:</p>\n                <ul>\n                  <li><strong>Language Selection:</strong> Use the language dropdown to switch between languages</li>\n                  <li><strong>Translations:</strong> Add translations for all text fields</li>\n                  <li><strong>FHIR Extensions:</strong> Uses standard FHIR translation extensions</li>\n                  <li><strong>Preview:</strong> Test questionnaires in different languages</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>🌍 Best Practice:</strong> Always provide translations for your target implementation languages\n                </div>\n              `\n            }\n          ]\n        },\n        {\n          id: 'questionnaire-management',\n          title: 'Managing Questionnaire Assets',\n          badge: '/sgex/cat-paw-file-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'File Organization',\n              content: `\n                <p>FHIR Questionnaires are organized as follows:</p>\n                <ul>\n                  <li><strong>Location:</strong> <code>input/questionnaires/</code> directory</li>\n                  <li><strong>Format:</strong> JSON files following FHIR R4 Questionnaire schema</li>\n                  <li><strong>Naming:</strong> Use descriptive names like <code>patient-registration.json</code></li>\n                  <li><strong>Validation:</strong> All files are validated against FHIR schema</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>📁 Convention:</strong> Use kebab-case filenames for consistency\n                </div>\n              `\n            },\n            {\n              title: 'Version Control Integration',\n              content: `\n                <p>The questionnaire editor integrates with GitHub for version control:</p>\n                <ul>\n                  <li><strong>Staging:</strong> Save changes locally before committing</li>\n                  <li><strong>Commits:</strong> Create meaningful commit messages</li>\n                  <li><strong>Branches:</strong> Work on different branches for features</li>\n                  <li><strong>History:</strong> Track changes and revert if needed</li>\n                </ul>\n                <div class=\"help-warning\">\n                  <strong>⚠️ Important:</strong> Always test questionnaires before committing to main branch\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'component-editor': [\n        {\n          id: 'component-editor-overview',\n          title: 'Understanding the Component Editor',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'DAK Component Types',\n              content: `\n                <p>The component editor provides specialized interfaces for different DAK components:</p>\n                <h4>Business Logic Components</h4>\n                <ul>\n                  <li><strong>Business Processes:</strong> BPMN workflow editor</li>\n                  <li><strong>Decision Logic:</strong> DMN decision table editor</li>\n                  <li><strong>Forms:</strong> Structured questionnaire builder</li>\n                </ul>\n                <h4>Technical Components</h4>\n                <ul>\n                  <li><strong>FHIR Resources:</strong> Profile and extension definitions</li>\n                  <li><strong>Terminology:</strong> Code systems and value sets</li>\n                  <li><strong>Test Data:</strong> Example data and test cases</li>\n                </ul>\n              `\n            }\n          ]\n        }\n      ],\n      'pat-login': [\n        {\n          id: 'pat-authentication-help',\n          title: 'Using Personal Access Tokens',\n          badge: '/sgex/cat-paw-lock-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Why Personal Access Tokens?',\n              content: `\n                <p>SGEX uses GitHub Personal Access Tokens (PATs) for secure authentication:</p>\n                <ul>\n                  <li><strong>No Backend Required:</strong> Works entirely in your browser</li>\n                  <li><strong>Fine-grained Control:</strong> Choose which repositories to access</li>\n                  <li><strong>Enhanced Security:</strong> Can be easily rotated and revoked</li>\n                  <li><strong>Privacy Focused:</strong> Your token never leaves your browser</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>🔒 Security:</strong> SGEX stores your token locally and never transmits it to any server.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'pat-setup-instructions': [\n        {\n          id: 'detailed-pat-setup',\n          title: 'Detailed PAT Setup Guide',\n          badge: '/sgex/cat-paw-lock-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Token Type Comparison',\n              content: `\n                <p>GitHub offers two types of Personal Access Tokens:</p>\n                <h4>Fine-grained Tokens (Recommended)</h4>\n                <ul>\n                  <li>Repository-specific access control</li>\n                  <li>Better security with minimal permissions</li>\n                  <li>More granular permission settings</li>\n                  <li>Shorter default expiration times</li>\n                </ul>\n                <h4>Classic Tokens</h4>\n                <ul>\n                  <li>Broader scope-based permissions</li>\n                  <li>Simpler permission model</li>\n                  <li>Longer expiration options</li>\n                  <li>Works with all GitHub integrations</li>\n                </ul>\n              `\n            }\n          ]\n        }\n      ],\n      'welcome': [\n        {\n          id: 'github-pat-setup',\n          title: 'How to Create a GitHub Personal Access Token',\n          badge: '/sgex/cat-paw-lock-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Step 1: Go to GitHub Settings',\n              content: `\n                <p>Navigate to your GitHub account settings:</p>\n                <ol>\n                  <li>Click your profile picture in the top right</li>\n                  <li>Select \"Settings\" from the dropdown</li>\n                  <li>Go to \"Developer settings\" → \"Personal access tokens\"</li>\n                  <li>Choose \"Fine-grained tokens\" (recommended) or \"Tokens (classic)\"</li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> Fine-grained tokens provide better security with repository-specific access.\n                </div>\n              `\n            },\n            {\n              title: 'Step 2: Generate New Token',\n              content: `\n                <p>Create your new token:</p>\n                <ol>\n                  <li>Click \"Generate new token\"</li>\n                  <li>Give it a descriptive name like \"SGEX Workbench\"</li>\n                  <li>Set expiration (90 days recommended)</li>\n                  <li>Select repository access (specific repos or all)</li>\n                </ol>\n                <div class=\"help-warning\">\n                  <strong>⚠️ Important:</strong> You'll only see the token once, so copy it immediately!\n                </div>\n              `\n            },\n            {\n              title: 'Step 3: Set Required Permissions',\n              content: `\n                <p>For <strong>fine-grained tokens</strong>, enable:</p>\n                <ul>\n                  <li><strong>Contents:</strong> Read and Write</li>\n                  <li><strong>Metadata:</strong> Read</li>\n                  <li><strong>Pull requests:</strong> Read and Write</li>\n                </ul>\n                <p>For <strong>classic tokens</strong>, select:</p>\n                <ul>\n                  <li><strong>repo</strong> - Full control of private repositories</li>\n                  <li><strong>read:org</strong> - Read org and team membership</li>\n                </ul>\n              `\n            },\n            {\n              title: 'Step 4: Use Your Token',\n              content: `\n                <p>Now you can authenticate with SGEX:</p>\n                <ol>\n                  <li>Copy your newly generated token</li>\n                  <li>Paste it into the login form</li>\n                  <li>Click \"Sign in with Personal Access Token\"</li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>🔒 Security:</strong> Your token is stored securely in your browser and never shared with servers.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'dak-configuration': [\n        {\n          id: 'dak-configuration-guide',\n          title: 'Configuring Your DAK',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Understanding DAK Configuration',\n              content: `\n                <p>When creating a new DAK, you need to configure both repository and FHIR settings:</p>\n                <h4>Repository Configuration</h4>\n                <ul>\n                  <li><strong>Repository Name:</strong> GitHub repository identifier (lowercase with hyphens)</li>\n                  <li><strong>Description:</strong> Brief description of your DAK's purpose</li>\n                  <li><strong>Topics:</strong> Tags that help others discover your DAK</li>\n                  <li><strong>Visibility:</strong> Public repositories are discoverable by the community</li>\n                </ul>\n                <h4>FHIR Implementation Guide Settings</h4>\n                <ul>\n                  <li><strong>IG ID:</strong> Unique identifier for your Implementation Guide</li>\n                  <li><strong>Name:</strong> Technical name used in code generation</li>\n                  <li><strong>Title:</strong> Human-readable title for documentation</li>\n                  <li><strong>Publisher:</strong> Organization responsible for the DAK</li>\n                </ul>\n              `\n            }\n          ]\n        }\n      ],\n      'core-data-dictionary-viewer': [\n        {\n          id: 'core-data-dictionary-help',\n          title: 'Understanding Core Data Dictionary',\n          badge: '/sgex/cat-paw-info-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'What is the Core Data Dictionary?',\n              content: `\n                <p>The Core Data Dictionary (Component 2) contains the data elements required throughout the different points of the workflow. These data elements are mapped to the International Classification of Diseases version 11 (ICD-11) codes and other established concept mapping standards to ensure the data dictionary is compatible with other digital systems.</p>\n                <h4>Purpose: System Design and Interoperability</h4>\n                <p>To know which data elements need to be logged and how they map to other standard terminologies (e.g. ICD, Systematized Nomenclature of Medicine [SNOMED]) for interoperability with other standards-based systems.</p>\n                <h4>FHIR FSH Source Files</h4>\n                <ul>\n                  <li><strong>CodeSystems:</strong> Define custom codes and concepts used in your DAK</li>\n                  <li><strong>ValueSets:</strong> Specify allowed values for clinical data elements</li>\n                  <li><strong>ConceptMaps:</strong> Map between different terminology systems including ICD-11 and SNOMED</li>\n                  <li><strong>Logical Models:</strong> Define data structures for clinical workflows</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Location:</strong> FSH files are stored in the <code>input/fsh/</code> directory of your repository.\n                </div>\n              `\n            },\n            {\n              title: 'GitHub Pages Integration',\n              content: `\n                <p>When GitHub Pages is configured, your FSH files are automatically compiled into HTML documentation:</p>\n                <h4>Published Artifacts</h4>\n                <ul>\n                  <li><strong>Code Systems:</strong> Browse and search your custom terminologies</li>\n                  <li><strong>Value Sets:</strong> View allowed values with descriptions</li>\n                  <li><strong>Logical Models:</strong> Interactive data structure documentation</li>\n                  <li><strong>Concept Maps:</strong> Visual mapping between terminologies</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>⚡ URL Pattern:</strong> Main branch publishes to <code>user.github.io/repo</code>, feature branches to <code>user.github.io/repo/branches/branch-name</code>\n                </div>\n              `\n            }\n          ]\n        },\n        {\n          id: 'github-pages-setup',\n          title: 'Setting Up GitHub Pages',\n          badge: '/sgex/cat-paw-settings-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Enable GitHub Pages for Your DAK',\n              content: `\n                <p>Follow these steps to enable automatic publishing of your Implementation Guide:</p>\n                <h4>Step 1: Repository Settings</h4>\n                <ol>\n                  <li>Go to your repository on GitHub</li>\n                  <li>Click on the <strong>Settings</strong> tab</li>\n                  <li>Scroll down to <strong>Pages</strong> in the left sidebar</li>\n                  <li>Under <strong>Source</strong>, select <strong>GitHub Actions</strong></li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>📋 Note:</strong> Your repository must contain a valid FHIR Implementation Guide structure with <code>sushi-config.yaml</code>\n                </div>\n              `\n            },\n            {\n              title: 'Configure IG Publisher Workflow',\n              content: `\n                <p>Set up the automated publishing workflow:</p>\n                <h4>Step 2: GitHub Actions</h4>\n                <ol>\n                  <li>Create <code>.github/workflows/</code> directory in your repository</li>\n                  <li>Add an IG Publisher workflow file (e.g., <code>publish.yml</code>)</li>\n                  <li>Configure the workflow to run on push to main branch</li>\n                  <li>Include steps to build and deploy the Implementation Guide</li>\n                </ol>\n                <h4>Step 3: Verify Publishing</h4>\n                <ul>\n                  <li>Check the <strong>Actions</strong> tab for workflow status</li>\n                  <li>Once successful, visit your GitHub Pages URL</li>\n                  <li>Verify that artifacts are accessible from the Core Data Dictionary viewer</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>🔗 Reference:</strong> See the <a href=\"https://smart.who.int/ig-starter-kit/v1.0.0/ig_setup.html#ghpages-build\" target=\"_blank\">WHO IG Starter Kit</a> for detailed setup instructions.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'business-process-selection': [\n        {\n          id: 'business-process-help',\n          title: 'Understanding Business Processes',\n          badge: '/sgex/cat-paw-workflow-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'What are Business Processes?',\n              content: `\n                <p>Business Processes (Component 5) define the clinical workflows and care processes in your DAK:</p>\n                <h4>BPMN 2.0 Diagrams</h4>\n                <ul>\n                  <li><strong>Clinical Workflows:</strong> Step-by-step patient care processes</li>\n                  <li><strong>Decision Points:</strong> Where clinical decisions are made</li>\n                  <li><strong>Task Assignments:</strong> Who performs each step in the workflow</li>\n                  <li><strong>Data Flows:</strong> How information moves through the process</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Standard:</strong> Uses BPMN 2.0 (Business Process Model and Notation) for workflow modeling\n                </div>\n              `\n            },\n            {\n              title: 'Working with BPMN Files',\n              content: `\n                <p>Business process diagrams are stored as BPMN XML files in your repository:</p>\n                <h4>File Management</h4>\n                <ul>\n                  <li><strong>Location:</strong> Typically stored in <code>input/models/</code> or <code>input/bpmn/</code></li>\n                  <li><strong>Format:</strong> BPMN 2.0 XML standard format</li>\n                  <li><strong>Editing:</strong> Use the built-in BPMN editor or external tools</li>\n                  <li><strong>Validation:</strong> Automatic validation against BPMN 2.0 schema</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>🔧 Tools:</strong> SGeX includes an integrated BPMN editor for creating and modifying workflow diagrams\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'pages-manager': [\n        {\n          id: 'page-content-help',\n          title: 'Managing Page Content',\n          badge: '/sgex/cat-paw-document-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'What is Page Content?',\n              content: `\n                <p>Page Content represents the narrative documentation and educational materials in your DAK:</p>\n                <h4>Content Types</h4>\n                <ul>\n                  <li><strong>Clinical Guidelines:</strong> Evidence-based care recommendations</li>\n                  <li><strong>User Guides:</strong> Instructions for healthcare workers</li>\n                  <li><strong>Training Materials:</strong> Educational content and scenarios</li>\n                  <li><strong>Reference Documentation:</strong> Technical specifications and background</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Format:</strong> Content is typically authored in Markdown format for easy editing and version control\n                </div>\n              `\n            },\n            {\n              title: 'Content Organization',\n              content: `\n                <p>Page content is organized to support different user needs and workflows:</p>\n                <h4>Structure</h4>\n                <ul>\n                  <li><strong>Pages Directory:</strong> Main content files organized by topic</li>\n                  <li><strong>Assets:</strong> Images, diagrams, and multimedia content</li>\n                  <li><strong>Templates:</strong> Reusable content patterns and layouts</li>\n                  <li><strong>Navigation:</strong> Menus and linking between related content</li>\n                </ul>\n                <h4>Publishing</h4>\n                <ul>\n                  <li><strong>GitHub Pages:</strong> Automatic publishing of content as web pages</li>\n                  <li><strong>FHIR IG:</strong> Integration with Implementation Guide publishing</li>\n                  <li><strong>Version Control:</strong> Track changes and collaborate on content</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>📝 Best Practice:</strong> Use clear headings, bullet points, and visual elements to make content accessible to healthcare workers\n                </div>\n              `\n            }\n          ]\n        }\n      ]\n    };\n  }\n\n  // Get help topics for a specific page\n  getHelpTopicsForPage(pageId, contextData = {}) {\n    const pageTopics = this.helpTopics[pageId] || [];\n    const universalTopics = this.getUniversalTopics(contextData);\n    return [...pageTopics, ...universalTopics];\n  }\n\n  // Get universal topics based on context (e.g., if DAK is selected)\n  getUniversalTopics(contextData = {}) {\n    const topics = [\n      this.universalTopics.documentation,\n      this.universalTopics.bugReport\n    ];\n    \n    // Add DAK feedback if we have DAK context\n    if (contextData.selectedDak || contextData.repository) {\n      topics.push(this.universalTopics.dakFeedback);\n    }\n    \n    return topics;\n  }\n\n  // Get a specific help topic by ID\n  getHelpTopic(topicId) {\n    for (const pageTopics of Object.values(this.helpTopics)) {\n      const topic = pageTopics.find(t => t.id === topicId);\n      if (topic) {\n        return topic;\n      }\n    }\n    return null;\n  }\n\n  // Check if a page has help topics (now always true since we have universal topics)\n  hasHelpTopics(pageId, contextData = {}) {\n    return true; // Always true now due to universal topics\n  }\n\n  // Add a help topic to a page\n  addHelpTopicToPage(pageId, helpTopic) {\n    if (!this.helpTopics[pageId]) {\n      this.helpTopics[pageId] = [];\n    }\n    this.helpTopics[pageId].push(helpTopic);\n  }\n\n  // Get all available page IDs that have help content\n  getAvailablePages() {\n    return Object.keys(this.helpTopics);\n  }\n\n  // Helper method to open DAK-specific issues\n  openDakIssue(issueType, dakRepository) {\n    if (!dakRepository) {\n      console.warn('No DAK repository specified for feedback');\n      return;\n    }\n\n    const baseUrl = `https://github.com/${dakRepository.owner}/${dakRepository.name}/issues/new`;\n    let url = baseUrl;\n\n    switch (issueType) {\n      case 'bug':\n        url += '?template=bug_report.md&labels=bug,dak-issue';\n        break;\n      case 'improvement':\n        url += '?template=feature_request.md&labels=enhancement,dak-improvement';\n        break;\n      case 'content':\n        url += '?labels=content-issue,clinical-content';\n        break;\n      case 'question':\n        url += '?template=question.md&labels=question,dak-question';\n        break;\n      default:\n        url += '?labels=dak-feedback';\n    }\n\n    window.open(url, '_blank');\n  }\n}\n\n// Create and export a singleton instance\nconst helpContentService = new HelpContentService();\nexport default helpContentService;","/**\n * Profile Subscription Service - Manages profile subscriptions in localStorage\n * \n * Provides functionality to manage profile subscriptions:\n * - Always includes WorldHealthOrganization\n * - Includes logged-in user when authenticated\n * - Auto-adds users when browsing their profiles\n * - Allows removal of profiles (except WHO and current user)\n */\nclass ProfileSubscriptionService {\n  constructor() {\n    this.storageKey = 'sgex-profile-subscriptions';\n    this.whoProfile = 'WorldHealthOrganization';\n  }\n\n  /**\n   * Get profile subscriptions from localStorage\n   * @returns {Array} Array of profile objects\n   */\n  getSubscriptions() {\n    try {\n      const stored = localStorage.getItem(this.storageKey);\n      const subscriptions = stored ? JSON.parse(stored) : [];\n      \n      // Always ensure WHO is included\n      if (!subscriptions.find(profile => profile.login === this.whoProfile)) {\n        subscriptions.unshift({\n          login: this.whoProfile,\n          name: 'World Health Organization',\n          avatar_url: `https://github.com/${this.whoProfile}.png`,\n          type: 'Organization',\n          isPermanent: true,\n          addedAt: new Date().toISOString()\n        });\n        this.saveSubscriptions(subscriptions);\n      }\n      \n      return subscriptions;\n    } catch (error) {\n      console.warn('Error reading profile subscriptions from localStorage:', error);\n      // Return minimal default with WHO\n      return [{\n        login: this.whoProfile,\n        name: 'World Health Organization',\n        avatar_url: `https://github.com/${this.whoProfile}.png`,\n        type: 'Organization',\n        isPermanent: true,\n        addedAt: new Date().toISOString()\n      }];\n    }\n  }\n\n  /**\n   * Save profile subscriptions to localStorage\n   * @param {Array} subscriptions - Array of profile objects\n   */\n  saveSubscriptions(subscriptions) {\n    try {\n      localStorage.setItem(this.storageKey, JSON.stringify(subscriptions));\n    } catch (error) {\n      console.error('Error saving profile subscriptions to localStorage:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Add a profile to subscriptions\n   * @param {Object} profile - Profile object with login, name, avatar_url, type\n   * @param {boolean} isPermanent - Whether the profile cannot be removed\n   * @returns {Object} The added profile\n   */\n  addSubscription(profile, isPermanent = false) {\n    if (!profile || !profile.login) {\n      throw new Error('Profile must have a login property');\n    }\n\n    const subscriptions = this.getSubscriptions();\n    \n    // Check if already subscribed\n    const existingIndex = subscriptions.findIndex(p => p.login === profile.login);\n    if (existingIndex !== -1) {\n      // Update existing subscription\n      subscriptions[existingIndex] = {\n        ...subscriptions[existingIndex],\n        ...profile,\n        isPermanent: subscriptions[existingIndex].isPermanent || isPermanent,\n        lastUpdated: new Date().toISOString()\n      };\n      this.saveSubscriptions(subscriptions);\n      return subscriptions[existingIndex];\n    }\n\n    // Add new subscription\n    const newSubscription = {\n      login: profile.login,\n      name: profile.name || profile.login,\n      avatar_url: profile.avatar_url || `https://github.com/${profile.login}.png`,\n      type: profile.type || 'User',\n      isPermanent,\n      addedAt: new Date().toISOString(),\n      lastUpdated: new Date().toISOString()\n    };\n\n    subscriptions.push(newSubscription);\n    this.saveSubscriptions(subscriptions);\n    return newSubscription;\n  }\n\n  /**\n   * Remove a profile from subscriptions\n   * @param {string} login - Login/username to remove\n   * @returns {boolean} Success status\n   */\n  removeSubscription(login) {\n    if (!login) {\n      return false;\n    }\n\n    try {\n      const subscriptions = this.getSubscriptions();\n      const profileIndex = subscriptions.findIndex(p => p.login === login);\n      \n      if (profileIndex === -1) {\n        return false; // Profile not found\n      }\n\n      const profile = subscriptions[profileIndex];\n      \n      // Cannot remove permanent profiles (WHO, current user)\n      if (profile.isPermanent) {\n        console.warn(`Cannot remove permanent profile: ${login}`);\n        return false;\n      }\n\n      subscriptions.splice(profileIndex, 1);\n      this.saveSubscriptions(subscriptions);\n      return true;\n    } catch (error) {\n      console.error('Error removing profile subscription:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Check if a profile is subscribed\n   * @param {string} login - Login/username to check\n   * @returns {boolean} Whether the profile is subscribed\n   */\n  isSubscribed(login) {\n    if (!login) return false;\n    const subscriptions = this.getSubscriptions();\n    return subscriptions.some(p => p.login === login);\n  }\n\n  /**\n   * Get a specific subscription by login\n   * @param {string} login - Login/username to find\n   * @returns {Object|null} Profile object or null if not found\n   */\n  getSubscription(login) {\n    if (!login) return null;\n    const subscriptions = this.getSubscriptions();\n    return subscriptions.find(p => p.login === login) || null;\n  }\n\n  /**\n   * Auto-add current user to subscriptions (when logged in)\n   * @param {Object} userProfile - Current user's profile\n   */\n  ensureCurrentUserSubscribed(userProfile) {\n    if (!userProfile || !userProfile.login) {\n      return;\n    }\n\n    const existing = this.getSubscription(userProfile.login);\n    if (!existing) {\n      this.addSubscription({\n        ...userProfile,\n        isPermanent: true // Current user cannot be removed\n      }, true);\n    } else if (!existing.isPermanent) {\n      // Update existing to be permanent\n      this.addSubscription({\n        ...existing,\n        ...userProfile,\n        isPermanent: true\n      }, true);\n    }\n  }\n\n  /**\n   * Auto-add a visited user profile (from browsing)\n   * @param {Object} visitedProfile - Profile that user is browsing\n   */\n  autoAddVisitedProfile(visitedProfile) {\n    if (!visitedProfile || !visitedProfile.login) {\n      return;\n    }\n\n    // Don't auto-add if already subscribed\n    if (this.isSubscribed(visitedProfile.login)) {\n      return;\n    }\n\n    // Don't auto-add demo profiles\n    if (visitedProfile.isDemo) {\n      return;\n    }\n\n    this.addSubscription(visitedProfile, false);\n  }\n\n  /**\n   * Get subscriptions sorted alphabetically by name\n   * @returns {Array} Sorted array of profile objects\n   */\n  getSubscriptionsSorted() {\n    const subscriptions = this.getSubscriptions();\n    return subscriptions.sort((a, b) => {\n      // WHO always first\n      if (a.login === this.whoProfile) return -1;\n      if (b.login === this.whoProfile) return 1;\n      \n      // Then sort by name/login\n      const nameA = a.name || a.login;\n      const nameB = b.name || b.login;\n      return nameA.localeCompare(nameB);\n    });\n  }\n\n  /**\n   * Get subscriptions for profile selection (formatted for UI)\n   * @returns {Array} Array of profile objects formatted for selection UI\n   */\n  getSubscriptionsForSelection() {\n    return this.getSubscriptionsSorted().map(profile => ({\n      ...profile,\n      displayName: profile.name || profile.login,\n      isRemovable: !profile.isPermanent\n    }));\n  }\n\n  /**\n   * Update subscription with latest profile information\n   * @param {string} login - Login/username to update\n   * @param {Object} updatedProfile - Updated profile information\n   * @returns {boolean} Success status\n   */\n  updateSubscription(login, updatedProfile) {\n    if (!login || !updatedProfile) {\n      return false;\n    }\n\n    try {\n      const subscriptions = this.getSubscriptions();\n      const index = subscriptions.findIndex(p => p.login === login);\n      \n      if (index === -1) {\n        return false;\n      }\n\n      subscriptions[index] = {\n        ...subscriptions[index],\n        ...updatedProfile,\n        login, // Preserve original login\n        lastUpdated: new Date().toISOString()\n      };\n\n      this.saveSubscriptions(subscriptions);\n      return true;\n    } catch (error) {\n      console.error('Error updating subscription:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear all subscriptions (except WHO)\n   */\n  clearSubscriptions() {\n    try {\n      const whoProfile = {\n        login: this.whoProfile,\n        name: 'World Health Organization',\n        avatar_url: `https://github.com/${this.whoProfile}.png`,\n        type: 'Organization',\n        isPermanent: true,\n        addedAt: new Date().toISOString()\n      };\n      this.saveSubscriptions([whoProfile]);\n    } catch (error) {\n      console.error('Error clearing subscriptions:', error);\n    }\n  }\n\n  /**\n   * Export subscriptions as JSON\n   * @returns {string} JSON string of subscriptions\n   */\n  exportSubscriptions() {\n    const subscriptions = this.getSubscriptions();\n    return JSON.stringify(subscriptions, null, 2);\n  }\n\n  /**\n   * Import subscriptions from JSON\n   * @param {string} jsonString - JSON string of subscriptions\n   * @param {boolean} merge - Whether to merge with existing subscriptions\n   * @returns {boolean} Success status\n   */\n  importSubscriptions(jsonString, merge = false) {\n    try {\n      const importedSubscriptions = JSON.parse(jsonString);\n      \n      if (!Array.isArray(importedSubscriptions)) {\n        throw new Error('Invalid subscription format');\n      }\n\n      let finalSubscriptions;\n      \n      if (merge) {\n        const existingSubscriptions = this.getSubscriptions();\n        const mergedSubscriptions = [...existingSubscriptions];\n        \n        importedSubscriptions.forEach(imported => {\n          const existingIndex = mergedSubscriptions.findIndex(p => p.login === imported.login);\n          if (existingIndex !== -1) {\n            // Preserve permanence of existing subscriptions\n            mergedSubscriptions[existingIndex] = {\n              ...imported,\n              isPermanent: mergedSubscriptions[existingIndex].isPermanent || imported.isPermanent\n            };\n          } else {\n            mergedSubscriptions.push(imported);\n          }\n        });\n        \n        finalSubscriptions = mergedSubscriptions;\n      } else {\n        finalSubscriptions = importedSubscriptions;\n      }\n\n      // Ensure WHO is always included\n      if (!finalSubscriptions.find(p => p.login === this.whoProfile)) {\n        finalSubscriptions.unshift({\n          login: this.whoProfile,\n          name: 'World Health Organization',\n          avatar_url: `https://github.com/${this.whoProfile}.png`,\n          type: 'Organization',\n          isPermanent: true,\n          addedAt: new Date().toISOString()\n        });\n      }\n      \n      this.saveSubscriptions(finalSubscriptions);\n      return true;\n    } catch (error) {\n      console.error('Error importing subscriptions:', error);\n      return false;\n    }\n  }\n}\n\n// Create and export singleton instance\nconst profileSubscriptionService = new ProfileSubscriptionService();\nexport default profileSubscriptionService;","import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { useParams, useLocation, useNavigate } from 'react-router-dom';\nimport githubService from '../../services/githubService';\nimport dakValidationService from '../../services/dakValidationService';\nimport profileSubscriptionService from '../../services/profileSubscriptionService';\n\n/**\n * Page types supported by the framework\n */\nexport const PAGE_TYPES = {\n  TOP_LEVEL: 'top-level',\n  USER: 'user', \n  DAK: 'dak',\n  ASSET: 'asset'\n};\n\n/**\n * Context for page framework\n */\nconst PageContext = createContext(null);\n\n/**\n * Hook to use page context\n */\nexport const usePage = () => {\n  const context = useContext(PageContext);\n  if (!context) {\n    console.error('usePage: PageContext is null - component not wrapped in PageProvider');\n    // Return a default context instead of throwing to make ErrorHandler more resilient\n    return {\n      pageName: 'unknown',\n      user: null,\n      profile: null,\n      repository: null,\n      branch: null,\n      asset: null,\n      type: 'top-level',\n      loading: false,\n      error: null,\n      isAuthenticated: false,\n      navigate: () => {},\n      params: {},\n      location: { pathname: '/' }\n    };\n  }\n  return context;\n};\n\n/**\n * Determine page type from URL parameters\n */\nconst determinePageType = (params) => {\n  const { user, repo } = params;\n  const asset = params['*']; // Wildcard parameter for asset path\n  \n  if (asset) return PAGE_TYPES.ASSET;\n  if (user && repo) return PAGE_TYPES.DAK;\n  if (user) return PAGE_TYPES.USER;\n  return PAGE_TYPES.TOP_LEVEL;\n};\n\n/**\n * Provider component for page framework\n */\nexport const PageProvider = ({ children, pageName }) => {\n  const params = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  \n  const [pageState, setPageState] = useState({\n    type: determinePageType(params),\n    pageName,\n    loading: false,\n    error: null,\n    user: null,\n    profile: null,\n    repository: null,\n    branch: null,\n    asset: null,\n    isAuthenticated: githubService.isAuth()\n  });\n\n  // Extract URL parameters\n  const { user, repo } = params;\n  const asset = params['*']; // Wildcard parameter for asset path\n\n  // Load data based on page type\n  useEffect(() => {\n    const loadPageData = async () => {\n      try {\n        setPageState(prev => ({ ...prev, loading: true, error: null }));\n\n        // Use location state if available, otherwise fetch from URL params\n        let profile = location.state?.profile;\n        let repository = location.state?.repository;\n        let selectedBranch = location.state?.selectedBranch || params.branch;\n\n        // For DAK and Asset pages, validate and fetch data\n        if (pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n          if (!profile && user) {\n            if (githubService.isAuth()) {\n              try {\n                profile = await githubService.getUser(user);\n              } catch (err) {\n                // For dashboard pages, set error state instead of redirecting\n                if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                  setPageState(prev => ({\n                    ...prev,\n                    loading: false,\n                    error: `User '${user}' not found or not accessible. Please check the username and try again.`,\n                    user,\n                    // Still set available URL parameters for context\n                    repository: repo ? { name: repo, owner: { login: user }, html_url: `https://github.com/${user}/${repo}`, isNotFound: true } : null,\n                    branch: params.branch || 'main'\n                  }));\n                  return;\n                }\n                throw new Error(`User '${user}' not found or not accessible.`);\n              }\n            } else {\n              // Demo mode for DAK validation\n              const isValidDAK = dakValidationService.validateDemoDAKRepository(user, repo);\n              if (!isValidDAK) {\n                // For dashboard pages, set error state instead of redirecting\n                if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                  setPageState(prev => ({\n                    ...prev,\n                    loading: false,\n                    error: `Repository '${user}/${repo}' not found or not accessible. This may be a private repository or the repository doesn't exist.`,\n                    user,\n                    profile: {\n                      login: user,\n                      name: user.charAt(0).toUpperCase() + user.slice(1),\n                      avatar_url: `https://github.com/${user}.png`,\n                      type: 'User',\n                      isDemo: true\n                    },\n                    repository: { name: repo, owner: { login: user }, html_url: `https://github.com/${user}/${repo}`, isNotFound: true },\n                    branch: params.branch || 'main'\n                  }));\n                  return;\n                }\n                throw new Error(`Repository '${user}/${repo}' not found or not accessible.`);\n              }\n              profile = {\n                login: user,\n                name: user.charAt(0).toUpperCase() + user.slice(1),\n                avatar_url: `https://github.com/${user}.png`,\n                type: 'User',\n                isDemo: true\n              };\n            }\n          }\n\n          if (!repository && user && repo) {\n            if (githubService.isAuth()) {\n              try {\n                repository = await githubService.getRepository(user, repo);\n                // Validate it's a DAK repository\n                const isValidDAK = await dakValidationService.validateDAKRepository(user, repo, selectedBranch || repository.default_branch);\n                if (!isValidDAK) {\n                  // For dashboard pages, set error state instead of redirecting\n                  if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                    setPageState(prev => ({\n                      ...prev,\n                      loading: false,\n                      error: `Repository '${user}/${repo}' is not a valid DAK repository. This repository may not contain WHO SMART Guidelines content.`,\n                      user,\n                      profile,\n                      repository: { ...repository, isInvalidDAK: true },\n                      branch: selectedBranch || repository.default_branch\n                    }));\n                    return;\n                  }\n                  throw new Error(`Repository '${user}/${repo}' is not a valid DAK repository.`);\n                }\n              } catch (err) {\n                // For dashboard pages, set error state instead of redirecting\n                if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                  setPageState(prev => ({\n                    ...prev,\n                    loading: false,\n                    error: `Repository '${user}/${repo}' not found or not accessible. Please check the repository name and your access permissions.`,\n                    user,\n                    profile,\n                    repository: { name: repo, owner: { login: user }, html_url: `https://github.com/${user}/${repo}`, isNotFound: true },\n                    branch: selectedBranch || 'main'\n                  }));\n                  return;\n                }\n                throw new Error(`Repository '${user}/${repo}' not found or not accessible.`);\n              }\n            } else {\n              // For demo mode, validate the demo repository exists\n              const isValidDAK = dakValidationService.validateDemoDAKRepository(user, repo);\n              if (!isValidDAK) {\n                // For dashboard pages, set error state instead of redirecting\n                if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                  setPageState(prev => ({\n                    ...prev,\n                    loading: false,\n                    error: `Repository '${user}/${repo}' not found or not accessible. This may be a private repository or the repository doesn't exist.`,\n                    user,\n                    profile: {\n                      login: user,\n                      name: user.charAt(0).toUpperCase() + user.slice(1),\n                      avatar_url: `https://github.com/${user}.png`,\n                      type: 'User',\n                      isDemo: true\n                    },\n                    repository: { name: repo, owner: { login: user }, html_url: `https://github.com/${user}/${repo}`, isNotFound: true },\n                    branch: selectedBranch || 'main'\n                  }));\n                  return;\n                }\n                throw new Error(`Repository '${user}/${repo}' not found or not accessible.`);\n              }\n              \n              repository = {\n                name: repo,\n                full_name: `${user}/${repo}`,\n                owner: { login: user },\n                default_branch: selectedBranch || 'main',\n                html_url: `https://github.com/${user}/${repo}`,\n                isDemo: true\n              };\n            }\n          }\n\n          selectedBranch = selectedBranch || repository?.default_branch || 'main';\n\n          // For asset pages, validate the asset exists (when authenticated or public repo)\n          if (pageState.type === PAGE_TYPES.ASSET && asset) {\n            try {\n              await githubService.getFileContent(user, repo, asset, selectedBranch);\n            } catch (err) {\n              // For asset pages, set error state instead of redirecting  \n              if (pageName === 'asset' || pageName.includes('editor') || pageName.includes('viewer')) {\n                setPageState(prev => ({\n                  ...prev,\n                  loading: false,\n                  error: `Asset '${asset}' not found in repository '${user}/${repo}'. The file may have been moved or deleted.`,\n                  user,\n                  profile,\n                  repository,\n                  branch: selectedBranch,\n                  asset\n                }));\n                return;\n              }\n              throw new Error(`Asset '${asset}' not found in repository.`);\n            }\n          }\n        }\n\n        // For User pages, just need profile\n        if (pageState.type === PAGE_TYPES.USER && !profile && user) {\n          if (githubService.isAuth()) {\n            try {\n              profile = await githubService.getUser(user);\n            } catch (err) {\n              // For user pages, set error state instead of redirecting\n              setPageState(prev => ({\n                ...prev,\n                loading: false,\n                error: `User '${user}' not found or not accessible. Please check the username and try again.`,\n                user\n              }));\n              return;\n            }\n          } else {\n            profile = {\n              login: user,\n              name: user.charAt(0).toUpperCase() + user.slice(1),\n              avatar_url: `https://github.com/${user}.png`,\n              type: 'User',\n              isDemo: true\n            };\n          }\n        }\n\n        setPageState(prev => ({\n          ...prev,\n          loading: false,\n          user,\n          profile,\n          repository,\n          branch: selectedBranch,\n          asset,\n          isAuthenticated: githubService.isAuth()\n        }));\n\n        // Handle profile subscriptions asynchronously\n        const handleSubscriptions = async () => {\n          try {\n            const currentUser = await githubService.getCurrentUser();\n            if (currentUser) {\n              profileSubscriptionService.ensureCurrentUserSubscribed(currentUser);\n            }\n          } catch (error) {\n            // Current user fetch failed, but continue with visited profile logic\n            console.debug('Could not fetch current user for subscriptions:', error);\n          }\n\n          // Auto-add visited profiles (if not demo and not already subscribed)\n          if (profile && !profile.isDemo && (pageState.type === PAGE_TYPES.USER || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET)) {\n            profileSubscriptionService.autoAddVisitedProfile(profile);\n          }\n        };\n\n        // Run subscription logic without blocking the main page load\n        if (githubService.isAuth()) {\n          handleSubscriptions();\n        }\n\n      } catch (error) {\n        console.error('Page data loading error:', error);\n        setPageState(prev => ({\n          ...prev,\n          loading: false,\n          error: error.message\n        }));\n      }\n    };\n\n    // Only load data if we have URL parameters that require it\n    if ((pageState.type !== PAGE_TYPES.TOP_LEVEL && user) || pageState.type === PAGE_TYPES.TOP_LEVEL) {\n      loadPageData();\n    }\n  }, [user, repo, params.branch, asset, pageState.type, location.state, navigate, pageName]);\n\n  // Monitor authentication state changes\n  useEffect(() => {\n    const checkAuthState = () => {\n      const currentAuthState = githubService.isAuth();\n      if (currentAuthState !== pageState.isAuthenticated) {\n        setPageState(prev => ({\n          ...prev,\n          isAuthenticated: currentAuthState\n        }));\n      }\n    };\n\n    // Check periodically for auth state changes (for logout detection)\n    const interval = setInterval(checkAuthState, 1000);\n    \n    return () => clearInterval(interval);\n  }, [pageState.isAuthenticated]);\n\n  const value = {\n    ...pageState,\n    navigate,\n    params,\n    location\n  };\n\n  return (\n    <PageContext.Provider value={value}>\n      {children}\n    </PageContext.Provider>\n  );\n};","/**\n * Utility function to get the appropriate image path based on the current theme\n * This can be used outside React components\n * @param {string} baseImagePath - The base image path (e.g., \"sgex-mascot.png\")\n * @returns {string} The theme-appropriate image path\n */\nexport const getThemeImagePath = (baseImagePath) => {\n  const isDarkMode = document.body.classList.contains('theme-dark');\n  \n  // Get the correct base path for the deployment environment\n  const publicUrl = process.env.PUBLIC_URL || '';\n  \n  // Normalize the base image path (remove leading slash if present)\n  const normalizedPath = baseImagePath.startsWith('/') ? baseImagePath.slice(1) : baseImagePath;\n  \n  let finalPath;\n  if (isDarkMode) {\n    // Convert base image to dark mode version\n    // e.g., \"sgex-mascot.png\" -> \"sgex-mascot_grey_tabby.png\"\n    const darkImageName = normalizedPath.replace(/\\.png$/, '_grey_tabby.png');\n    finalPath = publicUrl ? `${publicUrl}/${darkImageName}` : `/${darkImageName}`;\n  } else {\n    // Use original image for light mode\n    finalPath = publicUrl ? `${publicUrl}/${normalizedPath}` : `/${normalizedPath}`;\n  }\n  \n  return finalPath;\n};\n\nexport default getThemeImagePath;","/**\n * User Access Service\n * \n * Manages user types and access levels throughout the SGEX Workbench.\n * Supports three user types: authenticated, unauthenticated, and demo users.\n */\n\nimport githubService from './githubService';\nimport logger from '../utils/logger';\nimport { getThemeImagePath } from '../utils/themeUtils';\n\n/**\n * User types supported by the access framework\n */\nexport const USER_TYPES = {\n  AUTHENTICATED: 'authenticated',\n  UNAUTHENTICATED: 'unauthenticated', \n  DEMO: 'demo'\n};\n\n/**\n * Access levels for different operations\n */\nexport const ACCESS_LEVELS = {\n  READ: 'read',\n  WRITE: 'write',\n  NONE: 'none'\n};\n\nclass UserAccessService {\n  constructor() {\n    this.logger = logger.getLogger('UserAccessService');\n    this.currentUser = null;\n    this.userType = USER_TYPES.UNAUTHENTICATED;\n    this.permissions = new Map();\n    this.listeners = new Set();\n  }\n\n  /**\n   * Initialize user access service\n   */\n  async initialize() {\n    this.logger.info('Initializing user access service');\n    await this.detectUserType();\n    this.notifyListeners();\n  }\n\n  /**\n   * Detect current user type based on authentication state\n   */\n  async detectUserType() {\n    try {\n      if (githubService.isAuth()) {\n        // Check if this is a demo user (has demo DAKs configured)\n        const isDemoUser = this.checkIfDemoUser();\n        \n        if (isDemoUser) {\n          this.userType = USER_TYPES.DEMO;\n          this.currentUser = await this.createDemoUser();\n        } else {\n          this.userType = USER_TYPES.AUTHENTICATED;\n          this.currentUser = await githubService.getCurrentUser();\n        }\n      } else {\n        this.userType = USER_TYPES.UNAUTHENTICATED;\n        this.currentUser = null;\n      }\n\n      this.logger.info('User type detected', { \n        userType: this.userType, \n        hasUser: !!this.currentUser \n      });\n    } catch (error) {\n      this.logger.error('Error detecting user type', { error: error.message });\n      // Fallback to unauthenticated\n      this.userType = USER_TYPES.UNAUTHENTICATED;\n      this.currentUser = null;\n    }\n  }\n\n  /**\n   * Check if current authenticated user should be treated as demo user\n   */\n  checkIfDemoUser() {\n    // Demo users are determined by having access to demo DAKs\n    // This can be configured via localStorage or environment variables\n    const demoMode = localStorage.getItem('sgex_demo_mode');\n    const envDemoMode = process.env.REACT_APP_DEMO_MODE;\n    \n    return demoMode === 'true' || envDemoMode === 'true';\n  }\n\n  /**\n   * Create demo user object with demo data\n   */\n  async createDemoUser() {\n    try {\n      const realUser = await githubService.getCurrentUser();\n      return {\n        ...realUser,\n        isDemo: true,\n        demoData: this.getDemoData()\n      };\n    } catch (error) {\n      // If we can't get real user, create a synthetic demo user\n      return {\n        login: 'demo-user',\n        name: 'Demo User',\n        avatar_url: getThemeImagePath('sgex-mascot.png'),\n        type: 'User',\n        isDemo: true,\n        demoData: this.getDemoData()\n      };\n    }\n  }\n\n  /**\n   * Get demo data and DAKs\n   */\n  getDemoData() {\n    return {\n      daks: [\n        {\n          owner: 'WHO',\n          repo: 'smart-anc',\n          name: 'Smart Antenatal Care',\n          description: 'Demo DAK for antenatal care guidelines'\n        },\n        {\n          owner: 'WHO', \n          repo: 'smart-tb',\n          name: 'Smart Tuberculosis',\n          description: 'Demo DAK for tuberculosis care guidelines'\n        }\n      ],\n      sampleAssets: {\n        'input/vocabulary/ValueSet-anc-care-codes.json': {\n          type: 'ValueSet',\n          description: 'Demo value set for antenatal care'\n        }\n      }\n    };\n  }\n\n  /**\n   * Get current user type\n   */\n  getUserType() {\n    return this.userType;\n  }\n\n  /**\n   * Get current user information\n   */\n  getCurrentUser() {\n    return this.currentUser;\n  }\n\n  /**\n   * Check if user is authenticated (includes demo users)\n   */\n  isAuthenticated() {\n    return this.userType === USER_TYPES.AUTHENTICATED || this.userType === USER_TYPES.DEMO;\n  }\n\n  /**\n   * Check if user is in demo mode\n   */\n  isDemoUser() {\n    return this.userType === USER_TYPES.DEMO;\n  }\n\n  /**\n   * Check if user is unauthenticated\n   */\n  isUnauthenticated() {\n    return this.userType === USER_TYPES.UNAUTHENTICATED;\n  }\n\n  /**\n   * Get access level for a specific repository and operation\n   */\n  async getRepositoryAccess(owner, repo, branch = 'main') {\n    const cacheKey = `${owner}/${repo}/${branch}`;\n    \n    // Check cache first\n    if (this.permissions.has(cacheKey)) {\n      return this.permissions.get(cacheKey);\n    }\n\n    let access = ACCESS_LEVELS.NONE;\n\n    try {\n      if (this.userType === USER_TYPES.UNAUTHENTICATED) {\n        // Unauthenticated users only get read access to public repos\n        access = ACCESS_LEVELS.READ;\n      } else if (this.userType === USER_TYPES.DEMO) {\n        // Demo users get read access to demo DAKs, but no write access\n        const isDemoDAK = this.isDemoDAK(owner, repo);\n        access = isDemoDAK ? ACCESS_LEVELS.READ : ACCESS_LEVELS.NONE;\n      } else if (this.userType === USER_TYPES.AUTHENTICATED) {\n        // Authenticated users get access based on GitHub permissions\n        const hasReadAccess = await this.checkGitHubReadAccess(owner, repo);\n        const hasWriteAccess = await this.checkGitHubWriteAccess(owner, repo);\n        \n        if (hasWriteAccess) {\n          access = ACCESS_LEVELS.WRITE;\n        } else if (hasReadAccess) {\n          access = ACCESS_LEVELS.READ;\n        }\n      }\n    } catch (error) {\n      this.logger.error('Error checking repository access', { \n        owner, repo, branch, error: error.message \n      });\n      // Default to read access on error for better UX\n      access = ACCESS_LEVELS.READ;\n    }\n\n    // Cache the result\n    this.permissions.set(cacheKey, access);\n    \n    this.logger.debug('Repository access determined', { \n      owner, repo, branch, access, userType: this.userType \n    });\n\n    return access;\n  }\n\n  /**\n   * Check if a repository is a demo DAK\n   */\n  isDemoDAK(owner, repo) {\n    if (!this.currentUser?.demoData?.daks) {\n      return false;\n    }\n    \n    return this.currentUser.demoData.daks.some(dak => \n      dak.owner === owner && dak.repo === repo\n    );\n  }\n\n  /**\n   * Check GitHub read access for authenticated users\n   */\n  async checkGitHubReadAccess(owner, repo) {\n    try {\n      await githubService.getRepository(owner, repo);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Check GitHub write access for authenticated users\n   */\n  async checkGitHubWriteAccess(owner, repo) {\n    try {\n      return await githubService.hasRepositoryWriteAccess(owner, repo);\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Check if user can save to GitHub for a specific repository\n   */\n  async canSaveToGitHub(owner, repo, branch = 'main') {\n    // Demo users and unauthenticated users never have GitHub write access\n    if (this.userType !== USER_TYPES.AUTHENTICATED) {\n      return false;\n    }\n\n    const access = await this.getRepositoryAccess(owner, repo, branch);\n    return access === ACCESS_LEVELS.WRITE;\n  }\n\n  /**\n   * Check if user can save to local storage (staging ground)\n   */\n  canSaveLocal() {\n    // All user types can save to local storage\n    return true;\n  }\n\n  /**\n   * Get UI behavior configuration for current user type\n   */\n  getUIBehavior() {\n    const behavior = {\n      showEditFeatures: true,\n      showSaveToGitHub: true,\n      showSaveLocal: true,\n      confirmBeforeSave: true,\n      allowCreateNew: true,\n      showAccessBadges: true\n    };\n\n    switch (this.userType) {\n      case USER_TYPES.UNAUTHENTICATED:\n        return {\n          ...behavior,\n          showEditFeatures: false,\n          showSaveToGitHub: false,\n          allowCreateNew: false\n        };\n      \n      case USER_TYPES.DEMO:\n        return {\n          ...behavior,\n          showSaveToGitHub: false, // Demo users see the UI but get blocked at save\n          allowCreateNew: false\n        };\n      \n      case USER_TYPES.AUTHENTICATED:\n        return behavior;\n      \n      default:\n        return {\n          ...behavior,\n          showEditFeatures: false,\n          showSaveToGitHub: false,\n          allowCreateNew: false\n        };\n    }\n  }\n\n  /**\n   * Get access badge information for a repository\n   */\n  async getAccessBadge(owner, repo, branch = 'main') {\n    const access = await this.getRepositoryAccess(owner, repo, branch);\n    \n    const badges = {\n      [ACCESS_LEVELS.WRITE]: {\n        text: 'Write Access',\n        icon: '✏️',\n        color: 'green',\n        description: 'You can edit and save changes to this repository'\n      },\n      [ACCESS_LEVELS.READ]: {\n        text: 'Read Only',\n        icon: '👁️',\n        color: 'blue', \n        description: 'You can view this repository but cannot save changes'\n      },\n      [ACCESS_LEVELS.NONE]: {\n        text: 'No Access',\n        icon: '🚫',\n        color: 'red',\n        description: 'You do not have access to this repository'\n      }\n    };\n\n    return badges[access] || badges[ACCESS_LEVELS.NONE];\n  }\n\n  /**\n   * Enable demo mode for current user\n   */\n  enableDemoMode() {\n    localStorage.setItem('sgex_demo_mode', 'true');\n    this.initialize(); // Re-initialize to update user type\n  }\n\n  /**\n   * Disable demo mode\n   */\n  disableDemoMode() {\n    localStorage.removeItem('sgex_demo_mode');\n    this.initialize(); // Re-initialize to update user type\n  }\n\n  /**\n   * Clear cached permissions\n   */\n  clearPermissionsCache() {\n    this.permissions.clear();\n    this.logger.debug('Permissions cache cleared');\n  }\n\n  /**\n   * Add listener for user access changes\n   */\n  addListener(callback) {\n    this.listeners.add(callback);\n    \n    // Return unsubscribe function\n    return () => {\n      this.listeners.delete(callback);\n    };\n  }\n\n  /**\n   * Notify all listeners of changes\n   */\n  notifyListeners() {\n    const accessState = {\n      userType: this.userType,\n      currentUser: this.currentUser,\n      isAuthenticated: this.isAuthenticated(),\n      isDemoUser: this.isDemoUser(),\n      uiBehavior: this.getUIBehavior()\n    };\n\n    this.listeners.forEach(callback => {\n      try {\n        callback(accessState);\n      } catch (error) {\n        this.logger.error('Error in access service listener', { error: error.message });\n      }\n    });\n  }\n\n  /**\n   * Handle authentication state changes\n   */\n  handleAuthChange() {\n    this.clearPermissionsCache();\n    this.initialize();\n  }\n}\n\n// Create singleton instance\nconst userAccessService = new UserAccessService();\n\nexport default userAccessService;","/**\n * Bookmark Service - Manages user bookmarks in localStorage\n * \n * Provides functionality to bookmark pages with context-aware titles:\n * - DAK: {user}/{repo} for DAK pages\n * - DAK: {user}/{repo}/{branch} for DAK pages with specific branch  \n * - {asset} in DAK: {user}/{repo}/{branch} for asset pages\n */\nclass BookmarkService {\n  constructor() {\n    this.storageKey = 'sgex-bookmarks';\n  }\n\n  /**\n   * Get all bookmarks from localStorage\n   * @returns {Array} Array of bookmark objects\n   */\n  getBookmarks() {\n    try {\n      const stored = localStorage.getItem(this.storageKey);\n      return stored ? JSON.parse(stored) : [];\n    } catch (error) {\n      console.warn('Error reading bookmarks from localStorage:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Save bookmarks to localStorage\n   * @param {Array} bookmarks - Array of bookmark objects\n   */\n  saveBookmarks(bookmarks) {\n    try {\n      localStorage.setItem(this.storageKey, JSON.stringify(bookmarks));\n    } catch (error) {\n      console.error('Error saving bookmarks to localStorage:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Generate bookmark title based on page context\n   * @param {string} pageName - Name of the page\n   * @param {Object} context - Page context (user, repo, branch, asset)\n   * @returns {string} Generated bookmark title\n   */\n  generateBookmarkTitle(pageName, context) {\n    const { user, repository, branch, asset } = context;\n\n    // Asset pages: {asset} in DAK: {user}/{repo}/{branch}\n    if (asset && user && repository) {\n      const repoName = repository.name || repository;\n      const branchName = branch || 'main';\n      return `${asset} in DAK: ${user}/${repoName}/${branchName}`;\n    }\n\n    // DAK pages with branch: DAK: {user}/{repo}/{branch}\n    if (user && repository && branch) {\n      const repoName = repository.name || repository;\n      return `DAK: ${user}/${repoName}/${branch}`;\n    }\n\n    // DAK pages without specific branch: DAK: {user}/{repo}\n    if (user && repository) {\n      const repoName = repository.name || repository;\n      return `DAK: ${user}/${repoName}`;\n    }\n\n    // User pages: {pageName}: {user}\n    if (user) {\n      return `${pageName}: ${user}`;\n    }\n\n    // Top-level pages: just use page name\n    return pageName;\n  }\n\n  /**\n   * Add a bookmark\n   * @param {string} pageName - Name of the page\n   * @param {string} url - URL of the page\n   * @param {Object} context - Page context for generating title\n   * @returns {Object} The created bookmark\n   */\n  addBookmark(pageName, url, context = {}) {\n    const bookmarks = this.getBookmarks();\n    \n    // Check if bookmark already exists\n    const existingIndex = bookmarks.findIndex(b => b.url === url);\n    if (existingIndex !== -1) {\n      // Update existing bookmark\n      bookmarks[existingIndex] = {\n        ...bookmarks[existingIndex],\n        title: this.generateBookmarkTitle(pageName, context),\n        pageName,\n        context,\n        lastUpdated: new Date().toISOString()\n      };\n    } else {\n      // Create new bookmark\n      const bookmark = {\n        id: Date.now().toString(),\n        title: this.generateBookmarkTitle(pageName, context),\n        url,\n        pageName,\n        context,\n        createdAt: new Date().toISOString(),\n        lastUpdated: new Date().toISOString()\n      };\n      bookmarks.push(bookmark);\n    }\n\n    this.saveBookmarks(bookmarks);\n    return bookmarks[existingIndex] || bookmarks[bookmarks.length - 1];\n  }\n\n  /**\n   * Remove a bookmark by ID\n   * @param {string} bookmarkId - ID of the bookmark to remove\n   * @returns {boolean} Success status\n   */\n  removeBookmark(bookmarkId) {\n    try {\n      const bookmarks = this.getBookmarks();\n      const filteredBookmarks = bookmarks.filter(b => b.id !== bookmarkId);\n      \n      if (filteredBookmarks.length !== bookmarks.length) {\n        this.saveBookmarks(filteredBookmarks);\n        return true;\n      }\n      return false;\n    } catch (error) {\n      console.error('Error removing bookmark:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Check if current page is bookmarked\n   * @param {string} url - URL to check\n   * @returns {boolean} Whether the page is bookmarked\n   */\n  isBookmarked(url) {\n    const bookmarks = this.getBookmarks();\n    return bookmarks.some(b => b.url === url);\n  }\n\n  /**\n   * Get bookmark for a specific URL\n   * @param {string} url - URL to find\n   * @returns {Object|null} Bookmark object or null if not found\n   */\n  getBookmarkByUrl(url) {\n    const bookmarks = this.getBookmarks();\n    return bookmarks.find(b => b.url === url) || null;\n  }\n\n  /**\n   * Get bookmarks organized by page name (alphabetically)\n   * @returns {Object} Bookmarks grouped by page name\n   */\n  getBookmarksGroupedByPage() {\n    const bookmarks = this.getBookmarks();\n    const grouped = {};\n\n    bookmarks.forEach(bookmark => {\n      const pageName = bookmark.pageName || 'Other';\n      if (!grouped[pageName]) {\n        grouped[pageName] = [];\n      }\n      grouped[pageName].push(bookmark);\n    });\n\n    // Sort each group by title\n    Object.keys(grouped).forEach(pageName => {\n      grouped[pageName].sort((a, b) => a.title.localeCompare(b.title));\n    });\n\n    // Return as sorted array of objects\n    const sortedPages = Object.keys(grouped).sort();\n    return sortedPages.map(pageName => ({\n      pageName,\n      bookmarks: grouped[pageName]\n    }));\n  }\n\n  /**\n   * Clear all bookmarks\n   */\n  clearBookmarks() {\n    try {\n      localStorage.removeItem(this.storageKey);\n    } catch (error) {\n      console.error('Error clearing bookmarks:', error);\n    }\n  }\n\n  /**\n   * Export bookmarks as JSON\n   * @returns {string} JSON string of bookmarks\n   */\n  exportBookmarks() {\n    const bookmarks = this.getBookmarks();\n    return JSON.stringify(bookmarks, null, 2);\n  }\n\n  /**\n   * Import bookmarks from JSON\n   * @param {string} jsonString - JSON string of bookmarks\n   * @param {boolean} merge - Whether to merge with existing bookmarks\n   * @returns {boolean} Success status\n   */\n  importBookmarks(jsonString, merge = false) {\n    try {\n      const importedBookmarks = JSON.parse(jsonString);\n      \n      if (!Array.isArray(importedBookmarks)) {\n        throw new Error('Invalid bookmark format');\n      }\n\n      if (merge) {\n        const existingBookmarks = this.getBookmarks();\n        const mergedBookmarks = [...existingBookmarks];\n        \n        importedBookmarks.forEach(imported => {\n          const existingIndex = mergedBookmarks.findIndex(b => b.url === imported.url);\n          if (existingIndex !== -1) {\n            mergedBookmarks[existingIndex] = imported;\n          } else {\n            mergedBookmarks.push(imported);\n          }\n        });\n        \n        this.saveBookmarks(mergedBookmarks);\n      } else {\n        this.saveBookmarks(importedBookmarks);\n      }\n      \n      return true;\n    } catch (error) {\n      console.error('Error importing bookmarks:', error);\n      return false;\n    }\n  }\n}\n\n// Create and export singleton instance\nconst bookmarkService = new BookmarkService();\nexport default bookmarkService;","import React, { useState, useEffect, useRef } from 'react';\nimport githubService from '../services/githubService';\n\n/**\n * PreviewBadge component that displays when the app is deployed from a non-main branch\n * Shows branch name and links to the associated PR\n * Can expand to show detailed PR information, comments, and add new comments\n */\nconst PreviewBadge = () => {\n  const [branchInfo, setBranchInfo] = useState(null);\n  const [prInfo, setPrInfo] = useState([]); // Changed to array to support multiple PRs\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [isSticky, setIsSticky] = useState(false);\n  const expandedRef = useRef(null);\n\n  useEffect(() => {\n    const detectBranchAndPR = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n\n        // Detect current branch from environment or URL\n        const currentBranch = getCurrentBranch();\n        \n        if (!currentBranch || currentBranch === 'main') {\n          // Not a preview branch, don't show badge\n          setLoading(false);\n          return;\n        }\n\n        setBranchInfo({\n          name: currentBranch,\n          safeName: currentBranch.replace(/\\//g, '-')\n        });\n\n        // Try to fetch PR information for this branch\n        try {\n          const prData = await fetchPRsForBranch(currentBranch);\n          if (prData && prData.length > 0) {\n            setPrInfo(prData);\n          }\n        } catch (prError) {\n          console.debug('Could not fetch PR info:', prError);\n          // Continue without PR info - still show branch badge\n        }\n\n        setLoading(false);\n      } catch (err) {\n        console.error('Error detecting branch:', err);\n        setError(err.message);\n        setLoading(false);\n      }\n    };\n\n    detectBranchAndPR();\n  }, []);\n\n  // Handle clicks outside the expanded panel to close it (only if not sticky)\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (expandedRef.current && !expandedRef.current.contains(event.target)) {\n        if (isSticky) {\n          setIsSticky(false);\n        }\n        setIsExpanded(false);\n      }\n    };\n\n    if (isExpanded) {\n      // Listen for both mouse and touch events to support mobile devices\n      document.addEventListener('mousedown', handleClickOutside);\n      document.addEventListener('touchstart', handleClickOutside);\n      return () => {\n        document.removeEventListener('mousedown', handleClickOutside);\n        document.removeEventListener('touchstart', handleClickOutside);\n      };\n    }\n  }, [isExpanded, isSticky]);\n\n  const getCurrentBranch = () => {\n    // First try environment variable (set during build)\n    if (process.env.REACT_APP_GITHUB_REF_NAME) {\n      return process.env.REACT_APP_GITHUB_REF_NAME;\n    }\n    \n    // Fallback: detect from URL path\n    const path = window.location.pathname;\n    \n    // Match pattern: /sgex/{branch-name}/\n    const match = path.match(/^\\/sgex\\/([^/]+)\\//);\n    if (match && match[1] !== 'main') {\n      const safeBranchName = match[1];\n      \n      // Convert safe branch name back to original branch name\n      // This handles the common case where slashes are converted to dashes\n      // Note: This is a heuristic and may not be perfect for all edge cases\n      let branchName = safeBranchName;\n      \n      // Common patterns: feature-name -> feature/name, fix-123 -> fix/123\n      if (safeBranchName.includes('-') && !safeBranchName.startsWith('v') && !safeBranchName.match(/^\\d/)) {\n        // Try to detect if this looks like a feature branch\n        if (safeBranchName.match(/^(feature|fix|hotfix|bugfix|chore|docs|style|refactor|test)-/)) {\n          branchName = safeBranchName.replace(/^([^-]+)-/, '$1/');\n        }\n      }\n      \n      return branchName;\n    }\n\n    return null;\n  };\n\n  const fetchPRsForBranch = async (branchName) => {\n    try {\n      // Get current repository context if available\n      // For now, we'll use the main repository\n      const owner = 'litlfred';\n      const repo = 'sgex';\n\n      const prs = await githubService.getPullRequestsForBranch(owner, repo, branchName);\n      \n      return prs;\n\n    } catch (error) {\n      console.debug('Failed to fetch PR info:', error);\n      return [];\n    }\n  };\n\n  const handleBadgeClick = (pr) => {\n    if (pr && pr.html_url) {\n      window.open(pr.html_url, '_blank');\n    }\n  };\n\n  const handleMouseEnter = () => {\n    if (!isSticky && (!prInfo || prInfo.length === 0)) {\n      setIsExpanded(true);\n    }\n  };\n\n  const handleMouseLeave = () => {\n    if (!isSticky && (!prInfo || prInfo.length === 0)) {\n      setIsExpanded(false);\n    }\n  };\n\n  const handleBadgeToggle = (event) => {\n    // Only allow toggle for branch-only badges (no PRs)\n    if (prInfo && prInfo.length > 0) return;\n    \n    // Prevent event from bubbling up\n    event.stopPropagation();\n    event.preventDefault();\n    \n    if (isSticky) {\n      // If already sticky, collapse and remove sticky state\n      setIsSticky(false);\n      setIsExpanded(false);\n    } else {\n      // Make it sticky and ensure it's expanded\n      setIsSticky(true);\n      setIsExpanded(true);\n    }\n  };\n\n  const truncateTitle = (title, maxLength = 30) => {\n    if (title.length <= maxLength) return title;\n    return title.substring(0, maxLength) + '...';\n  };\n\n  // Don't render anything if loading, error, or not a preview branch\n  if (loading || error || !branchInfo) {\n    return null;\n  }\n\n  // Render multiple badges if there are multiple PRs\n  return (\n    <div className=\"preview-badge-container\" ref={expandedRef}>\n      {prInfo && prInfo.length > 0 ? (\n        // Multiple PR badges - each one is clickable and opens the corresponding PR\n        prInfo.map((pr, index) => (\n          <div \n            key={pr.id}\n            className=\"preview-badge clickable\"\n            onClick={() => handleBadgeClick(pr)}\n            title={`Click to view PR: ${pr.title}`}\n          >\n            <div className=\"badge-content\">\n              <span className=\"badge-label\">PR:</span>\n              <span className=\"badge-branch\">#{pr.number}</span>\n              <span className=\"badge-separator\">|</span>\n              <span className=\"badge-pr-title\">{truncateTitle(pr.title)}</span>\n            </div>\n          </div>\n        ))\n      ) : (\n        // Single expandable badge for branch with no PRs\n        <div \n          className={`preview-badge clickable ${isExpanded ? 'expanded' : ''} ${isSticky ? 'sticky' : ''}`}\n          onClick={handleBadgeToggle}\n          onMouseEnter={handleMouseEnter}\n          onMouseLeave={handleMouseLeave}\n          title={isSticky ? \"Click to collapse\" : isExpanded ? \"Click to keep expanded\" : `🔍 Hover for branch details, click to pin: ${branchInfo.name}`}\n        >\n          <div className=\"badge-content\">\n            <span className=\"badge-label\">Preview:</span>\n            <span className=\"badge-branch\">{branchInfo.name}</span>\n            <span className=\"badge-expand-icon\">{isExpanded ? '▼' : '▶'}</span>\n          </div>\n        </div>\n      )}\n\n      {isExpanded && (!prInfo || prInfo.length === 0) && (\n        <div className=\"preview-badge-expanded\">\n          <div className=\"expanded-header\">\n            <div className=\"pr-info\">\n              <h3>Preview Branch: {branchInfo.name}</h3>\n              <div className=\"pr-meta\">\n                <span className=\"pr-state\" data-state=\"unknown\">No PR found</span>\n                <span className=\"pr-author\">Branch preview</span>\n              </div>\n            </div>\n            <button \n              className=\"close-button\"\n              onClick={(e) => {\n                e.stopPropagation();\n                setIsExpanded(false);\n                setIsSticky(false);\n              }}\n              title=\"Close expanded view\"\n            >\n              ×\n            </button>\n          </div>\n\n          <div className=\"pr-description\">\n            <h4>Branch Information</h4>\n            <div className=\"pr-body\">\n              This is a preview deployment from the <code>{branchInfo.name}</code> branch.\n              <div style={{marginTop: '0.5rem'}}>\n                <strong>Preview URL:</strong> <code>{window.location.origin}{window.location.pathname}</code>\n              </div>\n              {!githubService.isAuth() ? (\n                <div style={{marginTop: '0.5rem', padding: '0.5rem', backgroundColor: '#f0f8ff', border: '1px solid #bee5eb', borderRadius: '4px'}}>\n                  <strong>💡 Tip:</strong> Sign in to GitHub to view pull request details, comments, and contribute to this branch.\n                </div>\n              ) : (\n                <div style={{marginTop: '0.5rem', color: '#28a745'}}>\n                  ✅ Authenticated - You can view full PR details when available.\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div className=\"expanded-footer\">\n            <a href={`https://github.com/litlfred/sgex/tree/${branchInfo.name}`} target=\"_blank\" rel=\"noopener noreferrer\" className=\"github-link\">\n              View Branch on GitHub →\n            </a>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PreviewBadge;","import React, { useState, useEffect } from 'react';\nimport { usePage } from './PageProvider';\nimport githubService from '../../services/githubService';\nimport userAccessService from '../../services/userAccessService';\nimport bookmarkService from '../../services/bookmarkService';\nimport PreviewBadge from '../PreviewBadge';\n\n/**\n * Consistent header component for all pages\n */\nconst PageHeader = () => {\n  const { \n    pageName, \n    profile, \n    repository, \n    branch, \n    asset,\n    isAuthenticated,\n    navigate \n  } = usePage();\n\n  const [showUserDropdown, setShowUserDropdown] = useState(false);\n  const [showBookmarkDropdown, setShowBookmarkDropdown] = useState(false);\n  const [authenticatedUser, setAuthenticatedUser] = useState(null);\n\n  // Always fetch the authenticated user for login button display\n  useEffect(() => {\n    if (isAuthenticated) {\n      const fetchAuthenticatedUser = async () => {\n        try {\n          // Use userAccessService to get the current user (handles both authenticated and demo users)\n          const user = userAccessService.getCurrentUser();\n          if (user) {\n            setAuthenticatedUser(user);\n          } else {\n            // Fallback to githubService for backwards compatibility\n            const githubUser = await githubService.getCurrentUser();\n            setAuthenticatedUser(githubUser);\n          }\n        } catch (error) {\n          console.debug('Could not fetch authenticated user:', error);\n        }\n      };\n      \n      fetchAuthenticatedUser();\n    } else {\n      setAuthenticatedUser(null);\n    }\n  }, [isAuthenticated]);\n\n  const handleLogout = () => {\n    githubService.logout();\n    navigate('/');\n  };\n\n  const handleHomeNavigation = () => {\n    navigate('/');\n  };\n\n  const handleGitHubUser = () => {\n    // Always navigate to the authenticated user's GitHub profile, not the DAK owner's\n    if (authenticatedUser?.html_url) {\n      window.open(authenticatedUser.html_url, '_blank');\n    } else if (authenticatedUser?.login) {\n      window.open(`https://github.com/${authenticatedUser.login}`, '_blank');\n    }\n  };\n\n  const handleBookmarkCurrentPage = () => {\n    const context = {\n      user: authenticatedUser?.login, // Use authenticated user for bookmarks\n      repository,\n      branch,\n      asset\n    };\n    \n    const currentUrl = window.location.pathname;\n    bookmarkService.addBookmark(pageName, currentUrl, context);\n    setShowBookmarkDropdown(false);\n  };\n\n  const handleRemoveBookmark = (bookmarkId) => {\n    bookmarkService.removeBookmark(bookmarkId);\n    // Force re-render by toggling dropdown\n    setShowBookmarkDropdown(false);\n    setTimeout(() => setShowBookmarkDropdown(true), 50);\n  };\n\n  const handleBookmarkNavigation = (bookmark) => {\n    navigate(bookmark.url);\n    setShowBookmarkDropdown(false);\n  };\n\n  const getCurrentPageBookmark = () => {\n    return bookmarkService.getBookmarkByUrl(window.location.pathname);\n  };\n\n  const getBookmarksGrouped = () => {\n    return bookmarkService.getBookmarksGroupedByPage();\n  };\n\n  const currentBookmark = getCurrentPageBookmark();\n  const bookmarksGrouped = getBookmarksGrouped();\n\n  return (\n    <header className=\"page-header\">\n      {/* Left side - Logo and context */}\n      <div className=\"page-header-left\">\n        <div className=\"sgex-logo\" onClick={handleHomeNavigation}>\n          <h1>SGEX Workbench</h1>\n          <p className=\"subtitle\">WHO SMART Guidelines Exchange</p>\n        </div>\n        \n        {/* Preview badge for non-main branches */}\n        <PreviewBadge />\n      </div>\n\n      {/* Right side - Navigation and user controls */}\n      <div className=\"page-header-right\">\n        {/* User info and controls */}\n        {(isAuthenticated || profile?.isDemo) && authenticatedUser ? (\n          <div className=\"user-controls\">\n            <div className=\"user-info\" onClick={() => setShowUserDropdown(!showUserDropdown)}>\n              <img src={authenticatedUser.avatar_url} alt=\"User avatar\" className=\"user-avatar\" />\n              <span className=\"user-name\">{authenticatedUser.name || authenticatedUser.login}</span>\n              <span className=\"dropdown-arrow\">▼</span>\n            </div>\n            {showUserDropdown && (\n              <div className=\"user-dropdown\">\n                <button className=\"dropdown-item\" onClick={handleGitHubUser}>\n                  <svg className=\"github-icon\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\">\n                    <path d=\"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z\"/>\n                  </svg>\n                  GitHub Profile\n                </button>\n                \n                {/* Add/Remove current page bookmark - moved to same level as bookmarks */}\n                {currentBookmark ? (\n                  <button \n                    className=\"dropdown-item bookmark-action\"\n                    onClick={() => handleRemoveBookmark(currentBookmark.id)}\n                  >\n                    ⭐ Remove Bookmark\n                  </button>\n                ) : (\n                  <button \n                    className=\"dropdown-item bookmark-action\"\n                    onClick={handleBookmarkCurrentPage}\n                  >\n                    ☆ Add Bookmark\n                  </button>\n                )}\n                \n                {/* Bookmarks submenu */}\n                <div className=\"bookmarks-section\">\n                  <div className=\"dropdown-item bookmarks-header\" onClick={() => setShowBookmarkDropdown(!showBookmarkDropdown)}>\n                    📖 Bookmarks\n                    <span className=\"dropdown-arrow\">{showBookmarkDropdown ? '▲' : '▼'}</span>\n                  </div>\n                  \n                  {showBookmarkDropdown && (\n                    <div className=\"bookmarks-dropdown\">\n                      {/* Bookmarks list grouped by page */}\n                      {bookmarksGrouped.length > 0 ? (\n                        <div className=\"bookmarks-list\">\n                          {bookmarksGrouped.map(group => (\n                            <div key={group.pageName} className=\"bookmark-group\">\n                              <div className=\"bookmark-group-header\">{group.pageName}</div>\n                              {group.bookmarks.map(bookmark => (\n                                <div key={bookmark.id} className=\"bookmark-item\">\n                                  <button \n                                    className=\"bookmark-link\"\n                                    onClick={() => handleBookmarkNavigation(bookmark)}\n                                    title={bookmark.url}\n                                  >\n                                    {bookmark.title}\n                                  </button>\n                                  <button \n                                    className=\"bookmark-remove\"\n                                    onClick={() => handleRemoveBookmark(bookmark.id)}\n                                    title=\"Remove bookmark\"\n                                  >\n                                    ×\n                                  </button>\n                                </div>\n                              ))}\n                            </div>\n                          ))}\n                        </div>\n                      ) : (\n                        <div className=\"no-bookmarks\">No bookmarks yet</div>\n                      )}\n                    </div>\n                  )}\n                </div>\n                \n                <button className=\"dropdown-item logout-btn\" onClick={handleLogout}>\n                  Logout\n                </button>\n              </div>\n            )}\n          </div>\n        ) : (\n          <button className=\"login-btn\" onClick={handleHomeNavigation}>\n            Login\n          </button>\n        )}\n      </div>\n    </header>\n  );\n};\n\nexport default PageHeader;","import React, { useState, useEffect } from 'react';\nimport userAccessService from '../../services/userAccessService';\n\n/**\n * Access Badge Component\n * \n * Displays user's access level (read/write) for the current repository\n * Shows in the title bar with dynamic styling based on permissions\n */\nconst AccessBadge = ({ owner, repo, branch = 'main', className = '' }) => {\n  const [badge, setBadge] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showTooltip, setShowTooltip] = useState(false);\n\n  useEffect(() => {\n    let mounted = true;\n\n    const loadBadge = async () => {\n      if (!owner || !repo) {\n        setLoading(false);\n        return;\n      }\n\n      try {\n        setLoading(true);\n        const badgeInfo = await userAccessService.getAccessBadge(owner, repo, branch);\n        \n        if (mounted) {\n          setBadge(badgeInfo);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('Error loading access badge:', error);\n        if (mounted) {\n          setBadge({\n            text: 'Unknown',\n            icon: '❓',\n            color: 'gray',\n            description: 'Unable to determine access level'\n          });\n          setLoading(false);\n        }\n      }\n    };\n\n    loadBadge();\n\n    // Listen for access changes\n    const unsubscribe = userAccessService.addListener(() => {\n      loadBadge();\n    });\n\n    return () => {\n      mounted = false;\n      unsubscribe();\n    };\n  }, [owner, repo, branch]);\n\n  if (loading) {\n    return (\n      <div className={`access-badge loading ${className}`}>\n        <span className=\"access-badge-icon\">⏳</span>\n        <span className=\"access-badge-text\">Loading...</span>\n      </div>\n    );\n  }\n\n  if (!badge) {\n    return null;\n  }\n\n  return (\n    <div \n      className={`access-badge ${badge.color} ${className}`}\n      onMouseEnter={() => setShowTooltip(true)}\n      onMouseLeave={() => setShowTooltip(false)}\n      title={badge.description}\n    >\n      <span className=\"access-badge-icon\" role=\"img\" aria-label={badge.text}>\n        {badge.icon}\n      </span>\n      <span className=\"access-badge-text\">\n        {badge.text}\n      </span>\n      \n      {showTooltip && (\n        <div className=\"access-badge-tooltip\">\n          <div className=\"tooltip-content\">\n            <strong>{badge.text}</strong>\n            <p>{badge.description}</p>\n            {repo && (\n              <small>Repository: {owner}/{repo}</small>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AccessBadge;","import React, { useState, useEffect } from 'react';\nimport { usePage, PAGE_TYPES } from './PageProvider';\nimport AccessBadge from './AccessBadge';\nimport githubService from '../../services/githubService';\n\n/**\n * Page context component that displays profile/repo/branch information and breadcrumbs\n * Unified navigation component with avatar on left and two-row content on right\n */\nconst PageContext = ({ customBreadcrumbs }) => {\n  const { \n    type, \n    pageName,\n    profile, \n    repository, \n    branch,\n    navigate \n  } = usePage();\n\n  // Branch selector state\n  const [branches, setBranches] = useState([]);\n  const [showBranchDropdown, setShowBranchDropdown] = useState(false);\n  const [branchSearchTerm, setBranchSearchTerm] = useState('');\n  const [loadingBranches, setLoadingBranches] = useState(false);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (showBranchDropdown && !event.target.closest('.page-context-branch-selector')) {\n        setShowBranchDropdown(false);\n        setBranchSearchTerm('');\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showBranchDropdown]);\n\n  // Fetch branches when repository changes\n  useEffect(() => {\n    const fetchBranches = async () => {\n      if (!repository || !(type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET)) {\n        setBranches([]);\n        return;\n      }\n\n      try {\n        setLoadingBranches(true);\n        const owner = repository.owner?.login || repository.full_name?.split('/')[0];\n        const branchData = await githubService.getBranches(owner, repository.name);\n        \n        // Sort branches alphabetically as requested\n        const sortedBranches = branchData.sort((a, b) => a.name.localeCompare(b.name));\n        setBranches(sortedBranches);\n      } catch (error) {\n        console.error('Failed to fetch branches for context:', error);\n        setBranches([]);\n      } finally {\n        setLoadingBranches(false);\n      }\n    };\n\n    fetchBranches();\n  }, [repository, type]);\n\n  const handleBranchChange = (newBranch) => {\n    // Update URL with new branch\n    const currentPath = window.location.pathname;\n    const pathParts = currentPath.split('/');\n    \n    // URL structure: /sgex/dashboard/{user}/{repo}/{branch}\n    // After splitting: ['', 'sgex', 'dashboard', '{user}', '{repo}', '{branch}']\n    // So branch is at index 5 when including the empty string at index 0\n    if (pathParts.length >= 5) {\n      if (pathParts.length === 5) {\n        // No branch in URL, append it\n        pathParts.push(newBranch);\n      } else {\n        // Branch exists, replace it\n        pathParts[5] = newBranch;\n      }\n      navigate(pathParts.join('/'));\n    }\n    setShowBranchDropdown(false);\n    setBranchSearchTerm('');\n  };\n\n  // Filter branches based on search term\n  const filteredBranches = branches.filter(b => \n    b.name.toLowerCase().includes(branchSearchTerm.toLowerCase())\n  );\n\n  const handleGitHubRepo = () => {\n    if (repository?.html_url) {\n      window.open(repository.html_url, '_blank');\n    }\n  };\n\n  const handleGitHubUser = () => {\n    if (profile?.html_url) {\n      window.open(profile.html_url, '_blank');\n    } else if (profile?.login) {\n      window.open(`https://github.com/${profile.login}`, '_blank');\n    }\n  };\n\n  // Generate breadcrumbs\n  const getBreadcrumbs = () => {\n    // If custom breadcrumbs are provided, use them\n    if (customBreadcrumbs && customBreadcrumbs.length > 0) {\n      return customBreadcrumbs;\n    }\n\n    // Generate automatic breadcrumbs based on page type\n    const breadcrumbs = [];\n\n    // Always start with home\n    breadcrumbs.push({\n      label: 'Home',\n      path: '/',\n      onClick: () => navigate('/')\n    });\n\n    // Add user context for user/DAK/asset pages\n    if ((type === PAGE_TYPES.USER || type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) && profile) {\n      breadcrumbs.push({\n        label: 'Select Repository',\n        path: `/dak-selection/${profile.login}`,\n        onClick: () => navigate(`/dak-selection/${profile.login}`, { state: { profile } })\n      });\n    }\n\n    // Add DAK context for DAK/asset pages\n    if ((type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) && repository) {\n      const branchPath = branch && branch !== 'main' ? `/${branch}` : '';\n      const ownerLogin = repository.owner?.login || repository.full_name?.split('/')[0];\n      if (ownerLogin) {\n        breadcrumbs.push({\n          label: 'DAK Components',\n          path: `/dashboard/${ownerLogin}/${repository.name}${branchPath}`,\n          onClick: () => navigate(`/dashboard/${ownerLogin}/${repository.name}${branchPath}`)\n        });\n      }\n    }\n\n    // Add current page context\n    const pageLabels = {\n      'landing': 'Home',\n      'landing-unauthenticated': 'Home',\n      'repositories': 'Select Repository', \n      'dak-selection': 'Select DAK',\n      'dak-action': 'Choose DAK Action',\n      'dashboard': 'DAK Components',\n      'dak-dashboard': 'DAK Components',\n      'actor-editor': 'Actor Definitions',\n      'component-editor': 'Component Editor',\n      'bpmn-viewer': 'Business Process Viewer',\n      'bpmn-editor': 'Business Process Editor',\n      'decision-support-logic': 'Decision Support Logic',\n      'core-data-dictionary-viewer': 'Core Data Dictionary',\n      'testing-viewer': 'Testing',\n      'pages-manager': 'Pages',\n      'documentation': 'Documentation'\n    };\n\n    const currentPageLabel = pageLabels[pageName] || pageName;\n    \n    // Don't add duplicate page labels\n    if (breadcrumbs.length === 0 || breadcrumbs[breadcrumbs.length - 1].label !== currentPageLabel) {\n      breadcrumbs.push({\n        label: currentPageLabel,\n        current: true\n      });\n    }\n\n    return breadcrumbs;\n  };\n\n  const breadcrumbs = getBreadcrumbs();\n\n  // Don't render if no context information to show\n  if (!profile && !repository && breadcrumbs.length <= 1) {\n    return null;\n  }\n\n  return (\n    <div className=\"page-context-container\">\n      <div className=\"page-context-content\">\n        {/* Avatar positioned to the far left */}\n        {profile && (\n          <img src={profile.avatar_url} alt={`${profile.login} avatar`} className=\"page-context-avatar\" />\n        )}\n        \n        <div className=\"page-context-info\">\n          {/* First row: Profile / Repository / Branch */}\n          <div className=\"page-context-row page-context-user-repo\">\n            {profile && (\n              <>\n                <span className=\"page-context-profile\" onClick={handleGitHubUser}>\n                  {profile.login}\n                </span>\n                {repository && <span className=\"page-context-separator\">/</span>}\n              </>\n            )}\n            {repository && (\n              <span className=\"page-context-repo\">\n                {repository.name}\n              </span>\n            )}\n            {branch && (type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) && (\n              <>\n                <span className=\"page-context-separator\">@</span>\n                <div className=\"page-context-branch-selector\">\n                  <button \n                    className=\"page-context-branch-btn\"\n                    onClick={() => setShowBranchDropdown(!showBranchDropdown)}\n                    title=\"Switch branch\"\n                  >\n                    <span className=\"branch-icon\">🌿</span>\n                    {branch}\n                    <span className=\"branch-dropdown-arrow\">{showBranchDropdown ? '▲' : '▼'}</span>\n                  </button>\n                  \n                  {showBranchDropdown && (\n                    <div className=\"branch-dropdown\">\n                      <div className=\"branch-search\">\n                        <input\n                          type=\"text\"\n                          placeholder=\"Search branches...\"\n                          value={branchSearchTerm}\n                          onChange={(e) => setBranchSearchTerm(e.target.value)}\n                          className=\"branch-search-input\"\n                          autoFocus\n                        />\n                      </div>\n                      <div className=\"branch-list\">\n                        {loadingBranches ? (\n                          <div className=\"branch-item loading\">Loading branches...</div>\n                        ) : filteredBranches.length > 0 ? (\n                          filteredBranches.map((b) => (\n                            <button\n                              key={b.name}\n                              className={`branch-item ${b.name === branch ? 'current' : ''}`}\n                              onClick={() => handleBranchChange(b.name)}\n                            >\n                              <span className=\"branch-icon\">🌿</span>\n                              {b.name}\n                              {b.name === branch && <span className=\"current-badge\">current</span>}\n                            </button>\n                          ))\n                        ) : (\n                          <div className=\"branch-item no-results\">\n                            {branchSearchTerm ? 'No branches found' : 'No branches available'}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </>\n            )}\n          </div>\n          \n          {/* Second row: Breadcrumbs */}\n          {breadcrumbs.length > 1 && (\n            <nav className=\"page-context-row page-context-breadcrumbs\" aria-label=\"Breadcrumb navigation\">\n              <ol className=\"breadcrumb-list\">\n                {breadcrumbs.map((crumb, index) => (\n                  <li key={index} className=\"breadcrumb-item\">\n                    {!crumb.current ? (\n                      <>\n                        <button \n                          className=\"breadcrumb-link\" \n                          onClick={() => crumb.onClick ? crumb.onClick() : navigate(crumb.path)}\n                          aria-label={`Navigate to ${crumb.label}`}\n                        >\n                          {crumb.label}\n                        </button>\n                        <span className=\"breadcrumb-separator\" aria-hidden=\"true\">›</span>\n                      </>\n                    ) : (\n                      <span className=\"breadcrumb-current\" aria-current=\"page\">\n                        {crumb.label}\n                      </span>\n                    )}\n                  </li>\n                ))}\n              </ol>\n            </nav>\n          )}\n        </div>\n        \n        {/* Actions area for DAK and Asset pages */}\n        {(type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) && repository && (\n          <div className=\"page-context-actions\">\n            {/* Access badge */}\n            <AccessBadge \n              owner={repository.owner?.login || profile?.login}\n              repo={repository.name}\n              branch={branch}\n              className=\"context-access-badge\"\n            />\n            {/* GitHub repository button */}\n            <button className=\"context-btn github-repo-btn\" onClick={handleGitHubRepo} title=\"Open repository on GitHub\">\n              <svg className=\"github-icon\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\">\n                <path d=\"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z\"/>\n              </svg>\n              Repository\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default PageContext;","import React, { useState } from 'react';\nimport { usePage } from './PageProvider';\nimport ContextualHelpMascot from '../ContextualHelpMascot';\nimport useThemeImage from '../../hooks/useThemeImage';\n\n/**\n * Error handler component with automatic bug reporting functionality\n */\nconst ErrorHandler = ({ error, onRetry }) => {\n  const pageContext = usePage();\n  const pageName = pageContext.pageName;\n  const [bugReportSent, setBugReportSent] = useState(false);\n\n  // Theme-aware mascot image\n  const mascotImage = useThemeImage('sgex-mascot.png');\n  const [userExplanation, setUserExplanation] = useState('');\n\n  const generateBugReportUrl = () => {\n    const title = encodeURIComponent('User should not have reached this page');\n    const body = encodeURIComponent(`\n**Error Information:**\n- Page: ${pageName}\n- URL: ${window.location.href}\n- Error: ${error}\n- Timestamp: ${new Date().toISOString()}\n- User Agent: ${navigator.userAgent}\n\n**Context:**\n- Browser: ${navigator.userAgent}\n- Viewport: ${window.innerWidth}x${window.innerHeight}\n- Referrer: ${document.referrer || 'Direct access'}\n\n**User Explanation:**\n${userExplanation || 'No additional details provided'}\n\n**Steps to Reproduce:**\n1. Navigate to: ${window.location.href}\n2. [Please add any additional steps]\n\n**Expected Behavior:**\nThe page should load without errors.\n\n**Actual Behavior:**\n${error}\n    `);\n\n    return `https://github.com/litlfred/sgex/issues/new?title=${title}&body=${body}&labels=bug,user-error`;\n  };\n\n  const handleSendBugReport = () => {\n    const bugReportUrl = generateBugReportUrl();\n    window.open(bugReportUrl, '_blank');\n    setBugReportSent(true);\n  };\n\n  const handleRetry = () => {\n    if (onRetry) {\n      onRetry();\n    } else {\n      window.location.reload();\n    }\n  };\n\n  const handleGoHome = () => {\n    window.location.href = '/sgex/';\n  };\n\n  // Enhanced error message generation for DAK-specific errors\n  const getErrorDisplayInfo = () => {\n    const lowercaseError = error.toLowerCase();\n    \n    // Extract user/repo from URL or page context\n    const user = pageContext?.user;\n    const repo = pageContext?.repository?.name;\n    \n    if (lowercaseError.includes('not found') || lowercaseError.includes('not accessible')) {\n      if (lowercaseError.includes('user')) {\n        return {\n          title: 'User Not Found',\n          message: `The user ${user ? `'${user}'` : 'in the URL'} could not be found on GitHub.`,\n          suggestions: [\n            'Check the spelling of the username',\n            'Verify the user account exists on GitHub',\n            'Try searching for the user on GitHub.com'\n          ],\n          icon: '👤'\n        };\n      } else if (lowercaseError.includes('repository')) {\n        return {\n          title: 'Repository Not Found',\n          message: `The repository ${user && repo ? `'${user}/${repo}'` : 'in the URL'} could not be accessed.`,\n          suggestions: [\n            'Check the spelling of the repository name',\n            'Verify the repository exists and is public',\n            'If it\\'s a private repository, make sure you have access',\n            'Try visiting the repository directly on GitHub.com'\n          ],\n          icon: '📁'\n        };\n      }\n    }\n    \n    if (lowercaseError.includes('not a valid dak') || lowercaseError.includes('invalid dak')) {\n      return {\n        title: 'Not a DAK Repository',\n        message: `The repository ${user && repo ? `'${user}/${repo}'` : 'in the URL'} doesn't appear to contain WHO SMART Guidelines content.`,\n        suggestions: [\n          'Verify this is a WHO SMART Guidelines Digital Adaptation Kit',\n          'Check if the repository has a sushi-config.yaml file',\n          'Look for smart.who.int.base dependencies in the configuration',\n          'Try browsing other DAK repositories for examples'\n        ],\n        icon: '📋'\n      };\n    }\n    \n    if (lowercaseError.includes('asset') && lowercaseError.includes('not found')) {\n      return {\n        title: 'File Not Found',\n        message: `The requested file could not be found in the repository.`,\n        suggestions: [\n          'Check if the file path is correct',\n          'Verify the file exists in the current branch',\n          'The file may have been moved or deleted',\n          'Try browsing the repository to find the correct path'\n        ],\n        icon: '📄'\n      };\n    }\n    \n    // Default error info\n    return {\n      title: 'Something Went Wrong',\n      message: error,\n      suggestions: [\n        'Try refreshing the page',\n        'Check your internet connection',\n        'The service may be temporarily unavailable'\n      ],\n      icon: '⚠️'\n    };\n  };\n\n  const errorInfo = getErrorDisplayInfo();\n\n  return (\n    <div className=\"error-handler\">\n      <div className=\"error-content\">\n        <div className=\"error-mascot-container\">\n          <ContextualHelpMascot\n            helpContent={\n              <div className=\"error-help-content\">\n                <div className=\"error-mascot-large\">\n                  <img \n                    src={mascotImage} \n                    alt=\"SGEX Helper\" \n                    className=\"large-mascot-icon\"\n                  />\n                  <div className=\"mascot-speech-bubble\">\n                    <div className=\"speech-content\">\n                      I'm sorry! Something went wrong.\n                    </div>\n                    <div className=\"speech-tail\"></div>\n                  </div>\n                </div>\n              </div>\n            }\n            position=\"center\"\n          />\n        </div>\n        \n        <div className=\"error-details\">\n          <h2>{errorInfo.icon} {errorInfo.title}</h2>\n          <p className=\"error-message\">{errorInfo.message}</p>\n          \n          {errorInfo.suggestions && (\n            <div className=\"error-suggestions\">\n              <h3>💡 Suggestions:</h3>\n              <ul>\n                {errorInfo.suggestions.map((suggestion, index) => (\n                  <li key={index}>{suggestion}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n          \n          <div className=\"error-actions\">\n            <button className=\"error-btn primary\" onClick={handleRetry}>\n              🔄 Try Again\n            </button>\n            <button className=\"error-btn secondary\" onClick={handleGoHome}>\n              🏠 Go Home\n            </button>\n          </div>\n          \n          <div className=\"bug-report-section\">\n            <h3>Help us improve SGEX</h3>\n            <p>If this error persists, please let us know what happened:</p>\n            \n            <div className=\"user-explanation\">\n              <label htmlFor=\"user-explanation\">\n                What were you trying to do when this error occurred?\n              </label>\n              <textarea\n                id=\"user-explanation\"\n                value={userExplanation}\n                onChange={(e) => setUserExplanation(e.target.value)}\n                placeholder=\"Please describe what you were doing when the error occurred...\"\n                rows={4}\n              />\n            </div>\n            \n            {!bugReportSent ? (\n              <button className=\"bug-report-btn\" onClick={handleSendBugReport}>\n                📧 Send Bug Report\n              </button>\n            ) : (\n              <div className=\"bug-report-sent\">\n                <span className=\"success-icon\">✅</span>\n                Thank you! A bug report has been opened. We'll investigate this issue.\n              </div>\n            )}\n          </div>\n          \n          <div className=\"error-context\">\n            <details>\n              <summary>Technical Details</summary>\n              <div className=\"technical-details\">\n                <p><strong>Page:</strong> {pageName}</p>\n                <p><strong>URL:</strong> {window.location.href}</p>\n                <p><strong>Error:</strong> {error}</p>\n                <p><strong>Timestamp:</strong> {new Date().toISOString()}</p>\n              </div>\n            </details>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ErrorHandler;","import React from 'react';\nimport { PageProvider, usePage } from './PageProvider';\nimport PageHeader from './PageHeader';\nimport PageContext from './PageContext';\nimport ErrorHandler from './ErrorHandler';\nimport ContextualHelpMascot from '../ContextualHelpMascot';\n\n/**\n * Error boundary wrapper for catching React errors\n */\nclass PageErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true, error: error.message };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error('PageLayout caught an error:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"page-layout-error\">\n          <ErrorHandler \n            error={this.state.error}\n            onRetry={() => {\n              this.setState({ hasError: false, error: null });\n              window.location.reload();\n            }}\n          />\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n/**\n * Inner layout component that uses page context\n */\nconst PageLayoutInner = ({ \n  children, \n  showHeader = true, \n  showMascot = true, \n  showBreadcrumbs = true, \n  customBreadcrumbs \n}) => {\n  const { loading, error, pageName } = usePage();\n\n  // Show loading state\n  if (loading) {\n    return (\n      <div className=\"page-layout\">\n        {showHeader && <PageHeader />}\n        <main className=\"page-main\">\n          <div className=\"page-loading\">\n            <div className=\"loading-spinner\"></div>\n            <p>Loading...</p>\n          </div>\n        </main>\n        {showMascot && (\n          <ContextualHelpMascot \n            pageId={`${pageName}-loading`}\n            position=\"bottom-right\"\n          />\n        )}\n      </div>\n    );\n  }\n\n  // Show error state\n  if (error) {\n    return (\n      <div className=\"page-layout\">\n        {showHeader && <PageHeader />}\n        <main className=\"page-main\">\n          <ErrorHandler \n            error={error}\n            onRetry={() => window.location.reload()}\n          />\n        </main>\n      </div>\n    );\n  }\n\n  // Show normal page content\n  return (\n    <div className=\"page-layout\">\n      {showHeader && <PageHeader />}\n      <PageContext customBreadcrumbs={showBreadcrumbs ? customBreadcrumbs : []} />\n      <main className=\"page-main\">\n        {children}\n        {showMascot && (\n          <ContextualHelpMascot \n            pageId={pageName}\n            position=\"bottom-right\"\n            contextData={{}}\n          />\n        )}\n      </main>\n    </div>\n  );\n};\n\n/**\n * Main page layout component with framework integration\n */\nconst PageLayout = ({ \n  children, \n  pageName, \n  showHeader = true, \n  showMascot = true,\n  showBreadcrumbs = true,\n  customBreadcrumbs\n}) => {\n  return (\n    <PageErrorBoundary>\n      <PageProvider pageName={pageName}>\n        <PageLayoutInner \n          showHeader={showHeader} \n          showMascot={showMascot}\n          showBreadcrumbs={showBreadcrumbs}\n          customBreadcrumbs={customBreadcrumbs}\n        >\n          {children}\n        </PageLayoutInner>\n      </PageProvider>\n    </PageErrorBoundary>\n  );\n};\n\nexport default PageLayout;","import { usePage, PAGE_TYPES } from './PageProvider';\n\n/**\n * Hook for accessing URL parameters in a type-safe way\n */\nexport const usePageParams = () => {\n  const { type, user, profile, repository, branch, asset, params, navigate } = usePage();\n\n  const updateBranch = (newBranch) => {\n    if (type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) {\n      const currentPath = window.location.pathname;\n      const pathParts = currentPath.split('/');\n      \n      // Update branch in URL path\n      if (pathParts.length >= 5) {\n        if (pathParts.length === 5) {\n          // No branch in URL, append it\n          pathParts.push(newBranch);\n        } else {\n          // Branch exists, replace it\n          pathParts[5] = newBranch;\n        }\n        navigate(pathParts.join('/'));\n      }\n    }\n  };\n\n  const navigateToUser = (userLogin) => {\n    navigate(`/${params.page || 'dak-action'}/${userLogin}`);\n  };\n\n  const navigateToDAK = (userLogin, repoName, branchName = 'main') => {\n    navigate(`/${params.page || 'dashboard'}/${userLogin}/${repoName}/${branchName}`);\n  };\n\n  const navigateToAsset = (userLogin, repoName, branchName, assetPath) => {\n    navigate(`/${params.page || 'editor'}/${userLogin}/${repoName}/${branchName}/${assetPath}`);\n  };\n\n  return {\n    type,\n    user,\n    profile,\n    repository,\n    branch,\n    asset,\n    params,\n    updateBranch,\n    navigateToUser,\n    navigateToDAK,\n    navigateToAsset,\n    navigate\n  };\n};\n\n/**\n * Hook specifically for DAK pages (DAK and Asset page types)\n */\nexport const useDAKParams = () => {\n  try {\n    const pageParams = usePageParams();\n    \n    // Only throw error if page is fully loaded and type is not DAK/ASSET\n    // This prevents errors during initial loading or page type determination\n    if (!pageParams.loading && \n        pageParams.type !== PAGE_TYPES.DAK && \n        pageParams.type !== PAGE_TYPES.ASSET) {\n      throw new Error(`useDAKParams can only be used on DAK or Asset pages. Current page type: ${pageParams.type}`);\n    }\n\n    return {\n      user: pageParams.user,\n      profile: pageParams.profile,\n      repository: pageParams.repository,\n      branch: pageParams.branch,\n      asset: pageParams.asset,\n      updateBranch: pageParams.updateBranch,\n      navigate: pageParams.navigate\n    };\n  } catch (error) {\n    // If PageProvider is not ready yet, return empty object\n    if (error.message.includes('usePage must be used within a PageProvider')) {\n      console.log('useDAKParams: PageProvider not ready yet, returning empty data');\n      return {\n        user: null,\n        profile: null,\n        repository: null,\n        branch: null,\n        asset: null,\n        updateBranch: () => {},\n        navigate: () => {}\n      };\n    }\n    throw error;\n  }\n};\n\n/**\n * Hook specifically for User pages\n */\nexport const useUserParams = () => {\n  const pageParams = usePageParams();\n  \n  if (pageParams.type !== PAGE_TYPES.USER) {\n    throw new Error('useUserParams can only be used on User pages');\n  }\n\n  return {\n    user: pageParams.user,\n    profile: pageParams.profile,\n    navigateToDAK: pageParams.navigateToDAK,\n    navigate: pageParams.navigate\n  };\n};","import React from 'react';\n\n/**\n * Container for save buttons with independent states\n * Provides consistent UI for local and GitHub save operations\n */\nconst SaveButtonsContainer = ({\n  // States\n  hasChanges = false,\n  isSavingLocal = false,\n  isSavingGitHub = false,\n  canSaveToGitHub = false,\n  localSaveSuccess = false,\n  githubSaveSuccess = false,\n  savedLocally = false,\n  \n  // Handlers\n  onSaveLocal,\n  onSaveGitHub,\n  \n  // Configuration\n  isDemo = false,\n  showLocalButton = true,\n  showGitHubButton = true,\n  buttonSize = 'medium', // 'small', 'medium', 'large'\n  layout = 'horizontal' // 'horizontal', 'vertical'\n}) => {\n  \n  // Determine button states\n  const localButtonDisabled = !hasChanges || isSavingLocal || localSaveSuccess;\n  const githubButtonDisabled = !hasChanges || isSavingGitHub || githubSaveSuccess || !canSaveToGitHub;\n  \n  // Button text based on state\n  const getLocalButtonText = () => {\n    if (localSaveSuccess) return 'Saved Locally ✓';\n    if (isSavingLocal) return 'Saving...';\n    return 'Save Local';\n  };\n  \n  const getGitHubButtonText = () => {\n    if (githubSaveSuccess) return 'Committed ✓';\n    if (isSavingGitHub) return 'Committing...';\n    return 'Save to GitHub';\n  };\n\n  // CSS classes\n  const containerClasses = [\n    'save-buttons-container',\n    `layout-${layout}`,\n    `size-${buttonSize}`\n  ].join(' ');\n\n  const getButtonClasses = (type, disabled, success) => {\n    const classes = ['save-button', `save-button-${type}`];\n    if (disabled) classes.push('disabled');\n    if (success) classes.push('success');\n    return classes.join(' ');\n  };\n\n  return (\n    <div className={containerClasses}>\n      {/* Local Save Button */}\n      {showLocalButton && (\n        <button\n          className={getButtonClasses('local', localButtonDisabled, localSaveSuccess)}\n          onClick={onSaveLocal}\n          disabled={localButtonDisabled}\n          title={\n            !hasChanges ? 'No changes to save' :\n            localSaveSuccess ? 'Changes saved to local storage' :\n            isSavingLocal ? 'Saving to local storage...' :\n            'Save changes to browser local storage'\n          }\n        >\n          <span className=\"button-icon\">💾</span>\n          <span className=\"button-text\">{getLocalButtonText()}</span>\n        </button>\n      )}\n\n      {/* GitHub Save Button */}\n      {showGitHubButton && canSaveToGitHub && (\n        <button\n          className={getButtonClasses('github', githubButtonDisabled, githubSaveSuccess)}\n          onClick={onSaveGitHub}\n          disabled={githubButtonDisabled}\n          title={\n            !hasChanges ? 'No changes to save' :\n            githubSaveSuccess ? 'Changes committed to GitHub' :\n            isSavingGitHub ? 'Committing to GitHub...' :\n            'Commit changes to GitHub repository'\n          }\n        >\n          <span className=\"button-icon\">📤</span>\n          <span className=\"button-text\">{getGitHubButtonText()}</span>\n        </button>\n      )}\n\n      {/* GitHub unavailable indicator */}\n      {showGitHubButton && !canSaveToGitHub && !isDemo && (\n        <div className=\"github-unavailable\">\n          <span className=\"unavailable-icon\">🔒</span>\n          <span className=\"unavailable-text\">GitHub save unavailable</span>\n          <small>Login required for GitHub access</small>\n        </div>\n      )}\n\n      {/* Demo mode indicator */}\n      {isDemo && (\n        <div className=\"demo-mode-indicator\">\n          <span className=\"demo-icon\">🧪</span>\n          <span className=\"demo-text\">Demo Mode - Local save only</span>\n        </div>\n      )}\n\n      {/* Local storage indicator */}\n      {savedLocally && (\n        <div className=\"local-storage-indicator\">\n          <span className=\"local-icon\">💾</span>\n          <span className=\"local-text\">Local version available</span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SaveButtonsContainer;","import React, { useEffect, useRef } from 'react';\n\n/**\n * Dialog for entering commit message when saving to GitHub\n * Provides commit message input with validation and cancel functionality\n */\nconst CommitMessageDialog = ({\n  isOpen = false,\n  commitMessage = '',\n  setCommitMessage,\n  onCommit,\n  onCancel,\n  isSaving = false,\n  fileName = '',\n  suggestedMessage = ''\n}) => {\n  const textareaRef = useRef(null);\n  \n  // Auto-focus and suggest message when dialog opens\n  useEffect(() => {\n    if (isOpen && textareaRef.current) {\n      textareaRef.current.focus();\n      \n      // Set suggested message if none provided\n      if (!commitMessage && !suggestedMessage && fileName) {\n        const defaultMessage = `Update ${fileName}`;\n        setCommitMessage(defaultMessage);\n      } else if (suggestedMessage && !commitMessage) {\n        setCommitMessage(suggestedMessage);\n      }\n    }\n  }, [isOpen, commitMessage, suggestedMessage, fileName, setCommitMessage]);\n\n  // Handle key presses\n  const handleKeyDown = (e) => {\n    if (e.key === 'Escape' && !isSaving) {\n      onCancel();\n    } else if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {\n      // Ctrl/Cmd + Enter to commit\n      if (commitMessage.trim() && !isSaving) {\n        onCommit(commitMessage.trim());\n      }\n    }\n  };\n\n  // Handle commit button click\n  const handleCommit = () => {\n    if (commitMessage.trim() && !isSaving) {\n      onCommit(commitMessage.trim());\n    }\n  };\n\n  // Handle overlay click to close\n  const handleOverlayClick = (e) => {\n    if (e.target === e.currentTarget && !isSaving) {\n      onCancel();\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"commit-dialog-overlay\" onClick={handleOverlayClick}>\n      <div className=\"commit-dialog\" onKeyDown={handleKeyDown}>\n        <div className=\"commit-dialog-header\">\n          <h3>Commit Changes to GitHub</h3>\n          <button \n            className=\"close-button\"\n            onClick={onCancel}\n            disabled={isSaving}\n            aria-label=\"Close dialog\"\n          >\n            ✕\n          </button>\n        </div>\n        \n        <div className=\"commit-dialog-content\">\n          {fileName && (\n            <div className=\"file-info\">\n              <span className=\"file-icon\">📄</span>\n              <span className=\"file-name\">{fileName}</span>\n            </div>\n          )}\n          \n          <div className=\"commit-message-section\">\n            <label htmlFor=\"commit-message\" className=\"commit-message-label\">\n              Commit Message *\n            </label>\n            <textarea\n              id=\"commit-message\"\n              ref={textareaRef}\n              className=\"commit-message-input\"\n              value={commitMessage}\n              onChange={(e) => setCommitMessage(e.target.value)}\n              placeholder=\"Describe the changes you made...\"\n              rows={4}\n              disabled={isSaving}\n              required\n            />\n            <div className=\"commit-message-help\">\n              <small>\n                Describe what changes you made and why. This will be visible in the repository's commit history.\n              </small>\n            </div>\n          </div>\n          \n          <div className=\"commit-guidelines\">\n            <details>\n              <summary>Commit Message Guidelines</summary>\n              <ul>\n                <li>Use clear, descriptive language</li>\n                <li>Start with a verb (Add, Update, Fix, Remove, etc.)</li>\n                <li>Keep the first line under 72 characters</li>\n                <li>Add details in additional lines if needed</li>\n              </ul>\n            </details>\n          </div>\n        </div>\n        \n        <div className=\"commit-dialog-footer\">\n          <div className=\"dialog-actions\">\n            <button \n              className=\"btn btn-secondary\"\n              onClick={onCancel}\n              disabled={isSaving}\n            >\n              Cancel\n            </button>\n            <button \n              className=\"btn btn-primary\"\n              onClick={handleCommit}\n              disabled={!commitMessage.trim() || isSaving}\n            >\n              {isSaving ? (\n                <>\n                  <span className=\"spinner\"></span>\n                  Committing...\n                </>\n              ) : (\n                'Commit Changes'\n              )}\n            </button>\n          </div>\n          \n          <div className=\"keyboard-shortcut\">\n            <small>\n              Press <kbd>Ctrl+Enter</kbd> to commit or <kbd>Esc</kbd> to cancel\n            </small>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CommitMessageDialog;","/**\n * Data Access Layer\n * \n * Comprehensive service that integrates user access, staging ground, and GitHub\n * for a unified asset management experience across all user types.\n */\n\nimport userAccessService from './userAccessService';\nimport stagingGroundService from './stagingGroundService';\nimport githubService from './githubService';\nimport logger from '../utils/logger';\n\n/**\n * Save targets for asset operations\n */\nexport const SAVE_TARGETS = {\n  LOCAL: 'local',\n  GITHUB: 'github'\n};\n\n/**\n * Asset operation results\n */\nexport const OPERATION_RESULTS = {\n  SUCCESS: 'success',\n  ERROR: 'error',\n  PERMISSION_DENIED: 'permission_denied',\n  DEMO_MODE_BLOCKED: 'demo_mode_blocked'\n};\n\nclass DataAccessLayer {\n  constructor() {\n    this.logger = logger.getLogger('DataAccessLayer');\n    this.pendingOperations = new Map();\n    this.assetCache = new Map();\n  }\n\n  /**\n   * Initialize data access layer\n   */\n  async initialize(repository, branch) {\n    this.logger.info('Initializing data access layer', { \n      repository: repository?.full_name, \n      branch \n    });\n    \n    // Initialize staging ground for the repository\n    stagingGroundService.initialize(repository, branch);\n    \n    // Initialize user access service if not already done\n    await userAccessService.initialize();\n  }\n\n  /**\n   * Get asset content from GitHub or local storage\n   */\n  async getAsset(owner, repo, branch, assetPath) {\n    const cacheKey = `${owner}/${repo}/${branch}/${assetPath}`;\n    \n    try {\n      // Check if user has read access\n      const access = await userAccessService.getRepositoryAccess(owner, repo, branch);\n      if (access === 'none') {\n        throw new Error('No access to this repository');\n      }\n\n      // First, check if there's a local version in staging ground\n      const stagingGround = stagingGroundService.getStagingGround();\n      const localFile = stagingGround.files.find(f => f.path === assetPath);\n      \n      if (localFile) {\n        this.logger.debug('Asset loaded from staging ground', { assetPath });\n        return {\n          content: localFile.content,\n          source: 'local',\n          metadata: localFile.metadata,\n          hasLocalChanges: true\n        };\n      }\n\n      // If no local version, get from GitHub\n      let content;\n      if (userAccessService.isDemoUser() && userAccessService.isDemoDAK(owner, repo)) {\n        // For demo users, provide demo content\n        content = this.getDemoAssetContent(assetPath);\n      } else {\n        // Get real content from GitHub\n        content = await githubService.getFileContent(owner, repo, assetPath, branch);\n      }\n\n      // Cache the content\n      this.assetCache.set(cacheKey, content);\n\n      this.logger.debug('Asset loaded from GitHub', { assetPath, source: 'github' });\n      return {\n        content,\n        source: 'github',\n        hasLocalChanges: false\n      };\n\n    } catch (error) {\n      this.logger.error('Error getting asset', { \n        owner, repo, branch, assetPath, error: error.message \n      });\n      throw error;\n    }\n  }\n\n  /**\n   * Save asset to local storage (staging ground)\n   */\n  async saveAssetLocal(assetPath, content, metadata = {}) {\n    try {\n      const userType = userAccessService.getUserType();\n      \n      // All user types can save to local storage\n      const success = stagingGroundService.updateFile(assetPath, content, {\n        ...metadata,\n        savedBy: userType,\n        saveTarget: SAVE_TARGETS.LOCAL\n      });\n\n      if (success) {\n        this.logger.info('Asset saved to local storage', { assetPath, userType });\n        return {\n          result: OPERATION_RESULTS.SUCCESS,\n          message: 'Changes saved to local staging area',\n          target: SAVE_TARGETS.LOCAL\n        };\n      } else {\n        throw new Error('Failed to save to local storage');\n      }\n\n    } catch (error) {\n      this.logger.error('Error saving asset locally', { assetPath, error: error.message });\n      return {\n        result: OPERATION_RESULTS.ERROR,\n        message: `Failed to save locally: ${error.message}`,\n        target: SAVE_TARGETS.LOCAL\n      };\n    }\n  }\n\n  /**\n   * Save asset to GitHub\n   */\n  async saveAssetGitHub(owner, repo, branch, assetPath, content, commitMessage, metadata = {}) {\n    try {\n      const userType = userAccessService.getUserType();\n      \n      // Check if user can save to GitHub\n      const canSave = await userAccessService.canSaveToGitHub(owner, repo, branch);\n      \n      if (!canSave) {\n        if (userType === 'demo') {\n          return {\n            result: OPERATION_RESULTS.DEMO_MODE_BLOCKED,\n            message: 'Demo users cannot save to GitHub. Changes can be saved locally.',\n            target: SAVE_TARGETS.GITHUB\n          };\n        } else if (userType === 'unauthenticated') {\n          return {\n            result: OPERATION_RESULTS.PERMISSION_DENIED,\n            message: 'Please authenticate to save changes to GitHub.',\n            target: SAVE_TARGETS.GITHUB\n          };\n        } else {\n          return {\n            result: OPERATION_RESULTS.PERMISSION_DENIED,\n            message: 'You do not have write access to this repository.',\n            target: SAVE_TARGETS.GITHUB\n          };\n        }\n      }\n\n      // For authenticated users with write access, save to GitHub\n      const result = await githubService.updateFileContent(\n        owner, \n        repo, \n        assetPath, \n        content, \n        commitMessage, \n        branch\n      );\n\n      if (result.success) {\n        // Remove from staging ground since it's now committed\n        stagingGroundService.removeFile(assetPath);\n        \n        // Clear cache\n        const cacheKey = `${owner}/${repo}/${branch}/${assetPath}`;\n        this.assetCache.delete(cacheKey);\n\n        this.logger.info('Asset saved to GitHub', { \n          owner, repo, branch, assetPath, commit: result.data?.commit?.sha \n        });\n\n        return {\n          result: OPERATION_RESULTS.SUCCESS,\n          message: 'Changes successfully committed to GitHub',\n          target: SAVE_TARGETS.GITHUB,\n          commitSha: result.data?.commit?.sha,\n          commitUrl: result.data?.commit?.html_url\n        };\n      } else {\n        throw new Error(result.error || 'GitHub commit failed');\n      }\n\n    } catch (error) {\n      this.logger.error('Error saving asset to GitHub', { \n        owner, repo, branch, assetPath, error: error.message \n      });\n      \n      return {\n        result: OPERATION_RESULTS.ERROR,\n        message: `Failed to save to GitHub: ${error.message}`,\n        target: SAVE_TARGETS.GITHUB\n      };\n    }\n  }\n\n  /**\n   * Get demo asset content for demo users\n   */\n  getDemoAssetContent(assetPath) {\n    const demoAssets = {\n      'input/vocabulary/ValueSet-anc-care-codes.json': JSON.stringify({\n        resourceType: \"ValueSet\",\n        id: \"anc-care-codes\",\n        name: \"ANCCareCodes\",\n        title: \"ANC Care Codes (Demo)\",\n        status: \"draft\",\n        description: \"Demo value set for antenatal care codes\",\n        compose: {\n          include: [{\n            system: \"http://example.org/anc-codes\",\n            concept: [\n              { code: \"anc-visit\", display: \"Antenatal Care Visit\" },\n              { code: \"anc-screening\", display: \"Antenatal Screening\" }\n            ]\n          }]\n        }\n      }, null, 2),\n      \n      'input/actors/Patient.json': JSON.stringify({\n        resourceType: \"ActorDefinition\",\n        id: \"patient\",\n        name: \"Patient\",\n        title: \"Patient (Demo)\",\n        status: \"draft\",\n        description: \"Demo patient actor definition\",\n        type: \"person\"\n      }, null, 2),\n\n      'README.md': `# Demo DAK Repository\n\nThis is a demo repository showing the structure of a SMART Guidelines DAK.\n\n## Components\n\n- **ValueSets**: Terminology definitions\n- **Actors**: System and person actors  \n- **Business Processes**: BPMN workflow definitions\n\nThis is demo data and cannot be saved to GitHub.`\n    };\n\n    return demoAssets[assetPath] || `# Demo Asset: ${assetPath}\n\nThis is demo content for the asset located at: ${assetPath}\n\nDemo users can edit this content and save it locally, but cannot commit changes to GitHub.`;\n  }\n\n  /**\n   * Get save options for current user and asset\n   */\n  async getSaveOptions(owner, repo, branch) {\n    const userType = userAccessService.getUserType();\n    const canSaveGitHub = await userAccessService.canSaveToGitHub(owner, repo, branch);\n    const canSaveLocal = userAccessService.canSaveLocal();\n    const uiBehavior = userAccessService.getUIBehavior();\n\n    return {\n      canSaveLocal,\n      canSaveGitHub,\n      showSaveLocal: uiBehavior.showSaveLocal,\n      showSaveGitHub: uiBehavior.showSaveToGitHub,\n      confirmBeforeSave: uiBehavior.confirmBeforeSave,\n      userType,\n      restrictions: this.getSaveRestrictions(userType, canSaveGitHub)\n    };\n  }\n\n  /**\n   * Get save restrictions and messaging for user type\n   */\n  getSaveRestrictions(userType, canSaveGitHub) {\n    switch (userType) {\n      case 'unauthenticated':\n        return {\n          localMessage: 'Changes will be saved to your browser only',\n          githubMessage: 'Please authenticate to save to GitHub',\n          githubDisabled: true\n        };\n      \n      case 'demo':\n        return {\n          localMessage: 'Changes will be saved to your browser only',\n          githubMessage: 'Demo users cannot save to GitHub',\n          githubDisabled: true\n        };\n      \n      case 'authenticated':\n        if (canSaveGitHub) {\n          return {\n            localMessage: 'Save changes to staging area',\n            githubMessage: 'Commit changes to GitHub repository',\n            githubDisabled: false\n          };\n        } else {\n          return {\n            localMessage: 'Changes will be saved to your browser only',\n            githubMessage: 'You do not have write access to this repository',\n            githubDisabled: true\n          };\n        }\n      \n      default:\n        return {\n          localMessage: 'Local saves only',\n          githubMessage: 'GitHub saves not available',\n          githubDisabled: true\n        };\n    }\n  }\n\n  /**\n   * Get staging ground status\n   */\n  getStagingGroundStatus() {\n    return stagingGroundService.getStatus();\n  }\n\n  /**\n   * Clear staging ground\n   */\n  clearStagingGround() {\n    return stagingGroundService.clearStagingGround();\n  }\n\n  /**\n   * Get changed files in staging ground\n   */\n  getChangedFiles() {\n    const stagingGround = stagingGroundService.getStagingGround();\n    return stagingGround.files;\n  }\n\n  /**\n   * Check if asset has local changes\n   */\n  hasLocalChanges(assetPath) {\n    const stagingGround = stagingGroundService.getStagingGround();\n    return stagingGround.files.some(f => f.path === assetPath);\n  }\n\n  /**\n   * Create new asset (when supported by user type)\n   */\n  async createAsset(owner, repo, branch, assetPath, initialContent = '', metadata = {}) {\n    const uiBehavior = userAccessService.getUIBehavior();\n    \n    if (!uiBehavior.allowCreateNew) {\n      throw new Error('Current user type cannot create new assets');\n    }\n\n    // Save as local first\n    return this.saveAssetLocal(assetPath, initialContent, {\n      ...metadata,\n      isNew: true,\n      createdAt: Date.now()\n    });\n  }\n\n  /**\n   * Batch operations for multiple assets\n   */\n  async batchSaveLocal(assets) {\n    const results = [];\n    \n    for (const asset of assets) {\n      const result = await this.saveAssetLocal(\n        asset.path, \n        asset.content, \n        asset.metadata\n      );\n      results.push({ ...result, path: asset.path });\n    }\n\n    return {\n      success: results.every(r => r.result === OPERATION_RESULTS.SUCCESS),\n      results\n    };\n  }\n\n  /**\n   * Get access information for current context\n   */\n  async getAccessInfo(owner, repo, branch) {\n    const [access, badge, saveOptions] = await Promise.all([\n      userAccessService.getRepositoryAccess(owner, repo, branch),\n      userAccessService.getAccessBadge(owner, repo, branch),\n      this.getSaveOptions(owner, repo, branch)\n    ]);\n\n    return {\n      access,\n      badge,\n      saveOptions,\n      userType: userAccessService.getUserType(),\n      isDemo: userAccessService.isDemoUser()\n    };\n  }\n}\n\n// Create singleton instance\nconst dataAccessLayer = new DataAccessLayer();\n\nexport default dataAccessLayer;","import React, { useState, useCallback, useEffect } from 'react';\nimport { PageLayout } from './index';\nimport SaveButtonsContainer from './SaveButtonsContainer';\nimport CommitMessageDialog from './CommitMessageDialog';\nimport dataAccessLayer from '../../services/dataAccessLayer';\n\n/**\n * Enhanced page framework for asset editors\n * Provides consistent save functionality with user access integration\n */\nconst AssetEditorLayout = ({\n  children,\n  pageName,\n  // Asset information\n  file,\n  repository,\n  branch,\n  // Content management\n  content,\n  originalContent,\n  hasChanges = false,\n  // Save callbacks\n  onSave,\n  onContentChange,\n  // Custom save functions (for special cases like BPMN that need XML export)\n  customSaveToGitHub,\n  // UI customization\n  showSaveButtons = true,\n  saveButtonsPosition = 'top', // 'top', 'bottom', 'both'\n  ...pageLayoutProps\n}) => {\n  // Save states\n  const [isSavingLocal, setIsSavingLocal] = useState(false);\n  const [isSavingGitHub, setIsSavingGitHub] = useState(false);\n  const [saveError, setSaveError] = useState(null);\n  const [localSaveSuccess, setLocalSaveSuccess] = useState(false);\n  const [githubSaveSuccess, setGithubSaveSuccess] = useState(false);\n  const [saveOptions, setSaveOptions] = useState(null);\n  \n  // Commit dialog state\n  const [showCommitDialog, setShowCommitDialog] = useState(false);\n  const [commitMessage, setCommitMessage] = useState('');\n\n  // Load save options based on current user and repository\n  useEffect(() => {\n    const loadSaveOptions = async () => {\n      if (repository) {\n        try {\n          const options = await dataAccessLayer.getSaveOptions(\n            repository.owner?.login,\n            repository.name,\n            branch\n          );\n          setSaveOptions(options);\n        } catch (error) {\n          console.error('Error loading save options:', error);\n        }\n      }\n    };\n\n    loadSaveOptions();\n  }, [repository, branch]);\n\n  // Check if user can save to GitHub based on access service\n  const canSaveToGitHub = saveOptions?.canSaveGitHub && saveOptions?.showSaveGitHub;\n\n  // Handle local save\n  const handleSaveLocal = useCallback(async () => {\n    if (!hasChanges || !file?.path) return;\n\n    try {\n      setIsSavingLocal(true);\n      setSaveError(null);\n      setLocalSaveSuccess(false);\n\n      // Use data access layer for local save\n      const result = await dataAccessLayer.saveAssetLocal(file.path, content, {\n        repository: repository?.full_name || `${repository?.owner?.login}/${repository?.name}`,\n        branch: branch || repository?.default_branch || 'main',\n        fileName: file.name,\n        timestamp: new Date().toISOString()\n      });\n      \n      if (result.result === 'success') {\n        setLocalSaveSuccess(true);\n        onSave && onSave(content, 'local');\n        \n        // Auto-hide success message after 3 seconds\n        setTimeout(() => {\n          setLocalSaveSuccess(false);\n        }, 3000);\n      } else {\n        throw new Error(result.message || 'Failed to save to local storage');\n      }\n\n    } catch (error) {\n      console.error('Error saving file locally:', error);\n      setSaveError(`Failed to save locally: ${error.message}`);\n    } finally {\n      setIsSavingLocal(false);\n    }\n  }, [hasChanges, file, content, repository, branch, onSave]);\n\n  // Handle GitHub save - shows commit dialog\n  const handleSaveGitHub = useCallback(() => {\n    if (!hasChanges || !canSaveToGitHub) return;\n    \n    setSaveError(null);\n    setShowCommitDialog(true);\n  }, [hasChanges, canSaveToGitHub]);\n\n  // Handle commit to GitHub with message\n  const handleCommitToGitHub = useCallback(async (message) => {\n    if (!message.trim() || !file?.path) return;\n\n    try {\n      setIsSavingGitHub(true);\n      setSaveError(null);\n      setGithubSaveSuccess(false);\n\n      // Use custom save function if provided (for special cases like BPMN)\n      if (customSaveToGitHub) {\n        const success = await customSaveToGitHub(message.trim());\n        if (success) {\n          setGithubSaveSuccess(true);\n          setShowCommitDialog(false);\n          setCommitMessage('');\n          onSave && onSave(content, 'github');\n          \n          // Auto-hide success message after 3 seconds\n          setTimeout(() => {\n            setGithubSaveSuccess(false);\n          }, 3000);\n        } else {\n          throw new Error('Custom save function failed');\n        }\n        return;\n      }\n\n      // Use data access layer for GitHub save\n      const result = await dataAccessLayer.saveAssetGitHub(\n        repository?.owner?.login,\n        repository?.name,\n        branch,\n        file.path,\n        content,\n        message.trim()\n      );\n\n      if (result.result === 'success') {\n        setGithubSaveSuccess(true);\n        setShowCommitDialog(false);\n        setCommitMessage('');\n        onSave && onSave(content, 'github');\n        \n        // Auto-hide success message after 3 seconds\n        setTimeout(() => {\n          setGithubSaveSuccess(false);\n        }, 3000);\n      } else {\n        // Handle different result types\n        let errorMessage = result.message;\n        if (result.result === 'demo_mode_blocked') {\n          errorMessage = 'Demo users cannot save to GitHub. You can save changes locally instead.';\n        } else if (result.result === 'permission_denied') {\n          errorMessage = 'You do not have permission to save to this repository.';\n        }\n        throw new Error(errorMessage);\n      }\n\n    } catch (error) {\n      console.error('Error saving file to GitHub:', error);\n      setSaveError(`Failed to save to GitHub: ${error.message}`);\n    } finally {\n      setIsSavingGitHub(false);\n    }\n  }, [file, content, repository, branch, onSave, customSaveToGitHub]);\n\n  // Handle commit dialog cancel\n  const handleCancelCommit = useCallback(() => {\n    setShowCommitDialog(false);\n    setCommitMessage('');\n  }, []);\n\n  const saveButtonsProps = {\n    // States\n    hasChanges,\n    isSavingLocal,\n    isSavingGitHub,\n    canSaveToGitHub,\n    localSaveSuccess,\n    githubSaveSuccess,\n    \n    // Handlers\n    onSaveLocal: handleSaveLocal,\n    onSaveGitHub: handleSaveGitHub\n  };\n\n  return (\n    <PageLayout pageName={pageName} {...pageLayoutProps}>\n      <div className=\"asset-editor-layout\">\n        {/* Top save buttons */}\n        {showSaveButtons && (saveButtonsPosition === 'top' || saveButtonsPosition === 'both') && (\n          <div className=\"save-buttons-top\">\n            <SaveButtonsContainer {...saveButtonsProps} />\n          </div>\n        )}\n\n        {/* Error display */}\n        {saveError && (\n          <div className=\"asset-editor-error\">\n            <span className=\"error-icon\">⚠️</span>\n            {saveError}\n            <button \n              className=\"btn-link error-dismiss\"\n              onClick={() => setSaveError(null)}\n            >\n              ✕\n            </button>\n          </div>\n        )}\n\n        {/* Success messages */}\n        {localSaveSuccess && (\n          <div className=\"asset-editor-success\">\n            <span className=\"success-icon\">✅</span>\n            Changes saved locally successfully!\n          </div>\n        )}\n        \n        {githubSaveSuccess && (\n          <div className=\"asset-editor-success\">\n            <span className=\"success-icon\">✅</span>\n            Changes committed to GitHub successfully!\n          </div>\n        )}\n\n        {/* Main content area */}\n        <div className=\"asset-editor-content\">\n          {children}\n        </div>\n\n        {/* Bottom save buttons */}\n        {showSaveButtons && (saveButtonsPosition === 'bottom' || saveButtonsPosition === 'both') && (\n          <div className=\"save-buttons-bottom\">\n            <SaveButtonsContainer {...saveButtonsProps} />\n          </div>\n        )}\n\n        {/* Commit message dialog */}\n        {showCommitDialog && (\n          <CommitMessageDialog\n            isOpen={showCommitDialog}\n            commitMessage={commitMessage}\n            setCommitMessage={setCommitMessage}\n            onCommit={handleCommitToGitHub}\n            onCancel={handleCancelCommit}\n            isSaving={isSavingGitHub}\n            fileName={file?.name}\n          />\n        )}\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AssetEditorLayout;","import { useState, useCallback, useEffect } from 'react';\nimport githubService from '../../services/githubService';\nimport localStorageService from '../../services/localStorageService';\n\n/**\n * Hook for managing asset editor save state and operations\n * Provides consistent save functionality for asset editors\n */\nexport const useAssetSave = ({\n  file,\n  repository,\n  branch,\n  content,\n  originalContent,\n  isDemo = false,\n  onSave\n}) => {\n  // Save states\n  const [isSavingLocal, setIsSavingLocal] = useState(false);\n  const [isSavingGitHub, setIsSavingGitHub] = useState(false);\n  const [saveError, setSaveError] = useState(null);\n  const [savedLocally, setSavedLocally] = useState(false);\n  const [localSaveSuccess, setLocalSaveSuccess] = useState(false);\n  const [githubSaveSuccess, setGithubSaveSuccess] = useState(false);\n\n  // Derived states\n  const hasChanges = content !== originalContent;\n  const canSaveToGitHub = githubService.isAuth() && !isDemo;\n\n  // Check if there's a local version of this file\n  useEffect(() => {\n    if (file?.path) {\n      const localContent = localStorageService.getLocalContent(file.path);\n      if (localContent && localContent !== originalContent) {\n        setSavedLocally(true);\n      } else {\n        setSavedLocally(false);\n      }\n    }\n  }, [file?.path, originalContent]);\n\n  // Reset success states when content changes\n  useEffect(() => {\n    if (hasChanges) {\n      setLocalSaveSuccess(false);\n      setGithubSaveSuccess(false);\n      setSaveError(null);\n    }\n  }, [hasChanges]);\n\n  // Handle local save\n  const saveLocal = useCallback(async () => {\n    if (!hasChanges || !file?.path) return false;\n\n    try {\n      setIsSavingLocal(true);\n      setSaveError(null);\n      setLocalSaveSuccess(false);\n\n      // Save to local storage\n      const metadata = {\n        repository: repository?.full_name || `${repository?.owner?.login}/${repository?.name}`,\n        branch: branch || repository?.default_branch || 'main',\n        fileName: file.name,\n        timestamp: new Date().toISOString()\n      };\n\n      const saved = localStorageService.saveLocal(file.path, content, metadata);\n      \n      if (saved) {\n        setSavedLocally(true);\n        setLocalSaveSuccess(true);\n        onSave && onSave(content, 'local');\n        \n        // Auto-hide success message after 3 seconds\n        setTimeout(() => {\n          setLocalSaveSuccess(false);\n        }, 3000);\n        \n        return true;\n      } else {\n        throw new Error('Failed to save to local storage');\n      }\n\n    } catch (error) {\n      console.error('Error saving file locally:', error);\n      setSaveError(`Failed to save locally: ${error.message}`);\n      return false;\n    } finally {\n      setIsSavingLocal(false);\n    }\n  }, [hasChanges, file, content, repository, branch, onSave]);\n\n  // Handle GitHub save with commit message\n  const saveToGitHub = useCallback(async (commitMessage) => {\n    if (!commitMessage?.trim() || !file?.path || !canSaveToGitHub) return false;\n\n    try {\n      setIsSavingGitHub(true);\n      setSaveError(null);\n      setGithubSaveSuccess(false);\n\n      let owner, repoName;\n      if (repository?.owner?.login) {\n        owner = repository.owner.login;\n        repoName = repository.name;\n      } else if (repository?.full_name) {\n        [owner, repoName] = repository.full_name.split('/');\n      } else {\n        throw new Error('Repository information not available');\n      }\n\n      await githubService.updateFile(\n        owner,\n        repoName,\n        file.path,\n        content,\n        commitMessage.trim(),\n        branch || repository?.default_branch || 'main'\n      );\n\n      setGithubSaveSuccess(true);\n      onSave && onSave(content, 'github');\n      \n      // Auto-hide success message after 3 seconds\n      setTimeout(() => {\n        setGithubSaveSuccess(false);\n      }, 3000);\n      \n      return true;\n\n    } catch (error) {\n      console.error('Error saving file to GitHub:', error);\n      setSaveError(`Failed to save to GitHub: ${error.message}`);\n      return false;\n    } finally {\n      setIsSavingGitHub(false);\n    }\n  }, [file, content, repository, branch, canSaveToGitHub, onSave]);\n\n  // Load local version of file\n  const loadLocalVersion = useCallback(() => {\n    if (file?.path) {\n      const localContent = localStorageService.getLocalContent(file.path);\n      return localContent;\n    }\n    return null;\n  }, [file?.path]);\n\n  // Discard local version\n  const discardLocalVersion = useCallback(() => {\n    if (file?.path) {\n      localStorageService.removeLocal(file.path);\n      setSavedLocally(false);\n      return true;\n    }\n    return false;\n  }, [file?.path]);\n\n  // Clear save error\n  const clearError = useCallback(() => {\n    setSaveError(null);\n  }, []);\n\n  // Export local changes\n  const exportLocalChanges = useCallback(() => {\n    try {\n      const exportData = localStorageService.exportLocalChanges('json');\n      const url = URL.createObjectURL(exportData);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `sgex-local-changes-${new Date().toISOString().split('T')[0]}.json`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n      return true;\n    } catch (error) {\n      console.error('Error exporting local changes:', error);\n      setSaveError(`Failed to export: ${error.message}`);\n      return false;\n    }\n  }, []);\n\n  return {\n    // States\n    hasChanges,\n    isSavingLocal,\n    isSavingGitHub,\n    saveError,\n    savedLocally,\n    localSaveSuccess,\n    githubSaveSuccess,\n    canSaveToGitHub,\n    \n    // Actions\n    saveLocal,\n    saveToGitHub,\n    loadLocalVersion,\n    discardLocalVersion,\n    clearError,\n    exportLocalChanges,\n    \n    // Utilities\n    isLoading: isSavingLocal || isSavingGitHub\n  };\n};","/**\n * Tool Definition Framework\n * \n * Provides a simple API for creating new tools in the SGEX Workbench.\n * Handles page setup, user access, data management, and UI integration.\n */\n\nimport React from 'react';\nimport { PageLayout, AssetEditorLayout } from './index';\nimport { usePageParams } from './usePageParams';\nimport userAccessService from '../../services/userAccessService';\nimport dataAccessLayer from '../../services/dataAccessLayer';\n\n/**\n * Tool types supported by the framework\n */\nexport const TOOL_TYPES = {\n  VIEWER: 'viewer',        // Read-only asset viewer\n  EDITOR: 'editor',        // Asset editor with save capabilities\n  DASHBOARD: 'dashboard',  // DAK-level dashboard\n  UTILITY: 'utility'       // General utility tool\n};\n\n/**\n * Base tool definition interface\n */\nexport class ToolDefinition {\n  constructor(config) {\n    this.id = config.id;\n    this.name = config.name;\n    this.title = config.title || config.name;\n    this.description = config.description;\n    this.type = config.type || TOOL_TYPES.UTILITY;\n    this.route = config.route || `/${this.id}`;\n    this.icon = config.icon;\n    this.category = config.category || 'general';\n    \n    // Access requirements\n    this.requiresAuth = config.requiresAuth !== false; // Default to true\n    this.supportsDemo = config.supportsDemo !== false; // Default to true\n    this.requiresDAK = config.requiresDAK || false;\n    \n    // Asset handling\n    this.assetTypes = config.assetTypes || [];\n    this.assetPattern = config.assetPattern;\n    \n    // UI components\n    this.viewerComponent = config.viewerComponent;\n    this.editorComponent = config.editorComponent;\n    this.dashboardComponent = config.dashboardComponent;\n    \n    // Hooks\n    this.onInit = config.onInit;\n    this.onAssetLoad = config.onAssetLoad;\n    this.onAssetSave = config.onAssetSave;\n    this.onError = config.onError;\n  }\n\n  /**\n   * Check if tool supports the given asset type\n   */\n  supportsAsset(assetPath) {\n    if (!this.assetTypes?.length && !this.assetPattern) {\n      return true; // Tool accepts any asset\n    }\n    \n    if (this.assetPattern) {\n      return new RegExp(this.assetPattern).test(assetPath);\n    }\n    \n    return this.assetTypes.some(type => assetPath.includes(type));\n  }\n\n  /**\n   * Check if current user can access this tool\n   */\n  async canAccess() {\n    if (this.requiresAuth && userAccessService.isUnauthenticated()) {\n      return false;\n    }\n    \n    if (!this.supportsDemo && userAccessService.isDemoUser()) {\n      return false;\n    }\n    \n    return true;\n  }\n\n  /**\n   * Generate React component for this tool\n   */\n  createComponent() {\n    const toolDef = this;\n    \n    return function ToolComponent(props) {\n      return <ToolWrapper toolDefinition={toolDef} {...props} />;\n    };\n  }\n}\n\n/**\n * Wrapper component that handles framework integration\n */\nconst ToolWrapper = ({ toolDefinition, ...props }) => {\n  const pageParams = usePageParams();\n  const [toolState, setToolState] = React.useState({\n    loading: true,\n    error: null,\n    canAccess: false,\n    assets: [],\n    content: null\n  });\n\n  const initializeTool = React.useCallback(async () => {\n    try {\n      setToolState(prev => ({ ...prev, loading: true, error: null }));\n\n      // Check access\n      const canAccess = await toolDefinition.canAccess();\n      if (!canAccess) {\n        throw new Error(`Access denied: This tool requires ${toolDefinition.requiresAuth ? 'authentication' : 'different user type'}`);\n      }\n\n      // Initialize data access layer if needed\n      if (pageParams.repository) {\n        await dataAccessLayer.initialize(pageParams.repository, pageParams.branch);\n      }\n\n      // Load assets if this is an asset tool\n      let assets = [];\n      let content = null;\n      \n      if (pageParams.asset && (toolDefinition.type === TOOL_TYPES.VIEWER || toolDefinition.type === TOOL_TYPES.EDITOR)) {\n        if (toolDefinition.supportsAsset(pageParams.asset)) {\n          const assetData = await dataAccessLayer.getAsset(\n            pageParams.user,\n            pageParams.repository?.name,\n            pageParams.branch,\n            pageParams.asset\n          );\n          assets = [{ path: pageParams.asset, ...assetData }];\n          content = assetData.content;\n        } else {\n          throw new Error(`This tool does not support asset type: ${pageParams.asset}`);\n        }\n      }\n\n      // Call tool's initialization hook\n      if (toolDefinition.onInit) {\n        await toolDefinition.onInit({\n          pageParams,\n          assets,\n          content\n        });\n      }\n\n      setToolState({\n        loading: false,\n        error: null,\n        canAccess: true,\n        assets,\n        content\n      });\n\n    } catch (error) {\n      console.error(`Error initializing tool ${toolDefinition.id}:`, error);\n      setToolState({\n        loading: false,\n        error: error.message,\n        canAccess: false,\n        assets: [],\n        content: null\n      });\n\n      // Call tool's error hook\n      if (toolDefinition.onError) {\n        toolDefinition.onError(error, { pageParams });\n      }\n    }\n  }, [toolDefinition, pageParams]);\n\n  React.useEffect(() => {\n    initializeTool();\n  }, [initializeTool]);\n\n  const handleAssetSave = async (newContent, saveType) => {\n    if (!pageParams.asset) return;\n\n    try {\n      let result;\n      if (saveType === 'local') {\n        result = await dataAccessLayer.saveAssetLocal(pageParams.asset, newContent);\n      } else if (saveType === 'github') {\n        // This should be called with commit message from UI\n        throw new Error('GitHub save requires commit message - use handleGitHubSave instead');\n      }\n\n      // Call tool's save hook\n      if (toolDefinition.onAssetSave) {\n        await toolDefinition.onAssetSave({\n          asset: pageParams.asset,\n          content: newContent,\n          saveType,\n          result,\n          pageParams\n        });\n      }\n\n      return result;\n    } catch (error) {\n      console.error(`Error saving asset in tool ${toolDefinition.id}:`, error);\n      throw error;\n    }\n  };\n\n  const handleGitHubSave = async (newContent, commitMessage) => {\n    if (!pageParams.asset) return;\n\n    try {\n      const result = await dataAccessLayer.saveAssetGitHub(\n        pageParams.user,\n        pageParams.repository?.name,\n        pageParams.branch,\n        pageParams.asset,\n        newContent,\n        commitMessage\n      );\n\n      // Call tool's save hook\n      if (toolDefinition.onAssetSave) {\n        await toolDefinition.onAssetSave({\n          asset: pageParams.asset,\n          content: newContent,\n          saveType: 'github',\n          result,\n          commitMessage,\n          pageParams\n        });\n      }\n\n      return result;\n    } catch (error) {\n      console.error(`Error saving asset to GitHub in tool ${toolDefinition.id}:`, error);\n      throw error;\n    }\n  };\n\n  // Show loading state\n  if (toolState.loading) {\n    return (\n      <PageLayout pageName={toolDefinition.id}>\n        <div className=\"tool-loading\">\n          <h2>Loading {toolDefinition.title}...</h2>\n          <p>Initializing tool and checking access permissions.</p>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  // Show error state\n  if (toolState.error || !toolState.canAccess) {\n    return (\n      <PageLayout pageName={toolDefinition.id}>\n        <div className=\"tool-error\">\n          <h2>Cannot Access {toolDefinition.title}</h2>\n          <p>{toolState.error || 'Access denied'}</p>\n          <button onClick={() => window.history.back()}>\n            Go Back\n          </button>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  // Render appropriate component based on tool type\n  const renderToolContent = () => {\n    const commonProps = {\n      toolDefinition,\n      pageParams,\n      toolState,\n      onAssetSave: handleAssetSave,\n      onGitHubSave: handleGitHubSave,\n      ...props\n    };\n\n    switch (toolDefinition.type) {\n      case TOOL_TYPES.EDITOR:\n        if (toolDefinition.editorComponent) {\n          const EditorComponent = toolDefinition.editorComponent;\n          \n          if (pageParams.asset && toolState.assets.length > 0) {\n            // Use AssetEditorLayout for asset editors\n            return (\n              <AssetEditorLayout\n                pageName={toolDefinition.id}\n                file={{ name: pageParams.asset, path: pageParams.asset }}\n                repository={pageParams.repository}\n                branch={pageParams.branch}\n                content={toolState.content}\n                originalContent={toolState.assets[0]?.content}\n                hasChanges={false} // Will be managed by the editor component\n                onSave={handleAssetSave}\n                onContentChange={(content) => {\n                  setToolState(prev => ({ ...prev, content }));\n                }}\n              >\n                <EditorComponent {...commonProps} />\n              </AssetEditorLayout>\n            );\n          } else {\n            // General editor without specific asset\n            return (\n              <PageLayout pageName={toolDefinition.id}>\n                <EditorComponent {...commonProps} />\n              </PageLayout>\n            );\n          }\n        }\n        break;\n\n      case TOOL_TYPES.VIEWER:\n        if (toolDefinition.viewerComponent) {\n          const ViewerComponent = toolDefinition.viewerComponent;\n          return (\n            <PageLayout pageName={toolDefinition.id}>\n              <ViewerComponent {...commonProps} />\n            </PageLayout>\n          );\n        }\n        break;\n\n      case TOOL_TYPES.DASHBOARD:\n        if (toolDefinition.dashboardComponent) {\n          const DashboardComponent = toolDefinition.dashboardComponent;\n          return (\n            <PageLayout pageName={toolDefinition.id}>\n              <DashboardComponent {...commonProps} />\n            </PageLayout>\n          );\n        }\n        break;\n\n      case TOOL_TYPES.UTILITY:\n      default:\n        // Use viewer component as fallback, or dashboard component\n        const Component = toolDefinition.viewerComponent || \n                         toolDefinition.editorComponent || \n                         toolDefinition.dashboardComponent;\n        \n        if (Component) {\n          return (\n            <PageLayout pageName={toolDefinition.id}>\n              <Component {...commonProps} />\n            </PageLayout>\n          );\n        }\n        break;\n    }\n\n    // Fallback if no component is provided\n    return (\n      <PageLayout pageName={toolDefinition.id}>\n        <div className=\"tool-fallback\">\n          <h1>{toolDefinition.title}</h1>\n          <p>{toolDefinition.description}</p>\n          <p>No component defined for this tool.</p>\n        </div>\n      </PageLayout>\n    );\n  };\n\n  return renderToolContent();\n};\n\n/**\n * Registry for managing tool definitions\n */\nclass ToolRegistry {\n  constructor() {\n    this.tools = new Map();\n  }\n\n  /**\n   * Register a new tool\n   */\n  register(config) {\n    const tool = new ToolDefinition(config);\n    this.tools.set(tool.id, tool);\n    return tool;\n  }\n\n  /**\n   * Get tool by ID\n   */\n  get(id) {\n    return this.tools.get(id);\n  }\n\n  /**\n   * Get all tools\n   */\n  getAll() {\n    return Array.from(this.tools.values());\n  }\n\n  /**\n   * Get tools by category\n   */\n  getByCategory(category) {\n    return this.getAll().filter(tool => tool.category === category);\n  }\n\n  /**\n   * Get tools that support a specific asset type\n   */\n  getByAssetType(assetPath) {\n    return this.getAll().filter(tool => tool.supportsAsset(assetPath));\n  }\n\n  /**\n   * Get tools accessible by current user\n   */\n  async getAccessibleTools() {\n    const tools = this.getAll();\n    const accessibleTools = [];\n\n    for (const tool of tools) {\n      if (await tool.canAccess()) {\n        accessibleTools.push(tool);\n      }\n    }\n\n    return accessibleTools;\n  }\n}\n\n// Create singleton registry\nconst toolRegistry = new ToolRegistry();\n\n/**\n * Helper function to create a simple tool\n */\nexport const createTool = (config) => {\n  return toolRegistry.register(config);\n};\n\n/**\n * Helper function to create an asset editor tool\n */\nexport const createAssetEditor = (config) => {\n  return createTool({\n    ...config,\n    type: TOOL_TYPES.EDITOR,\n    requiresDAK: true\n  });\n};\n\n/**\n * Helper function to create an asset viewer tool\n */\nexport const createAssetViewer = (config) => {\n  return createTool({\n    ...config,\n    type: TOOL_TYPES.VIEWER,\n    requiresDAK: true,\n    requiresAuth: false // Viewers can be used by unauthenticated users\n  });\n};\n\n/**\n * Helper function to create a dashboard tool\n */\nexport const createDashboard = (config) => {\n  return createTool({\n    ...config,\n    type: TOOL_TYPES.DASHBOARD,\n    requiresDAK: true\n  });\n};\n\nexport default toolRegistry;","/**\n * Cache Management Service\n * \n * Centralized service for managing all application cache and local storage\n * including repository cache, branch context, staging ground, and user data\n */\n\nimport repositoryCacheService from './repositoryCacheService';\nimport branchContextService from './branchContextService';\nimport logger from '../utils/logger';\n\nclass CacheManagementService {\n  constructor() {\n    this.logger = logger.getLogger('CacheManagementService');\n  }\n\n  /**\n   * Clear all application cache and local context\n   * This includes:\n   * - Repository cache (localStorage)\n   * - Branch context (sessionStorage) \n   * - Staging ground data (localStorage)\n   * - Any other SGEX-related local storage\n   */\n  clearAllCache() {\n    try {\n      this.logger.info('Starting complete cache clear operation');\n      \n      // Clear repository cache\n      const repoCacheCleared = repositoryCacheService.clearAllCaches();\n      this.logger.debug('Repository cache cleared', { success: repoCacheCleared });\n\n      // Clear branch context\n      branchContextService.clearAllBranchContext();\n      this.logger.debug('Branch context cleared');\n\n      // Clear staging ground data\n      this.clearAllStagingGrounds();\n      this.logger.debug('Staging ground data cleared');\n\n      // Clear any other SGEX-related localStorage items\n      this.clearOtherSGEXData();\n      this.logger.debug('Other SGEX data cleared');\n\n      this.logger.info('Complete cache clear operation completed successfully');\n      return true;\n    } catch (error) {\n      this.logger.error('Error during cache clear operation', { error: error.message });\n      console.error('Error clearing cache:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear all staging ground data across repositories and branches\n   */\n  clearAllStagingGrounds() {\n    try {\n      // Find all staging ground keys in localStorage\n      const keys = Object.keys(localStorage);\n      const stagingKeys = keys.filter(key => key.startsWith('sgex_staging_'));\n      \n      stagingKeys.forEach(key => {\n        localStorage.removeItem(key);\n        this.logger.debug('Removed staging ground', { key });\n      });\n\n      // Also clear staging ground history\n      const historyKeys = keys.filter(key => key.startsWith('sgex_staging_history_'));\n      historyKeys.forEach(key => {\n        localStorage.removeItem(key);\n        this.logger.debug('Removed staging ground history', { key });\n      });\n\n      return true;\n    } catch (error) {\n      this.logger.error('Error clearing staging grounds', { error: error.message });\n      console.warn('Error clearing staging grounds:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear other SGEX-related data that might be stored\n   */\n  clearOtherSGEXData() {\n    try {\n      const keys = Object.keys(localStorage);\n      const sgexKeys = keys.filter(key => \n        key.startsWith('sgex_') && \n        !key.startsWith('sgex_repo_cache_') && \n        !key.startsWith('sgex_staging_')\n      );\n      \n      sgexKeys.forEach(key => {\n        localStorage.removeItem(key);\n        this.logger.debug('Removed other SGEX data', { key });\n      });\n\n      // Also check sessionStorage for SGEX data (excluding branch context which is handled separately)\n      const sessionKeys = Object.keys(sessionStorage);\n      const sgexSessionKeys = sessionKeys.filter(key => \n        key.startsWith('sgex_') && key !== 'sgex_branch_context'\n      );\n      \n      sgexSessionKeys.forEach(key => {\n        sessionStorage.removeItem(key);\n        this.logger.debug('Removed SGEX session data', { key });\n      });\n\n      return true;\n    } catch (error) {\n      this.logger.error('Error clearing other SGEX data', { error: error.message });\n      console.warn('Error clearing other SGEX data:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get information about current cache usage\n   * Useful for debugging and showing users what will be cleared\n   */\n  getCacheInfo() {\n    try {\n      const info = {\n        repositoryCache: {\n          count: 0,\n          keys: []\n        },\n        branchContext: {\n          hasData: false,\n          repositoryCount: 0\n        },\n        stagingGround: {\n          count: 0,\n          keys: []\n        },\n        other: {\n          count: 0,\n          keys: []\n        }\n      };\n\n      // Check localStorage\n      const localKeys = Object.keys(localStorage);\n      \n      // Repository cache\n      info.repositoryCache.keys = localKeys.filter(key => key.startsWith('sgex_repo_cache_'));\n      info.repositoryCache.count = info.repositoryCache.keys.length;\n\n      // Staging ground\n      info.stagingGround.keys = localKeys.filter(key => \n        key.startsWith('sgex_staging_') || key.startsWith('sgex_staging_history_')\n      );\n      info.stagingGround.count = info.stagingGround.keys.length;\n\n      // Other SGEX data\n      info.other.keys = localKeys.filter(key => \n        key.startsWith('sgex_') && \n        !key.startsWith('sgex_repo_cache_') && \n        !key.startsWith('sgex_staging_')\n      );\n      info.other.count = info.other.keys.length;\n\n      // Check sessionStorage for branch context\n      try {\n        const branchContext = sessionStorage.getItem('sgex_branch_context');\n        if (branchContext) {\n          const parsed = JSON.parse(branchContext);\n          info.branchContext.hasData = true;\n          info.branchContext.repositoryCount = Object.keys(parsed).length;\n        }\n      } catch (e) {\n        // Ignore parsing errors\n      }\n\n      return info;\n    } catch (error) {\n      this.logger.error('Error getting cache info', { error: error.message });\n      return null;\n    }\n  }\n\n  /**\n   * Check if there's any uncommitted work that would be lost\n   * Returns information about staging grounds with unsaved changes\n   */\n  getUncommittedWork() {\n    try {\n      const uncommittedWork = [];\n      const keys = Object.keys(localStorage);\n      const stagingKeys = keys.filter(key => key.startsWith('sgex_staging_') && !key.includes('_history_'));\n      \n      stagingKeys.forEach(key => {\n        try {\n          const data = JSON.parse(localStorage.getItem(key));\n          if (data && data.files && data.files.length > 0) {\n            // Extract repository and branch from key\n            const keyParts = key.replace('sgex_staging_', '').split('_');\n            const branch = keyParts.pop();\n            const repository = keyParts.join('_');\n            \n            uncommittedWork.push({\n              repository,\n              branch,\n              fileCount: data.files.length,\n              lastModified: data.timestamp ? new Date(data.timestamp) : null,\n              message: data.message || ''\n            });\n          }\n        } catch (e) {\n          // Skip invalid entries\n        }\n      });\n\n      return uncommittedWork;\n    } catch (error) {\n      this.logger.error('Error checking uncommitted work', { error: error.message });\n      return [];\n    }\n  }\n}\n\n// Export singleton instance\nconst cacheManagementService = new CacheManagementService();\nexport default cacheManagementService;","import React, { useState, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\n// Default UN languages\nconst UN_LANGUAGES = [\n  { code: 'en', name: 'language.english', flag: '🇺🇸' },\n  { code: 'fr', name: 'language.french', flag: '🇫🇷' },\n  { code: 'es', name: 'language.spanish', flag: '🇪🇸' },\n  { code: 'ar', name: 'language.arabic', flag: '🇸🇦' },\n  { code: 'zh', name: 'language.chinese', flag: '🇨🇳' },\n  { code: 'ru', name: 'language.russian', flag: '🇷🇺' }\n];\n\n// Comprehensive ISO 639-1 language list with native names and English names for searchability\nconst ADDITIONAL_LANGUAGES = [\n  // European languages\n  { code: 'de', name: 'Deutsch', englishName: 'German', flag: '🇩🇪' },\n  { code: 'it', name: 'Italiano', englishName: 'Italian', flag: '🇮🇹' },\n  { code: 'pt', name: 'Português', englishName: 'Portuguese', flag: '🇵🇹' },\n  { code: 'nl', name: 'Nederlands', englishName: 'Dutch', flag: '🇳🇱' },\n  { code: 'sv', name: 'Svenska', englishName: 'Swedish', flag: '🇸🇪' },\n  { code: 'no', name: 'Norsk', englishName: 'Norwegian', flag: '🇳🇴' },\n  { code: 'da', name: 'Dansk', englishName: 'Danish', flag: '🇩🇰' },\n  { code: 'fi', name: 'Suomi', englishName: 'Finnish', flag: '🇫🇮' },\n  { code: 'pl', name: 'Polski', englishName: 'Polish', flag: '🇵🇱' },\n  { code: 'cs', name: 'Čeština', englishName: 'Czech', flag: '🇨🇿' },\n  { code: 'sk', name: 'Slovenčina', englishName: 'Slovak', flag: '🇸🇰' },\n  { code: 'hu', name: 'Magyar', englishName: 'Hungarian', flag: '🇭🇺' },\n  { code: 'ro', name: 'Română', englishName: 'Romanian', flag: '🇷🇴' },\n  { code: 'bg', name: 'Български', englishName: 'Bulgarian', flag: '🇧🇬' },\n  { code: 'hr', name: 'Hrvatski', englishName: 'Croatian', flag: '🇭🇷' },\n  { code: 'el', name: 'Ελληνικά', englishName: 'Greek', flag: '🇬🇷' },\n  { code: 'sr', name: 'Српски', englishName: 'Serbian', flag: '🇷🇸' },\n  { code: 'sl', name: 'Slovenščina', englishName: 'Slovenian', flag: '🇸🇮' },\n  { code: 'lv', name: 'Latviešu', englishName: 'Latvian', flag: '🇱🇻' },\n  { code: 'lt', name: 'Lietuvių', englishName: 'Lithuanian', flag: '🇱🇹' },\n  { code: 'et', name: 'Eesti', englishName: 'Estonian', flag: '🇪🇪' },\n  { code: 'mt', name: 'Malti', englishName: 'Maltese', flag: '🇲🇹' },\n  { code: 'is', name: 'Íslenska', englishName: 'Icelandic', flag: '🇮🇸' },\n  { code: 'ga', name: 'Gaeilge', englishName: 'Irish', flag: '🇮🇪' },\n  { code: 'cy', name: 'Cymraeg', englishName: 'Welsh', flag: '🏴' },\n  { code: 'eu', name: 'Euskera', englishName: 'Basque', flag: '🇪🇸' },\n  { code: 'ca', name: 'Català', englishName: 'Catalan', flag: '🇪🇸' },\n  { code: 'gl', name: 'Galego', englishName: 'Galician', flag: '🇪🇸' },\n\n  // Middle Eastern & Turkic languages\n  { code: 'tr', name: 'Türkçe', englishName: 'Turkish', flag: '🇹🇷' },\n  { code: 'he', name: 'עברית', englishName: 'Hebrew', flag: '🇮🇱' },\n  { code: 'fa', name: 'فارسی', englishName: 'Persian', flag: '🇮🇷' },\n  { code: 'ur', name: 'اردو', englishName: 'Urdu', flag: '🇵🇰' },\n  { code: 'ku', name: 'Kurdî', englishName: 'Kurdish', flag: '🇹🇷' },\n  { code: 'az', name: 'Azərbaycan', englishName: 'Azerbaijani', flag: '🇦🇿' },\n  { code: 'hy', name: 'Հայերեն', englishName: 'Armenian', flag: '🇦🇲' },\n  { code: 'ka', name: 'ქართული', englishName: 'Georgian', flag: '🇬🇪' },\n\n  // Asian languages\n  { code: 'ja', name: '日本語', englishName: 'Japanese', flag: '🇯🇵' },\n  { code: 'ko', name: '한국어', englishName: 'Korean', flag: '🇰🇷' },\n  { code: 'hi', name: 'हिन्दी', englishName: 'Hindi', flag: '🇮🇳' },\n  { code: 'th', name: 'ไทย', englishName: 'Thai', flag: '🇹🇭' },\n  { code: 'vi', name: 'Tiếng Việt', englishName: 'Vietnamese', flag: '🇻🇳' },\n  { code: 'bn', name: 'বাংলা', englishName: 'Bengali', flag: '🇧🇩' },\n  { code: 'ta', name: 'தமிழ்', englishName: 'Tamil', flag: '🇮🇳' },\n  { code: 'te', name: 'తెలుగు', englishName: 'Telugu', flag: '🇮🇳' },\n  { code: 'ml', name: 'മലയാളം', englishName: 'Malayalam', flag: '🇮🇳' },\n  { code: 'kn', name: 'ಕನ್ನಡ', englishName: 'Kannada', flag: '🇮🇳' },\n  { code: 'gu', name: 'ગુજરાતી', englishName: 'Gujarati', flag: '🇮🇳' },\n  { code: 'mr', name: 'मराठी', englishName: 'Marathi', flag: '🇮🇳' },\n  { code: 'pa', name: 'ਪੰਜਾਬੀ', englishName: 'Punjabi', flag: '🇮🇳' },\n  { code: 'or', name: 'ଓଡ଼ିଆ', englishName: 'Odia', flag: '🇮🇳' },\n  { code: 'as', name: 'অসমীয়া', englishName: 'Assamese', flag: '🇮🇳' },\n  { code: 'ne', name: 'नेपाली', englishName: 'Nepali', flag: '🇳🇵' },\n  { code: 'si', name: 'සිංහල', englishName: 'Sinhala', flag: '🇱🇰' },\n  { code: 'my', name: 'မြန်မာ', englishName: 'Myanmar', flag: '🇲🇲' },\n  { code: 'km', name: 'ខ្មែរ', englishName: 'Khmer', flag: '🇰🇭' },\n  { code: 'lo', name: 'ລາວ', englishName: 'Lao', flag: '🇱🇦' },\n  { code: 'mn', name: 'Монгол', englishName: 'Mongolian', flag: '🇲🇳' },\n  { code: 'bo', name: 'བོད་ཡིག', englishName: 'Tibetan', flag: '🇨🇳' },\n  { code: 'dz', name: 'རྫོང་ཁ', englishName: 'Dzongkha', flag: '🇧🇹' },\n\n  // Southeast Asian languages\n  { code: 'id', name: 'Bahasa Indonesia', englishName: 'Indonesian', flag: '🇮🇩' },\n  { code: 'ms', name: 'Bahasa Melayu', englishName: 'Malay', flag: '🇲🇾' },\n  { code: 'tl', name: 'Filipino', englishName: 'Filipino', flag: '🇵🇭' },\n  { code: 'ceb', name: 'Cebuano', englishName: 'Cebuano', flag: '🇵🇭' },\n  { code: 'jv', name: 'Basa Jawa', englishName: 'Javanese', flag: '🇮🇩' },\n\n  // African languages\n  { code: 'sw', name: 'Kiswahili', englishName: 'Swahili', flag: '🇰🇪' },\n  { code: 'am', name: 'አማርኛ', englishName: 'Amharic', flag: '🇪🇹' },\n  { code: 'yo', name: 'Yorùbá', englishName: 'Yoruba', flag: '🇳🇬' },\n  { code: 'ig', name: 'Igbo', englishName: 'Igbo', flag: '🇳🇬' },\n  { code: 'ha', name: 'Hausa', englishName: 'Hausa', flag: '🇳🇬' },\n  { code: 'zu', name: 'isiZulu', englishName: 'Zulu', flag: '🇿🇦' },\n  { code: 'af', name: 'Afrikaans', englishName: 'Afrikaans', flag: '🇿🇦' },\n  { code: 'xh', name: 'isiXhosa', englishName: 'Xhosa', flag: '🇿🇦' },\n  { code: 'st', name: 'Sesotho', englishName: 'Sotho', flag: '🇱🇸' },\n  { code: 'tn', name: 'Setswana', englishName: 'Tswana', flag: '🇧🇼' },\n  { code: 'ss', name: 'SiSwati', englishName: 'Swati', flag: '🇸🇿' },\n  { code: 've', name: 'Tshivenḓa', englishName: 'Venda', flag: '🇿🇦' },\n  { code: 'ts', name: 'Xitsonga', englishName: 'Tsonga', flag: '🇿🇦' },\n  { code: 'sn', name: 'ChiShona', englishName: 'Shona', flag: '🇿🇼' },\n  { code: 'ny', name: 'ChiCheŵa', englishName: 'Chewa', flag: '🇲🇼' },\n  { code: 'rw', name: 'Kinyarwanda', englishName: 'Kinyarwanda', flag: '🇷🇼' },\n  { code: 'rn', name: 'Kirundi', englishName: 'Kirundi', flag: '🇧🇮' },\n  { code: 'lg', name: 'Luganda', englishName: 'Luganda', flag: '🇺🇬' },\n  { code: 'so', name: 'Soomaali', englishName: 'Somali', flag: '🇸🇴' },\n  { code: 'om', name: 'Afaan Oromoo', englishName: 'Oromo', flag: '🇪🇹' },\n  { code: 'ti', name: 'ትግርኛ', englishName: 'Tigrinya', flag: '🇪🇷' },\n\n  // Latin American indigenous languages\n  { code: 'qu', name: 'Quechua', englishName: 'Quechua', flag: '🇵🇪' },\n  { code: 'gn', name: 'Guaraní', englishName: 'Guarani', flag: '🇵🇾' },\n  { code: 'ay', name: 'Aymará', englishName: 'Aymara', flag: '🇧🇴' },\n\n  // Pacific languages\n  { code: 'mi', name: 'Te Reo Māori', englishName: 'Maori', flag: '🇳🇿' },\n  { code: 'sm', name: 'Gagana Samoa', englishName: 'Samoan', flag: '🇼🇸' },\n  { code: 'to', name: 'Lea Faka-Tonga', englishName: 'Tongan', flag: '🇹🇴' },\n  { code: 'fj', name: 'Na Vosa Vakaviti', englishName: 'Fijian', flag: '🇫🇯' },\n\n  // Additional European languages\n  { code: 'fo', name: 'Føroyskt', englishName: 'Faroese', flag: '🇫🇴' },\n  { code: 'kl', name: 'Kalaallisut', englishName: 'Greenlandic', flag: '🇬🇱' },\n  { code: 'se', name: 'Davvisámegiella', englishName: 'Northern Sami', flag: '🇳🇴' },\n\n  // Other languages\n  { code: 'eo', name: 'Esperanto', englishName: 'Esperanto', flag: '🌍' },\n  { code: 'la', name: 'Latina', englishName: 'Latin', flag: '🇻🇦' },\n  { code: 'sa', name: 'संस्कृतम्', englishName: 'Sanskrit', flag: '🇮🇳' }\n];\n\nconst LanguageSelector = ({ className = '' }) => {\n  const { i18n, t } = useTranslation();\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedLanguages, setSelectedLanguages] = useState(() => {\n    // Get selected languages from localStorage or default to UN languages\n    const saved = localStorage.getItem('sgex-selected-languages');\n    return saved ? JSON.parse(saved) : UN_LANGUAGES.map(lang => lang.code);\n  });\n\n  // Get available languages (UN languages + any additional selected languages)\n  const availableLanguages = useMemo(() => {\n    // Start with all UN languages\n    const languages = [...UN_LANGUAGES];\n    \n    // Add any additional languages that have been selected\n    selectedLanguages.forEach(langCode => {\n      // If this language code is not already in UN_LANGUAGES, find it in ADDITIONAL_LANGUAGES\n      if (!UN_LANGUAGES.some(unLang => unLang.code === langCode)) {\n        const additionalLang = ADDITIONAL_LANGUAGES.find(addLang => addLang.code === langCode);\n        if (additionalLang) {\n          languages.push({\n            code: additionalLang.code,\n            name: additionalLang.name, // Use the native name for additional languages\n            englishName: additionalLang.englishName, // Include English name for consistency\n            flag: additionalLang.flag\n          });\n        }\n      }\n    });\n    \n    // Map the languages to include translated names for UN languages\n    return languages.map(lang => ({\n      ...lang,\n      name: UN_LANGUAGES.some(unLang => unLang.code === lang.code) ? t(lang.name) : lang.name\n    }));\n  }, [selectedLanguages, t]);\n\n  // Get searchable languages (excluding already selected ones)\n  const searchableLanguages = useMemo(() => {\n    if (!searchTerm) return [];\n    \n    const searchLower = searchTerm.toLowerCase();\n    return ADDITIONAL_LANGUAGES.filter(lang => \n      !selectedLanguages.includes(lang.code) &&\n      (lang.name.toLowerCase().includes(searchLower) || \n       lang.englishName.toLowerCase().includes(searchLower) ||\n       lang.code.toLowerCase().includes(searchLower))\n    ).slice(0, 10); // Limit to 10 results\n  }, [searchTerm, selectedLanguages]);\n\n  const currentLanguage = availableLanguages.find(lang => lang.code === i18n.language) || availableLanguages[0];\n\n  const handleLanguageChange = (langCode) => {\n    i18n.changeLanguage(langCode);\n    setIsOpen(false);\n    setSearchTerm('');\n  };\n\n  const handleAddLanguage = (langCode) => {\n    const newSelectedLanguages = [...selectedLanguages, langCode];\n    setSelectedLanguages(newSelectedLanguages);\n    localStorage.setItem('sgex-selected-languages', JSON.stringify(newSelectedLanguages));\n    \n    // Optionally switch to the newly added language\n    i18n.changeLanguage(langCode);\n    setIsOpen(false);\n    setSearchTerm('');\n  };\n\n  const handleSearchChange = (e) => {\n    setSearchTerm(e.target.value);\n  };\n\n  return (\n    <div className={`language-selector ${className}`}>\n      <button\n        className=\"language-toggle\"\n        onClick={() => setIsOpen(!isOpen)}\n        aria-label={t('language.select')}\n        title={t('language.select')}\n      >\n        <span className=\"language-icon\">🐾🎧</span>\n        <span className=\"language-name\">{currentLanguage?.name}</span>\n        <span className={`dropdown-arrow ${isOpen ? 'open' : ''}`}>▼</span>\n      </button>\n      \n      {isOpen && (\n        <div className=\"language-dropdown\">\n          {/* Available Languages */}\n          {availableLanguages.map((language) => (\n            <button\n              key={language.code}\n              className={`language-option ${i18n.language === language.code ? 'active' : ''}`}\n              onClick={() => handleLanguageChange(language.code)}\n            >\n              <span className=\"language-flag\">{language.flag}</span>\n              <span className=\"language-name\">{language.name}</span>\n              {i18n.language === language.code && (\n                <span className=\"language-checkmark\">✓</span>\n              )}\n            </button>\n          ))}\n          \n          {/* Search Section */}\n          <div className=\"language-search-section\">\n            <div className=\"language-search-divider\"></div>\n            <div className=\"language-search-input\">\n              <input\n                type=\"text\"\n                placeholder={t('language.search')}\n                value={searchTerm}\n                onChange={handleSearchChange}\n                className=\"language-search\"\n                autoFocus={false}\n              />\n            </div>\n            \n            {/* Search Results */}\n            {searchableLanguages.map((language) => (\n              <button\n                key={language.code}\n                className=\"language-option language-option-addable\"\n                onClick={() => handleAddLanguage(language.code)}\n              >\n                <span className=\"language-flag\">{language.flag}</span>\n                <span className=\"language-name\">\n                  {language.name}\n                  {language.englishName !== language.name && (\n                    <span className=\"language-english-name\"> ({language.englishName})</span>\n                  )}\n                </span>\n                <span className=\"language-add-icon\">+</span>\n              </button>\n            ))}\n            \n            {searchTerm && searchableLanguages.length === 0 && (\n              <div className=\"language-no-results\">\n                No languages found for \"{searchTerm}\"\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LanguageSelector;","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport helpContentService from '../services/helpContentService';\nimport cacheManagementService from '../services/cacheManagementService';\nimport HelpModal from './HelpModal';\nimport LanguageSelector from './LanguageSelector';\nimport useThemeImage from '../hooks/useThemeImage';\n\nconst ContextualHelpMascot = ({ pageId, helpContent, position = 'bottom-right', contextData = {}, notificationBadge = false }) => {\n  const { t, i18n } = useTranslation();\n  const [showHelp, setShowHelp] = useState(false);\n  const [helpSticky, setHelpSticky] = useState(false);\n  const [selectedHelpTopic, setSelectedHelpTopic] = useState(null);\n  const [isDarkMode, setIsDarkMode] = useState(true);\n  const [cacheClearing, setCacheClearing] = useState(false);\n  const [cacheCleared, setCacheCleared] = useState(false);\n\n  // Theme-aware mascot image\n  const mascotImage = useThemeImage('sgex-mascot.png');\n\n  // Load theme preference from localStorage on mount\n  useEffect(() => {\n    const savedTheme = localStorage.getItem('sgex-theme');\n    if (savedTheme) {\n      setIsDarkMode(savedTheme === 'dark');\n    } else {\n      // Check if user explicitly prefers light mode\n      let prefersLight = false;\n      try {\n        if (window.matchMedia) {\n          prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;\n        }\n      } catch (e) {\n        // Fallback for test environments\n        prefersLight = false;\n      }\n      // Default to dark mode unless user explicitly prefers light\n      setIsDarkMode(!prefersLight);\n    }\n  }, []);\n\n  // Update body class when theme changes\n  useEffect(() => {\n    document.body.className = isDarkMode ? 'theme-dark' : 'theme-light';\n    localStorage.setItem('sgex-theme', isDarkMode ? 'dark' : 'light');\n  }, [isDarkMode]);\n\n  // Update document direction for RTL languages\n  useEffect(() => {\n    const currentLang = i18n.language || 'en';\n    const isRTL = ['ar', 'he', 'fa'].includes(currentLang);\n    document.documentElement.dir = isRTL ? 'rtl' : 'ltr';\n    document.documentElement.lang = currentLang;\n  }, [i18n.language]);\n\n  const toggleTheme = () => {\n    setIsDarkMode(!isDarkMode);\n  };\n\n  // Get help topics for the page\n  const helpTopics = pageId ? helpContentService.getHelpTopicsForPage(pageId, contextData) : [];\n\n  const handleMouseEnter = () => {\n    if (!helpSticky) {\n      setShowHelp(true);\n    }\n  };\n\n  const handleMouseLeave = () => {\n    if (!helpSticky) {\n      setShowHelp(false);\n    }\n  };\n\n  const handleClick = () => {\n    setHelpSticky(!helpSticky);\n    setShowHelp(!helpSticky || showHelp);\n  };\n\n  const handleCloseHelp = () => {\n    setShowHelp(false);\n    setHelpSticky(false);\n  };\n\n  const handleHelpTopicClick = (topic) => {\n    // If it's an action type, execute the action immediately\n    if (topic.type === 'action' && topic.action) {\n      topic.action();\n      setShowHelp(false);\n      setHelpSticky(false);\n    } else {\n      // For slideshow and other types, show in modal\n      setSelectedHelpTopic(topic);\n      setShowHelp(false);\n      setHelpSticky(false);\n    }\n  };\n\n  const handleCloseModal = () => {\n    setSelectedHelpTopic(null);\n  };\n\n  const handleFlushCache = async () => {\n    if (cacheClearing) return; // Prevent multiple clicks\n    \n    setCacheClearing(true);\n    setCacheCleared(false);\n    \n    try {\n      const success = cacheManagementService.clearAllCache();\n      if (success) {\n        setCacheCleared(true);\n        // Auto-hide success message after 3 seconds\n        setTimeout(() => {\n          setCacheCleared(false);\n        }, 3000);\n      } else {\n        console.error('Failed to clear cache');\n        alert('Failed to clear cache. Please try again.');\n      }\n    } catch (error) {\n      console.error('Error clearing cache:', error);\n      alert('Error clearing cache. Please try again.');\n    } finally {\n      setCacheClearing(false);\n    }\n  };\n\n  // Always render the mascot now since we have universal topics\n  // if (!hasTopics) {\n  //   return null;\n  // }\n\n  return (\n    <>\n      <div className={`contextual-help-mascot ${position}`}>\n        <div \n          className=\"mascot-container\"\n          onMouseEnter={handleMouseEnter}\n          onMouseLeave={handleMouseLeave}\n          onClick={handleClick}\n        >\n          <img \n            src={mascotImage} \n            alt=\"SGEX Helper\" \n            className=\"mascot-icon\"\n          />\n          \n          {/* Notification badge for important help messages */}\n          {notificationBadge && (\n            <div className=\"notification-badge\">\n              !\n            </div>\n          )}\n          \n          {/* Question mark thought bubble - always show since we always have topics now */}\n          {!notificationBadge && (\n            <div className={`question-bubble ${showHelp ? 'help-open' : ''}`}>\n              ?\n            </div>\n          )}\n        </div>\n        \n        {showHelp && (\n          <div className=\"help-thought-bubble\">\n            <div className=\"bubble-content\">\n              {helpSticky && (\n                <button \n                  className=\"close-bubble-btn\"\n                  onClick={handleCloseHelp}\n                  aria-label=\"Close help\"\n                >\n                  ×\n                </button>\n              )}\n              <div className=\"help-text\">\n                {helpTopics.length > 0 ? (\n                  <div className=\"help-topics-list\">\n                    <h4>{t('help.title')}</h4>\n                    {helpTopics.map((topic) => (\n                      <button\n                        key={topic.id}\n                        className=\"help-topic-btn\"\n                        onClick={() => handleHelpTopicClick(topic)}\n                      >\n                        {topic.badge && (\n                          <img \n                            src={topic.badge} \n                            alt=\"\" \n                            className=\"help-topic-badge\"\n                          />\n                        )}\n                        <span className=\"help-topic-title\">{topic.title}</span>\n                      </button>\n                    ))}\n                    \n                    {/* Language Selector in Help Menu */}\n                    <div className=\"help-menu-divider\"></div>\n                    <LanguageSelector className=\"help-menu-language-selector\" />\n                    \n                    {/* Theme Toggle in Help Menu */}\n                    <div className=\"help-menu-divider\"></div>\n                    <button \n                      className={`help-theme-toggle-btn ${isDarkMode ? 'dark' : 'light'}`}\n                      onClick={toggleTheme}\n                      aria-label={t('theme.toggle')}\n                      title={t('theme.toggle')}\n                    >\n                      <span className=\"theme-icon\">{isDarkMode ? '🌞' : '🌙'}</span>\n                      <span className=\"theme-label\">{isDarkMode ? t('theme.switchToLight', 'Light Mode') : t('theme.switchToDark', 'Dark Mode')}</span>\n                    </button>\n                    \n                    {/* Flush Cache Option */}\n                    <div className=\"help-menu-divider\"></div>\n                    <div className=\"help-menu-cache-section\">\n                      {cacheCleared ? (\n                        <div className=\"cache-success-message\">\n                          ✅ Cache cleared successfully!\n                        </div>\n                      ) : (\n                        <button\n                          className=\"help-cache-btn\"\n                          onClick={handleFlushCache}\n                          disabled={cacheClearing}\n                          title=\"Clear all cached data including repository info, branch context, and staging ground data\"\n                        >\n                          {cacheClearing ? '🔄 Clearing...' : '🗑️ Flush Cache'}\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                ) : (\n                  <div>\n                    {helpContent}\n                    {/* Language Selector in Help Menu */}\n                    <div className=\"help-menu-divider\"></div>\n                    <LanguageSelector className=\"help-menu-language-selector\" />\n                    \n                    {/* Theme Toggle in Help Menu */}\n                    <div className=\"help-menu-divider\"></div>\n                    <button \n                      className={`help-theme-toggle-btn ${isDarkMode ? 'dark' : 'light'}`}\n                      onClick={toggleTheme}\n                      aria-label={t('theme.toggle')}\n                      title={t('theme.toggle')}\n                    >\n                      <span className=\"theme-icon\">{isDarkMode ? '🌞' : '🌙'}</span>\n                      <span className=\"theme-label\">{isDarkMode ? t('theme.switchToLight', 'Light Mode') : t('theme.switchToDark', 'Dark Mode')}</span>\n                    </button>\n                    \n                    {/* Flush Cache Option */}\n                    <div className=\"help-menu-divider\"></div>\n                    <div className=\"help-menu-cache-section\">\n                      {cacheCleared ? (\n                        <div className=\"cache-success-message\">\n                          ✅ Cache cleared successfully!\n                        </div>\n                      ) : (\n                        <button\n                          className=\"help-cache-btn\"\n                          onClick={handleFlushCache}\n                          disabled={cacheClearing}\n                          title=\"Clear all cached data including repository info, branch context, and staging ground data\"\n                        >\n                          {cacheClearing ? '🔄 Clearing...' : '🗑️ Flush Cache'}\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n            <div className=\"bubble-tail\"></div>\n          </div>\n        )}\n      </div>\n      \n      {/* Help Modal for displaying slideshow content */}\n      {selectedHelpTopic && (\n        <HelpModal\n          helpTopic={selectedHelpTopic}\n          contextData={contextData}\n          onClose={handleCloseModal}\n        />\n      )}\n    </>\n  );\n};\n\nexport default ContextualHelpMascot;","import { useState, useEffect } from 'react';\n\n/**\n * Custom hook that returns the appropriate image path based on the current theme\n * @param {string} baseImagePath - The base image path (e.g., \"sgex-mascot.png\", \"authoring.png\")\n * @returns {string} The theme-appropriate image path\n */\nconst useThemeImage = (baseImagePath) => {\n  const [currentImagePath, setCurrentImagePath] = useState(baseImagePath);\n\n  useEffect(() => {\n    const updateImagePath = () => {\n      const isDarkMode = document.body.classList.contains('theme-dark');\n      \n      // Get the correct base path for the deployment environment\n      const publicUrl = process.env.PUBLIC_URL || '';\n      \n      // Normalize the base image path (remove leading slash if present)\n      const normalizedPath = baseImagePath.startsWith('/') ? baseImagePath.slice(1) : baseImagePath;\n      \n      let finalPath;\n      if (isDarkMode) {\n        // Convert base image to dark mode version\n        // e.g., \"sgex-mascot.png\" -> \"sgex-mascot_grey_tabby.png\"\n        const darkImageName = normalizedPath.replace(/\\.png$/, '_grey_tabby.png');\n        finalPath = publicUrl ? `${publicUrl}/${darkImageName}` : `/${darkImageName}`;\n      } else {\n        // Use original image for light mode\n        finalPath = publicUrl ? `${publicUrl}/${normalizedPath}` : `/${normalizedPath}`;\n      }\n      \n      setCurrentImagePath(finalPath);\n    };\n\n    // Initial update\n    updateImagePath();\n\n    // Create a MutationObserver to watch for body class changes\n    const observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {\n          updateImagePath();\n        }\n      });\n    });\n\n    // Start observing the body for class changes\n    observer.observe(document.body, {\n      attributes: true,\n      attributeFilter: ['class']\n    });\n\n    // Cleanup observer on unmount\n    return () => {\n      observer.disconnect();\n    };\n  }, [baseImagePath]);\n\n  return currentImagePath;\n};\n\nexport default useThemeImage;","import React, { useState, useEffect } from 'react';\nimport useThemeImage from '../hooks/useThemeImage';\n\nconst HelpModal = ({ topic, helpTopic, contextData, onClose }) => {\n  const [showMenu, setShowMenu] = useState(false);\n  const [currentSlide, setCurrentSlide] = useState(0);\n\n  // Theme-aware mascot image\n  const mascotImage = useThemeImage('sgex-mascot.png');\n\n  // Set up global reference for inline onclick handlers\n  useEffect(() => {\n    const createContextualUrl = (baseUrl, params) => {\n      const urlParams = new URLSearchParams(params);\n      \n      // Add contextual information\n      if (contextData.pageId) {\n        urlParams.set('sgex_page', contextData.pageId);\n      }\n      \n      const currentUrl = window.location.href;\n      urlParams.set('sgex_current_url', currentUrl);\n      \n      if (contextData.selectedDak?.name) {\n        urlParams.set('sgex_selected_dak', contextData.selectedDak.name);\n      }\n      \n      return `${baseUrl}?${urlParams.toString()}`;\n    };\n\n    window.helpModalInstance = {\n      openSgexIssue: (issueType) => {\n        const baseUrl = `https://github.com/litlfred/sgex/issues/new`;\n        let params = {};\n\n        switch (issueType) {\n          case 'bug':\n            params.template = 'bug_report.yml';\n            params.labels = 'bug';\n            break;\n          case 'feature':\n            params.template = 'feature_request.yml';\n            params.labels = 'enhancement';\n            break;\n          case 'question':\n            params.template = 'question.yml';\n            params.labels = 'question';\n            break;\n          case 'documentation':\n            params.template = 'documentation.yml';\n            params.labels = 'documentation';\n            break;\n          case 'blank':\n            // No template specified - this will allow users to create a blank issue\n            params.labels = 'blank-issue';\n            break;\n          default:\n            params.labels = 'needs-triage';\n        }\n\n        const url = createContextualUrl(baseUrl, params);\n        \n        // Try to open the GitHub issue, but handle cases where external links are blocked\n        try {\n          const newWindow = window.open(url, '_blank');\n          \n          // Check if the window was blocked or failed to open\n          if (!newWindow || newWindow.closed) {\n            // Fallback: show instructions to manually open the link\n            window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, issueType);\n          } else {\n            // Check if the window actually loaded after a brief delay\n            setTimeout(() => {\n              try {\n                if (newWindow.closed || !newWindow.location || newWindow.location.href === 'about:blank') {\n                  newWindow.close();\n                  window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, issueType);\n                }\n              } catch (e) {\n                // Cross-origin restriction means it probably loaded successfully\n                // or the check failed due to security - either way, don't show fallback\n              }\n            }, 1000);\n          }\n        } catch (error) {\n          console.warn('Failed to open GitHub issue:', error);\n          window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, issueType);\n        }\n      },\n\n      openDakIssue: (issueType) => {\n        const repository = contextData.repository || contextData.selectedDak;\n        if (!repository) {\n          console.warn('No DAK repository specified for feedback');\n          return;\n        }\n\n        const baseUrl = `https://github.com/${repository.owner}/${repository.name}/issues/new`;\n        let params = {};\n\n        switch (issueType) {\n          case 'bug':\n            params.template = 'dak_bug_report.yml';\n            params.labels = 'bug,dak-issue';\n            break;\n          case 'improvement':\n            params.template = 'dak_feature_request.yml';\n            params.labels = 'enhancement,dak-improvement';\n            break;\n          case 'content':\n            params.template = 'dak_content_error.yml';\n            params.labels = 'content-issue,clinical-content';\n            break;\n          case 'question':\n            params.template = 'dak_question.yml';\n            params.labels = 'question,dak-question';\n            break;\n          case 'blank':\n            // No template specified - this will allow users to create a blank issue\n            params.labels = 'blank-issue,dak-feedback';\n            break;\n          default:\n            params.labels = 'dak-feedback';\n        }\n\n        // Add DAK-specific context\n        if (repository.name) {\n          params.sgex_dak_repository = `${repository.owner}/${repository.name}`;\n        }\n\n        const url = createContextualUrl(baseUrl, params);\n        \n        // Try to open the GitHub issue, but handle cases where external links are blocked\n        try {\n          const newWindow = window.open(url, '_blank');\n          \n          // Check if the window was blocked or failed to open\n          if (!newWindow || newWindow.closed) {\n            // Fallback: show instructions to manually open the link\n            window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, `dak-${issueType}`);\n          } else {\n            // Check if the window actually loaded after a brief delay\n            setTimeout(() => {\n              try {\n                if (newWindow.closed || !newWindow.location || newWindow.location.href === 'about:blank') {\n                  newWindow.close();\n                  window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, `dak-${issueType}`);\n                }\n              } catch (e) {\n                // Cross-origin restriction means it probably loaded successfully\n                // or the check failed due to security - either way, don't show fallback\n              }\n            }, 1000);\n          }\n        } catch (error) {\n          console.warn('Failed to open DAK issue:', error);\n          window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, `dak-${issueType}`);\n        }\n      },\n\n      // Function to show fallback instructions when GitHub access is blocked\n      showFallbackInstructions: (reason, url, issueType) => {\n        const instructions = {\n          'github-blocked': {\n            title: 'GitHub Access Required',\n            message: `\n              <div class=\"help-fallback-notice\">\n                <h4>🔗 GitHub Link Blocked</h4>\n                <p>It looks like GitHub access is restricted in your current environment.</p>\n                <h5>To report this issue:</h5>\n                <ol>\n                  <li>Copy the link below</li>\n                  <li>Open it in a browser with GitHub access</li>\n                  <li>Fill out the issue template</li>\n                </ol>\n                <div class=\"fallback-url\">\n                  <strong>Link to copy:</strong><br>\n                  <textarea readonly onclick=\"this.select()\" style=\"width: 100%; height: 60px; margin: 5px 0; padding: 5px; font-family: monospace; font-size: 12px;\">${url}</textarea>\n                </div>\n                <p><em>💡 Tip: You can also email us at <a href=\"mailto:smart@who.int\">smart@who.int</a> with your issue details.</em></p>\n              </div>\n            `\n          }\n        };\n\n        const fallback = instructions[reason] || {\n          title: 'External Link Issue',\n          message: `<p>Unable to open external link. Please copy and visit: <br><code>${url}</code></p>`\n        };\n\n        // Create a temporary modal-like alert for fallback instructions\n        const existingFallback = document.querySelector('.help-fallback-overlay');\n        if (existingFallback) {\n          existingFallback.remove();\n        }\n\n        const fallbackOverlay = document.createElement('div');\n        fallbackOverlay.className = 'help-fallback-overlay';\n        fallbackOverlay.style.cssText = `\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0, 0, 0, 0.7);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          z-index: 10000;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n        `;\n\n        const fallbackModal = document.createElement('div');\n        fallbackModal.style.cssText = `\n          background: white;\n          border-radius: 8px;\n          padding: 20px;\n          max-width: 500px;\n          max-height: 80vh;\n          overflow-y: auto;\n          position: relative;\n          box-shadow: 0 10px 25px rgba(0,0,0,0.3);\n        `;\n\n        fallbackModal.innerHTML = `\n          <button onclick=\"this.closest('.help-fallback-overlay').remove()\" style=\"\n            position: absolute;\n            top: 10px;\n            right: 15px;\n            background: none;\n            border: none;\n            font-size: 24px;\n            cursor: pointer;\n            color: #666;\n          \">×</button>\n          <h3 style=\"margin-top: 0; color: #333;\">${fallback.title}</h3>\n          <div style=\"color: #555; line-height: 1.5;\">${fallback.message}</div>\n        `;\n\n        fallbackOverlay.appendChild(fallbackModal);\n        document.body.appendChild(fallbackOverlay);\n\n        // Click outside to close\n        fallbackOverlay.addEventListener('click', (e) => {\n          if (e.target === fallbackOverlay) {\n            fallbackOverlay.remove();\n          }\n        });\n\n        // Auto-remove after 30 seconds\n        setTimeout(() => {\n          if (document.body.contains(fallbackOverlay)) {\n            fallbackOverlay.remove();\n          }\n        }, 30000);\n      }\n    };\n\n    return () => {\n      // Cleanup\n      delete window.helpModalInstance;\n    };\n  }, [contextData]);\n\n  const handleOverlayClick = (e) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  const handleMenuToggle = () => {\n    setShowMenu(!showMenu);\n  };\n\n  const handleBugReport = () => {\n    // Use the new SGEX issue reporting system\n    if (window.helpModalInstance?.openSgexIssue) {\n      window.helpModalInstance.openSgexIssue('bug');\n    } else {\n      // Fallback to direct URL\n      const params = new URLSearchParams({\n        template: 'bug_report.yml',\n        labels: 'bug',\n        sgex_page: contextData.pageId || 'unknown',\n        sgex_current_url: window.location.href\n      });\n      \n      if (contextData.selectedDak?.name) {\n        params.set('sgex_selected_dak', contextData.selectedDak.name);\n      }\n      \n      const url = `https://github.com/litlfred/sgex/issues/new?${params.toString()}`;\n      \n      // Try to open with error handling\n      try {\n        const newWindow = window.open(url, '_blank');\n        if (!newWindow || newWindow.closed) {\n          window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, 'bug');\n        }\n      } catch (error) {\n        console.warn('Failed to open GitHub issue:', error);\n        window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, 'bug');\n      }\n    }\n  };\n\n  const handleDAKFeedback = () => {\n    if (contextData.repository) {\n      // Default to opening content error as the primary DAK feedback type\n      if (window.helpModalInstance?.openDakIssue) {\n        window.helpModalInstance.openDakIssue('content');\n      }\n    }\n  };\n\n  const handleEmailSupport = () => {\n    const topicTitle = helpTopic?.title || topic;\n    const subject = encodeURIComponent(`SGEX Workbench Support: ${topicTitle}`);\n    const body = encodeURIComponent(`\nHello SMART Guidelines Team,\n\nI need assistance with the SGEX Workbench.\n\nTopic: ${topicTitle}\nPage: ${window.location.pathname}\n\nPlease describe your question or issue:\n\n\nBest regards,\n    `.trim());\n    \n    window.open(`mailto:smart@who.int?subject=${subject}&body=${body}`);\n  };\n\n  const handleDocumentation = () => {\n    window.open('/sgex/docs/overview', '_blank');\n  };\n\n  const handlePrevSlide = () => {\n    if (currentSlide > 0) {\n      setCurrentSlide(currentSlide - 1);\n    }\n  };\n\n  const handleNextSlide = () => {\n    if (helpTopic?.content && currentSlide < helpTopic.content.length - 1) {\n      setCurrentSlide(currentSlide + 1);\n    }\n  };\n\n  const renderSlideshow = () => {\n    if (!helpTopic?.content || helpTopic.type !== 'slideshow') {\n      return null;\n    }\n\n    const slides = helpTopic.content;\n    const currentSlideData = slides[currentSlide];\n\n    // Handle DAK feedback buttons by replacing onclick handlers\n    let processedContent = currentSlideData.content;\n    if (helpTopic.id === 'provide-dak-feedback') {\n      processedContent = processedContent.replace(\n        /onclick=\"this\\.openDakIssue\\('([^']+)'\\)\"/g,\n        `onclick=\"window.helpModalInstance?.openDakIssue('$1')\"`\n      );\n    }\n\n    return (\n      <div className=\"help-slideshow\">\n        <div className=\"slideshow-header\">\n          <h3>{currentSlideData.title}</h3>\n          <div className=\"slide-counter\">\n            {currentSlide + 1} of {slides.length}\n          </div>\n        </div>\n        \n        <div \n          className=\"slideshow-content\"\n          dangerouslySetInnerHTML={{ __html: processedContent }}\n        />\n        \n        <div className=\"slideshow-controls\">\n          <button \n            onClick={handlePrevSlide}\n            disabled={currentSlide === 0}\n            className=\"slide-nav-btn\"\n          >\n            ← Previous\n          </button>\n          \n          <div className=\"slide-dots\">\n            {slides.map((_, index) => (\n              <button\n                key={index}\n                className={`slide-dot ${index === currentSlide ? 'active' : ''}`}\n                onClick={() => setCurrentSlide(index)}\n                aria-label={`Go to slide ${index + 1}`}\n              />\n            ))}\n          </div>\n          \n          <button \n            onClick={handleNextSlide}\n            disabled={currentSlide === slides.length - 1}\n            className=\"slide-nav-btn\"\n          >\n            Next →\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  const getHelpContent = () => {\n    // If we have a specific help topic, use it\n    if (helpTopic) {\n      return {\n        title: helpTopic.title,\n        content: helpTopic.type === 'slideshow' ? renderSlideshow() : (\n          <div className=\"help-content\">\n            <div className=\"mascot-message\">\n              <img src={mascotImage} alt=\"SGEX Helper\" className=\"help-mascot\" />\n              <div className=\"message-bubble\">\n                <div dangerouslySetInnerHTML={{ __html: helpTopic.content }} />\n              </div>\n            </div>\n          </div>\n        )\n      };\n    }\n\n    // Legacy support for old topic strings\n    switch (topic) {\n      case 'github-token':\n      case 'pat-help':\n        return {\n          title: 'GitHub Authentication Help',\n          content: (\n            <div className=\"help-content\">\n              <div className=\"mascot-message\">\n                <img src={mascotImage} alt=\"SGEX Helper\" className=\"help-mascot\" />\n                <div className=\"message-bubble\">\n                  <p>SGEX Workbench uses GitHub Personal Access Tokens for secure authentication!</p>\n                  <p><strong>How it works:</strong></p>\n                  <ul>\n                    <li>Create a Personal Access Token in your GitHub settings</li>\n                    <li>Enter the token in the login form</li>\n                    <li>SGEX will securely connect to your GitHub repositories</li>\n                    <li>No backend server required - works entirely in your browser!</li>\n                  </ul>\n                  <p>This approach ensures compliance with our no-backend requirement while keeping your data secure.</p>\n                  <p>If you're having trouble, please use the menu above to get additional support.</p>\n                </div>\n              </div>\n            </div>\n          )\n        };\n      default:\n        return {\n          title: 'SGEX Workbench Help',\n          content: (\n            <div className=\"help-content\">\n              <div className=\"mascot-message\">\n                <img src={mascotImage} alt=\"SGEX Helper\" className=\"help-mascot\" />\n                <div className=\"message-bubble\">\n                  <p>Hi! I'm here to help you with the SGEX Workbench.</p>\n                  <p>Use the menu in the top right to get additional support options.</p>\n                </div>\n              </div>\n            </div>\n          )\n        };\n    }\n  };\n\n  const { title, content } = getHelpContent();\n\n  return (\n    <div className=\"help-modal-overlay\" onClick={handleOverlayClick}>\n      <div className=\"help-modal\">\n        <div className=\"help-modal-header\">\n          <h2>{title}</h2>\n          <div className=\"help-modal-actions\">\n            <button \n              className=\"hamburger-menu-btn\"\n              onClick={handleMenuToggle}\n              aria-label=\"More options\"\n            >\n              <span></span>\n              <span></span>\n              <span></span>\n            </button>\n            <button \n              className=\"close-btn\"\n              onClick={onClose}\n              aria-label=\"Close help\"\n            >\n              ×\n            </button>\n          </div>\n          \n          {showMenu && (\n            <div className=\"help-menu-dropdown\">\n              <button onClick={handleDocumentation} className=\"menu-item\">\n                <span className=\"menu-icon\">📖</span>\n                Documentation\n              </button>\n              \n              <button onClick={handleBugReport} className=\"menu-item\">\n                <img src=\"/sgex/bug-report-icon.svg\" alt=\"Bug\" className=\"menu-icon\" />\n                File Bug Report\n              </button>\n              \n              {contextData.repository && (\n                <button onClick={handleDAKFeedback} className=\"menu-item\">\n                  <span className=\"menu-icon\">📝</span>\n                  Provide DAK Feedback\n                </button>\n              )}\n              \n              <button onClick={handleEmailSupport} className=\"menu-item\">\n                <span className=\"menu-icon\">📧</span>\n                Email Support\n              </button>\n            </div>\n          )}\n        </div>\n        \n        <div className=\"help-modal-content\">\n          {content}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default HelpModal;","/**\n * Repository Cache Service\n * Manages caching of discovered SMART Guidelines repositories with expiry\n */\n\nimport logger from '../utils/logger';\n\nclass RepositoryCacheService {\n  constructor() {\n    this.CACHE_KEY_PREFIX = 'sgex_repo_cache_';\n    this.CACHE_EXPIRY_HOURS = 24; // Cache expires after 24 hours\n    this.logger = logger.getLogger('RepositoryCacheService');\n    this.logger.debug('RepositoryCacheService initialized', { \n      cacheExpiryHours: this.CACHE_EXPIRY_HOURS \n    });\n  }\n\n  /**\n   * Generate cache key for a user/organization\n   */\n  getCacheKey(owner, type = 'user') {\n    return `${this.CACHE_KEY_PREFIX}${type}_${owner}`;\n  }\n\n  /**\n   * Check if cached data is stale (older than 24 hours)\n   */\n  isStale(timestamp) {\n    const now = Date.now();\n    const cacheAge = now - timestamp;\n    const maxAge = this.CACHE_EXPIRY_HOURS * 60 * 60 * 1000; // 24 hours in milliseconds\n    return cacheAge > maxAge;\n  }\n\n  /**\n   * Get cached repositories for a user/organization\n   * Returns null if cache doesn't exist or is stale\n   */\n  getCachedRepositories(owner, type = 'user') {\n    try {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.cache('get', cacheKey);\n      \n      const cachedData = localStorage.getItem(cacheKey);\n      \n      if (!cachedData) {\n        this.logger.cache('miss', cacheKey, 'No cached data found');\n        return null;\n      }\n\n      const parsed = JSON.parse(cachedData);\n      \n      // Check if cache is stale\n      if (this.isStale(parsed.timestamp)) {\n        // Remove stale cache\n        this.logger.cache('expired', cacheKey, { age: Date.now() - parsed.timestamp });\n        localStorage.removeItem(cacheKey);\n        return null;\n      }\n\n      this.logger.cache('hit', cacheKey, { \n        repositoryCount: parsed.repositories?.length || 0,\n        age: Date.now() - parsed.timestamp\n      });\n\n      return {\n        repositories: parsed.repositories,\n        timestamp: parsed.timestamp,\n        owner: parsed.owner,\n        type: parsed.type\n      };\n    } catch (error) {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.error('Error reading repository cache', { cacheKey, error: error.message });\n      console.warn('Error reading repository cache:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Cache repositories for a user/organization\n   */\n  setCachedRepositories(owner, type = 'user', repositories) {\n    try {\n      const cacheKey = this.getCacheKey(owner, type);\n      const cacheData = {\n        repositories,\n        timestamp: Date.now(),\n        owner,\n        type\n      };\n\n      this.logger.cache('set', cacheKey, { \n        repositoryCount: repositories?.length || 0,\n        owner, \n        type \n      });\n\n      localStorage.setItem(cacheKey, JSON.stringify(cacheData));\n      return true;\n    } catch (error) {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.error('Error caching repositories', { cacheKey, error: error.message });\n      console.warn('Error caching repositories:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear cache for a specific user/organization\n   */\n  clearCache(owner, type = 'user') {\n    try {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.cache('clear', cacheKey, { owner, type });\n      localStorage.removeItem(cacheKey);\n      return true;\n    } catch (error) {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.error('Error clearing repository cache', { cacheKey, error: error.message });\n      console.warn('Error clearing repository cache:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear all repository caches\n   */\n  clearAllCaches() {\n    try {\n      const keys = Object.keys(localStorage);\n      keys.forEach(key => {\n        if (key.startsWith(this.CACHE_KEY_PREFIX)) {\n          localStorage.removeItem(key);\n        }\n      });\n      return true;\n    } catch (error) {\n      console.warn('Error clearing all repository caches:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get cache info for debugging\n   */\n  getCacheInfo(owner, type = 'user') {\n    const cached = this.getCachedRepositories(owner, type);\n    if (!cached) {\n      return { exists: false, stale: true };\n    }\n\n    const age = Date.now() - cached.timestamp;\n    const ageHours = Math.round(age / (60 * 60 * 1000));\n    \n    return {\n      exists: true,\n      stale: this.isStale(cached.timestamp),\n      age: age,\n      ageHours: ageHours,\n      repositoryCount: cached.repositories.length,\n      timestamp: new Date(cached.timestamp).toISOString()\n    };\n  }\n}\n\n// Create singleton instance\nconst repositoryCacheService = new RepositoryCacheService();\n\nexport default repositoryCacheService;","/**\n * Service for managing feature file changes in browser localStorage\n * This allows users to edit and save feature files locally without requiring GitHub authentication\n */\n\nclass LocalStorageService {\n  constructor() {\n    this.storageKey = 'sgex_feature_files';\n    this.metadataKey = 'sgex_feature_files_metadata';\n  }\n\n  /**\n   * Get all locally stored feature file changes\n   * @returns {Object} Object with file paths as keys and content as values\n   */\n  getAllLocalChanges() {\n    try {\n      const data = localStorage.getItem(this.storageKey);\n      return data ? JSON.parse(data) : {};\n    } catch (error) {\n      console.error('Error reading local changes:', error);\n      return {};\n    }\n  }\n\n  /**\n   * Get locally stored content for a specific file\n   * @param {string} filePath - The file path\n   * @returns {string|null} The stored content or null if not found\n   */\n  getLocalContent(filePath) {\n    const changes = this.getAllLocalChanges();\n    return changes[filePath] || null;\n  }\n\n  /**\n   * Save feature file content to localStorage\n   * @param {string} filePath - The file path\n   * @param {string} content - The file content\n   * @param {Object} metadata - Additional metadata (repository, branch, etc.)\n   */\n  saveLocal(filePath, content, metadata = {}) {\n    try {\n      // Save the content\n      const changes = this.getAllLocalChanges();\n      changes[filePath] = content;\n      localStorage.setItem(this.storageKey, JSON.stringify(changes));\n\n      // Save metadata\n      const allMetadata = this.getAllMetadata();\n      allMetadata[filePath] = {\n        ...metadata,\n        lastModified: new Date().toISOString(),\n        originalPath: filePath\n      };\n      localStorage.setItem(this.metadataKey, JSON.stringify(allMetadata));\n\n      return true;\n    } catch (error) {\n      console.error('Error saving to localStorage:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Remove locally stored content for a file\n   * @param {string} filePath - The file path\n   */\n  removeLocal(filePath) {\n    try {\n      const changes = this.getAllLocalChanges();\n      delete changes[filePath];\n      localStorage.setItem(this.storageKey, JSON.stringify(changes));\n\n      const metadata = this.getAllMetadata();\n      delete metadata[filePath];\n      localStorage.setItem(this.metadataKey, JSON.stringify(metadata));\n\n      return true;\n    } catch (error) {\n      console.error('Error removing from localStorage:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get metadata for all locally stored files\n   * @returns {Object} Metadata object\n   */\n  getAllMetadata() {\n    try {\n      const data = localStorage.getItem(this.metadataKey);\n      return data ? JSON.parse(data) : {};\n    } catch (error) {\n      console.error('Error reading metadata:', error);\n      return {};\n    }\n  }\n\n  /**\n   * Get metadata for a specific file\n   * @param {string} filePath - The file path\n   * @returns {Object|null} The metadata or null if not found\n   */\n  getMetadata(filePath) {\n    const metadata = this.getAllMetadata();\n    return metadata[filePath] || null;\n  }\n\n  /**\n   * Check if there are any local changes\n   * @returns {boolean} True if there are local changes\n   */\n  hasLocalChanges() {\n    const changes = this.getAllLocalChanges();\n    return Object.keys(changes).length > 0;\n  }\n\n  /**\n   * Get the number of locally changed files\n   * @returns {number} Number of files with local changes\n   */\n  getLocalChangesCount() {\n    const changes = this.getAllLocalChanges();\n    return Object.keys(changes).length;\n  }\n\n  /**\n   * Export local changes as a downloadable file\n   * @param {string} format - Export format ('json' or 'zip')\n   * @returns {Blob} The export data as a Blob\n   */\n  exportLocalChanges(format = 'json') {\n    const changes = this.getAllLocalChanges();\n    const metadata = this.getAllMetadata();\n\n    if (format === 'json') {\n      const exportData = {\n        exported: new Date().toISOString(),\n        version: '1.0',\n        changes,\n        metadata\n      };\n      \n      return new Blob(\n        [JSON.stringify(exportData, null, 2)], \n        { type: 'application/json' }\n      );\n    }\n\n    // For future expansion - could support ZIP format with individual files\n    throw new Error(`Export format '${format}' not supported`);\n  }\n\n  /**\n   * Import local changes from exported data\n   * @param {string} jsonData - The exported JSON data\n   * @returns {boolean} True if import was successful\n   */\n  importLocalChanges(jsonData) {\n    try {\n      const importData = JSON.parse(jsonData);\n      \n      if (!importData.changes || !importData.metadata) {\n        throw new Error('Invalid import data format');\n      }\n\n      // Merge with existing data\n      const existingChanges = this.getAllLocalChanges();\n      const existingMetadata = this.getAllMetadata();\n\n      const mergedChanges = { ...existingChanges, ...importData.changes };\n      const mergedMetadata = { ...existingMetadata, ...importData.metadata };\n\n      localStorage.setItem(this.storageKey, JSON.stringify(mergedChanges));\n      localStorage.setItem(this.metadataKey, JSON.stringify(mergedMetadata));\n\n      return true;\n    } catch (error) {\n      console.error('Error importing local changes:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear all local changes\n   */\n  clearAllLocalChanges() {\n    localStorage.removeItem(this.storageKey);\n    localStorage.removeItem(this.metadataKey);\n  }\n\n  /**\n   * Get storage usage information\n   * @returns {Object} Storage usage stats\n   */\n  getStorageInfo() {\n    const changes = this.getAllLocalChanges();\n    const metadata = this.getAllMetadata();\n    \n    const changesSize = JSON.stringify(changes).length;\n    const metadataSize = JSON.stringify(metadata).length;\n    const totalSize = changesSize + metadataSize;\n\n    return {\n      fileCount: Object.keys(changes).length,\n      totalSize,\n      changesSize,\n      metadataSize,\n      formattedSize: this.formatBytes(totalSize)\n    };\n  }\n\n  /**\n   * Format bytes into human readable string\n   * @param {number} bytes - Number of bytes\n   * @returns {string} Formatted string\n   */\n  formatBytes(bytes) {\n    if (bytes === 0) return '0 Bytes';\n\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  }\n}\n\n// Create and export a singleton instance\nconst localStorageService = new LocalStorageService();\nexport default localStorageService;","import yaml from 'js-yaml';\nimport githubService from './githubService';\n\n/**\n * Service for validating WHO SMART Guidelines Digital Adaptation Kit repositories\n * \n * A repository is considered a valid DAK if:\n * 1. It has a sushi-config.yaml file in the root\n * 2. The sushi-config.yaml contains a 'dependencies' section\n * 3. The dependencies section contains the key 'smart.who.int.base'\n */\nclass DAKValidationService {\n  /**\n   * Validates if a repository is a WHO SMART Guidelines Digital Adaptation Kit\n   * @param {string} owner - Repository owner (username or organization)\n   * @param {string} repo - Repository name\n   * @param {string} branch - Branch to check (defaults to 'main')\n   * @returns {Promise<boolean>} - True if repository is a valid DAK\n   */\n  async validateDAKRepository(owner, repo, branch = 'main') {\n    try {\n      // First, check if this is an existing GitHub repository\n      const repositoryExists = await this.checkRepositoryExists(owner, repo);\n      \n      // Try to fetch the sushi-config.yaml file from the repository root\n      const sushiConfigContent = await this.fetchSushiConfig(owner, repo, branch);\n      \n      if (!sushiConfigContent) {\n        // If no sushi-config.yaml but repository exists, still allow it\n        // This handles cases like litlfred/smart-ips-pilgrimage that exist but may not have full DAK structure\n        if (repositoryExists) {\n          console.log(`Repository ${owner}/${repo} exists on GitHub - allowing access even without sushi-config.yaml`);\n          return true;\n        }\n        console.log(`No sushi-config.yaml found in ${owner}/${repo} and repository doesn't exist`);\n        return false;\n      }\n\n      // Parse the YAML content\n      const config = yaml.load(sushiConfigContent);\n      \n      if (!config || typeof config !== 'object') {\n        // If YAML is invalid but repository exists, still allow it\n        if (repositoryExists) {\n          console.log(`Invalid YAML format in sushi-config.yaml for ${owner}/${repo} but repository exists - allowing access`);\n          return true;\n        }\n        console.log(`Invalid YAML format in sushi-config.yaml for ${owner}/${repo}`);\n        return false;\n      }\n\n      // Check if dependencies section exists\n      if (!config.dependencies || typeof config.dependencies !== 'object') {\n        // If no dependencies but repository exists, still allow it\n        if (repositoryExists) {\n          console.log(`No dependencies section found in sushi-config.yaml for ${owner}/${repo} but repository exists - allowing access`);\n          return true;\n        }\n        console.log(`No dependencies section found in sushi-config.yaml for ${owner}/${repo}`);\n        return false;\n      }\n\n      // Check if smart.who.int.base dependency exists\n      const hasSmartBase = 'smart.who.int.base' in config.dependencies;\n      \n      if (hasSmartBase) {\n        console.log(`Valid DAK repository found: ${owner}/${repo} (has smart.who.int.base dependency)`);\n        return true;\n      } else {\n        // If no smart.who.int.base dependency but repository exists, still allow it\n        if (repositoryExists) {\n          console.log(`Repository ${owner}/${repo} has sushi-config.yaml but missing smart.who.int.base dependency - allowing access since repository exists`);\n          return true;\n        }\n        console.log(`Repository ${owner}/${repo} has sushi-config.yaml but missing smart.who.int.base dependency`);\n        return false;\n      }\n\n    } catch (error) {\n      console.log(`Error validating DAK repository ${owner}/${repo}:`, error.message);\n      return false;\n    }\n  }\n\n  /**\n   * Checks if a repository exists on GitHub\n   * @param {string} owner - Repository owner\n   * @param {string} repo - Repository name\n   * @returns {Promise<boolean>} - True if repository exists\n   */\n  async checkRepositoryExists(owner, repo) {\n    try {\n      // Use the same approach as githubService - get the octokit instance\n      const octokit = githubService.isAuth() ? githubService.octokit : null;\n      \n      if (!octokit) {\n        // In unauthenticated mode, we can't reliably check repository existence\n        console.log(`Cannot check repository existence for ${owner}/${repo} - not authenticated`);\n        return false;\n      }\n\n      await octokit.rest.repos.get({\n        owner,\n        repo\n      });\n      \n      console.log(`Repository ${owner}/${repo} exists on GitHub`);\n      return true;\n    } catch (error) {\n      if (error.status === 404) {\n        console.log(`Repository ${owner}/${repo} does not exist on GitHub`);\n        return false;\n      }\n      // For other errors (like rate limiting, network issues, firewall blocks), \n      // we can't determine if the repository exists, so we'll be permissive\n      console.log(`Error checking repository existence for ${owner}/${repo}:`, error.message, '- assuming it might exist');\n      return true; // Changed from false to true for non-404 errors\n    }\n  }\n\n  /**\n   * Fetches the sushi-config.yaml file content from a repository\n   * @param {string} owner - Repository owner\n   * @param {string} repo - Repository name  \n   * @param {string} branch - Branch to check\n   * @returns {Promise<string|null>} - YAML content or null if not found\n   */\n  async fetchSushiConfig(owner, repo, branch = 'main') {\n    try {\n      // Use the same approach as githubService - get the octokit instance\n      const octokit = githubService.isAuth() ? githubService.octokit : null;\n      \n      if (!octokit) {\n        // In unauthenticated mode, we can't fetch file contents reliably\n        console.log(`Cannot fetch sushi-config.yaml for ${owner}/${repo} - not authenticated`);\n        return null;\n      }\n\n      // Try main branch first if no branch specified\n      const branchesToTry = branch === 'main' ? ['main', 'master'] : [branch];\n      \n      for (const branchName of branchesToTry) {\n        try {\n          const { data } = await octokit.rest.repos.getContent({\n            owner,\n            repo,\n            path: 'sushi-config.yaml',\n            ref: branchName\n          });\n          \n          if (data.type === 'file' && data.content) {\n            // Decode base64 content\n            const content = decodeURIComponent(escape(atob(data.content)));\n            console.log(`Found sushi-config.yaml in ${owner}/${repo} on branch ${branchName}`);\n            return content;\n          }\n        } catch (branchError) {\n          console.log(`sushi-config.yaml not found on branch ${branchName} for ${owner}/${repo}:`, branchError.status === 404 ? 'File not found' : branchError.message);\n          continue;\n        }\n      }\n      \n      return null;\n    } catch (error) {\n      console.log(`Error fetching sushi-config.yaml for ${owner}/${repo}:`, error.message);\n      return null;\n    }\n  }\n\n  /**\n   * Validates DAK repository in demo mode based on basic format\n   * A repository is valid if it has proper org/repo format. In demo mode,\n   * we cannot reliably fetch sushi-config.yaml due to authentication limitations,\n   * so we allow any repository that follows the basic org/repo pattern.\n   * @param {string} owner - Repository owner\n   * @param {string} repo - Repository name\n   * @returns {boolean} - True if repository has valid org/repo format\n   */\n  validateDemoDAKRepository(owner, repo) {\n    // Validate basic format: must look like org/repo\n    if (!owner || !repo || owner.includes('/') || repo.includes('/')) {\n      console.log(`Demo mode: Invalid repository format ${owner}/${repo}`);\n      return false;\n    }\n\n    // Basic validation for reasonable org and repo names\n    // Allow alphanumeric characters, hyphens, underscores, and dots\n    const validNamePattern = /^[a-zA-Z0-9._-]+$/;\n    \n    if (!validNamePattern.test(owner) || !validNamePattern.test(repo)) {\n      console.log(`Demo mode: Invalid characters in repository name ${owner}/${repo}`);\n      return false;\n    }\n\n    const fullName = `${owner}/${repo}`;\n    console.log(`Demo mode: ${fullName} accepted as valid DAK repository (proper org/repo format)`);\n    return true;\n  }\n}\n\nconst dakValidationService = new DAKValidationService();\n\nexport default dakValidationService;"],"names":["constructor","this","universalTopics","documentation","id","title","badge","type","action","currentPath","window","location","pathname","basePath","includes","pathParts","split","sgexIndex","indexOf","length","concat","slice","join","href","content","bugReport","dakFeedback","helpTopics","getHelpTopicsForPage","pageId","contextData","arguments","undefined","getUniversalTopics","topics","selectedDak","repository","push","getHelpTopic","topicId","pageTopics","Object","values","topic","find","t","hasHelpTopics","addHelpTopicToPage","helpTopic","getAvailablePages","keys","openDakIssue","issueType","dakRepository","console","warn","url","owner","name","open","storageKey","whoProfile","getSubscriptions","stored","localStorage","getItem","subscriptions","JSON","parse","profile","login","unshift","avatar_url","isPermanent","addedAt","Date","toISOString","saveSubscriptions","error","setItem","stringify","addSubscription","Error","existingIndex","findIndex","p","_objectSpread","lastUpdated","newSubscription","removeSubscription","profileIndex","splice","isSubscribed","some","getSubscription","ensureCurrentUserSubscribed","userProfile","existing","autoAddVisitedProfile","visitedProfile","isDemo","getSubscriptionsSorted","sort","a","b","nameA","nameB","localeCompare","getSubscriptionsForSelection","map","displayName","isRemovable","updateSubscription","updatedProfile","index","clearSubscriptions","exportSubscriptions","importSubscriptions","jsonString","merge","importedSubscriptions","Array","isArray","finalSubscriptions","mergedSubscriptions","forEach","imported","PAGE_TYPES","PageContext","createContext","usePage","context","useContext","pageName","user","branch","asset","loading","isAuthenticated","navigate","params","determinePageType","repo","PageProvider","_ref","children","useParams","useLocation","useNavigate","pageState","setPageState","useState","githubService","isAuth","useEffect","async","_location$state","_location$state2","_location$state3","prev","state","selectedBranch","_repository","getUser","err","html_url","isNotFound","dakValidationService","validateDemoDAKRepository","charAt","toUpperCase","getRepository","validateDAKRepository","default_branch","isInvalidDAK","full_name","getFileContent","handleSubscriptions","currentUser","getCurrentUser","profileSubscriptionService","debug","message","loadPageData","interval","setInterval","checkAuthState","currentAuthState","clearInterval","value","_jsx","Provider","getThemeImagePath","baseImagePath","isDarkMode","document","body","classList","contains","publicUrl","process","normalizedPath","startsWith","finalPath","darkImageName","replace","USER_TYPES","ACCESS_LEVELS","logger","getLogger","userType","permissions","Map","listeners","Set","initialize","info","detectUserType","notifyListeners","checkIfDemoUser","createDemoUser","hasUser","REACT_APP_DEMO_MODE","realUser","demoData","getDemoData","daks","description","sampleAssets","getUserType","isDemoUser","isUnauthenticated","getRepositoryAccess","cacheKey","has","get","access","isDemoDAK","hasReadAccess","checkGitHubReadAccess","checkGitHubWriteAccess","set","_this$currentUser","_this$currentUser$dem","dak","hasRepositoryWriteAccess","canSaveToGitHub","canSaveLocal","getUIBehavior","behavior","showEditFeatures","showSaveToGitHub","showSaveLocal","confirmBeforeSave","allowCreateNew","showAccessBadges","getAccessBadge","badges","text","icon","color","enableDemoMode","disableDemoMode","removeItem","clearPermissionsCache","clear","addListener","callback","add","delete","accessState","uiBehavior","handleAuthChange","getBookmarks","saveBookmarks","bookmarks","generateBookmarkTitle","repoName","branchName","addBookmark","bookmark","now","toString","createdAt","removeBookmark","bookmarkId","filteredBookmarks","filter","isBookmarked","getBookmarkByUrl","getBookmarksGroupedByPage","grouped","clearBookmarks","exportBookmarks","importBookmarks","importedBookmarks","mergedBookmarks","PreviewBadge","branchInfo","setBranchInfo","prInfo","setPrInfo","setLoading","setError","isExpanded","setIsExpanded","isSticky","setIsSticky","expandedRef","useRef","currentBranch","getCurrentBranch","safeName","prData","fetchPRsForBranch","prError","detectBranchAndPR","handleClickOutside","event","current","target","addEventListener","removeEventListener","getPullRequestsForBranch","truncateTitle","maxLength","substring","_jsxs","className","ref","pr","onClick","handleBadgeClick","number","stopPropagation","preventDefault","onMouseEnter","handleMouseEnter","onMouseLeave","handleMouseLeave","e","style","marginTop","origin","padding","backgroundColor","border","borderRadius","rel","PageHeader","showUserDropdown","setShowUserDropdown","showBookmarkDropdown","setShowBookmarkDropdown","authenticatedUser","setAuthenticatedUser","userAccessService","githubUser","fetchAuthenticatedUser","handleHomeNavigation","handleRemoveBookmark","bookmarkService","setTimeout","currentBookmark","bookmarksGrouped","src","alt","handleGitHubUser","viewBox","width","height","d","handleBookmarkCurrentPage","currentUrl","group","handleBookmarkNavigation","handleLogout","logout","setBadge","showTooltip","setShowTooltip","mounted","loadBadge","badgeInfo","unsubscribe","role","_repository$owner3","customBreadcrumbs","branches","setBranches","showBranchDropdown","setShowBranchDropdown","branchSearchTerm","setBranchSearchTerm","loadingBranches","setLoadingBranches","closest","_repository$owner","_repository$full_name","sortedBranches","getBranches","fetchBranches","filteredBranches","toLowerCase","breadcrumbs","getBreadcrumbs","label","path","_repository$owner2","_repository$full_name2","branchPath","ownerLogin","currentPageLabel","_Fragment","placeholder","onChange","autoFocus","newBranch","handleBranchChange","crumb","AccessBadge","handleGitHubRepo","onRetry","pageContext","bugReportSent","setBugReportSent","mascotImage","useThemeImage","userExplanation","setUserExplanation","errorInfo","getErrorDisplayInfo","_pageContext$reposito","lowercaseError","suggestions","ContextualHelpMascot","helpContent","position","suggestion","handleRetry","reload","handleGoHome","htmlFor","rows","handleSendBugReport","bugReportUrl","generateBugReportUrl","encodeURIComponent","navigator","userAgent","innerWidth","innerHeight","referrer","PageErrorBoundary","React","props","super","hasError","getDerivedStateFromError","componentDidCatch","render","ErrorHandler","setState","PageLayoutInner","showHeader","showMascot","showBreadcrumbs","_ref2","usePageParams","updateBranch","navigateToUser","userLogin","page","navigateToDAK","navigateToAsset","assetPath","useDAKParams","pageParams","log","hasChanges","isSavingLocal","isSavingGitHub","localSaveSuccess","githubSaveSuccess","savedLocally","onSaveLocal","onSaveGitHub","showLocalButton","showGitHubButton","buttonSize","layout","localButtonDisabled","githubButtonDisabled","containerClasses","getButtonClasses","disabled","success","classes","isOpen","commitMessage","setCommitMessage","onCommit","onCancel","isSaving","fileName","suggestedMessage","textareaRef","focus","defaultMessage","currentTarget","onKeyDown","key","ctrlKey","metaKey","trim","required","handleCommit","SAVE_TARGETS","OPERATION_RESULTS","pendingOperations","assetCache","stagingGroundService","getAsset","localFile","getStagingGround","files","f","source","metadata","hasLocalChanges","getDemoAssetContent","saveAssetLocal","updateFile","savedBy","saveTarget","result","saveAssetGitHub","updateFileContent","_result$data","_result$data$commit","_result$data2","_result$data2$commit","_result$data3","_result$data3$commit","removeFile","commit","data","sha","commitSha","commitUrl","resourceType","status","compose","include","system","concept","code","display","getSaveOptions","canSaveGitHub","showSaveGitHub","restrictions","getSaveRestrictions","localMessage","githubMessage","githubDisabled","getStagingGroundStatus","getStatus","clearStagingGround","getChangedFiles","createAsset","initialContent","isNew","batchSaveLocal","assets","results","every","r","getAccessInfo","saveOptions","Promise","all","file","originalContent","onSave","onContentChange","customSaveToGitHub","showSaveButtons","saveButtonsPosition","pageLayoutProps","_objectWithoutProperties","_excluded","setIsSavingLocal","setIsSavingGitHub","saveError","setSaveError","setLocalSaveSuccess","setGithubSaveSuccess","setSaveOptions","showCommitDialog","setShowCommitDialog","options","dataAccessLayer","loadSaveOptions","handleSaveLocal","useCallback","timestamp","handleSaveGitHub","handleCommitToGitHub","errorMessage","handleCancelCommit","saveButtonsProps","PageLayout","SaveButtonsContainer","CommitMessageDialog","TOOL_TYPES","ToolDefinition","config","route","category","requiresAuth","supportsDemo","requiresDAK","assetTypes","assetPattern","viewerComponent","editorComponent","dashboardComponent","onInit","onAssetLoad","onAssetSave","onError","supportsAsset","_this$assetTypes","RegExp","test","canAccess","createComponent","toolDef","ToolWrapper","toolDefinition","toolState","setToolState","initializeTool","_pageParams$repositor","assetData","handleAssetSave","newContent","saveType","handleGitHubSave","_pageParams$repositor2","history","back","renderToolContent","commonProps","onGitHubSave","EditorComponent","_toolState$assets$","AssetEditorLayout","ViewerComponent","DashboardComponent","Component","tools","register","tool","getAll","from","getByCategory","getByAssetType","getAccessibleTools","accessibleTools","clearAllCache","repoCacheCleared","repositoryCacheService","clearAllCaches","branchContextService","clearAllBranchContext","clearAllStagingGrounds","clearOtherSGEXData","sessionKeys","sessionStorage","getCacheInfo","repositoryCache","count","branchContext","hasData","repositoryCount","stagingGround","other","localKeys","parsed","getUncommittedWork","uncommittedWork","keyParts","pop","fileCount","lastModified","UN_LANGUAGES","flag","ADDITIONAL_LANGUAGES","englishName","i18n","useTranslation","setIsOpen","searchTerm","setSearchTerm","selectedLanguages","setSelectedLanguages","saved","lang","availableLanguages","useMemo","languages","langCode","unLang","additionalLang","addLang","searchableLanguages","searchLower","currentLanguage","language","handleLanguageChange","changeLanguage","newSelectedLanguages","handleAddLanguage","notificationBadge","showHelp","setShowHelp","helpSticky","setHelpSticky","selectedHelpTopic","setSelectedHelpTopic","setIsDarkMode","cacheClearing","setCacheClearing","cacheCleared","setCacheCleared","savedTheme","prefersLight","matchMedia","matches","currentLang","isRTL","documentElement","dir","toggleTheme","helpContentService","handleFlushCache","cacheManagementService","alert","handleClick","handleCloseHelp","handleHelpTopicClick","LanguageSelector","HelpModal","onClose","handleCloseModal","currentImagePath","setCurrentImagePath","updateImagePath","observer","MutationObserver","mutations","mutation","attributeName","observe","attributes","attributeFilter","disconnect","showMenu","setShowMenu","currentSlide","setCurrentSlide","createContextualUrl","baseUrl","_contextData$selected","urlParams","URLSearchParams","helpModalInstance","openSgexIssue","template","labels","newWindow","_window$helpModalInst","_window$helpModalInst2","closed","showFallbackInstructions","call","_window$helpModalInst3","_window$helpModalInst4","close","_window$helpModalInst5","_window$helpModalInst6","sgex_dak_repository","_window$helpModalInst7","_window$helpModalInst8","_window$helpModalInst9","_window$helpModalInst0","_window$helpModalInst1","_window$helpModalInst10","reason","fallback","existingFallback","querySelector","remove","fallbackOverlay","createElement","cssText","fallbackModal","innerHTML","appendChild","handlePrevSlide","handleNextSlide","renderSlideshow","slides","currentSlideData","processedContent","dangerouslySetInnerHTML","__html","_","getHelpContent","handleMenuToggle","handleDocumentation","handleBugReport","_window$helpModalInst11","_contextData$selected2","sgex_page","sgex_current_url","_window$helpModalInst12","_window$helpModalInst13","_window$helpModalInst14","_window$helpModalInst15","handleDAKFeedback","_window$helpModalInst16","handleEmailSupport","topicTitle","subject","CACHE_KEY_PREFIX","CACHE_EXPIRY_HOURS","cacheExpiryHours","getCacheKey","isStale","getCachedRepositories","_parsed$repositories","cache","cachedData","age","repositories","setCachedRepositories","cacheData","clearCache","cached","exists","stale","ageHours","Math","round","metadataKey","getAllLocalChanges","getLocalContent","filePath","saveLocal","changes","allMetadata","getAllMetadata","originalPath","removeLocal","getMetadata","getLocalChangesCount","exportLocalChanges","format","exportData","exported","version","Blob","importLocalChanges","jsonData","importData","existingChanges","existingMetadata","mergedChanges","mergedMetadata","clearAllLocalChanges","getStorageInfo","changesSize","metadataSize","totalSize","formattedSize","formatBytes","bytes","i","floor","parseFloat","pow","toFixed","repositoryExists","checkRepositoryExists","sushiConfigContent","fetchSushiConfig","yaml","dependencies","octokit","rest","repos","branchesToTry","getContent","decodeURIComponent","escape","atob","branchError","validNamePattern","fullName"],"sourceRoot":""}