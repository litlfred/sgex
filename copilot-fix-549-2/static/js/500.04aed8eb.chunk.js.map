{"version":3,"file":"static/js/500.04aed8eb.chunk.js","mappings":"iLAypBA,MACA,EADqB,IAvoBrB,MACEA,WAAAA,GACEC,KAAKC,aAAc,EACnBD,KAAKE,mBAAqB,KAC1BF,KAAKG,KAAO,GACZH,KAAKI,UAAY,IAAIC,GACvB,CAMA,kBAAMC,CAAaC,EAAYC,EAAQC,GACrCT,KAAKU,IAAI,OAAO,0BAADC,OAA4BJ,EAAWK,UAAS,KAAAD,OAAIH,IAEnE,IAEE,MAAMK,QAAoBb,KAAKc,mBAAmBP,EAAYC,EAAQC,GACtET,KAAKU,IAAI,OAAO,UAADC,OAAYE,EAAYE,OAAM,2BAG7C,MAAMC,QAAqBhB,KAAKiB,4BAChCjB,KAAKU,IAAI,OAAO,UAADC,OAAYK,EAAaD,OAAM,mCAG9C,MAAMG,EAAclB,KAAKmB,cAAcN,EAAaG,GAGpD,OAFAhB,KAAKU,IAAI,OAAO,gCAADC,OAAkCO,EAAYH,SAEtDG,CACT,CAAE,MAAOE,GAEP,MADApB,KAAKU,IAAI,QAAQ,6BAADC,OAA+BS,EAAMC,UAC/CD,CACR,CACF,CAKA,wBAAMN,CAAmBP,EAAYC,EAAQC,GAC3C,MAAMa,EAAW,GAEjB,IAEE,MAAMC,EAAiB,CACrB,YACA,MACA,qBACA,uBACA,sBACA,wBACA,qBACA,kBACA,qBAGF,IAAK,MAAMC,KAAaD,EACtB,IACE,MAAME,QAAcC,EAAAA,EAAcC,sBAChCpB,EAAWqB,MAAMC,MACjBtB,EAAWuB,KACXN,EACAhB,EACAC,EAAQsB,OAGV,GAAIC,MAAMC,QAAQR,GAChB,IAAK,MAAMS,KAAQT,EACjB,GAAkB,SAAdS,EAAKC,MAAmBD,EAAKJ,KAAKM,SAAS,QAAS,CACtD,MAAMC,QAAgBX,EAAAA,EAAcY,eAClC/B,EAAWqB,MAAMC,MACjBtB,EAAWuB,KACXI,EAAKK,KACL/B,EACAC,EAAQsB,OAGVT,EAASkB,KAAK,CACZD,KAAML,EAAKK,KACXT,KAAMI,EAAKJ,KACXO,QAASA,EACTI,OAAQ,SACRC,KAAMR,EAAKQ,MAEf,CAGN,CAAE,MAAOtB,GAEPpB,KAAKU,IAAI,QAAQ,aAADC,OAAea,EAAS,8BAC1C,CAIF,IACE,MAAMmB,QAAkBjB,EAAAA,EAAcC,sBACpCpB,EAAWqB,MAAMC,MACjBtB,EAAWuB,KACX,GACAtB,EACAC,EAAQsB,OAGV,GAAIC,MAAMC,QAAQU,GAChB,IAAK,MAAMT,KAAQS,EACjB,GAAkB,SAAdT,EAAKC,MAAmBD,EAAKJ,KAAKM,SAAS,QAAS,CACtD,MAAMC,QAAgBX,EAAAA,EAAcY,eAClC/B,EAAWqB,MAAMC,MACjBtB,EAAWuB,KACXI,EAAKK,KACL/B,EACAC,EAAQsB,OAGVT,EAASkB,KAAK,CACZD,KAAML,EAAKK,KACXT,KAAMI,EAAKJ,KACXO,QAASA,EACTI,OAAQ,SACRC,KAAMR,EAAKQ,MAEf,CAGN,CAAE,MAAOtB,GACPpB,KAAKU,IAAI,QAAQ,gCAADC,OAAkCS,EAAMC,SAC1D,CAEF,CAAE,MAAOD,GAEP,MADApB,KAAKU,IAAI,QAAQ,oCAADC,OAAsCS,EAAMC,UACtDD,CACR,CAEA,OAAOE,CACT,CAKA,+BAAML,GACJ,MAAMK,EAAW,GAEjB,IACE,MAAMsB,EAAgBC,EAAAA,EAAqBC,mBAE3C,GAAIF,GAAiBA,EAAcnB,MACjC,IAAK,MAAMS,KAAQU,EAAcnB,MAC3BS,EAAKK,KAAKH,SAAS,SACrBd,EAASkB,KAAK,CACZD,KAAML,EAAKK,KACXT,KAAMI,EAAKK,KAAKQ,MAAM,KAAKC,MAC3BX,QAASH,EAAKG,QACdI,OAAQ,UACRQ,SAAUf,EAAKe,SACfC,UAAWhB,EAAKgB,WAK1B,CAAE,MAAO9B,GAEP,MADApB,KAAKU,IAAI,QAAQ,4CAADC,OAA8CS,EAAMC,UAC9DD,CACR,CAEA,OAAOE,CACT,CAMAH,aAAAA,CAAcN,EAAaG,GACzB,MAAME,EAAc,IAAIL,GAGxB,IAAK,MAAMsC,KAAenC,EAAc,CACtC,MAAMoC,EAAgBlC,EAAYmC,UAAUC,GAAKA,EAAEf,OAASY,EAAYZ,MAEpEa,GAAiB,GAEnBlC,EAAYkC,GAAiBD,EAC7BnD,KAAKU,IAAI,QAAQ,cAADC,OAAgBwC,EAAYZ,KAAI,mCAGhDrB,EAAYsB,KAAKW,GACjBnD,KAAKU,IAAI,QAAQ,mBAADC,OAAqBwC,EAAYZ,KAAI,yBAEzD,CAEA,OAAOrB,CACT,CAKA,qBAAMqC,CAAgBhD,EAAYC,EAAQC,GACxC,IACE,IAAI+C,EAAe,KACfC,EAAgB,KAGpB,IACE,MAAMC,QAAsBhC,EAAAA,EAAcY,eACxC/B,EAAWqB,MAAMC,MACjBtB,EAAWuB,KACX,oBACAtB,EACAC,EAAQsB,OAEVyB,EAAeG,EAAAA,QAAAA,KAAUD,GACzB1D,KAAKU,IAAI,OAAO,2CAADC,OAA6C6C,EAAaI,IAAM,WACjF,CAAE,MAAOxC,GACPpB,KAAKU,IAAI,OAAO,iDAADC,OAAmDS,EAAMC,SAC1E,CAGA,IACE,MACMwC,EADehB,EAAAA,EAAqBiB,kBACHC,KAAK7B,GAAsB,sBAAdA,EAAKK,MACrDsB,IACFJ,EAAgBE,EAAAA,QAAAA,KAAUE,EAAkBxB,SAC5CrC,KAAKU,IAAI,OAAO,4CAADC,OAA8C8C,EAAcG,IAAM,YAErF,CAAE,MAAOxC,GACPpB,KAAKU,IAAI,OAAO,kDAADC,OAAoDS,EAAMC,SAC3E,CAGA,MAAM2C,EAASP,GAAiBD,EAChC,IAAKQ,EACH,MAAM,IAAIC,MAAM,uDAGlB,MAAO,CACLD,SACAE,mBAAoBV,EACpBW,oBAAqBV,EACrBW,iBAAkBX,EAEtB,CAAE,MAAOrC,GAEP,MADApB,KAAKU,IAAI,QAAQ,qCAADC,OAAuCS,EAAMC,UACvDD,CACR,CACF,CAKA,8BAAMiD,CAAyBL,GAC7B,IACE,MAAMM,EAAcX,EAAAA,QAAAA,KAAUK,EAAQ,CACpCO,OAAQ,EACRC,UAAW,IACXC,YAAa,MAKf,OAFA5B,EAAAA,EAAqB6B,SAAS,oBAAqBJ,GACnDtE,KAAKU,IAAI,OAAQ,gDACV,CACT,CAAE,MAAOU,GAEP,MADApB,KAAKU,IAAI,QAAQ,gDAADC,OAAkDS,EAAMC,UAClED,CACR,CACF,CAKAuD,mBAAAA,CAAoBX,GAClB,MAAMY,EAAS,GACTC,EAAW,GAiDjB,OA9CKb,EAAOJ,GAEA,4BAA4BkB,KAAKd,EAAOJ,KAClDgB,EAAOpC,KAAK,yEAFZoC,EAAOpC,KAAK,wBAKTwB,EAAOlC,KAED,KAAKgD,KAAKd,EAAOlC,OAC1B8C,EAAOpC,KAAK,2EAFZoC,EAAOpC,KAAK,0BAKTwB,EAAOe,QAEA,kCAAkCD,KAAKd,EAAOe,UACxDH,EAAOpC,KAAK,yDAFZoC,EAAOpC,KAAK,6BAKTwB,EAAOgB,YAEA,CAAC,QAAS,QAAS,SAASC,SAASjB,EAAOgB,cACtDH,EAASrC,KAAK,qDAFdqC,EAASrC,KAAK,kDAMXwB,EAAOkB,UAE2B,kBAArBlB,EAAOkB,YAClBlB,EAAOkB,UAAUpD,MACpB+C,EAASrC,KAAK,iCAEZwB,EAAOkB,UAAUC,MAAQ,eAAeL,KAAKd,EAAOkB,UAAUC,MAChEP,EAAOpC,KAAK,uEAEVwB,EAAOkB,UAAUE,QAAU,6BAA6BN,KAAKd,EAAOkB,UAAUE,QAChFR,EAAOpC,KAAK,kDATdqC,EAASrC,KAAK,wCAcXwB,EAAOqB,aAEArB,EAAOqB,aAAa,oBAAuBrB,EAAOqB,aAAa,uBACzER,EAASrC,KAAK,0EAFdqC,EAASrC,KAAK,qEAKT,CACL8C,MAAyB,IAAlBV,EAAO7D,OACd6D,SACAC,WAEJ,CAKA,0BAAMU,CAAqBhF,EAAYC,EAAQC,EAASuD,GACtD,MAAMwB,EAAQ,GAEd,GAAIxB,EAAOwB,MACT,IAAK,MAAOC,EAASC,KAAcC,OAAOC,QAAQ5B,EAAOwB,OAAQ,CAC/D,MAAMK,GAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,CACRC,IAAKN,GACFC,GAAS,IACZM,QAAS,CACPC,OAAQ,KACRC,QAAS,QAKPC,EAAc,qBAAAxF,OAAwB8E,EAAO,OAGnD,IACE,MAAMpD,QAAgBX,EAAAA,EAAcY,eAClC/B,EAAWqB,MAAMC,MACjBtB,EAAWuB,KACXqE,EACA3F,EACAC,EAAQsB,OAEV8D,EAAKG,QAAQC,OAAS,CACpB1D,KAAM4D,EACNhB,IAAI,sBAADxE,OAAwBJ,EAAWqB,MAAMC,MAAK,KAAAlB,OAAIJ,EAAWuB,KAAI,UAAAnB,OAASH,EAAM,KAAAG,OAAIwF,GACvFzD,KAAML,EAAQtB,OAElB,CAAE,MAAOK,GACP,CAIF,IACE,MACM+B,EADeN,EAAAA,EAAqBiB,kBACTC,KAAK7B,GAAQA,EAAKK,OAAS4D,GACxDhD,IACF0C,EAAKG,QAAQE,QAAU,CACrB3D,KAAM4D,EACNzD,KAAMS,EAAYd,QAAQtB,QAGhC,CAAE,MAAOK,GACP,CAGFoE,EAAMhD,KAAKqD,EACb,CAGF,OAAOL,CACT,CAMA,cAAMY,CAAS7F,EAAYC,EAAQC,GACjCT,KAAKU,IAAI,OAAQ,6CACjBV,KAAKqG,YAEL,IAEE,MAAM/E,QAAiBtB,KAAKM,aAAaC,EAAYC,EAAQC,GACvD6F,QAAqBtG,KAAKuD,gBAAgBhD,EAAYC,EAAQC,GAEpE,GAAwB,IAApBa,EAASP,OAEX,OADAf,KAAKU,IAAI,OAAQ,iCACV,CACL6F,SAAS,EACTlF,QAAS,gCACTI,MAAO,GACPtB,KAAMH,KAAKG,MAKf,MAAMqG,EAAWxG,KAAKyG,gBAAgBnF,GAgBtC,OAdAtB,KAAKE,mBAAqB,CACxBuB,MAAOH,EACP0C,OAAQsC,EAAatC,OACrBwC,SAAUA,EACVE,cAAe,CACbxC,iBAAkBoC,EAAapC,iBAC/BC,kBAAmBmC,EAAanC,kBAChCC,eAAgBkC,EAAalC,iBAIjCpE,KAAKU,IAAI,OAAQ,2CACjBV,KAAK2G,kBAEE,CACLJ,SAAS,EACTK,OAAQ,CACNnF,MAAOH,EACP0C,OAAQsC,EAAatC,OACrB0C,cAAeJ,EACfE,SAAUA,EACVnF,QAAS,+FAEXI,MAAOH,EACPnB,KAAMH,KAAKG,KACX0G,MAAO7G,KAAK8G,iBAAiBN,GAGjC,CAAE,MAAOpF,GAIP,OAHApB,KAAKU,IAAI,QAAQ,0BAADC,OAA4BS,EAAMC,UAClDrB,KAAK2G,kBAEE,CACLJ,SAAS,EACTnF,MAAOA,EAAMC,QACblB,KAAMH,KAAKG,KAEf,CACF,CAKAsG,eAAAA,CAAgBnF,GACd,MAAMkF,EAAW,CACfO,WAAYzF,EAASP,OACrBF,YAAaS,EAAS0F,OAAO1D,GAAkB,WAAbA,EAAEb,QAAqB1B,OACzDC,aAAcM,EAAS0F,OAAO1D,GAAkB,YAAbA,EAAEb,QAAsB1B,OAC3DkG,UAAW,GACXC,UAAW,CAAC,EACZC,WAAY,EACZC,SAAU,EACVC,WAAY,EACZC,UAAW,EACXC,YAAa,EACbC,UAAW,GAyBb,OAtBAlG,EAASmG,QAAQvF,IAEf,MAAMG,EAAUH,EAAKG,QACrBmE,EAASW,YAAc9E,EAAQU,MAAM,MAAMhC,OAGvCsB,EAAQ4C,SAAS,aAAauB,EAASY,WACvC/E,EAAQ4C,SAAS,eAAeuB,EAASa,aACzChF,EAAQ4C,SAAS,cAAcuB,EAASc,YACxCjF,EAAQ4C,SAAS,gBAAgBuB,EAASe,cAC1ClF,EAAQ4C,SAAS,cAAcuB,EAASgB,YAGxB,YAAhBtF,EAAKO,QACP+D,EAASS,UAAUzE,KAAKN,EAAKK,MAI/B,MAAMmF,EAAYxF,EAAKK,KAAKQ,MAAM,KAAKC,MACvCwD,EAASU,UAAUQ,IAAclB,EAASU,UAAUQ,IAAc,GAAK,IAGlElB,CACT,CAKAM,gBAAAA,CAAiBN,GACf,MAAO,CACL/E,MAAO+E,EAASO,WAChBY,MAAOnB,EAASW,WAChBnB,QAAS,CACPC,OAAQO,EAAS3F,YACjBqF,QAASM,EAASxF,cAEpB4G,WAAY,CACVR,SAAUZ,EAASY,SACnBC,WAAYb,EAASa,WACrBC,UAAWd,EAASc,UACpBC,YAAaf,EAASe,YACtBC,UAAWhB,EAASgB,WAEtBP,UAAWT,EAASS,UAAUlG,OAElC,CAKAsF,SAAAA,GACErG,KAAKG,KAAO,EACd,CAKAO,GAAAA,CAAImH,EAAOxG,GACT,MAAMyG,EAAW,CACfD,MAAOA,EACPxG,QAASA,EACT0G,SAJwBC,UAAAjH,OAAA,QAAAkH,IAAAD,UAAA,GAAAA,UAAA,GAAG,KAK3B9E,WAAW,IAAIgF,MAAOC,eAGxBnI,KAAKG,KAAKqC,KAAKsF,GACfM,QAAQP,IAAUO,QAAQP,GAAO,WAADlH,OAAYU,GAC9C,CAKAgH,OAAAA,GACE,OAAOrI,KAAKG,IACd,CAKAmI,cAAAA,CAAeT,GACb,OAAO7H,KAAKG,KAAK6G,OAAOtG,GAAOA,EAAImH,QAAUA,EAC/C,CAKAU,UAAAA,CAAWC,GACT,OAAOxI,KAAKG,KAAK6G,OAAOtG,GACtBA,EAAIW,QAAQoH,cAAcxD,SAASuD,EAAWC,eAElD,CAKAC,gBAAAA,GACE,OAAO1I,KAAKG,KAAKwI,IAAIjI,GAAG,IAAAC,OAClBD,EAAIwC,UAAS,OAAAvC,OAAMD,EAAImH,MAAMe,cAAa,MAAAjI,OAAKD,EAAIW,SAAOV,OAAGD,EAAIqH,SAAQ,KAAApH,OAAQD,EAAIqH,SAAQ,KAAM,KACvGc,KAAK,KACT,CAKAC,qBAAAA,GACE,OAAO9I,KAAKE,kBACd,CAKA6I,WAAAA,CAAYC,GAEV,OADAhJ,KAAKI,UAAU6I,IAAID,GACZ,IAAMhJ,KAAKI,UAAU8I,OAAOF,EACrC,CAKArC,eAAAA,GACE3G,KAAKI,UAAUqH,QAAQuB,IACrB,IACEA,EAAS,CACP7I,KAAMH,KAAKG,KACXgJ,QAASnJ,KAAKE,mBACd2G,MAAO7G,KAAKE,mBAAqBF,KAAK8G,iBAAiB9G,KAAKE,mBAAmBsG,UAAY,MAE/F,CAAE,MAAOpF,GACPgH,QAAQhH,MAAM,0CAA2CA,EAC3D,GAEJ,CAKAgI,aAAAA,GACE,OAAOpJ,KAAKC,WACd,CAKA,iBAAMoJ,CAAYC,GAChB,IAEE,MAAM1E,EAAS,GACTC,EAAW,GAEX8C,EAAQ2B,EAAWvG,MAAM,MAC/B,IAAK,IAAIwG,EAAI,EAAGA,EAAI5B,EAAM5G,OAAQwI,IAAK,CACrC,MAAMC,EAAO7B,EAAM4B,GAAGE,OAGlBD,EAAKvE,SAAS,cAAgBuE,EAAKvE,SAAS,MAC9CJ,EAASrC,KAAK,QAAD7B,OAAS4I,EAAI,EAAC,qDAGzBC,EAAKvE,SAAS,MAASuE,EAAKvE,SAAS,MAASuE,EAAKvE,SAAS,OAC9DJ,EAASrC,KAAK,QAAD7B,OAAS4I,EAAI,EAAC,sCAE/B,CAEA,MAAO,CACLjE,MAAyB,IAAlBV,EAAO7D,OACd6D,OAAQA,EACRC,SAAUA,EAEd,CAAE,MAAOzD,GACP,MAAO,CACLkE,OAAO,EACPV,OAAQ,CAACxD,EAAMC,SACfwD,SAAU,GAEd,CACF,E,2GC/oBF,MA0UA,EA1UoB6E,KAClB,MAAM,KAAEC,EAAI,KAAEC,EAAI,OAAEpJ,IAAWqJ,EAAAA,EAAAA,KACzB9B,GAAW+B,EAAAA,EAAAA,MACXC,GAAWC,EAAAA,EAAAA,OAGVzJ,EAAY0J,IAAiBC,EAAAA,EAAAA,UAAS,OACtCC,EAAgBC,IAAqBF,EAAAA,EAAAA,UAAS1J,GAAU,SACxDC,EAAS4J,IAAcH,EAAAA,EAAAA,UAAS,OAChCI,EAASC,IAAcL,EAAAA,EAAAA,WAAS,IAChC9I,EAAOoJ,IAAYN,EAAAA,EAAAA,UAAS,OAC5BO,EAAWC,IAAgBR,EAAAA,EAAAA,WAAS,IACpCf,EAASwB,IAAcT,EAAAA,EAAAA,UAAS,OAChC/J,EAAMyK,IAAWV,EAAAA,EAAAA,UAAS,KAC1BW,EAAWC,IAAgBZ,EAAAA,EAAAA,UAAS,QACpC1B,EAAYuC,IAAiBb,EAAAA,EAAAA,UAAS,KACtCc,EAAeC,IAAoBf,EAAAA,EAAAA,UAAS,IAAI7J,MAGvD6K,EAAAA,EAAAA,WAAU,KACkBC,WACxBZ,GAAW,GACXC,EAAS,MAET,IAAK,IAADY,EAEF,MAAMC,EAAgBC,aAAaC,QAAQ,gBAC3C,IAAKF,EAEH,YADAtB,EAAS,mBAIX,MAAMyB,EAAcC,KAAKC,MAAML,GAI/B,GAHAhB,EAAWmB,GAGP7B,GAAQC,EAAM,CAChB,MAAM+B,QAAuBjK,EAAAA,EAAckK,cAAcjC,EAAMC,EAAM4B,EAAYzJ,OACjFkI,EAAc0B,GACdvB,EAAkB5J,GAAUmL,EAAeE,gBAAkB,OAC/D,MAAyB,QAAlBT,EAAIrD,EAAS+D,aAAK,IAAAV,GAAdA,EAAgB7K,YAEzB0J,EAAclC,EAAS+D,MAAMvL,YAC7B6J,EAAkBrC,EAAS+D,MAAM3B,gBAAkBpC,EAAS+D,MAAMvL,WAAWsL,gBAAkB,SAE/FrB,EAAS,yEAEb,CAAE,MAAOuB,GACP3D,QAAQhH,MAAM,2CAA4C2K,GAC1DvB,EAAS,8BAAD7J,OAA+BoL,EAAI1K,SAC7C,CAAC,QACCkJ,GAAW,EACb,GAGFyB,IACC,CAACrC,EAAMC,EAAMpJ,EAAQuH,EAAS+D,MAAO/B,KAGxCmB,EAAAA,EAAAA,WAAU,IACYe,EAAAA,EAAalD,YAAamD,IAC5CtB,EAAQsB,EAAO/L,MAAQ,IACvBwK,EAAWuB,EAAO/C,WAInB,IAGH,MAAMgD,EAAehM,EAAK6G,OAAOtG,IAC/B,MAAM0L,EAA2B,QAAdvB,GAAuBnK,EAAImH,QAAUgD,EAClDwB,EAA6B,KAAf7D,GAClB9H,EAAIW,QAAQoH,cAAcxD,SAASuD,EAAWC,eAChD,OAAO2D,GAAcC,IAIjBC,GAAiBC,EAAAA,EAAAA,aAAYpB,UACjC,GAAK5K,GAAe4J,GAAmB1J,EAAvC,CAKAiK,GAAa,GACbC,EAAW,MACXC,EAAQ,IAER,IACE,MAAMhE,QAAeqF,EAAAA,EAAa7F,SAAS7F,EAAY4J,EAAgB1J,EAAS,CAC9E+L,SAAU,SAGZ7B,EAAW/D,EACb,CAAE,MAAOxF,GACPgH,QAAQhH,MAAM,2BAA4BA,GAC1CuJ,EAAW,CACTpE,SAAS,EACTnF,MAAOA,EAAMC,QACblB,KAAM8L,EAAAA,EAAa5D,WAEvB,CAAC,QACCqC,GAAa,EACf,CArBA,MAFE+B,MAAM,sDAwBP,CAAClM,EAAY4J,EAAgB1J,IAkC1BiM,EAAoBA,KAEtB3C,EADEJ,GAAQC,GAAQO,EACT,cAADxJ,OAAegJ,EAAI,KAAAhJ,OAAIiJ,EAAI,KAAAjJ,OAAIwJ,GAE9B,eAKPwC,EAAY,CAChBvL,MAAOjB,EAAK6G,OAAO4F,GAAiB,UAAZA,EAAE/E,OAAmB9G,OAC7C8L,KAAM1M,EAAK6G,OAAO4F,GAAiB,SAAZA,EAAE/E,OAAkB9G,OAC3C+L,KAAM3M,EAAK6G,OAAO4F,GAAiB,SAAZA,EAAE/E,OAAkB9G,OAC3CgM,MAAO5M,EAAK6G,OAAO4F,GAAiB,UAAZA,EAAE/E,OAAmB9G,QAG/C,OAAIuJ,GAEA0C,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,sBAAqBC,UAClCC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,mCAENF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBC,SAAA,EAChCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qBACfE,EAAAA,EAAAA,KAAA,KAAAD,SAAG,wCAMP9L,GAEA4L,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sBAAqBC,SAAA,EAClCC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,iCACJC,EAAAA,EAAAA,KAAA,UAAQC,QAASV,EAAmBO,UAAU,eAAcC,SAAC,0BAI/DF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kBAAiBC,SAAA,EAC9BC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,WACJC,EAAAA,EAAAA,KAAA,KAAAD,SAAI9L,KACJ+L,EAAAA,EAAAA,KAAA,UAAQC,QAASV,EAAmBO,UAAU,cAAaC,SAAC,2BASlEF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,sBAAqBC,SAAA,EAClCC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,iCACJF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wBAAuBC,SAAA,EACpCC,EAAAA,EAAAA,KAAA,UACEC,QAASd,EACTe,SAAU5C,EACVwC,UAAU,aAAYC,SAErBzC,EAAY,aAAe,8BAE9B0C,EAAAA,EAAAA,KAAA,UAAQC,QAASV,EAAmBO,UAAU,eAAcC,SAAC,6BAMjEF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBC,SAAA,EAEnCF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kBAAiBC,SAAA,EAC9BF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,CAAI,eAAuB,OAAV3M,QAAU,IAAVA,OAAU,EAAVA,EAAYK,UAAU,KAAGuJ,EAAe,QACzDgD,EAAAA,EAAAA,KAAA,KAAAD,SAAG,6NAIJ/D,IACC6D,EAAAA,EAAAA,MAAA,OAAKC,UAAS,mBAAAtM,OAAqBwI,EAAQ5C,QAAU,UAAY,SAAU2G,SAAA,EACzEC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,sBACJF,EAAAA,EAAAA,MAAA,KAAAE,SAAA,CAAG,YACOC,EAAAA,EAAAA,KAAA,UAAAD,SAAS/D,EAAQ5C,QAAU,UAAY,cAEhD4C,EAAQ1H,QACPuL,EAAAA,EAAAA,MAAA,KAAAE,SAAA,CAAG,wBAAsB/D,EAAQ1H,MAAMV,UAExCoI,EAAQ/H,QACP4L,EAAAA,EAAAA,MAAA,KAAGC,UAAU,gBAAeC,SAAA,CAAC,UAAQ/D,EAAQ/H,SAE9C+H,EAAQtC,QACPmG,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBC,SAAA,EAChCC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,0BACHC,EAAAA,EAAAA,KAAA,OAAAD,SAAMzB,KAAK6B,UAAUnE,EAAQtC,MAAO,KAAM,YAOlDmG,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcC,SAAA,EAC3BF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,cAAaC,SAAA,EAC1BC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,qBACJF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,gBAAeC,SAAA,EAC5BF,EAAAA,EAAAA,MAAA,UACEO,MAAO1C,EACP2C,SAAWC,GAAM3C,EAAa2C,EAAEC,OAAOH,OACvCN,UAAU,aAAYC,SAAA,EAEtBF,EAAAA,EAAAA,MAAA,UAAQO,MAAM,MAAKL,SAAA,CAAC,aAAW/M,EAAKY,OAAO,QAC3CiM,EAAAA,EAAAA,MAAA,UAAQO,MAAM,QAAOL,SAAA,CAAC,WAASP,EAAUvL,MAAM,QAC/C4L,EAAAA,EAAAA,MAAA,UAAQO,MAAM,OAAML,SAAA,CAAC,aAAWP,EAAUE,KAAK,QAC/CG,EAAAA,EAAAA,MAAA,UAAQO,MAAM,OAAML,SAAA,CAAC,SAAOP,EAAUG,KAAK,QAC3CE,EAAAA,EAAAA,MAAA,UAAQO,MAAM,QAAOL,SAAA,CAAC,UAAQP,EAAUI,MAAM,WAEhDI,EAAAA,EAAAA,KAAA,SACEhL,KAAK,OACLwL,YAAY,iBACZJ,MAAO/E,EACPgF,SAAWC,GAAM1C,EAAc0C,EAAEC,OAAOH,OACxCN,UAAU,gBAEZE,EAAAA,EAAAA,KAAA,UAAQC,QAvJQQ,KAC1B,MAAMC,EAAU5B,EAAAA,EAAavD,mBAC7BoF,UAAUC,UAAUC,UAAUH,GAASI,KAAK,KAC1CxB,MAAM,8BACLyB,MAAMnC,IACP3D,QAAQhH,MAAM,uBAAwB2K,MAkJQkB,UAAU,mBAAkBC,SAAC,yBAMvEC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,iBAAgBC,SACJ,IAAxBf,EAAapL,QACZoM,EAAAA,EAAAA,KAAA,KAAGF,UAAU,UAASC,SAAC,uBAEvBf,EAAaxD,IAAI,CAACjI,EAAKyN,KACrBnB,EAAAA,EAAAA,MAAA,OAEEC,UAAS,iBAAAtM,OAAmBD,EAAImH,OAChCuF,QAASA,IA3JH1M,KACpB,MAAMmN,EAAO,IAAAlN,OAAOD,EAAIwC,UAAS,OAAAvC,OAAMD,EAAImH,MAAMe,cAAa,MAAAjI,OAAKD,EAAIW,SAAOV,OAAGD,EAAIqH,SAAQ,KAAApH,OAAQD,EAAIqH,SAAQ,KAAM,IACvH+F,UAAUC,UAAUC,UAAUH,GAASI,KAAK,QAEzCC,MAAMnC,IACP3D,QAAQhH,MAAM,4BAA6B2K,MAsJhBqC,CAAa1N,GAC5B2N,MAAM,6BAA4BnB,SAAA,EAElCC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,gBAAeC,SAAE,IAAIhF,KAAKxH,EAAIwC,WAAWoL,wBACzDnB,EAAAA,EAAAA,KAAA,QAAMF,UAAS,mBAAAtM,OAAqBD,EAAImH,OAAQqF,SAAExM,EAAImH,MAAMe,iBAC5DuE,EAAAA,EAAAA,KAAA,QAAMF,UAAU,cAAaC,SAAExM,EAAIW,UAClCX,EAAIqH,WACHiF,EAAAA,EAAAA,MAAA,QAAMC,UAAU,eAAcC,SAAA,CAAC,IAAExM,EAAIqH,SAAS,SAT3CoG,SAkBdhF,GAAWA,EAAQ1H,QAClBuL,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kBAAiBC,SAAA,EAC9BF,EAAAA,EAAAA,MAAA,MAAAE,SAAA,CAAI,wBAAsB/D,EAAQ1H,MAAMV,OAAO,QAC/CoM,EAAAA,EAAAA,KAAA,OAAKF,UAAU,aAAYC,SACxB/D,EAAQ1H,MAAMkH,IAAI,CAACzG,EAAMiM,KACxBnB,EAAAA,EAAAA,MAAA,OAAiBC,UAAU,YAAWC,SAAA,EACpCF,EAAAA,EAAAA,MAAA,OACEC,UAAU,cACVG,QAASA,IAzKEmB,KAC3B,MAAMC,EAAc,IAAInO,IAAI2K,GACxBwD,EAAYC,IAAIF,GAClBC,EAAYtF,OAAOqF,GAEnBC,EAAYvF,IAAIsF,GAElBtD,EAAiBuD,IAkKcE,CAAoBxM,EAAKK,MAAM2K,SAAA,EAE9CC,EAAAA,EAAAA,KAAA,QAAMF,UAAU,YAAWC,SAAEhL,EAAKK,QAClC4K,EAAAA,EAAAA,KAAA,QAAMF,UAAS,sBAAAtM,OAAwBuB,EAAKO,QAASyK,SAClDhL,EAAKO,UAER0K,EAAAA,EAAAA,KAAA,QAAMF,UAAU,cAAaC,SAC1BlC,EAAcyD,IAAIvM,EAAKK,MAAQ,SAAM,cAGzCyI,EAAcyD,IAAIvM,EAAKK,QACtB4K,EAAAA,EAAAA,KAAA,OAAKF,UAAU,eAAcC,UAC3BC,EAAAA,EAAAA,KAAA,OAAAD,SAAMhL,EAAKG,cAfP8L,SAyBjBhF,GAAWA,EAAQvC,SAClBoG,EAAAA,EAAAA,MAAA,OAAKC,UAAU,cAAaC,SAAA,EAC1BC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,0BACJC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,iBAAgBC,UAC7BC,EAAAA,EAAAA,KAAA,OAAAD,SAAMzB,KAAK6B,UAAUnE,EAAQvC,OAAQ,KAAM,gB","sources":["services/sushiService.js","components/SushiRunner.js"],"sourcesContent":["/**\n * SUSHI Service\n * \n * Provides client-side FSH file loading and management for SGEX Workbench.\n * Integrates with GitHub repositories and staging ground to load and process FSH files.\n * \n * Key features:\n * - Load FSH files from GitHub repositories\n * - Override with staging ground files  \n * - Provide file merging logic as requested\n * - Detailed logging and error reporting\n * - Future SUSHI compilation support when library is compatible\n */\n\nimport githubService from './githubService';\nimport stagingGroundService from './stagingGroundService';\nimport yaml from 'js-yaml';\n\nclass SushiService {\n  constructor() {\n    this.initialized = true; // Simplified for now\n    this.compilationResults = null;\n    this.logs = [];\n    this.listeners = new Set();\n  }\n\n  /**\n   * Load all FSH files from GitHub repository and staging ground\n   * GitHub files are loaded first, then overridden by staging ground files\n   */\n  async loadFSHFiles(repository, branch, profile) {\n    this.log('info', `Loading FSH files from ${repository.full_name}/${branch}`);\n    \n    try {\n      // Step 1: Load all FSH files from GitHub repository\n      const githubFiles = await this.loadGitHubFSHFiles(repository, branch, profile);\n      this.log('info', `Loaded ${githubFiles.length} FSH files from GitHub`);\n      \n      // Step 2: Load staging ground files and override GitHub files\n      const stagingFiles = await this.loadStagingGroundFSHFiles();\n      this.log('info', `Loaded ${stagingFiles.length} FSH files from staging ground`);\n      \n      // Step 3: Merge files - staging ground overrides GitHub\n      const mergedFiles = this.mergeFSHFiles(githubFiles, stagingFiles);\n      this.log('info', `Total FSH files after merge: ${mergedFiles.length}`);\n      \n      return mergedFiles;\n    } catch (error) {\n      this.log('error', `Failed to load FSH files: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Load FSH files from GitHub repository\n   */\n  async loadGitHubFSHFiles(repository, branch, profile) {\n    const fshFiles = [];\n    \n    try {\n      // Common FSH directories to check\n      const fshDirectories = [\n        'input/fsh',\n        'fsh', \n        'input/fsh/profiles',\n        'input/fsh/extensions',\n        'input/fsh/valuesets',\n        'input/fsh/codesystems',\n        'input/fsh/examples',\n        'input/fsh/rules',\n        'input/fsh/aliases'\n      ];\n\n      for (const directory of fshDirectories) {\n        try {\n          const files = await githubService.getRepositoryContents(\n            repository.owner.login,\n            repository.name,\n            directory,\n            branch,\n            profile.token\n          );\n\n          if (Array.isArray(files)) {\n            for (const file of files) {\n              if (file.type === 'file' && file.name.endsWith('.fsh')) {\n                const content = await githubService.getFileContent(\n                  repository.owner.login,\n                  repository.name,\n                  file.path,\n                  branch,\n                  profile.token\n                );\n                \n                fshFiles.push({\n                  path: file.path,\n                  name: file.name,\n                  content: content,\n                  source: 'github',\n                  size: file.size\n                });\n              }\n            }\n          }\n        } catch (error) {\n          // Directory might not exist, continue with next\n          this.log('debug', `Directory ${directory} not found or inaccessible`);\n        }\n      }\n\n      // Also check for any .fsh files in the root\n      try {\n        const rootFiles = await githubService.getRepositoryContents(\n          repository.owner.login,\n          repository.name,\n          '',\n          branch,\n          profile.token\n        );\n\n        if (Array.isArray(rootFiles)) {\n          for (const file of rootFiles) {\n            if (file.type === 'file' && file.name.endsWith('.fsh')) {\n              const content = await githubService.getFileContent(\n                repository.owner.login,\n                repository.name,\n                file.path,\n                branch,\n                profile.token\n              );\n              \n              fshFiles.push({\n                path: file.path,\n                name: file.name,\n                content: content,\n                source: 'github',\n                size: file.size\n              });\n            }\n          }\n        }\n      } catch (error) {\n        this.log('debug', `Root directory check failed: ${error.message}`);\n      }\n\n    } catch (error) {\n      this.log('error', `Failed to load GitHub FSH files: ${error.message}`);\n      throw error;\n    }\n\n    return fshFiles;\n  }\n\n  /**\n   * Load FSH files from staging ground\n   */\n  async loadStagingGroundFSHFiles() {\n    const fshFiles = [];\n    \n    try {\n      const stagingGround = stagingGroundService.getStagingGround();\n      \n      if (stagingGround && stagingGround.files) {\n        for (const file of stagingGround.files) {\n          if (file.path.endsWith('.fsh')) {\n            fshFiles.push({\n              path: file.path,\n              name: file.path.split('/').pop(),\n              content: file.content,\n              source: 'staging',\n              metadata: file.metadata,\n              timestamp: file.timestamp\n            });\n          }\n        }\n      }\n    } catch (error) {\n      this.log('error', `Failed to load staging ground FSH files: ${error.message}`);\n      throw error;\n    }\n\n    return fshFiles;\n  }\n\n  /**\n   * Merge GitHub and staging ground FSH files\n   * Staging ground files override GitHub files with the same path\n   */\n  mergeFSHFiles(githubFiles, stagingFiles) {\n    const mergedFiles = [...githubFiles];\n    \n    // Override GitHub files with staging ground files\n    for (const stagingFile of stagingFiles) {\n      const existingIndex = mergedFiles.findIndex(f => f.path === stagingFile.path);\n      \n      if (existingIndex >= 0) {\n        // Override existing file\n        mergedFiles[existingIndex] = stagingFile;\n        this.log('debug', `Overriding ${stagingFile.path} with staging ground version`);\n      } else {\n        // Add new file from staging ground\n        mergedFiles.push(stagingFile);\n        this.log('debug', `Adding new file ${stagingFile.path} from staging ground`);\n      }\n    }\n\n    return mergedFiles;\n  }\n\n  /**\n   * Load SUSHI configuration from repository and staging ground\n   */\n  async loadSushiConfig(repository, branch, profile) {\n    try {\n      let githubConfig = null;\n      let stagingConfig = null;\n\n      // Load from GitHub\n      try {\n        const configContent = await githubService.getFileContent(\n          repository.owner.login,\n          repository.name,\n          'sushi-config.yaml',\n          branch,\n          profile.token\n        );\n        githubConfig = yaml.load(configContent);\n        this.log('info', `Loaded SUSHI configuration from GitHub: ${githubConfig.id || 'unnamed'}`);\n      } catch (error) {\n        this.log('warn', `Could not load sushi-config.yaml from GitHub: ${error.message}`);\n      }\n\n      // Load from staging ground if available\n      try {\n        const stagingFiles = stagingGroundService.getStagingFiles();\n        const stagingConfigFile = stagingFiles.find(file => file.path === 'sushi-config.yaml');\n        if (stagingConfigFile) {\n          stagingConfig = yaml.load(stagingConfigFile.content);\n          this.log('info', `Loaded SUSHI configuration from staging: ${stagingConfig.id || 'unnamed'}`);\n        }\n      } catch (error) {\n        this.log('warn', `Could not load sushi-config.yaml from staging: ${error.message}`);\n      }\n\n      // Return staging config if available, otherwise GitHub config\n      const config = stagingConfig || githubConfig;\n      if (!config) {\n        throw new Error('No sushi-config.yaml found in repository or staging');\n      }\n\n      return {\n        config,\n        hasGithubVersion: !!githubConfig,\n        hasStagingVersion: !!stagingConfig,\n        isUsingStaging: !!stagingConfig\n      };\n    } catch (error) {\n      this.log('error', `Failed to load sushi-config.yaml: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Save SUSHI configuration to staging ground\n   */\n  async saveSushiConfigToStaging(config) {\n    try {\n      const yamlContent = yaml.dump(config, {\n        indent: 2,\n        lineWidth: 120,\n        quotingType: '\"'\n      });\n\n      stagingGroundService.saveFile('sushi-config.yaml', yamlContent);\n      this.log('info', 'Saved SUSHI configuration to staging ground');\n      return true;\n    } catch (error) {\n      this.log('error', `Failed to save sushi-config.yaml to staging: ${error.message}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Validate SUSHI configuration\n   */\n  validateSushiConfig(config) {\n    const errors = [];\n    const warnings = [];\n\n    // Required fields validation\n    if (!config.id) {\n      errors.push('id field is required');\n    } else if (!/^[a-z0-9]+(\\.[a-z0-9]+)*$/.test(config.id)) {\n      errors.push('id must be lowercase alphanumeric with dots only (e.g., who.fhir.anc)');\n    }\n\n    if (!config.name) {\n      errors.push('name field is required');\n    } else if (/\\s/.test(config.name)) {\n      errors.push('name should not contain spaces (use PascalCase, e.g., WHOANCGuidelines)');\n    }\n\n    if (!config.version) {\n      errors.push('version field is required');\n    } else if (!/^\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9]+)?$/.test(config.version)) {\n      errors.push('version must follow semantic versioning (e.g., 1.0.0)');\n    }\n\n    if (!config.fhirVersion) {\n      warnings.push('fhirVersion not specified, defaulting to 4.0.1');\n    } else if (!['4.0.1', '4.3.0', '5.0.0'].includes(config.fhirVersion)) {\n      warnings.push('fhirVersion should be one of: 4.0.1, 4.3.0, 5.0.0');\n    }\n\n    // Publisher validation\n    if (!config.publisher) {\n      warnings.push('publisher information is recommended');\n    } else if (typeof config.publisher === 'object') {\n      if (!config.publisher.name) {\n        warnings.push('publisher.name is recommended');\n      }\n      if (config.publisher.url && !/^https?:\\/\\//.test(config.publisher.url)) {\n        errors.push('publisher.url must be a valid URL starting with http:// or https://');\n      }\n      if (config.publisher.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(config.publisher.email)) {\n        errors.push('publisher.email must be a valid email address');\n      }\n    }\n\n    // Dependencies validation - ensure WHO base dependency for DAKs\n    if (!config.dependencies) {\n      warnings.push('dependencies section is recommended for WHO SMART Guidelines DAKs');\n    } else if (!config.dependencies['hl7.fhir.uv.sdc'] && !config.dependencies['smart.who.int.base']) {\n      warnings.push('WHO SMART Guidelines DAKs should include smart.who.int.base dependency');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      warnings\n    };\n  }\n\n  /**\n   * Get pages from sushi config and link to source files\n   */\n  async loadPagesWithSources(repository, branch, profile, config) {\n    const pages = [];\n    \n    if (config.pages) {\n      for (const [pageKey, pageValue] of Object.entries(config.pages)) {\n        const page = {\n          key: pageKey,\n          ...pageValue,\n          sources: {\n            github: null,\n            staging: null\n          }\n        };\n\n        // Check for source file in input/pagecontent\n        const sourceFileName = `input/pagecontent/${pageKey}.md`;\n        \n        // Check GitHub\n        try {\n          const content = await githubService.getFileContent(\n            repository.owner.login,\n            repository.name,\n            sourceFileName,\n            branch,\n            profile.token\n          );\n          page.sources.github = {\n            path: sourceFileName,\n            url: `https://github.com/${repository.owner.login}/${repository.name}/blob/${branch}/${sourceFileName}`,\n            size: content.length\n          };\n        } catch (error) {\n          // Page source not found in GitHub\n        }\n\n        // Check staging\n        try {\n          const stagingFiles = stagingGroundService.getStagingFiles();\n          const stagingFile = stagingFiles.find(file => file.path === sourceFileName);\n          if (stagingFile) {\n            page.sources.staging = {\n              path: sourceFileName,\n              size: stagingFile.content.length\n            };\n          }\n        } catch (error) {\n          // Page source not found in staging\n        }\n\n        pages.push(page);\n      }\n    }\n\n    return pages;\n  }\n\n  /**\n   * Run FSH file loading and analysis (simplified version)\n   * This loads and validates FSH files without full SUSHI compilation\n   */\n  async runSUSHI(repository, branch, profile, options = {}) {\n    this.log('info', 'Starting FSH file loading and analysis...');\n    this.clearLogs();\n\n    try {\n      // Load FSH files and configuration\n      const fshFiles = await this.loadFSHFiles(repository, branch, profile);\n      const configResult = await this.loadSushiConfig(repository, branch, profile);\n\n      if (fshFiles.length === 0) {\n        this.log('warn', 'No FSH files found to process');\n        return {\n          success: false,\n          message: 'No FSH files found to process',\n          files: [],\n          logs: this.logs\n        };\n      }\n\n      // Analyze FSH files\n      const analysis = this.analyzeFSHFiles(fshFiles);\n\n      this.compilationResults = {\n        files: fshFiles,\n        config: configResult.config,\n        analysis: analysis,\n        configSources: {\n          hasGithubVersion: configResult.hasGithubVersion,\n          hasStagingVersion: configResult.hasStagingVersion,\n          isUsingStaging: configResult.isUsingStaging\n        }\n      };\n      \n      this.log('info', 'FSH file loading and analysis completed');\n      this.notifyListeners();\n\n      return {\n        success: true,\n        result: {\n          files: fshFiles,\n          config: configResult.config,\n          configSources: configResult,\n          analysis: analysis,\n          message: 'FSH files loaded successfully. Full SUSHI compilation will be available in future releases.'\n        },\n        files: fshFiles,\n        logs: this.logs,\n        stats: this.getAnalysisStats(analysis)\n      };\n\n    } catch (error) {\n      this.log('error', `FSH processing failed: ${error.message}`);\n      this.notifyListeners();\n      \n      return {\n        success: false,\n        error: error.message,\n        logs: this.logs\n      };\n    }\n  }\n\n  /**\n   * Analyze FSH files to provide useful information\n   */\n  analyzeFSHFiles(fshFiles) {\n    const analysis = {\n      totalFiles: fshFiles.length,\n      githubFiles: fshFiles.filter(f => f.source === 'github').length,\n      stagingFiles: fshFiles.filter(f => f.source === 'staging').length,\n      overrides: [],\n      fileTypes: {},\n      totalLines: 0,\n      profiles: 0,\n      extensions: 0,\n      valueSets: 0,\n      codeSystems: 0,\n      instances: 0\n    };\n\n    fshFiles.forEach(file => {\n      // Count basic FSH constructs\n      const content = file.content;\n      analysis.totalLines += content.split('\\n').length;\n\n      // Basic FSH construct detection\n      if (content.includes('Profile:')) analysis.profiles++;\n      if (content.includes('Extension:')) analysis.extensions++;\n      if (content.includes('ValueSet:')) analysis.valueSets++;\n      if (content.includes('CodeSystem:')) analysis.codeSystems++;\n      if (content.includes('Instance:')) analysis.instances++;\n\n      // Track overrides\n      if (file.source === 'staging') {\n        analysis.overrides.push(file.path);\n      }\n\n      // File type analysis\n      const extension = file.path.split('.').pop();\n      analysis.fileTypes[extension] = (analysis.fileTypes[extension] || 0) + 1;\n    });\n\n    return analysis;\n  }\n\n  /**\n   * Get analysis statistics\n   */\n  getAnalysisStats(analysis) {\n    return {\n      files: analysis.totalFiles,\n      lines: analysis.totalLines,\n      sources: {\n        github: analysis.githubFiles,\n        staging: analysis.stagingFiles\n      },\n      constructs: {\n        profiles: analysis.profiles,\n        extensions: analysis.extensions,\n        valueSets: analysis.valueSets,\n        codeSystems: analysis.codeSystems,\n        instances: analysis.instances\n      },\n      overrides: analysis.overrides.length\n    };\n  }\n\n  /**\n   * Clear compilation logs\n   */\n  clearLogs() {\n    this.logs = [];\n  }\n\n  /**\n   * Add a log entry\n   */\n  log(level, message, location = null) {\n    const logEntry = {\n      level: level,\n      message: message,\n      location: location,\n      timestamp: new Date().toISOString()\n    };\n    \n    this.logs.push(logEntry);\n    console[level] && console[level](`[SUSHI] ${message}`);\n  }\n\n  /**\n   * Get all logs\n   */\n  getLogs() {\n    return this.logs;\n  }\n\n  /**\n   * Get logs filtered by level\n   */\n  getLogsByLevel(level) {\n    return this.logs.filter(log => log.level === level);\n  }\n\n  /**\n   * Search logs by content\n   */\n  searchLogs(searchTerm) {\n    return this.logs.filter(log => \n      log.message.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n  }\n\n  /**\n   * Export logs as text\n   */\n  exportLogsAsText() {\n    return this.logs.map(log => \n      `[${log.timestamp}] [${log.level.toUpperCase()}] ${log.message}${log.location ? ` (${log.location})` : ''}`\n    ).join('\\n');\n  }\n\n  /**\n   * Get compilation results\n   */\n  getCompilationResults() {\n    return this.compilationResults;\n  }\n\n  /**\n   * Add change listener\n   */\n  addListener(listener) {\n    this.listeners.add(listener);\n    return () => this.listeners.delete(listener);\n  }\n\n  /**\n   * Notify all listeners of changes\n   */\n  notifyListeners() {\n    this.listeners.forEach(listener => {\n      try {\n        listener({\n          logs: this.logs,\n          results: this.compilationResults,\n          stats: this.compilationResults ? this.getAnalysisStats(this.compilationResults.analysis) : null\n        });\n      } catch (error) {\n        console.error('Error notifying SUSHI service listener:', error);\n      }\n    });\n  }\n\n  /**\n   * Check if SUSHI is available and initialized\n   */\n  isInitialized() {\n    return this.initialized;\n  }\n\n  /**\n   * Validate FSH syntax (basic validation for now)\n   */\n  async validateFSH(fshContent) {\n    try {\n      // Basic FSH validation - check for common syntax patterns\n      const errors = [];\n      const warnings = [];\n      \n      const lines = fshContent.split('\\n');\n      for (let i = 0; i < lines.length; i++) {\n        const line = lines[i].trim();\n        \n        // Basic syntax checks\n        if (line.includes('Profile:') && !line.includes('=')) {\n          warnings.push(`Line ${i + 1}: Profile declaration might be missing metadata`);\n        }\n        \n        if (line.includes('*') && !line.includes('=') && !line.includes('//')) {\n          warnings.push(`Line ${i + 1}: Rule might be missing assignment`);\n        }\n      }\n      \n      return {\n        valid: errors.length === 0,\n        errors: errors,\n        warnings: warnings\n      };\n    } catch (error) {\n      return {\n        valid: false,\n        errors: [error.message],\n        warnings: []\n      };\n    }\n  }\n}\n\n// Export singleton instance\nconst sushiService = new SushiService();\nexport default sushiService;","import React, { useState, useEffect, useCallback } from 'react';\nimport { useParams, useLocation, useNavigate } from 'react-router-dom';\nimport sushiService from '../services/sushiService';\nimport githubService from '../services/githubService';\nimport './SushiRunner.css';\n\nconst SushiRunner = () => {\n  const { user, repo, branch } = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  \n  // State for repository and profile context\n  const [repository, setRepository] = useState(null);\n  const [selectedBranch, setSelectedBranch] = useState(branch || 'main');\n  const [profile, setProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [isRunning, setIsRunning] = useState(false);\n  const [results, setResults] = useState(null);\n  const [logs, setLogs] = useState([]);\n  const [logFilter, setLogFilter] = useState('all');\n  const [searchTerm, setSearchTerm] = useState('');\n  const [expandedFiles, setExpandedFiles] = useState(new Set());\n\n  // Initialize repository context from URL parameters or location state\n  useEffect(() => {\n    const initializeContext = async () => {\n      setLoading(true);\n      setError(null);\n\n      try {\n        // Get profile from localStorage or redirect to login\n        const storedProfile = localStorage.getItem('sgex-profile');\n        if (!storedProfile) {\n          navigate('/select_profile');\n          return;\n        }\n\n        const profileData = JSON.parse(storedProfile);\n        setProfile(profileData);\n\n        // If we have URL parameters, load repository\n        if (user && repo) {\n          const repositoryData = await githubService.getRepository(user, repo, profileData.token);\n          setRepository(repositoryData);\n          setSelectedBranch(branch || repositoryData.default_branch || 'main');\n        } else if (location.state?.repository) {\n          // Use repository from navigation state\n          setRepository(location.state.repository);\n          setSelectedBranch(location.state.selectedBranch || location.state.repository.default_branch || 'main');\n        } else {\n          setError('No repository context available. Please navigate from a DAK dashboard.');\n        }\n      } catch (err) {\n        console.error('Error initializing SUSHI runner context:', err);\n        setError(`Failed to load repository: ${err.message}`);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    initializeContext();\n  }, [user, repo, branch, location.state, navigate]);\n\n  // Listen to SUSHI service updates\n  useEffect(() => {\n    const unsubscribe = sushiService.addListener((update) => {\n      setLogs(update.logs || []);\n      setResults(update.results);\n    });\n\n    return unsubscribe;\n  }, []);\n\n  // Filter logs based on selected filter and search term\n  const filteredLogs = logs.filter(log => {\n    const levelMatch = logFilter === 'all' || log.level === logFilter;\n    const searchMatch = searchTerm === '' || \n      log.message.toLowerCase().includes(searchTerm.toLowerCase());\n    return levelMatch && searchMatch;\n  });\n\n  // Run SUSHI compilation\n  const runCompilation = useCallback(async () => {\n    if (!repository || !selectedBranch || !profile) {\n      alert('Missing required parameters for SUSHI compilation');\n      return;\n    }\n\n    setIsRunning(true);\n    setResults(null);\n    setLogs([]);\n\n    try {\n      const result = await sushiService.runSUSHI(repository, selectedBranch, profile, {\n        logLevel: 'info'\n      });\n      \n      setResults(result);\n    } catch (error) {\n      console.error('SUSHI compilation error:', error);\n      setResults({\n        success: false,\n        error: error.message,\n        logs: sushiService.getLogs()\n      });\n    } finally {\n      setIsRunning(false);\n    }\n  }, [repository, selectedBranch, profile]);\n\n  // Copy logs to clipboard\n  const copyLogsToClipboard = () => {\n    const logText = sushiService.exportLogsAsText();\n    navigator.clipboard.writeText(logText).then(() => {\n      alert('Logs copied to clipboard');\n    }).catch(err => {\n      console.error('Failed to copy logs:', err);\n    });\n  };\n\n  // Copy single log entry to clipboard\n  const copyLogEntry = (log) => {\n    const logText = `[${log.timestamp}] [${log.level.toUpperCase()}] ${log.message}${log.location ? ` (${log.location})` : ''}`;\n    navigator.clipboard.writeText(logText).then(() => {\n      // Visual feedback could be added here\n    }).catch(err => {\n      console.error('Failed to copy log entry:', err);\n    });\n  };\n\n  // Toggle file expansion in results\n  const toggleFileExpansion = (fileName) => {\n    const newExpanded = new Set(expandedFiles);\n    if (newExpanded.has(fileName)) {\n      newExpanded.delete(fileName);\n    } else {\n      newExpanded.add(fileName);\n    }\n    setExpandedFiles(newExpanded);\n  };\n\n  // Navigate back to dashboard\n  const goBackToDashboard = () => {\n    if (user && repo && selectedBranch) {\n      navigate(`/dashboard/${user}/${repo}/${selectedBranch}`);\n    } else {\n      navigate('/dashboard');\n    }\n  };\n\n  // Get log level counts for badges\n  const logCounts = {\n    error: logs.filter(l => l.level === 'error').length,\n    warn: logs.filter(l => l.level === 'warn').length,\n    info: logs.filter(l => l.level === 'info').length,\n    debug: logs.filter(l => l.level === 'debug').length\n  };\n\n  if (loading) {\n    return (\n      <div className=\"sushi-runner\">\n        <div className=\"sushi-runner-header\">\n          <h2>FSH File Manager & Analyzer</h2>\n        </div>\n        <div className=\"loading-container\">\n          <div className=\"loading-spinner\"></div>\n          <p>Loading repository context...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"sushi-runner\">\n        <div className=\"sushi-runner-header\">\n          <h2>FSH File Manager & Analyzer</h2>\n          <button onClick={goBackToDashboard} className=\"close-button\">\n            Back to Dashboard\n          </button>\n        </div>\n        <div className=\"error-container\">\n          <h3>Error</h3>\n          <p>{error}</p>\n          <button onClick={goBackToDashboard} className=\"back-button\">\n            Go to Dashboard\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"sushi-runner\">\n      <div className=\"sushi-runner-header\">\n        <h2>FSH File Manager & Analyzer</h2>\n        <div className=\"sushi-runner-controls\">\n          <button \n            onClick={runCompilation} \n            disabled={isRunning}\n            className=\"run-button\"\n          >\n            {isRunning ? 'Loading...' : 'Load & Analyze FSH Files'}\n          </button>\n          <button onClick={goBackToDashboard} className=\"close-button\">\n            Back to Dashboard\n          </button>\n        </div>\n      </div>\n\n      <div className=\"sushi-runner-content\">\n        {/* Repository Information */}\n        <div className=\"repository-info\">\n          <h3>Repository: {repository?.full_name} ({selectedBranch})</h3>\n          <p>This will load and analyze all FSH files from the repository and staging ground. Staging ground files will override repository files with the same path. Full SUSHI compilation will be available in future releases.</p>\n        </div>\n\n        {/* Analysis Results Summary */}\n        {results && (\n          <div className={`results-summary ${results.success ? 'success' : 'error'}`}>\n            <h3>Analysis Results</h3>\n            <p>\n              Status: <strong>{results.success ? 'Success' : 'Failed'}</strong>\n            </p>\n            {results.files && (\n              <p>FSH Files Processed: {results.files.length}</p>\n            )}\n            {results.error && (\n              <p className=\"error-message\">Error: {results.error}</p>\n            )}\n            {results.stats && (\n              <div className=\"compilation-stats\">\n                <p>Analysis Statistics:</p>\n                <pre>{JSON.stringify(results.stats, null, 2)}</pre>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Logs Section */}\n        <div className=\"logs-section\">\n          <div className=\"logs-header\">\n            <h3>Processing Logs</h3>\n            <div className=\"logs-controls\">\n              <select \n                value={logFilter} \n                onChange={(e) => setLogFilter(e.target.value)}\n                className=\"log-filter\"\n              >\n                <option value=\"all\">All Logs ({logs.length})</option>\n                <option value=\"error\">Errors ({logCounts.error})</option>\n                <option value=\"warn\">Warnings ({logCounts.warn})</option>\n                <option value=\"info\">Info ({logCounts.info})</option>\n                <option value=\"debug\">Debug ({logCounts.debug})</option>\n              </select>\n              <input\n                type=\"text\"\n                placeholder=\"Search logs...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"log-search\"\n              />\n              <button onClick={copyLogsToClipboard} className=\"copy-logs-button\">\n                Copy All Logs\n              </button>\n            </div>\n          </div>\n\n          <div className=\"logs-container\">\n            {filteredLogs.length === 0 ? (\n              <p className=\"no-logs\">No logs to display</p>\n            ) : (\n              filteredLogs.map((log, index) => (\n                <div \n                  key={index} \n                  className={`log-entry log-${log.level}`}\n                  onClick={() => copyLogEntry(log)}\n                  title=\"Click to copy to clipboard\"\n                >\n                  <span className=\"log-timestamp\">{new Date(log.timestamp).toLocaleTimeString()}</span>\n                  <span className={`log-level level-${log.level}`}>{log.level.toUpperCase()}</span>\n                  <span className=\"log-message\">{log.message}</span>\n                  {log.location && (\n                    <span className=\"log-location\">({log.location})</span>\n                  )}\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n\n        {/* Processed Files */}\n        {results && results.files && (\n          <div className=\"processed-files\">\n            <h3>Processed FSH Files ({results.files.length})</h3>\n            <div className=\"files-list\">\n              {results.files.map((file, index) => (\n                <div key={index} className=\"file-item\">\n                  <div \n                    className=\"file-header\" \n                    onClick={() => toggleFileExpansion(file.path)}\n                  >\n                    <span className=\"file-path\">{file.path}</span>\n                    <span className={`file-source source-${file.source}`}>\n                      {file.source}\n                    </span>\n                    <span className=\"expand-icon\">\n                      {expandedFiles.has(file.path) ? '▼' : '▶'}\n                    </span>\n                  </div>\n                  {expandedFiles.has(file.path) && (\n                    <div className=\"file-content\">\n                      <pre>{file.content}</pre>\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Analysis Output */}\n        {results && results.result && (\n          <div className=\"fhir-output\">\n            <h3>FSH Analysis Results</h3>\n            <div className=\"fhir-resources\">\n              <pre>{JSON.stringify(results.result, null, 2)}</pre>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default SushiRunner;"],"names":["constructor","this","initialized","compilationResults","logs","listeners","Set","loadFSHFiles","repository","branch","profile","log","concat","full_name","githubFiles","loadGitHubFSHFiles","length","stagingFiles","loadStagingGroundFSHFiles","mergedFiles","mergeFSHFiles","error","message","fshFiles","fshDirectories","directory","files","githubService","getRepositoryContents","owner","login","name","token","Array","isArray","file","type","endsWith","content","getFileContent","path","push","source","size","rootFiles","stagingGround","stagingGroundService","getStagingGround","split","pop","metadata","timestamp","stagingFile","existingIndex","findIndex","f","loadSushiConfig","githubConfig","stagingConfig","configContent","yaml","id","stagingConfigFile","getStagingFiles","find","config","Error","hasGithubVersion","hasStagingVersion","isUsingStaging","saveSushiConfigToStaging","yamlContent","indent","lineWidth","quotingType","saveFile","validateSushiConfig","errors","warnings","test","version","fhirVersion","includes","publisher","url","email","dependencies","valid","loadPagesWithSources","pages","pageKey","pageValue","Object","entries","page","_objectSpread","key","sources","github","staging","sourceFileName","runSUSHI","clearLogs","configResult","success","analysis","analyzeFSHFiles","configSources","notifyListeners","result","stats","getAnalysisStats","totalFiles","filter","overrides","fileTypes","totalLines","profiles","extensions","valueSets","codeSystems","instances","forEach","extension","lines","constructs","level","logEntry","location","arguments","undefined","Date","toISOString","console","getLogs","getLogsByLevel","searchLogs","searchTerm","toLowerCase","exportLogsAsText","map","toUpperCase","join","getCompilationResults","addListener","listener","add","delete","results","isInitialized","validateFSH","fshContent","i","line","trim","SushiRunner","user","repo","useParams","useLocation","navigate","useNavigate","setRepository","useState","selectedBranch","setSelectedBranch","setProfile","loading","setLoading","setError","isRunning","setIsRunning","setResults","setLogs","logFilter","setLogFilter","setSearchTerm","expandedFiles","setExpandedFiles","useEffect","async","_location$state","storedProfile","localStorage","getItem","profileData","JSON","parse","repositoryData","getRepository","default_branch","state","err","initializeContext","sushiService","update","filteredLogs","levelMatch","searchMatch","runCompilation","useCallback","logLevel","alert","goBackToDashboard","logCounts","l","warn","info","debug","_jsxs","className","children","_jsx","onClick","disabled","stringify","value","onChange","e","target","placeholder","copyLogsToClipboard","logText","navigator","clipboard","writeText","then","catch","index","copyLogEntry","title","toLocaleTimeString","fileName","newExpanded","has","toggleFileExpansion"],"sourceRoot":""}