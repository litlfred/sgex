"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[5207],{25207:(e,s,i)=>{i.r(s),i.d(s,{default:()=>h});var o=i(65043),a=i(29001),n=i(93071),r=i(65240),t=i(79359),c=i(26368),l=i(98714),d=i(70579);const h=()=>{var e;const s=(0,a.zy)(),i=(0,a.Zp)(),{user:h}=(0,a.g)(),[p,u]=(0,o.useState)([]),[m,g]=(0,o.useState)(!0),[x,j]=(0,o.useState)(null),[N,v]=(0,o.useState)(!1),[f,y]=(0,o.useState)(null),[A,b]=(0,o.useState)(null===(e=s.state)||void 0===e?void 0:e.profile);(0,o.useEffect)(()=>{t.A.registerModalCallback(e=>{y(e),v(!0)}),(async()=>{if(h&&!A)try{if(n.A.isAuth()){const e=await n.A.getUser(h);b(e)}else b({login:h,name:h.charAt(0).toUpperCase()+h.slice(1),avatar_url:"https://github.com/".concat(h,".png"),type:"User"})}catch(x){console.error("Error fetching user profile:",x),i("/",{state:{warningMessage:"User '".concat(h,"' not found or not accessible.")}})}})()},[h,A,i]);const k=(0,o.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g(!0),j(null);try{const i=A.type;if(!e){let e=null;try{e=r.A.getCachedRepositories(A.login,i)}catch(s){console.warn("Error accessing repository cache:",s)}if(e)return console.log("Using cached repositories for ".concat(A.login," (").concat(i,")")),u(e.repositories),void g(!1)}console.log("Fetching fresh repositories for ".concat(A.login," (").concat(i,")"));const o=await n.A.getRepositories(A.login,i);try{r.A.setCachedRepositories(A.login,i,o)}catch(s){console.warn("Error caching repositories:",s)}u(o)}catch(x){console.error("Error fetching repositories:",x),j("Failed to fetch repositories. Please check your connection and try again.")}finally{g(!1)}},[A]);(0,o.useEffect)(()=>{A||h?A&&k():i("/")},[A,h,i,k]);return(0,d.jsxs)(l.Mx,{pageName:"repository-selection",children:[A?(0,d.jsx)("div",{className:"repo-content",children:(0,d.jsx)("div",{className:"repo-main",children:(0,d.jsxs)("div",{className:"repo-selection",children:[(0,d.jsx)("h2",{children:"Select DAK Repository"}),(0,d.jsx)("p",{children:"Choose a repository containing WHO SMART Guidelines Digital Adaptation Kit content:"}),m?(0,d.jsxs)("div",{className:"loading",children:[(0,d.jsx)("div",{className:"spinner"}),(0,d.jsx)("p",{children:"Loading repositories..."})]}):x?(0,d.jsxs)("div",{className:"error-state",children:[(0,d.jsx)("h3",{children:"Error loading repositories"}),(0,d.jsx)("p",{children:x}),(0,d.jsx)("button",{onClick:()=>k(!0),className:"retry-btn",children:"Try Again"})]}):0===p.length?(0,d.jsxs)("div",{className:"empty-state",children:[(0,d.jsx)("h3",{children:"No DAK repositories found"}),(0,d.jsx)("p",{children:"No repositories found with DAK-related topics or keywords. Create a new repository or add topics like 'who', 'smart-guidelines', 'dak', or 'health' to existing repositories."})]}):(0,d.jsx)("div",{className:"repo-grid",children:p.map(e=>{return(0,d.jsxs)("div",{className:"repo-card",onClick:()=>(e=>{i("/dashboard/".concat(e.owner.login,"/").concat(e.name),{state:{profile:A,repository:e}})})(e),children:[(0,d.jsxs)("div",{className:"repo-header-info",children:[(0,d.jsx)("h3",{children:e.name}),(0,d.jsxs)("div",{className:"repo-meta",children:[e.private&&(0,d.jsx)("span",{className:"private-badge",children:"Private"}),e.language&&(0,d.jsx)("span",{className:"language-badge",children:e.language})]})]}),(0,d.jsx)("p",{className:"repo-description",children:e.description||"No description available"}),(0,d.jsxs)("div",{className:"repo-topics",children:[(e.topics||[]).slice(0,3).map(e=>(0,d.jsx)("span",{className:"topic-tag",children:e},e)),(e.topics||[]).length>3&&(0,d.jsxs)("span",{className:"topic-more",children:["+",(e.topics||[]).length-3," more"]})]}),(0,d.jsxs)("div",{className:"repo-stats",children:[(0,d.jsxs)("div",{className:"stat",children:[(0,d.jsx)("span",{className:"stat-icon",children:"\u2b50"}),(0,d.jsx)("span",{children:e.stargazers_count||0})]}),(0,d.jsxs)("div",{className:"stat",children:[(0,d.jsx)("span",{className:"stat-icon",children:"\ud83c\udf74"}),(0,d.jsx)("span",{children:e.forks_count||0})]}),(0,d.jsxs)("div",{className:"stat",children:[(0,d.jsx)("span",{className:"stat-icon",children:"\ud83d\udcc5"}),(0,d.jsxs)("span",{children:["Updated ",(s=e.updated_at,new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]})]})]})]},e.id);var s})})]})})}):(0,d.jsx)("div",{children:"Redirecting..."}),(0,d.jsx)(c.A,{isOpen:N,onClose:()=>{v(!1),y(null)},samlInfo:f})]})}},26368:(e,s,i)=>{i.d(s,{A:()=>r});var o=i(65043),a=i(5452),n=i(70579);const r=e=>{let{isOpen:s,onClose:i,samlInfo:r}=e;const t=a.A.getLogger("SAMLAuthModal");if((0,o.useEffect)(()=>(s&&r&&t.componentMount({organization:r.organization,repository:r.repository}),()=>{s&&t.componentUnmount()}),[t,s,r]),!s||!r)return null;const{organization:c,repository:l,authorizationUrl:d}=r,h=()=>{t.userAction("SAML modal closed",{organization:c}),i()};return(0,n.jsx)("div",{className:"saml-modal-overlay",onClick:h,role:"dialog","aria-modal":"true","aria-labelledby":"saml-modal-title",children:(0,n.jsxs)("div",{className:"saml-modal",onClick:e=>e.stopPropagation(),role:"document",children:[(0,n.jsxs)("div",{className:"saml-modal-header",children:[(0,n.jsx)("h2",{id:"saml-modal-title",children:"\ud83d\udd10 SAML SSO Authorization Required"}),(0,n.jsx)("button",{onClick:h,className:"close-button","aria-label":"Close",children:"\xd7"})]}),(0,n.jsxs)("div",{className:"saml-modal-content",children:[(0,n.jsxs)("div",{className:"saml-info-section",children:[(0,n.jsx)("div",{className:"saml-icon",children:(0,n.jsx)("span",{role:"img","aria-label":"lock",children:"\ud83d\udd12"})}),(0,n.jsx)("h3",{children:"Organization Access Required"}),(0,n.jsxs)("p",{className:"saml-description",children:["Your Personal Access Token needs SAML SSO authorization to access the"," ",(0,n.jsx)("strong",{children:c})," organization",l?" and the ".concat(l," repository"):"","."]})]}),(0,n.jsxs)("div",{className:"saml-steps-section",children:[(0,n.jsx)("h4",{children:"How to authorize your token:"}),(0,n.jsxs)("ol",{className:"saml-steps",children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:'Click "Authorize on GitHub"'})," below to open the authorization page"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Review the permissions"})," requested by the organization"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:'Click "Authorize"'})," to grant your token access"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{children:"Return to this page"})," and refresh or try your action again"]})]})]}),(0,n.jsxs)("div",{className:"saml-note",children:[(0,n.jsx)("span",{className:"note-icon",children:"\u2139\ufe0f"}),(0,n.jsx)("p",{children:"This is a GitHub security feature for organizations using SAML SSO. You only need to authorize once per organization per token."})]}),(0,n.jsxs)("div",{className:"saml-modal-actions",children:[(0,n.jsx)("button",{onClick:()=>{t.userAction("Authorize SAML clicked",{organization:c,authorizationUrl:d}),window.open(d,"_blank","noopener,noreferrer"),t.info("SAML authorization page opened",{organization:c,instruction:"User should authorize their PAT on GitHub and then refresh"})},className:"saml-authorize-btn",children:"\ud83d\udd13 Authorize on GitHub"}),(0,n.jsx)("button",{onClick:h,className:"saml-cancel-btn",children:"Later"})]})]})]})})}}}]);
//# sourceMappingURL=5207.4768a17b.chunk.js.map