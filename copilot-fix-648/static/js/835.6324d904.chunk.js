"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[835],{13333:(e,i,n)=>{n.d(i,{hX:()=>s});var a=n(85909);const s=function(e,i,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i&&"string"===typeof i)if(!i.includes("://")||(0,a.h3)(i))if((e=>!!(null!==e&&void 0!==e&&e.ctrlKey||null!==e&&void 0!==e&&e.metaKey))(e)){const e=(e=>{if(!e||"string"!==typeof e)return window.location.origin;if(e.includes("javascript:")||e.includes("data:"))return console.warn("Blocked dangerous URL scheme in path:",e),window.location.origin;const i="/sgex/copilot-fix-648",n=window.location.origin,a=e.startsWith("/")?e.slice(1):e;return i?`${n}${i.endsWith("/")?i:i+"/"}${a}`:`${n}/${a}`})(i);window.open(e,"_blank","noopener,noreferrer")}else s?n(i,{state:s}):n(i);else console.warn("Blocked navigation to potentially dangerous URL:",i);else console.warn("Invalid navigation path provided")}},45835:(e,i,n)=>{n.r(i),n.d(i,{default:()=>g});var a=n(65043),s=n(29615),o=n(74117),t=n(93071),l=n(65240),r=n(76712),c=n(13333),d=n(70579);const g=()=>{const{t:e}=(0,o.Bd)(),[i,n]=(0,a.useState)(null),[g,h]=(0,a.useState)([]),[u,p]=(0,a.useState)(!1),[m,f]=(0,a.useState)(!1),[v,x]=(0,a.useState)(null),[j,w]=(0,a.useState)({}),[k,b]=(0,a.useState)(null),N=(0,s.Zp)(),z=(0,s.zy)(),y=(0,a.useCallback)((e,i)=>{if(!t.A.isAuth())return;const n={};if(e){const i=l.A.getCachedRepositories(e.login,"user");i&&i.repositories&&(n[`user-${e.login}`]=i.repositories.length)}i.forEach(e=>{const i=l.A.getCachedRepositories(e.login,"org");i&&i.repositories&&(n[`org-${e.login}`]=i.repositories.length)}),w(n)},[]),O=(0,a.useCallback)(async()=>{f(!0),x(null);try{await t.A.checkTokenPermissions();const i=await t.A.getCurrentUser();n(i);let a=[];if(t.A.isAuth())try{a=await t.A.getUserOrganizations()}catch(v){console.error("Error fetching organizations:",v),a=[]}try{const e=await t.A.getWHOOrganization(),i=a.findIndex(e=>"WorldHealthOrganization"===e.login);i>=0?a[i]={...a[i],...e,isWHO:!0}:a.unshift(e)}catch(e){console.warn("Could not fetch WHO organization data, using fallback:",e);const i={id:"who-organization",login:"WorldHealthOrganization",name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",isWHO:!0};a.some(e=>"WorldHealthOrganization"===e.login)?a=a.map(e=>"WorldHealthOrganization"===e.login?{...e,isWHO:!0}:e):a.unshift(i)}h(a),y(i,a)}catch(v){console.error("Error fetching user data:",v),x("Failed to fetch user data. Please check your connection and try again."),p(!1),sessionStorage.removeItem("github_token"),localStorage.removeItem("github_token")}finally{f(!1)}},[y]);(0,a.useEffect)(()=>{(()=>{const e=sessionStorage.getItem("github_token")||localStorage.getItem("github_token");if(e){t.A.authenticate(e)?p(!0):(sessionStorage.removeItem("github_token"),localStorage.removeItem("github_token"),N("/",{replace:!0}))}else N("/",{replace:!0})})()},[N]),(0,a.useEffect)(()=>{var e;null!==(e=z.state)&&void 0!==e&&e.warningMessage&&(b(z.state.warningMessage),N(z.pathname,{replace:!0,state:{}}))},[z.state,N,z.pathname]),(0,a.useEffect)(()=>{u&&!i&&O()},[u,i,O]);const W=(e,i)=>{const n={profile:i};(0,c.hX)(e,`/dak-action/${i.login}`,N,n)};return u?(0,d.jsx)(r.Mx,{pageName:"select-profile",children:(0,d.jsxs)("div",{className:"select-profile-content",children:[k&&(0,d.jsx)("div",{className:"warning-message",children:(0,d.jsxs)("div",{className:"warning-content",children:[(0,d.jsxs)("div",{className:"warning-header",children:[(0,d.jsx)("span",{className:"warning-icon",children:"\u26a0\ufe0f"}),(0,d.jsx)("span",{className:"warning-text",children:k})]}),(0,d.jsx)("button",{className:"warning-dismiss",onClick:()=>{b(null)},"aria-label":"Dismiss warning",children:"\xd7 Dismiss"})]})}),m?(0,d.jsxs)("div",{className:"loading-section",children:[(0,d.jsx)("div",{className:"spinner"}),(0,d.jsx)("p",{children:"Loading profile data..."})]}):(0,d.jsxs)("div",{className:"profile-selection",children:[(0,d.jsx)("h2",{children:e("organization.select")}),(0,d.jsxs)("p",{children:[e("organization.personal"),":"]}),v&&(0,d.jsx)("div",{className:"error-message",children:v}),(0,d.jsxs)("div",{className:"profile-grid-horizontal",children:[(0,d.jsxs)("div",{className:"profile-card",onClick:e=>W(e,{type:"user",...i}),children:[(0,d.jsxs)("div",{className:"profile-card-header",children:[(0,d.jsx)("img",{src:null===i||void 0===i?void 0:i.avatar_url,alt:"Personal profile"}),j[`user-${null===i||void 0===i?void 0:i.login}`]>0&&(0,d.jsx)("div",{className:"dak-count-badge",children:j[`user-${null===i||void 0===i?void 0:i.login}`]})]}),(0,d.jsx)("h3",{children:(null===i||void 0===i?void 0:i.name)||(null===i||void 0===i?void 0:i.login)}),(0,d.jsx)("p",{children:"Personal repositories"}),(0,d.jsx)("div",{className:"profile-badges",children:(0,d.jsx)("span",{className:"profile-type",children:"Personal"})})]}),g.map(i=>(0,d.jsxs)("div",{className:"profile-card "+(i.isWHO?"who-org":""),onClick:e=>W(e,{type:"org",...i}),children:[(0,d.jsxs)("div",{className:"profile-card-header",children:[(0,d.jsx)("img",{src:i.avatar_url||`https://github.com/${i.login}.png`,alt:`${i.name||i.login} organization`}),j[`org-${i.login}`]>0&&(0,d.jsx)("div",{className:"dak-count-badge",children:j[`org-${i.login}`]})]}),(0,d.jsx)("h3",{children:i.name||i.login}),(0,d.jsxs)("p",{children:["@",i.login]}),(0,d.jsxs)("div",{className:"profile-badges",children:[(0,d.jsx)("span",{className:"profile-type",children:e("organization.organizations")}),i.isWHO&&(0,d.jsx)("span",{className:"who-badge",children:"WHO Official"})]})]},i.login))]})]})]})}):null}}}]);
//# sourceMappingURL=835.6324d904.chunk.js.map