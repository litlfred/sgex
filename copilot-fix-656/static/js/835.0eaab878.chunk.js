"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[835],{13333:(e,a,n)=>{n.d(a,{hX:()=>i});const i=function(e,a,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((e=>!!(null!==e&&void 0!==e&&e.ctrlKey||null!==e&&void 0!==e&&e.metaKey))(e)){const e=(e=>{const a="/sgex/copilot-fix-656",n=window.location.origin,i=e.startsWith("/")?e.slice(1):e;if(!a)return"".concat(n,"/").concat(i);const s=a.endsWith("/")?a:a+"/";return"".concat(n).concat(s).concat(i)})(a);window.open(e,"_blank","noopener,noreferrer")}else i?n(a,{state:i}):n(a)}},45835:(e,a,n)=>{n.r(a),n.d(a,{default:()=>h});var i=n(89379),s=n(65043),o=n(73537),t=n(74117),l=n(93071),r=n(65240),c=n(76712),d=n(13333),g=n(70579);const h=()=>{const{t:e}=(0,t.Bd)(),[a,n]=(0,s.useState)(null),[h,u]=(0,s.useState)([]),[p,m]=(0,s.useState)(!1),[f,v]=(0,s.useState)(!1),[x,j]=(0,s.useState)(null),[b,k]=(0,s.useState)({}),[w,N]=(0,s.useState)(null),z=(0,o.Zp)(),O=(0,o.zy)(),A=(0,s.useCallback)((e,a)=>{if(!l.A.isAuth())return;const n={};if(e){const a=r.A.getCachedRepositories(e.login,"user");a&&a.repositories&&(n["user-".concat(e.login)]=a.repositories.length)}a.forEach(e=>{const a=r.A.getCachedRepositories(e.login,"org");a&&a.repositories&&(n["org-".concat(e.login)]=a.repositories.length)}),k(n)},[]),W=(0,s.useCallback)(async()=>{v(!0),j(null);try{await l.A.checkTokenPermissions();const a=await l.A.getCurrentUser();n(a);let s=[];if(l.A.isAuth())try{s=await l.A.getUserOrganizations()}catch(x){console.error("Error fetching organizations:",x),s=[]}try{const e=await l.A.getWHOOrganization(),a=s.findIndex(e=>"WorldHealthOrganization"===e.login);a>=0?s[a]=(0,i.A)((0,i.A)((0,i.A)({},s[a]),e),{},{isWHO:!0}):s.unshift(e)}catch(e){console.warn("Could not fetch WHO organization data, using fallback:",e);const a={id:"who-organization",login:"WorldHealthOrganization",name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",isWHO:!0};s.some(e=>"WorldHealthOrganization"===e.login)?s=s.map(e=>"WorldHealthOrganization"===e.login?(0,i.A)((0,i.A)({},e),{},{isWHO:!0}):e):s.unshift(a)}u(s),A(a,s)}catch(x){console.error("Error fetching user data:",x),j("Failed to fetch user data. Please check your connection and try again."),m(!1),sessionStorage.removeItem("github_token"),localStorage.removeItem("github_token")}finally{v(!1)}},[A]);(0,s.useEffect)(()=>{(()=>{const e=sessionStorage.getItem("github_token")||localStorage.getItem("github_token");if(e){l.A.authenticate(e)?m(!0):(sessionStorage.removeItem("github_token"),localStorage.removeItem("github_token"),z("/",{replace:!0}))}else z("/",{replace:!0})})()},[z]),(0,s.useEffect)(()=>{var e;null!==(e=O.state)&&void 0!==e&&e.warningMessage&&(N(O.state.warningMessage),z(O.pathname,{replace:!0,state:{}}))},[O.state,z,O.pathname]),(0,s.useEffect)(()=>{p&&!a&&W()},[p,a,W]);const y=(e,a)=>{const n={profile:a};(0,d.hX)(e,"/dak-action/".concat(a.login),z,n)};return p?(0,g.jsx)(c.Mx,{pageName:"select-profile",children:(0,g.jsxs)("div",{className:"select-profile-content",children:[w&&(0,g.jsx)("div",{className:"warning-message",children:(0,g.jsxs)("div",{className:"warning-content",children:[(0,g.jsxs)("div",{className:"warning-header",children:[(0,g.jsx)("span",{className:"warning-icon",children:"\u26a0\ufe0f"}),(0,g.jsx)("span",{className:"warning-text",children:w})]}),(0,g.jsx)("button",{className:"warning-dismiss",onClick:()=>{N(null)},"aria-label":"Dismiss warning",children:"\xd7 Dismiss"})]})}),f?(0,g.jsxs)("div",{className:"loading-section",children:[(0,g.jsx)("div",{className:"spinner"}),(0,g.jsx)("p",{children:"Loading profile data..."})]}):(0,g.jsxs)("div",{className:"profile-selection",children:[(0,g.jsx)("h2",{children:e("organization.select")}),(0,g.jsxs)("p",{children:[e("organization.personal"),":"]}),x&&(0,g.jsx)("div",{className:"error-message",children:x}),(0,g.jsxs)("div",{className:"profile-grid-horizontal",children:[(0,g.jsxs)("div",{className:"profile-card",onClick:e=>y(e,(0,i.A)({type:"user"},a)),children:[(0,g.jsxs)("div",{className:"profile-card-header",children:[(0,g.jsx)("img",{src:null===a||void 0===a?void 0:a.avatar_url,alt:"Personal profile"}),b["user-".concat(null===a||void 0===a?void 0:a.login)]>0&&(0,g.jsx)("div",{className:"dak-count-badge",children:b["user-".concat(null===a||void 0===a?void 0:a.login)]})]}),(0,g.jsx)("h3",{children:(null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.login)}),(0,g.jsx)("p",{children:"Personal repositories"}),(0,g.jsx)("div",{className:"profile-badges",children:(0,g.jsx)("span",{className:"profile-type",children:"Personal"})})]}),h.map(a=>(0,g.jsxs)("div",{className:"profile-card ".concat(a.isWHO?"who-org":""),onClick:e=>y(e,(0,i.A)({type:"org"},a)),children:[(0,g.jsxs)("div",{className:"profile-card-header",children:[(0,g.jsx)("img",{src:a.avatar_url||"https://github.com/".concat(a.login,".png"),alt:"".concat(a.name||a.login," organization")}),b["org-".concat(a.login)]>0&&(0,g.jsx)("div",{className:"dak-count-badge",children:b["org-".concat(a.login)]})]}),(0,g.jsx)("h3",{children:a.name||a.login}),(0,g.jsxs)("p",{children:["@",a.login]}),(0,g.jsxs)("div",{className:"profile-badges",children:[(0,g.jsx)("span",{className:"profile-type",children:e("organization.organizations")}),a.isWHO&&(0,g.jsx)("span",{className:"who-badge",children:"WHO Official"})]})]},a.login))]})]})]})}):null}}}]);
//# sourceMappingURL=835.0eaab878.chunk.js.map