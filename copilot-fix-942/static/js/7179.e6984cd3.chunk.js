"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[7179],{70451:()=>{},97179:(e,s,a)=>{a.r(s),a.d(s,{default:()=>d});var t=a(9950),n=a(85001),c=a(67818),i=a(90584),l=a(29166),r=a(38659),o=(a(70451),a(44414));const d=()=>{const{t:e}=(0,c.Bd)(),[s,a]=((0,n.g)(),(0,n.zy)(),(0,t.useState)([])),[d,h]=(0,t.useState)(new Set),[m,p]=(0,t.useState)([]),[u,x]=(0,t.useState)([]),[j,v]=(0,t.useState)(!0),[g,f]=(0,t.useState)(null),[N,y]=(0,t.useState)(""),[S,w]=(0,t.useState)(null),[C,b]=(0,t.useState)({}),[M,I]=(0,t.useState)(null),[P,T]=(0,t.useState)(null),k=(0,t.useMemo)(()=>"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,[]);(0,t.useEffect)(()=>{(async()=>{try{const[e,s]=await Promise.all([(0,r.ph)(),(0,r.Vq)()]);I(()=>e),T(s)}catch(e){console.warn("Failed to load syntax highlighting:",e)}})()},[]),(0,t.useEffect)(()=>{(async()=>{if(!k)return f("MCP Inspector is only available in local development environment."),void v(!1);try{v(!0);const e=await q();a(e),h(new Set(e.map(e=>e.id)));const s=await Promise.allSettled(e.map(async e=>{try{const s=await fetch("".concat(e.baseUrl,"/health"));return{serviceId:e.id,healthy:s.ok,status:s.status,timestamp:(new Date).toISOString()}}catch(s){return{serviceId:e.id,healthy:!1,error:s.message,timestamp:(new Date).toISOString()}}})),t={};s.forEach((s,a)=>{var n;"fulfilled"===s.status?t[e[a].id]=s.value:t[e[a].id]={serviceId:e[a].id,healthy:!1,error:(null===(n=s.reason)||void 0===n?void 0:n.message)||"Health check failed",timestamp:(new Date).toISOString()}}),b(t)}catch(e){f("Failed to discover MCP services: ".concat(e.message))}finally{v(!1)}})()},[k]),(0,t.useEffect)(()=>{if(!k||0===s.length)return;const e=async()=>{try{const e=E(s);p(e)}catch(e){console.warn("Failed to fetch traffic logs:",e)}};e();const a=setInterval(e,5e3);return()=>clearInterval(a)},[k,s]),(0,t.useEffect)(()=>{let e=m.filter(e=>d.has(e.serviceId));if(N.trim()){const s=N.toLowerCase();e=e.filter(e=>e.method.toLowerCase().includes(s)||e.url.toLowerCase().includes(s)||e.status.toString().includes(s)||JSON.stringify(e.request).toLowerCase().includes(s)||JSON.stringify(e.response).toLowerCase().includes(s))}e.sort((e,s)=>new Date(s.timestamp)-new Date(e.timestamp)),x(e)},[m,d,N]);const q=async()=>{try{const e=await fetch("http://127.0.0.1:3001/mcp/services");if(e.ok){return(await e.json()).services||[]}}catch(e){console.warn("Failed to fetch from service registry:",e)}return[{id:"dak-faq",name:"DAK FAQ MCP Service",description:"WHO SMART Guidelines DAK FAQ functionality",functionality:"dak-faq",baseUrl:"http://127.0.0.1:3001/mcp",version:"1.0.0",endpoints:["GET /health","GET /faq/questions/catalog","POST /faq/questions/execute","GET /faq/schemas","GET /faq/openapi"]}]},E=e=>{const s=[],a=Date.now();return e.forEach(e=>{for(let t=0;t<5;t++)s.push({id:"".concat(e.id,"-").concat(t,"-").concat(a),serviceId:e.id,serviceName:e.name,timestamp:new Date(a-3e4*t).toISOString(),method:["GET","POST"][Math.floor(2*Math.random())],url:e.endpoints[Math.floor(Math.random()*e.endpoints.length)],status:[200,201,400,404,500][Math.floor(5*Math.random())],responseTime:Math.floor(1e3*Math.random())+50,request:{headers:{"Content-Type":"application/json"},body:{questionId:"sample-question",parameters:{}}},response:{headers:{"Content-Type":"application/json"},body:{status:"success",data:{result:"Sample response"}}}})}),s},D=(0,t.useMemo)(()=>{const e={};return s.forEach(s=>{const a=s.functionality||"other";e[a]||(e[a]=[]),e[a].push(s)}),e},[s]);return g?(0,o.jsxs)(i.Mx,{children:[(0,o.jsx)(i.zY,{title:"MCP Inspector",breadcrumbItems:[{label:"Home",path:"/"},{label:"MCP Inspector",path:"/mcp-inspector",current:!0}]}),(0,o.jsx)("div",{className:"sgex-error-container mcp-inspector-error",children:(0,o.jsxs)("div",{className:"sgex-error-message",children:[(0,o.jsx)("h3",{children:"MCP Inspector Unavailable"}),(0,o.jsx)("p",{children:g}),!k&&(0,o.jsxs)("div",{className:"local-only-notice",children:[(0,o.jsx)("p",{children:"The MCP Inspector is only available when running SGEX locally for development and testing."}),(0,o.jsx)("p",{children:"To use the MCP Inspector:"}),(0,o.jsxs)("ol",{children:[(0,o.jsx)("li",{children:"Clone the SGEX repository locally"}),(0,o.jsxs)("li",{children:["Run ",(0,o.jsx)("code",{children:"npm start"})," to start the development server"]}),(0,o.jsxs)("li",{children:["Start MCP services with ",(0,o.jsx)("code",{children:"npm run run-mcp"})]}),(0,o.jsxs)("li",{children:["Access the inspector at ",(0,o.jsx)("code",{children:"http://localhost:3000/sgex/mcp-inspector"})]})]})]})]})}),(0,o.jsx)(l.A,{pageId:"mcp-inspector"})]}):j?(0,o.jsxs)(i.Mx,{children:[(0,o.jsx)(i.zY,{title:"MCP Inspector",breadcrumbItems:[{label:"Home",path:"/"},{label:"MCP Inspector",path:"/mcp-inspector",current:!0}]}),(0,o.jsxs)("div",{className:"sgex-loading-container mcp-inspector-loading",children:[(0,o.jsx)("div",{className:"loading-spinner"}),(0,o.jsx)("p",{children:"Discovering MCP services..."})]}),(0,o.jsx)(l.A,{pageId:"mcp-inspector"})]}):(0,o.jsxs)(i.Mx,{children:[(0,o.jsx)(i.zY,{title:"MCP Inspector",subtitle:"Inspect and monitor local MCP service traffic",breadcrumbItems:[{label:"Home",path:"/"},{label:"MCP Inspector",path:"/mcp-inspector",current:!0}]}),(0,o.jsxs)("div",{className:"sgex-fullheight-container mcp-inspector-container",children:[(0,o.jsxs)("div",{className:"mcp-services-panel",children:[(0,o.jsx)("h3",{children:"Discovered MCP Services"}),Object.entries(D).map(e=>{let[s,a]=e;return(0,o.jsxs)("div",{className:"functionality-group",children:[(0,o.jsxs)("h4",{className:"functionality-title",children:[s.charAt(0).toUpperCase()+s.slice(1)," Services"]}),a.map(e=>{var s,a;return(0,o.jsxs)("div",{className:"service-card",children:[(0,o.jsxs)("div",{className:"service-header",children:[(0,o.jsxs)("label",{className:"service-checkbox",children:[(0,o.jsx)("input",{type:"checkbox",checked:d.has(e.id),onChange:()=>(e=>{const s=new Set(d);s.has(e)?s.delete(e):s.add(e),h(s)})(e.id)}),(0,o.jsx)("span",{className:"service-name",children:e.name})]}),(0,o.jsx)("div",{className:"service-health ".concat(null!==(s=C[e.id])&&void 0!==s&&s.healthy?"healthy":"unhealthy"),children:null!==(a=C[e.id])&&void 0!==a&&a.healthy?"\ud83d\udfe2":"\ud83d\udd34"})]}),(0,o.jsxs)("div",{className:"service-details",children:[(0,o.jsx)("p",{className:"service-description",children:e.description}),(0,o.jsx)("p",{className:"service-url",children:e.baseUrl}),(0,o.jsx)("div",{className:"service-endpoints",children:(0,o.jsxs)("small",{children:["Endpoints: ",e.endpoints.join(", ")]})})]})]},e.id)})]},s)})]}),(0,o.jsxs)("div",{className:"mcp-traffic-panel",children:[(0,o.jsxs)("div",{className:"traffic-header",children:[(0,o.jsx)("h3",{children:"Traffic Logs"}),(0,o.jsxs)("div",{className:"traffic-controls",children:[(0,o.jsx)("input",{type:"text",placeholder:"Search logs...",value:N,onChange:e=>y(e.target.value),className:"search-input"}),(0,o.jsx)("button",{onClick:()=>p([]),className:"clear-logs-btn",children:"Clear Logs"})]})]}),(0,o.jsx)("div",{className:"traffic-logs",children:0===u.length?(0,o.jsxs)("div",{className:"no-logs",children:[(0,o.jsx)("p",{children:"No traffic logs found."}),0===d.size&&(0,o.jsx)("p",{children:"Select one or more services to view their traffic."})]}):u.map(e=>(0,o.jsxs)("div",{className:"log-entry ".concat(e.status>=400?"error":"success"),onClick:()=>(e=>{w(e)})(e),children:[(0,o.jsxs)("div",{className:"log-summary",children:[(0,o.jsx)("span",{className:"log-method",children:e.method}),(0,o.jsx)("span",{className:"log-url",children:e.url}),(0,o.jsx)("span",{className:"log-status status-".concat(Math.floor(e.status/100),"xx"),children:e.status}),(0,o.jsxs)("span",{className:"log-time",children:[e.responseTime,"ms"]}),(0,o.jsx)("span",{className:"log-timestamp",children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,o.jsx)("div",{className:"log-service",children:e.serviceName})]},e.id))})]}),S&&(0,o.jsx)("div",{className:"log-detail-modal",onClick:()=>w(null),children:(0,o.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"modal-header",children:[(0,o.jsx)("h3",{children:"Traffic Log Details"}),(0,o.jsx)("button",{className:"modal-close",onClick:()=>w(null),children:"\xd7"})]}),(0,o.jsxs)("div",{className:"modal-body",children:[(0,o.jsxs)("div",{className:"log-metadata",children:[(0,o.jsxs)("div",{className:"metadata-row",children:[(0,o.jsx)("strong",{children:"Service:"})," ",S.serviceName]}),(0,o.jsxs)("div",{className:"metadata-row",children:[(0,o.jsx)("strong",{children:"Timestamp:"})," ",new Date(S.timestamp).toLocaleString()]}),(0,o.jsxs)("div",{className:"metadata-row",children:[(0,o.jsx)("strong",{children:"Method:"})," ",S.method]}),(0,o.jsxs)("div",{className:"metadata-row",children:[(0,o.jsx)("strong",{children:"URL:"})," ",S.url]}),(0,o.jsxs)("div",{className:"metadata-row",children:[(0,o.jsx)("strong",{children:"Status:"}),(0,o.jsx)("span",{className:"status-badge status-".concat(Math.floor(S.status/100),"xx"),children:S.status})]}),(0,o.jsxs)("div",{className:"metadata-row",children:[(0,o.jsx)("strong",{children:"Response Time:"})," ",S.responseTime,"ms"]})]}),(0,o.jsxs)("div",{className:"log-details",children:[(0,o.jsxs)("div",{className:"detail-section",children:[(0,o.jsx)("h4",{children:"Request"}),M?(0,o.jsx)(M,{language:"json",style:P,className:"syntax-highlighter",children:JSON.stringify(S.request,null,2)}):(0,o.jsx)("pre",{className:"json-display",children:JSON.stringify(S.request,null,2)})]}),(0,o.jsxs)("div",{className:"detail-section",children:[(0,o.jsx)("h4",{children:"Response"}),M?(0,o.jsx)(M,{language:"json",style:P,className:"syntax-highlighter",children:JSON.stringify(S.response,null,2)}):(0,o.jsx)("pre",{className:"json-display",children:JSON.stringify(S.response,null,2)})]})]})]})]})})]}),(0,o.jsx)(l.A,{pageId:"mcp-inspector"})]})}}}]);