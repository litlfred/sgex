"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[700],{1932:(e,a,n)=>{n.d(a,{hX:()=>s});const s=function(e,a,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((e=>!!(null!==e&&void 0!==e&&e.ctrlKey||null!==e&&void 0!==e&&e.metaKey))(e)){const e=(e=>{const a="/sgex/dependabot-npm_and_yarn-react-router-dom-7.8.1",n=window.location.origin,s=e.startsWith("/")?e.slice(1):e;if(!a)return"".concat(n,"/").concat(s);const i=a.endsWith("/")?a:a+"/";return"".concat(n).concat(i).concat(s)})(a);window.open(e,"_blank","noopener,noreferrer")}else s?n(a,{state:s}):n(a)}},98700:(e,a,n)=>{n.r(a),n.d(a,{default:()=>g});var s=n(89379),i=n(9950),t=n(85001),o=n(67818),l=n(29946),r=n(29473),c=n(51635),d=n(1932),h=n(44414);const g=()=>{const{t:e}=(0,o.Bd)(),[a,n]=(0,i.useState)(null),[g,u]=(0,i.useState)([]),[p,m]=(0,i.useState)(!1),[f,x]=(0,i.useState)(!1),[v,j]=(0,i.useState)(null),[N,b]=(0,i.useState)({}),[w,z]=(0,i.useState)(null),k=(0,t.Zp)(),y=(0,t.zy)(),O=(0,i.useCallback)((e,a)=>{if(!l.A.isAuth())return;const n={};if(e){const a=r.A.getCachedRepositories(e.login,"user");a&&a.repositories&&(n["user-".concat(e.login)]=a.repositories.length)}a.forEach(e=>{const a=r.A.getCachedRepositories(e.login,"org");a&&a.repositories&&(n["org-".concat(e.login)]=a.repositories.length)}),b(n)},[]),A=(0,i.useCallback)(async()=>{x(!0),j(null);try{let a=null;p?(await l.A.checkTokenPermissions(),a=await l.A.getCurrentUser(),n(a)):(a=null,n(null));let i=[];if(p)try{i=await l.A.getUserOrganizations()}catch(v){console.error("Error fetching organizations:",v),i=[]}try{const e=await l.A.getWHOOrganization(),a=i.findIndex(e=>"WorldHealthOrganization"===e.login);a>=0?i[a]=(0,s.A)((0,s.A)((0,s.A)({},i[a]),e),{},{isWHO:!0}):i.unshift(e)}catch(e){console.warn("Could not fetch WHO organization data, using fallback:",e);const a={id:"who-organization",login:"WorldHealthOrganization",name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",isWHO:!0};i.some(e=>"WorldHealthOrganization"===e.login)?i=i.map(e=>"WorldHealthOrganization"===e.login?(0,s.A)((0,s.A)({},e),{},{isWHO:!0}):e):i.unshift(a)}u(i),p&&O(a,i)}catch(v){console.error("Error fetching user data:",v),p?(j("Failed to fetch user data. Please check your connection and try again."),m(!1),l.A.logout()):j("Unable to fetch additional data. Some features may be limited.")}finally{x(!1)}},[O,p]);(0,i.useEffect)(()=>{(()=>{const e=l.A.initializeFromStoredToken();m(!!e)})()},[]),(0,i.useEffect)(()=>{var e;null!==(e=y.state)&&void 0!==e&&e.warningMessage&&(z(y.state.warningMessage),k(y.pathname,{replace:!0,state:{}}))},[y.state,k,y.pathname]),(0,i.useEffect)(()=>{a||A()},[a,A]);const W=(e,a)=>{const n={profile:a};(0,d.hX)(e,"/dak-action/".concat(a.login),k,n)};return(0,h.jsx)(c.Mx,{pageName:"select-profile",children:f&&!a?(0,h.jsxs)("div",{className:"loading-section",children:[(0,h.jsx)("div",{className:"spinner"}),(0,h.jsx)("p",{children:"Loading profile data..."})]}):(0,h.jsxs)("div",{className:"select-profile-content",children:[w&&(0,h.jsx)("div",{className:"warning-message",children:(0,h.jsxs)("div",{className:"warning-content",children:[(0,h.jsxs)("div",{className:"warning-header",children:[(0,h.jsx)("span",{className:"warning-icon",children:"\u26a0\ufe0f"}),(0,h.jsx)("span",{className:"warning-text",children:w})]}),(0,h.jsx)("button",{className:"warning-dismiss",onClick:()=>{z(null)},"aria-label":"Dismiss warning",children:"\xd7 Dismiss"})]})}),!p&&(0,h.jsx)("div",{className:"auth-status-message",children:(0,h.jsxs)("div",{className:"auth-status-content",children:[(0,h.jsx)("span",{className:"auth-status-icon",children:"\ud83d\udd13"}),(0,h.jsx)("span",{className:"auth-status-text",children:"You are browsing in unauthenticated mode. Some features like saving to GitHub will be disabled, but you can still explore and use local staging."})]})}),f?(0,h.jsxs)("div",{className:"loading-section",children:[(0,h.jsx)("div",{className:"spinner"}),(0,h.jsx)("p",{children:"Loading profile data..."})]}):(0,h.jsxs)("div",{className:"profile-selection",children:[(0,h.jsx)("h2",{children:e("organization.select")}),(0,h.jsxs)("p",{children:[e("organization.personal"),":"]}),v&&(0,h.jsx)("div",{className:"error-message",children:v}),(0,h.jsxs)("div",{className:"profile-grid-horizontal",children:[p&&a&&(0,h.jsxs)("div",{className:"profile-card",onClick:e=>W(e,(0,s.A)({type:"user"},a)),children:[(0,h.jsxs)("div",{className:"profile-card-header",children:[(0,h.jsx)("img",{src:null===a||void 0===a?void 0:a.avatar_url,alt:"Personal profile"}),N["user-".concat(null===a||void 0===a?void 0:a.login)]>0&&(0,h.jsx)("div",{className:"dak-count-badge",children:N["user-".concat(null===a||void 0===a?void 0:a.login)]})]}),(0,h.jsx)("h3",{children:(null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.login)}),(0,h.jsx)("p",{children:"Personal repositories"}),(0,h.jsx)("div",{className:"profile-badges",children:(0,h.jsx)("span",{className:"profile-type",children:"Personal"})})]}),g.map(a=>(0,h.jsxs)("div",{className:"profile-card ".concat(a.isWHO?"who-org":""),onClick:e=>W(e,(0,s.A)({type:"org"},a)),children:[(0,h.jsxs)("div",{className:"profile-card-header",children:[(0,h.jsx)("img",{src:a.avatar_url||"https://github.com/".concat(a.login,".png"),alt:"".concat(a.name||a.login," organization")}),N["org-".concat(a.login)]>0&&(0,h.jsx)("div",{className:"dak-count-badge",children:N["org-".concat(a.login)]})]}),(0,h.jsx)("h3",{children:a.name||a.login}),(0,h.jsxs)("p",{children:["@",a.login]}),(0,h.jsxs)("div",{className:"profile-badges",children:[(0,h.jsx)("span",{className:"profile-type",children:e("organization.organizations")}),a.isWHO&&(0,h.jsx)("span",{className:"who-badge",children:"WHO Official"})]})]},a.login))]})]})]})})}}}]);