"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[6813],{17009:(e,a,s)=>{s.r(a),s.d(a,{default:()=>h});var t=s(89379),n=s(9950),r=s(67818),c=s(53782),l=s(37210),i=s(46901),o=s(88259),d=s(95388),u=s(15824),m=s(44414);const h=()=>{const{t:e}=(0,r.Bd)(),a=i.A.isAuth(),[s,h]=(0,n.useState)([]),[x,g]=(0,n.useState)(!0),[p,j]=(0,n.useState)(null),[N,w]=(0,n.useState)(1),[v,f]=(0,n.useState)(""),[b,A]=(0,n.useState)("updated"),[k,y]=(0,n.useState)("desc"),[S,_]=(0,n.useState)({}),[C,P]=(0,n.useState)("open"),[L,E]=(0,n.useState)(!1),[D,G]=(0,n.useState)({}),[R]=(0,n.useState)(!1),[T,I]=(0,n.useState)({}),[O,M]=(0,n.useState)({}),[F,X]=(0,n.useState)({}),[H,U]=(0,n.useState)({}),[q,B]=(0,n.useState)(!1),V=10,W=(0,o.A)("sgex-mascot.png"),Y=e=>{i.A.authenticate(e)&&E(!0)},z=()=>{E(!1),i.A.logout(),G({})},Q=async e=>{try{if(i.A.isAuth()){const a=await i.A.getPullRequestIssueComments(u.A.getOwner(),u.A.getName(),e);if(0===a.length)return{count:0,lastComment:null};const s=a[a.length-1];return{count:a.length,lastComment:{author:s.user.login,created_at:new Date(s.created_at),avatar_url:s.user.avatar_url}}}try{const a=await i.A.getPullRequestIssueComments(u.A.getOwner(),u.A.getName(),e);if(0===a.length)return{count:0,lastComment:null};const s=a[a.length-1];return{count:a.length,lastComment:{author:s.user.login,created_at:new Date(s.created_at),avatar_url:s.user.avatar_url}}}catch(p){return console.warn("Failed to fetch comments for PR ".concat(e,": ").concat(p.message)),{count:0,lastComment:null,error:!0}}}catch(p){return console.warn("Error fetching comment summary for PR ".concat(e,":"),p),{count:0,lastComment:null,error:!0}}},J=async e=>{try{if(i.A.isAuth()){return(await i.A.getPullRequestIssueComments(u.A.getOwner(),u.A.getName(),e)).map(e=>({id:e.id,author:e.user.login,body:e.body,created_at:new Date(e.created_at).toLocaleDateString(),created_at_raw:new Date(e.created_at),avatar_url:e.user.avatar_url})).sort((e,a)=>a.created_at_raw-e.created_at_raw)}try{return(await i.A.getPullRequestIssueComments(u.A.getOwner(),u.A.getName(),e)).map(e=>({id:e.id,author:e.user.login,body:e.body,created_at:new Date(e.created_at).toLocaleDateString(),created_at_raw:new Date(e.created_at),avatar_url:e.user.avatar_url})).sort((e,a)=>a.created_at_raw-e.created_at_raw)}catch(p){return console.warn("Failed to fetch comments for PR ".concat(e,": ").concat(p.message)),[]}}catch(p){return console.warn("Error fetching all comments for PR ".concat(e,":"),p),[]}},K=(0,n.useCallback)(async e=>{if(0===e.length)return;B(!0);const a={};for(const s of e)a[s.number]=await Q(s.number);U(a),B(!1)},[a]),Z=e=>{const a=H[e];if(q)return"Loading discussion...";if(!a)return"No comments yet";if(a.error)return"Unable to load comments";if(0===a.count)return"No comments yet";const{count:s,lastComment:t}=a,n=t?$(t.created_at):"";return"".concat(s," comment").concat(s>1?"s":"",", last by ").concat(t.author," ").concat(n)},$=e=>{const a=new Date-e,s=Math.floor(a/864e5);return 0===s?"today":1===s?"1 day ago":s<7?"".concat(s," days ago"):s<30?"".concat(Math.floor(s/7)," week").concat(Math.floor(s/7)>1?"s":""," ago"):"".concat(Math.floor(s/30)," month").concat(Math.floor(s/30)>1?"s":""," ago")},ee=async e=>{try{if(i.A.isAuth())try{const a=await i.A.getWorkflowRuns(u.A.getOwner(),u.A.getName(),{branch:e,workflow_id:"deploy.yml",per_page:1});if(a.workflow_runs&&a.workflow_runs.length>0){const e=a.workflow_runs[0];return{status:e.status,conclusion:e.conclusion,html_url:e.html_url,created_at:e.created_at}}return{status:"unknown",conclusion:null}}catch(a){return console.warn("Authenticated workflow check failed for ".concat(e,":"),a),{status:"unknown",conclusion:null}}else try{const a=await i.A.getWorkflowRuns(u.A.getOwner(),u.A.getName(),{branch:e,workflow_id:"deploy.yml",per_page:1});if(a.workflow_runs&&a.workflow_runs.length>0){const e=a.workflow_runs[0];return{status:e.status,conclusion:e.conclusion,html_url:e.html_url,created_at:e.created_at}}return{status:"unknown",conclusion:null}}catch(p){return console.warn("Failed to fetch deployment status for ".concat(e,": ").concat(p.message)),{status:"unknown",conclusion:null}}}catch(p){return console.warn("Error checking deployment status for ".concat(e,":"),p),{status:"unknown",conclusion:null}}},ae=(0,n.useCallback)(async e=>{if(0===e.length)return;const a={};for(const s of e)a[s.safeBranchName]=await ee(s.safeBranchName);_(e=>(0,t.A)((0,t.A)({},e),a))},[a]),se=e=>{const a=S[e];return a?"completed"===a.status&&"success"===a.conclusion?{text:"\u2705 Deployed",class:"success"}:"completed"===a.status&&"failure"===a.conclusion?{text:"\u274c Failed",class:"failed"}:"in_progress"===a.status?{text:"\ud83d\udd04 Deploying",class:"in-progress"}:"queued"===a.status?{text:"\u23f3 Queued",class:"queued"}:"error"===a.status?{text:"\u26a0\ufe0f Error",class:"error"}:{text:"\u2753 Unknown",class:"unknown"}:{text:"Checking...",class:"unknown"}},te=function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"desc";return[...e].sort((e,t)=>{let n=0;switch(a){case"number":n=t.number-e.number;break;case"alphabetical":n=e.title.localeCompare(t.title);break;default:const a=new Date(e.updatedAt);n=new Date(t.updatedAt)-a}return"asc"===s?-n:n})};(0,n.useEffect)(()=>{if(i.A.initializeFromStoredToken()){i.A.getStoredTokenInfo()&&E(!0)}},[]),(0,n.useEffect)(()=>{(async()=>{try{g(!0);const e=u.A.getOwner(),a="sgex",s="all"===C?"all":C,t=(await i.A.getPullRequests(e,a,{state:s,sort:"updated",per_page:100})).map(e=>{const a=e.head.ref.replace(/\//g,"-");return{id:e.id,number:e.number,title:e.title,state:e.state,author:e.user.login,branchName:e.head.ref,safeBranchName:a,url:"./".concat(a,"/index.html"),prUrl:e.html_url,updatedAt:new Date(e.updated_at).toLocaleDateString(),createdAt:new Date(e.created_at).toLocaleDateString()}});h(t),await K(t.slice(0,V))}catch(e){if(console.error("Error fetching data:",e),j(e.message),e.message.includes("Failed to fetch")||e.message.includes("rate limit")){console.log("Using fallback mock data...");const a=[{id:1,number:460,title:"Improve multi-page selector landing page for GitHub deployment",state:"open",author:"copilot",branchName:"copilot/fix-459",safeBranchName:"copilot-fix-459",url:"./sgex/copilot-fix-459/index.html",prUrl:"".concat(u.A.getGitHubUrl(),"/pull/460"),updatedAt:(new Date).toLocaleDateString(),createdAt:new Date(Date.now()-864e5).toLocaleDateString()},{id:2,number:459,title:"Add enhanced PR preview functionality",state:"open",author:"developer",branchName:"feature/pr-preview",safeBranchName:"feature-pr-preview",url:"./sgex/feature-pr-preview/index.html",prUrl:"".concat(u.A.getGitHubUrl(),"/pull/459"),updatedAt:new Date(Date.now()-1728e5).toLocaleDateString(),createdAt:new Date(Date.now()-3456e5).toLocaleDateString()}];h(a),e.message.includes("Failed to fetch")&&j("API rate limit exceeded for 136.47.145.179. (But here's the good news: Authenticated requests get a higher rate limit. Check out the documentation for more details.) - https://docs.github.com/rest/overview/resources-in-the-rest-api#rate-limiting")}}finally{g(!1)}})()},[C,a,K]),(0,n.useEffect)(()=>{if(0===s.length)return;const e=s.filter(e=>e.title.toLowerCase().includes(v.toLowerCase())||e.author.toLowerCase().includes(v.toLowerCase())||e.branchName.toLowerCase().includes(v.toLowerCase())),a=te(e,b,k).slice((N-1)*V,N*V);ae(a);const t=setInterval(()=>{ae(a)},7e3);return()=>clearInterval(t)},[s,v,b,k,N,ae]),(0,n.useEffect)(()=>{if(s.length>0){const e=s.filter(e=>e.title.toLowerCase().includes(v.toLowerCase())||e.author.toLowerCase().includes(v.toLowerCase())||e.branchName.toLowerCase().includes(v.toLowerCase())),a=te(e,b,k).slice((N-1)*V,N*V);K(a)}},[N,v,b,k,s,K]);const ne=s.filter(e=>e.title.toLowerCase().includes(v.toLowerCase())||e.author.toLowerCase().includes(v.toLowerCase())||e.branchName.toLowerCase().includes(v.toLowerCase())),re=te(ne,b,k),ce=re.slice((N-1)*V,N*V),le=Math.ceil(re.length/V);return(0,m.jsx)(c.Mx,{pageName:"branch-listing",showBreadcrumbs:!1,children:(0,m.jsx)("div",{className:"branch-listing-content",children:x?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"branch-listing-header",children:[(0,m.jsxs)("h1",{children:[(0,m.jsx)("img",{src:W,alt:(0,d.lm)(e,d.ld.ICON_SGEX,"SGEX Icon"),className:"sgex-icon"})," SGEX"]}),(0,m.jsx)("p",{className:"subtitle",children:"a collaborative workbench for WHO SMART Guidelines"}),(0,m.jsx)("div",{className:"loading",children:"Loading previews..."}),(0,m.jsx)("div",{className:"prominent-info",children:(0,m.jsx)("p",{className:"info-text",children:"\ud83d\udc3e While previews load, you can access the main SGEX workbench and login below."})})]}),(0,m.jsxs)("div",{className:"action-cards",children:[(0,m.jsx)("div",{className:"action-card main-site-card",children:(0,m.jsx)("a",{href:"/sgex/main/",className:"card-link",children:(0,m.jsxs)("div",{className:"card-content",children:[(0,m.jsx)("img",{src:W,alt:(0,d.lm)(e,d.ld.MASCOT_HELPER,"SGEX Mascot"),className:"card-icon"}),(0,m.jsxs)("div",{className:"card-text",children:[(0,m.jsx)("h3",{children:"View Main Site"}),(0,m.jsx)("p",{children:"Access the main SGEX workbench"})]})]})})}),L?(0,m.jsx)("div",{className:"action-card logout-card",children:(0,m.jsxs)("div",{className:"card-content",children:[(0,m.jsx)("div",{className:"login-icon",children:"\u2705"}),(0,m.jsxs)("div",{className:"card-text",children:[(0,m.jsx)("h3",{children:"Logged In"}),(0,m.jsx)("p",{children:"You can now view and add comments"}),(0,m.jsx)("button",{onClick:z,className:"logout-btn",children:"\ud83d\udeaa Logout"})]})]})}):(0,m.jsx)("div",{className:"action-card login-card",children:(0,m.jsxs)("div",{className:"card-content",children:[(0,m.jsx)("div",{className:"login-icon",children:"\ud83d\udd10"}),(0,m.jsxs)("div",{className:"card-text",children:[(0,m.jsx)("h3",{children:"GitHub Login"}),(0,m.jsx)("p",{children:"Login to get higher API rate limits and view comments"}),(0,m.jsx)(l.A,{onAuthSuccess:Y})]})]})})]})]}):p&&0===s.length?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("header",{className:"branch-listing-header",children:[(0,m.jsxs)("h1",{children:[(0,m.jsx)("img",{src:W,alt:(0,d.lm)(e,d.ld.ICON_SGEX,"SGEX Icon"),className:"sgex-icon"})," SGEX"]}),(0,m.jsx)("p",{className:"subtitle",children:"a collaborative workbench for WHO SMART Guidelines"}),(0,m.jsx)("div",{className:"error-banner",children:(0,m.jsxs)("div",{className:"error-content",children:[(0,m.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,m.jsxs)("div",{className:"error-text",children:[(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"Failed to load previews:"})," ",p]}),(0,m.jsxs)("p",{className:"error-help",children:["GitHub API rate limit exceeded.",!L&&" Try logging in with a Personal Access Token for higher rate limits, or"," ","try refreshing the page in a few minutes."]})]})]})}),(0,m.jsx)("div",{className:"prominent-info",children:(0,m.jsx)("p",{className:"info-text",children:"\ud83d\udc3e You can still access the main SGEX workbench and login below."})})]}),(0,m.jsxs)("div",{className:"action-cards",children:[(0,m.jsx)("div",{className:"action-card main-site-card",children:(0,m.jsx)("a",{href:"/sgex/main/",className:"card-link",children:(0,m.jsxs)("div",{className:"card-content",children:[(0,m.jsx)("img",{src:W,alt:(0,d.lm)(e,d.ld.MASCOT_HELPER,"SGEX Mascot"),className:"card-icon"}),(0,m.jsxs)("div",{className:"card-text",children:[(0,m.jsx)("h3",{children:"View Main Site"}),(0,m.jsx)("p",{children:"Access the main SGEX workbench"})]})]})})}),L?(0,m.jsx)("div",{className:"action-card logout-card",children:(0,m.jsxs)("div",{className:"card-content",children:[(0,m.jsx)("div",{className:"login-icon",children:"\u2705"}),(0,m.jsxs)("div",{className:"card-text",children:[(0,m.jsx)("h3",{children:"Logged In"}),(0,m.jsx)("p",{children:"You can now view and add comments"}),(0,m.jsx)("button",{onClick:z,className:"logout-btn",children:"\ud83d\udeaa Logout"})]})]})}):(0,m.jsx)("div",{className:"action-card login-card",children:(0,m.jsxs)("div",{className:"card-content",children:[(0,m.jsx)("div",{className:"login-icon",children:"\ud83d\udd10"}),(0,m.jsxs)("div",{className:"card-text",children:[(0,m.jsx)("h3",{children:"GitHub Login"}),(0,m.jsx)("p",{children:"Login to get higher API rate limits and view comments"}),(0,m.jsx)(l.A,{onAuthSuccess:Y})]})]})})]})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("header",{className:"branch-listing-header",children:[(0,m.jsxs)("h1",{children:[(0,m.jsx)("img",{src:W,alt:(0,d.lm)(e,d.ld.ICON_SGEX,"SGEX Icon"),className:"sgex-icon"})," SGEX"]}),(0,m.jsx)("p",{className:"subtitle",children:"a collaborative workbench for WHO SMART Guidelines"}),p&&(0,m.jsx)("div",{className:"error-banner",children:(0,m.jsxs)("div",{className:"error-content",children:[(0,m.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,m.jsxs)("div",{className:"error-text",children:[(0,m.jsxs)("p",{children:[(0,m.jsx)("strong",{children:"Failed to load previews:"})," ",p]}),(0,m.jsxs)("p",{className:"error-help",children:["GitHub API rate limit exceeded.",!L&&" Try logging in with a Personal Access Token for higher rate limits, or"," ","try refreshing the page in a few minutes."]})]})]})}),(0,m.jsx)("div",{className:"prominent-info",children:(0,m.jsx)("p",{className:"info-text",children:"\ud83d\udc3e This landing page lists all available previews. Each branch and PR is automatically deployed to its own preview environment."})})]}),(0,m.jsxs)("div",{className:"action-cards",children:[(0,m.jsx)("div",{className:"action-card main-site-card",children:(0,m.jsx)("a",{href:"/sgex/main/",className:"card-link",children:(0,m.jsxs)("div",{className:"card-content",children:[(0,m.jsx)("img",{src:W,alt:(0,d.lm)(e,d.ld.MASCOT_HELPER,"SGEX Mascot"),className:"card-icon"}),(0,m.jsxs)("div",{className:"card-text",children:[(0,m.jsx)("h3",{children:"View Main Site"}),(0,m.jsx)("p",{children:"Access the main SGEX workbench"})]})]})})}),L?(0,m.jsx)("div",{className:"action-card logout-card",children:(0,m.jsxs)("div",{className:"card-content",children:[(0,m.jsx)("div",{className:"login-icon",children:"\u2705"}),(0,m.jsxs)("div",{className:"card-text",children:[(0,m.jsx)("h3",{children:"Logged In"}),(0,m.jsx)("p",{children:"You can now view and add comments"}),(0,m.jsx)("button",{onClick:z,className:"logout-btn",children:"\ud83d\udeaa Logout"})]})]})}):(0,m.jsx)("div",{className:"action-card login-card",children:(0,m.jsxs)("div",{className:"card-content",children:[(0,m.jsx)("div",{className:"login-icon",children:"\ud83d\udd10"}),(0,m.jsxs)("div",{className:"card-text",children:[(0,m.jsx)("h3",{children:"GitHub Login"}),(0,m.jsxs)("p",{children:["Login to view and add comments",p?" and get higher API rate limits":""]}),(0,m.jsx)(l.A,{onAuthSuccess:Y})]})]})})]}),(0,m.jsx)("div",{className:"preview-tabs",children:(0,m.jsxs)("button",{className:"tab-button active",children:["\ud83d\udd04 Pull Request Previews (",re.length,")"]})}),(0,m.jsxs)("div",{className:"pr-section",children:[(0,m.jsxs)("div",{className:"pr-controls",children:[(0,m.jsxs)("div",{className:"pr-filter-section",children:[(0,m.jsx)("label",{htmlFor:"pr-filter",children:"Filter PRs:"}),(0,m.jsxs)("select",{id:"pr-filter",value:C,onChange:e=>{P(e.target.value),w(1)},className:"filter-select",children:[(0,m.jsx)("option",{value:"open",children:"Open PRs Only"}),(0,m.jsx)("option",{value:"closed",children:"Closed PRs Only"}),(0,m.jsx)("option",{value:"all",children:"All PRs"})]})]}),(0,m.jsx)("input",{type:"text",placeholder:"Search pull requests by title, author, or branch name...",value:v,onChange:e=>{f(e.target.value),w(1)},className:"pr-search"}),(0,m.jsxs)("select",{value:b,onChange:e=>{A(e.target.value),w(1)},className:"sort-select",children:[(0,m.jsx)("option",{value:"updated",children:"Sort by Recent Updates"}),(0,m.jsx)("option",{value:"number",children:"Sort by PR Number"}),(0,m.jsx)("option",{value:"alphabetical",children:"Sort Alphabetically"})]}),(0,m.jsxs)("select",{value:k,onChange:e=>{y(e.target.value),w(1)},className:"sort-select",children:[(0,m.jsx)("option",{value:"desc",children:"Descending"}),(0,m.jsx)("option",{value:"asc",children:"Ascending"})]})]}),(0,m.jsx)("div",{className:"pr-cards",children:0===ce.length?(0,m.jsx)("div",{className:"no-items",children:v?(0,m.jsxs)("p",{children:['No pull requests match your search "',v,'".']}):(0,m.jsx)("p",{children:"No pull request previews available at the moment."})}):ce.map(a=>{var s;return(0,m.jsxs)("div",{className:"preview-card pr-card",children:[(0,m.jsxs)("div",{className:"card-header",children:[(0,m.jsxs)("h3",{className:"item-name",children:["#",a.number,": ",a.title]}),(0,m.jsxs)("div",{className:"card-badges",children:[(0,m.jsxs)("span",{className:"state-badge ".concat(a.state),children:["open"===a.state?"\ud83d\udfe2":"\ud83d\udd34"," ",a.state]}),(0,m.jsx)("span",{className:"deployment-status ".concat(se(a.safeBranchName).class),children:se(a.safeBranchName).text})]})]}),(0,m.jsxs)("div",{className:"card-body",children:[(0,m.jsxs)("p",{className:"pr-meta",children:[(0,m.jsx)("strong",{children:"Branch:"})," ",a.branchName," \u2022 ",(0,m.jsx)("strong",{children:"Author:"})," ",a.author]}),(0,m.jsxs)("p",{className:"item-date",children:["Created: ",a.createdAt," \u2022 Updated: ",a.updatedAt]}),(0,m.jsxs)("div",{className:"discussion-summary-bar",onClick:()=>(async e=>{const a=F[e];if(!a){const a=await J(e);G(s=>(0,t.A)((0,t.A)({},s),{},{[e]:a}))}X(s=>(0,t.A)((0,t.A)({},s),{},{[e]:!a}))})(a.number),children:[(0,m.jsxs)("div",{className:"discussion-summary-text",children:[(0,m.jsx)("span",{className:"discussion-summary-icon",children:"\ud83d\udcac"}),Z(a.number)]}),(0,m.jsx)("span",{className:"discussion-expand-icon ".concat(F[a.number]?"expanded":""),children:"\u25b6"})]}),F[a.number]&&(0,m.jsxs)("div",{className:"discussion-expanded-section",children:[(0,m.jsxs)("div",{className:"discussion-header",children:[(0,m.jsx)("h4",{className:"discussion-title",children:"Discussion"}),(0,m.jsxs)("div",{className:"discussion-actions",children:[(0,m.jsx)("a",{href:"".concat(u.A.getGitHubUrl(),"/pull/").concat(a.number,"/files"),target:"_blank",rel:"noopener noreferrer",className:"discussion-action-btn",children:"\ud83d\udcc1 View Files"}),(0,m.jsx)("a",{href:a.prUrl,target:"_blank",rel:"noopener noreferrer",className:"discussion-action-btn secondary",children:"\ud83d\udd17 View PR"})]})]}),i.A.isAuth()&&(0,m.jsxs)("div",{className:"comment-input-section",children:[(0,m.jsx)("textarea",{value:T[a.number]||"",onChange:e=>I(s=>(0,t.A)((0,t.A)({},s),{},{[a.number]:e.target.value})),placeholder:"Add a comment...",className:"comment-input",rows:3}),(0,m.jsx)("button",{onClick:()=>(async(e,a)=>{if(!i.A.isAuth()||!a.trim())return!1;M(a=>(0,t.A)((0,t.A)({},a),{},{[e]:!0}));try{if(await i.A.createPullRequestComment(u.A.getOwner(),u.A.getName(),e,a),I(a=>(0,t.A)((0,t.A)({},a),{},{[e]:""})),F[e]){const a=await J(e);G(s=>(0,t.A)((0,t.A)({},s),{},{[e]:a}))}const s=await Q(e);return U(a=>(0,t.A)((0,t.A)({},a),{},{[e]:s})),!0}catch(p){return console.error("Error submitting comment for PR ".concat(e,":"),p),!1}finally{M(a=>(0,t.A)((0,t.A)({},a),{},{[e]:!1}))}})(a.number,T[a.number]),disabled:!(null!==(s=T[a.number])&&void 0!==s&&s.trim())||O[a.number],className:"submit-comment-btn",children:O[a.number]?"Submitting...":"Add Comment"})]}),(0,m.jsx)("div",{className:"discussion-scroll-area",children:R?(0,m.jsx)("div",{className:"comments-loading",children:"Loading full discussion..."}):D[a.number]&&D[a.number].length>0?(0,m.jsx)("div",{className:"comments-list",children:D[a.number].slice(0,5).map(a=>(0,m.jsxs)("div",{className:"comment-item",children:[(0,m.jsxs)("div",{className:"comment-header",children:[(0,m.jsx)("img",{src:a.avatar_url,alt:(0,d.yl)(e,{name:a.author},"user"),className:"comment-avatar"}),(0,m.jsx)("span",{className:"comment-author",children:a.author}),(0,m.jsx)("span",{className:"comment-date",children:a.created_at})]}),(0,m.jsx)("div",{className:"comment-body",children:a.body.length>200?"".concat(a.body.substring(0,200),"..."):a.body})]},a.id))}):(0,m.jsx)("div",{className:"no-comments",children:i.A.isAuth()?"No comments yet. Be the first to comment!":"No comments yet. Login to add the first comment!"})})]}),(0,m.jsxs)("div",{className:"pr-actions",children:[(0,m.jsx)("a",{href:a.url,className:"preview-link",target:"_blank",rel:"noopener noreferrer",children:(0,m.jsx)("span",{children:"\ud83d\ude80 View Preview"})}),(0,m.jsx)("a",{href:a.prUrl,className:"pr-link",target:"_blank",rel:"noopener noreferrer",children:(0,m.jsx)("span",{children:"\ud83d\udccb View PR"})})]})]}),(0,m.jsx)("div",{className:"card-footer",children:(0,m.jsxs)("small",{className:"preview-path",children:["Preview URL: ",a.url]})})]},a.id)})}),le>1&&(0,m.jsxs)("div",{className:"pagination",children:[(0,m.jsx)("button",{className:"pagination-btn",onClick:()=>w(Math.max(1,N-1)),disabled:1===N,children:"\u2190 Previous"}),(0,m.jsxs)("span",{className:"pagination-info",children:["Page ",N," of ",le," (",re.length," total)"]}),(0,m.jsx)("button",{className:"pagination-btn",onClick:()=>w(Math.min(le,N+1)),disabled:N===le,children:"Next \u2192"})]})]})]})})})}},37210:(e,a,s)=>{s.d(a,{A:()=>l});var t=s(9950),n=s(67818),r=s(85571),c=s(44414);const l=e=>{let{onAuthSuccess:a}=e;const{t:l}=(0,n.Bd)(),[i,o]=(0,t.useState)(""),[d,u]=(0,t.useState)(""),[m,h]=(0,t.useState)(""),[x,g]=(0,t.useState)(!1),p=r.A.getLogger("PATLogin");t.useEffect(()=>(p.componentMount({hasOnAuthSuccess:!!a}),()=>p.componentUnmount()),[p,a]);return(0,c.jsx)("div",{className:"pat-login",children:(0,c.jsxs)("div",{className:"pat-login-section",children:[(0,c.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p.userAction("PAT login attempt",{tokenProvided:!!i.trim()}),!i.trim()){return h("Please enter a GitHub Personal Access Token"),void p.warn("PAT login failed - no token provided")}g(!0),h("");const t=Date.now();p.auth("Starting PAT authentication");try{const{Octokit:e}=await s.e(112).then(s.bind(s,10112)),n=new e({auth:i.trim()});p.debug("Octokit instance created for PAT validation"),p.apiCall("GET","/user",null);const r=await n.rest.users.getAuthenticated(),c=Date.now()-t;p.apiResponse("GET","/user",r.status,c),p.auth("PAT authentication successful",{username:r.data.login,duration:c}),a(i.trim(),n)}catch(n){const e=Date.now()-t;p.apiError("GET","/user",n),p.auth("PAT authentication failed",{status:n.status,message:n.message,duration:e}),console.error("PAT authentication failed:",n),401===n.status?h("Invalid Personal Access Token. Please check your token and try again."):403===n.status?h("Token doesn't have sufficient permissions. Please ensure your token has 'repo' and 'read:org' scopes."):h("Authentication failed. Please check your connection and try again.")}finally{g(!1)}},className:"pat-form",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"token-name",children:"Token Name (optional):"}),(0,c.jsx)("input",{id:"token-name",type:"text",value:d,onChange:e=>{u(e.target.value),m&&h("")},placeholder:"e.g., SGEX Access Token",className:"token-name-input",disabled:x,autoComplete:"username"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsxs)("label",{htmlFor:"pat-token",children:[l("auth.setupToken"),":"]}),(0,c.jsx)("input",{id:"pat-token",type:"password",value:i,onChange:e=>{o(e.target.value),m&&h("")},placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx",className:"token-input ".concat(m?"error":""),disabled:x,autoComplete:"current-password"})]}),(0,c.jsx)("button",{type:"submit",className:"github-login-btn",disabled:x||!i.trim(),children:x?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"spinner small"}),l("common.loading"),"..."]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"github-icon",children:"\ud83d\udd11"}),l("auth.signInWithPAT")]})})]}),m&&(0,c.jsx)("div",{className:"error-message",children:m})]})})}}}]);