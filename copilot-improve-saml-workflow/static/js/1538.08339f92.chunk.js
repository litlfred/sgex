"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[1538],{42789:(e,t,s)=>{s.r(t),s.d(t,{default:()=>F});var n=s(89379),a=s(9950),i=s(67818),o=s(46901),r=(s(88498),s(18354)),c=s(78952),l=s(25345),d=s(88259),u=s(44414);const h=e=>{let{helpTopic:t,contextData:s={}}=e;const[n,i]=(0,a.useState)(!1),o=(0,d.A)("sgex-mascot.png");return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{className:"help-button",onClick:()=>{i(!0)},title:"Get Help","aria-label":"Get Help",children:(0,u.jsx)("img",{src:o,alt:"SGEX Helper",className:"help-mascot-icon"})}),n&&(0,u.jsx)(l.A,{topic:t,contextData:s,onClose:()=>{i(!1)}})]})};var m=s(32675),p=s(12516),g=s(58377),f=s(53155),v=s(53782),x=s(1932),b=s(49162),y=s(16558);const j=new class{constructor(){this.registry=null,this.loaded=!1}loadFromYaml(e){try{this.registry=y.default.load(e),this.loaded=!0}catch(t){throw new Error("Failed to parse parameter registry YAML: ".concat(t.message))}}getParameters(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.loaded||!this.registry)throw new Error("Parameter registry not loaded");const s=[];if(this.registry.defaults)for(const[n,i]of Object.entries(this.registry.defaults))s.push(new b.hI({name:n,type:i.type,required:i.required||!1,description:i.description||"",defaultValue:i.default||null,validation:i.validation||{}}));if(this.registry[e])if(t&&this.registry[e][t])for(const[i,o]of Object.entries(this.registry[e][t]))s.push(new b.hI((0,n.A)({name:i},o)));else if(!t)for(const[i,o]of Object.entries(this.registry[e]))"object"===typeof o&&o.type&&s.push(new b.hI((0,n.A)({name:i},o)));const a=new Map;return s.forEach(e=>{a.set(e.name,e)}),Array.from(a.values())}validateParameters(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=this.getParameters(t,s),a={},i=[];for(const o of n){const t=e[o.name];if(o.required&&(void 0===t||null===t)){i.push("Required parameter '".concat(o.name,"' is missing"));continue}const s=void 0!==t?t:o.defaultValue;if(null!==s&&void 0!==s){const e=this.validateParameterType(s,o);if(e){i.push("Parameter '".concat(o.name,"': ").concat(e));continue}const t=this.validateParameterCustom(s,o);if(t){i.push("Parameter '".concat(o.name,"': ").concat(t));continue}}a[o.name]=s}for(const o of Object.keys(e))n.find(e=>e.name===o)||i.push("Unknown parameter '".concat(o,"'"));return{normalized:a,errors:i,isValid:0===i.length}}validateParameterType(e,t){const s=t.type,n=typeof e;switch(s){case"string":if("string"!==n)return"Expected string, got ".concat(n);break;case"boolean":if("boolean"!==n)return"Expected boolean, got ".concat(n);break;case"number":if("number"!==n||isNaN(e))return"Expected number, got ".concat(n);break;case"array":if(!Array.isArray(e))return"Expected array, got ".concat(n);break;case"object":if("object"!==n||Array.isArray(e))return"Expected object, got ".concat(n);break;default:return"Unknown type: ".concat(s)}return null}validateParameterCustom(e,t){if(!t.validation)return null;const s=t.validation;if(s.pattern&&"string"===typeof e){if(!new RegExp(s.pattern).test(e))return"Value does not match pattern ".concat(s.pattern)}return s.enum&&Array.isArray(s.enum)&&!s.enum.includes(e)?"Value must be one of: ".concat(s.enum.join(", ")):void 0!==s.minLength&&"string"===typeof e&&e.length<s.minLength?"String must be at least ".concat(s.minLength," characters"):void 0!==s.maxLength&&"string"===typeof e&&e.length>s.maxLength?"String must be at most ".concat(s.maxLength," characters"):void 0!==s.min&&"number"===typeof e&&e<s.min?"Number must be at least ".concat(s.min):void 0!==s.max&&"number"===typeof e&&e>s.max?"Number must be at most ".concat(s.max):null}getParameterSchema(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.getParameters(e,t),n={},a=[];for(const i of s){const e={type:i.type,description:i.description};null!==i.defaultValue&&(e.default=i.defaultValue),i.validation&&Object.assign(e,i.validation),n[i.name]=e,i.required&&a.push(i.name)}return{type:"object",properties:n,required:a}}};j.loadFromYaml('\ndefaults:\n  repository:\n    type: string\n    required: true\n    description: "Repository context (always required)"\n  locale:\n    type: string\n    required: false\n    default: "en_US"\n    description: "Locale for responses"\n  branch:\n    type: string\n    required: false\n    default: "main"\n    description: "Git branch context"\n\ndak:\n\ncomponent:\n  businessProcess:\n    componentType:\n      type: string\n      required: true\n      default: "businessProcess"\n      description: "Type of component being analyzed"\n\nasset:\n  lesson:\n    assetFile:\n      type: string\n      required: true\n      description: "Relative path to the lesson file"\n');const w=j;class N{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";if("string"!==typeof e)throw new Error("BrowserBuffer only supports string content");this.content=e,this.encoding=t}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf-8";return"utf-8"!==e&&"utf8"!==e&&console.warn("BrowserBuffer: Encoding ".concat(e," not fully supported, using utf-8")),this.content}get length(){return this.content.length}static from(e){return new N(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8")}}const S={from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return N.from(e,t)},isBuffer:e=>e instanceof N};class k{async readFile(e){throw new Error("readFile must be implemented by subclass")}async fileExists(e){throw new Error("fileExists must be implemented by subclass")}async listFiles(e){throw new Error("listFiles must be implemented by subclass")}async getFileInfo(e){throw new Error("getFileInfo must be implemented by subclass")}}class A extends k{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";super(),this.githubService=e,this.repository=t,this.branch=s,this.cache=new Map}parseRepository(e){if("string"===typeof e){if(e.includes("github.com")){const t=e.match(/github\.com\/([^/]+)\/([^/?#]+)/);if(t)return{owner:t[1],repo:t[2].replace(/\.git$/,"")}}const t=e.split("/");if(2===t.length)return{owner:t[0],repo:t[1]}}throw new Error("Invalid repository format: ".concat(e))}async readFile(e){const t="".concat(this.repository,":").concat(this.branch,":").concat(e);if(this.cache.has(t))return console.log("GitHubStorage.readFile: Cache hit for ".concat(e)),this.cache.get(t);try{const{owner:s,repo:n}=this.parseRepository(this.repository);console.log("GitHubStorage.readFile: Reading file ".concat(e," from ").concat(s,"/").concat(n," (branch: ").concat(this.branch,")")),console.log("GitHubStorage.readFile: About to call githubService.getFileContent...");const a=await this.githubService.getFileContent(s,n,e,this.branch);if(console.log("GitHubStorage.readFile: \u2705 GitHub service call completed successfully"),console.log("GitHubStorage.readFile: Received content - type: ".concat(typeof a,", length: ").concat((null===a||void 0===a?void 0:a.length)||"undefined")),"string"!==typeof a)throw console.error("GitHubStorage.readFile: \u274c Expected string but got ".concat(typeof a,":"),a),new Error("GitHub service returned invalid content type: ".concat(typeof a));0===a.length&&console.warn("GitHubStorage.readFile: \u26a0\ufe0f Content string is empty for ".concat(e)),console.log("GitHubStorage.readFile: Converting string to browser-compatible Buffer...");const i=S.from(a,"utf-8");return console.log("GitHubStorage.readFile: \u2705 Buffer-like object created successfully, size: ".concat(i.length," bytes")),this.cache.set(t,i),console.log("GitHubStorage.readFile: \u2705 Successfully read file ".concat(e,", cached and returning content")),console.log("GitHubStorage.readFile: Content preview (first 200 chars):",a.substring(0,200)),i}catch(n){var s;throw console.error("GitHubStorage.readFile: \u274c Failed to read file ".concat(e,":"),n),console.error("GitHubStorage.readFile: Error details:",{message:n.message,name:n.name,stack:null===(s=n.stack)||void 0===s?void 0:s.substring(0,500)}),new Error("Failed to read file ".concat(e,": ").concat(n.message))}}async fileExists(e){try{console.log("GitHubStorage.fileExists: Checking if file exists: ".concat(e)),console.log("GitHubStorage.fileExists: Repository: ".concat(this.repository,", Branch: ").concat(this.branch));const{owner:t,repo:s}=this.parseRepository(this.repository);console.log("GitHubStorage.fileExists: Parsed repository - owner: ".concat(t,", repo: ").concat(s)),this.githubService&&this.githubService.isAuth?console.log("GitHubStorage.fileExists: Authentication status: ".concat(this.githubService.isAuth())):console.log("GitHubStorage.fileExists: GitHub service not available or no auth method"),console.log("GitHubStorage.fileExists: About to call readFile...");const n=await this.readFile(e);return console.log("GitHubStorage.fileExists: readFile completed successfully for ".concat(e,", content size: ").concat((null===n||void 0===n?void 0:n.length)||"undefined")),console.log("GitHubStorage.fileExists: File ".concat(e," exists - returning true")),!0}catch(s){var t;return console.error("GitHubStorage.fileExists: readFile failed for ".concat(e,":"),s.message),console.error("GitHubStorage.fileExists: Full error details:",{name:s.name,message:s.message,stack:null===(t=s.stack)||void 0===t?void 0:t.substring(0,300)}),console.log("GitHubStorage.fileExists: File ".concat(e," does not exist - returning false")),!1}}async listFiles(e){try{const{owner:t,repo:s}=this.parseRepository(this.repository),n=(await this.githubService.getRepositoryTree(t,s,this.branch,!0)).tree.filter(e=>"blob"===e.type).map(e=>e.path);if(e.includes("*")||e.includes("?")){const t=e.replace(/\./g,"\\.").replace(/\*/g,".*").replace(/\?/g,"."),s=new RegExp("^".concat(t,"$"));return n.filter(e=>s.test(e))}return n.filter(t=>t.startsWith(e))}catch(t){throw new Error("Failed to list files: ".concat(t.message))}}async getFileInfo(e){try{const{owner:t,repo:s}=this.parseRepository(this.repository),n=await this.githubService.getFileContent(t,s,e,this.branch);return{size:n.length||0,sha:n.sha||"unknown",path:e,type:"file",url:"https://github.com/".concat(t,"/").concat(s,"/blob/").concat(this.branch,"/").concat(e)}}catch(t){throw new Error("Failed to get file info for ".concat(e,": ").concat(t.message))}}}const q=new class{constructor(){this.questionRegistry=new Map,this.initialized=!1}async initialize(){if(!this.initialized)try{await this.loadQuestions(),this.initialized=!0}catch(e){throw new Error("Failed to initialize FAQ engine: ".concat(e.message))}}async loadQuestions(){const e=[{id:"dak-name",module:()=>s.e(399).then(s.bind(s,30399))},{id:"dak-version",module:()=>s.e(3714).then(s.bind(s,33714))},{id:"business-process-workflows",module:()=>s.e(7076).then(s.bind(s,97076))},{id:"decision-table-inputs",module:()=>s.e(5619).then(s.bind(s,85619))}];for(const s of e)try{const e=await s.module();e.metadata&&e.execute?this.questionRegistry.set(s.id,{metadata:e.metadata,execute:e.execute,Render:e.Render||null}):console.warn("Question ".concat(s.id," is missing required exports (metadata, execute)"))}catch(t){console.error("Failed to load question ".concat(s.id,":"),t)}}getCatalog(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.initialized)throw new Error("FAQ engine not initialized");let t=Array.from(this.questionRegistry.values()).map(e=>e.metadata);return e.level&&(t=t.filter(t=>t.level===e.level)),e.tags&&Array.isArray(e.tags)&&(t=t.filter(t=>e.tags.some(e=>t.tags.includes(e)))),e.componentType&&(t=t.filter(t=>!t.componentTypes||0===t.componentTypes.length||t.componentTypes.includes(e.componentType))),e.assetType&&(t=t.filter(t=>!t.assetTypes||0===t.assetTypes.length||t.assetTypes.includes(e.assetType))),t}async executeBatch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.initialized||await this.initialize();const s=[];for(const a of e)try{const e=await this.executeQuestion(a,t);s.push({questionId:a.questionId,success:!0,result:e})}catch(n){s.push({questionId:a.questionId,success:!1,error:n.message,result:new b.uC({structured:{},narrative:this.getErrorNarrative(a.locale||"en_US",n.message),errors:[n.message],meta:{}})})}return s}async executeQuestion(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{questionId:s,parameters:a={},assetFiles:i=[]}=e,o=this.questionRegistry.get(s);if(!o)throw new Error("Question not found: ".concat(s));if(o.metadata.isTemplate&&i.length>0)return await this.executeTemplateQuestion(o,e,t);const r=w.validateParameters(a,o.metadata.level,this.getQuestionType(o.metadata));if(!r.isValid)throw new Error("Parameter validation failed: ".concat(r.errors.join(", ")));const c=this.createStorage(r.normalized,t),l=new b.q_({repository:r.normalized.repository,locale:r.normalized.locale||"en_US",branch:r.normalized.branch||"main",user:t.user||null,assetFile:r.normalized.assetFile||null,componentType:r.normalized.componentType||null,storage:c}),d=(0,n.A)((0,n.A)({},r.normalized),{},{storage:c,context:l});return await o.execute(d)}async executeTemplateQuestion(e,t,s){const{parameters:a={},assetFiles:i=[]}=t,o=[],r=[],c=[];for(const h of i)try{const t=(0,n.A)((0,n.A)({},a),{},{assetFile:h}),i=w.validateParameters(t,e.metadata.level,this.getQuestionType(e.metadata));if(!i.isValid){c.push("Asset ".concat(h,": ").concat(i.errors.join(", ")));continue}const l=this.createStorage(i.normalized,s),d=new b.q_({repository:i.normalized.repository,locale:i.normalized.locale||"en_US",branch:i.normalized.branch||"main",user:s.user||null,assetFile:h,componentType:i.normalized.componentType||null,storage:l}),u=(0,n.A)((0,n.A)({},i.normalized),{},{storage:l,context:d}),m=await e.execute(u);o.push({assetFile:h,result:m}),m.warnings&&r.push(...m.warnings),m.errors&&c.push(...m.errors)}catch(u){c.push("Asset ".concat(h,": ").concat(u.message))}const l={assets:o.map(e=>(0,n.A)({assetFile:e.assetFile},e.result.structured)),summary:{totalAssets:i.length,successfulAssets:o.length,failedAssets:i.length-o.length}},d=this.aggregateNarratives(o,t.locale||"en_US");return new b.uC({structured:l,narrative:d,warnings:r,errors:c,meta:{isAggregated:!0,questionId:e.metadata.id,assetCount:i.length}})}createStorage(e,t){if(t.githubService)return new A(t.githubService,e.repository,e.branch||"main");throw new Error("Local storage not implemented in web context")}getQuestionType(e){return e.componentTypes&&e.componentTypes.length>0?e.componentTypes[0]:e.assetTypes&&e.assetTypes.length>0?e.assetTypes[0]:null}aggregateNarratives(e,t){if(0===e.length)return"<h4>No Results</h4><p>No assets were processed successfully.</p>";let s="<h4>Asset Analysis Results</h4>";s+="<p>Processed ".concat(e.length," asset(s):</p>"),s+="<ul>";for(const{assetFile:n,result:a}of e)s+="<li><strong>".concat(n,"</strong>"),a.errors&&a.errors.length>0?s+=' <span class="error">('.concat(a.errors.length," error(s))</span>"):a.warnings&&a.warnings.length>0?s+=' <span class="warning">('.concat(a.warnings.length," warning(s))</span>"):s+=' <span class="success">\u2713</span>',s+="</li>";return s+="</ul>",s}getErrorNarrative(e,t){const s={en_US:'<h4>Error</h4><p class="error">An error occurred while executing the question: '.concat(t,"</p>"),fr_FR:"<h4>Erreur</h4><p class=\"error\">Une erreur s'est produite lors de l'ex\xe9cution de la question: ".concat(t,"</p>"),es_ES:'<h4>Error</h4><p class="error">Ocurri\xf3 un error al ejecutar la pregunta: '.concat(t,"</p>")};return s[e]||s.en_US}normalizeLocale(e){if(!e)return"en_US";const t=e.replace("-","_");if(["en_US","fr_FR","es_ES","ar_AR","zh_CN","ru_RU"].includes(t))return t;return{en:"en_US",fr:"fr_FR",es:"es_ES",ar:"ar_AR",zh:"zh_CN",ru:"ru_RU"}[t.split("_")[0]]||"en_US"}};var C=s(7082);const z=e=>{let{repository:t,branch:s="main",githubService:n,filters:o={},className:r=""}=e;const{t:c,i18n:l}=(0,i.Bd)(),[d,h]=(0,a.useState)([]),[m,p]=(0,a.useState)(new Set),[g,f]=(0,a.useState)(new Map),[v,x]=(0,a.useState)(new Set),[b,y]=(0,a.useState)(!0),[j,w]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{y(!0),await q.initialize();const e=q.getCatalog(o);h(e),w(null)}catch(e){console.error("Failed to load FAQ questions:",e),w(e.message)}finally{y(!1)}})()},[o]);const N=async e=>{if(n&&t){x(t=>new Set(t).add(e));try{const a={questionId:e,parameters:{repository:t,branch:s,locale:l.language.replace("-","_")||"en_US"}},i={githubService:n},o=await q.executeQuestion(a,i);f(t=>new Map(t).set(e,o))}catch(a){console.error("Failed to execute question ".concat(e,":"),a),f(t=>new Map(t).set(e,{structured:{},narrative:'<p class="error">Error: '.concat(a.message,"</p>"),errors:[a.message],warnings:[],meta:{}}))}finally{x(t=>{const s=new Set(t);return s.delete(e),s})}}},S=e=>C.default.sanitize(e,{ALLOWED_TAGS:["h1","h2","h3","h4","h5","h6","p","div","span","ul","ol","li","strong","em","code","pre","time","small"],ALLOWED_ATTR:["class","datetime"]}),k=e=>{const t=g.get(e);return v.has(e)?(0,u.jsxs)("div",{className:"faq-answer loading",children:[(0,u.jsx)("div",{className:"faq-loading-spinner"}),(0,u.jsx)("p",{children:c("dak.faq.loading")})]}):t?t.errors&&t.errors.length>0?(0,u.jsxs)("div",{className:"faq-answer error",children:[(0,u.jsx)("div",{className:"faq-narrative",dangerouslySetInnerHTML:{__html:S(t.narrative||"")}}),(0,u.jsx)("div",{className:"faq-messages",children:t.errors.map((e,t)=>(0,u.jsxs)("div",{className:"faq-message faq-error",children:[(0,u.jsx)("span",{className:"faq-message-icon",children:"\u26a0\ufe0f"}),e]},"error-".concat(t)))}),(0,u.jsx)("button",{onClick:()=>(async e=>{f(t=>{const s=new Map(t);return s.delete(e),s}),await N(e)})(e),className:"faq-retry-button",children:c("dak.faq.retry")})]}):(0,u.jsxs)("div",{className:"faq-answer success",children:[(0,u.jsx)("div",{className:"faq-narrative",dangerouslySetInnerHTML:{__html:S(t.narrative||"")}}),t.warnings&&t.warnings.length>0&&(0,u.jsx)("div",{className:"faq-messages",children:t.warnings.map((e,t)=>(0,u.jsxs)("div",{className:"faq-message faq-warning",children:[(0,u.jsx)("span",{className:"faq-message-icon",children:"\u26a0\ufe0f"}),e]},"warning-".concat(t)))})]}):(0,u.jsx)("div",{className:"faq-answer empty",children:(0,u.jsx)("p",{children:c("dak.faq.no_data")})})};return b?(0,u.jsx)("div",{className:"faq-accordion loading ".concat(r),children:(0,u.jsxs)("div",{className:"faq-loading",children:[(0,u.jsx)("div",{className:"loading-spinner"}),(0,u.jsx)("p",{children:c("dak.faq.loading_questions")})]})}):j?(0,u.jsx)("div",{className:"faq-accordion error ".concat(r),children:(0,u.jsxs)("div",{className:"faq-error",children:[(0,u.jsx)("h4",{children:c("dak.faq.error_title")}),(0,u.jsx)("p",{children:j}),(0,u.jsx)("button",{onClick:()=>window.location.reload(),className:"btn-secondary",children:c("common.retry")})]})}):0===d.length?(0,u.jsx)("div",{className:"faq-accordion empty ".concat(r),children:(0,u.jsxs)("div",{className:"faq-empty",children:[(0,u.jsx)("h4",{children:c("dak.faq.no_questions_title")}),(0,u.jsx)("p",{children:c("dak.faq.no_questions_message")})]})}):(0,u.jsxs)("div",{className:"faq-accordion ".concat(r),children:[(0,u.jsxs)("div",{className:"faq-accordion-header",children:[(0,u.jsx)("h4",{children:c("dak.faq.available_questions",{count:d.length})}),(0,u.jsx)("p",{children:c("dak.faq.accordion_description")})]}),(0,u.jsx)("div",{className:"faq-accordion-list",children:d.map(e=>{const t=m.has(e.id),s=v.has(e.id);return(0,u.jsxs)("div",{className:"faq-accordion-item ".concat(t?"expanded":""," ").concat(s?"loading":""),children:[(0,u.jsxs)("button",{className:"faq-accordion-toggle",onClick:()=>(async e=>{const t=new Set(m);m.has(e)?t.delete(e):(t.add(e),g.has(e)||await N(e)),p(t)})(e.id),"aria-expanded":t,"aria-controls":"faq-content-".concat(e.id),children:[(0,u.jsxs)("div",{className:"faq-question-info",children:[(0,u.jsx)("h5",{className:"faq-question-title",children:e.title}),(0,u.jsx)("p",{className:"faq-question-description",children:e.description}),(0,u.jsxs)("div",{className:"faq-question-meta",children:[(0,u.jsx)("span",{className:"faq-level",children:e.level}),e.tags&&e.tags.slice(0,3).map(e=>(0,u.jsx)("span",{className:"faq-tag",children:e},e))]})]}),(0,u.jsx)("div",{className:"faq-accordion-icon",children:s?(0,u.jsx)("div",{className:"faq-loading-icon"}):(0,u.jsx)("span",{className:"faq-chevron ".concat(t?"rotated":""),children:"\u25bc"})})]}),t&&(0,u.jsx)("div",{id:"faq-content-".concat(e.id),className:"faq-accordion-content",children:k(e.id)})]},e.id)})})]})};var E=s(95388),T=s(15824);const _=()=>{var e;const{t:t}=(0,i.Bd)(),{profile:s,repository:l,branch:b,navigate:y,loading:j,error:w}=(0,v.N5)(),N={core:"components",publications:"publishing",faq:"dak-faq"},S={components:"core",publishing:"publications","dak-faq":"faq"},k=(0,d.A)("sgex-mascot.png"),[A,q]=(0,a.useState)(!1),[C,_]=(0,a.useState)(!1),[F,L]=(0,a.useState)(()=>{const e=window.location.hash.slice(1);return S[e]||"core"}),[M,P]=(0,a.useState)({}),[I,R]=(0,a.useState)(!1),[G,H]=(0,a.useState)(!1),[D,O]=(0,a.useState)(null),[B,U]=(0,a.useState)(!1),[Q,K]=(0,a.useState)(null);(0,a.useEffect)(()=>{const e=e=>{"Escape"===e.key&&G&&H(!1)};if(G)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[G]);const V=b,W=e=>{let{component:t,handleComponentClick:s,t:n,statusBadge:i,badgeIcon:o,badgeColor:r}=e;const[c,l]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1),p=(0,d.A)(t.cardImage);return(0,u.jsx)("div",{className:"component-card ".concat(t.type.toLowerCase()," large-card ").concat(c?"image-loaded":""),onClick:e=>s(e,t),style:{"--component-color":t.color},tabIndex:0,role:"button","aria-label":"".concat(t.name," - ").concat(t.description),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),s(e,t))},children:(0,u.jsxs)("div",{className:"component-main",children:[(0,u.jsxs)("div",{className:"component-header-content",children:[(0,u.jsx)("div",{className:"component-header",children:(0,u.jsxs)("div",{className:"component-image-container",children:[(0,u.jsx)("img",{src:p,alt:(0,E.lm)(n,E.ld.ICON_DAK_COMPONENT,t.name,{name:t.name}),className:"component-card-image",onLoad:()=>{l(!0),m(!1)},onError:()=>{m(!0),l(!1)},style:{display:h?"none":"block"}}),h&&(0,u.jsx)("div",{className:"component-icon",style:{color:t.color},children:t.icon}),i&&o&&(0,u.jsx)("div",{className:"component-status-badge",style:{backgroundColor:r||"#007bff"},title:i,children:(0,u.jsx)("span",{className:"badge-icon",children:o})})]})}),(0,u.jsxs)("div",{className:"component-content",children:[(0,u.jsx)("h4",{children:t.name}),(0,u.jsx)("p",{children:t.description})]})]}),(0,u.jsx)("div",{className:"component-meta-section",children:(0,u.jsxs)("div",{className:"component-meta",children:[(0,u.jsx)("div",{className:"file-types",children:t.fileTypes.map(e=>(0,u.jsx)("span",{className:"file-type-tag",children:e},e))}),(0,u.jsxs)("div",{className:"file-count",children:[t.count," files"]})]})})]})})},X=e=>{let{title:t,icon:s,children:n,defaultExpanded:i=!1,color:o="#007bff"}=e;const[r,c]=(0,a.useState)(i);return(0,u.jsxs)("div",{className:"status-bar ".concat(r?"expanded":"collapsed"),children:[(0,u.jsxs)("button",{className:"status-bar-header",onClick:()=>c(!r),style:{backgroundColor:o},type:"button","aria-expanded":r,children:[(0,u.jsxs)("div",{className:"status-bar-title",children:[(0,u.jsx)("span",{className:"status-bar-icon",children:s}),(0,u.jsx)("span",{className:"status-bar-text",children:t})]}),(0,u.jsx)("span",{className:"status-bar-chevron ".concat(r?"expanded":""),children:"\u25bc"})]}),r&&(0,u.jsx)("div",{className:"status-bar-content",children:n})]})};(0,a.useEffect)(()=>{if(l){if(r.default.getSelectedBranch(l));else{const e=l.default_branch||"main";r.default.setSelectedBranch(l,e)}}},[l]),(0,a.useEffect)(()=>{c.A.registerModalCallback(e=>{K(e),U(!0)})},[]);(0,a.useEffect)(()=>{l&&!j&&(async()=>{if(l)try{var e;const t=(null===(e=l.owner)||void 0===e?void 0:e.login)||l.full_name.split("/")[0],s=l.name,n=(await o.A.getIssues(t,s,{state:"all",per_page:100})).filter(e=>!e.pull_request),a=n.filter(e=>"open"===e.state).length,i=n.filter(e=>"closed"===e.state).length;P({total:n.length,open:a,closed:i})}catch(t){console.warn("Could not load issue counts:",t),P({total:0,open:0,closed:0})}})()},[l,j]),(0,a.useEffect)(()=>{(async()=>{if(l&&s)try{var e;const t=await o.A.checkRepositoryWritePermissions((null===(e=l.owner)||void 0===e?void 0:e.login)||l.full_name.split("/")[0],l.name);q(t)}catch(w){console.warn("Could not check write permissions:",w),q(!1)}})()},[l,s]),(0,a.useEffect)(()=>{const e=e=>{I&&!e.target.closest(".user-menu-container")&&R(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[I]),(0,a.useEffect)(()=>{if(!j&&!w&&s&&l){const e=N[F];e&&(window.location.hash=e)}},[F,N,j,w,s,l]),(0,a.useEffect)(()=>{if(!j&&!w&&s&&l){const e=()=>{const e=window.location.hash.slice(1),t=S[e];t&&t!==F&&L(t)};return window.addEventListener("hashchange",e),()=>window.removeEventListener("hashchange",e)}},[F,S,j,w,s,l]);const Y=[{id:"health-interventions",name:t("dak.healthInterventions"),description:"Clinical guidelines and health intervention specifications that define evidence-based care recommendations",icon:"\ud83d\udcd6",cardImage:"dashboard/dak_interventions.png",type:"L2",color:"#0078d4",fileTypes:["IRIS","Publication"],count:5,editor:"Publication reference manager with IRIS integration"},{id:"generic-personas",name:t("dak.genericPersonas"),description:"Standardized user roles and actor definitions that represent different types of healthcare workers and patients",icon:"\ud83d\udc65",cardImage:"dashboard/dak_personas.png",type:"L2",color:"#107c10",fileTypes:["Actor","Role"],count:8,editor:"Persona definition editor with role-based access specifications"},{id:"user-scenarios",name:t("dak.userScenarios"),description:"Narrative descriptions of how different personas interact with the system in specific healthcare contexts",icon:"\ud83d\udcdd",cardImage:"dashboard/dak_user_scenarios.png",type:"L2",color:"#881798",fileTypes:["Narrative","Use Case"],count:12,editor:"Scenario editor with workflow visualization"},{id:"business-processes",name:t("dak.businessProcesses"),description:"BPMN workflows and business process definitions that model clinical workflows and care pathways",icon:"\ud83d\udd04",cardImage:"dashboard/dak_business_processes.png",type:"L2",color:"#d13438",fileTypes:["BPMN","XML"],count:15,editor:"Graphical BPMN editor with SVG visualization"},{id:"core-data-elements",name:t("dak.coreDataElements"),description:"Essential data structures and terminology needed for clinical data capture and exchange (includes Terminology Services via OCL and Product Master Data via PCMT)",icon:"\ud83d\uddc3\ufe0f",cardImage:"dashboard/dak_core_data_elements.png",type:"L2",color:"#ff8c00",fileTypes:["OCL","Concept","PCMT","Product"],count:M.total||89,editor:"Data element editor with OCL and PCMT integration"},{id:"decision-support",name:t("dak.decisionSupportLogic"),description:"DMN decision tables and clinical decision support rules that encode clinical logic",icon:"\ud83c\udfaf",cardImage:"dashboard/dak_decision_support_logic.png",type:"L2",color:"#00bcf2",fileTypes:["DMN","XML"],count:24,editor:"DMN decision table editor with validation"},{id:"program-indicators",name:t("dak.programIndicators"),description:"Performance indicators and measurement definitions for monitoring and evaluation",icon:"\ud83d\udcca",cardImage:"dashboard/dak_indicators.png",type:"L2",color:"#498205",fileTypes:["Measure","Logic"],count:18,editor:"Indicator definition editor with measurement logic"},{id:"functional-requirements",name:t("dak.requirements"),description:"System requirements specifications that define capabilities and constraints",icon:"\u2699\ufe0f",cardImage:"dashboard/dak_requirements.png",type:"L2",color:"#6b69d6",fileTypes:["Requirements","Specification"],count:32,editor:"Requirements editor with structured templates"},{id:"test-scenarios",name:t("dak.testScenarios")||"Test Scenarios",description:"Feature files and test scenarios for validating the DAK implementation",icon:"\ud83e\uddea",cardImage:"dashboard/dak_testing.png",type:"L2",color:"#8b5cf6",fileTypes:["Feature","Test"],count:0,editor:"Testing viewer with feature file browser"}],$=(e,t)=>{var n;const a={profile:s,repository:l,component:t,selectedBranch:V};if("Tool"===t.type&&"publications"===F)return void J(t);if("Tool"===t.type&&"faq"===F)return void Z(t);if("decision-support"===t.id){var i;const t=(null===(i=l.owner)||void 0===i?void 0:i.login)||l.full_name.split("/")[0],s=l.name,n=V?"/decision-support-logic/".concat(t,"/").concat(s,"/").concat(V):"/decision-support-logic/".concat(t,"/").concat(s);return void(0,x.hX)(e,n,y,a)}if("business-processes"===t.id){var o;const t=(null===(o=l.owner)||void 0===o?void 0:o.login)||l.full_name.split("/")[0],s=l.name,n=V?"/business-process-selection/".concat(t,"/").concat(s,"/").concat(V):"/business-process-selection/".concat(t,"/").concat(s);return void(0,x.hX)(e,n,y,a)}if("health-interventions"===t.id){var r;const t=(null===(r=l.owner)||void 0===r?void 0:r.login)||l.full_name.split("/")[0],s=l.name,n=V?"/health-interventions/".concat(t,"/").concat(s,"/").concat(V):"/health-interventions/".concat(t,"/").concat(s);return void(0,x.hX)(e,n,y,a)}if("core-data-elements"===t.id){var c,d;const t=(null===s||void 0===s?void 0:s.login)||(null===l||void 0===l||null===(c=l.owner)||void 0===c?void 0:c.login)||(null===l||void 0===l||null===(d=l.full_name)||void 0===d?void 0:d.split("/")[0]),n=null===l||void 0===l?void 0:l.name,i=V,o=i?"/core-data-dictionary-viewer/".concat(t,"/").concat(n,"/").concat(i):"/core-data-dictionary-viewer/".concat(t,"/").concat(n);return void(0,x.hX)(e,o,y,a)}if("generic-personas"===t.id){var u;const t=(null===(u=l.owner)||void 0===u?void 0:u.login)||l.full_name.split("/")[0],s=l.name,n=V?"/actor-editor/".concat(t,"/").concat(s,"/").concat(V):"/actor-editor/".concat(t,"/").concat(s);return void(0,x.hX)(e,n,y,a)}if("test-scenarios"===t.id){var h;const t=(null===(h=l.owner)||void 0===h?void 0:h.login)||l.full_name.split("/")[0],s=l.name,n=V?"/testing-viewer/".concat(t,"/").concat(s,"/").concat(V):"/testing-viewer/".concat(t,"/").concat(s);return void(0,x.hX)(e,n,y,a)}if(!A)return void _(!0);const m=(null===(n=l.owner)||void 0===n?void 0:n.login)||l.full_name.split("/")[0],p=l.name,g=V?"/".concat(t.id,"/").concat(m,"/").concat(p,"/").concat(V):"/".concat(t.id,"/").concat(m,"/").concat(p);(0,x.hX)(e,g,y,a)},J=e=>{console.log("Publication tool clicked:",e.name)},Z=e=>{console.log("FAQ tool clicked:",e.name)};return j?(0,u.jsx)("div",{className:"dak-dashboard loading-state",children:(0,u.jsxs)("div",{className:"loading-content",children:[(0,u.jsx)("h2",{children:"Loading Dashboard..."}),(0,u.jsx)("p",{children:"Fetching repository and user data..."})]})}):w?(0,u.jsx)("div",{className:"dak-dashboard error-state",children:(0,u.jsxs)("div",{className:"error-content",children:[(0,u.jsx)("h2",{children:t("dashboard.errorLoading")}),(0,u.jsx)("p",{children:w}),(0,u.jsxs)("div",{className:"error-actions",children:[(0,u.jsx)("button",{onClick:()=>y("/"),className:"action-btn primary",children:t("navigation.home")}),(0,u.jsx)("button",{onClick:()=>window.location.reload(),className:"action-btn secondary",children:t("common.retry")})]})]})}):s&&l?(0,u.jsxs)("div",{className:"dak-dashboard",children:[(0,u.jsx)("div",{className:"dashboard-content",children:(0,u.jsxs)("div",{className:"dashboard-main",children:[(0,u.jsxs)("div",{className:"dashboard-intro",children:[(0,u.jsx)("h2",{children:t("dak.components")}),(0,u.jsxs)("p",{children:["Select a component to edit content for ",(0,u.jsx)("strong",{children:l.name}),V&&(0,u.jsxs)("span",{children:[" on branch ",(0,u.jsx)("code",{className:"branch-display",children:V})]}),". Components are organized according to the WHO SMART Guidelines framework."]})]}),(0,u.jsx)(g.A,{profile:s,repository:l,selectedBranch:V}),(0,u.jsxs)("div",{className:"tab-navigation-statusbar",children:[(0,u.jsxs)("button",{className:"tab-button-compact ".concat("core"===F?"active":""),onClick:()=>L("core"),children:[(0,u.jsx)("span",{className:"tab-icon",children:"\u2b50"}),(0,u.jsx)("span",{className:"tab-text",children:"9 Core Components"})]}),(0,u.jsxs)("button",{className:"tab-button-compact ".concat("publications"===F?"active":""),onClick:()=>L("publications"),children:[(0,u.jsx)("span",{className:"tab-icon",children:"\ud83d\udcda"}),(0,u.jsx)("span",{className:"tab-text",children:"Publishing"})]}),(0,u.jsxs)("button",{className:"tab-button-compact ".concat("faq"===F?"active":""),onClick:()=>L("faq"),children:[(0,u.jsx)("span",{className:"tab-icon",children:"\u2753"}),(0,u.jsx)("span",{className:"tab-text",children:"DAK FAQ"})]})]}),"core"===F&&(0,u.jsxs)("div",{className:"components-section active",children:[(0,u.jsxs)("div",{className:"section-header",children:[(0,u.jsx)("h3",{className:"section-title",children:t("dak.components")}),(0,u.jsx)("p",{className:"section-description",children:"Essential components that form the foundation of any WHO SMART Guidelines Digital Adaptation Kit"})]}),(0,u.jsx)("div",{className:"components-grid core-components",children:Y.map(e=>{const s=A?"\u270f\ufe0f":"\ud83d\udc41\ufe0f",n=A?"Edit":"View",a=A?"#28a745":"#007bff";return(0,u.jsx)(W,{component:e,handleComponentClick:$,t:t,statusBadge:n,badgeIcon:s,badgeColor:a},e.id)})})]}),"publications"===F&&(0,u.jsxs)("div",{className:"components-section publications-section active",children:[(0,u.jsxs)("div",{className:"section-header",children:[(0,u.jsx)("h3",{className:"section-title",children:"DAK Publication"}),(0,u.jsx)("p",{className:"section-description",children:"Generate WHO SMART Guidelines publications for each component with multiple output formats"})]}),(0,u.jsxs)("div",{className:"publication-status-bars",children:[(0,u.jsxs)(X,{title:"Repository Status",icon:"\ud83d\udcca",defaultExpanded:!1,color:"#0078d4",children:[l&&V&&(0,u.jsx)(m.A,{repository:l,selectedBranch:V,hasWriteAccess:A,profile:s}),(0,u.jsx)(p.A,{profile:s,repository:l,selectedBranch:V,hasWriteAccess:A})]}),(0,u.jsx)(X,{title:"Staging Ground",icon:"\ud83d\udcdd",defaultExpanded:!1,color:"#ff8c00",children:(0,u.jsxs)("div",{className:"staging-ground-content",children:[(0,u.jsx)("p",{children:"Changes made through DAK component editors are staged here before being committed to the repository. Review and commit your changes when ready."}),(0,u.jsxs)("div",{className:"staging-summary",children:[(0,u.jsxs)("div",{className:"staging-status",children:[(0,u.jsx)("span",{className:"status-indicator",children:"\ud83d\udd34"}),(0,u.jsx)("span",{className:"status-indicator",children:"\ud83d\udfe1"}),(0,u.jsx)("span",{className:"status-indicator",children:"\ud83d\udfe2"}),(0,u.jsx)("button",{className:"save-btn",disabled:!0,children:"\ud83d\udcbe Save Changes"})]}),(0,u.jsxs)("div",{className:"staging-files",children:[(0,u.jsx)("h4",{children:"\ud83d\udcc1 Changed Files"}),(0,u.jsx)("p",{children:"No changes in staging ground"}),(0,u.jsx)("p",{children:"Changes made through DAK component editors will appear here before being saved to the repository."})]})]})]})})]}),(0,u.jsx)("div",{className:"components-grid core-components",children:Y.map(e=>{const s=(0,n.A)((0,n.A)({},e),{},{description:"".concat(e.description," \u2022 DocBook \u2022 EPUB \u2022 HTML")});return(0,u.jsx)(W,{component:s,handleComponentClick:$,t:t,statusBadge:"Publish",badgeIcon:"\ud83d\udda8\ufe0f",badgeColor:"#107c10"},e.id)})})]}),"faq"===F&&(0,u.jsxs)("div",{className:"components-section faq-section active",children:[(0,u.jsxs)("div",{className:"section-header",children:[(0,u.jsx)("h3",{className:"section-title",children:"DAK FAQ"}),(0,u.jsx)("p",{className:"section-description",children:"Click on any component to view and ask questions specific to that DAK component"})]}),(0,u.jsx)("div",{className:"faq-status-bars",children:(0,u.jsx)(X,{title:"MCP Server API",icon:"\ud83d\udd0c",defaultExpanded:!1,color:"#6b69d6",children:(0,u.jsxs)("div",{className:"mcp-info",children:[(0,u.jsx)("h4",{children:"MCP Server API"}),"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("p",{children:"The FAQ system can also be accessed programmatically via the MCP server API:"}),(0,u.jsxs)("ul",{children:[(0,u.jsxs)("li",{children:[(0,u.jsx)("code",{children:"GET http://127.0.0.1:3001/faq/questions/catalog"})," - Get question catalog"]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("code",{children:"POST http://127.0.0.1:3001/faq/questions/execute"})," - Execute questions"]})]})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("p",{children:"For programmatic access to the FAQ system, you can install and run the MCP server locally:"}),(0,u.jsxs)("div",{style:{background:"#e9ecef",padding:"1rem",borderRadius:"4px",marginBottom:"1rem"},children:[(0,u.jsx)("h5",{children:"Installation Instructions:"}),(0,u.jsxs)("ol",{children:[(0,u.jsxs)("li",{children:["Clone the SGEX repository: ",(0,u.jsxs)("code",{children:["git clone ",T.A.getGitHubUrl(),".git"]})]}),(0,u.jsxs)("li",{children:["Navigate to repository: ",(0,u.jsx)("code",{children:"cd sgex"})]}),(0,u.jsxs)("li",{children:["Build MCP server: ",(0,u.jsx)("code",{children:"npm run build-mcp"})]}),(0,u.jsxs)("li",{children:["Start MCP server: ",(0,u.jsx)("code",{children:"npm run run-mcp"})]})]}),(0,u.jsxs)("p",{style:{margin:"0.5rem 0",fontSize:"0.9em",color:"#6c757d"},children:[(0,u.jsx)("strong",{children:"Alternative:"})," For manual setup, navigate to ",(0,u.jsx)("code",{children:"services/dak-faq-mcp"})," and run ",(0,u.jsx)("code",{children:"npm install && npm run build && npm start"})]})]}),(0,u.jsx)("p",{children:"Once running, the MCP server will be available at:"}),(0,u.jsxs)("ul",{children:[(0,u.jsxs)("li",{children:[(0,u.jsx)("code",{children:"GET http://127.0.0.1:3001/faq/questions/catalog"})," - Get question catalog"]}),(0,u.jsxs)("li",{children:[(0,u.jsx)("code",{children:"POST http://127.0.0.1:3001/faq/questions/execute"})," - Execute questions"]})]}),(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:"Note:"})," The MCP server runs locally for security and provides full API access to the DAK FAQ system."]})]})]})})}),(0,u.jsx)("div",{className:"components-grid core-components",children:Y.map(e=>(0,u.jsx)(W,{component:e,handleComponentClick:(e,t)=>((e,t)=>{O(t),H(!0)})(0,t),t:t,statusBadge:"Ask",badgeIcon:"\u2753",badgeColor:"#8b5cf6"},e.id))})]})]})}),C&&(0,u.jsx)("div",{className:"permission-dialog-overlay",children:(0,u.jsxs)("div",{className:"permission-dialog",children:[(0,u.jsxs)("div",{className:"dialog-header",children:[(0,u.jsx)("h3",{children:"Edit Access Required"}),(0,u.jsx)("button",{className:"dialog-close",onClick:()=>_(!1),children:"\xd7"})]}),(0,u.jsxs)("div",{className:"dialog-content",children:[(0,u.jsxs)("div",{className:"dialog-mascot",children:[(0,u.jsx)("img",{src:k,alt:(0,E.lm)(t,E.ld.MASCOT_HELPER,"SGEX Helper"),className:"dialog-mascot-img"}),(0,u.jsxs)("div",{className:"mascot-message",children:[(0,u.jsx)("p",{children:"You need edit permissions to modify DAK components!"}),(0,u.jsx)("p",{children:"Your current token only provides read access to this repository."})]})]}),(0,u.jsxs)("div",{className:"permission-options",children:[(0,u.jsxs)("div",{className:"option-card",children:[(0,u.jsx)("h4",{children:"\ud83d\udd27 Upgrade Your Token"}),(0,u.jsx)("p",{children:"Create a new fine-grained token with write permissions for this repository."}),(0,u.jsxs)("div",{className:"option-buttons",children:[(0,u.jsx)("a",{href:"https://github.com/settings/personal-access-tokens/new",target:"_blank",rel:"noopener noreferrer",className:"btn-primary",children:"Create New Token"}),(0,u.jsx)(h,{helpTopic:"github-token",contextData:{repository:{owner:(null===(e=l.owner)||void 0===e?void 0:e.login)||l.full_name.split("/")[0],name:l.name},requiredScopes:["Contents: Write","Metadata: Read","Pull requests: Write"],permissionMode:"edit",upgradeMode:!0}})]})]}),(0,u.jsxs)("div",{className:"option-card",children:[(0,u.jsx)("h4",{children:"\ud83d\udc41\ufe0f Continue in Read-Only Mode"}),(0,u.jsx)("p",{children:"Browse and view DAK components without editing capabilities."}),(0,u.jsx)("button",{className:"btn-secondary",onClick:()=>_(!1),children:"Continue Read-Only"})]})]})]})]})}),G&&D&&(0,u.jsx)("div",{className:"faq-modal-overlay",onClick:e=>{e.target===e.currentTarget&&H(!1)},role:"presentation",children:(0,u.jsxs)("div",{className:"faq-modal",role:"dialog","aria-modal":"true",tabIndex:-1,children:[(0,u.jsxs)("div",{className:"faq-modal-header",children:[(0,u.jsxs)("h3",{children:["\u2753 FAQ: ",D.name]}),(0,u.jsx)("button",{className:"modal-close-btn",onClick:()=>H(!1),"aria-label":"Close modal",children:"\xd7"})]}),(0,u.jsxs)("div",{className:"faq-modal-content",children:[(0,u.jsxs)("p",{children:["Questions specific to ",(0,u.jsx)("strong",{children:D.name})]}),(0,u.jsx)(z,{repository:"".concat(null===s||void 0===s?void 0:s.login,"/").concat(null===l||void 0===l?void 0:l.name),branch:V||"main",githubService:o.A,filters:{level:"component",component:D.id},className:"component-faq-accordion"})]})]})}),(0,u.jsx)(f.A,{isOpen:B,onClose:()=>{U(!1),K(null)},samlInfo:Q})]}):(y("/"),(0,u.jsx)("div",{children:"Redirecting..."}))},F=()=>(0,u.jsx)(v.Mx,{pageName:"dak-dashboard",children:(0,u.jsx)(_,{})})},49162:(e,t,s)=>{s.d(t,{Q5:()=>a,hI:()=>i,kv:()=>c,q_:()=>o,uC:()=>r,x:()=>n});const n={DAK:"dak",COMPONENT:"component",ASSET:"asset"};class a{constructor(e){let{id:t,level:s,title:n,description:a,parameters:i=[],tags:o=[],version:r="1.0.0",isTemplate:c=!1,componentTypes:l=[],assetTypes:d=[]}=e;this.id=t,this.level=s,this.title=n,this.description=a,this.parameters=i,this.tags=o,this.version=r,this.isTemplate=c,this.componentTypes=l,this.assetTypes=d}}class i{constructor(e){let{name:t,type:s="string",required:n=!1,description:a="",defaultValue:i=null,validation:o={}}=e;this.name=t,this.type=s,this.required=n,this.description=a,this.defaultValue=i,this.validation=o}}class o{constructor(e){let{repository:t,locale:s="en_US",branch:n="main",user:a=null,assetFile:i=null,componentType:o=null,storage:r=null}=e;this.repository=t,this.locale=s,this.branch=n,this.user=a,this.assetFile=i,this.componentType=o,this.storage=r}}class r{constructor(e){let{structured:t={},narrative:s="",warnings:n=[],errors:a=[],meta:i={}}=e;this.structured=t,this.narrative=s,this.warnings=n,this.errors=a,this.meta=i}}class c{constructor(e){let{scope:t="repository",key:s="",ttl:n=3600,dependencies:a=[]}=e;this.scope=t,this.key=s,this.ttl=n,this.dependencies=a}}},53155:(e,t,s)=>{s.d(t,{A:()=>c});var n=s(9950),a=s(85571),i=s(36241),o=s(78952),r=s(44414);const c=e=>{let{isOpen:t,onClose:s,samlInfo:c,onAuthorizationComplete:l,pollingInterval:d=3e3,pollingTimeout:u=3e5}=e;const h=a.A.getLogger("SAMLAuthModal"),[m,p]=(0,n.useState)(!1),[g,f]=(0,n.useState)(null),[v,x]=(0,n.useState)(null),b=(0,n.useRef)(null),y=(0,n.useRef)(null),j=(0,n.useRef)(null);(0,n.useEffect)(()=>{t&&null!==c&&void 0!==c&&c.originalRequest&&(j.current=c.originalRequest)},[t,c]);const w=(0,n.useCallback)(async()=>{if(null===c||void 0===c||!c.organization)return!1;try{if(h.debug("Checking SAML authorization status",{organization:c.organization,repository:c.repository}),j.current)try{return await j.current(),h.info("SAML authorization successful - original request succeeded",{organization:c.organization}),!0}catch(t){var e;return(403!==t.status||null===(e=t.message)||void 0===e||!e.toLowerCase().includes("saml"))&&(h.warn("Original request failed with non-SAML error",{organization:c.organization,error:t.message}),!0)}return!1}catch(t){return h.error("Error checking SAML status",{organization:c.organization,error:t.message}),!1}},[c,h]),N=(0,n.useCallback)(()=>{b.current&&(clearInterval(b.current),b.current=null,p(!1),f(null),y.current=null,h.debug("Polling stopped",{organization:null===c||void 0===c?void 0:c.organization}))},[c,h]),S=(0,n.useCallback)(()=>{!m&&null!==c&&void 0!==c&&c.organization&&(p(!0),y.current=Date.now(),f("Waiting for authorization..."),h.info("Started polling for SAML authorization",{organization:c.organization,pollingInterval:d,pollingTimeout:u}),i.A.isAvailable()&&i.A.broadcast(i.B.SAML_POLLING_STARTED,{organization:c.organization,timestamp:Date.now()}),b.current=setInterval(async()=>{const e=Date.now()-y.current;if(e>u)return h.warn("SAML polling timeout reached",{organization:c.organization,elapsedTime:e,timeout:u}),f("Authorization check timed out. Please try again."),void N();await w()?(h.info("SAML authorization detected",{organization:c.organization,elapsedTime:e}),o.A.markSAMLAuthorized(c.organization,c.repository),l&&l({organization:c.organization,repository:c.repository}),f("Authorization successful!"),setTimeout(()=>{N(),s()},1e3)):h.debug("SAML authorization not yet complete",{organization:c.organization,elapsedTime:e})},d))},[m,c,d,u,w,N,l,s,h]);if((0,n.useEffect)(()=>{if(!t||null===c||void 0===c||!c.organization)return;return i.A.on(i.B.SAML_AUTHENTICATED,e=>{e.organization===c.organization&&(h.debug("SAML authentication detected from another tab",{organization:e.organization}),N(),s())})},[t,c,N,s,h]),(0,n.useEffect)(()=>{t||(N(),v&&!v.closed&&h.debug("Closing SSO window",{organization:null===c||void 0===c?void 0:c.organization}))},[t,v,c,N,h]),(0,n.useEffect)(()=>(t&&c&&h.componentMount({organization:c.organization,repository:c.repository}),()=>{t&&(N(),h.componentUnmount())}),[h,t,c,N]),!t||!c)return null;const{organization:k,repository:A,authorizationUrl:q}=c,C=()=>{h.userAction("SAML modal closed",{organization:k}),N(),s()};return(0,r.jsx)("div",{className:"saml-modal-overlay",onClick:C,onKeyDown:e=>"Escape"===e.key&&C(),role:"dialog","aria-modal":"true","aria-labelledby":"saml-modal-title",tabIndex:-1,children:(0,r.jsxs)("div",{className:"saml-modal",onClick:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),role:"document",children:[(0,r.jsxs)("div",{className:"saml-modal-header",children:[(0,r.jsx)("h2",{id:"saml-modal-title",children:"\ud83d\udd10 SAML SSO Authorization Required"}),(0,r.jsx)("button",{onClick:C,className:"close-button","aria-label":"Close",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"saml-modal-content",children:[(0,r.jsxs)("div",{className:"saml-info-section",children:[(0,r.jsx)("div",{className:"saml-icon",children:(0,r.jsx)("span",{role:"img","aria-label":"lock",children:"\ud83d\udd12"})}),(0,r.jsx)("h3",{children:"Organization Access Required"}),(0,r.jsxs)("p",{className:"saml-description",children:["Your Personal Access Token needs SAML SSO authorization to access the"," ",(0,r.jsx)("strong",{children:k})," organization",A?" and the ".concat(A," repository"):"","."]})]}),(0,r.jsxs)("div",{className:"saml-steps-section",children:[(0,r.jsx)("h4",{children:"How to authorize your token:"}),(0,r.jsxs)("ol",{className:"saml-steps",children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:'Click "Authorize on GitHub"'})," below to open the authorization page"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"Review the permissions"})," requested by the organization"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:'Click "Authorize"'})," to grant your token access"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"This modal will automatically detect"})," when authorization is complete"]})]})]}),m&&(0,r.jsxs)("div",{className:"saml-polling-status",children:[(0,r.jsx)("span",{className:"polling-spinner",children:"\u23f3"}),(0,r.jsx)("p",{children:g})]}),(0,r.jsxs)("div",{className:"saml-note",children:[(0,r.jsx)("span",{className:"note-icon",children:"\u2139\ufe0f"}),(0,r.jsxs)("p",{children:["This is a GitHub security feature for organizations using SAML SSO. You only need to authorize once per organization per token.",!m&&' Click "Later" to dismiss for 1 minute.']})]}),(0,r.jsx)("div",{className:"saml-modal-actions",children:m?(0,r.jsx)("button",{onClick:C,className:"saml-cancel-btn",children:"Cancel"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{h.userAction("Authorize SAML clicked",{organization:k,authorizationUrl:q});const e=window.open(q,"_blank","noopener,noreferrer");x(e),h.info("SAML authorization page opened",{organization:k,instruction:"Polling will check for authorization completion"}),S()},className:"saml-authorize-btn",children:"\ud83d\udd13 Authorize on GitHub"}),(0,r.jsx)("button",{onClick:()=>{h.userAction('SAML modal "Later" clicked',{organization:k}),N(),o.A.clearCooldown(k),s()},className:"saml-cancel-btn",children:"Later"})]})})]})]})})}}}]);