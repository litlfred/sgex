"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[8130],{27458:(e,a,n)=>{n.r(a),n.d(a,{default:()=>p});var s=n(89379),t=n(9950),i=n(18518),o=n(67818),l=n(46901),r=n(29473),c=(n(78723),n(78952)),d=n(37210),h=n(53155),u=n(53782),g=n(1932),m=n(44414);const p=()=>{const{t:e}=(0,o.Bd)(),[a,n]=(0,t.useState)(null),[p,x]=(0,t.useState)([]),[j,f]=(0,t.useState)(!1),[v,N]=(0,t.useState)(!1),[A,k]=(0,t.useState)(null),[b,w]=(0,t.useState)({}),[y,O]=(0,t.useState)(null),[T,P]=(0,t.useState)(!1),[z,S]=(0,t.useState)(null),C=(0,i.Zp)(),W=(0,i.zy)(),H=(0,t.useCallback)((e,a)=>{if(!l.A.isAuth())return;const n={};if(e){const a=r.A.getCachedRepositories(e.login,"user");a&&a.repositories&&(n["user-".concat(e.login)]=a.repositories.length)}a.forEach(e=>{const a=r.A.getCachedRepositories(e.login,"org");a&&a.repositories&&(n["org-".concat(e.login)]=a.repositories.length)}),w(n)},[]),E=(0,t.useCallback)(async()=>{N(!0),k(null);try{await l.A.checkTokenPermissions();const a=await l.A.getCurrentUser();n(a);let t=[];if(l.A.isAuth())try{t=await l.A.getUserOrganizations()}catch(A){console.error("Error fetching organizations:",A),t=[]}try{const e=await l.A.getWHOOrganization(),a=t.findIndex(e=>"WorldHealthOrganization"===e.login);a>=0?t[a]=(0,s.A)((0,s.A)((0,s.A)({},t[a]),e),{},{isWHO:!0}):t.unshift(e)}catch(e){console.warn("Could not fetch WHO organization data, using fallback:",e);const a={id:"who-organization",login:"WorldHealthOrganization",name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",isWHO:!0};t.some(e=>"WorldHealthOrganization"===e.login)?t=t.map(e=>"WorldHealthOrganization"===e.login?(0,s.A)((0,s.A)({},e),{},{isWHO:!0}):e):t.unshift(a)}x(t),H(a,t)}catch(A){console.error("Error fetching user data:",A),k("Failed to fetch user data. Please check your connection and try again."),f(!1),l.A.logout()}finally{N(!1)}},[H]);(0,t.useEffect)(()=>{l.A.initializeFromStoredToken()&&f(!0)},[]),(0,t.useEffect)(()=>{c.A.registerModalCallback(e=>{S(e),P(!0)})},[]),(0,t.useEffect)(()=>{var e;null!==(e=W.state)&&void 0!==e&&e.warningMessage&&(O(W.state.warningMessage),C(W.pathname,{replace:!0,state:{}}))},[W.state,C,W.pathname]),(0,t.useEffect)(()=>{j&&!a&&E()},[j,a,E]);const D=(e,a)=>{l.A.authenticateWithOctokit(a),l.A.authenticate(e),f(!0),k(null),E()},_=(e,a)=>{const n={profile:a};(0,g.hX)(e,"/dak-action/".concat(a.login),C,n)},M=e=>{const a={login:"demo-user",name:"Demo User",avatar_url:"https://github.com/github.png",type:"User",isDemo:!0},n={profile:a,action:"edit"};(0,g.hX)(e,"/dak-selection/".concat(a.login),C,n)},U=()=>{O(null)};return j?(0,m.jsxs)(u.Mx,{pageName:"landing-authenticated",children:[(0,m.jsxs)("div",{className:"landing-content",children:[y&&(0,m.jsx)("div",{className:"warning-message",children:(0,m.jsxs)("div",{className:"warning-content",children:[(0,m.jsx)("span",{className:"warning-icon",children:"\u26a0\ufe0f"}),(0,m.jsx)("span",{className:"warning-text",children:y}),(0,m.jsx)("button",{className:"warning-dismiss",onClick:U,"aria-label":"Dismiss warning",children:"\xd7"})]})}),v?(0,m.jsxs)("div",{className:"loading-section",children:[(0,m.jsx)("div",{className:"spinner"}),(0,m.jsx)("p",{children:"Loading profile data..."})]}):(0,m.jsxs)("div",{className:"profile-selection",children:[(0,m.jsx)("h2",{children:e("organization.select")}),(0,m.jsxs)("p",{children:[e("organization.personal"),":"]}),A&&(0,m.jsx)("div",{className:"error-message",children:A}),(0,m.jsxs)("div",{className:"profile-grid",children:[(0,m.jsxs)("div",{className:"profile-card",onClick:e=>_(e,(0,s.A)({type:"user"},a)),children:[(0,m.jsxs)("div",{className:"profile-card-header",children:[(0,m.jsx)("img",{src:null===a||void 0===a?void 0:a.avatar_url,alt:"Personal profile"}),b["user-".concat(null===a||void 0===a?void 0:a.login)]>0&&(0,m.jsx)("div",{className:"dak-count-badge",children:b["user-".concat(null===a||void 0===a?void 0:a.login)]})]}),(0,m.jsx)("h3",{children:(null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.login)}),(0,m.jsx)("p",{children:"Personal repositories"}),(0,m.jsx)("div",{className:"profile-badges",children:(0,m.jsx)("span",{className:"profile-type",children:"Personal"})})]}),p.map(a=>(0,m.jsxs)("div",{className:"profile-card ".concat(a.isWHO?"who-org":""),onClick:e=>_(e,(0,s.A)({type:"org"},a)),children:[(0,m.jsxs)("div",{className:"profile-card-header",children:[(0,m.jsx)("img",{src:a.avatar_url||"https://github.com/".concat(a.login,".png"),alt:"".concat(a.name||a.login," organization")}),b["org-".concat(a.login)]>0&&(0,m.jsx)("div",{className:"dak-count-badge",children:b["org-".concat(a.login)]})]}),(0,m.jsx)("h3",{children:a.name||a.login}),(0,m.jsxs)("p",{children:["@",a.login]}),(0,m.jsxs)("div",{className:"profile-badges",children:[(0,m.jsx)("span",{className:"profile-type",children:e("organization.organizations")}),a.isWHO&&(0,m.jsx)("span",{className:"who-badge",children:"WHO Official"})]})]},a.login))]})]})]}),(0,m.jsx)(h.A,{isOpen:T,onClose:()=>{P(!1),S(null)},samlInfo:z})]}):(0,m.jsx)(u.Mx,{pageName:"landing-unauthenticated",children:(0,m.jsxs)("div",{className:"landing-content",children:[y&&(0,m.jsx)("div",{className:"warning-message",children:(0,m.jsxs)("div",{className:"warning-content",children:[(0,m.jsx)("span",{className:"warning-icon",children:"\u26a0\ufe0f"}),(0,m.jsx)("span",{className:"warning-text",children:y}),(0,m.jsx)("button",{className:"warning-dismiss",onClick:U,"aria-label":"Dismiss warning",children:"\xd7"})]})}),(0,m.jsxs)("div",{className:"welcome-section",children:[(0,m.jsx)("h2",{children:e("landing.welcome")}),(0,m.jsx)("p",{children:e("app.description")}),(0,m.jsxs)("div",{className:"auth-section",children:[(0,m.jsxs)("p",{children:[e("auth.signInWithPAT"),":"]}),(0,m.jsx)(d.A,{onAuthSuccess:D}),A&&(0,m.jsx)("div",{className:"error-message",children:A})]}),(0,m.jsxs)("div",{className:"demo-section",children:[(0,m.jsx)("p",{children:"Want to try without authentication?"}),(0,m.jsx)("button",{onClick:M,className:"demo-mode-btn",children:"\ud83c\udfad Try Demo Mode"}),(0,m.jsx)("p",{className:"demo-note",children:"Demo mode showcases the enhanced DAK scanning display with mock data."})]}),(0,m.jsx)("div",{className:"info-section",children:(0,m.jsx)("p",{children:"Need help getting started? Use the help mascot (bottom-right corner) to access comprehensive documentation and learn more about SGEX Workbench and DAK components."})})]})]})})}},37210:(e,a,n)=>{n.d(a,{A:()=>l});var s=n(9950),t=n(67818),i=n(85571),o=n(44414);const l=e=>{let{onAuthSuccess:a}=e;const{t:l}=(0,t.Bd)(),[r,c]=(0,s.useState)(""),[d,h]=(0,s.useState)(""),[u,g]=(0,s.useState)(""),[m,p]=(0,s.useState)(!1),x=i.A.getLogger("PATLogin");s.useEffect(()=>(x.componentMount({hasOnAuthSuccess:!!a}),()=>x.componentUnmount()),[x,a]);return(0,o.jsx)("div",{className:"pat-login",children:(0,o.jsxs)("div",{className:"pat-login-section",children:[(0,o.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),x.userAction("PAT login attempt",{tokenProvided:!!r.trim()}),!r.trim()){return g("Please enter a GitHub Personal Access Token"),void x.warn("PAT login failed - no token provided")}p(!0),g("");const s=Date.now();x.auth("Starting PAT authentication");try{const{Octokit:e}=await n.e(112).then(n.bind(n,10112)),t=new e({auth:r.trim()});x.debug("Octokit instance created for PAT validation"),x.apiCall("GET","/user",null);const i=await t.rest.users.getAuthenticated(),o=Date.now()-s;x.apiResponse("GET","/user",i.status,o),x.auth("PAT authentication successful",{username:i.data.login,duration:o}),a(r.trim(),t)}catch(t){const e=Date.now()-s;x.apiError("GET","/user",t),x.auth("PAT authentication failed",{status:t.status,message:t.message,duration:e}),console.error("PAT authentication failed:",t),401===t.status?g("Invalid Personal Access Token. Please check your token and try again."):403===t.status?g("Token doesn't have sufficient permissions. Please ensure your token has 'repo' and 'read:org' scopes."):g("Authentication failed. Please check your connection and try again.")}finally{p(!1)}},className:"pat-form",children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"token-name",children:"Token Name (optional):"}),(0,o.jsx)("input",{id:"token-name",type:"text",value:d,onChange:e=>{h(e.target.value),u&&g("")},placeholder:"e.g., SGEX Access Token",className:"token-name-input",disabled:m,autoComplete:"username"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsxs)("label",{htmlFor:"pat-token",children:[l("auth.setupToken"),":"]}),(0,o.jsx)("input",{id:"pat-token",type:"password",value:r,onChange:e=>{c(e.target.value),u&&g("")},placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx",className:"token-input ".concat(u?"error":""),disabled:m,autoComplete:"current-password"})]}),(0,o.jsx)("button",{type:"submit",className:"github-login-btn",disabled:m||!r.trim(),children:m?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"spinner small"}),l("common.loading"),"..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"github-icon",children:"\ud83d\udd11"}),l("auth.signInWithPAT")]})})]}),u&&(0,o.jsx)("div",{className:"error-message",children:u})]})})}}}]);