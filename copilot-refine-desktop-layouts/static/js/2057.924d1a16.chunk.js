"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[2057],{3611:function(e,i,n){var s=this&&this.__createBinding||(Object.create?function(e,i,n,s){void 0===s&&(s=n);var t=Object.getOwnPropertyDescriptor(i,n);t&&!("get"in t?!i.__esModule:t.writable||t.configurable)||(t={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(e,s,t)}:function(e,i,n,s){void 0===s&&(s=n),e[s]=i[n]}),t=this&&this.__exportStar||function(e,i){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||s(i,e,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.decisionTableCore=i.DecisionTableCore=i.questionnaireDefinitionCore=i.QuestionnaireDefinitionCore=i.actorDefinitionCore=i.ActorDefinitionCore=void 0,t(n(62600),i),t(n(9646),i);var r=n(64738);Object.defineProperty(i,"ActorDefinitionCore",{enumerable:!0,get:function(){return r.ActorDefinitionCore}}),Object.defineProperty(i,"actorDefinitionCore",{enumerable:!0,get:function(){return r.actorDefinitionCore}});var a=n(84198);Object.defineProperty(i,"QuestionnaireDefinitionCore",{enumerable:!0,get:function(){return a.QuestionnaireDefinitionCore}}),Object.defineProperty(i,"questionnaireDefinitionCore",{enumerable:!0,get:function(){return a.questionnaireDefinitionCore}});var o=n(34708);Object.defineProperty(i,"DecisionTableCore",{enumerable:!0,get:function(){return o.DecisionTableCore}}),Object.defineProperty(i,"decisionTableCore",{enumerable:!0,get:function(){return o.decisionTableCore}})},12057:(e,i,n)=>{n.r(i),n.d(i,{default:()=>x});var s=n(89379),t=n(9950),r=n(53782),a=n(50490),o=n(46901),l=n(3611),d=n(44414);const c=e=>{var i,n,r;let{questionnaire:a,onChange:o}=e;const[l,c]=(0,t.useState)(!1);(0,t.useEffect)(()=>{(async()=>{try{console.log("LForms initialization skipped - using fallback editor")}catch(e){console.log("LForms not available, using fallback editor")}})()},[]);const u=(e,i,n)=>{if(!a.item)return;const t=[...a.item];t[e]=(0,s.A)((0,s.A)({},t[e]),{},{[i]:n});const r=(0,s.A)((0,s.A)({},a),{},{item:t});o(r)},h=(e,i)=>{const n=(0,s.A)((0,s.A)({},a),{},{[e]:i});o(n)};return(0,d.jsxs)("div",{className:"lforms-visual-editor",children:[(0,d.jsxs)("div",{className:"editor-modes",children:[(0,d.jsx)("button",{className:"mode-toggle ".concat(l?"":"active"),onClick:()=>c(!1),children:"\ud83d\udd27 Build Mode"}),(0,d.jsx)("button",{className:"mode-toggle ".concat(l?"active":""),onClick:()=>c(!0),children:"\ud83d\udc41\ufe0f Preview Mode"})]}),l?(0,d.jsxs)("div",{className:"lforms-preview",children:[(0,d.jsx)("h5",{children:"Live Preview"}),(0,d.jsxs)("div",{className:"simple-questionnaire-preview",children:[(0,d.jsxs)("div",{className:"preview-header",children:[(0,d.jsx)("h3",{children:a.title||"Untitled Questionnaire"}),(0,d.jsx)("p",{children:a.description||"No description provided"})]}),(0,d.jsx)("div",{className:"preview-questions",children:(null===(i=a.item)||void 0===i?void 0:i.map((e,i)=>(0,d.jsxs)("div",{className:"preview-question",children:[(0,d.jsxs)("label",{className:"preview-question-label",children:[i+1,". ",e.text,e.required&&(0,d.jsx)("span",{className:"required-asterisk",children:" *"})]}),"string"===e.type&&(0,d.jsx)("input",{type:"text",placeholder:"Text answer",disabled:!0}),"text"===e.type&&(0,d.jsx)("textarea",{placeholder:"Long text answer",disabled:!0,rows:3}),"boolean"===e.type&&(0,d.jsxs)("div",{className:"preview-boolean",children:[(0,d.jsxs)("label",{children:[(0,d.jsx)("input",{type:"radio",disabled:!0})," Yes"]}),(0,d.jsxs)("label",{children:[(0,d.jsx)("input",{type:"radio",disabled:!0})," No"]})]}),"decimal"===e.type&&(0,d.jsx)("input",{type:"number",step:"0.01",placeholder:"Number",disabled:!0}),"integer"===e.type&&(0,d.jsx)("input",{type:"number",step:"1",placeholder:"Integer",disabled:!0}),"date"===e.type&&(0,d.jsx)("input",{type:"date",disabled:!0}),"choice"===e.type&&(0,d.jsx)("select",{disabled:!0,children:(0,d.jsx)("option",{children:"Select an option..."})})]},e.linkId)))||(0,d.jsx)("p",{className:"no-questions-preview",children:"No questions added yet."})})]})]}):(0,d.jsxs)("div",{className:"lforms-builder",children:[(0,d.jsxs)("div",{className:"questionnaire-metadata-editor",children:[(0,d.jsx)("h5",{children:"Questionnaire Details"}),(0,d.jsxs)("div",{className:"metadata-grid",children:[(0,d.jsxs)("div",{className:"field-group",children:[(0,d.jsx)("label",{htmlFor:"questionnaire-title",children:"Title:"}),(0,d.jsx)("input",{id:"questionnaire-title",type:"text",value:a.title||"",onChange:e=>h("title",e.target.value),placeholder:"Enter questionnaire title"})]}),(0,d.jsxs)("div",{className:"field-group",children:[(0,d.jsx)("label",{htmlFor:"questionnaire-name",children:"Name:"}),(0,d.jsx)("input",{id:"questionnaire-name",type:"text",value:a.name||"",onChange:e=>h("name",e.target.value),placeholder:"Enter questionnaire name"})]}),(0,d.jsxs)("div",{className:"field-group",children:[(0,d.jsx)("label",{htmlFor:"questionnaire-status",children:"Status:"}),(0,d.jsxs)("select",{id:"questionnaire-status",value:a.status||"draft",onChange:e=>h("status",e.target.value),children:[(0,d.jsx)("option",{value:"draft",children:"Draft"}),(0,d.jsx)("option",{value:"active",children:"Active"}),(0,d.jsx)("option",{value:"retired",children:"Retired"})]})]}),(0,d.jsxs)("div",{className:"field-group",children:[(0,d.jsx)("label",{htmlFor:"questionnaire-publisher",children:"Publisher:"}),(0,d.jsx)("input",{id:"questionnaire-publisher",type:"text",value:a.publisher||"",onChange:e=>h("publisher",e.target.value),placeholder:"Enter publisher"})]})]}),(0,d.jsxs)("div",{className:"field-group",children:[(0,d.jsx)("label",{htmlFor:"questionnaire-description",children:"Description:"}),(0,d.jsx)("textarea",{id:"questionnaire-description",value:a.description||"",onChange:e=>h("description",e.target.value),placeholder:"Enter questionnaire description",rows:3})]})]}),(0,d.jsxs)("div",{className:"questions-builder",children:[(0,d.jsxs)("div",{className:"questions-header",children:[(0,d.jsxs)("h5",{children:["Questions (",(null===(n=a.item)||void 0===n?void 0:n.length)||0,")"]}),(0,d.jsx)("button",{onClick:()=>{var e;const i={linkId:"item-".concat(Date.now()),text:"New Question ".concat(((null===(e=a.item)||void 0===e?void 0:e.length)||0)+1),type:"string",required:!1},n=(0,s.A)((0,s.A)({},a),{},{item:[...a.item||[],i]});o(n)},className:"add-question-btn",children:"+ Add Question"})]}),null===(r=a.item)||void 0===r?void 0:r.map((e,i)=>(0,d.jsxs)("div",{className:"question-editor",children:[(0,d.jsxs)("div",{className:"question-header",children:[(0,d.jsxs)("span",{className:"question-number",children:["Q",i+1]}),(0,d.jsx)("button",{onClick:()=>(e=>{if(!a.item)return;const i=a.item.filter((i,n)=>n!==e),n=(0,s.A)((0,s.A)({},a),{},{item:i});o(n)})(i),className:"remove-question-btn",title:"Remove question",children:"\u2715"})]}),(0,d.jsxs)("div",{className:"question-fields",children:[(0,d.jsxs)("div",{className:"field-group",children:[(0,d.jsx)("label",{htmlFor:"question-text-".concat(i),children:"Question Text:"}),(0,d.jsx)("input",{id:"question-text-".concat(i),type:"text",value:e.text||"",onChange:e=>u(i,"text",e.target.value),placeholder:"Enter question text"})]}),(0,d.jsxs)("div",{className:"field-group",children:[(0,d.jsx)("label",{htmlFor:"question-linkid-".concat(i),children:"Link ID:"}),(0,d.jsx)("input",{id:"question-linkid-".concat(i),type:"text",value:e.linkId||"",onChange:e=>u(i,"linkId",e.target.value),placeholder:"Enter unique ID"})]}),(0,d.jsxs)("div",{className:"field-group",children:[(0,d.jsx)("label",{htmlFor:"question-type-".concat(i),children:"Question Type:"}),(0,d.jsxs)("select",{id:"question-type-".concat(i),value:e.type||"string",onChange:e=>u(i,"type",e.target.value),children:[(0,d.jsx)("option",{value:"string",children:"Short Text"}),(0,d.jsx)("option",{value:"text",children:"Long Text"}),(0,d.jsx)("option",{value:"boolean",children:"Yes/No"}),(0,d.jsx)("option",{value:"decimal",children:"Decimal Number"}),(0,d.jsx)("option",{value:"integer",children:"Integer"}),(0,d.jsx)("option",{value:"date",children:"Date"}),(0,d.jsx)("option",{value:"choice",children:"Single Choice"}),(0,d.jsx)("option",{value:"open-choice",children:"Choice with Other"})]})]}),(0,d.jsx)("div",{className:"field-group checkbox-group",children:(0,d.jsxs)("label",{children:[(0,d.jsx)("input",{type:"checkbox",checked:e.required||!1,onChange:e=>u(i,"required",e.target.checked)}),"Required"]})})]})]},e.linkId)),(!a.item||0===a.item.length)&&(0,d.jsx)("div",{className:"no-questions",children:(0,d.jsx)("p",{children:'No questions yet. Click "Add Question" to get started.'})})]})]})]})},u=()=>{var e;const i=(0,r.oc)(),[n,u]=(0,t.useState)([]),[h,x]=(0,t.useState)(null),[p,m]=(0,t.useState)(!0),[j,v]=(0,t.useState)(!1),[g,f]=(0,t.useState)(null),[y,N]=(0,t.useState)(""),[b,q]=(0,t.useState)(!1),[S,w]=(0,t.useState)(!1),[C,F]=(0,t.useState)("visual"),[k,Q]=(0,t.useState)(null),[O,E]=(0,t.useState)(!1),[D,T]=(0,t.useState)(null),[H,I]=(0,t.useState)(null),A=null===i||void 0===i?void 0:i.repository,P=null===i||void 0===i?void 0:i.branch,L=null===i||void 0===i?void 0:i.isLoading,R=A&&P&&!L;if((0,t.useEffect)(()=>{(async()=>{try{Q(null),console.log("Using built-in visual editor"),w(!0)}catch(g){console.error("Failed to load LForms:",g),Q("Failed to load questionnaire editor: ".concat(g.message)),console.log("Using built-in visual editor as fallback"),w(!0)}})()},[]),(0,t.useEffect)(()=>{(async()=>{if(R)try{console.log("QuestionnaireEditor: Loading questionnaires for",A.name,"branch",P),m(!0),f(null);const e=[],i=[{path:"input/questionnaires",extensions:[".json"],type:"JSON"},{path:"input/fsh/questionnaires",extensions:[".fsh"],type:"FSH"}];for(const n of i)try{const i=(await o.A.getDirectoryContents(A.owner.login,A.name,n.path,P)).filter(e=>"file"===e.type&&n.extensions.some(i=>e.name.endsWith(i))).map(e=>{const i=n.extensions.find(i=>e.name.endsWith(i));return(0,s.A)((0,s.A)({},e),{},{displayName:e.name.replace(i,""),fullPath:"".concat(n.path,"/").concat(e.name),fileType:n.type,extension:i})});e.push(...i)}catch(g){404!==g.status&&console.warn("Error loading from ".concat(n.path,":"),g)}u(e)}catch(g){console.error("Error loading questionnaires:",g),f("Failed to load questionnaires: ".concat(g.message))}finally{m(!1)}else console.log("QuestionnaireEditor: Waiting for PageProvider context...",{repository:!!A,branch:!!P,pageLoading:L})})()},[R,A,P,L]),i.error)return(0,d.jsx)("div",{className:"questionnaire-editor-container",children:(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsx)("h2",{children:"Page Context Error"}),(0,d.jsx)("p",{children:i.error}),(0,d.jsx)("p",{children:"This component requires a DAK repository context to function properly."})]})});if(i.loading)return(0,d.jsx)("div",{className:"questionnaire-editor-container",children:(0,d.jsxs)("div",{className:"loading-message",children:[(0,d.jsx)("h2",{children:"Loading..."}),(0,d.jsx)("p",{children:"Initializing page context..."})]})});if(!A||!P)return(0,d.jsxs)("div",{className:"questionnaire-editor-loading",children:[(0,d.jsx)("div",{className:"loading-spinner"}),(0,d.jsx)("p",{children:"Initializing Questionnaire Editor..."})]});const J=async e=>{const i=await(0,l.extractFSHMetadata)(e);return i.title||i.name||null},_=async e=>(await(0,l.extractFSHMetadata)(e)).status||null,M=async e=>{const i=await(0,l.extractFSHMetadata)(e);return i.name||i.id||null},W=async e=>(await(0,l.extractFSHMetadata)(e)).description||null,z=()=>{const e={resourceType:"Questionnaire",id:"questionnaire-".concat(Date.now()),meta:{versionId:"1",lastUpdated:(new Date).toISOString()},url:"http://example.org/Questionnaire/".concat(Date.now()),name:"NewQuestionnaire",title:"New Questionnaire",status:"draft",date:(new Date).toISOString().split("T")[0],publisher:"WHO SMART Guidelines",description:"A new FHIR Questionnaire",item:[{linkId:"1",text:"Sample Question",type:"string",required:!1}]};T(e),I(JSON.stringify(e,null,2)),x({name:"".concat(e.name,".json"),displayName:e.name,fullPath:"input/questionnaires/".concat(e.name,".json"),fileType:"JSON",isNew:!0}),E(!0),F("visual"),console.log("New questionnaire created:",e)},B=D&&H&&JSON.stringify(D,null,2)!==H;return R?p&&!O?(0,d.jsx)(r.ox,{pageName:"questionnaire-editor",repository:A,branch:P,children:(0,d.jsxs)("div",{className:"questionnaire-editor-loading",children:[(0,d.jsx)("h2",{children:"Loading Questionnaires..."}),(0,d.jsx)("p",{children:"Fetching questionnaire files from repository..."})]})}):(0,d.jsx)(r.ox,{pageName:"questionnaire-editor",file:h,repository:A,branch:P,content:D?JSON.stringify(D,null,2):null,originalContent:H,hasChanges:B,onSave:(e,i)=>{if(console.log("Questionnaire saved to ".concat(i)),"github"===i){const e=async()=>{try{const e=[],i=[{path:"input/questionnaires",extensions:[".json"],type:"JSON"},{path:"input/fsh/questionnaires",extensions:[".fsh"],type:"FSH"}];for(const n of i)try{const i=(await o.A.getDirectoryContents(A.owner.login,A.name,n.path,P)).filter(e=>"file"===e.type&&n.extensions.some(i=>e.name.endsWith(i))).map(e=>{const i=n.extensions.find(i=>e.name.endsWith(i));return(0,s.A)((0,s.A)({},e),{},{displayName:e.name.replace(i,""),fullPath:"".concat(n.path,"/").concat(e.name),fileType:n.type,extension:i})});e.push(...i)}catch(g){404!==g.status&&console.warn("Error loading from ".concat(n.path,":"),g)}u(e)}catch(g){console.error("Error refreshing questionnaires:",g)}};e()}},showSaveButtons:O,children:(0,d.jsxs)("div",{className:"questionnaire-editor",children:[(0,d.jsxs)("div",{className:"questionnaire-content",children:[g&&(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsx)("strong",{children:"Error:"})," ",g]}),O?(0,d.jsxs)("div",{className:"questionnaire-editor-container",children:[(0,d.jsxs)("div",{className:"editor-header",children:[(0,d.jsx)("button",{onClick:()=>E(!1),className:"back-to-list",children:"\u2190 Back to List"}),(0,d.jsx)("h2",{children:(null===h||void 0===h?void 0:h.displayName)||"New Questionnaire"}),"FSH"!==(null===D||void 0===D?void 0:D.fileType)&&(0,d.jsxs)("div",{className:"edit-mode-toggle",children:[(0,d.jsx)("button",{className:"mode-btn ".concat("visual"===C?"active":""),onClick:()=>F("visual"),children:"\ud83d\udcdd Visual Editor"}),(0,d.jsx)("button",{className:"mode-btn ".concat("json"===C?"active":""),onClick:()=>F("json"),children:" JSON Editor"})]})]}),k&&(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsx)("strong",{children:"LForms Error:"})," ",k]}),S?(0,d.jsxs)("div",{className:"lforms-container",children:[(0,d.jsxs)("div",{className:"questionnaire-preview",children:[(0,d.jsx)("h4",{children:"Questionnaire Preview"}),(0,d.jsxs)("div",{className:"questionnaire-metadata",children:[(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"Title:"})," ",(null===D||void 0===D?void 0:D.title)||"Untitled"]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"Status:"})," ",(null===D||void 0===D?void 0:D.status)||"draft"]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"Format:"})," ",(null===D||void 0===D?void 0:D.fileType)||"JSON"]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"Date:"})," ",(null===D||void 0===D?void 0:D.date)||"Not specified"]}),"FSH"!==(null===D||void 0===D?void 0:D.fileType)&&(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"Items:"})," ",(null===D||void 0===D||null===(e=D.item)||void 0===e?void 0:e.length)||0," questions"]})]})]}),"FSH"===(null===D||void 0===D?void 0:D.fileType)?(0,d.jsxs)("div",{className:"questionnaire-content-editor",children:[(0,d.jsxs)("h4",{children:["FHIR Shorthand Content",(0,d.jsx)("span",{className:"readonly-badge",children:" (Read-Only)"})]}),(0,d.jsxs)("div",{className:"fsh-editor",children:[(0,d.jsx)("textarea",{value:(null===D||void 0===D?void 0:D.rawContent)||"",readOnly:!0,className:"fsh-content",rows:20}),(0,d.jsxs)("div",{className:"fsh-notice",children:[(0,d.jsx)("strong",{children:"\ud83d\udcdd FSH File:"})," This is a FHIR Shorthand questionnaire. Direct editing is not supported yet - please edit the .fsh file directly in your repository."]})]})]}):"visual"===C?(0,d.jsxs)("div",{className:"visual-editor-section",children:[(0,d.jsx)("h4",{children:"Visual Questionnaire Builder"}),(0,d.jsx)("div",{className:"lforms-visual-editor",children:(0,d.jsx)(c,{questionnaire:D,onChange:e=>{T(e)},onError:Q})})]}):(0,d.jsxs)("div",{className:"questionnaire-content-editor",children:[(0,d.jsx)("h4",{children:"Raw JSON Content"}),(0,d.jsx)("textarea",{value:JSON.stringify(D,null,2),onChange:e=>{try{const i=JSON.parse(e.target.value);T(i)}catch(g){console.warn("Invalid JSON in editor")}},className:"json-editor",rows:20})]}),(0,d.jsxs)("div",{className:"editor-instructions",children:[(0,d.jsx)("h4",{children:"Editing Instructions:"}),"FSH"===(null===D||void 0===D?void 0:D.fileType)?(0,d.jsxs)("ul",{children:[(0,d.jsx)("li",{children:"This is a FHIR Shorthand (.fsh) questionnaire file"}),(0,d.jsx)("li",{children:"FSH files define questionnaires using a domain-specific language"}),(0,d.jsx)("li",{children:"To edit this questionnaire, modify the .fsh file directly in your repository"}),(0,d.jsx)("li",{children:"FSH files are compiled into JSON during the build process"}),(0,d.jsxs)("li",{children:["Learn more about FHIR Shorthand at ",(0,d.jsx)("a",{href:"https://build.fhir.org/ig/HL7/fhir-shorthand/",target:"_blank",rel:"noopener noreferrer",children:"HL7 FHIR Shorthand"})]})]}):"visual"===C?(0,d.jsxs)("ul",{children:[(0,d.jsx)("li",{children:"Use the visual editor above to build your questionnaire interactively"}),(0,d.jsx)("li",{children:"Add, remove, and modify questions using the form builder interface"}),(0,d.jsx)("li",{children:"Preview your questionnaire as users will see it"}),(0,d.jsx)("li",{children:"Switch to JSON mode to see the raw FHIR Questionnaire structure"}),(0,d.jsx)("li",{children:"Changes are automatically saved as you work"})]}):(0,d.jsxs)("ul",{children:[(0,d.jsx)("li",{children:"Edit the JSON structure above to modify the questionnaire"}),(0,d.jsx)("li",{children:"The preview shows key questionnaire metadata"}),(0,d.jsx)("li",{children:"Changes are automatically detected for saving"}),(0,d.jsx)("li",{children:"Switch to Visual mode for an easier editing experience"}),(0,d.jsx)("li",{children:'Click "Save to Staging" to save changes locally'})]}),(0,d.jsxs)("div",{className:"help-tip",children:[(0,d.jsx)("strong",{children:"\u2728 New:"})," Visual questionnaire editor is now available using LHC-Forms!"]})]})]}):(0,d.jsx)("div",{className:"lforms-loading",children:(0,d.jsx)("p",{children:"Loading questionnaire editor..."})})]}):(0,d.jsxs)("div",{className:"questionnaire-list",children:[(0,d.jsxs)("div",{className:"list-header",children:[(0,d.jsxs)("h2",{children:["Questionnaires (",n.length,")"]}),(0,d.jsx)("button",{onClick:z,className:"btn-primary",disabled:!S,children:"+ Create New Questionnaire"})]}),0===n.length?(0,d.jsxs)("div",{className:"empty-state",children:[(0,d.jsx)("div",{className:"empty-icon",children:"\ud83d\udccb"}),(0,d.jsx)("h3",{children:"No Questionnaires Found"}),(0,d.jsx)("p",{children:"This repository doesn't have any FHIR Questionnaire files yet."}),(0,d.jsx)("p",{children:"Questionnaires can be stored as:"}),(0,d.jsxs)("ul",{style:{textAlign:"left",maxWidth:"400px",margin:"0 auto"},children:[(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{children:"input/questionnaires/*.json"})," - FHIR JSON format"]}),(0,d.jsxs)("li",{children:[(0,d.jsx)("code",{children:"input/fsh/questionnaires/*.fsh"})," - FHIR Shorthand format"]})]}),(0,d.jsx)("button",{onClick:z,className:"btn-primary",disabled:!S,children:"Create Your First Questionnaire"})]}):(0,d.jsx)("div",{className:"questionnaire-grid",children:n.map(e=>(0,d.jsxs)("div",{className:"questionnaire-card",onClick:()=>(async e=>{try{m(!0);const i=await o.A.getFileContent(A.owner.login,A.name,e.fullPath,P);let n;"JSON"===e.fileType?n=JSON.parse(i):"FSH"===e.fileType&&(n={resourceType:"Questionnaire",fileType:"FSH",title:await J(i)||e.displayName,status:await _(i)||"draft",name:await M(i)||e.displayName,description:await W(i)||"FHIR Shorthand Questionnaire",rawContent:i,isReadOnly:!0}),T(n),I(i),x(e),E(!0),console.log("Questionnaire loaded:",n)}catch(g){console.error("Error loading questionnaire content:",g),f("Failed to load questionnaire: ".concat(g.message))}finally{m(!1)}})(e),children:[(0,d.jsx)("div",{className:"card-icon",children:"FSH"===e.fileType?"\ud83d\udcdd":"\ud83d\udccb"}),(0,d.jsxs)("div",{className:"card-content",children:[(0,d.jsx)("h3",{children:e.displayName}),(0,d.jsxs)("p",{className:"card-type",children:[e.fileType," Questionnaire"]}),(0,d.jsx)("p",{className:"card-path",children:e.fullPath}),(0,d.jsxs)("p",{className:"card-size",children:[(e.size/1024).toFixed(1)," KB"]})]})]},e.name))})]})]}),(0,d.jsx)(a.A,{pageId:"questionnaire-editor",contextData:{repository:A.name,branch:P,hasQuestionnaires:n.length>0,isEditing:O}})]})}):(0,d.jsx)(r.ox,{pageName:"questionnaire-editor",children:(0,d.jsxs)("div",{className:"questionnaire-editor-loading",children:[(0,d.jsx)("h2",{children:"Initializing Questionnaire Editor..."}),(0,d.jsx)("p",{children:"Loading repository context..."})]})})};class h extends t.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e.message}}componentDidCatch(e,i){console.error("QuestionnaireEditor caught an error:",e,i)}render(){return this.state.hasError?(0,d.jsx)(r.ox,{pageName:"questionnaire-editor",children:(0,d.jsxs)("div",{className:"error-state",children:[(0,d.jsx)("h2",{children:"\u26a0\ufe0f Questionnaire Editor Error"}),(0,d.jsx)("p",{children:"An unexpected error occurred while loading the questionnaire editor."}),(0,d.jsxs)("div",{className:"error-details",children:[(0,d.jsx)("strong",{children:"Error:"})," ",this.state.error]}),(0,d.jsx)("button",{onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},className:"btn-primary",children:"Reload Editor"})]})}):this.props.children}}const x=()=>(0,d.jsx)(r.Mx,{pageName:"questionnaire-editor",children:(0,d.jsx)(h,{children:(0,d.jsx)(u,{})})})}}]);