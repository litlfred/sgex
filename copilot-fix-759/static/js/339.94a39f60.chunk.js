"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[339],{90919:(e,n,t)=>{t.r(n),t.d(n,{default:()=>j});var o=t(9950),s=t(91018),a=t(67818),i=t(29946),c=t(88498),r=t(18354),l=t(44350),d=t(88259),m=t(44414);const h=e=>{let{helpTopic:n,contextData:t={}}=e;const[s,a]=(0,o.useState)(!1),i=(0,d.A)("sgex-mascot.png");return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("button",{className:"help-button",onClick:()=>{a(!0)},title:"Get Help","aria-label":"Get Help",children:(0,m.jsx)("img",{src:i,alt:"SGEX Helper",className:"help-mascot-icon"})}),s&&(0,m.jsx)(l.A,{topic:n,contextData:t,onClose:()=>{a(!1)}})]})};var p=t(32675),u=t(30221),f=t(58377),v=t(83111),g=t(1932),x=t(95388);const b=()=>{var e,n,t,l;const{t:v}=(0,a.Bd)(),b=(0,s.zy)(),j=(0,s.Zp)(),{user:y,repo:N,branch:w}=(0,s.g)(),k=(0,d.A)("sgex-mascot.png"),[C,_]=(0,o.useState)((null===(e=b.state)||void 0===e?void 0:e.profile)||null),[A,S]=(0,o.useState)((null===(n=b.state)||void 0===n?void 0:n.repository)||null),[D,R]=(0,o.useState)(!C||!A),[M,I]=(0,o.useState)(null),[L,T]=(0,o.useState)(!1),[q,E]=(0,o.useState)(!1),[P,K]=(0,o.useState)("core"),[B,O]=(0,o.useState)((null===(t=b.state)||void 0===t?void 0:t.selectedBranch)||w||null),[H,X]=(0,o.useState)({}),[F,G]=(0,o.useState)(!1),U=e=>{let{component:n,handleComponentClick:t,t:s}=e;const[a,i]=(0,o.useState)(!1),[c,r]=(0,o.useState)(!1),l=(0,d.A)(n.cardImage);return(0,m.jsxs)("div",{className:"component-card ".concat(n.type.toLowerCase()," large-card ").concat(a?"image-loaded":""),onClick:e=>t(e,n),style:{"--component-color":n.color},tabIndex:0,role:"button","aria-label":"".concat(n.name," - ").concat(n.description),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t(e,n))},children:[(0,m.jsxs)("div",{className:"component-main",children:[(0,m.jsx)("div",{className:"component-header",children:(0,m.jsxs)("div",{className:"component-image-container",children:[(0,m.jsx)("img",{src:l,alt:(0,x.lm)(s,x.ld.ICON_DAK_COMPONENT,n.name,{name:n.name}),className:"component-card-image",onLoad:()=>{i(!0),r(!1)},onError:()=>{r(!0),i(!1)},style:{display:c?"none":"block"}}),c&&(0,m.jsx)("div",{className:"component-icon",style:{color:n.color},children:n.icon})]})}),(0,m.jsxs)("div",{className:"component-content",children:[(0,m.jsx)("h4",{children:n.name}),(0,m.jsx)("p",{children:n.description})]})]}),(0,m.jsx)("div",{className:"component-meta-section",children:(0,m.jsxs)("div",{className:"component-meta",children:[(0,m.jsx)("div",{className:"file-types",children:n.fileTypes.map(e=>(0,m.jsx)("span",{className:"file-type-tag",children:e},e))}),(0,m.jsxs)("div",{className:"file-count",children:[n.count," files"]})]})})]})};(0,o.useEffect)(()=>{(async()=>{if(C&&A||!y||!N)R(!1);else try{if(R(!0),I(null),!i.A.isAuth()){if(window.location.pathname.includes("/dashboard/")){if(!c.A.validateDemoDAKRepository(y,N))return void j("/",{state:{warningMessage:"Could not access the requested DAK. Repository '".concat(y,"/").concat(N,"' not found or not accessible.")}});const e={login:y,name:y.charAt(0).toUpperCase()+y.slice(1),avatar_url:"https://github.com/".concat(y,".png"),type:"User",isDemo:!0},n={name:N,full_name:"".concat(y,"/").concat(N),owner:{login:y},default_branch:w||"main",html_url:"https://github.com/".concat(y,"/").concat(N),isDemo:!0};return _(e),S(n),O(w||"main"),void R(!1)}return I(v("auth.authRequired")),void R(!1)}let n=null;try{n=await i.A.getUser(y)}catch(e){return console.error("Error fetching user:",e),void j("/",{state:{warningMessage:"Could not access the requested DAK. User '".concat(y,"' not found or not accessible.")}})}let t=null;try{t=await i.A.getRepository(y,N)}catch(e){return console.error("Error fetching repository:",e),void j("/",{state:{warningMessage:"Could not access the requested DAK. Repository '".concat(y,"/").concat(N,"' not found or not accessible.")}})}if(!await c.A.validateDAKRepository(y,N,w||t.default_branch))return console.log("Repository ".concat(y,"/").concat(N," is not a valid DAK repository")),void j("/",{state:{warningMessage:"Could not access the requested DAK. Repository '".concat(y,"/").concat(N,"' not found or not accessible.")}});if(w)try{await i.A.getBranch(y,N,w),O(w)}catch(e){console.warn("Branch '".concat(w,"' not found, falling back to default branch")),O(t.default_branch)}else O(t.default_branch);_(n),S(t),R(!1)}catch(e){console.error("Error fetching data from URL params:",e),I("Failed to load dashboard data. Please check the URL or try again."),R(!1)}})()},[y,N,w,C,A,j,v]),(0,o.useEffect)(()=>{if(A){const e=r.default.getSelectedBranch(A);if(e)O(e);else if(C&&"demo-user"===C.login){const e=A.default_branch||"main";O(e),r.default.setSelectedBranch(A,e)}}},[A,C]);(0,o.useEffect)(()=>{A&&!D&&(async()=>{if(A)try{var e;const n=(null===(e=A.owner)||void 0===e?void 0:e.login)||A.full_name.split("/")[0],t=A.name,o=(await i.A.getIssues(n,t,{state:"all",per_page:100})).filter(e=>!e.pull_request),s=o.filter(e=>"open"===e.state).length,a=o.filter(e=>"closed"===e.state).length;X({total:o.length,open:s,closed:a})}catch(n){console.warn("Could not load issue counts:",n),X({total:0,open:0,closed:0})}})()},[A,D]),(0,o.useEffect)(()=>{(async()=>{if(A&&C)try{var e;const n=await i.A.checkRepositoryWritePermissions((null===(e=A.owner)||void 0===e?void 0:e.login)||A.full_name.split("/")[0],A.name);T(n)}catch(M){console.warn("Could not check write permissions:",M),T(!1)}R(!1)})()},[A,C]),(0,o.useEffect)(()=>{const e=e=>{F&&!e.target.closest(".user-menu-container")&&G(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[F]);const W=[{id:"health-interventions",name:v("dak.healthInterventions"),description:"Clinical guidelines and health intervention specifications that define evidence-based care recommendations",icon:"\ud83d\udcd6",cardImage:"dashboard/dak_interventions.png",type:"L2",color:"#0078d4",fileTypes:["IRIS","Publication"],count:5,editor:"Publication reference manager with IRIS integration"},{id:"generic-personas",name:v("dak.genericPersonas"),description:"Standardized user roles and actor definitions that represent different types of healthcare workers and patients",icon:"\ud83d\udc65",cardImage:"dashboard/dak_personas.png",type:"L2",color:"#107c10",fileTypes:["Actor","Role"],count:8,editor:"Persona definition editor with role-based access specifications"},{id:"user-scenarios",name:v("dak.userScenarios"),description:"Narrative descriptions of how different personas interact with the system in specific healthcare contexts",icon:"\ud83d\udcdd",cardImage:"dashboard/dak_user_scenarios.png",type:"L2",color:"#881798",fileTypes:["Narrative","Use Case"],count:12,editor:"Scenario editor with workflow visualization"},{id:"business-processes",name:v("dak.businessProcesses"),description:"BPMN workflows and business process definitions that model clinical workflows and care pathways",icon:"\ud83d\udd04",cardImage:"dashboard/dak_business_processes.png",type:"L2",color:"#d13438",fileTypes:["BPMN","XML"],count:15,editor:"Graphical BPMN editor with SVG visualization"},{id:"core-data-elements",name:v("dak.coreDataElements"),description:"Essential data structures and terminology needed for clinical data capture and exchange (includes Terminology Services via OCL and Product Master Data via PCMT)",icon:"\ud83d\uddc3\ufe0f",cardImage:"dashboard/dak_core_data_elements.png",type:"L2",color:"#ff8c00",fileTypes:["OCL","Concept","PCMT","Product"],count:H.total||89,editor:"Data element editor with OCL and PCMT integration"},{id:"decision-support",name:v("dak.decisionSupportLogic"),description:"DMN decision tables and clinical decision support rules that encode clinical logic",icon:"\ud83c\udfaf",cardImage:"dashboard/dak_decision_support_logic.png",type:"L2",color:"#00bcf2",fileTypes:["DMN","XML"],count:24,editor:"DMN decision table editor with validation"},{id:"program-indicators",name:v("dak.programIndicators"),description:"Performance indicators and measurement definitions for monitoring and evaluation",icon:"\ud83d\udcca",cardImage:"dashboard/dak_indicators.png",type:"L2",color:"#498205",fileTypes:["Measure","Logic"],count:18,editor:"Indicator definition editor with measurement logic"},{id:"functional-requirements",name:v("dak.requirements"),description:"System requirements specifications that define capabilities and constraints",icon:"\u2699\ufe0f",cardImage:"dashboard/dak_requirements.png",type:"L2",color:"#6b69d6",fileTypes:["Requirements","Specification"],count:32,editor:"Requirements editor with structured templates"},{id:"test-scenarios",name:v("dak.testScenarios")||"Test Scenarios",description:"Feature files and test scenarios for validating the DAK implementation",icon:"\ud83e\uddea",cardImage:"dashboard/dak_testing.png",type:"L2",color:"#8b5cf6",fileTypes:["Feature","Test"],count:0,editor:"Testing viewer with feature file browser"}],z=(e,n)=>{var t;const o={profile:C,repository:A,component:n,selectedBranch:B};if("decision-support"===n.id){var s;const n=(null===(s=A.owner)||void 0===s?void 0:s.login)||A.full_name.split("/")[0],t=A.name,a=B?"/decision-support-logic/".concat(n,"/").concat(t,"/").concat(B):"/decision-support-logic/".concat(n,"/").concat(t);return void(0,g.hX)(e,a,j,o)}if("business-processes"===n.id){var a;const n=(null===(a=A.owner)||void 0===a?void 0:a.login)||A.full_name.split("/")[0],t=A.name,s=B?"/business-process-selection/".concat(n,"/").concat(t,"/").concat(B):"/business-process-selection/".concat(n,"/").concat(t);return void(0,g.hX)(e,s,j,o)}if("health-interventions"===n.id){var i;const n=(null===(i=A.owner)||void 0===i?void 0:i.login)||A.full_name.split("/")[0],t=A.name,s=B?"/health-interventions/".concat(n,"/").concat(t,"/").concat(B):"/health-interventions/".concat(n,"/").concat(t);return void(0,g.hX)(e,s,j,o)}if("core-data-elements"===n.id){var c;const n=y||(null===(c=A.owner)||void 0===c?void 0:c.login)||A.full_name.split("/")[0],t=N||A.name,s=B,a=s?"/core-data-dictionary-viewer/".concat(n,"/").concat(t,"/").concat(s):"/core-data-dictionary-viewer/".concat(n,"/").concat(t);return void(0,g.hX)(e,a,j,o)}if("generic-personas"===n.id){var r;const n=(null===(r=A.owner)||void 0===r?void 0:r.login)||A.full_name.split("/")[0],t=A.name,s=B?"/actor-editor/".concat(n,"/").concat(t,"/").concat(B):"/actor-editor/".concat(n,"/").concat(t);return void(0,g.hX)(e,s,j,o)}if("test-scenarios"===n.id){var l;const n=(null===(l=A.owner)||void 0===l?void 0:l.login)||A.full_name.split("/")[0],t=A.name,s=B?"/testing-viewer/".concat(n,"/").concat(t,"/").concat(B):"/testing-viewer/".concat(n,"/").concat(t);return void(0,g.hX)(e,s,j,o)}if(!L)return void E(!0);const d=(null===(t=A.owner)||void 0===t?void 0:t.login)||A.full_name.split("/")[0],m=A.name,h=B?"/".concat(n.id,"/").concat(d,"/").concat(m,"/").concat(B):"/".concat(n.id,"/").concat(d,"/").concat(m);(0,g.hX)(e,h,j,o)};return D?(0,m.jsx)("div",{className:"dak-dashboard loading-state",children:(0,m.jsxs)("div",{className:"loading-content",children:[(0,m.jsx)("h2",{children:"Loading Dashboard..."}),(0,m.jsx)("p",{children:"Fetching repository and user data..."})]})}):M?(0,m.jsx)("div",{className:"dak-dashboard error-state",children:(0,m.jsxs)("div",{className:"error-content",children:[(0,m.jsx)("h2",{children:v("dashboard.errorLoading")}),(0,m.jsx)("p",{children:M}),(0,m.jsxs)("div",{className:"error-actions",children:[(0,m.jsx)("button",{onClick:()=>j("/"),className:"action-btn primary",children:v("navigation.home")}),(0,m.jsx)("button",{onClick:()=>window.location.reload(),className:"action-btn secondary",children:v("common.retry")})]})]})}):C&&A?(0,m.jsxs)("div",{className:"dak-dashboard",children:[(0,m.jsx)("div",{className:"dashboard-content",children:(0,m.jsxs)("div",{className:"dashboard-main",children:[(0,m.jsxs)("div",{className:"dashboard-intro",children:[(0,m.jsx)("h2",{children:v("dak.components")}),(0,m.jsxs)("p",{children:["Select a component to edit content for ",(0,m.jsx)("strong",{children:A.name}),B&&(0,m.jsxs)("span",{children:[" on branch ",(0,m.jsx)("code",{className:"branch-display",children:B})]}),". Components are organized according to the WHO SMART Guidelines framework."]})]}),(0,m.jsx)(f.A,{profile:C,repository:A,selectedBranch:B}),A&&B&&(0,m.jsx)(p.A,{repository:A,selectedBranch:B,hasWriteAccess:L,profile:C}),(0,m.jsxs)("div",{className:"tab-navigation-fullwidth",children:[(0,m.jsxs)("button",{className:"tab-button-fullwidth ".concat("core"===P?"active":""),onClick:()=>K("core"),children:[(0,m.jsx)("span",{className:"tab-icon",children:"\u2b50"}),(0,m.jsx)("span",{className:"tab-text",children:"9 Core Components"})]}),(0,m.jsxs)("button",{className:"tab-button-fullwidth ".concat("publications"===P?"active":""),onClick:()=>K("publications"),children:[(0,m.jsx)("span",{className:"tab-icon",children:"\ud83d\udcda"}),(0,m.jsx)("span",{className:"tab-text",children:"Publications"})]}),(0,m.jsxs)("button",{className:"tab-button-fullwidth ".concat("other"===P?"active":""),onClick:()=>K("other"),children:[(0,m.jsx)("span",{className:"tab-icon",children:"\ud83d\udd27"}),(0,m.jsx)("span",{className:"tab-text",children:"Other DAK Components"})]})]}),"core"===P&&(0,m.jsxs)("div",{className:"components-section active",children:[(0,m.jsxs)("div",{className:"section-header",children:[(0,m.jsx)("h3",{className:"section-title",children:v("dak.components")}),(0,m.jsx)("p",{className:"section-description",children:"Essential components that form the foundation of any WHO SMART Guidelines Digital Adaptation Kit"})]}),(0,m.jsx)("div",{className:"components-grid core-components",children:W.map(e=>(0,m.jsx)(U,{component:e,handleComponentClick:z,t:v},e.id))})]}),"other"===P&&(0,m.jsxs)("div",{className:"components-section other-components active",children:[(0,m.jsxs)("div",{className:"section-header",children:[(0,m.jsx)("h3",{className:"section-title",children:"Other DAK Components"}),(0,m.jsx)("p",{className:"section-description",children:"Additional specialized components for advanced DAK functionality and implementation"})]}),(0,m.jsx)("div",{className:"components-grid other-components",children:(0,m.jsxs)("div",{className:"component-card l3",onClick:e=>{var n;const t=(null===(n=A.owner)||void 0===n?void 0:n.login)||A.full_name.split("/")[0],o=A.name,s=B?"/questionnaire-editor/".concat(t,"/").concat(o,"/").concat(B):"/questionnaire-editor/".concat(t,"/").concat(o),a={profile:C,repository:A,component:{id:"questionnaire-editor",name:"FHIR Questionnaires",description:"Structured questionnaires and forms for data collection using FHIR standard"},selectedBranch:B};(0,g.hX)(e,s,j,a)},style:{"--component-color":"#17a2b8"},children:[(0,m.jsx)("div",{className:"component-header",children:(0,m.jsx)("div",{className:"component-icon",style:{color:"#17a2b8"},children:"\ud83d\udccb"})}),(0,m.jsxs)("div",{className:"component-content",children:[(0,m.jsx)("h4",{children:"FHIR Questionnaires"}),(0,m.jsx)("p",{children:"Structured questionnaires and forms for data collection using FHIR Questionnaire standard"}),(0,m.jsxs)("div",{className:"component-meta",children:[(0,m.jsxs)("div",{className:"file-types",children:[(0,m.jsx)("span",{className:"file-type-tag",children:"JSON"}),(0,m.jsx)("span",{className:"file-type-tag",children:"FHIR"})]}),(0,m.jsx)("div",{className:"file-count",children:"questionnaires/"})]})]})]})})]}),"publications"===P&&(0,m.jsx)("div",{className:"components-section publications-section active",children:(0,m.jsx)(u.A,{profile:C,repository:A,selectedBranch:B,hasWriteAccess:L})})]})}),q&&(0,m.jsx)("div",{className:"permission-dialog-overlay",children:(0,m.jsxs)("div",{className:"permission-dialog",children:[(0,m.jsxs)("div",{className:"dialog-header",children:[(0,m.jsx)("h3",{children:"Edit Access Required"}),(0,m.jsx)("button",{className:"dialog-close",onClick:()=>E(!1),children:"\xd7"})]}),(0,m.jsxs)("div",{className:"dialog-content",children:[(0,m.jsxs)("div",{className:"dialog-mascot",children:[(0,m.jsx)("img",{src:k,alt:(0,x.lm)(v,x.ld.MASCOT_HELPER,"SGEX Helper"),className:"dialog-mascot-img"}),(0,m.jsxs)("div",{className:"mascot-message",children:[(0,m.jsx)("p",{children:"You need edit permissions to modify DAK components!"}),(0,m.jsx)("p",{children:"Your current token only provides read access to this repository."})]})]}),(0,m.jsxs)("div",{className:"permission-options",children:[(0,m.jsxs)("div",{className:"option-card",children:[(0,m.jsx)("h4",{children:"\ud83d\udd27 Upgrade Your Token"}),(0,m.jsx)("p",{children:"Create a new fine-grained token with write permissions for this repository."}),(0,m.jsxs)("div",{className:"option-buttons",children:[(0,m.jsx)("a",{href:"https://github.com/settings/personal-access-tokens/new",target:"_blank",rel:"noopener noreferrer",className:"btn-primary",children:"Create New Token"}),(0,m.jsx)(h,{helpTopic:"github-token",contextData:{repository:{owner:(null===(l=A.owner)||void 0===l?void 0:l.login)||A.full_name.split("/")[0],name:A.name},requiredScopes:["Contents: Write","Metadata: Read","Pull requests: Write"],permissionMode:"edit",upgradeMode:!0}})]})]}),(0,m.jsxs)("div",{className:"option-card",children:[(0,m.jsx)("h4",{children:"\ud83d\udc41\ufe0f Continue in Read-Only Mode"}),(0,m.jsx)("p",{children:"Browse and view DAK components without editing capabilities."}),(0,m.jsx)("button",{className:"btn-secondary",onClick:()=>E(!1),children:"Continue Read-Only"})]})]})]})]})})]}):(j("/"),(0,m.jsx)("div",{children:"Redirecting..."}))},j=()=>(0,m.jsx)(v.Mx,{pageName:"dak-dashboard",children:(0,m.jsx)(b,{})})}}]);