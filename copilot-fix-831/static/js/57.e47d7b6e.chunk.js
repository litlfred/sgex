"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[57],{12057:(e,i,s)=>{s.r(i),s.d(i,{default:()=>h});var n=s(89379),t=s(9950),r=s(51635),o=s(29166),a=s(29946),l=s(44414);const d=e=>{var i,s,r;let{questionnaire:o,onChange:a,onError:d}=e;const[c,u]=(0,t.useState)(!1),[h,m]=(0,t.useState)(null),[x,p]=(0,t.useState)(!1),[j]=(0,t.useState)("lforms-container-".concat(Date.now()));(0,t.useEffect)(()=>{(async()=>{try{if(console.log("Loading LForms library from local bundle..."),window.LForms)return console.log("LForms already available globally"),m(window.LForms),p(!0),void(d&&d(null));const i="/sgex/copilot-fix-831",s=document.createElement("link");s.rel="stylesheet",s.href="".concat(i,"/vendor/lforms/lforms-styles.css"),document.head.appendChild(s);const n=["".concat(i,"/vendor/lforms/webcomponent/polyfills.js"),"".concat(i,"/vendor/lforms/webcomponent/runtime.js"),"".concat(i,"/vendor/lforms/webcomponent/main.js"),"".concat(i,"/vendor/lforms/webcomponent/lhc-forms.js"),"".concat(i,"/vendor/lforms/lformsFHIR.js")];for(const t of n)try{console.log("Loading LForms file: ".concat(t)),await new Promise((e,i)=>{const s=document.createElement("script");s.src=t,s.onload=e,s.onerror=()=>i(new Error("Failed to load ".concat(t))),document.head.appendChild(s)})}catch(e){console.warn("Optional LForms file failed to load: ".concat(e.message))}window.LForms?(console.log("LForms loaded successfully from local bundle"),m(window.LForms),p(!0),d&&d(null)):(console.warn("LForms not available after loading local files, using fallback editor"),d&&d("LHC-Forms library could not be loaded from local bundle - using fallback editor"),p(!0))}catch(e){console.error("Failed to load LForms:",e),d&&d("LHC-Forms library could not be loaded. Using fallback editor. Error: ".concat(e.message)),p(!0)}})()},[d]),(0,t.useEffect)(()=>{if(h&&o&&!c)try{const i={type:"LOINC",code:(e=o).id||"questionnaire",name:e.title||"Questionnaire",items:(e.item||[]).map((e,i)=>({questionCode:e.linkId||"q".concat(i+1),question:e.text||"Question ".concat(i+1),dataType:v(e.type),answerRequired:e.required||!1,answers:e.answerOption?e.answerOption.map(e=>{var i,s;return{text:(null===(i=e.valueCoding)||void 0===i?void 0:i.display)||e.valueString||"Option",code:(null===(s=e.valueCoding)||void 0===s?void 0:s.code)||e.valueString}}):void 0}))},s=document.getElementById(j);if(s){s.innerHTML="",h.Util.addFormToPage(i,j);const e=s.querySelector("form");e&&e.addEventListener("input",()=>{const i=h.Util.getUserData(e);if(i&&a){const e=(s=o,(0,n.A)((0,n.A)({},s),{},{meta:(0,n.A)((0,n.A)({},s.meta),{},{lastUpdated:(new Date).toISOString()})}));a(e)}var s})}}catch(i){console.error("Error initializing LForms questionnaire:",i),d&&d("Error displaying questionnaire: ".concat(i.message))}var e},[h,o,c,j,a,d]);const v=e=>({string:"ST",text:"TX",boolean:"BL",decimal:"REAL",integer:"INT",date:"DT",dateTime:"DTM",choice:"CWE","open-choice":"CWE"}[e]||"ST"),g=(e,i,s)=>{if(!o.item)return;const t=[...o.item];t[e]=(0,n.A)((0,n.A)({},t[e]),{},{[i]:s});const r=(0,n.A)((0,n.A)({},o),{},{item:t});a(r)},f=(e,i)=>{const s=(0,n.A)((0,n.A)({},o),{},{[e]:i});a(s)};return(0,l.jsx)("div",{className:"lforms-visual-editor",children:x?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"editor-modes",children:[(0,l.jsx)("button",{className:"mode-toggle ".concat(c?"":"active"),onClick:()=>u(!1),children:h?"\ud83c\udfaf LHC-Forms Editor":"\ud83d\udd27 Build Mode"}),(0,l.jsx)("button",{className:"mode-toggle ".concat(c?"active":""),onClick:()=>u(!0),children:"\ud83d\udc41\ufe0f Preview Mode"})]}),c?(0,l.jsxs)("div",{className:"lforms-preview",children:[(0,l.jsx)("h5",{children:"Live Preview"}),(0,l.jsxs)("div",{className:"simple-questionnaire-preview",children:[(0,l.jsxs)("div",{className:"preview-header",children:[(0,l.jsx)("h3",{children:o.title||"Untitled Questionnaire"}),(0,l.jsx)("p",{children:o.description||"No description provided"})]}),(0,l.jsx)("div",{className:"preview-questions",children:(null===(i=o.item)||void 0===i?void 0:i.map((e,i)=>(0,l.jsxs)("div",{className:"preview-question",children:[(0,l.jsxs)("label",{className:"preview-question-label",children:[i+1,". ",e.text,e.required&&(0,l.jsx)("span",{className:"required-asterisk",children:" *"})]}),"string"===e.type&&(0,l.jsx)("input",{type:"text",placeholder:"Text answer",disabled:!0}),"text"===e.type&&(0,l.jsx)("textarea",{placeholder:"Long text answer",disabled:!0,rows:3}),"boolean"===e.type&&(0,l.jsxs)("div",{className:"preview-boolean",children:[(0,l.jsxs)("label",{children:[(0,l.jsx)("input",{type:"radio",disabled:!0})," Yes"]}),(0,l.jsxs)("label",{children:[(0,l.jsx)("input",{type:"radio",disabled:!0})," No"]})]}),"decimal"===e.type&&(0,l.jsx)("input",{type:"number",step:"0.01",placeholder:"Number",disabled:!0}),"integer"===e.type&&(0,l.jsx)("input",{type:"number",step:"1",placeholder:"Integer",disabled:!0}),"date"===e.type&&(0,l.jsx)("input",{type:"date",disabled:!0}),"choice"===e.type&&(0,l.jsx)("select",{disabled:!0,children:(0,l.jsx)("option",{children:"Select an option..."})})]},e.linkId)))||(0,l.jsx)("p",{className:"no-questions-preview",children:"No questions added yet."})})]})]}):(0,l.jsx)("div",{className:"lforms-builder",children:h?(0,l.jsxs)("div",{className:"lhc-forms-container",children:[(0,l.jsxs)("div",{className:"lhc-forms-header",children:[(0,l.jsx)("h5",{children:"\u2728 LHC-Forms Visual Editor"}),(0,l.jsx)("p",{children:"Powered by locally bundled LHC-Forms for professional questionnaire design"}),(0,l.jsx)("div",{className:"lhc-forms-status success",children:"\u2705 LHC-Forms library loaded successfully from local bundle"})]}),(0,l.jsx)("div",{id:j,className:"lhc-forms-widget",style:{minHeight:"400px",border:"1px solid #ddd",padding:"20px",borderRadius:"8px",backgroundColor:"#fafafa"},children:(0,l.jsx)("div",{className:"lforms-placeholder",children:(0,l.jsx)("p",{children:"Initializing LHC-Forms questionnaire editor..."})})}),(0,l.jsxs)("div",{className:"lhc-forms-instructions",children:[(0,l.jsx)("h6",{children:"\u2728 LHC-Forms Features:"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Professional visual questionnaire design interface"}),(0,l.jsx)("li",{children:"Real-time FHIR Questionnaire generation"}),(0,l.jsx)("li",{children:"Advanced question types and validation"}),(0,l.jsx)("li",{children:"Industry-standard questionnaire authoring"})]})]})]}):(0,l.jsxs)("div",{className:"fallback-editor-container",children:[(0,l.jsxs)("div",{className:"fallback-editor-header",children:[(0,l.jsx)("h5",{children:"\ud83d\udd27 Built-in Questionnaire Editor"}),(0,l.jsx)("p",{children:"Visual questionnaire builder with essential features"}),(0,l.jsx)("div",{className:"lhc-forms-status warning",children:"\u26a0\ufe0f LHC-Forms library could not be loaded from local bundle - using fallback editor"})]}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"questionnaire-metadata-editor",children:[(0,l.jsx)("h5",{children:"Questionnaire Details"}),(0,l.jsxs)("div",{className:"metadata-grid",children:[(0,l.jsxs)("div",{className:"field-group",children:[(0,l.jsx)("label",{htmlFor:"questionnaire-title",children:"Title:"}),(0,l.jsx)("input",{id:"questionnaire-title",type:"text",value:o.title||"",onChange:e=>f("title",e.target.value),placeholder:"Enter questionnaire title"})]}),(0,l.jsxs)("div",{className:"field-group",children:[(0,l.jsx)("label",{htmlFor:"questionnaire-name",children:"Name:"}),(0,l.jsx)("input",{id:"questionnaire-name",type:"text",value:o.name||"",onChange:e=>f("name",e.target.value),placeholder:"Enter questionnaire name"})]}),(0,l.jsxs)("div",{className:"field-group",children:[(0,l.jsx)("label",{htmlFor:"questionnaire-status",children:"Status:"}),(0,l.jsxs)("select",{id:"questionnaire-status",value:o.status||"draft",onChange:e=>f("status",e.target.value),children:[(0,l.jsx)("option",{value:"draft",children:"Draft"}),(0,l.jsx)("option",{value:"active",children:"Active"}),(0,l.jsx)("option",{value:"retired",children:"Retired"})]})]}),(0,l.jsxs)("div",{className:"field-group",children:[(0,l.jsx)("label",{htmlFor:"questionnaire-publisher",children:"Publisher:"}),(0,l.jsx)("input",{id:"questionnaire-publisher",type:"text",value:o.publisher||"",onChange:e=>f("publisher",e.target.value),placeholder:"Enter publisher"})]})]}),(0,l.jsxs)("div",{className:"field-group",children:[(0,l.jsx)("label",{htmlFor:"questionnaire-description",children:"Description:"}),(0,l.jsx)("textarea",{id:"questionnaire-description",value:o.description||"",onChange:e=>f("description",e.target.value),placeholder:"Enter questionnaire description",rows:3})]})]}),(0,l.jsxs)("div",{className:"questions-builder",children:[(0,l.jsxs)("div",{className:"questions-header",children:[(0,l.jsxs)("h5",{children:["Questions (",(null===(s=o.item)||void 0===s?void 0:s.length)||0,")"]}),(0,l.jsx)("button",{onClick:()=>{var e;const i={linkId:"item-".concat(Date.now()),text:"New Question ".concat(((null===(e=o.item)||void 0===e?void 0:e.length)||0)+1),type:"string",required:!1},s=(0,n.A)((0,n.A)({},o),{},{item:[...o.item||[],i]});a(s)},className:"add-question-btn",children:"+ Add Question"})]}),null===(r=o.item)||void 0===r?void 0:r.map((e,i)=>(0,l.jsxs)("div",{className:"question-editor",children:[(0,l.jsxs)("div",{className:"question-header",children:[(0,l.jsxs)("span",{className:"question-number",children:["Q",i+1]}),(0,l.jsx)("button",{onClick:()=>(e=>{if(!o.item)return;const i=o.item.filter((i,s)=>s!==e),s=(0,n.A)((0,n.A)({},o),{},{item:i});a(s)})(i),className:"remove-question-btn",title:"Remove question",children:"\u2715"})]}),(0,l.jsxs)("div",{className:"question-fields",children:[(0,l.jsxs)("div",{className:"field-group",children:[(0,l.jsx)("label",{htmlFor:"question-text-".concat(i),children:"Question Text:"}),(0,l.jsx)("input",{id:"question-text-".concat(i),type:"text",value:e.text||"",onChange:e=>g(i,"text",e.target.value),placeholder:"Enter question text"})]}),(0,l.jsxs)("div",{className:"field-group",children:[(0,l.jsx)("label",{htmlFor:"question-linkid-".concat(i),children:"Link ID:"}),(0,l.jsx)("input",{id:"question-linkid-".concat(i),type:"text",value:e.linkId||"",onChange:e=>g(i,"linkId",e.target.value),placeholder:"Enter unique ID"})]}),(0,l.jsxs)("div",{className:"field-group",children:[(0,l.jsx)("label",{htmlFor:"question-type-".concat(i),children:"Question Type:"}),(0,l.jsxs)("select",{id:"question-type-".concat(i),value:e.type||"string",onChange:e=>g(i,"type",e.target.value),children:[(0,l.jsx)("option",{value:"string",children:"Short Text"}),(0,l.jsx)("option",{value:"text",children:"Long Text"}),(0,l.jsx)("option",{value:"boolean",children:"Yes/No"}),(0,l.jsx)("option",{value:"decimal",children:"Decimal Number"}),(0,l.jsx)("option",{value:"integer",children:"Integer"}),(0,l.jsx)("option",{value:"date",children:"Date"}),(0,l.jsx)("option",{value:"choice",children:"Single Choice"}),(0,l.jsx)("option",{value:"open-choice",children:"Choice with Other"})]})]}),(0,l.jsx)("div",{className:"field-group checkbox-group",children:(0,l.jsxs)("label",{children:[(0,l.jsx)("input",{type:"checkbox",checked:e.required||!1,onChange:e=>g(i,"required",e.target.checked)}),"Required"]})})]})]},e.linkId)),(!o.item||0===o.item.length)&&(0,l.jsx)("div",{className:"no-questions",children:(0,l.jsx)("p",{children:'No questions yet. Click "Add Question" to get started.'})})]})]})]})})]}):(0,l.jsxs)("div",{className:"lforms-loading",children:[(0,l.jsx)("div",{className:"loading-spinner"}),(0,l.jsx)("p",{children:"Loading LHC-Forms visual editor..."})]})})},c=()=>{var e;const{repository:i,branch:s,isLoading:c}=(0,r.oc)(),[u,h]=(0,t.useState)([]),[m,x]=(0,t.useState)(null),[p,j]=(0,t.useState)(!0),[v,g]=(0,t.useState)(null),[f,y]=(0,t.useState)(!1),[N,b]=(0,t.useState)(null),[q,w]=(0,t.useState)(null),[S,F]=(0,t.useState)(!1),[C,E]=(0,t.useState)("visual"),[k,L]=(0,t.useState)(null),I=i&&s&&!c;if((0,t.useEffect)(()=>{(async()=>{try{L(null),console.log("Initializing LForms lazy loading..."),F(!0),console.log("LForms lazy loading initialized successfully")}catch(v){console.error("Failed to initialize LForms:",v),L("Failed to initialize questionnaire editor: ".concat(v.message)),F(!0)}})()},[]),(0,t.useEffect)(()=>{(async()=>{if(I)try{console.log("QuestionnaireEditor: Loading questionnaires for",i.name,"branch",s),j(!0),g(null);const e=[],t=[{path:"input/questionnaires",extensions:[".json"],type:"JSON"},{path:"input/fsh/questionnaires",extensions:[".fsh"],type:"FSH"}];for(const r of t)try{const t=(await a.A.getDirectoryContents(i.owner.login,i.name,r.path,s)).filter(e=>"file"===e.type&&r.extensions.some(i=>e.name.endsWith(i))).map(e=>{const i=r.extensions.find(i=>e.name.endsWith(i));return(0,n.A)((0,n.A)({},e),{},{displayName:e.name.replace(i,""),fullPath:"".concat(r.path,"/").concat(e.name),fileType:r.type,extension:i})});e.push(...t)}catch(v){404!==v.status&&console.warn("Error loading from ".concat(r.path,":"),v)}h(e)}catch(v){console.error("Error loading questionnaires:",v),g("Failed to load questionnaires: ".concat(v.message))}finally{j(!1)}else console.log("QuestionnaireEditor: Waiting for PageProvider context...",{repository:!!i,branch:!!s,pageLoading:c})})()},[I,i,s,c]),!i||!s)return(0,l.jsxs)("div",{className:"questionnaire-editor-loading",children:[(0,l.jsx)("div",{className:"loading-spinner"}),(0,l.jsx)("p",{children:"Initializing Questionnaire Editor..."})]});const Q=async e=>{try{j(!0);const n=await a.A.getFileContent(i.owner.login,i.name,e.fullPath,s);let t;"JSON"===e.fileType?t=JSON.parse(n):"FSH"===e.fileType&&(t={resourceType:"Questionnaire",fileType:"FSH",title:H(n)||e.displayName,status:T(n)||"draft",name:O(n)||e.displayName,description:A(n)||"FHIR Shorthand Questionnaire",rawContent:n,isReadOnly:!0}),b(t),w(n),x(e),y(!0),console.log("Questionnaire loaded:",t)}catch(v){console.error("Error loading questionnaire content:",v),g("Failed to load questionnaire: ".concat(v.message))}finally{j(!1)}},H=e=>{const i=[/\*\s*title\s*=\s*"([^"]+)"/,/^\s*Title:\s*"?([^"\n]+)"?/m,/Instance:\s*\w+\s*"([^"]+)"/];for(const s of i){const i=e.match(s);if(i)return i[1].trim()}return null},T=e=>{const i=[/\*\s*status\s*=\s*#(\w+)/,/^\s*Status:\s*#?(\w+)/m];for(const s of i){const i=e.match(s);if(i)return i[1]}return null},O=e=>{const i=[/\*\s*name\s*=\s*"([^"]+)"/,/^\s*Name:\s*"?([^"\n]+)"?/m,/Instance:\s*(\w+)/];for(const s of i){const i=e.match(s);if(i)return i[1].trim()}return null},A=e=>{const i=[/\*\s*description\s*=\s*"([^"]+)"/,/^\s*Description:\s*"?([^"\n]+)"?/m,/\/\/\s*(.+)/];for(const s of i){const i=e.match(s);if(i)return i[1].trim()}return null},D=()=>{const e={resourceType:"Questionnaire",id:"questionnaire-".concat(Date.now()),meta:{versionId:"1",lastUpdated:(new Date).toISOString()},url:"http://example.org/Questionnaire/".concat(Date.now()),name:"NewQuestionnaire",title:"New Questionnaire",status:"draft",date:(new Date).toISOString().split("T")[0],publisher:"WHO SMART Guidelines",description:"A new FHIR Questionnaire",item:[{linkId:"1",text:"Sample Question",type:"string",required:!1}]};b(e),w(JSON.stringify(e,null,2)),x({name:"".concat(e.name,".json"),displayName:e.name,fullPath:"input/questionnaires/".concat(e.name,".json"),fileType:"JSON",isNew:!0}),y(!0),E("visual"),console.log("New questionnaire created:",e)},R=N&&q&&JSON.stringify(N,null,2)!==q;return I?p&&!f?(0,l.jsx)(r.ox,{pageName:"questionnaire-editor",repository:i,branch:s,children:(0,l.jsxs)("div",{className:"questionnaire-editor-loading",children:[(0,l.jsx)("h2",{children:"Loading Questionnaires..."}),(0,l.jsx)("p",{children:"Fetching questionnaire files from repository..."})]})}):(0,l.jsx)(r.ox,{pageName:"questionnaire-editor",file:m,repository:i,branch:s,content:N?JSON.stringify(N,null,2):null,originalContent:q,hasChanges:R,onSave:(e,t)=>{if(console.log("Questionnaire saved to ".concat(t)),"github"===t){const e=async()=>{try{const e=[],t=[{path:"input/questionnaires",extensions:[".json"],type:"JSON"},{path:"input/fsh/questionnaires",extensions:[".fsh"],type:"FSH"}];for(const r of t)try{const t=(await a.A.getDirectoryContents(i.owner.login,i.name,r.path,s)).filter(e=>"file"===e.type&&r.extensions.some(i=>e.name.endsWith(i))).map(e=>{const i=r.extensions.find(i=>e.name.endsWith(i));return(0,n.A)((0,n.A)({},e),{},{displayName:e.name.replace(i,""),fullPath:"".concat(r.path,"/").concat(e.name),fileType:r.type,extension:i})});e.push(...t)}catch(v){404!==v.status&&console.warn("Error loading from ".concat(r.path,":"),v)}h(e)}catch(v){console.error("Error refreshing questionnaires:",v)}};e()}},showSaveButtons:f,children:(0,l.jsxs)("div",{className:"questionnaire-editor",children:[(0,l.jsxs)("div",{className:"questionnaire-content",children:[v&&(0,l.jsxs)("div",{className:"error-message",children:[(0,l.jsx)("strong",{children:"Error:"})," ",v]}),f?(0,l.jsxs)("div",{className:"questionnaire-editor-container",children:[(0,l.jsxs)("div",{className:"editor-header",children:[(0,l.jsx)("button",{onClick:()=>y(!1),className:"back-to-list",children:"\u2190 Back to List"}),(0,l.jsx)("h2",{children:(null===m||void 0===m?void 0:m.displayName)||"New Questionnaire"}),"FSH"!==(null===N||void 0===N?void 0:N.fileType)&&(0,l.jsxs)("div",{className:"edit-mode-toggle",children:[(0,l.jsx)("button",{className:"mode-btn ".concat("visual"===C?"active":""),onClick:()=>E("visual"),children:"\ud83d\udcdd Visual Editor"}),(0,l.jsx)("button",{className:"mode-btn ".concat("json"===C?"active":""),onClick:()=>E("json"),children:" JSON Editor"})]})]}),k&&(0,l.jsxs)("div",{className:"error-message",children:[(0,l.jsx)("strong",{children:"Editor Error:"})," ",k]}),S?(0,l.jsxs)("div",{className:"lforms-container",children:[(0,l.jsxs)("div",{className:"questionnaire-preview",children:[(0,l.jsx)("h4",{children:"Questionnaire Preview"}),(0,l.jsxs)("div",{className:"questionnaire-metadata",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Title:"})," ",(null===N||void 0===N?void 0:N.title)||"Untitled"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Status:"})," ",(null===N||void 0===N?void 0:N.status)||"draft"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Format:"})," ",(null===N||void 0===N?void 0:N.fileType)||"JSON"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Date:"})," ",(null===N||void 0===N?void 0:N.date)||"Not specified"]}),"FSH"!==(null===N||void 0===N?void 0:N.fileType)&&(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Items:"})," ",(null===N||void 0===N||null===(e=N.item)||void 0===e?void 0:e.length)||0," questions"]})]})]}),"FSH"===(null===N||void 0===N?void 0:N.fileType)?(0,l.jsxs)("div",{className:"questionnaire-content-editor",children:[(0,l.jsxs)("h4",{children:["FHIR Shorthand Content",(0,l.jsx)("span",{className:"readonly-badge",children:" (Read-Only)"})]}),(0,l.jsxs)("div",{className:"fsh-editor",children:[(0,l.jsx)("textarea",{value:(null===N||void 0===N?void 0:N.rawContent)||"",readOnly:!0,className:"fsh-content",rows:20}),(0,l.jsxs)("div",{className:"fsh-notice",children:[(0,l.jsx)("strong",{children:"\ud83d\udcdd FSH File:"})," This is a FHIR Shorthand questionnaire. Direct editing is not supported yet - please edit the .fsh file directly in your repository."]})]})]}):"visual"===C?(0,l.jsxs)("div",{className:"visual-editor-section",children:[(0,l.jsx)("h4",{children:"Visual Questionnaire Builder"}),(0,l.jsx)("div",{className:"lforms-visual-editor",children:(0,l.jsx)(d,{questionnaire:N,onChange:e=>{b(e)},onError:L})})]}):(0,l.jsxs)("div",{className:"questionnaire-content-editor",children:[(0,l.jsx)("h4",{children:"Raw JSON Content"}),(0,l.jsx)("textarea",{value:JSON.stringify(N,null,2),onChange:e=>{try{const i=JSON.parse(e.target.value);b(i)}catch(v){console.warn("Invalid JSON in editor")}},className:"json-editor",rows:20})]}),(0,l.jsxs)("div",{className:"editor-instructions",children:[(0,l.jsx)("h4",{children:"Editing Instructions:"}),"FSH"===(null===N||void 0===N?void 0:N.fileType)?(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"This is a FHIR Shorthand (.fsh) questionnaire file"}),(0,l.jsx)("li",{children:"FSH files define questionnaires using a domain-specific language"}),(0,l.jsx)("li",{children:"To edit this questionnaire, modify the .fsh file directly in your repository"}),(0,l.jsx)("li",{children:"FSH files are compiled into JSON during the build process"}),(0,l.jsxs)("li",{children:["Learn more about FHIR Shorthand at ",(0,l.jsx)("a",{href:"https://build.fhir.org/ig/HL7/fhir-shorthand/",target:"_blank",rel:"noopener noreferrer",children:"HL7 FHIR Shorthand"})]})]}):"visual"===C?(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Use the visual editor above to build your questionnaire interactively"}),(0,l.jsx)("li",{children:"Add, remove, and modify questions using the form builder interface"}),(0,l.jsx)("li",{children:"Preview your questionnaire as users will see it"}),(0,l.jsx)("li",{children:"Switch to JSON mode to see the raw FHIR Questionnaire structure"}),(0,l.jsx)("li",{children:"Changes are automatically saved as you work"})]}):(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Edit the JSON structure above to modify the questionnaire"}),(0,l.jsx)("li",{children:"The preview shows key questionnaire metadata"}),(0,l.jsx)("li",{children:"Changes are automatically detected for saving"}),(0,l.jsx)("li",{children:"Switch to Visual mode for an easier editing experience"}),(0,l.jsx)("li",{children:'Click "Save to Staging" to save changes locally'})]}),(0,l.jsxs)("div",{className:"help-tip",children:[(0,l.jsx)("strong",{children:"Note:"})," Use the visual editor above to build questionnaires interactively or switch to JSON mode for direct editing."]})]})]}):(0,l.jsx)("div",{className:"lforms-loading",children:(0,l.jsx)("p",{children:"Loading questionnaire editor..."})})]}):(0,l.jsxs)("div",{className:"questionnaire-list",children:[(0,l.jsxs)("div",{className:"list-header",children:[(0,l.jsxs)("h2",{children:["Questionnaires (",u.length,")"]}),(0,l.jsx)("button",{onClick:D,className:"btn-primary",disabled:!S,children:"+ Create New Questionnaire"})]}),0===u.length?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("div",{className:"empty-icon",children:"\ud83d\udccb"}),(0,l.jsx)("h3",{children:"No Questionnaires Found"}),(0,l.jsx)("p",{children:"This repository doesn't have any FHIR Questionnaire files yet."}),(0,l.jsx)("p",{children:"Questionnaires can be stored as:"}),(0,l.jsxs)("ul",{style:{textAlign:"left",maxWidth:"400px",margin:"0 auto"},children:[(0,l.jsxs)("li",{children:[(0,l.jsx)("code",{children:"input/questionnaires/*.json"})," - FHIR JSON format"]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("code",{children:"input/fsh/questionnaires/*.fsh"})," - FHIR Shorthand format"]})]}),(0,l.jsx)("button",{onClick:D,className:"btn-primary",disabled:!S,children:"Create Your First Questionnaire"})]}):(0,l.jsx)("div",{className:"questionnaire-grid",children:u.map(e=>(0,l.jsxs)("div",{className:"questionnaire-card",onClick:()=>Q(e),onKeyDown:i=>{"Enter"!==i.key&&" "!==i.key||(i.preventDefault(),Q(e))},role:"button",tabIndex:0,"aria-label":"Open ".concat(e.displayName," questionnaire"),children:[(0,l.jsx)("div",{className:"card-icon",children:"FSH"===e.fileType?"\ud83d\udcdd":"\ud83d\udccb"}),(0,l.jsxs)("div",{className:"card-content",children:[(0,l.jsx)("h3",{children:e.displayName}),(0,l.jsxs)("p",{className:"card-type",children:[e.fileType," Questionnaire"]}),(0,l.jsx)("p",{className:"card-path",children:e.fullPath}),(0,l.jsxs)("p",{className:"card-size",children:[(e.size/1024).toFixed(1)," KB"]})]})]},e.name))})]})]}),(0,l.jsx)(o.A,{pageId:"questionnaire-editor",contextData:{repository:i.name,branch:s,hasQuestionnaires:u.length>0,isEditing:f}})]})}):(0,l.jsx)(r.ox,{pageName:"questionnaire-editor",children:(0,l.jsxs)("div",{className:"questionnaire-editor-loading",children:[(0,l.jsx)("h2",{children:"Initializing Questionnaire Editor..."}),(0,l.jsx)("p",{children:"Loading repository context..."})]})})};class u extends t.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e.message}}componentDidCatch(e,i){console.error("QuestionnaireEditor caught an error:",e,i)}render(){return this.state.hasError?(0,l.jsx)(r.ox,{pageName:"questionnaire-editor",children:(0,l.jsxs)("div",{className:"error-state",children:[(0,l.jsx)("h2",{children:"\u26a0\ufe0f Questionnaire Editor Error"}),(0,l.jsx)("p",{children:"An unexpected error occurred while loading the questionnaire editor."}),(0,l.jsxs)("div",{className:"error-details",children:[(0,l.jsx)("strong",{children:"Error:"})," ",this.state.error]}),(0,l.jsx)("button",{onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},className:"btn-primary",children:"Reload Editor"})]})}):this.props.children}}const h=()=>(0,l.jsx)(r.Mx,{pageName:"questionnaire-editor",children:(0,l.jsx)(u,{children:(0,l.jsx)(c,{})})})}}]);