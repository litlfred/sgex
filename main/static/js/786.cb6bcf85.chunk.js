"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[786],{12602:(e,t,o)=>{o.d(t,{A:()=>n});const n=new class{constructor(){this.universalTopics={documentation:{id:"sgex-documentation",title:"View Documentation",badge:"/sgex/cat-paw-info-icon.svg",type:"action",action:()=>{const e=window.location.pathname;let t="";if(e.includes("/sgex")){const o=e.split("/"),n=o.indexOf("sgex");-1!==n&&(t=o.length>n+2&&o[n+1]&&!["dashboard","docs","select_profile","dak-action","dak-selection"].includes(o[n+1])?"/".concat(o.slice(1,n+2).join("/")):"/".concat(o.slice(1,n+1).join("/")))}window.location.href="".concat(t,"/docs/overview")},content:'\n          <p>Access comprehensive documentation and guides for using SGEX Workbench.</p>\n          <div class="help-tip">\n            <strong>\ud83d\udcd6 Available Documentation:</strong> Requirements, Architecture, DAK Components, User Guides, and more.\n          </div>\n        '},bugReport:{id:"report-sgex-bug",title:"Report a SGeX bug",badge:"/sgex/cat-paw-bug-icon.svg",type:"slideshow",content:[{title:"Report a Bug or Issue",content:'\n              <p>Help us improve SGeX by reporting bugs and issues:</p>\n              <h4>What type of issue are you experiencing?</h4>\n              <div class="bug-report-options">\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'bug\')">\n                  \ud83d\udc1b Bug Report - Something isn\'t working correctly\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'feature\')">\n                  \u2728 Feature Request - Suggest a new feature or improvement\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'question\')">\n                  \u2753 Question - Ask for help or clarification\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'documentation\')">\n                  \ud83d\udcda Documentation Issue - Report problems with documentation\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openSgexIssue(\'blank\')">\n                  \ud83d\udcdd Blank Issue - Create an issue without a template\n                </button>\n              </div>\n              <div class="help-tip">\n                <strong>\ud83d\udca1 Tip:</strong> Please provide as much detail as possible including steps to reproduce, expected behavior, and actual behavior.\n              </div>\n              <div class="help-fallback">\n                <strong>\ud83d\udd17 Can\'t access GitHub?</strong> If the buttons above don\'t work in your environment:\n                <ol>\n                  <li>Email us directly at <a href="mailto:smart@who.int?subject=SGEX Bug Report">smart@who.int</a></li>\n                  <li>Or visit <a href="https://github.com/litlfred/sgex/issues/new" target="_blank">github.com/litlfred/sgex/issues/new</a> manually</li>\n                </ol>\n              </div>\n            '}]},dakFeedback:{id:"provide-dak-feedback",title:"Provide DAK Feedback",type:"slideshow",content:[{title:"Provide Feedback on this DAK",content:'\n              <p>Share feedback about this Digital Adaptation Kit (DAK):</p>\n              <h4>What type of feedback do you have?</h4>\n              <div class="bug-report-options">\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'content\')">\n                  \ud83d\udcdd Report DAK Content Error - Problems with clinical content or logic\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'bug\')">\n                  \ud83d\udc1b DAK Bug - Issue with this specific DAK content\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'improvement\')">\n                  \ud83d\udcc8 DAK Improvement - Suggest enhancements to this DAK\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'question\')">\n                  \u2753 DAK Question - Ask about this DAK\'s implementation\n                </button>\n                <button class="bug-type-btn" onclick="window.helpModalInstance?.openDakIssue(\'blank\')">\n                  \ud83d\udcdd Blank DAK Issue - Create an issue without a template\n                </button>\n              </div>\n              <div class="help-tip">\n                <strong>\ud83d\udca1 Note:</strong> This will open an issue in the selected DAK repository for targeted feedback.\n              </div>\n            '}]}},this.helpTopics={"landing-page-unauthenticated":[{id:"github-pat-setup",title:"How to Create a GitHub Personal Access Token",badge:"/sgex/cat-paw-lock-icon.svg",type:"slideshow",content:[{title:"Step 1: Go to GitHub Settings",content:'\n                <p>Navigate to your GitHub account settings:</p>\n                <ol>\n                  <li>Click your profile picture in the top right</li>\n                  <li>Select "Settings" from the dropdown</li>\n                  <li>Go to "Developer settings" \u2192 "Personal access tokens"</li>\n                  <li>Choose "Fine-grained tokens" (recommended) or "Tokens (classic)"</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> Fine-grained tokens provide better security with repository-specific access.\n                </div>\n              '},{title:"Step 2: Generate New Token",content:'\n                <p>Create your new token:</p>\n                <ol>\n                  <li>Click "Generate new token"</li>\n                  <li>Give it a descriptive name like "SGEX Workbench"</li>\n                  <li>Set expiration (90 days recommended)</li>\n                  <li>Select repository access (specific repos or all)</li>\n                </ol>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Important:</strong> You\'ll only see the token once, so copy it immediately!\n                </div>\n              '},{title:"Step 3: Set Required Permissions",content:"\n                <p>For <strong>fine-grained tokens</strong>, enable:</p>\n                <ul>\n                  <li><strong>Contents:</strong> Read and Write</li>\n                  <li><strong>Metadata:</strong> Read</li>\n                  <li><strong>Pull requests:</strong> Read and Write</li>\n                </ul>\n                <p>For <strong>classic tokens</strong>, select:</p>\n                <ul>\n                  <li><strong>repo</strong> - Full control of private repositories</li>\n                  <li><strong>read:org</strong> - Read org and team membership</li>\n                </ul>\n              "},{title:"Step 4: Use Your Token",content:'\n                <p>Now you can authenticate with SGEX:</p>\n                <ol>\n                  <li>Copy your newly generated token</li>\n                  <li>Paste it into the login form</li>\n                  <li>Click "Sign in with Personal Access Token"</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udd12 Security:</strong> Your token is stored securely in your browser and never shared with servers.\n                </div>\n              '}]}],"landing-page-authenticated":[{id:"profile-selection",title:"Selecting Your Profile or Organization",type:"slideshow",content:[{title:"Understanding Profile Types",content:'\n                <p>SGEX shows different types of profiles:</p>\n                <ul>\n                  <li><strong>Personal:</strong> Your individual GitHub repositories</li>\n                  <li><strong>Organization:</strong> Repositories belonging to organizations you\'re a member of</li>\n                  <li><strong>WHO Official:</strong> World Health Organization repositories (always available)</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> DAK count badges show how many SMART Guidelines repositories were found.\n                </div>\n              '}]}],"dak-action-selection":[{id:"choosing-dak-action",title:"Choosing Your DAK Action",type:"slideshow",content:[{title:"Understanding DAK Actions",content:'\n                <p>Choose the right action for your workflow:</p>\n                <ul>\n                  <li><strong>Edit Existing DAK:</strong> Modify an existing repository you have write access to</li>\n                  <li><strong>Fork and Edit:</strong> Create your own copy of a repository to work on</li>\n                  <li><strong>Create New DAK:</strong> Start a brand new DAK repository from scratch</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> If you\'re not sure, start with "Edit Existing DAK" if you have permissions, or "Fork and Edit" to experiment safely.\n                </div>\n              '}]}],"documentation-viewer":[{id:"navigation-help",title:"Navigating Documentation",type:"slideshow",content:[{title:"Using the Documentation Viewer",content:'\n                <p>The documentation viewer provides easy access to all project information:</p>\n                <ul>\n                  <li>Use the sidebar menu to navigate between sections</li>\n                  <li>Use the dropdown to quickly jump to any document</li>\n                  <li>Click "Back" to return to the previous page</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udcd6 Available Documentation:</strong> Requirements, Architecture, DAK Components, and more.\n                </div>\n              '}]}],"dak-dashboard":[{id:"dak-components-overview",title:"Understanding DAK Components",type:"slideshow",content:[{title:"WHO SMART Guidelines DAK Components",content:"\n                <p>Digital Adaptation Kits (DAKs) contain 8 core components organized in two levels:</p>\n                <h4>Level 2: Business Logic & Processes</h4>\n                <ul>\n                  <li><strong>Business Processes:</strong> BPMN workflows</li>\n                  <li><strong>Decision Support Logic:</strong> DMN decision tables</li>\n                  <li><strong>Indicators & Measures:</strong> Performance metrics</li>\n                  <li><strong>Data Entry Forms:</strong> Structured questionnaires</li>\n                </ul>\n                <h4>Level 3: Technical Implementation</h4>\n                <ul>\n                  <li><strong>Terminology:</strong> Code systems and value sets</li>\n                  <li><strong>FHIR Profiles:</strong> Resource structure definitions</li>\n                  <li><strong>FHIR Extensions:</strong> Custom data elements</li>\n                  <li><strong>Test Data & Examples:</strong> Sample data for validation</li>\n                </ul>\n              "}]}],"dak-selection":[{id:"choosing-dak-repository",title:"Selecting the Right DAK Repository",type:"slideshow",content:[{title:"Understanding DAK Repository Types",content:'\n                <p>Choose the right repository based on your workflow:</p>\n                <ul>\n                  <li><strong>Published DAKs:</strong> Official WHO repositories with complete implementations</li>\n                  <li><strong>Community DAKs:</strong> Community-maintained repositories with adaptations</li>\n                  <li><strong>Template DAKs:</strong> Starting templates for creating new DAKs</li>\n                  <li><strong>Private DAKs:</strong> Your private repositories or organization-specific DAKs</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> Look for the "SMART Guidelines" badge to ensure compatibility.\n                </div>\n              '}]}],"organization-selection":[{id:"selecting-organization",title:"Choosing an Organization",type:"slideshow",content:[{title:"Organization vs Personal Account",content:'\n                <p>Decide where to create or fork your DAK:</p>\n                <ul>\n                  <li><strong>Personal Account:</strong> For individual development and experimentation</li>\n                  <li><strong>Organization Account:</strong> For team collaboration and official implementations</li>\n                  <li><strong>WHO Official:</strong> Only for authorized WHO contributors</li>\n                </ul>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Important:</strong> Make sure you have the necessary permissions for the selected organization.\n                </div>\n              '}]}],"bpmn-editor":[{id:"using-bpmn-editor",title:"Using the BPMN Editor",type:"slideshow",content:[{title:"BPMN Business Process Modeling",content:'\n                <p>The BPMN editor helps you create and modify business process workflows:</p>\n                <ul>\n                  <li><strong>Drag and Drop:</strong> Use the palette to add process elements</li>\n                  <li><strong>Connect Elements:</strong> Click and drag to create sequence flows</li>\n                  <li><strong>Properties Panel:</strong> Configure element properties and conditions</li>\n                  <li><strong>Validation:</strong> The editor highlights errors and warnings</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> BPMN processes define the clinical workflow and decision logic for your DAK.\n                </div>\n              '}]}],"questionnaire-editor":[{id:"using-questionnaire-editor",title:"Using the FHIR Questionnaire Editor",badge:"/sgex/cat-paw-icon.svg",type:"slideshow",content:[{title:"FHIR Questionnaire Overview",content:'\n                <p>The FHIR Questionnaire editor helps you create and modify structured data collection forms:</p>\n                <ul>\n                  <li><strong>Visual Editor:</strong> Uses LHC-Forms for intuitive questionnaire design</li>\n                  <li><strong>FHIR Compliant:</strong> Generates standard FHIR R4 Questionnaire resources</li>\n                  <li><strong>Multilingual:</strong> Support for multiple languages and translations</li>\n                  <li><strong>Preview Mode:</strong> Test questionnaires as they would appear to users</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udccb File Location:</strong> Questionnaires are stored in <code>input/questionnaires/*.json</code>\n                </div>\n              '},{title:"Creating New Questionnaires",content:'\n                <p>To create a new FHIR Questionnaire:</p>\n                <ol>\n                  <li>Click "Create New Questionnaire" on the main screen</li>\n                  <li>A template questionnaire will be loaded in the editor</li>\n                  <li>Modify the questionnaire structure using the visual interface</li>\n                  <li>Add questions, sections, and response options</li>\n                  <li>Set validation rules and conditional logic</li>\n                </ol>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Remember:</strong> Save your work regularly using "Save to Staging" or "Commit to GitHub"\n                </div>\n              '},{title:"Editing Existing Questionnaires",content:'\n                <p>To modify existing questionnaires:</p>\n                <ol>\n                  <li>Select a questionnaire from the list</li>\n                  <li>The questionnaire will load in the LHC-Forms editor</li>\n                  <li>Make your changes using the visual interface</li>\n                  <li>Preview the form to test user experience</li>\n                  <li>Save changes when satisfied</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> Use the staging framework to test changes before committing to GitHub\n                </div>\n              '},{title:"Internationalization Support",content:'\n                <p>The questionnaire editor supports multiple languages:</p>\n                <ul>\n                  <li><strong>Language Selection:</strong> Use the language dropdown to switch between languages</li>\n                  <li><strong>Translations:</strong> Add translations for all text fields</li>\n                  <li><strong>FHIR Extensions:</strong> Uses standard FHIR translation extensions</li>\n                  <li><strong>Preview:</strong> Test questionnaires in different languages</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83c\udf0d Best Practice:</strong> Always provide translations for your target implementation languages\n                </div>\n              '}]},{id:"questionnaire-management",title:"Managing Questionnaire Assets",badge:"/sgex/cat-paw-file-icon.svg",type:"slideshow",content:[{title:"File Organization",content:'\n                <p>FHIR Questionnaires are organized as follows:</p>\n                <ul>\n                  <li><strong>Location:</strong> <code>input/questionnaires/</code> directory</li>\n                  <li><strong>Format:</strong> JSON files following FHIR R4 Questionnaire schema</li>\n                  <li><strong>Naming:</strong> Use descriptive names like <code>patient-registration.json</code></li>\n                  <li><strong>Validation:</strong> All files are validated against FHIR schema</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udcc1 Convention:</strong> Use kebab-case filenames for consistency\n                </div>\n              '},{title:"Version Control Integration",content:'\n                <p>The questionnaire editor integrates with GitHub for version control:</p>\n                <ul>\n                  <li><strong>Staging:</strong> Save changes locally before committing</li>\n                  <li><strong>Commits:</strong> Create meaningful commit messages</li>\n                  <li><strong>Branches:</strong> Work on different branches for features</li>\n                  <li><strong>History:</strong> Track changes and revert if needed</li>\n                </ul>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Important:</strong> Always test questionnaires before committing to main branch\n                </div>\n              '}]}],"component-editor":[{id:"component-editor-overview",title:"Understanding the Component Editor",type:"slideshow",content:[{title:"DAK Component Types",content:"\n                <p>The component editor provides specialized interfaces for different DAK components:</p>\n                <h4>Business Logic Components</h4>\n                <ul>\n                  <li><strong>Business Processes:</strong> BPMN workflow editor</li>\n                  <li><strong>Decision Logic:</strong> DMN decision table editor</li>\n                  <li><strong>Forms:</strong> Structured questionnaire builder</li>\n                </ul>\n                <h4>Technical Components</h4>\n                <ul>\n                  <li><strong>FHIR Resources:</strong> Profile and extension definitions</li>\n                  <li><strong>Terminology:</strong> Code systems and value sets</li>\n                  <li><strong>Test Data:</strong> Example data and test cases</li>\n                </ul>\n              "}]}],"pat-login":[{id:"pat-authentication-help",title:"Using Personal Access Tokens",badge:"/sgex/cat-paw-lock-icon.svg",type:"slideshow",content:[{title:"Why Personal Access Tokens?",content:'\n                <p>SGEX uses GitHub Personal Access Tokens (PATs) for secure authentication:</p>\n                <ul>\n                  <li><strong>No Backend Required:</strong> Works entirely in your browser</li>\n                  <li><strong>Fine-grained Control:</strong> Choose which repositories to access</li>\n                  <li><strong>Enhanced Security:</strong> Can be easily rotated and revoked</li>\n                  <li><strong>Privacy Focused:</strong> Your token never leaves your browser</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udd12 Security:</strong> SGEX stores your token locally and never transmits it to any server.\n                </div>\n              '}]}],"pat-setup-instructions":[{id:"detailed-pat-setup",title:"Detailed PAT Setup Guide",badge:"/sgex/cat-paw-lock-icon.svg",type:"slideshow",content:[{title:"Token Type Comparison",content:"\n                <p>GitHub offers two types of Personal Access Tokens:</p>\n                <h4>Fine-grained Tokens (Recommended)</h4>\n                <ul>\n                  <li>Repository-specific access control</li>\n                  <li>Better security with minimal permissions</li>\n                  <li>More granular permission settings</li>\n                  <li>Shorter default expiration times</li>\n                </ul>\n                <h4>Classic Tokens</h4>\n                <ul>\n                  <li>Broader scope-based permissions</li>\n                  <li>Simpler permission model</li>\n                  <li>Longer expiration options</li>\n                  <li>Works with all GitHub integrations</li>\n                </ul>\n              "}]}],welcome:[{id:"github-pat-setup",title:"How to Create a GitHub Personal Access Token",badge:"/sgex/cat-paw-lock-icon.svg",type:"slideshow",content:[{title:"Step 1: Go to GitHub Settings",content:'\n                <p>Navigate to your GitHub account settings:</p>\n                <ol>\n                  <li>Click your profile picture in the top right</li>\n                  <li>Select "Settings" from the dropdown</li>\n                  <li>Go to "Developer settings" \u2192 "Personal access tokens"</li>\n                  <li>Choose "Fine-grained tokens" (recommended) or "Tokens (classic)"</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Tip:</strong> Fine-grained tokens provide better security with repository-specific access.\n                </div>\n              '},{title:"Step 2: Generate New Token",content:'\n                <p>Create your new token:</p>\n                <ol>\n                  <li>Click "Generate new token"</li>\n                  <li>Give it a descriptive name like "SGEX Workbench"</li>\n                  <li>Set expiration (90 days recommended)</li>\n                  <li>Select repository access (specific repos or all)</li>\n                </ol>\n                <div class="help-warning">\n                  <strong>\u26a0\ufe0f Important:</strong> You\'ll only see the token once, so copy it immediately!\n                </div>\n              '},{title:"Step 3: Set Required Permissions",content:"\n                <p>For <strong>fine-grained tokens</strong>, enable:</p>\n                <ul>\n                  <li><strong>Contents:</strong> Read and Write</li>\n                  <li><strong>Metadata:</strong> Read</li>\n                  <li><strong>Pull requests:</strong> Read and Write</li>\n                </ul>\n                <p>For <strong>classic tokens</strong>, select:</p>\n                <ul>\n                  <li><strong>repo</strong> - Full control of private repositories</li>\n                  <li><strong>read:org</strong> - Read org and team membership</li>\n                </ul>\n              "},{title:"Step 4: Use Your Token",content:'\n                <p>Now you can authenticate with SGEX:</p>\n                <ol>\n                  <li>Copy your newly generated token</li>\n                  <li>Paste it into the login form</li>\n                  <li>Click "Sign in with Personal Access Token"</li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udd12 Security:</strong> Your token is stored securely in your browser and never shared with servers.\n                </div>\n              '}]}],"dak-configuration":[{id:"dak-configuration-guide",title:"Configuring Your DAK",type:"slideshow",content:[{title:"Understanding DAK Configuration",content:"\n                <p>When creating a new DAK, you need to configure both repository and FHIR settings:</p>\n                <h4>Repository Configuration</h4>\n                <ul>\n                  <li><strong>Repository Name:</strong> GitHub repository identifier (lowercase with hyphens)</li>\n                  <li><strong>Description:</strong> Brief description of your DAK's purpose</li>\n                  <li><strong>Topics:</strong> Tags that help others discover your DAK</li>\n                  <li><strong>Visibility:</strong> Public repositories are discoverable by the community</li>\n                </ul>\n                <h4>FHIR Implementation Guide Settings</h4>\n                <ul>\n                  <li><strong>IG ID:</strong> Unique identifier for your Implementation Guide</li>\n                  <li><strong>Name:</strong> Technical name used in code generation</li>\n                  <li><strong>Title:</strong> Human-readable title for documentation</li>\n                  <li><strong>Publisher:</strong> Organization responsible for the DAK</li>\n                </ul>\n              "}]}],"core-data-dictionary-viewer":[{id:"core-data-dictionary-help",title:"Understanding Core Data Dictionary",badge:"/sgex/cat-paw-info-icon.svg",type:"slideshow",content:[{title:"What is the Core Data Dictionary?",content:'\n                <p>The Core Data Dictionary (Component 2) contains the data elements required throughout the different points of the workflow. These data elements are mapped to the International Classification of Diseases version 11 (ICD-11) codes and other established concept mapping standards to ensure the data dictionary is compatible with other digital systems.</p>\n                <h4>Purpose: System Design and Interoperability</h4>\n                <p>To know which data elements need to be logged and how they map to other standard terminologies (e.g. ICD, Systematized Nomenclature of Medicine [SNOMED]) for interoperability with other standards-based systems.</p>\n                <h4>FHIR FSH Source Files</h4>\n                <ul>\n                  <li><strong>CodeSystems:</strong> Define custom codes and concepts used in your DAK</li>\n                  <li><strong>ValueSets:</strong> Specify allowed values for clinical data elements</li>\n                  <li><strong>ConceptMaps:</strong> Map between different terminology systems including ICD-11 and SNOMED</li>\n                  <li><strong>Logical Models:</strong> Define data structures for clinical workflows</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Location:</strong> FSH files are stored in the <code>input/fsh/</code> directory of your repository.\n                </div>\n              '},{title:"GitHub Pages Integration",content:'\n                <p>When GitHub Pages is configured, your FSH files are automatically compiled into HTML documentation:</p>\n                <h4>Published Artifacts</h4>\n                <ul>\n                  <li><strong>Code Systems:</strong> Browse and search your custom terminologies</li>\n                  <li><strong>Value Sets:</strong> View allowed values with descriptions</li>\n                  <li><strong>Logical Models:</strong> Interactive data structure documentation</li>\n                  <li><strong>Concept Maps:</strong> Visual mapping between terminologies</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\u26a1 URL Pattern:</strong> Main branch publishes to <code>user.github.io/repo</code>, feature branches to <code>user.github.io/repo/branches/branch-name</code>\n                </div>\n              '}]},{id:"github-pages-setup",title:"Setting Up GitHub Pages",badge:"/sgex/cat-paw-settings-icon.svg",type:"slideshow",content:[{title:"Enable GitHub Pages for Your DAK",content:'\n                <p>Follow these steps to enable automatic publishing of your Implementation Guide:</p>\n                <h4>Step 1: Repository Settings</h4>\n                <ol>\n                  <li>Go to your repository on GitHub</li>\n                  <li>Click on the <strong>Settings</strong> tab</li>\n                  <li>Scroll down to <strong>Pages</strong> in the left sidebar</li>\n                  <li>Under <strong>Source</strong>, select <strong>GitHub Actions</strong></li>\n                </ol>\n                <div class="help-tip">\n                  <strong>\ud83d\udccb Note:</strong> Your repository must contain a valid FHIR Implementation Guide structure with <code>sushi-config.yaml</code>\n                </div>\n              '},{title:"Configure IG Publisher Workflow",content:'\n                <p>Set up the automated publishing workflow:</p>\n                <h4>Step 2: GitHub Actions</h4>\n                <ol>\n                  <li>Create <code>.github/workflows/</code> directory in your repository</li>\n                  <li>Add an IG Publisher workflow file (e.g., <code>publish.yml</code>)</li>\n                  <li>Configure the workflow to run on push to main branch</li>\n                  <li>Include steps to build and deploy the Implementation Guide</li>\n                </ol>\n                <h4>Step 3: Verify Publishing</h4>\n                <ul>\n                  <li>Check the <strong>Actions</strong> tab for workflow status</li>\n                  <li>Once successful, visit your GitHub Pages URL</li>\n                  <li>Verify that artifacts are accessible from the Core Data Dictionary viewer</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udd17 Reference:</strong> See the <a href="https://smart.who.int/ig-starter-kit/v1.0.0/ig_setup.html#ghpages-build" target="_blank">WHO IG Starter Kit</a> for detailed setup instructions.\n                </div>\n              '}]}],"business-process-selection":[{id:"business-process-help",title:"Understanding Business Processes",badge:"/sgex/cat-paw-workflow-icon.svg",type:"slideshow",content:[{title:"What are Business Processes?",content:'\n                <p>Business Processes (Component 5) define the clinical workflows and care processes in your DAK:</p>\n                <h4>BPMN 2.0 Diagrams</h4>\n                <ul>\n                  <li><strong>Clinical Workflows:</strong> Step-by-step patient care processes</li>\n                  <li><strong>Decision Points:</strong> Where clinical decisions are made</li>\n                  <li><strong>Task Assignments:</strong> Who performs each step in the workflow</li>\n                  <li><strong>Data Flows:</strong> How information moves through the process</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Standard:</strong> Uses BPMN 2.0 (Business Process Model and Notation) for workflow modeling\n                </div>\n              '},{title:"Working with BPMN Files",content:'\n                <p>Business process diagrams are stored as BPMN XML files in your repository:</p>\n                <h4>File Management</h4>\n                <ul>\n                  <li><strong>Location:</strong> Typically stored in <code>input/models/</code> or <code>input/bpmn/</code></li>\n                  <li><strong>Format:</strong> BPMN 2.0 XML standard format</li>\n                  <li><strong>Editing:</strong> Use the built-in BPMN editor or external tools</li>\n                  <li><strong>Validation:</strong> Automatic validation against BPMN 2.0 schema</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udd27 Tools:</strong> SGeX includes an integrated BPMN editor for creating and modifying workflow diagrams\n                </div>\n              '}]}],"pages-manager":[{id:"page-content-help",title:"Managing Page Content",badge:"/sgex/cat-paw-document-icon.svg",type:"slideshow",content:[{title:"What is Page Content?",content:'\n                <p>Page Content represents the narrative documentation and educational materials in your DAK:</p>\n                <h4>Content Types</h4>\n                <ul>\n                  <li><strong>Clinical Guidelines:</strong> Evidence-based care recommendations</li>\n                  <li><strong>User Guides:</strong> Instructions for healthcare workers</li>\n                  <li><strong>Training Materials:</strong> Educational content and scenarios</li>\n                  <li><strong>Reference Documentation:</strong> Technical specifications and background</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udca1 Format:</strong> Content is typically authored in Markdown format for easy editing and version control\n                </div>\n              '},{title:"Content Organization",content:'\n                <p>Page content is organized to support different user needs and workflows:</p>\n                <h4>Structure</h4>\n                <ul>\n                  <li><strong>Pages Directory:</strong> Main content files organized by topic</li>\n                  <li><strong>Assets:</strong> Images, diagrams, and multimedia content</li>\n                  <li><strong>Templates:</strong> Reusable content patterns and layouts</li>\n                  <li><strong>Navigation:</strong> Menus and linking between related content</li>\n                </ul>\n                <h4>Publishing</h4>\n                <ul>\n                  <li><strong>GitHub Pages:</strong> Automatic publishing of content as web pages</li>\n                  <li><strong>FHIR IG:</strong> Integration with Implementation Guide publishing</li>\n                  <li><strong>Version Control:</strong> Track changes and collaborate on content</li>\n                </ul>\n                <div class="help-tip">\n                  <strong>\ud83d\udcdd Best Practice:</strong> Use clear headings, bullet points, and visual elements to make content accessible to healthcare workers\n                </div>\n              '}]}]}}getHelpTopicsForPage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[...this.helpTopics[e]||[],...this.getUniversalTopics(t)]}getUniversalTopics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[this.universalTopics.documentation,this.universalTopics.bugReport];return(e.selectedDak||e.repository)&&t.push(this.universalTopics.dakFeedback),t}getHelpTopic(e){for(const t of Object.values(this.helpTopics)){const o=t.find(t=>t.id===e);if(o)return o}return null}hasHelpTopics(e){return!0}addHelpTopicToPage(e,t){this.helpTopics[e]||(this.helpTopics[e]=[]),this.helpTopics[e].push(t)}getAvailablePages(){return Object.keys(this.helpTopics)}openDakIssue(e,t){if(!t)return void console.warn("No DAK repository specified for feedback");let o="https://github.com/".concat(t.owner,"/").concat(t.name,"/issues/new");switch(e){case"bug":o+="?template=bug_report.md&labels=bug,dak-issue";break;case"improvement":o+="?template=feature_request.md&labels=enhancement,dak-improvement";break;case"content":o+="?labels=content-issue,clinical-content";break;case"question":o+="?template=question.md&labels=question,dak-question";break;default:o+="?labels=dak-feedback"}window.open(o,"_blank")}}},16786:(e,t,o)=>{o.d(t,{ox:()=>Q,Mx:()=>H,oc:()=>M,HX:()=>B});var n=o(65043),s=o(89379),a=o(73537),r=o(93071),i=o(89387);const c=new class{constructor(){this.storageKey="sgex-profile-subscriptions",this.whoProfile="WorldHealthOrganization"}getSubscriptions(){try{const e=localStorage.getItem(this.storageKey),t=e?JSON.parse(e):[];return t.find(e=>e.login===this.whoProfile)||(t.unshift({login:this.whoProfile,name:"World Health Organization",avatar_url:"https://github.com/".concat(this.whoProfile,".png"),type:"Organization",isPermanent:!0,addedAt:(new Date).toISOString()}),this.saveSubscriptions(t)),t}catch(e){return console.warn("Error reading profile subscriptions from localStorage:",e),[{login:this.whoProfile,name:"World Health Organization",avatar_url:"https://github.com/".concat(this.whoProfile,".png"),type:"Organization",isPermanent:!0,addedAt:(new Date).toISOString()}]}}saveSubscriptions(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){throw console.error("Error saving profile subscriptions to localStorage:",t),t}}addSubscription(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||!e.login)throw new Error("Profile must have a login property");const o=this.getSubscriptions(),n=o.findIndex(t=>t.login===e.login);if(-1!==n)return o[n]=(0,s.A)((0,s.A)((0,s.A)({},o[n]),e),{},{isPermanent:o[n].isPermanent||t,lastUpdated:(new Date).toISOString()}),this.saveSubscriptions(o),o[n];const a={login:e.login,name:e.name||e.login,avatar_url:e.avatar_url||"https://github.com/".concat(e.login,".png"),type:e.type||"User",isPermanent:t,addedAt:(new Date).toISOString(),lastUpdated:(new Date).toISOString()};return o.push(a),this.saveSubscriptions(o),a}removeSubscription(e){if(!e)return!1;try{const t=this.getSubscriptions(),o=t.findIndex(t=>t.login===e);if(-1===o)return!1;return t[o].isPermanent?(console.warn("Cannot remove permanent profile: ".concat(e)),!1):(t.splice(o,1),this.saveSubscriptions(t),!0)}catch(t){return console.error("Error removing profile subscription:",t),!1}}isSubscribed(e){if(!e)return!1;return this.getSubscriptions().some(t=>t.login===e)}getSubscription(e){if(!e)return null;return this.getSubscriptions().find(t=>t.login===e)||null}ensureCurrentUserSubscribed(e){if(!e||!e.login)return;const t=this.getSubscription(e.login);t?t.isPermanent||this.addSubscription((0,s.A)((0,s.A)((0,s.A)({},t),e),{},{isPermanent:!0}),!0):this.addSubscription((0,s.A)((0,s.A)({},e),{},{isPermanent:!0}),!0)}autoAddVisitedProfile(e){e&&e.login&&(this.isSubscribed(e.login)||e.isDemo||this.addSubscription(e,!1))}getSubscriptionsSorted(){return this.getSubscriptions().sort((e,t)=>{if(e.login===this.whoProfile)return-1;if(t.login===this.whoProfile)return 1;const o=e.name||e.login,n=t.name||t.login;return o.localeCompare(n)})}getSubscriptionsForSelection(){return this.getSubscriptionsSorted().map(e=>(0,s.A)((0,s.A)({},e),{},{displayName:e.name||e.login,isRemovable:!e.isPermanent}))}updateSubscription(e,t){if(!e||!t)return!1;try{const o=this.getSubscriptions(),n=o.findIndex(t=>t.login===e);return-1!==n&&(o[n]=(0,s.A)((0,s.A)((0,s.A)({},o[n]),t),{},{login:e,lastUpdated:(new Date).toISOString()}),this.saveSubscriptions(o),!0)}catch(o){return console.error("Error updating subscription:",o),!1}}clearSubscriptions(){try{const e={login:this.whoProfile,name:"World Health Organization",avatar_url:"https://github.com/".concat(this.whoProfile,".png"),type:"Organization",isPermanent:!0,addedAt:(new Date).toISOString()};this.saveSubscriptions([e])}catch(e){console.error("Error clearing subscriptions:",e)}}exportSubscriptions(){const e=this.getSubscriptions();return JSON.stringify(e,null,2)}importSubscriptions(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const o=JSON.parse(e);if(!Array.isArray(o))throw new Error("Invalid subscription format");let n;if(t){const e=[...this.getSubscriptions()];o.forEach(t=>{const o=e.findIndex(e=>e.login===t.login);-1!==o?e[o]=(0,s.A)((0,s.A)({},t),{},{isPermanent:e[o].isPermanent||t.isPermanent}):e.push(t)}),n=e}else n=o;return n.find(e=>e.login===this.whoProfile)||n.unshift({login:this.whoProfile,name:"World Health Organization",avatar_url:"https://github.com/".concat(this.whoProfile,".png"),type:"Organization",isPermanent:!0,addedAt:(new Date).toISOString()}),this.saveSubscriptions(n),!0}catch(o){return console.error("Error importing subscriptions:",o),!1}}};var l=o(70579);const h="top-level",g="user",d="dak",u="asset",p=(0,n.createContext)(null),m=()=>{const e=(0,n.useContext)(p);return e||(console.error("usePage: PageContext is null - component not wrapped in PageProvider"),{pageName:"unknown",user:null,profile:null,repository:null,branch:null,asset:null,type:"top-level",loading:!1,error:null,isAuthenticated:!1,navigate:()=>{},params:{},location:{pathname:"/"}})},b=e=>{const{user:t,repo:o}=e;return e["*"]?u:t&&o?d:t?g:h},f=e=>{let{children:t,pageName:o}=e;const m=(0,a.g)(),f=(0,a.zy)(),w=(0,a.Zp)(),[y,v]=(0,n.useState)({type:b(m),pageName:o,loading:!1,error:null,user:null,profile:null,repository:null,branch:null,asset:null,isAuthenticated:r.A.isAuth()}),{user:k,repo:x}=m,S=m["*"];(0,n.useEffect)(()=>{(y.type!==h&&k||y.type===h)&&(async()=>{try{var e,t,n;v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!0,error:null}));let h=null===(e=f.state)||void 0===e?void 0:e.profile,p=null===(t=f.state)||void 0===t?void 0:t.repository,b=(null===(n=f.state)||void 0===n?void 0:n.selectedBranch)||m.branch;if(y.type===d||y.type===u){var a;if(!h&&k)if(r.A.isAuth())try{h=await r.A.getUser(k)}catch(l){if("dashboard"===o||o.includes("editor")||o.includes("viewer")||y.type===d||y.type===u)return void v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!1,error:"User '".concat(k,"' not found or not accessible. Please check the username and try again."),user:k,repository:x?{name:x,owner:{login:k},html_url:"https://github.com/".concat(k,"/").concat(x),isNotFound:!0}:null,branch:m.branch||"main"}));throw new Error("User '".concat(k,"' not found or not accessible."))}else{if(!i.A.validateDemoDAKRepository(k,x)){if("dashboard"===o||o.includes("editor")||o.includes("viewer")||y.type===d||y.type===u)return void v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!1,error:"Repository '".concat(k,"/").concat(x,"' not found or not accessible. This may be a private repository or the repository doesn't exist."),user:k,profile:{login:k,name:k.charAt(0).toUpperCase()+k.slice(1),avatar_url:"https://github.com/".concat(k,".png"),type:"User",isDemo:!0},repository:{name:x,owner:{login:k},html_url:"https://github.com/".concat(k,"/").concat(x),isNotFound:!0},branch:m.branch||"main"}));throw new Error("Repository '".concat(k,"/").concat(x,"' not found or not accessible."))}h={login:k,name:k.charAt(0).toUpperCase()+k.slice(1),avatar_url:"https://github.com/".concat(k,".png"),type:"User",isDemo:!0}}if(!p&&k&&x)if(r.A.isAuth())try{if(p=await r.A.getRepository(k,x),!await i.A.validateDAKRepository(k,x,b||p.default_branch)){if("dashboard"===o||o.includes("editor")||o.includes("viewer")||y.type===d||y.type===u)return void v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!1,error:"Repository '".concat(k,"/").concat(x,"' is not a valid DAK repository. This repository may not contain WHO SMART Guidelines content."),user:k,profile:h,repository:(0,s.A)((0,s.A)({},p),{},{isInvalidDAK:!0}),branch:b||p.default_branch}));throw new Error("Repository '".concat(k,"/").concat(x,"' is not a valid DAK repository."))}}catch(l){if("dashboard"===o||o.includes("editor")||o.includes("viewer")||y.type===d||y.type===u)return void v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!1,error:"Repository '".concat(k,"/").concat(x,"' not found or not accessible. Please check the repository name and your access permissions."),user:k,profile:h,repository:{name:x,owner:{login:k},html_url:"https://github.com/".concat(k,"/").concat(x),isNotFound:!0},branch:b||"main"}));throw new Error("Repository '".concat(k,"/").concat(x,"' not found or not accessible."))}else{if(!i.A.validateDemoDAKRepository(k,x)){if("dashboard"===o||o.includes("editor")||o.includes("viewer")||y.type===d||y.type===u)return void v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!1,error:"Repository '".concat(k,"/").concat(x,"' not found or not accessible. This may be a private repository or the repository doesn't exist."),user:k,profile:{login:k,name:k.charAt(0).toUpperCase()+k.slice(1),avatar_url:"https://github.com/".concat(k,".png"),type:"User",isDemo:!0},repository:{name:x,owner:{login:k},html_url:"https://github.com/".concat(k,"/").concat(x),isNotFound:!0},branch:b||"main"}));throw new Error("Repository '".concat(k,"/").concat(x,"' not found or not accessible."))}p={name:x,full_name:"".concat(k,"/").concat(x),owner:{login:k},default_branch:b||"main",html_url:"https://github.com/".concat(k,"/").concat(x),isDemo:!0}}if(b=b||(null===(a=p)||void 0===a?void 0:a.default_branch)||"main",y.type===u&&S)try{await r.A.getFileContent(k,x,S,b)}catch(l){if("asset"===o||o.includes("editor")||o.includes("viewer"))return void v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!1,error:"Asset '".concat(S,"' not found in repository '").concat(k,"/").concat(x,"'. The file may have been moved or deleted."),user:k,profile:h,repository:p,branch:b,asset:S}));throw new Error("Asset '".concat(S,"' not found in repository."))}}if(y.type===g&&!h&&k)if(r.A.isAuth())try{h=await r.A.getUser(k)}catch(l){return void v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!1,error:"User '".concat(k,"' not found or not accessible. Please check the username and try again."),user:k}))}else h={login:k,name:k.charAt(0).toUpperCase()+k.slice(1),avatar_url:"https://github.com/".concat(k,".png"),type:"User",isDemo:!0};v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!1,user:k,profile:h,repository:p,branch:b,asset:S,isAuthenticated:r.A.isAuth()}));const w=async()=>{try{const e=await r.A.getCurrentUser();e&&c.ensureCurrentUserSubscribed(e)}catch(e){console.debug("Could not fetch current user for subscriptions:",e)}!h||h.isDemo||y.type!==g&&y.type!==d&&y.type!==u||c.autoAddVisitedProfile(h)};r.A.isAuth()&&w()}catch(h){console.error("Page data loading error:",h),v(e=>(0,s.A)((0,s.A)({},e),{},{loading:!1,error:h.message}))}})()},[k,x,m.branch,S,y.type,f.state,w,o]),(0,n.useEffect)(()=>{const e=setInterval(()=>{const e=r.A.isAuth();e!==y.isAuthenticated&&v(t=>(0,s.A)((0,s.A)({},t),{},{isAuthenticated:e}))},1e3);return()=>clearInterval(e)},[y.isAuthenticated]);const A=(0,s.A)((0,s.A)({},y),{},{navigate:w,params:m,location:f});return(0,l.jsx)(p.Provider,{value:A,children:t})};var w=o(5452);const y=e=>{const t=document.body.classList.contains("theme-dark"),o="/sgex/main",n=e.startsWith("/")?e.slice(1):e;let s;if(t){const e=n.replace(/\.png$/,"_grey_tabby.png");s=o?"".concat(o,"/").concat(e):"/".concat(e)}else s=o?"".concat(o,"/").concat(n):"/".concat(n);return s},v="authenticated",k="unauthenticated",x="demo",S="read",A="write",N="none";const C=new class{constructor(){this.logger=w.A.getLogger("UserAccessService"),this.currentUser=null,this.userType=k,this.permissions=new Map,this.listeners=new Set}async initialize(){this.logger.info("Initializing user access service"),await this.detectUserType(),this.notifyListeners()}async detectUserType(){try{if(r.A.isAuth()){this.checkIfDemoUser()?(this.userType=x,this.currentUser=await this.createDemoUser()):(this.userType=v,this.currentUser=await r.A.getCurrentUser())}else this.userType=k,this.currentUser=null;this.logger.info("User type detected",{userType:this.userType,hasUser:!!this.currentUser})}catch(e){this.logger.error("Error detecting user type",{error:e.message}),this.userType=k,this.currentUser=null}}checkIfDemoUser(){return"true"===localStorage.getItem("sgex_demo_mode")||"true"==={NODE_ENV:"production",PUBLIC_URL:"/sgex/main",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GITHUB_REF_NAME:"main"}.REACT_APP_DEMO_MODE}async createDemoUser(){try{const e=await r.A.getCurrentUser();return(0,s.A)((0,s.A)({},e),{},{isDemo:!0,demoData:this.getDemoData()})}catch(e){return{login:"demo-user",name:"Demo User",avatar_url:y("sgex-mascot.png"),type:"User",isDemo:!0,demoData:this.getDemoData()}}}getDemoData(){return{daks:[{owner:"WHO",repo:"smart-anc",name:"Smart Antenatal Care",description:"Demo DAK for antenatal care guidelines"},{owner:"WHO",repo:"smart-tb",name:"Smart Tuberculosis",description:"Demo DAK for tuberculosis care guidelines"}],sampleAssets:{"input/vocabulary/ValueSet-anc-care-codes.json":{type:"ValueSet",description:"Demo value set for antenatal care"}}}}getUserType(){return this.userType}getCurrentUser(){return this.currentUser}isAuthenticated(){return this.userType===v||this.userType===x}isDemoUser(){return this.userType===x}isUnauthenticated(){return this.userType===k}async getRepositoryAccess(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";const n="".concat(e,"/").concat(t,"/").concat(o);if(this.permissions.has(n))return this.permissions.get(n);let s=N;try{if(this.userType===k)s=S;else if(this.userType===x){s=this.isDemoDAK(e,t)?S:N}else if(this.userType===v){const o=await this.checkGitHubReadAccess(e,t);await this.checkGitHubWriteAccess(e,t)?s=A:o&&(s=S)}}catch(a){this.logger.error("Error checking repository access",{owner:e,repo:t,branch:o,error:a.message}),s=S}return this.permissions.set(n,s),this.logger.debug("Repository access determined",{owner:e,repo:t,branch:o,access:s,userType:this.userType}),s}isDemoDAK(e,t){var o,n;return!(null===(o=this.currentUser)||void 0===o||null===(n=o.demoData)||void 0===n||!n.daks)&&this.currentUser.demoData.daks.some(o=>o.owner===e&&o.repo===t)}async checkGitHubReadAccess(e,t){try{return await r.A.getRepository(e,t),!0}catch(o){return!1}}async checkGitHubWriteAccess(e,t){try{return await r.A.hasRepositoryWriteAccess(e,t)}catch(o){return!1}}async canSaveToGitHub(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";if(this.userType!==v)return!1;return await this.getRepositoryAccess(e,t,o)===A}canSaveLocal(){return!0}getUIBehavior(){const e={showEditFeatures:!0,showSaveToGitHub:!0,showSaveLocal:!0,confirmBeforeSave:!0,allowCreateNew:!0,showAccessBadges:!0};switch(this.userType){case k:return(0,s.A)((0,s.A)({},e),{},{showEditFeatures:!1,showSaveToGitHub:!1,allowCreateNew:!1});case x:return(0,s.A)((0,s.A)({},e),{},{showSaveToGitHub:!1,allowCreateNew:!1});case v:return e;default:return(0,s.A)((0,s.A)({},e),{},{showEditFeatures:!1,showSaveToGitHub:!1,allowCreateNew:!1})}}async getAccessBadge(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";const n=await this.getRepositoryAccess(e,t,o),s={[A]:{text:"Write Access",icon:"\u270f\ufe0f",color:"green",description:"You can edit and save changes to this repository"},[S]:{text:"Read Only",icon:"\ud83d\udc41\ufe0f",color:"blue",description:"You can view this repository but cannot save changes"},[N]:{text:"No Access",icon:"\ud83d\udeab",color:"red",description:"You do not have access to this repository"}};return s[n]||s[N]}enableDemoMode(){localStorage.setItem("sgex_demo_mode","true"),this.initialize()}disableDemoMode(){localStorage.removeItem("sgex_demo_mode"),this.initialize()}clearPermissionsCache(){this.permissions.clear(),this.logger.debug("Permissions cache cleared")}addListener(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){const e={userType:this.userType,currentUser:this.currentUser,isAuthenticated:this.isAuthenticated(),isDemoUser:this.isDemoUser(),uiBehavior:this.getUIBehavior()};this.listeners.forEach(t=>{try{t(e)}catch(o){this.logger.error("Error in access service listener",{error:o.message})}})}handleAuthChange(){this.clearPermissionsCache(),this.initialize()}};const j=new class{constructor(){this.storageKey="sgex-bookmarks"}getBookmarks(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}catch(e){return console.warn("Error reading bookmarks from localStorage:",e),[]}}saveBookmarks(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){throw console.error("Error saving bookmarks to localStorage:",t),t}}generateBookmarkTitle(e,t){const{user:o,repository:n,branch:s,asset:a}=t;if(a&&o&&n){const e=n.name||n,t=s||"main";return"".concat(a," in DAK: ").concat(o,"/").concat(e,"/").concat(t)}if(o&&n&&s){const e=n.name||n;return"DAK: ".concat(o,"/").concat(e,"/").concat(s)}if(o&&n){const e=n.name||n;return"DAK: ".concat(o,"/").concat(e)}return o?"".concat(e,": ").concat(o):e}addBookmark(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.getBookmarks(),a=n.findIndex(e=>e.url===t);if(-1!==a)n[a]=(0,s.A)((0,s.A)({},n[a]),{},{title:this.generateBookmarkTitle(e,o),pageName:e,context:o,lastUpdated:(new Date).toISOString()});else{const s={id:Date.now().toString(),title:this.generateBookmarkTitle(e,o),url:t,pageName:e,context:o,createdAt:(new Date).toISOString(),lastUpdated:(new Date).toISOString()};n.push(s)}return this.saveBookmarks(n),n[a]||n[n.length-1]}removeBookmark(e){try{const t=this.getBookmarks(),o=t.filter(t=>t.id!==e);return o.length!==t.length&&(this.saveBookmarks(o),!0)}catch(t){return console.error("Error removing bookmark:",t),!1}}isBookmarked(e){return this.getBookmarks().some(t=>t.url===e)}getBookmarkByUrl(e){return this.getBookmarks().find(t=>t.url===e)||null}getBookmarksGroupedByPage(){const e=this.getBookmarks(),t={};e.forEach(e=>{const o=e.pageName||"Other";t[o]||(t[o]=[]),t[o].push(e)}),Object.keys(t).forEach(e=>{t[e].sort((e,t)=>e.title.localeCompare(t.title))});return Object.keys(t).sort().map(e=>({pageName:e,bookmarks:t[e]}))}clearBookmarks(){try{localStorage.removeItem(this.storageKey)}catch(e){console.error("Error clearing bookmarks:",e)}}exportBookmarks(){const e=this.getBookmarks();return JSON.stringify(e,null,2)}importBookmarks(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const o=JSON.parse(e);if(!Array.isArray(o))throw new Error("Invalid bookmark format");if(t){const e=[...this.getBookmarks()];o.forEach(t=>{const o=e.findIndex(e=>e.url===t.url);-1!==o?e[o]=t:e.push(t)}),this.saveBookmarks(e)}else this.saveBookmarks(o);return!0}catch(o){return console.error("Error importing bookmarks:",o),!1}}},_=()=>{const[e,t]=(0,n.useState)(null),[o,s]=(0,n.useState)([]),[a,i]=(0,n.useState)(!0),[c,h]=(0,n.useState)(null),[g,d]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!1),m=(0,n.useRef)(null);(0,n.useEffect)(()=>{(async()=>{try{i(!0),h(null);const o=b();if(!o||"main"===o)return void i(!1);t({name:o,safeName:o.replace(/\//g,"-")});try{const e=await f(o);e&&e.length>0&&s(e)}catch(e){console.debug("Could not fetch PR info:",e)}i(!1)}catch(o){console.error("Error detecting branch:",o),h(o.message),i(!1)}})()},[]),(0,n.useEffect)(()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&(u&&p(!1),d(!1))};if(g)return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[g,u]);const b=()=>"main",f=async e=>{try{const t="litlfred",o="sgex";return await r.A.getPullRequestsForBranch(t,o,e)}catch(c){return console.debug("Failed to fetch PR info:",c),[]}},w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return e.length<=t?e:e.substring(0,t)+"..."};return a||c||!e?null:(0,l.jsxs)("div",{className:"preview-badge-container",ref:m,children:[o&&o.length>0?o.map((e,t)=>(0,l.jsx)("div",{className:"preview-badge clickable",onClick:()=>(e=>{e&&e.html_url&&window.open(e.html_url,"_blank")})(e),title:"Click to view PR: ".concat(e.title),children:(0,l.jsxs)("div",{className:"badge-content",children:[(0,l.jsx)("span",{className:"badge-label",children:"PR:"}),(0,l.jsxs)("span",{className:"badge-branch",children:["#",e.number]}),(0,l.jsx)("span",{className:"badge-separator",children:"|"}),(0,l.jsx)("span",{className:"badge-pr-title",children:w(e.title)})]})},e.id)):(0,l.jsx)("div",{className:"preview-badge clickable ".concat(g?"expanded":""," ").concat(u?"sticky":""),onClick:e=>{o&&o.length>0||(e.stopPropagation(),e.preventDefault(),u?(p(!1),d(!1)):(p(!0),d(!0)))},onMouseEnter:()=>{u||o&&0!==o.length||d(!0)},onMouseLeave:()=>{u||o&&0!==o.length||d(!1)},title:u?"Click to collapse":g?"Click to keep expanded":"\ud83d\udd0d Hover for branch details, click to pin: ".concat(e.name),children:(0,l.jsxs)("div",{className:"badge-content",children:[(0,l.jsx)("span",{className:"badge-label",children:"Preview:"}),(0,l.jsx)("span",{className:"badge-branch",children:e.name}),(0,l.jsx)("span",{className:"badge-expand-icon",children:g?"\u25bc":"\u25b6"})]})}),g&&(!o||0===o.length)&&(0,l.jsxs)("div",{className:"preview-badge-expanded",children:[(0,l.jsxs)("div",{className:"expanded-header",children:[(0,l.jsxs)("div",{className:"pr-info",children:[(0,l.jsxs)("h3",{children:["Preview Branch: ",e.name]}),(0,l.jsxs)("div",{className:"pr-meta",children:[(0,l.jsx)("span",{className:"pr-state","data-state":"unknown",children:"No PR found"}),(0,l.jsx)("span",{className:"pr-author",children:"Branch preview"})]})]}),(0,l.jsx)("button",{className:"close-button",onClick:e=>{e.stopPropagation(),d(!1),p(!1)},title:"Close expanded view",children:"\xd7"})]}),(0,l.jsxs)("div",{className:"pr-description",children:[(0,l.jsx)("h4",{children:"Branch Information"}),(0,l.jsxs)("div",{className:"pr-body",children:["This is a preview deployment from the ",(0,l.jsx)("code",{children:e.name})," branch.",(0,l.jsxs)("div",{style:{marginTop:"0.5rem"},children:[(0,l.jsx)("strong",{children:"Preview URL:"})," ",(0,l.jsxs)("code",{children:[window.location.origin,window.location.pathname]})]}),r.A.isAuth()?(0,l.jsx)("div",{style:{marginTop:"0.5rem",color:"#28a745"},children:"\u2705 Authenticated - You can view full PR details when available."}):(0,l.jsxs)("div",{style:{marginTop:"0.5rem",padding:"0.5rem",backgroundColor:"#f0f8ff",border:"1px solid #bee5eb",borderRadius:"4px"},children:[(0,l.jsx)("strong",{children:"\ud83d\udca1 Tip:"})," Sign in to GitHub to view pull request details, comments, and contribute to this branch."]})]})]}),(0,l.jsx)("div",{className:"expanded-footer",children:(0,l.jsx)("a",{href:"https://github.com/litlfred/sgex/tree/".concat(e.name),target:"_blank",rel:"noopener noreferrer",className:"github-link",children:"View Branch on GitHub \u2192"})})]})]})},T=()=>{const{pageName:e,profile:t,repository:o,branch:s,asset:a,isAuthenticated:i,navigate:c}=m(),[h,g]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),[p,b]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(i){(async()=>{try{const e=C.getCurrentUser();if(e)b(e);else{const e=await r.A.getCurrentUser();b(e)}}catch(e){console.debug("Could not fetch authenticated user:",e)}})()}else b(null)},[i]);const f=()=>{c("/")},w=e=>{j.removeBookmark(e),u(!1),setTimeout(()=>u(!0),50)},y=j.getBookmarkByUrl(window.location.pathname),v=j.getBookmarksGroupedByPage();return(0,l.jsxs)("header",{className:"page-header",children:[(0,l.jsxs)("div",{className:"page-header-left",children:[(0,l.jsxs)("div",{className:"sgex-logo",onClick:f,children:[(0,l.jsx)("h1",{children:"SGEX Workbench"}),(0,l.jsx)("p",{className:"subtitle",children:"WHO SMART Guidelines Exchange"})]}),(0,l.jsx)(_,{})]}),(0,l.jsx)("div",{className:"page-header-right",children:(i||null!==t&&void 0!==t&&t.isDemo)&&p?(0,l.jsxs)("div",{className:"user-controls",children:[(0,l.jsxs)("div",{className:"user-info",onClick:()=>g(!h),children:[(0,l.jsx)("img",{src:p.avatar_url,alt:"User avatar",className:"user-avatar"}),(0,l.jsx)("span",{className:"user-name",children:p.name||p.login}),(0,l.jsx)("span",{className:"dropdown-arrow",children:"\u25bc"})]}),h&&(0,l.jsxs)("div",{className:"user-dropdown",children:[(0,l.jsxs)("button",{className:"dropdown-item",onClick:()=>{null!==p&&void 0!==p&&p.html_url?window.open(p.html_url,"_blank"):null!==p&&void 0!==p&&p.login&&window.open("https://github.com/".concat(p.login),"_blank")},children:[(0,l.jsx)("svg",{className:"github-icon",viewBox:"0 0 16 16",width:"16",height:"16",children:(0,l.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})}),"GitHub Profile"]}),y?(0,l.jsx)("button",{className:"dropdown-item bookmark-action",onClick:()=>w(y.id),children:"\u2b50 Remove Bookmark"}):(0,l.jsx)("button",{className:"dropdown-item bookmark-action",onClick:()=>{const t={user:null===p||void 0===p?void 0:p.login,repository:o,branch:s,asset:a},n=window.location.pathname;j.addBookmark(e,n,t),u(!1)},children:"\u2606 Add Bookmark"}),(0,l.jsxs)("div",{className:"bookmarks-section",children:[(0,l.jsxs)("div",{className:"dropdown-item bookmarks-header",onClick:()=>u(!d),children:["\ud83d\udcd6 Bookmarks",(0,l.jsx)("span",{className:"dropdown-arrow",children:d?"\u25b2":"\u25bc"})]}),d&&(0,l.jsx)("div",{className:"bookmarks-dropdown",children:v.length>0?(0,l.jsx)("div",{className:"bookmarks-list",children:v.map(e=>(0,l.jsxs)("div",{className:"bookmark-group",children:[(0,l.jsx)("div",{className:"bookmark-group-header",children:e.pageName}),e.bookmarks.map(e=>(0,l.jsxs)("div",{className:"bookmark-item",children:[(0,l.jsx)("button",{className:"bookmark-link",onClick:()=>(e=>{c(e.url),u(!1)})(e),title:e.url,children:e.title}),(0,l.jsx)("button",{className:"bookmark-remove",onClick:()=>w(e.id),title:"Remove bookmark",children:"\xd7"})]},e.id))]},e.pageName))}):(0,l.jsx)("div",{className:"no-bookmarks",children:"No bookmarks yet"})})]}),(0,l.jsx)("button",{className:"dropdown-item logout-btn",onClick:()=>{r.A.logout(),c("/")},children:"Logout"})]})]}):(0,l.jsx)("button",{className:"login-btn",onClick:f,children:"Login"})})]})},D=e=>{let{owner:t,repo:o,branch:s="main",className:a=""}=e;const[r,i]=(0,n.useState)(null),[c,h]=(0,n.useState)(!0),[g,d]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=!0;const n=async()=>{if(t&&o)try{h(!0);const n=await C.getAccessBadge(t,o,s);e&&(i(n),h(!1))}catch(n){console.error("Error loading access badge:",n),e&&(i({text:"Unknown",icon:"\u2753",color:"gray",description:"Unable to determine access level"}),h(!1))}else h(!1)};n();const a=C.addListener(()=>{n()});return()=>{e=!1,a()}},[t,o,s]),c?(0,l.jsxs)("div",{className:"access-badge loading ".concat(a),children:[(0,l.jsx)("span",{className:"access-badge-icon",children:"\u23f3"}),(0,l.jsx)("span",{className:"access-badge-text",children:"Loading..."})]}):r?(0,l.jsxs)("div",{className:"access-badge ".concat(r.color," ").concat(a),onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),title:r.description,children:[(0,l.jsx)("span",{className:"access-badge-icon",role:"img","aria-label":r.text,children:r.icon}),(0,l.jsx)("span",{className:"access-badge-text",children:r.text}),g&&(0,l.jsx)("div",{className:"access-badge-tooltip",children:(0,l.jsxs)("div",{className:"tooltip-content",children:[(0,l.jsx)("strong",{children:r.text}),(0,l.jsx)("p",{children:r.description}),o&&(0,l.jsxs)("small",{children:["Repository: ",t,"/",o]})]})})]}):null},E=e=>{var t;let{customBreadcrumbs:o}=e;const{type:s,pageName:a,profile:i,repository:c,branch:h,navigate:p}=m(),[b,f]=(0,n.useState)([]),[w,y]=(0,n.useState)(!1),[v,k]=(0,n.useState)(""),[x,S]=(0,n.useState)(!1);(0,n.useEffect)(()=>{const e=e=>{w&&!e.target.closest(".page-context-branch-selector")&&(y(!1),k(""))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[w]),(0,n.useEffect)(()=>{(async()=>{if(!c||s!==d&&s!==u)f([]);else try{var e,t;S(!0);const o=(null===(e=c.owner)||void 0===e?void 0:e.login)||(null===(t=c.full_name)||void 0===t?void 0:t.split("/")[0]),n=(await r.A.getBranches(o,c.name)).sort((e,t)=>e.name.localeCompare(t.name));f(n)}catch(o){console.error("Failed to fetch branches for context:",o),f([])}finally{S(!1)}})()},[c,s]);const A=b.filter(e=>e.name.toLowerCase().includes(v.toLowerCase())),N=(()=>{if(o&&o.length>0)return o;const e=[];if(e.push({label:"Home",path:"/",onClick:()=>p("/")}),s!==g&&s!==d&&s!==u||!i||e.push({label:"Select Repository",path:"/dak-selection/".concat(i.login),onClick:()=>p("/dak-selection/".concat(i.login),{state:{profile:i}})}),(s===d||s===u)&&c){var t,n;const o=h&&"main"!==h?"/".concat(h):"",s=(null===(t=c.owner)||void 0===t?void 0:t.login)||(null===(n=c.full_name)||void 0===n?void 0:n.split("/")[0]);s&&e.push({label:"DAK Components",path:"/dashboard/".concat(s,"/").concat(c.name).concat(o),onClick:()=>p("/dashboard/".concat(s,"/").concat(c.name).concat(o))})}const r={landing:"Home","landing-unauthenticated":"Home",repositories:"Select Repository","dak-selection":"Select DAK","dak-action":"Choose DAK Action",dashboard:"DAK Components","dak-dashboard":"DAK Components","actor-editor":"Actor Definitions","component-editor":"Component Editor","bpmn-viewer":"Business Process Viewer","bpmn-editor":"Business Process Editor","decision-support-logic":"Decision Support Logic","core-data-dictionary-viewer":"Core Data Dictionary","testing-viewer":"Testing","pages-manager":"Pages",documentation:"Documentation"}[a]||a;return 0!==e.length&&e[e.length-1].label===r||e.push({label:r,current:!0}),e})();return!i&&!c&&N.length<=1?null:(0,l.jsx)("div",{className:"page-context-container",children:(0,l.jsxs)("div",{className:"page-context-content",children:[i&&(0,l.jsx)("img",{src:i.avatar_url,alt:"".concat(i.login," avatar"),className:"page-context-avatar"}),(0,l.jsxs)("div",{className:"page-context-info",children:[(0,l.jsxs)("div",{className:"page-context-row page-context-user-repo",children:[i&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"page-context-profile",onClick:()=>{null!==i&&void 0!==i&&i.html_url?window.open(i.html_url,"_blank"):null!==i&&void 0!==i&&i.login&&window.open("https://github.com/".concat(i.login),"_blank")},children:i.login}),c&&(0,l.jsx)("span",{className:"page-context-separator",children:"/"})]}),c&&(0,l.jsx)("span",{className:"page-context-repo",children:c.name}),h&&(s===d||s===u)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"page-context-separator",children:"@"}),(0,l.jsxs)("div",{className:"page-context-branch-selector",children:[(0,l.jsxs)("button",{className:"page-context-branch-btn",onClick:()=>y(!w),title:"Switch branch",children:[(0,l.jsx)("span",{className:"branch-icon",children:"\ud83c\udf3f"}),h,(0,l.jsx)("span",{className:"branch-dropdown-arrow",children:w?"\u25b2":"\u25bc"})]}),w&&(0,l.jsxs)("div",{className:"branch-dropdown",children:[(0,l.jsx)("div",{className:"branch-search",children:(0,l.jsx)("input",{type:"text",placeholder:"Search branches...",value:v,onChange:e=>k(e.target.value),className:"branch-search-input",autoFocus:!0})}),(0,l.jsx)("div",{className:"branch-list",children:x?(0,l.jsx)("div",{className:"branch-item loading",children:"Loading branches..."}):A.length>0?A.map(e=>(0,l.jsxs)("button",{className:"branch-item ".concat(e.name===h?"current":""),onClick:()=>(e=>{const t=window.location.pathname.split("/");t.length>=5&&(5===t.length?t.push(e):t[5]=e,p(t.join("/"))),y(!1),k("")})(e.name),children:[(0,l.jsx)("span",{className:"branch-icon",children:"\ud83c\udf3f"}),e.name,e.name===h&&(0,l.jsx)("span",{className:"current-badge",children:"current"})]},e.name)):(0,l.jsx)("div",{className:"branch-item no-results",children:v?"No branches found":"No branches available"})})]})]})]})]}),N.length>1&&(0,l.jsx)("nav",{className:"page-context-row page-context-breadcrumbs","aria-label":"Breadcrumb navigation",children:(0,l.jsx)("ol",{className:"breadcrumb-list",children:N.map((e,t)=>(0,l.jsx)("li",{className:"breadcrumb-item",children:e.current?(0,l.jsx)("span",{className:"breadcrumb-current","aria-current":"page",children:e.label}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{className:"breadcrumb-link",onClick:()=>e.onClick?e.onClick():p(e.path),"aria-label":"Navigate to ".concat(e.label),children:e.label}),(0,l.jsx)("span",{className:"breadcrumb-separator","aria-hidden":"true",children:"\u203a"})]})},t))})})]}),(s===d||s===u)&&c&&(0,l.jsxs)("div",{className:"page-context-actions",children:[(0,l.jsx)(D,{owner:(null===(t=c.owner)||void 0===t?void 0:t.login)||(null===i||void 0===i?void 0:i.login),repo:c.name,branch:h,className:"context-access-badge"}),(0,l.jsxs)("button",{className:"context-btn github-repo-btn",onClick:()=>{null!==c&&void 0!==c&&c.html_url&&window.open(c.html_url,"_blank")},title:"Open repository on GitHub",children:[(0,l.jsx)("svg",{className:"github-icon",viewBox:"0 0 16 16",width:"16",height:"16",children:(0,l.jsx)("path",{d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})}),"Repository"]})]})]})})};var G=o(18077),R=o(19794);const I=e=>{let{error:t,onRetry:o}=e;const s=m(),a=s.pageName,[r,i]=(0,n.useState)(!1),c=(0,R.A)("sgex-mascot.png"),[h,g]=(0,n.useState)(""),d=(()=>{var e;const o=t.toLowerCase(),n=null===s||void 0===s?void 0:s.user,a=null===s||void 0===s||null===(e=s.repository)||void 0===e?void 0:e.name;if(o.includes("not found")||o.includes("not accessible")){if(o.includes("user"))return{title:"User Not Found",message:"The user ".concat(n?"'".concat(n,"'"):"in the URL"," could not be found on GitHub."),suggestions:["Check the spelling of the username","Verify the user account exists on GitHub","Try searching for the user on GitHub.com"],icon:"\ud83d\udc64"};if(o.includes("repository"))return{title:"Repository Not Found",message:"The repository ".concat(n&&a?"'".concat(n,"/").concat(a,"'"):"in the URL"," could not be accessed."),suggestions:["Check the spelling of the repository name","Verify the repository exists and is public","If it's a private repository, make sure you have access","Try visiting the repository directly on GitHub.com"],icon:"\ud83d\udcc1"}}return o.includes("not a valid dak")||o.includes("invalid dak")?{title:"Not a DAK Repository",message:"The repository ".concat(n&&a?"'".concat(n,"/").concat(a,"'"):"in the URL"," doesn't appear to contain WHO SMART Guidelines content."),suggestions:["Verify this is a WHO SMART Guidelines Digital Adaptation Kit","Check if the repository has a sushi-config.yaml file","Look for smart.who.int.base dependencies in the configuration","Try browsing other DAK repositories for examples"],icon:"\ud83d\udccb"}:o.includes("asset")&&o.includes("not found")?{title:"File Not Found",message:"The requested file could not be found in the repository.",suggestions:["Check if the file path is correct","Verify the file exists in the current branch","The file may have been moved or deleted","Try browsing the repository to find the correct path"],icon:"\ud83d\udcc4"}:{title:"Something Went Wrong",message:t,suggestions:["Try refreshing the page","Check your internet connection","The service may be temporarily unavailable"],icon:"\u26a0\ufe0f"}})();return(0,l.jsx)("div",{className:"error-handler",children:(0,l.jsxs)("div",{className:"error-content",children:[(0,l.jsx)("div",{className:"error-mascot-container",children:(0,l.jsx)(G.A,{helpContent:(0,l.jsx)("div",{className:"error-help-content",children:(0,l.jsxs)("div",{className:"error-mascot-large",children:[(0,l.jsx)("img",{src:c,alt:"SGEX Helper",className:"large-mascot-icon"}),(0,l.jsxs)("div",{className:"mascot-speech-bubble",children:[(0,l.jsx)("div",{className:"speech-content",children:"I'm sorry! Something went wrong."}),(0,l.jsx)("div",{className:"speech-tail"})]})]})}),position:"center"})}),(0,l.jsxs)("div",{className:"error-details",children:[(0,l.jsxs)("h2",{children:[d.icon," ",d.title]}),(0,l.jsx)("p",{className:"error-message",children:d.message}),d.suggestions&&(0,l.jsxs)("div",{className:"error-suggestions",children:[(0,l.jsx)("h3",{children:"\ud83d\udca1 Suggestions:"}),(0,l.jsx)("ul",{children:d.suggestions.map((e,t)=>(0,l.jsx)("li",{children:e},t))})]}),(0,l.jsxs)("div",{className:"error-actions",children:[(0,l.jsx)("button",{className:"error-btn primary",onClick:()=>{o?o():window.location.reload()},children:"\ud83d\udd04 Try Again"}),(0,l.jsx)("button",{className:"error-btn secondary",onClick:()=>{window.location.href="/sgex/"},children:"\ud83c\udfe0 Go Home"})]}),(0,l.jsxs)("div",{className:"bug-report-section",children:[(0,l.jsx)("h3",{children:"Help us improve SGEX"}),(0,l.jsx)("p",{children:"If this error persists, please let us know what happened:"}),(0,l.jsxs)("div",{className:"user-explanation",children:[(0,l.jsx)("label",{htmlFor:"user-explanation",children:"What were you trying to do when this error occurred?"}),(0,l.jsx)("textarea",{id:"user-explanation",value:h,onChange:e=>g(e.target.value),placeholder:"Please describe what you were doing when the error occurred...",rows:4})]}),r?(0,l.jsxs)("div",{className:"bug-report-sent",children:[(0,l.jsx)("span",{className:"success-icon",children:"\u2705"}),"Thank you! A bug report has been opened. We'll investigate this issue."]}):(0,l.jsx)("button",{className:"bug-report-btn",onClick:()=>{const e=(()=>{const e=encodeURIComponent("User should not have reached this page"),o=encodeURIComponent("\n**Error Information:**\n- Page: ".concat(a,"\n- URL: ").concat(window.location.href,"\n- Error: ").concat(t,"\n- Timestamp: ").concat((new Date).toISOString(),"\n- User Agent: ").concat(navigator.userAgent,"\n\n**Context:**\n- Browser: ").concat(navigator.userAgent,"\n- Viewport: ").concat(window.innerWidth,"x").concat(window.innerHeight,"\n- Referrer: ").concat(document.referrer||"Direct access","\n\n**User Explanation:**\n").concat(h||"No additional details provided","\n\n**Steps to Reproduce:**\n1. Navigate to: ").concat(window.location.href,"\n2. [Please add any additional steps]\n\n**Expected Behavior:**\nThe page should load without errors.\n\n**Actual Behavior:**\n").concat(t,"\n    "));return"https://github.com/litlfred/sgex/issues/new?title=".concat(e,"&body=").concat(o,"&labels=bug,user-error")})();window.open(e,"_blank"),i(!0)},children:"\ud83d\udce7 Send Bug Report"})]}),(0,l.jsx)("div",{className:"error-context",children:(0,l.jsxs)("details",{children:[(0,l.jsx)("summary",{children:"Technical Details"}),(0,l.jsxs)("div",{className:"technical-details",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Page:"})," ",a]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"URL:"})," ",window.location.href]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Error:"})," ",t]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"Timestamp:"})," ",(new Date).toISOString()]})]})]})})]})]})})};class F extends n.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e.message}}componentDidCatch(e,t){console.error("PageLayout caught an error:",e,t)}render(){return this.state.hasError?(0,l.jsx)("div",{className:"page-layout-error",children:(0,l.jsx)(I,{error:this.state.error,onRetry:()=>{this.setState({hasError:!1,error:null}),window.location.reload()}})}):this.props.children}}const P=e=>{let{children:t,showHeader:o=!0,showMascot:n=!0,showBreadcrumbs:s=!0,customBreadcrumbs:a}=e;const{loading:r,error:i,pageName:c}=m();return r?(0,l.jsxs)("div",{className:"page-layout",children:[o&&(0,l.jsx)(T,{}),(0,l.jsx)("main",{className:"page-main",children:(0,l.jsxs)("div",{className:"page-loading",children:[(0,l.jsx)("div",{className:"loading-spinner"}),(0,l.jsx)("p",{children:"Loading..."})]})}),n&&(0,l.jsx)(G.A,{pageId:"".concat(c,"-loading"),position:"bottom-right"})]}):i?(0,l.jsxs)("div",{className:"page-layout",children:[o&&(0,l.jsx)(T,{}),(0,l.jsx)("main",{className:"page-main",children:(0,l.jsx)(I,{error:i,onRetry:()=>window.location.reload()})})]}):(0,l.jsxs)("div",{className:"page-layout",children:[o&&(0,l.jsx)(T,{}),(0,l.jsx)(E,{customBreadcrumbs:s?a:[]}),(0,l.jsxs)("main",{className:"page-main",children:[t,n&&(0,l.jsx)(G.A,{pageId:c,position:"bottom-right",contextData:{}})]})]})},H=e=>{let{children:t,pageName:o,showHeader:n=!0,showMascot:s=!0,showBreadcrumbs:a=!0,customBreadcrumbs:r}=e;return(0,l.jsx)(F,{children:(0,l.jsx)(f,{pageName:o,children:(0,l.jsx)(P,{showHeader:n,showMascot:s,showBreadcrumbs:a,customBreadcrumbs:r,children:t})})})},B=()=>{const{type:e,user:t,profile:o,repository:n,branch:s,asset:a,params:r,navigate:i}=m();return{type:e,user:t,profile:o,repository:n,branch:s,asset:a,params:r,updateBranch:t=>{if(e===d||e===u){const e=window.location.pathname.split("/");e.length>=5&&(5===e.length?e.push(t):e[5]=t,i(e.join("/")))}},navigateToUser:e=>{i("/".concat(r.page||"dak-action","/").concat(e))},navigateToDAK:function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";i("/".concat(r.page||"dashboard","/").concat(e,"/").concat(t,"/").concat(o))},navigateToAsset:(e,t,o,n)=>{i("/".concat(r.page||"editor","/").concat(e,"/").concat(t,"/").concat(o,"/").concat(n))},navigate:i}},M=()=>{try{const e=B();if(!e.loading&&e.type!==d&&e.type!==u)throw new Error("useDAKParams can only be used on DAK or Asset pages. Current page type: ".concat(e.type));return{user:e.user,profile:e.profile,repository:e.repository,branch:e.branch,asset:e.asset,updateBranch:e.updateBranch,navigate:e.navigate}}catch(e){if(e.message.includes("usePage must be used within a PageProvider"))return console.log("useDAKParams: PageProvider not ready yet, returning empty data"),{user:null,profile:null,repository:null,branch:null,asset:null,updateBranch:()=>{},navigate:()=>{}};throw e}};var O=o(80045);const K=e=>{let{hasChanges:t=!1,isSavingLocal:o=!1,isSavingGitHub:n=!1,canSaveToGitHub:s=!1,localSaveSuccess:a=!1,githubSaveSuccess:r=!1,savedLocally:i=!1,onSaveLocal:c,onSaveGitHub:h,isDemo:g=!1,showLocalButton:d=!0,showGitHubButton:u=!0,buttonSize:p="medium",layout:m="horizontal"}=e;const b=!t||o||a,f=!t||n||r||!s,w=["save-buttons-container","layout-".concat(m),"size-".concat(p)].join(" "),y=(e,t,o)=>{const n=["save-button","save-button-".concat(e)];return t&&n.push("disabled"),o&&n.push("success"),n.join(" ")};return(0,l.jsxs)("div",{className:w,children:[d&&(0,l.jsxs)("button",{className:y("local",b,a),onClick:c,disabled:b,title:t?a?"Changes saved to local storage":o?"Saving to local storage...":"Save changes to browser local storage":"No changes to save",children:[(0,l.jsx)("span",{className:"button-icon",children:"\ud83d\udcbe"}),(0,l.jsx)("span",{className:"button-text",children:a?"Saved Locally \u2713":o?"Saving...":"Save Local"})]}),u&&s&&(0,l.jsxs)("button",{className:y("github",f,r),onClick:h,disabled:f,title:t?r?"Changes committed to GitHub":n?"Committing to GitHub...":"Commit changes to GitHub repository":"No changes to save",children:[(0,l.jsx)("span",{className:"button-icon",children:"\ud83d\udce4"}),(0,l.jsx)("span",{className:"button-text",children:r?"Committed \u2713":n?"Committing...":"Save to GitHub"})]}),u&&!s&&!g&&(0,l.jsxs)("div",{className:"github-unavailable",children:[(0,l.jsx)("span",{className:"unavailable-icon",children:"\ud83d\udd12"}),(0,l.jsx)("span",{className:"unavailable-text",children:"GitHub save unavailable"}),(0,l.jsx)("small",{children:"Login required for GitHub access"})]}),g&&(0,l.jsxs)("div",{className:"demo-mode-indicator",children:[(0,l.jsx)("span",{className:"demo-icon",children:"\ud83e\uddea"}),(0,l.jsx)("span",{className:"demo-text",children:"Demo Mode - Local save only"})]}),i&&(0,l.jsxs)("div",{className:"local-storage-indicator",children:[(0,l.jsx)("span",{className:"local-icon",children:"\ud83d\udcbe"}),(0,l.jsx)("span",{className:"local-text",children:"Local version available"})]})]})},U=e=>{let{isOpen:t=!1,commitMessage:o="",setCommitMessage:s,onCommit:a,onCancel:r,isSaving:i=!1,fileName:c="",suggestedMessage:h=""}=e;const g=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(t&&g.current)if(g.current.focus(),o||h||!c)h&&!o&&s(h);else{const e="Update ".concat(c);s(e)}},[t,o,h,c,s]);return t?(0,l.jsx)("div",{className:"commit-dialog-overlay",onClick:e=>{e.target!==e.currentTarget||i||r()},children:(0,l.jsxs)("div",{className:"commit-dialog",onKeyDown:e=>{"Escape"!==e.key||i?"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&o.trim()&&!i&&a(o.trim()):r()},children:[(0,l.jsxs)("div",{className:"commit-dialog-header",children:[(0,l.jsx)("h3",{children:"Commit Changes to GitHub"}),(0,l.jsx)("button",{className:"close-button",onClick:r,disabled:i,"aria-label":"Close dialog",children:"\u2715"})]}),(0,l.jsxs)("div",{className:"commit-dialog-content",children:[c&&(0,l.jsxs)("div",{className:"file-info",children:[(0,l.jsx)("span",{className:"file-icon",children:"\ud83d\udcc4"}),(0,l.jsx)("span",{className:"file-name",children:c})]}),(0,l.jsxs)("div",{className:"commit-message-section",children:[(0,l.jsx)("label",{htmlFor:"commit-message",className:"commit-message-label",children:"Commit Message *"}),(0,l.jsx)("textarea",{id:"commit-message",ref:g,className:"commit-message-input",value:o,onChange:e=>s(e.target.value),placeholder:"Describe the changes you made...",rows:4,disabled:i,required:!0}),(0,l.jsx)("div",{className:"commit-message-help",children:(0,l.jsx)("small",{children:"Describe what changes you made and why. This will be visible in the repository's commit history."})})]}),(0,l.jsx)("div",{className:"commit-guidelines",children:(0,l.jsxs)("details",{children:[(0,l.jsx)("summary",{children:"Commit Message Guidelines"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Use clear, descriptive language"}),(0,l.jsx)("li",{children:"Start with a verb (Add, Update, Fix, Remove, etc.)"}),(0,l.jsx)("li",{children:"Keep the first line under 72 characters"}),(0,l.jsx)("li",{children:"Add details in additional lines if needed"})]})]})})]}),(0,l.jsxs)("div",{className:"commit-dialog-footer",children:[(0,l.jsxs)("div",{className:"dialog-actions",children:[(0,l.jsx)("button",{className:"btn btn-secondary",onClick:r,disabled:i,children:"Cancel"}),(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>{o.trim()&&!i&&a(o.trim())},disabled:!o.trim()||i,children:i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"spinner"}),"Committing..."]}):"Commit Changes"})]}),(0,l.jsx)("div",{className:"keyboard-shortcut",children:(0,l.jsxs)("small",{children:["Press ",(0,l.jsx)("kbd",{children:"Ctrl+Enter"})," to commit or ",(0,l.jsx)("kbd",{children:"Esc"})," to cancel"]})})]})]})}):null};var L=o(22392);const W="local",z="github",q="success",V="error",J="permission_denied",X="demo_mode_blocked";const Y=new class{constructor(){this.logger=w.A.getLogger("DataAccessLayer"),this.pendingOperations=new Map,this.assetCache=new Map}async initialize(e,t){this.logger.info("Initializing data access layer",{repository:null===e||void 0===e?void 0:e.full_name,branch:t}),L.A.initialize(e,t),await C.initialize()}async getAsset(e,t,o,n){const s="".concat(e,"/").concat(t,"/").concat(o,"/").concat(n);try{if("none"===await C.getRepositoryAccess(e,t,o))throw new Error("No access to this repository");const a=L.A.getStagingGround().files.find(e=>e.path===n);if(a)return this.logger.debug("Asset loaded from staging ground",{assetPath:n}),{content:a.content,source:"local",metadata:a.metadata,hasLocalChanges:!0};let i;return i=C.isDemoUser()&&C.isDemoDAK(e,t)?this.getDemoAssetContent(n):await r.A.getFileContent(e,t,n,o),this.assetCache.set(s,i),this.logger.debug("Asset loaded from GitHub",{assetPath:n,source:"github"}),{content:i,source:"github",hasLocalChanges:!1}}catch(a){throw this.logger.error("Error getting asset",{owner:e,repo:t,branch:o,assetPath:n,error:a.message}),a}}async saveAssetLocal(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const n=C.getUserType();if(L.A.updateFile(e,t,(0,s.A)((0,s.A)({},o),{},{savedBy:n,saveTarget:W})))return this.logger.info("Asset saved to local storage",{assetPath:e,userType:n}),{result:q,message:"Changes saved to local staging area",target:W};throw new Error("Failed to save to local storage")}catch(n){return this.logger.error("Error saving asset locally",{assetPath:e,error:n.message}),{result:V,message:"Failed to save locally: ".concat(n.message),target:W}}}async saveAssetGitHub(e,t,o,n,s,a){try{const u=C.getUserType();if(!await C.canSaveToGitHub(e,t,o))return"demo"===u?{result:X,message:"Demo users cannot save to GitHub. Changes can be saved locally.",target:z}:"unauthenticated"===u?{result:J,message:"Please authenticate to save changes to GitHub.",target:z}:{result:J,message:"You do not have write access to this repository.",target:z};const p=await r.A.updateFileContent(e,t,n,s,a,o);if(p.success){var i,c,l,h,g,d;L.A.removeFile(n);const s="".concat(e,"/").concat(t,"/").concat(o,"/").concat(n);return this.assetCache.delete(s),this.logger.info("Asset saved to GitHub",{owner:e,repo:t,branch:o,assetPath:n,commit:null===(i=p.data)||void 0===i||null===(c=i.commit)||void 0===c?void 0:c.sha}),{result:q,message:"Changes successfully committed to GitHub",target:z,commitSha:null===(l=p.data)||void 0===l||null===(h=l.commit)||void 0===h?void 0:h.sha,commitUrl:null===(g=p.data)||void 0===g||null===(d=g.commit)||void 0===d?void 0:d.html_url}}throw new Error(p.error||"GitHub commit failed")}catch(u){return this.logger.error("Error saving asset to GitHub",{owner:e,repo:t,branch:o,assetPath:n,error:u.message}),{result:V,message:"Failed to save to GitHub: ".concat(u.message),target:z}}}getDemoAssetContent(e){return{"input/vocabulary/ValueSet-anc-care-codes.json":JSON.stringify({resourceType:"ValueSet",id:"anc-care-codes",name:"ANCCareCodes",title:"ANC Care Codes (Demo)",status:"draft",description:"Demo value set for antenatal care codes",compose:{include:[{system:"http://example.org/anc-codes",concept:[{code:"anc-visit",display:"Antenatal Care Visit"},{code:"anc-screening",display:"Antenatal Screening"}]}]}},null,2),"input/actors/Patient.json":JSON.stringify({resourceType:"ActorDefinition",id:"patient",name:"Patient",title:"Patient (Demo)",status:"draft",description:"Demo patient actor definition",type:"person"},null,2),"README.md":"# Demo DAK Repository\n\nThis is a demo repository showing the structure of a SMART Guidelines DAK.\n\n## Components\n\n- **ValueSets**: Terminology definitions\n- **Actors**: System and person actors  \n- **Business Processes**: BPMN workflow definitions\n\nThis is demo data and cannot be saved to GitHub."}[e]||"# Demo Asset: ".concat(e,"\n\nThis is demo content for the asset located at: ").concat(e,"\n\nDemo users can edit this content and save it locally, but cannot commit changes to GitHub.")}async getSaveOptions(e,t,o){const n=C.getUserType(),s=await C.canSaveToGitHub(e,t,o),a=C.canSaveLocal(),r=C.getUIBehavior();return{canSaveLocal:a,canSaveGitHub:s,showSaveLocal:r.showSaveLocal,showSaveGitHub:r.showSaveToGitHub,confirmBeforeSave:r.confirmBeforeSave,userType:n,restrictions:this.getSaveRestrictions(n,s)}}getSaveRestrictions(e,t){switch(e){case"unauthenticated":return{localMessage:"Changes will be saved to your browser only",githubMessage:"Please authenticate to save to GitHub",githubDisabled:!0};case"demo":return{localMessage:"Changes will be saved to your browser only",githubMessage:"Demo users cannot save to GitHub",githubDisabled:!0};case"authenticated":return t?{localMessage:"Save changes to staging area",githubMessage:"Commit changes to GitHub repository",githubDisabled:!1}:{localMessage:"Changes will be saved to your browser only",githubMessage:"You do not have write access to this repository",githubDisabled:!0};default:return{localMessage:"Local saves only",githubMessage:"GitHub saves not available",githubDisabled:!0}}}getStagingGroundStatus(){return L.A.getStatus()}clearStagingGround(){return L.A.clearStagingGround()}getChangedFiles(){return L.A.getStagingGround().files}hasLocalChanges(e){return L.A.getStagingGround().files.some(t=>t.path===e)}async createAsset(e,t,o,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(!C.getUIBehavior().allowCreateNew)throw new Error("Current user type cannot create new assets");return this.saveAssetLocal(n,a,(0,s.A)((0,s.A)({},r),{},{isNew:!0,createdAt:Date.now()}))}async batchSaveLocal(e){const t=[];for(const o of e){const e=await this.saveAssetLocal(o.path,o.content,o.metadata);t.push((0,s.A)((0,s.A)({},e),{},{path:o.path}))}return{success:t.every(e=>e.result===q),results:t}}async getAccessInfo(e,t,o){const[n,s,a]=await Promise.all([C.getRepositoryAccess(e,t,o),C.getAccessBadge(e,t,o),this.getSaveOptions(e,t,o)]);return{access:n,badge:s,saveOptions:a,userType:C.getUserType(),isDemo:C.isDemoUser()}}},Z=["children","pageName","file","repository","branch","content","originalContent","hasChanges","onSave","onContentChange","customSaveToGitHub","showSaveButtons","saveButtonsPosition"],Q=e=>{let{children:t,pageName:o,file:a,repository:r,branch:i,content:c,originalContent:h,hasChanges:g=!1,onSave:d,onContentChange:u,customSaveToGitHub:p,showSaveButtons:m=!0,saveButtonsPosition:b="top"}=e,f=(0,O.A)(e,Z);const[w,y]=(0,n.useState)(!1),[v,k]=(0,n.useState)(!1),[x,S]=(0,n.useState)(null),[A,N]=(0,n.useState)(!1),[C,j]=(0,n.useState)(!1),[_,T]=(0,n.useState)(null),[D,E]=(0,n.useState)(!1),[G,R]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{if(r)try{var e;const t=await Y.getSaveOptions(null===(e=r.owner)||void 0===e?void 0:e.login,r.name,i);T(t)}catch(t){console.error("Error loading save options:",t)}})()},[r,i]);const I=(null===_||void 0===_?void 0:_.canSaveGitHub)&&(null===_||void 0===_?void 0:_.showSaveGitHub),F=(0,n.useCallback)(async()=>{if(g&&null!==a&&void 0!==a&&a.path)try{var e;y(!0),S(null),N(!1);const t=await Y.saveAssetLocal(a.path,c,{repository:(null===r||void 0===r?void 0:r.full_name)||"".concat(null===r||void 0===r||null===(e=r.owner)||void 0===e?void 0:e.login,"/").concat(null===r||void 0===r?void 0:r.name),branch:i||(null===r||void 0===r?void 0:r.default_branch)||"main",fileName:a.name,timestamp:(new Date).toISOString()});if("success"!==t.result)throw new Error(t.message||"Failed to save to local storage");N(!0),d&&d(c,"local"),setTimeout(()=>{N(!1)},3e3)}catch(t){console.error("Error saving file locally:",t),S("Failed to save locally: ".concat(t.message))}finally{y(!1)}},[g,a,c,r,i,d]),P=(0,n.useCallback)(()=>{g&&I&&(S(null),E(!0))},[g,I]),B=(0,n.useCallback)(async e=>{if(e.trim()&&null!==a&&void 0!==a&&a.path)try{var t;if(k(!0),S(null),j(!1),p){if(!await p(e.trim()))throw new Error("Custom save function failed");return j(!0),E(!1),R(""),d&&d(c,"github"),void setTimeout(()=>{j(!1)},3e3)}const o=await Y.saveAssetGitHub(null===r||void 0===r||null===(t=r.owner)||void 0===t?void 0:t.login,null===r||void 0===r?void 0:r.name,i,a.path,c,e.trim());if("success"!==o.result){let e=o.message;throw"demo_mode_blocked"===o.result?e="Demo users cannot save to GitHub. You can save changes locally instead.":"permission_denied"===o.result&&(e="You do not have permission to save to this repository."),new Error(e)}j(!0),E(!1),R(""),d&&d(c,"github"),setTimeout(()=>{j(!1)},3e3)}catch(o){console.error("Error saving file to GitHub:",o),S("Failed to save to GitHub: ".concat(o.message))}finally{k(!1)}},[a,c,r,i,d,p]),M=(0,n.useCallback)(()=>{E(!1),R("")},[]),L={hasChanges:g,isSavingLocal:w,isSavingGitHub:v,canSaveToGitHub:I,localSaveSuccess:A,githubSaveSuccess:C,onSaveLocal:F,onSaveGitHub:P};return(0,l.jsx)(H,(0,s.A)((0,s.A)({pageName:o},f),{},{children:(0,l.jsxs)("div",{className:"asset-editor-layout",children:[m&&("top"===b||"both"===b)&&(0,l.jsx)("div",{className:"save-buttons-top",children:(0,l.jsx)(K,(0,s.A)({},L))}),x&&(0,l.jsxs)("div",{className:"asset-editor-error",children:[(0,l.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),x,(0,l.jsx)("button",{className:"btn-link error-dismiss",onClick:()=>S(null),children:"\u2715"})]}),A&&(0,l.jsxs)("div",{className:"asset-editor-success",children:[(0,l.jsx)("span",{className:"success-icon",children:"\u2705"}),"Changes saved locally successfully!"]}),C&&(0,l.jsxs)("div",{className:"asset-editor-success",children:[(0,l.jsx)("span",{className:"success-icon",children:"\u2705"}),"Changes committed to GitHub successfully!"]}),(0,l.jsx)("div",{className:"asset-editor-content",children:t}),m&&("bottom"===b||"both"===b)&&(0,l.jsx)("div",{className:"save-buttons-bottom",children:(0,l.jsx)(K,(0,s.A)({},L))}),D&&(0,l.jsx)(U,{isOpen:D,commitMessage:G,setCommitMessage:R,onCommit:B,onCancel:M,isSaving:v,fileName:null===a||void 0===a?void 0:a.name})]})}))};o(78362);const $=["toolDefinition"],ee="viewer",te="editor",oe="dashboard",ne="utility";class se{constructor(e){this.id=e.id,this.name=e.name,this.title=e.title||e.name,this.description=e.description,this.type=e.type||ne,this.route=e.route||"/".concat(this.id),this.icon=e.icon,this.category=e.category||"general",this.requiresAuth=!1!==e.requiresAuth,this.supportsDemo=!1!==e.supportsDemo,this.requiresDAK=e.requiresDAK||!1,this.assetTypes=e.assetTypes||[],this.assetPattern=e.assetPattern,this.viewerComponent=e.viewerComponent,this.editorComponent=e.editorComponent,this.dashboardComponent=e.dashboardComponent,this.onInit=e.onInit,this.onAssetLoad=e.onAssetLoad,this.onAssetSave=e.onAssetSave,this.onError=e.onError}supportsAsset(e){var t;return!(null!==(t=this.assetTypes)&&void 0!==t&&t.length||this.assetPattern)||(this.assetPattern?new RegExp(this.assetPattern).test(e):this.assetTypes.some(t=>e.includes(t)))}async canAccess(){return(!this.requiresAuth||!C.isUnauthenticated())&&!(!this.supportsDemo&&C.isDemoUser())}createComponent(){const e=this;return function(t){return(0,l.jsx)(ae,(0,s.A)({toolDefinition:e},t))}}}const ae=e=>{let{toolDefinition:t}=e,o=(0,O.A)(e,$);const a=B(),[r,i]=n.useState({loading:!0,error:null,canAccess:!1,assets:[],content:null}),c=n.useCallback(async()=>{try{i(e=>(0,s.A)((0,s.A)({},e),{},{loading:!0,error:null}));if(!await t.canAccess())throw new Error("Access denied: This tool requires ".concat(t.requiresAuth?"authentication":"different user type"));a.repository&&await Y.initialize(a.repository,a.branch);let o=[],n=null;if(a.asset&&(t.type===ee||t.type===te)){if(!t.supportsAsset(a.asset))throw new Error("This tool does not support asset type: ".concat(a.asset));{var e;const t=await Y.getAsset(a.user,null===(e=a.repository)||void 0===e?void 0:e.name,a.branch,a.asset);o=[(0,s.A)({path:a.asset},t)],n=t.content}}t.onInit&&await t.onInit({pageParams:a,assets:o,content:n}),i({loading:!1,error:null,canAccess:!0,assets:o,content:n})}catch(o){console.error("Error initializing tool ".concat(t.id,":"),o),i({loading:!1,error:o.message,canAccess:!1,assets:[],content:null}),t.onError&&t.onError(o,{pageParams:a})}},[t,a]);n.useEffect(()=>{c()},[c]);const h=async(e,o)=>{if(a.asset)try{let n;if("local"===o)n=await Y.saveAssetLocal(a.asset,e);else if("github"===o)throw new Error("GitHub save requires commit message - use handleGitHubSave instead");return t.onAssetSave&&await t.onAssetSave({asset:a.asset,content:e,saveType:o,result:n,pageParams:a}),n}catch(n){throw console.error("Error saving asset in tool ".concat(t.id,":"),n),n}},g=async(e,o)=>{if(a.asset)try{var n;const s=await Y.saveAssetGitHub(a.user,null===(n=a.repository)||void 0===n?void 0:n.name,a.branch,a.asset,e,o);return t.onAssetSave&&await t.onAssetSave({asset:a.asset,content:e,saveType:"github",result:s,commitMessage:o,pageParams:a}),s}catch(s){throw console.error("Error saving asset to GitHub in tool ".concat(t.id,":"),s),s}};if(r.loading)return(0,l.jsx)(H,{pageName:t.id,children:(0,l.jsxs)("div",{className:"tool-loading",children:[(0,l.jsxs)("h2",{children:["Loading ",t.title,"..."]}),(0,l.jsx)("p",{children:"Initializing tool and checking access permissions."})]})});if(r.error||!r.canAccess)return(0,l.jsx)(H,{pageName:t.id,children:(0,l.jsxs)("div",{className:"tool-error",children:[(0,l.jsxs)("h2",{children:["Cannot Access ",t.title]}),(0,l.jsx)("p",{children:r.error||"Access denied"}),(0,l.jsx)("button",{onClick:()=>window.history.back(),children:"Go Back"})]})});return(()=>{const e=(0,s.A)({toolDefinition:t,pageParams:a,toolState:r,onAssetSave:h,onGitHubSave:g},o);switch(t.type){case te:if(t.editorComponent){const o=t.editorComponent;var n;return a.asset&&r.assets.length>0?(0,l.jsx)(Q,{pageName:t.id,file:{name:a.asset,path:a.asset},repository:a.repository,branch:a.branch,content:r.content,originalContent:null===(n=r.assets[0])||void 0===n?void 0:n.content,hasChanges:!1,onSave:h,onContentChange:e=>{i(t=>(0,s.A)((0,s.A)({},t),{},{content:e}))},children:(0,l.jsx)(o,(0,s.A)({},e))}):(0,l.jsx)(H,{pageName:t.id,children:(0,l.jsx)(o,(0,s.A)({},e))})}break;case ee:if(t.viewerComponent){const o=t.viewerComponent;return(0,l.jsx)(H,{pageName:t.id,children:(0,l.jsx)(o,(0,s.A)({},e))})}break;case oe:if(t.dashboardComponent){const o=t.dashboardComponent;return(0,l.jsx)(H,{pageName:t.id,children:(0,l.jsx)(o,(0,s.A)({},e))})}break;default:const o=t.viewerComponent||t.editorComponent||t.dashboardComponent;if(o)return(0,l.jsx)(H,{pageName:t.id,children:(0,l.jsx)(o,(0,s.A)({},e))})}return(0,l.jsx)(H,{pageName:t.id,children:(0,l.jsxs)("div",{className:"tool-fallback",children:[(0,l.jsx)("h1",{children:t.title}),(0,l.jsx)("p",{children:t.description}),(0,l.jsx)("p",{children:"No component defined for this tool."})]})})})()};new class{constructor(){this.tools=new Map}register(e){const t=new se(e);return this.tools.set(t.id,t),t}get(e){return this.tools.get(e)}getAll(){return Array.from(this.tools.values())}getByCategory(e){return this.getAll().filter(t=>t.category===e)}getByAssetType(e){return this.getAll().filter(t=>t.supportsAsset(e))}async getAccessibleTools(){const e=this.getAll(),t=[];for(const o of e)await o.canAccess()&&t.push(o);return t}}},18077:(e,t,o)=>{o.d(t,{A:()=>f});var n=o(65043),s=o(74117),a=o(12602),r=o(65240),i=o(88691),c=o(5452);const l=new class{constructor(){this.logger=c.A.getLogger("CacheManagementService")}clearAllCache(){try{this.logger.info("Starting complete cache clear operation");const e=r.A.clearAllCaches();return this.logger.debug("Repository cache cleared",{success:e}),i.default.clearAllBranchContext(),this.logger.debug("Branch context cleared"),this.clearAllStagingGrounds(),this.logger.debug("Staging ground data cleared"),this.clearOtherSGEXData(),this.logger.debug("Other SGEX data cleared"),this.logger.info("Complete cache clear operation completed successfully"),!0}catch(e){return this.logger.error("Error during cache clear operation",{error:e.message}),console.error("Error clearing cache:",e),!1}}clearAllStagingGrounds(){try{const e=Object.keys(localStorage);e.filter(e=>e.startsWith("sgex_staging_")).forEach(e=>{localStorage.removeItem(e),this.logger.debug("Removed staging ground",{key:e})});return e.filter(e=>e.startsWith("sgex_staging_history_")).forEach(e=>{localStorage.removeItem(e),this.logger.debug("Removed staging ground history",{key:e})}),!0}catch(e){return this.logger.error("Error clearing staging grounds",{error:e.message}),console.warn("Error clearing staging grounds:",e),!1}}clearOtherSGEXData(){try{const e=Object.keys(localStorage);e.filter(e=>e.startsWith("sgex_")&&!e.startsWith("sgex_repo_cache_")&&!e.startsWith("sgex_staging_")).forEach(e=>{localStorage.removeItem(e),this.logger.debug("Removed other SGEX data",{key:e})});const t=Object.keys(sessionStorage);return t.filter(e=>e.startsWith("sgex_")&&"sgex_branch_context"!==e).forEach(e=>{sessionStorage.removeItem(e),this.logger.debug("Removed SGEX session data",{key:e})}),!0}catch(e){return this.logger.error("Error clearing other SGEX data",{error:e.message}),console.warn("Error clearing other SGEX data:",e),!1}}getCacheInfo(){try{const t={repositoryCache:{count:0,keys:[]},branchContext:{hasData:!1,repositoryCount:0},stagingGround:{count:0,keys:[]},other:{count:0,keys:[]}},o=Object.keys(localStorage);t.repositoryCache.keys=o.filter(e=>e.startsWith("sgex_repo_cache_")),t.repositoryCache.count=t.repositoryCache.keys.length,t.stagingGround.keys=o.filter(e=>e.startsWith("sgex_staging_")||e.startsWith("sgex_staging_history_")),t.stagingGround.count=t.stagingGround.keys.length,t.other.keys=o.filter(e=>e.startsWith("sgex_")&&!e.startsWith("sgex_repo_cache_")&&!e.startsWith("sgex_staging_")),t.other.count=t.other.keys.length;try{const e=sessionStorage.getItem("sgex_branch_context");if(e){const o=JSON.parse(e);t.branchContext.hasData=!0,t.branchContext.repositoryCount=Object.keys(o).length}}catch(e){}return t}catch(t){return this.logger.error("Error getting cache info",{error:t.message}),null}}getUncommittedWork(){try{const e=[],t=Object.keys(localStorage);return t.filter(e=>e.startsWith("sgex_staging_")&&!e.includes("_history_")).forEach(t=>{try{const o=JSON.parse(localStorage.getItem(t));if(o&&o.files&&o.files.length>0){const n=t.replace("sgex_staging_","").split("_"),s=n.pop(),a=n.join("_");e.push({repository:a,branch:s,fileCount:o.files.length,lastModified:o.timestamp?new Date(o.timestamp):null,message:o.message||""})}}catch(o){}}),e}catch(e){return this.logger.error("Error checking uncommitted work",{error:e.message}),[]}}};var h=o(48517),g=o(89379),d=o(70579);const u=[{code:"en",name:"language.english",flag:"\ud83c\uddfa\ud83c\uddf8"},{code:"fr",name:"language.french",flag:"\ud83c\uddeb\ud83c\uddf7"},{code:"es",name:"language.spanish",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"ar",name:"language.arabic",flag:"\ud83c\uddf8\ud83c\udde6"},{code:"zh",name:"language.chinese",flag:"\ud83c\udde8\ud83c\uddf3"},{code:"ru",name:"language.russian",flag:"\ud83c\uddf7\ud83c\uddfa"}],p=[{code:"de",name:"Deutsch",englishName:"German",flag:"\ud83c\udde9\ud83c\uddea"},{code:"it",name:"Italiano",englishName:"Italian",flag:"\ud83c\uddee\ud83c\uddf9"},{code:"pt",name:"Portugu\xeas",englishName:"Portuguese",flag:"\ud83c\uddf5\ud83c\uddf9"},{code:"nl",name:"Nederlands",englishName:"Dutch",flag:"\ud83c\uddf3\ud83c\uddf1"},{code:"sv",name:"Svenska",englishName:"Swedish",flag:"\ud83c\uddf8\ud83c\uddea"},{code:"no",name:"Norsk",englishName:"Norwegian",flag:"\ud83c\uddf3\ud83c\uddf4"},{code:"da",name:"Dansk",englishName:"Danish",flag:"\ud83c\udde9\ud83c\uddf0"},{code:"fi",name:"Suomi",englishName:"Finnish",flag:"\ud83c\uddeb\ud83c\uddee"},{code:"pl",name:"Polski",englishName:"Polish",flag:"\ud83c\uddf5\ud83c\uddf1"},{code:"cs",name:"\u010ce\u0161tina",englishName:"Czech",flag:"\ud83c\udde8\ud83c\uddff"},{code:"sk",name:"Sloven\u010dina",englishName:"Slovak",flag:"\ud83c\uddf8\ud83c\uddf0"},{code:"hu",name:"Magyar",englishName:"Hungarian",flag:"\ud83c\udded\ud83c\uddfa"},{code:"ro",name:"Rom\xe2n\u0103",englishName:"Romanian",flag:"\ud83c\uddf7\ud83c\uddf4"},{code:"bg",name:"\u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438",englishName:"Bulgarian",flag:"\ud83c\udde7\ud83c\uddec"},{code:"hr",name:"Hrvatski",englishName:"Croatian",flag:"\ud83c\udded\ud83c\uddf7"},{code:"el",name:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",englishName:"Greek",flag:"\ud83c\uddec\ud83c\uddf7"},{code:"sr",name:"\u0421\u0440\u043f\u0441\u043a\u0438",englishName:"Serbian",flag:"\ud83c\uddf7\ud83c\uddf8"},{code:"sl",name:"Sloven\u0161\u010dina",englishName:"Slovenian",flag:"\ud83c\uddf8\ud83c\uddee"},{code:"lv",name:"Latvie\u0161u",englishName:"Latvian",flag:"\ud83c\uddf1\ud83c\uddfb"},{code:"lt",name:"Lietuvi\u0173",englishName:"Lithuanian",flag:"\ud83c\uddf1\ud83c\uddf9"},{code:"et",name:"Eesti",englishName:"Estonian",flag:"\ud83c\uddea\ud83c\uddea"},{code:"mt",name:"Malti",englishName:"Maltese",flag:"\ud83c\uddf2\ud83c\uddf9"},{code:"is",name:"\xcdslenska",englishName:"Icelandic",flag:"\ud83c\uddee\ud83c\uddf8"},{code:"ga",name:"Gaeilge",englishName:"Irish",flag:"\ud83c\uddee\ud83c\uddea"},{code:"cy",name:"Cymraeg",englishName:"Welsh",flag:"\ud83c\udff4"},{code:"eu",name:"Euskera",englishName:"Basque",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"ca",name:"Catal\xe0",englishName:"Catalan",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"gl",name:"Galego",englishName:"Galician",flag:"\ud83c\uddea\ud83c\uddf8"},{code:"tr",name:"T\xfcrk\xe7e",englishName:"Turkish",flag:"\ud83c\uddf9\ud83c\uddf7"},{code:"he",name:"\u05e2\u05d1\u05e8\u05d9\u05ea",englishName:"Hebrew",flag:"\ud83c\uddee\ud83c\uddf1"},{code:"fa",name:"\u0641\u0627\u0631\u0633\u06cc",englishName:"Persian",flag:"\ud83c\uddee\ud83c\uddf7"},{code:"ur",name:"\u0627\u0631\u062f\u0648",englishName:"Urdu",flag:"\ud83c\uddf5\ud83c\uddf0"},{code:"ku",name:"Kurd\xee",englishName:"Kurdish",flag:"\ud83c\uddf9\ud83c\uddf7"},{code:"az",name:"Az\u0259rbaycan",englishName:"Azerbaijani",flag:"\ud83c\udde6\ud83c\uddff"},{code:"hy",name:"\u0540\u0561\u0575\u0565\u0580\u0565\u0576",englishName:"Armenian",flag:"\ud83c\udde6\ud83c\uddf2"},{code:"ka",name:"\u10e5\u10d0\u10e0\u10d7\u10e3\u10da\u10d8",englishName:"Georgian",flag:"\ud83c\uddec\ud83c\uddea"},{code:"ja",name:"\u65e5\u672c\u8a9e",englishName:"Japanese",flag:"\ud83c\uddef\ud83c\uddf5"},{code:"ko",name:"\ud55c\uad6d\uc5b4",englishName:"Korean",flag:"\ud83c\uddf0\ud83c\uddf7"},{code:"hi",name:"\u0939\u093f\u0928\u094d\u0926\u0940",englishName:"Hindi",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"th",name:"\u0e44\u0e17\u0e22",englishName:"Thai",flag:"\ud83c\uddf9\ud83c\udded"},{code:"vi",name:"Ti\u1ebfng Vi\u1ec7t",englishName:"Vietnamese",flag:"\ud83c\uddfb\ud83c\uddf3"},{code:"bn",name:"\u09ac\u09be\u0982\u09b2\u09be",englishName:"Bengali",flag:"\ud83c\udde7\ud83c\udde9"},{code:"ta",name:"\u0ba4\u0bae\u0bbf\u0bb4\u0bcd",englishName:"Tamil",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"te",name:"\u0c24\u0c46\u0c32\u0c41\u0c17\u0c41",englishName:"Telugu",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"ml",name:"\u0d2e\u0d32\u0d2f\u0d3e\u0d33\u0d02",englishName:"Malayalam",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"kn",name:"\u0c95\u0ca8\u0ccd\u0ca8\u0ca1",englishName:"Kannada",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"gu",name:"\u0a97\u0ac1\u0a9c\u0ab0\u0abe\u0aa4\u0ac0",englishName:"Gujarati",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"mr",name:"\u092e\u0930\u093e\u0920\u0940",englishName:"Marathi",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"pa",name:"\u0a2a\u0a70\u0a1c\u0a3e\u0a2c\u0a40",englishName:"Punjabi",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"or",name:"\u0b13\u0b21\u0b3c\u0b3f\u0b06",englishName:"Odia",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"as",name:"\u0985\u09b8\u09ae\u09c0\u09af\u09bc\u09be",englishName:"Assamese",flag:"\ud83c\uddee\ud83c\uddf3"},{code:"ne",name:"\u0928\u0947\u092a\u093e\u0932\u0940",englishName:"Nepali",flag:"\ud83c\uddf3\ud83c\uddf5"},{code:"si",name:"\u0dc3\u0dd2\u0d82\u0dc4\u0dbd",englishName:"Sinhala",flag:"\ud83c\uddf1\ud83c\uddf0"},{code:"my",name:"\u1019\u103c\u1014\u103a\u1019\u102c",englishName:"Myanmar",flag:"\ud83c\uddf2\ud83c\uddf2"},{code:"km",name:"\u1781\u17d2\u1798\u17c2\u179a",englishName:"Khmer",flag:"\ud83c\uddf0\ud83c\udded"},{code:"lo",name:"\u0ea5\u0eb2\u0ea7",englishName:"Lao",flag:"\ud83c\uddf1\ud83c\udde6"},{code:"mn",name:"\u041c\u043e\u043d\u0433\u043e\u043b",englishName:"Mongolian",flag:"\ud83c\uddf2\ud83c\uddf3"},{code:"bo",name:"\u0f56\u0f7c\u0f51\u0f0b\u0f61\u0f72\u0f42",englishName:"Tibetan",flag:"\ud83c\udde8\ud83c\uddf3"},{code:"dz",name:"\u0f62\u0fab\u0f7c\u0f44\u0f0b\u0f41",englishName:"Dzongkha",flag:"\ud83c\udde7\ud83c\uddf9"},{code:"id",name:"Bahasa Indonesia",englishName:"Indonesian",flag:"\ud83c\uddee\ud83c\udde9"},{code:"ms",name:"Bahasa Melayu",englishName:"Malay",flag:"\ud83c\uddf2\ud83c\uddfe"},{code:"tl",name:"Filipino",englishName:"Filipino",flag:"\ud83c\uddf5\ud83c\udded"},{code:"ceb",name:"Cebuano",englishName:"Cebuano",flag:"\ud83c\uddf5\ud83c\udded"},{code:"jv",name:"Basa Jawa",englishName:"Javanese",flag:"\ud83c\uddee\ud83c\udde9"},{code:"sw",name:"Kiswahili",englishName:"Swahili",flag:"\ud83c\uddf0\ud83c\uddea"},{code:"am",name:"\u12a0\u121b\u122d\u129b",englishName:"Amharic",flag:"\ud83c\uddea\ud83c\uddf9"},{code:"yo",name:"Yor\xf9b\xe1",englishName:"Yoruba",flag:"\ud83c\uddf3\ud83c\uddec"},{code:"ig",name:"Igbo",englishName:"Igbo",flag:"\ud83c\uddf3\ud83c\uddec"},{code:"ha",name:"Hausa",englishName:"Hausa",flag:"\ud83c\uddf3\ud83c\uddec"},{code:"zu",name:"isiZulu",englishName:"Zulu",flag:"\ud83c\uddff\ud83c\udde6"},{code:"af",name:"Afrikaans",englishName:"Afrikaans",flag:"\ud83c\uddff\ud83c\udde6"},{code:"xh",name:"isiXhosa",englishName:"Xhosa",flag:"\ud83c\uddff\ud83c\udde6"},{code:"st",name:"Sesotho",englishName:"Sotho",flag:"\ud83c\uddf1\ud83c\uddf8"},{code:"tn",name:"Setswana",englishName:"Tswana",flag:"\ud83c\udde7\ud83c\uddfc"},{code:"ss",name:"SiSwati",englishName:"Swati",flag:"\ud83c\uddf8\ud83c\uddff"},{code:"ve",name:"Tshiven\u1e13a",englishName:"Venda",flag:"\ud83c\uddff\ud83c\udde6"},{code:"ts",name:"Xitsonga",englishName:"Tsonga",flag:"\ud83c\uddff\ud83c\udde6"},{code:"sn",name:"ChiShona",englishName:"Shona",flag:"\ud83c\uddff\ud83c\uddfc"},{code:"ny",name:"ChiChe\u0175a",englishName:"Chewa",flag:"\ud83c\uddf2\ud83c\uddfc"},{code:"rw",name:"Kinyarwanda",englishName:"Kinyarwanda",flag:"\ud83c\uddf7\ud83c\uddfc"},{code:"rn",name:"Kirundi",englishName:"Kirundi",flag:"\ud83c\udde7\ud83c\uddee"},{code:"lg",name:"Luganda",englishName:"Luganda",flag:"\ud83c\uddfa\ud83c\uddec"},{code:"so",name:"Soomaali",englishName:"Somali",flag:"\ud83c\uddf8\ud83c\uddf4"},{code:"om",name:"Afaan Oromoo",englishName:"Oromo",flag:"\ud83c\uddea\ud83c\uddf9"},{code:"ti",name:"\u1275\u130d\u122d\u129b",englishName:"Tigrinya",flag:"\ud83c\uddea\ud83c\uddf7"},{code:"qu",name:"Quechua",englishName:"Quechua",flag:"\ud83c\uddf5\ud83c\uddea"},{code:"gn",name:"Guaran\xed",englishName:"Guarani",flag:"\ud83c\uddf5\ud83c\uddfe"},{code:"ay",name:"Aymar\xe1",englishName:"Aymara",flag:"\ud83c\udde7\ud83c\uddf4"},{code:"mi",name:"Te Reo M\u0101ori",englishName:"Maori",flag:"\ud83c\uddf3\ud83c\uddff"},{code:"sm",name:"Gagana Samoa",englishName:"Samoan",flag:"\ud83c\uddfc\ud83c\uddf8"},{code:"to",name:"Lea Faka-Tonga",englishName:"Tongan",flag:"\ud83c\uddf9\ud83c\uddf4"},{code:"fj",name:"Na Vosa Vakaviti",englishName:"Fijian",flag:"\ud83c\uddeb\ud83c\uddef"},{code:"fo",name:"F\xf8royskt",englishName:"Faroese",flag:"\ud83c\uddeb\ud83c\uddf4"},{code:"kl",name:"Kalaallisut",englishName:"Greenlandic",flag:"\ud83c\uddec\ud83c\uddf1"},{code:"se",name:"Davvis\xe1megiella",englishName:"Northern Sami",flag:"\ud83c\uddf3\ud83c\uddf4"},{code:"eo",name:"Esperanto",englishName:"Esperanto",flag:"\ud83c\udf0d"},{code:"la",name:"Latina",englishName:"Latin",flag:"\ud83c\uddfb\ud83c\udde6"},{code:"sa",name:"\u0938\u0902\u0938\u094d\u0915\u0943\u0924\u092e\u094d",englishName:"Sanskrit",flag:"\ud83c\uddee\ud83c\uddf3"}],m=e=>{let{className:t=""}=e;const{i18n:o,t:a}=(0,s.Bd)(),[r,i]=(0,n.useState)(!1),[c,l]=(0,n.useState)(""),[h,m]=(0,n.useState)(()=>{const e=localStorage.getItem("sgex-selected-languages");return e?JSON.parse(e):u.map(e=>e.code)}),b=(0,n.useMemo)(()=>{const e=[...u];return h.forEach(t=>{if(!u.some(e=>e.code===t)){const o=p.find(e=>e.code===t);o&&e.push({code:o.code,name:o.name,englishName:o.englishName,flag:o.flag})}}),e.map(e=>(0,g.A)((0,g.A)({},e),{},{name:u.some(t=>t.code===e.code)?a(e.name):e.name}))},[h,a]),f=(0,n.useMemo)(()=>{if(!c)return[];const e=c.toLowerCase();return p.filter(t=>!h.includes(t.code)&&(t.name.toLowerCase().includes(e)||t.englishName.toLowerCase().includes(e)||t.code.toLowerCase().includes(e))).slice(0,10)},[c,h]),w=b.find(e=>e.code===o.language)||b[0];return(0,d.jsxs)("div",{className:"language-selector ".concat(t),children:[(0,d.jsxs)("button",{className:"language-toggle",onClick:()=>i(!r),"aria-label":a("language.select"),title:a("language.select"),children:[(0,d.jsx)("span",{className:"language-icon",children:"\ud83d\udc3e\ud83c\udfa7"}),(0,d.jsx)("span",{className:"language-name",children:null===w||void 0===w?void 0:w.name}),(0,d.jsx)("span",{className:"dropdown-arrow ".concat(r?"open":""),children:"\u25bc"})]}),r&&(0,d.jsxs)("div",{className:"language-dropdown",children:[b.map(e=>(0,d.jsxs)("button",{className:"language-option ".concat(o.language===e.code?"active":""),onClick:()=>{return t=e.code,o.changeLanguage(t),i(!1),void l("");var t},children:[(0,d.jsx)("span",{className:"language-flag",children:e.flag}),(0,d.jsx)("span",{className:"language-name",children:e.name}),o.language===e.code&&(0,d.jsx)("span",{className:"language-checkmark",children:"\u2713"})]},e.code)),(0,d.jsxs)("div",{className:"language-search-section",children:[(0,d.jsx)("div",{className:"language-search-divider"}),(0,d.jsx)("div",{className:"language-search-input",children:(0,d.jsx)("input",{type:"text",placeholder:a("language.search"),value:c,onChange:e=>{l(e.target.value)},className:"language-search",autoFocus:!1})}),f.map(e=>(0,d.jsxs)("button",{className:"language-option language-option-addable",onClick:()=>(e=>{const t=[...h,e];m(t),localStorage.setItem("sgex-selected-languages",JSON.stringify(t)),o.changeLanguage(e),i(!1),l("")})(e.code),children:[(0,d.jsx)("span",{className:"language-flag",children:e.flag}),(0,d.jsxs)("span",{className:"language-name",children:[e.name,e.englishName!==e.name&&(0,d.jsxs)("span",{className:"language-english-name",children:[" (",e.englishName,")"]})]}),(0,d.jsx)("span",{className:"language-add-icon",children:"+"})]},e.code)),c&&0===f.length&&(0,d.jsxs)("div",{className:"language-no-results",children:['No languages found for "',c,'"']})]})]})]})};var b=o(19794);const f=e=>{let{pageId:t,helpContent:o,position:r="bottom-right",contextData:i={},notificationBadge:c=!1}=e;const{t:g,i18n:u}=(0,s.Bd)(),[p,f]=(0,n.useState)(!1),[w,y]=(0,n.useState)(!1),[v,k]=(0,n.useState)(null),[x,S]=(0,n.useState)(!0),[A,N]=(0,n.useState)(!1),[C,j]=(0,n.useState)(!1),_=(0,b.A)("sgex-mascot.png");(0,n.useEffect)(()=>{const e=localStorage.getItem("sgex-theme");if(e)S("dark"===e);else{let e=!1;try{window.matchMedia&&(e=window.matchMedia("(prefers-color-scheme: light)").matches)}catch(t){e=!1}S(!e)}},[]),(0,n.useEffect)(()=>{document.body.className=x?"theme-dark":"theme-light",localStorage.setItem("sgex-theme",x?"dark":"light")},[x]),(0,n.useEffect)(()=>{const e=u.language||"en",t=["ar","he","fa"].includes(e);document.documentElement.dir=t?"rtl":"ltr",document.documentElement.lang=e},[u.language]);const T=()=>{S(!x)},D=t?a.A.getHelpTopicsForPage(t,i):[],E=async()=>{if(!A){N(!0),j(!1);try{l.clearAllCache()?(j(!0),setTimeout(()=>{j(!1)},3e3)):(console.error("Failed to clear cache"),alert("Failed to clear cache. Please try again."))}catch(e){console.error("Error clearing cache:",e),alert("Error clearing cache. Please try again.")}finally{N(!1)}}};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"contextual-help-mascot ".concat(r),children:[(0,d.jsxs)("div",{className:"mascot-container",onMouseEnter:()=>{w||f(!0)},onMouseLeave:()=>{w||f(!1)},onClick:()=>{y(!w),f(!w||p)},children:[(0,d.jsx)("img",{src:_,alt:"SGEX Helper",className:"mascot-icon"}),c&&(0,d.jsx)("div",{className:"notification-badge",children:"!"}),!c&&(0,d.jsx)("div",{className:"question-bubble ".concat(p?"help-open":""),children:"?"})]}),p&&(0,d.jsxs)("div",{className:"help-thought-bubble",children:[(0,d.jsxs)("div",{className:"bubble-content",children:[w&&(0,d.jsx)("button",{className:"close-bubble-btn",onClick:()=>{f(!1),y(!1)},"aria-label":"Close help",children:"\xd7"}),(0,d.jsx)("div",{className:"help-text",children:D.length>0?(0,d.jsxs)("div",{className:"help-topics-list",children:[(0,d.jsx)("h4",{children:g("help.title")}),D.map(e=>(0,d.jsxs)("button",{className:"help-topic-btn",onClick:()=>(e=>{"action"===e.type&&e.action?(e.action(),f(!1),y(!1)):(k(e),f(!1),y(!1))})(e),children:[e.badge&&(0,d.jsx)("img",{src:e.badge,alt:"",className:"help-topic-badge"}),(0,d.jsx)("span",{className:"help-topic-title",children:e.title})]},e.id)),(0,d.jsx)("div",{className:"help-menu-divider"}),(0,d.jsx)(m,{className:"help-menu-language-selector"}),(0,d.jsx)("div",{className:"help-menu-divider"}),(0,d.jsxs)("button",{className:"help-theme-toggle-btn ".concat(x?"dark":"light"),onClick:T,"aria-label":g("theme.toggle"),title:g("theme.toggle"),children:[(0,d.jsx)("span",{className:"theme-icon",children:x?"\ud83c\udf1e":"\ud83c\udf19"}),(0,d.jsx)("span",{className:"theme-label",children:x?g("theme.switchToLight","Light Mode"):g("theme.switchToDark","Dark Mode")})]}),(0,d.jsx)("div",{className:"help-menu-divider"}),(0,d.jsx)("div",{className:"help-menu-cache-section",children:C?(0,d.jsx)("div",{className:"cache-success-message",children:"\u2705 Cache cleared successfully!"}):(0,d.jsx)("button",{className:"help-cache-btn",onClick:E,disabled:A,title:"Clear all cached data including repository info, branch context, and staging ground data",children:A?"\ud83d\udd04 Clearing...":"\ud83d\uddd1\ufe0f Flush Cache"})})]}):(0,d.jsxs)("div",{children:[o,(0,d.jsx)("div",{className:"help-menu-divider"}),(0,d.jsx)(m,{className:"help-menu-language-selector"}),(0,d.jsx)("div",{className:"help-menu-divider"}),(0,d.jsxs)("button",{className:"help-theme-toggle-btn ".concat(x?"dark":"light"),onClick:T,"aria-label":g("theme.toggle"),title:g("theme.toggle"),children:[(0,d.jsx)("span",{className:"theme-icon",children:x?"\ud83c\udf1e":"\ud83c\udf19"}),(0,d.jsx)("span",{className:"theme-label",children:x?g("theme.switchToLight","Light Mode"):g("theme.switchToDark","Dark Mode")})]}),(0,d.jsx)("div",{className:"help-menu-divider"}),(0,d.jsx)("div",{className:"help-menu-cache-section",children:C?(0,d.jsx)("div",{className:"cache-success-message",children:"\u2705 Cache cleared successfully!"}):(0,d.jsx)("button",{className:"help-cache-btn",onClick:E,disabled:A,title:"Clear all cached data including repository info, branch context, and staging ground data",children:A?"\ud83d\udd04 Clearing...":"\ud83d\uddd1\ufe0f Flush Cache"})})]})})]}),(0,d.jsx)("div",{className:"bubble-tail"})]})]}),v&&(0,d.jsx)(h.A,{helpTopic:v,contextData:i,onClose:()=>{k(null)}})]})}},19794:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(65043);const s=e=>{const[t,o]=(0,n.useState)(e);return(0,n.useEffect)(()=>{const t=()=>{const t=document.body.classList.contains("theme-dark"),n="/sgex/main",s=e.startsWith("/")?e.slice(1):e;let a;if(t){const e=s.replace(/\.png$/,"_grey_tabby.png");a=n?"".concat(n,"/").concat(e):"/".concat(e)}else a=n?"".concat(n,"/").concat(s):"/".concat(s);o(a)};t();const n=new MutationObserver(e=>{e.forEach(e=>{"attributes"===e.type&&"class"===e.attributeName&&t()})});return n.observe(document.body,{attributes:!0,attributeFilter:["class"]}),()=>{n.disconnect()}},[e]),t}},22392:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(80045),s=o(89379);const a=["savedAt"];const r=new class{constructor(){this.listeners=new Set,this.currentRepository=null,this.currentBranch=null}initialize(e,t){this.currentRepository=e,this.currentBranch=t,this.notifyListeners()}getStorageKey(){if(!this.currentRepository||!this.currentBranch)throw new Error("Staging ground not initialized");return"sgex_staging_".concat(this.currentRepository.full_name,"_").concat(this.currentBranch)}getStagingGround(){try{const e=this.getStorageKey(),t=localStorage.getItem(e);return t?JSON.parse(t):this.createEmptyStagingGround()}catch(e){return console.warn("Error reading staging ground from localStorage:",e),this.createEmptyStagingGround()}}createEmptyStagingGround(){var e;return{message:"",files:[],timestamp:Date.now(),branch:this.currentBranch,repository:null===(e=this.currentRepository)||void 0===e?void 0:e.full_name}}saveStagingGround(e){try{var t;const o=this.getStorageKey();return e.timestamp=Date.now(),e.branch=this.currentBranch,e.repository=null===(t=this.currentRepository)||void 0===t?void 0:t.full_name,localStorage.setItem(o,JSON.stringify(e)),this.saveToHistory(e),this.notifyListeners(),!0}catch(o){return console.error("Error saving staging ground to localStorage:",o),!1}}updateFile(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.getStagingGround(),a=n.files.findIndex(t=>t.path===e),r={path:e,content:t,metadata:(0,s.A)((0,s.A)({},o),{},{lastModified:Date.now()}),timestamp:Date.now()};return a>=0?n.files[a]=r:n.files.push(r),this.saveStagingGround(n)}removeFile(e){const t=this.getStagingGround();return t.files=t.files.filter(t=>t.path!==e),this.saveStagingGround(t)}updateCommitMessage(e){const t=this.getStagingGround();return t.message=e,this.saveStagingGround(t)}hasChanges(){return this.getStagingGround().files.length>0}getChangedFilesCount(){return this.getStagingGround().files.length}clearStagingGround(){const e=this.createEmptyStagingGround();return this.saveStagingGround(e)}saveToHistory(e){try{const t="".concat(this.getStorageKey(),"_history"),o=this.getHistory();o.push((0,s.A)((0,s.A)({},e),{},{savedAt:Date.now()}));const n=o.slice(-10);localStorage.setItem(t,JSON.stringify(n))}catch(t){console.warn("Error saving to history:",t)}}getHistory(){try{const e="".concat(this.getStorageKey(),"_history"),t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch(e){return console.warn("Error reading history:",e),[]}}rollbackToSave(e){const t=this.getHistory().find(t=>t.savedAt===e);if(!t)throw new Error("Save not found in history");const{savedAt:o}=t,s=(0,n.A)(t,a);return this.saveStagingGround(s)}exportStagingGround(){var e;return{current:this.getStagingGround(),history:this.getHistory(),exportedAt:Date.now(),repository:null===(e=this.currentRepository)||void 0===e?void 0:e.full_name,branch:this.currentBranch}}importStagingGround(e){var t;if(!e.current||!e.repository||!e.branch)throw new Error("Invalid export data format");if(e.repository!==(null===(t=this.currentRepository)||void 0===t?void 0:t.full_name)||e.branch!==this.currentBranch)throw new Error("Export data is for different repository or branch");if(this.saveStagingGround(e.current),e.history)try{const t="".concat(this.getStorageKey(),"_history");localStorage.setItem(t,JSON.stringify(e.history))}catch(o){console.warn("Error importing history:",o)}return!0}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6048e5;try{const o=Date.now(),n=[];for(let s=0;s<localStorage.length;s++){const a=localStorage.key(s);if(a&&a.startsWith("sgex_staging_"))try{const t=JSON.parse(localStorage.getItem(a));t.timestamp&&o-t.timestamp>e&&(n.push(a),n.push("".concat(a,"_history")))}catch(t){n.push(a)}}return n.forEach(e=>{localStorage.removeItem(e)}),n.length}catch(t){return console.error("Error during cleanup:",t),0}}addListener(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}notifyListeners(){const e=this.getStagingGround();this.listeners.forEach(t=>{try{t(e)}catch(o){console.error("Error in staging ground listener:",o)}})}contributeFiles(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Array.isArray(e)||(e=[e]);let o=!0;const n=[];return e.forEach(e=>{if(!e.path||!e.content)return n.push({path:e.path,success:!1,error:"Missing path or content"}),void(o=!1);const a=this.updateFile(e.path,e.content,(0,s.A)((0,s.A)({},t),{},{source:t.tool||"unknown",contributedAt:Date.now()}));n.push({path:e.path,success:a}),a||(o=!1)}),{success:o,results:n}}getStatus(){var e;const t=this.getStagingGround();return{hasChanges:this.hasChanges(),filesCount:this.getChangedFilesCount(),lastModified:t.timestamp,branch:this.currentBranch,repository:null===(e=this.currentRepository)||void 0===e?void 0:e.full_name}}}},48517:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(65043),s=o(19794),a=o(70579);const r=e=>{let{topic:t,helpTopic:o,contextData:r,onClose:i}=e;const[c,l]=(0,n.useState)(!1),[h,g]=(0,n.useState)(0),d=(0,s.A)("sgex-mascot.png");(0,n.useEffect)(()=>{const e=(e,t)=>{var o;const n=new URLSearchParams(t);r.pageId&&n.set("sgex_page",r.pageId);const s=window.location.href;return n.set("sgex_current_url",s),null!==(o=r.selectedDak)&&void 0!==o&&o.name&&n.set("sgex_selected_dak",r.selectedDak.name),"".concat(e,"?").concat(n.toString())};return window.helpModalInstance={openSgexIssue:t=>{let o={};switch(t){case"bug":o.template="bug_report.yml",o.labels="bug";break;case"feature":o.template="feature_request.yml",o.labels="enhancement";break;case"question":o.template="question.yml",o.labels="question";break;case"documentation":o.template="documentation.yml",o.labels="documentation";break;case"blank":o.labels="blank-issue";break;default:o.labels="needs-triage"}const n=e("https://github.com/litlfred/sgex/issues/new",o);try{const e=window.open(n,"_blank");var s,a;if(!e||e.closed)null===(s=window.helpModalInstance)||void 0===s||null===(a=s.showFallbackInstructions)||void 0===a||a.call(s,"github-blocked",n,t);else setTimeout(()=>{try{var o,s;if(e.closed||!e.location||"about:blank"===e.location.href)e.close(),null===(o=window.helpModalInstance)||void 0===o||null===(s=o.showFallbackInstructions)||void 0===s||s.call(o,"github-blocked",n,t)}catch(a){}},1e3)}catch(c){var r,i;console.warn("Failed to open GitHub issue:",c),null===(r=window.helpModalInstance)||void 0===r||null===(i=r.showFallbackInstructions)||void 0===i||i.call(r,"github-blocked",n,t)}},openDakIssue:t=>{const o=r.repository||r.selectedDak;if(!o)return void console.warn("No DAK repository specified for feedback");const n="https://github.com/".concat(o.owner,"/").concat(o.name,"/issues/new");let s={};switch(t){case"bug":s.template="dak_bug_report.yml",s.labels="bug,dak-issue";break;case"improvement":s.template="dak_feature_request.yml",s.labels="enhancement,dak-improvement";break;case"content":s.template="dak_content_error.yml",s.labels="content-issue,clinical-content";break;case"question":s.template="dak_question.yml",s.labels="question,dak-question";break;case"blank":s.labels="blank-issue,dak-feedback";break;default:s.labels="dak-feedback"}o.name&&(s.sgex_dak_repository="".concat(o.owner,"/").concat(o.name));const a=e(n,s);try{const e=window.open(a,"_blank");var i,c;if(!e||e.closed)null===(i=window.helpModalInstance)||void 0===i||null===(c=i.showFallbackInstructions)||void 0===c||c.call(i,"github-blocked",a,"dak-".concat(t));else setTimeout(()=>{try{var o,n;if(e.closed||!e.location||"about:blank"===e.location.href)e.close(),null===(o=window.helpModalInstance)||void 0===o||null===(n=o.showFallbackInstructions)||void 0===n||n.call(o,"github-blocked",a,"dak-".concat(t))}catch(s){}},1e3)}catch(g){var l,h;console.warn("Failed to open DAK issue:",g),null===(l=window.helpModalInstance)||void 0===l||null===(h=l.showFallbackInstructions)||void 0===h||h.call(l,"github-blocked",a,"dak-".concat(t))}},showFallbackInstructions:(e,t,o)=>{const n={"github-blocked":{title:"GitHub Access Required",message:'\n              <div class="help-fallback-notice">\n                <h4>\ud83d\udd17 GitHub Link Blocked</h4>\n                <p>It looks like GitHub access is restricted in your current environment.</p>\n                <h5>To report this issue:</h5>\n                <ol>\n                  <li>Copy the link below</li>\n                  <li>Open it in a browser with GitHub access</li>\n                  <li>Fill out the issue template</li>\n                </ol>\n                <div class="fallback-url">\n                  <strong>Link to copy:</strong><br>\n                  <textarea readonly onclick="this.select()" style="width: 100%; height: 60px; margin: 5px 0; padding: 5px; font-family: monospace; font-size: 12px;">'.concat(t,'</textarea>\n                </div>\n                <p><em>\ud83d\udca1 Tip: You can also email us at <a href="mailto:smart@who.int">smart@who.int</a> with your issue details.</em></p>\n              </div>\n            ')}}[e]||{title:"External Link Issue",message:"<p>Unable to open external link. Please copy and visit: <br><code>".concat(t,"</code></p>")},s=document.querySelector(".help-fallback-overlay");s&&s.remove();const a=document.createElement("div");a.className="help-fallback-overlay",a.style.cssText="\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0, 0, 0, 0.7);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          z-index: 10000;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n        ";const r=document.createElement("div");r.style.cssText="\n          background: white;\n          border-radius: 8px;\n          padding: 20px;\n          max-width: 500px;\n          max-height: 80vh;\n          overflow-y: auto;\n          position: relative;\n          box-shadow: 0 10px 25px rgba(0,0,0,0.3);\n        ",r.innerHTML='\n          <button onclick="this.closest(\'.help-fallback-overlay\').remove()" style="\n            position: absolute;\n            top: 10px;\n            right: 15px;\n            background: none;\n            border: none;\n            font-size: 24px;\n            cursor: pointer;\n            color: #666;\n          ">\xd7</button>\n          <h3 style="margin-top: 0; color: #333;">'.concat(n.title,'</h3>\n          <div style="color: #555; line-height: 1.5;">').concat(n.message,"</div>\n        "),a.appendChild(r),document.body.appendChild(a),a.addEventListener("click",e=>{e.target===a&&a.remove()}),setTimeout(()=>{document.body.contains(a)&&a.remove()},3e4)}},()=>{delete window.helpModalInstance}},[r]);const u=()=>{h>0&&g(h-1)},p=()=>{null!==o&&void 0!==o&&o.content&&h<o.content.length-1&&g(h+1)},m=()=>{if(null===o||void 0===o||!o.content||"slideshow"!==o.type)return null;const e=o.content,t=e[h];let n=t.content;return"provide-dak-feedback"===o.id&&(n=n.replace(/onclick="this\.openDakIssue\('([^']+)'\)"/g,"onclick=\"window.helpModalInstance?.openDakIssue('$1')\"")),(0,a.jsxs)("div",{className:"help-slideshow",children:[(0,a.jsxs)("div",{className:"slideshow-header",children:[(0,a.jsx)("h3",{children:t.title}),(0,a.jsxs)("div",{className:"slide-counter",children:[h+1," of ",e.length]})]}),(0,a.jsx)("div",{className:"slideshow-content",dangerouslySetInnerHTML:{__html:n}}),(0,a.jsxs)("div",{className:"slideshow-controls",children:[(0,a.jsx)("button",{onClick:u,disabled:0===h,className:"slide-nav-btn",children:"\u2190 Previous"}),(0,a.jsx)("div",{className:"slide-dots",children:e.map((e,t)=>(0,a.jsx)("button",{className:"slide-dot ".concat(t===h?"active":""),onClick:()=>g(t),"aria-label":"Go to slide ".concat(t+1)},t))}),(0,a.jsx)("button",{onClick:p,disabled:h===e.length-1,className:"slide-nav-btn",children:"Next \u2192"})]})]})},{title:b,content:f}=(()=>{if(o)return{title:o.title,content:"slideshow"===o.type?m():(0,a.jsx)("div",{className:"help-content",children:(0,a.jsxs)("div",{className:"mascot-message",children:[(0,a.jsx)("img",{src:d,alt:"SGEX Helper",className:"help-mascot"}),(0,a.jsx)("div",{className:"message-bubble",children:(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:o.content}})})]})})};switch(t){case"github-token":case"pat-help":return{title:"GitHub Authentication Help",content:(0,a.jsx)("div",{className:"help-content",children:(0,a.jsxs)("div",{className:"mascot-message",children:[(0,a.jsx)("img",{src:d,alt:"SGEX Helper",className:"help-mascot"}),(0,a.jsxs)("div",{className:"message-bubble",children:[(0,a.jsx)("p",{children:"SGEX Workbench uses GitHub Personal Access Tokens for secure authentication!"}),(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:"How it works:"})}),(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:"Create a Personal Access Token in your GitHub settings"}),(0,a.jsx)("li",{children:"Enter the token in the login form"}),(0,a.jsx)("li",{children:"SGEX will securely connect to your GitHub repositories"}),(0,a.jsx)("li",{children:"No backend server required - works entirely in your browser!"})]}),(0,a.jsx)("p",{children:"This approach ensures compliance with our no-backend requirement while keeping your data secure."}),(0,a.jsx)("p",{children:"If you're having trouble, please use the menu above to get additional support."})]})]})})};default:return{title:"SGEX Workbench Help",content:(0,a.jsx)("div",{className:"help-content",children:(0,a.jsxs)("div",{className:"mascot-message",children:[(0,a.jsx)("img",{src:d,alt:"SGEX Helper",className:"help-mascot"}),(0,a.jsxs)("div",{className:"message-bubble",children:[(0,a.jsx)("p",{children:"Hi! I'm here to help you with the SGEX Workbench."}),(0,a.jsx)("p",{children:"Use the menu in the top right to get additional support options."})]})]})})}}})();return(0,a.jsx)("div",{className:"help-modal-overlay",onClick:e=>{e.target===e.currentTarget&&i()},children:(0,a.jsxs)("div",{className:"help-modal",children:[(0,a.jsxs)("div",{className:"help-modal-header",children:[(0,a.jsx)("h2",{children:b}),(0,a.jsxs)("div",{className:"help-modal-actions",children:[(0,a.jsxs)("button",{className:"hamburger-menu-btn",onClick:()=>{l(!c)},"aria-label":"More options",children:[(0,a.jsx)("span",{}),(0,a.jsx)("span",{}),(0,a.jsx)("span",{})]}),(0,a.jsx)("button",{className:"close-btn",onClick:i,"aria-label":"Close help",children:"\xd7"})]}),c&&(0,a.jsxs)("div",{className:"help-menu-dropdown",children:[(0,a.jsxs)("button",{onClick:()=>{window.open("/sgex/docs/overview","_blank")},className:"menu-item",children:[(0,a.jsx)("span",{className:"menu-icon",children:"\ud83d\udcd6"}),"Documentation"]}),(0,a.jsxs)("button",{onClick:()=>{var e;if(null!==(e=window.helpModalInstance)&&void 0!==e&&e.openSgexIssue)window.helpModalInstance.openSgexIssue("bug");else{var t;const e=new URLSearchParams({template:"bug_report.yml",labels:"bug",sgex_page:r.pageId||"unknown",sgex_current_url:window.location.href});null!==(t=r.selectedDak)&&void 0!==t&&t.name&&e.set("sgex_selected_dak",r.selectedDak.name);const c="https://github.com/litlfred/sgex/issues/new?".concat(e.toString());try{const e=window.open(c,"_blank");var o,n;if(!e||e.closed)null===(o=window.helpModalInstance)||void 0===o||null===(n=o.showFallbackInstructions)||void 0===n||n.call(o,"github-blocked",c,"bug")}catch(i){var s,a;console.warn("Failed to open GitHub issue:",i),null===(s=window.helpModalInstance)||void 0===s||null===(a=s.showFallbackInstructions)||void 0===a||a.call(s,"github-blocked",c,"bug")}}},className:"menu-item",children:[(0,a.jsx)("img",{src:"/sgex/bug-report-icon.svg",alt:"Bug",className:"menu-icon"}),"File Bug Report"]}),r.repository&&(0,a.jsxs)("button",{onClick:()=>{var e;r.repository&&(null!==(e=window.helpModalInstance)&&void 0!==e&&e.openDakIssue&&window.helpModalInstance.openDakIssue("content"))},className:"menu-item",children:[(0,a.jsx)("span",{className:"menu-icon",children:"\ud83d\udcdd"}),"Provide DAK Feedback"]}),(0,a.jsxs)("button",{onClick:()=>{const e=(null===o||void 0===o?void 0:o.title)||t,n=encodeURIComponent("SGEX Workbench Support: ".concat(e)),s=encodeURIComponent("\nHello SMART Guidelines Team,\n\nI need assistance with the SGEX Workbench.\n\nTopic: ".concat(e,"\nPage: ").concat(window.location.pathname,"\n\nPlease describe your question or issue:\n\n\nBest regards,\n    ").trim());window.open("mailto:smart@who.int?subject=".concat(n,"&body=").concat(s))},className:"menu-item",children:[(0,a.jsx)("span",{className:"menu-icon",children:"\ud83d\udce7"}),"Email Support"]})]})]}),(0,a.jsx)("div",{className:"help-modal-content",children:f})]})})}},65240:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(5452);const s=new class{constructor(){this.CACHE_KEY_PREFIX="sgex_repo_cache_",this.CACHE_EXPIRY_HOURS=24,this.logger=n.A.getLogger("RepositoryCacheService"),this.logger.debug("RepositoryCacheService initialized",{cacheExpiryHours:this.CACHE_EXPIRY_HOURS})}getCacheKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";return"".concat(this.CACHE_KEY_PREFIX).concat(t,"_").concat(e)}isStale(e){return Date.now()-e>60*this.CACHE_EXPIRY_HOURS*60*1e3}getCachedRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";try{var o;const n=this.getCacheKey(e,t);this.logger.cache("get",n);const s=localStorage.getItem(n);if(!s)return this.logger.cache("miss",n,"No cached data found"),null;const a=JSON.parse(s);return this.isStale(a.timestamp)?(this.logger.cache("expired",n,{age:Date.now()-a.timestamp}),localStorage.removeItem(n),null):(this.logger.cache("hit",n,{repositoryCount:(null===(o=a.repositories)||void 0===o?void 0:o.length)||0,age:Date.now()-a.timestamp}),{repositories:a.repositories,timestamp:a.timestamp,owner:a.owner,type:a.type})}catch(n){const o=this.getCacheKey(e,t);return this.logger.error("Error reading repository cache",{cacheKey:o,error:n.message}),console.warn("Error reading repository cache:",n),null}}setCachedRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",o=arguments.length>2?arguments[2]:void 0;try{const n=this.getCacheKey(e,t),s={repositories:o,timestamp:Date.now(),owner:e,type:t};return this.logger.cache("set",n,{repositoryCount:(null===o||void 0===o?void 0:o.length)||0,owner:e,type:t}),localStorage.setItem(n,JSON.stringify(s)),!0}catch(n){const o=this.getCacheKey(e,t);return this.logger.error("Error caching repositories",{cacheKey:o,error:n.message}),console.warn("Error caching repositories:",n),!1}}clearCache(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";try{const o=this.getCacheKey(e,t);return this.logger.cache("clear",o,{owner:e,type:t}),localStorage.removeItem(o),!0}catch(o){const n=this.getCacheKey(e,t);return this.logger.error("Error clearing repository cache",{cacheKey:n,error:o.message}),console.warn("Error clearing repository cache:",o),!1}}clearAllCaches(){try{return Object.keys(localStorage).forEach(e=>{e.startsWith(this.CACHE_KEY_PREFIX)&&localStorage.removeItem(e)}),!0}catch(e){return console.warn("Error clearing all repository caches:",e),!1}}getCacheInfo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";const o=this.getCachedRepositories(e,t);if(!o)return{exists:!1,stale:!0};const n=Date.now()-o.timestamp,s=Math.round(n/36e5);return{exists:!0,stale:this.isStale(o.timestamp),age:n,ageHours:s,repositoryCount:o.repositories.length,timestamp:new Date(o.timestamp).toISOString()}}}},68598:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(5452);const s=new class{constructor(){this.logger=n.A.getLogger("SecureTokenStorage"),this.storageKey="sgex_secure_token",this.expirationHours=24,this.logger.debug("SecureTokenStorage instance created")}generateBrowserFingerprint(){const e=document.createElement("canvas"),t=e.getContext("2d");t.textBaseline="top",t.font="14px Arial",t.fillText("Browser fingerprint",2,2);const o=[navigator.userAgent,navigator.language,window.screen.width+"x"+window.screen.height,window.screen.colorDepth,(new Date).getTimezoneOffset(),e.toDataURL()].join("|");let n=0;for(let s=0;s<o.length;s++){n=(n<<5)-n+o.charCodeAt(s),n&=n}return Math.abs(n).toString(36)}xorCipher(e,t){let o="";for(let n=0;n<e.length;n++)o+=String.fromCharCode(e.charCodeAt(n)^t.charCodeAt(n%t.length));return o}validateTokenFormat(e){if(!e||"string"!==typeof e)return{isValid:!1,type:"invalid",reason:"Token is empty or not a string"};const t=e.trim();return t.match(/^ghp_[A-Za-z0-9]{36}$/)?{isValid:!0,type:"classic",token:t}:t.match(/^github_pat_[A-Za-z0-9]{22}_[A-Za-z0-9]{59}$/)?{isValid:!0,type:"fine-grained",token:t}:t.match(/^gho_[A-Za-z0-9]{36}$/)?{isValid:!0,type:"oauth",token:t}:t.match(/^[a-fA-F0-9]{40}$/)?{isValid:!0,type:"legacy",token:t}:{isValid:!1,type:"invalid",reason:"Token does not match expected GitHub PAT format"}}maskToken(e){if(!e||"string"!==typeof e)return"[INVALID_TOKEN]";const t=e.trim();return t.length<8?"[INVALID_TOKEN]":"".concat(t.substring(0,4)).concat("*".repeat(t.length-8)).concat(t.substring(t.length-4))}storeToken(e){try{this.logger.debug("Starting secure token storage");const t=this.validateTokenFormat(e);if(!t.isValid)return this.logger.warn("Token validation failed",{reason:t.reason,tokenMask:this.maskToken(e)}),!1;this.logger.debug("Token validation successful",{type:t.type,tokenMask:this.maskToken(e)});const o=this.generateBrowserFingerprint(),n="sgex_".concat(o,"_").concat(Date.now().toString(36)),s=this.xorCipher(t.token,n),a={token:btoa(s),key:btoa(n),type:t.type,created:Date.now(),expires:Date.now()+60*this.expirationHours*60*1e3,fingerprint:o};return sessionStorage.setItem(this.storageKey,JSON.stringify(a)),localStorage.removeItem("github_token"),sessionStorage.removeItem("github_token"),this.logger.debug("Token stored securely",{type:t.type,expires:new Date(a.expires).toISOString(),tokenMask:this.maskToken(e)}),!0}catch(t){return this.logger.error("Failed to store token securely",{error:t.message,tokenMask:this.maskToken(e)}),!1}}retrieveToken(){try{this.logger.debug("Attempting to retrieve secure token");const e=sessionStorage.getItem(this.storageKey);if(!e)return this.logger.debug("No secure token found in storage"),null;const t=JSON.parse(e);if(Date.now()>t.expires)return this.logger.warn("Stored token has expired"),this.clearToken(),null;const o=this.generateBrowserFingerprint();if(t.fingerprint!==o)return this.logger.warn("Browser fingerprint mismatch - possible security issue"),this.clearToken(),null;const n=atob(t.key),s=atob(t.token),a=this.xorCipher(s,n),r=this.validateTokenFormat(a);return r.isValid?(this.logger.debug("Token retrieved and decrypted successfully",{type:t.type,expires:new Date(t.expires).toISOString(),tokenMask:this.maskToken(a)}),{token:r.token,type:t.type,created:t.created,expires:t.expires}):(this.logger.error("Decrypted token failed validation"),this.clearToken(),null)}catch(e){return this.logger.error("Failed to retrieve secure token",{error:e.message}),this.clearToken(),null}}hasValidToken(){try{const e=sessionStorage.getItem(this.storageKey);if(!e)return!1;const t=JSON.parse(e);if(Date.now()>t.expires)return this.clearToken(),!1;const o=this.generateBrowserFingerprint();return t.fingerprint===o||(this.clearToken(),!1)}catch(e){return this.logger.error("Error checking token validity",{error:e.message}),this.clearToken(),!1}}clearToken(){this.logger.debug("Clearing secure token storage"),sessionStorage.removeItem(this.storageKey),sessionStorage.removeItem("github_token"),localStorage.removeItem("github_token")}getTokenInfo(){try{const e=sessionStorage.getItem(this.storageKey);if(!e)return null;const t=JSON.parse(e),o=t.expires-Date.now();return{type:t.type,created:new Date(t.created),expires:new Date(t.expires),timeRemaining:Math.max(0,o),isExpired:o<=0,isValid:this.hasValidToken()}}catch(e){return this.logger.error("Error getting token info",{error:e.message}),null}}migrateLegacyToken(){try{const e=sessionStorage.getItem("github_token")||localStorage.getItem("github_token");if(!e)return this.logger.debug("No legacy token found for migration"),!1;this.logger.debug("Migrating legacy token to secure storage");return this.storeToken(e)?(sessionStorage.removeItem("github_token"),localStorage.removeItem("github_token"),this.logger.debug("Legacy token migration completed successfully"),!0):(this.logger.error("Failed to migrate legacy token"),!1)}catch(e){return this.logger.error("Error during legacy token migration",{error:e.message}),!1}}}},78362:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(89379);const s=new class{constructor(){this.storageKey="sgex_feature_files",this.metadataKey="sgex_feature_files_metadata"}getAllLocalChanges(){try{const e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):{}}catch(e){return console.error("Error reading local changes:",e),{}}}getLocalContent(e){return this.getAllLocalChanges()[e]||null}saveLocal(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const s=this.getAllLocalChanges();s[e]=t,localStorage.setItem(this.storageKey,JSON.stringify(s));const a=this.getAllMetadata();return a[e]=(0,n.A)((0,n.A)({},o),{},{lastModified:(new Date).toISOString(),originalPath:e}),localStorage.setItem(this.metadataKey,JSON.stringify(a)),!0}catch(s){return console.error("Error saving to localStorage:",s),!1}}removeLocal(e){try{const t=this.getAllLocalChanges();delete t[e],localStorage.setItem(this.storageKey,JSON.stringify(t));const o=this.getAllMetadata();return delete o[e],localStorage.setItem(this.metadataKey,JSON.stringify(o)),!0}catch(t){return console.error("Error removing from localStorage:",t),!1}}getAllMetadata(){try{const e=localStorage.getItem(this.metadataKey);return e?JSON.parse(e):{}}catch(e){return console.error("Error reading metadata:",e),{}}}getMetadata(e){return this.getAllMetadata()[e]||null}hasLocalChanges(){const e=this.getAllLocalChanges();return Object.keys(e).length>0}getLocalChangesCount(){const e=this.getAllLocalChanges();return Object.keys(e).length}exportLocalChanges(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"json";const t=this.getAllLocalChanges(),o=this.getAllMetadata();if("json"===e){const e={exported:(new Date).toISOString(),version:"1.0",changes:t,metadata:o};return new Blob([JSON.stringify(e,null,2)],{type:"application/json"})}throw new Error("Export format '".concat(e,"' not supported"))}importLocalChanges(e){try{const t=JSON.parse(e);if(!t.changes||!t.metadata)throw new Error("Invalid import data format");const o=this.getAllLocalChanges(),s=this.getAllMetadata(),a=(0,n.A)((0,n.A)({},o),t.changes),r=(0,n.A)((0,n.A)({},s),t.metadata);return localStorage.setItem(this.storageKey,JSON.stringify(a)),localStorage.setItem(this.metadataKey,JSON.stringify(r)),!0}catch(t){return console.error("Error importing local changes:",t),!1}}clearAllLocalChanges(){localStorage.removeItem(this.storageKey),localStorage.removeItem(this.metadataKey)}getStorageInfo(){const e=this.getAllLocalChanges(),t=this.getAllMetadata(),o=JSON.stringify(e).length,n=JSON.stringify(t).length,s=o+n;return{fileCount:Object.keys(e).length,totalSize:s,changesSize:o,metadataSize:n,formattedSize:this.formatBytes(s)}}formatBytes(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}}},88691:(e,t,o)=>{o.r(t),o.d(t,{default:()=>n});const n=new class{constructor(){this.storageKey="sgex_branch_context"}getRepositoryKey(e){var t,o;if(!e||!e.name)return null;const n=(null===(t=e.owner)||void 0===t?void 0:t.login)||(null===(o=e.full_name)||void 0===o?void 0:o.split("/")[0]);return n?"".concat(n,"/").concat(e.name):null}getSelectedBranch(e){if(!e)return null;try{const t=this.getBranchContext();return t[this.getRepositoryKey(e)]||null}catch(t){return console.warn("Failed to get branch context:",t),null}}setSelectedBranch(e,t){if(e&&t)try{const o=this.getBranchContext();o[this.getRepositoryKey(e)]=t,this.setBranchContext(o)}catch(o){console.warn("Failed to set branch context:",o)}}clearRepositoryBranch(e){if(e)try{const t=this.getBranchContext();delete t[this.getRepositoryKey(e)],this.setBranchContext(t)}catch(t){console.warn("Failed to clear repository branch context:",t)}}clearAllBranchContext(){try{sessionStorage.removeItem(this.storageKey)}catch(e){console.warn("Failed to clear branch context:",e)}}getBranchContext(){try{const e=sessionStorage.getItem(this.storageKey);return e?JSON.parse(e):{}}catch(e){return console.warn("Failed to parse branch context from storage:",e),{}}}setBranchContext(e){try{sessionStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){console.warn("Failed to save branch context to storage:",t)}}getDefaultBranchName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e?t.some(e=>"main"===e.name)?"main":e.default_branch&&t.some(t=>t.name===e.default_branch)?e.default_branch:t.length>0?t[0].name:"main":"main"}hasBranchContext(e){return null!==this.getSelectedBranch(e)}getBranchDisplayInfo(e){const t=this.getSelectedBranch(e);if(!t)return null;const o=t===((null===e||void 0===e?void 0:e.default_branch)||"main");return{branch:t,isDefault:o,displayText:o?"".concat(t," (default)"):t}}}},89387:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(55661),s=o(93071);const a=new class{async validateDAKRepository(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";try{const s=await this.checkRepositoryExists(e,t),a=await this.fetchSushiConfig(e,t,o);if(!a)return s?(console.log("Repository ".concat(e,"/").concat(t," exists on GitHub - allowing access even without sushi-config.yaml")),!0):(console.log("No sushi-config.yaml found in ".concat(e,"/").concat(t," and repository doesn't exist")),!1);const r=n.Ay.load(a);if(!r||"object"!==typeof r)return s?(console.log("Invalid YAML format in sushi-config.yaml for ".concat(e,"/").concat(t," but repository exists - allowing access")),!0):(console.log("Invalid YAML format in sushi-config.yaml for ".concat(e,"/").concat(t)),!1);if(!r.dependencies||"object"!==typeof r.dependencies)return s?(console.log("No dependencies section found in sushi-config.yaml for ".concat(e,"/").concat(t," but repository exists - allowing access")),!0):(console.log("No dependencies section found in sushi-config.yaml for ".concat(e,"/").concat(t)),!1);return"smart.who.int.base"in r.dependencies?(console.log("Valid DAK repository found: ".concat(e,"/").concat(t," (has smart.who.int.base dependency)")),!0):s?(console.log("Repository ".concat(e,"/").concat(t," has sushi-config.yaml but missing smart.who.int.base dependency - allowing access since repository exists")),!0):(console.log("Repository ".concat(e,"/").concat(t," has sushi-config.yaml but missing smart.who.int.base dependency")),!1)}catch(s){return console.log("Error validating DAK repository ".concat(e,"/").concat(t,":"),s.message),!1}}async checkRepositoryExists(e,t){try{const o=s.A.isAuth()?s.A.octokit:null;return o?(await o.rest.repos.get({owner:e,repo:t}),console.log("Repository ".concat(e,"/").concat(t," exists on GitHub")),!0):(console.log("Cannot check repository existence for ".concat(e,"/").concat(t," - not authenticated")),!1)}catch(o){return 404===o.status?(console.log("Repository ".concat(e,"/").concat(t," does not exist on GitHub")),!1):(console.log("Error checking repository existence for ".concat(e,"/").concat(t,":"),o.message,"- assuming it might exist"),!0)}}async fetchSushiConfig(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";try{const a=s.A.isAuth()?s.A.octokit:null;if(!a)return console.log("Cannot fetch sushi-config.yaml for ".concat(e,"/").concat(t," - not authenticated")),null;const r="main"===o?["main","master"]:[o];for(const o of r)try{const{data:n}=await a.rest.repos.getContent({owner:e,repo:t,path:"sushi-config.yaml",ref:o});if("file"===n.type&&n.content){const s=decodeURIComponent(escape(atob(n.content)));return console.log("Found sushi-config.yaml in ".concat(e,"/").concat(t," on branch ").concat(o)),s}}catch(n){console.log("sushi-config.yaml not found on branch ".concat(o," for ").concat(e,"/").concat(t,":"),404===n.status?"File not found":n.message);continue}return null}catch(a){return console.log("Error fetching sushi-config.yaml for ".concat(e,"/").concat(t,":"),a.message),null}}validateDemoDAKRepository(e,t){if(!e||!t||e.includes("/")||t.includes("/"))return console.log("Demo mode: Invalid repository format ".concat(e,"/").concat(t)),!1;const o=/^[a-zA-Z0-9._-]+$/;if(!o.test(e)||!o.test(t))return console.log("Demo mode: Invalid characters in repository name ".concat(e,"/").concat(t)),!1;const n="".concat(e,"/").concat(t);return console.log("Demo mode: ".concat(n," accepted as valid DAK repository (proper org/repo format)")),!0}}},93071:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(89379),s=o(97036);async function a(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{concurrency:n=5,onProgress:s=null,onItemComplete:a=null,onItemStart:r=null}=o;if(!e||0===e.length)return[];const i=new Array(e.length),c=e.length;let l=0;const h=e.map((e,t)=>({item:e,index:t})),g=Array(Math.min(n,e.length)).fill().map(()=>(async()=>{for(;h.length>0;){const{item:o,index:n}=h.shift();r&&r(o,n);try{const e=await t(o,n);i[n]=e,l++,s&&s(l,c,o,e),a&&a(o,e,null)}catch(e){i[n]={error:e,item:o},l++,s&&s(l,c,o,null),a&&a(o,null,e)}}})());return await Promise.all(g),i}const r=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;this.cache=new Map,this.ttl=60*e*1e3}_getCacheKey(e,t){return"".concat(e,"/").concat(t)}_isValid(e){return Date.now()-e.timestamp<this.ttl}get(e,t){const o=this._getCacheKey(e,t),n=this.cache.get(o);return n?this._isValid(n)?n.compatible:(this.cache.delete(o),null):null}set(e,t,o){const n=this._getCacheKey(e,t);this.cache.set(n,{compatible:o,timestamp:Date.now()})}clear(){this.cache.clear()}cleanup(){const e=Date.now();for(const[t,o]of this.cache.entries())e-o.timestamp>=this.ttl&&this.cache.delete(t)}getStats(){return this.cleanup(),{size:this.cache.size,ttlMinutes:this.ttl/6e4,entries:Array.from(this.cache.entries()).map(e=>{let[t,o]=e;return{repository:t,compatible:o.compatible,ageMinutes:Math.round((Date.now()-o.timestamp)/6e4)}})}}};var i=o(68598),c=o(5452);const l=new class{constructor(){this.octokit=null,this.isAuthenticated=!1,this.permissions=null,this.tokenType=null,this.logger=c.A.getLogger("GitHubService"),this.logger.debug("GitHubService instance created")}authenticate(e){const t=Date.now();this.logger.auth("Starting authentication",{tokenProvided:!!e,tokenMask:e?i.A.maskToken(e):"none"});try{const o=i.A.validateTokenFormat(e);if(!o.isValid)return this.logger.warn("Token validation failed during authentication",{reason:o.reason,tokenMask:i.A.maskToken(e)}),this.isAuthenticated=!1,!1;this.octokit=new s.Octokit({auth:o.token}),this.isAuthenticated=!0,this.tokenType=o.type;const n=i.A.storeToken(o.token);n||this.logger.warn("Failed to store token securely, authentication will not persist");const a=Date.now()-t;return this.logger.auth("Authentication successful",{duration:a,tokenType:this.tokenType,tokenMask:i.A.maskToken(e),securelyStored:n}),this.logger.performance("GitHub authentication",a),!0}catch(o){const n=Date.now()-t;return this.logger.auth("Authentication failed",{error:o.message,duration:n,tokenMask:i.A.maskToken(e)}),console.error("Failed to authenticate with GitHub:",o),this.isAuthenticated=!1,i.A.clearToken(),!1}}authenticateWithOctokit(e){this.logger.auth("Starting OAuth authentication with Octokit instance");try{return this.octokit=e,this.isAuthenticated=!0,this.tokenType="oauth",this.logger.auth("OAuth authentication successful",{tokenType:this.tokenType}),!0}catch(t){return this.logger.auth("OAuth authentication failed",{error:t.message}),console.error("Failed to authenticate with Octokit instance:",t),this.isAuthenticated=!1,!1}}initializeFromStoredToken(){this.logger.auth("Attempting to initialize from stored token");try{i.A.migrateLegacyToken()&&this.logger.debug("Successfully migrated legacy token to secure storage");const e=i.A.retrieveToken();return e?(this.octokit=new s.Octokit({auth:e.token}),this.isAuthenticated=!0,this.tokenType=e.type,this.logger.auth("Successfully initialized from stored token",{tokenType:this.tokenType,tokenMask:i.A.maskToken(e.token),expires:new Date(e.expires).toISOString()}),!0):(this.logger.debug("No valid stored token found"),!1)}catch(e){return this.logger.auth("Failed to initialize from stored token",{error:e.message}),this.isAuthenticated=!1,i.A.clearToken(),!1}}hasStoredToken(){return i.A.hasValidToken()}getStoredTokenInfo(){return i.A.getTokenInfo()}async checkTokenPermissions(){if(!this.isAuth()){const e=new Error("Not authenticated with GitHub");throw this.logger.error("Token permission check failed - not authenticated"),e}const e=Date.now();this.logger.apiCall("GET","/user",null);try{const o=await this.octokit.request("GET /user");this.logger.apiResponse("GET","/user",o.status,Date.now()-e);try{const e=Date.now();this.logger.apiCall("GET","/rate_limit",null);const t=await this.octokit.rest.rateLimit.get();this.logger.apiResponse("GET","/rate_limit",t.status,Date.now()-e),this.tokenType=t.data.resources.core?"classic":"fine-grained",this.logger.debug("Token type determined",{tokenType:this.tokenType,hasCore:!!t.data.resources.core})}catch(t){this.tokenType="unknown",this.logger.warn("Could not determine token type from rate limit",{error:t.message})}const n={type:this.tokenType,user:o.data};return this.permissions=n,this.logger.debug("Token permissions checked successfully",{tokenType:this.tokenType,username:o.data.login}),n}catch(o){const t=Date.now()-e;throw this.logger.apiError("GET","/user",o),this.logger.performance("Token permission check (failed)",t),console.error("Failed to check token permissions:",o),o}}async checkRepositoryWritePermissions(e,t){if(!this.isAuth())return this.logger.warn("Cannot check repository write permissions - not authenticated",{owner:e,repo:t}),!1;const o=Date.now();this.logger.debug("Checking write permissions for repository",{owner:e,repo:t});try{const n=(await this.getCurrentUser()).login;this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/collaborators/").concat(n,"/permission"),null);const{data:s}=await this.octokit.rest.repos.getCollaboratorPermissionLevel({owner:e,repo:t,username:n}),a=Date.now()-o;this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/collaborators/").concat(n,"/permission"),200,a);const r=["write","admin"].includes(s.permission);return this.logger.debug("Repository write permissions checked",{owner:e,repo:t,permission:s.permission,hasWriteAccess:r}),r}catch(n){const s=Date.now()-o;return this.logger.apiError("GET","/repos/".concat(e,"/").concat(t,"/collaborators/*/permission"),n),this.logger.performance("Repository write permission check (failed)",s),console.warn("Could not check repository write permissions:",n),this.logger.warn("Assuming no write access due to permission check failure",{owner:e,repo:t,error:n.message}),!1}}async checkRepositoryPermissions(e,t){return this.checkRepositoryWritePermissions(e,t)}isAuth(){return this.isAuthenticated&&null!==this.octokit}async getCurrentUser(){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:e}=await this.octokit.rest.users.getAuthenticated();return e}catch(e){throw console.error("Failed to fetch user data:",e),e}}async getUserOrganizations(){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:e}=await this.octokit.rest.orgs.listForAuthenticatedUser();return e}catch(e){throw console.error("Failed to fetch organizations:",e),e}}async getOrganization(e){try{const t=this.octokit||new s.Octokit,{data:o}=await t.rest.orgs.get({org:e});return o}catch(t){throw console.error("Failed to fetch organization ".concat(e,":"),t),t}}async getUser(e){try{const t=this.octokit||new s.Octokit,{data:o}=await t.rest.users.getByUsername({username:e});return o}catch(t){throw console.error("Failed to fetch user ".concat(e,":"),t),t}}async getPublicRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";try{const o=this.octokit||new s.Octokit;let n=[],a=1,r=!0;for(;r;){let s;s="user"===t?await o.rest.repos.listForUser({username:e,sort:"updated",per_page:100,page:a}):await o.rest.repos.listForOrg({org:e,sort:"updated",per_page:100,page:a}),n=n.concat(s.data),r=100===s.data.length,a++}return n}catch(o){throw console.error("Failed to fetch public repositories for ".concat(e,":"),o),o}}async getWHOOrganization(){try{const e=await this.getOrganization("WorldHealthOrganization");return{id:e.id,login:e.login,display_name:e.name||"World Health Organization",description:e.description||"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:e.avatar_url,html_url:e.html_url,type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0}}catch(e){return console.warn("Could not fetch WHO organization data from API, using fallback:",e),{id:"who-organization",login:"WorldHealthOrganization",display_name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0}}}async getRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";return arguments.length>2&&void 0!==arguments[2]&&arguments[2]||"demo-user"===e?this.getDemoRepositories(e):this.getSmartGuidelinesRepositories(e,t)}getDemoRepositories(e){const t=[{id:"demo-smart-anc",name:"smart-anc",full_name:"".concat(e,"/smart-anc"),description:"Demo SMART Guidelines Digital Adaptation Kit for Antenatal Care",private:!1,owner:{login:e,id:"demo-owner",avatar_url:"https://github.com/".concat(e,".png"),type:"User"},html_url:"https://github.com/".concat(e,"/smart-anc"),clone_url:"https://github.com/".concat(e,"/smart-anc.git"),language:"FSH",stargazers_count:15,forks_count:3,open_issues_count:2,topics:["who","smart-guidelines","dak","antenatal-care","health"],created_at:"2023-01-15T10:00:00Z",updated_at:"2024-12-15T14:30:00Z",pushed_at:"2024-12-15T14:30:00Z",default_branch:"main",smart_guidelines_compatible:!0,isDemo:!0},{id:"demo-smart-tb",name:"smart-tb",full_name:"".concat(e,"/smart-tb"),description:"Demo SMART Guidelines Digital Adaptation Kit for Tuberculosis Care",private:!1,owner:{login:e,id:"demo-owner",avatar_url:"https://github.com/".concat(e,".png"),type:"User"},html_url:"https://github.com/".concat(e,"/smart-tb"),clone_url:"https://github.com/".concat(e,"/smart-tb.git"),language:"FSH",stargazers_count:8,forks_count:1,open_issues_count:0,topics:["who","smart-guidelines","dak","tuberculosis","health"],created_at:"2023-03-20T15:00:00Z",updated_at:"2024-11-30T09:15:00Z",pushed_at:"2024-11-30T09:15:00Z",default_branch:"main",smart_guidelines_compatible:!0,isDemo:!0},{id:"demo-smart-ips-pilgrimage",name:"smart-ips-pilgrimage",full_name:"".concat(e,"/smart-ips-pilgrimage"),description:"Demo SMART Guidelines International Patient Summary for Pilgrimage",private:!1,owner:{login:e,id:"demo-owner",avatar_url:"https://github.com/".concat(e,".png"),type:"User"},html_url:"https://github.com/".concat(e,"/smart-ips-pilgrimage"),clone_url:"https://github.com/".concat(e,"/smart-ips-pilgrimage.git"),language:"FSH",stargazers_count:12,forks_count:2,open_issues_count:1,topics:["who","smart-guidelines","dak","ips","pilgrimage","health"],created_at:"2023-06-10T12:00:00Z",updated_at:"2024-12-01T16:45:00Z",pushed_at:"2024-12-01T16:45:00Z",default_branch:"main",smart_guidelines_compatible:!0,isDemo:!0}];return Promise.resolve(t)}async checkSmartGuidelinesCompatibility(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=r.get(e,t);if(null!==n)return n;try{const o=this.octokit||new s.Octokit,{data:n}=await o.rest.repos.getContent({owner:e,repo:t,path:"sushi-config.yaml"});if("file"===n.type&&n.content){const o=decodeURIComponent(escape(atob(n.content))).includes("smart.who.int.base");return r.set(e,t,o),o}return r.set(e,t,!1),!1}catch(a){if(404===a.status&&o>0){console.warn("File not found for ".concat(e,"/").concat(t,", retrying... (").concat(o," attempts left)"));const n=1e3;return await new Promise(e=>setTimeout(e,n)),this.checkSmartGuidelinesCompatibility(e,t,o-1)}return console.warn("Failed to check ".concat(e,"/").concat(t," for sushi-config.yaml with smart.who.int.base dependency:"),a.message),r.set(e,t,!1),!1}}async getSmartGuidelinesRepositories(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";try{let o=[];if(this.isAuth()){let n=1,s=!0;for(;s;){let a;a="user"===t?await this.octokit.rest.repos.listForUser({username:e,sort:"updated",per_page:100,page:n}):await this.octokit.rest.repos.listForOrg({org:e,sort:"updated",per_page:100,page:n}),o=o.concat(a.data),s=100===a.data.length,n++}}else o=await this.getPublicRepositories(e,t);const s=[];for(const e of o){await this.checkSmartGuidelinesCompatibility(e.owner.login,e.name)&&s.push((0,n.A)((0,n.A)({},e),{},{smart_guidelines_compatible:!0}))}return s}catch(o){throw console.error("Failed to fetch SMART guidelines repositories:",o),o}}async getSmartGuidelinesRepositoriesProgressive(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{let r=[],i=1,c=!0;for(;c;){let o;o="user"===t?await this.octokit.rest.repos.listForUser({username:e,sort:"updated",per_page:100,page:i}):await this.octokit.rest.repos.listForOrg({org:e,sort:"updated",per_page:100,page:i}),r=r.concat(o.data),c=100===o.data.length,i++}if(0===r.length)return console.log("\ud83d\udcca No repositories found for user, completing scan immediately"),s&&s({current:0,total:0,currentRepo:"none",progress:100,completed:!0}),[];const l=async(e,t)=>{await new Promise(e=>setTimeout(e,100+200*Math.random()));if(await this.checkSmartGuidelinesCompatibility(e.owner.login,e.name)){const t=(0,n.A)((0,n.A)({},e),{},{smart_guidelines_compatible:!0});return o&&o(t),t}return null},h=await a(r,l,{concurrency:5,onProgress:(e,t,o,n)=>{s&&s({current:e,total:t,currentRepo:o.name,progress:Math.round(e/t*100),completed:!0})},onItemStart:(e,t)=>{s&&s({current:t+1,total:r.length,currentRepo:e.name,progress:Math.round((t+1)/r.length*100),completed:!1,started:!0})}});return h.filter(e=>null!==e&&!e.error)}catch(r){throw console.error("Failed to fetch SMART guidelines repositories:",r),r}}async getRepository(e,t){try{const o=this.isAuth()?this.octokit:new s.Octokit,{data:n}=await o.rest.repos.get({owner:e,repo:t});return n}catch(o){throw console.error("Failed to fetch repository:",o),o}}async getBranches(e,t){try{console.log("githubService.getBranches: Fetching branches for ".concat(e,"/").concat(t)),console.log("githubService.getBranches: Authentication status:",this.isAuth());const o=this.isAuth()?this.octokit:new s.Octokit;console.log("githubService.getBranches: Using",this.isAuth()?"authenticated":"public","octokit instance");const{data:n}=await o.rest.repos.listBranches({owner:e,repo:t,per_page:100});return console.log("githubService.getBranches: Successfully fetched ".concat(n.length," branches")),n}catch(o){throw console.error("githubService.getBranches: Failed to fetch branches:",o),console.error("githubService.getBranches: Error details:",{status:o.status,message:o.message,owner:e,repo:t}),o}}async createBranch(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main";if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:s}=await this.octokit.rest.git.getRef({owner:e,repo:t,ref:"heads/".concat(n)}),{data:a}=await this.octokit.rest.git.createRef({owner:e,repo:t,ref:"refs/heads/".concat(o),sha:s.object.sha});return a}catch(s){throw console.error("Failed to create branch:",s),s}}async getBranch(e,t,o){try{const n=this.isAuth()?this.octokit:new s.Octokit,{data:a}=await n.rest.repos.getBranch({owner:e,repo:t,branch:o});return a}catch(n){throw console.error("Failed to fetch branch:",n),n}}async getWorkflows(e,t){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:o}=await this.octokit.rest.actions.listRepoWorkflows({owner:e,repo:t});return o.workflows.map(e=>({id:e.id,name:e.name,filename:e.path.split("/").pop(),path:e.path,state:e.state,created_at:e.created_at,updated_at:e.updated_at,url:e.html_url,triggers:["unknown"],lastModified:e.updated_at}))}catch(o){if(404===o.status)return[];throw console.error("Failed to fetch workflows:",o),o}}async getWorkflowRuns(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const n={owner:e,repo:t,per_page:o.per_page||10,page:o.page||1};o.branch&&(n.branch=o.branch),o.workflow_id&&(n.workflow_id=o.workflow_id);const{data:s}=await this.octokit.rest.actions.listWorkflowRunsForRepo(n);return s}catch(n){throw console.error("Failed to fetch workflow runs:",n),n}}async getWorkflowRunsForWorkflow(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const s={owner:e,repo:t,workflow_id:o,per_page:n.per_page||10,page:n.page||1};n.branch&&(s.branch=n.branch);const{data:a}=await this.octokit.rest.actions.listWorkflowRuns(s);return a}catch(s){throw console.error("Failed to fetch workflow runs for workflow:",s),s}}async triggerWorkflow(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:a}=await this.octokit.rest.actions.createWorkflowDispatch({owner:e,repo:t,workflow_id:o,ref:n,inputs:s});return a}catch(a){throw console.error("Failed to trigger workflow:",a),a}}async rerunWorkflow(e,t,o){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.actions.reRunWorkflow({owner:e,repo:t,run_id:o});return n}catch(n){throw console.error("Failed to re-run workflow:",n),n}}async getWorkflowRunLogs(e,t,o){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.actions.downloadWorkflowRunLogs({owner:e,repo:t,run_id:o});return n}catch(n){throw console.error("Failed to get workflow run logs:",n),n}}async approveWorkflowRun(e,t,o){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.actions.approveWorkflowRun({owner:e,repo:t,run_id:o});return n}catch(n){throw console.error("Failed to approve workflow run:",n),n}}async getCommitDiff(e,t,o,n){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:s}=await this.octokit.rest.repos.compareCommits({owner:e,repo:t,base:o,head:n});return s}catch(s){throw console.error("Failed to get commit diff:",s),s}}async getCommit(e,t,o){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.repos.getCommit({owner:e,repo:t,ref:o});return n}catch(n){throw console.error("Failed to get commit details:",n),n}}async getReleases(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:n}=await this.octokit.rest.repos.listReleases({owner:e,repo:t,per_page:o.per_page||10,page:o.page||1});return n}catch(n){throw console.error("Failed to fetch releases:",n),n}}async getLatestRelease(e,t){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:o}=await this.octokit.rest.repos.getLatestRelease({owner:e,repo:t});return o}catch(o){throw console.error("Failed to fetch latest release:",o),o}}async getBpmnFilesRecursive(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];try{console.log("\ud83d\udd0e githubService.getBpmnFilesRecursive: Searching ".concat(e,"/").concat(t,"/").concat(o," (ref: ").concat(n,")"));const r=this.isAuth()?this.octokit:new s.Octokit;console.log("\ud83d\udd10 githubService.getBpmnFilesRecursive: Using ".concat(this.isAuth()?"authenticated":"public"," octokit"));const{data:i}=await r.rest.repos.getContent({owner:e,repo:t,path:o,ref:n});if(console.log("\ud83d\udce6 githubService.getBpmnFilesRecursive: Received data type: ".concat(Array.isArray(i)?"array":"single file",", length: ").concat(Array.isArray(i)?i.length:1)),!Array.isArray(i))return i.name.endsWith(".bpmn")&&(console.log("\ud83d\udcc4 githubService.getBpmnFilesRecursive: Found single BPMN file: ".concat(i.name)),a.push(i)),a;for(const o of i)"file"===o.type&&o.name.endsWith(".bpmn")?(console.log("\ud83d\udcc4 githubService.getBpmnFilesRecursive: Found BPMN file: ".concat(o.name)),a.push(o)):"dir"===o.type&&(console.log("\ud83d\udcc1 githubService.getBpmnFilesRecursive: Found subdirectory: ".concat(o.name,", recursing...")),await this.getBpmnFilesRecursive(e,t,o.path,n,a));return console.log("\u2705 githubService.getBpmnFilesRecursive: Completed search of ".concat(o,", found ").concat(a.length," total files so far")),a}catch(r){if(console.log("\u274c githubService.getBpmnFilesRecursive: Error searching ".concat(o,":"),r.status,r.message),404===r.status)return a;throw r}}async getBpmnFiles(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";console.log("\ud83d\udd0d githubService.getBpmnFiles: Starting search for ".concat(e,"/").concat(t," (ref: ").concat(o,")"));const n=[],s=["input/business-processes","input/business-process"];for(const i of s)try{console.log("\ud83d\udcc1 githubService.getBpmnFiles: Searching in directory: ".concat(i));const s=await this.getBpmnFilesRecursive(e,t,i,o);console.log("\u2705 githubService.getBpmnFiles: Found ".concat(s.length," BPMN files in ").concat(i)),n.push(...s)}catch(r){404!==r.status?console.warn("\u274c Could not fetch BPMN files from ".concat(i,":"),r.message):console.log("\ud83d\udcc2 githubService.getBpmnFiles: Directory ".concat(i," not found (404) - this is expected if the directory doesn't exist"))}const a=n.filter((e,t,o)=>t===o.findIndex(t=>t.path===e.path));return console.log("\ud83c\udfaf githubService.getBpmnFiles: Final result - ".concat(a.length," unique BPMN files found")),console.log("\ud83d\udccb githubService.getBpmnFiles: File list:",a.map(e=>e.name)),a}async getFileContent(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main";const a=15e3;try{console.log("\ud83d\ude80 githubService.getFileContent: Starting request for ".concat(e,"/").concat(t,"/").concat(o," (ref: ").concat(n,")")),console.log("\ud83d\udd10 githubService.getFileContent: Authentication status:",this.isAuth()),console.log("\ud83d\udccb githubService.getFileContent: Request parameters:",{owner:e,repo:t,path:o,ref:n});const r=this.isAuth()?this.octokit:new s.Octokit;console.log("\ud83d\udd27 githubService.getFileContent: Using",this.isAuth()?"authenticated":"public","octokit instance");const i=new Promise((e,t)=>{console.log("\u23f0 githubService.getFileContent: Setting up ".concat(a,"ms timeout")),setTimeout(()=>{console.error("\u23f0 githubService.getFileContent: Request timed out after ".concat(a,"ms")),t(new Error("Request timeout after ".concat(a,"ms")))},a)});console.log("\ud83c\udf10 githubService.getFileContent: Creating GitHub API promise...");const c=r.rest.repos.getContent({owner:e,repo:t,path:o,ref:n});console.log("\ud83d\udce1 githubService.getFileContent: API request initiated, waiting for response...");const l=Date.now(),{data:h}=await Promise.race([c,i]),g=Date.now()-l;if(console.log("\u2705 githubService.getFileContent: API response received in ".concat(g,"ms")),console.log("\ud83d\udcc2 githubService.getFileContent: Response data type:",h.type),console.log("\ud83d\udcca githubService.getFileContent: Response details:",{type:h.type,name:h.name,size:h.size,encoding:h.encoding,hasContent:!!h.content}),"file"===h.type&&h.content){console.log("\ud83d\udd27 githubService.getFileContent: Decoding base64 content..."),console.log("\ud83d\udcca githubService.getFileContent: Base64 content length:",h.content.length);const e=decodeURIComponent(escape(atob(h.content)));return console.log("\u2705 githubService.getFileContent: Successfully fetched and decoded file content"),console.log("\ud83d\udccf githubService.getFileContent: Final content length:",e.length,"characters"),console.log("\ud83d\udc40 githubService.getFileContent: Content preview (first 200 chars):",e.substring(0,200)),e}throw console.error("\u274c githubService.getFileContent: Invalid response - not a file or no content"),console.error("\ud83d\udd0d githubService.getFileContent: Full response data:",JSON.stringify(h,null,2)),new Error("File not found or is not a file")}catch(i){var r;if(console.error("\ud83d\udca5 githubService.getFileContent: Failed to fetch file content from ".concat(e,"/").concat(t,"/").concat(o,":"),i),console.error("\ud83d\udd0d githubService.getFileContent: Error analysis:",{type:typeof i,status:i.status,message:i.message,name:i.name,stack:(null===(r=i.stack)||void 0===r?void 0:r.substring(0,500))+"..."}),i.message.includes("timeout"))throw console.error("\u23f0 githubService.getFileContent: Timeout error detected"),new Error("GitHub API request timed out after ".concat(15," seconds. Please try again."));if(403===i.status)throw console.error("\ud83d\udd12 githubService.getFileContent: 403 Forbidden error detected"),new Error("Access denied. This repository may be private or you may have hit rate limits.");if(404===i.status)throw console.error("\ud83d\udd0d githubService.getFileContent: 404 Not Found error detected"),new Error("File not found in the repository.");if(i.message.includes("rate limit"))throw console.error("\ud83d\udea6 githubService.getFileContent: Rate limit error detected"),new Error("GitHub API rate limit exceeded. Please try again later.");if(i.message.includes("Network Error")||i.message.includes("Failed to fetch"))throw console.error("\ud83c\udf10 githubService.getFileContent: Network error detected"),new Error("Network error occurred. Please check your internet connection and try again.");throw console.error("\u2753 githubService.getFileContent: Unknown error type, re-throwing original error"),i}}async createCommit(e,t,o,n,s){if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const{data:a}=await this.octokit.rest.git.getRef({owner:e,repo:t,ref:"heads/".concat(o)}),r=a.object.sha,{data:i}=await this.octokit.rest.git.getCommit({owner:e,repo:t,commit_sha:r}),c=i.tree.sha,l=await Promise.all(s.map(async o=>{const{data:n}=await this.octokit.rest.git.createBlob({owner:e,repo:t,content:o.content,encoding:"utf-8"});return{path:o.path,mode:"100644",type:"blob",sha:n.sha}})),{data:h}=await this.octokit.rest.git.createTree({owner:e,repo:t,base_tree:c,tree:l}),{data:g}=await this.octokit.rest.git.createCommit({owner:e,repo:t,message:n,tree:h.sha,parents:[r]});return await this.octokit.rest.git.updateRef({owner:e,repo:t,ref:"heads/".concat(o),sha:g.sha}),{sha:g.sha,html_url:"https://github.com/".concat(e,"/").concat(t,"/commit/").concat(g.sha),message:g.message,author:g.author,committer:g.committer}}catch(a){throw console.error("Failed to create commit:",a),a}}async getRecentCommits(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;if(!this.isAuth())throw new Error("Not authenticated with GitHub");const s=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/commits"),{sha:o,per_page:n});try{const a=await this.octokit.rest.repos.listCommits({owner:e,repo:t,sha:o,per_page:n});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/commits"),a.status,Date.now()-s),a.data.map(e=>({sha:e.sha,message:e.commit.message,author:{name:e.commit.author.name,email:e.commit.author.email,date:e.commit.author.date},committer:{name:e.commit.committer.name,email:e.commit.committer.email,date:e.commit.committer.date},html_url:e.html_url,stats:e.stats}))}catch(a){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/commits"),a.status||"error",Date.now()-s),console.error("Failed to fetch recent commits:",a),a}}async getOpenPullRequestsCount(e,t){if(!this.isAuth())throw new Error("Not authenticated with GitHub");const o=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls"),{state:"open",per_page:1});try{const n=await this.octokit.rest.pulls.list({owner:e,repo:t,state:"open",per_page:1});this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),n.status,Date.now()-o);const s=n.headers.link;if(s&&s.includes('rel="last"')){const e=s.match(/page=(\d+)>; rel="last"/);if(e)return parseInt(e[1],10)}return n.data.length}catch(n){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),n.status||"error",Date.now()-o),console.error("Failed to fetch pull requests count:",n),n}}async getPullRequestForBranch(e,t,o){const n=await this.getPullRequestsForBranch(e,t,o);return n&&n.length>0?n[0]:null}async getPullRequestsForBranch(e,t,o){const n=this.isAuth()?this.octokit:new s.Octokit,a=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls"),{state:"open",head:"".concat(e,":").concat(o)});try{const s=await n.rest.pulls.list({owner:e,repo:t,state:"open",head:"".concat(e,":").concat(o),per_page:100});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),s.status,Date.now()-a),s.data||[]}catch(r){return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),r.status||"error",Date.now()-a),console.error("Failed to fetch pull requests for branch:",r),[]}}async getPullRequestComments(e,t,o){if(!this.isAuth())throw new Error("Not authenticated with GitHub");const n=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(o,"/comments"),{});try{const s=await this.octokit.rest.pulls.listReviewComments({owner:e,repo:t,pull_number:o,per_page:100});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(o,"/comments"),s.status,Date.now()-n),s.data}catch(s){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls/").concat(o,"/comments"),s.status||"error",Date.now()-n),console.error("Failed to fetch pull request comments:",s),s}}async getPullRequestIssueComments(e,t,o){if(!this.isAuth())throw new Error("Not authenticated with GitHub");const n=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(o,"/comments"),{});try{const s=await this.octokit.rest.issues.listComments({owner:e,repo:t,issue_number:o,per_page:100});return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(o,"/comments"),s.status,Date.now()-n),s.data}catch(s){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues/").concat(o,"/comments"),s.status||"error",Date.now()-n),console.error("Failed to fetch pull request issue comments:",s),s}}async createPullRequestComment(e,t,o,n){if(!this.isAuth())throw new Error("Not authenticated with GitHub");const s=Date.now();this.logger.apiCall("POST","/repos/".concat(e,"/").concat(t,"/issues/").concat(o,"/comments"),{body:n});try{const a=await this.octokit.rest.issues.createComment({owner:e,repo:t,issue_number:o,body:n});return this.logger.apiResponse("POST","/repos/".concat(e,"/").concat(t,"/issues/").concat(o,"/comments"),a.status,Date.now()-s),a.data}catch(a){throw this.logger.apiResponse("POST","/repos/".concat(e,"/").concat(t,"/issues/").concat(o,"/comments"),a.status||"error",Date.now()-s),console.error("Failed to create pull request comment:",a),a}}async getOpenIssuesCount(e,t){if(!this.isAuth())throw new Error("Not authenticated with GitHub");const o=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/issues"),{state:"open",per_page:1});try{const n=await this.octokit.rest.issues.listForRepo({owner:e,repo:t,state:"open",per_page:1});this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues"),n.status,Date.now()-o);const s=n.headers.link;if(s&&s.includes('rel="last"')){const e=s.match(/page=(\d+)>; rel="last"/);if(e)return parseInt(e[1],10)}return n.data.length}catch(n){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/issues"),n.status||"error",Date.now()-o),console.error("Failed to fetch issues count:",n),n}}async getRepositoryStats(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main";if(!this.isAuth())throw new Error("Not authenticated with GitHub");try{const[n,s,a]=await Promise.allSettled([this.getRecentCommits(e,t,o,1),this.getOpenPullRequestsCount(e,t),this.getOpenIssuesCount(e,t)]);return{recentCommits:"fulfilled"===n.status?n.value:[],openPullRequestsCount:"fulfilled"===s.status?s.value:0,openIssuesCount:"fulfilled"===a.status?a.value:0,errors:{recentCommits:"rejected"===n.status?n.reason:null,openPullRequestsCount:"rejected"===s.status?s.reason:null,openIssuesCount:"rejected"===a.status?a.reason:null}}}catch(n){throw console.error("Failed to fetch repository stats:",n),n}}async getDirectoryContents(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main";try{const a=this.isAuth()?this.octokit:new s.Octokit,{data:r}=await a.rest.repos.getContent({owner:e,repo:t,path:o,ref:n});if(Array.isArray(r))return r;throw new Error("Not a directory")}catch(a){throw console.error("Failed to get directory contents for ".concat(o,":"),a),a}}async updateFile(e,t,o,n,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"main";if(!this.isAuth())throw new Error("Authentication required to update files");try{const{data:r}=await this.octokit.rest.repos.getContent({owner:e,repo:t,path:o,ref:a});if(Array.isArray(r))throw new Error("Path is a directory, not a file");const{data:i}=await this.octokit.rest.repos.createOrUpdateFileContents({owner:e,repo:t,path:o,message:s,content:btoa(unescape(encodeURIComponent(n))),sha:r.sha,branch:a});return i}catch(r){throw console.error("Failed to update file ".concat(o,":"),r),r}}async getCommits(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const n=this.isAuth()?this.octokit:new s.Octokit,a={owner:e,repo:t,per_page:o.per_page||10,page:o.page||1};o.sha&&(a.sha=o.sha),o.since&&(a.since=o.since),o.until&&(a.until=o.until);const{data:r}=await n.rest.repos.listCommits(a);return r}catch(n){throw console.error("Failed to fetch commits:",n),n}}async getIssues(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const n=this.isAuth()?this.octokit:new s.Octokit,a={owner:e,repo:t,state:o.state||"all",per_page:o.per_page||30,page:o.page||1};o.labels&&(a.labels=o.labels),o.milestone&&(a.milestone=o.milestone);const{data:r}=await n.rest.issues.listForRepo(a);return r}catch(n){throw console.error("Failed to fetch issues:",n),n}}async getRepositoryIssues(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getIssues(e,t,o)}async getForks(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/forks"),o);try{const a=this.isAuth()?this.octokit:new s.Octokit,r={owner:e,repo:t,sort:o.sort||"newest",per_page:o.per_page||100,page:o.page||1},{data:i}=await a.rest.repos.listForks(r);return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/forks"),200,Date.now()-n),i.map(e=>({id:e.id,name:e.name,full_name:e.full_name,owner:{login:e.owner.login,avatar_url:e.owner.avatar_url,html_url:e.owner.html_url,type:e.owner.type},description:e.description,html_url:e.html_url,clone_url:e.clone_url,created_at:e.created_at,updated_at:e.updated_at,pushed_at:e.pushed_at,stargazers_count:e.stargazers_count,forks_count:e.forks_count,open_issues_count:e.open_issues_count,default_branch:e.default_branch,private:e.private,fork:e.fork,parent:e.parent?{full_name:e.parent.full_name,html_url:e.parent.html_url}:null}))}catch(a){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/forks"),a.status||"error",Date.now()-n),console.error("Failed to fetch repository forks:",a),a}}async getPullRequests(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Date.now();this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/pulls"),o);try{const a=this.isAuth()?this.octokit:new s.Octokit,r={owner:e,repo:t,state:o.state||"open",sort:o.sort||"updated",direction:o.direction||"desc",per_page:o.per_page||30,page:o.page||1};o.head&&(r.head=o.head),o.base&&(r.base=o.base);const{data:i}=await a.rest.pulls.list(r);return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),200,Date.now()-n),i.map(e=>({id:e.id,number:e.number,title:e.title,body:e.body,state:e.state,locked:e.locked,user:{login:e.user.login,avatar_url:e.user.avatar_url,html_url:e.user.html_url,type:e.user.type},created_at:e.created_at,updated_at:e.updated_at,closed_at:e.closed_at,merged_at:e.merged_at,html_url:e.html_url,diff_url:e.diff_url,patch_url:e.patch_url,head:{ref:e.head.ref,sha:e.head.sha,repo:e.head.repo?{name:e.head.repo.name,full_name:e.head.repo.full_name,owner:{login:e.head.repo.owner.login,avatar_url:e.head.repo.owner.avatar_url},html_url:e.head.repo.html_url}:null},base:{ref:e.base.ref,sha:e.base.sha,repo:{name:e.base.repo.name,full_name:e.base.repo.full_name,owner:{login:e.base.repo.owner.login,avatar_url:e.base.repo.owner.avatar_url},html_url:e.base.repo.html_url}},draft:e.draft,mergeable:e.mergeable,mergeable_state:e.mergeable_state,comments:e.comments,review_comments:e.review_comments,commits:e.commits,additions:e.additions,deletions:e.deletions,changed_files:e.changed_files}))}catch(a){throw this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/pulls"),a.status||"error",Date.now()-n),console.error("Failed to fetch pull requests:",a),a}}logout(){this.logger.auth("Logging out and clearing stored token"),this.octokit=null,this.isAuthenticated=!1,this.tokenType=null,this.permissions=null,i.A.clearToken();try{const{default:e}=o(88691);e.clearAllBranchContext()}catch(e){sessionStorage.removeItem("sgex_branch_context")}}async getRepositoryForks(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Date.now();this.logger.debug("Fetching repository forks",{owner:e,repo:t,options:o});try{const a=this.isAuth()?this.octokit:new s.Octokit;this.logger.apiCall("GET","/repos/".concat(e,"/").concat(t,"/forks"),o);const{data:r}=await a.rest.repos.listForks({owner:e,repo:t,sort:"newest",per_page:o.per_page||100,page:o.page||1}),i=Date.now()-n;return this.logger.apiResponse("GET","/repos/".concat(e,"/").concat(t,"/forks"),200,i,{forkCount:r.length}),this.logger.performance("Repository forks fetch",i),r}catch(a){const o=Date.now()-n;throw this.logger.apiError("GET","/repos/".concat(e,"/").concat(t,"/forks"),a),this.logger.performance("Repository forks fetch (failed)",o),console.error("Failed to fetch forks for ".concat(e,"/").concat(t,":"),a),a}}}}}]);
//# sourceMappingURL=786.cb6bcf85.chunk.js.map