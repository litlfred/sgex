"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[636],{12516:(e,s,n)=>{n.d(s,{A:()=>u});var i=n(9950),a=n(29946),t=n(57561),o=n(89379),r=n(57335);const l=n(44131);const c=new class{constructor(){this.validators=new Map,this.initializeSchemaValidator(),this.initializeDefaultValidators()}async initializeSchemaValidator(){const e=await(0,r.Ys)(),s=await(0,r._r)();this.ajv=new e({allErrors:!0,verbose:!0}),s(this.ajv),this.sushiConfigValidator=this.ajv.compile(l)}initializeDefaultValidators(){this.addValidator("xml","xml-well-formed",{level:"error",description:"XML files must be well-formed",validator:this.validateXMLWellFormed.bind(this)}),this.addValidator("bpmn","xml-well-formed",{level:"error",description:"BPMN files must be well-formed XML",validator:this.validateXMLWellFormed.bind(this)}),this.addValidator("bpmn","bpmn-namespace",{level:"error",description:"BPMN files must use correct BPMN 2.0 namespace",validator:this.validateBPMNNamespace.bind(this)}),this.addValidator("bpmn","has-start-event",{level:"warning",description:"BPMN process should have at least one start event",validator:this.validateBPMNStartEvent.bind(this)}),this.addValidator("dmn","xml-well-formed",{level:"error",description:"DMN files must be well-formed XML",validator:this.validateXMLWellFormed.bind(this)}),this.addValidator("dmn","dmn-namespace",{level:"error",description:"DMN files must use correct DMN 1.3 namespace",validator:this.validateDMNNamespace.bind(this)}),this.addValidator("json","json-valid",{level:"error",description:"JSON files must be valid JSON",validator:this.validateJSONSyntax.bind(this)}),this.addValidator("json","fhir-resource-type",{level:"info",description:"FHIR resources should have valid resourceType",validator:this.validateFHIRResourceType.bind(this)}),this.addValidator("*","file-size-limit",{level:"warning",description:"Files should be under 1MB for optimal performance",validator:this.validateFileSize.bind(this)}),this.addValidator("*","filename-conventions",{level:"info",description:"Files should follow naming conventions",validator:this.validateFilenameConventions.bind(this)}),this.addValidator("yaml","sushi-config-valid",{level:"error",description:"sushi-config.yaml must be valid and contain required fields",validator:this.validateSushiConfig.bind(this)})}addValidator(e,s,n){this.validators.has(e)||this.validators.set(e,new Map),this.validators.get(e).set(s,n)}removeValidator(e,s){this.validators.has(e)&&this.validators.get(e).delete(s)}async validateFile(e,s){const n=[],i=this.getFileExtension(e),a=this.getFileName(e),t=this.validators.get(i)||new Map,r=this.validators.get("*")||new Map;for(const[c,d]of t)try{const i=await d.validator(e,s,a);i&&n.push((0,o.A)({validatorId:c,level:d.level,description:d.description},i))}catch(l){n.push({validatorId:c,level:"error",description:"Validator execution failed",message:l.message,filePath:e})}for(const[c,d]of r)try{const i=await d.validator(e,s,a);i&&n.push((0,o.A)({validatorId:c,level:d.level,description:d.description},i))}catch(l){n.push({validatorId:c,level:"error",description:"Validator execution failed",message:l.message,filePath:e})}return n}async validateStagingGround(e){const s={summary:{error:0,warning:0,info:0},files:{},validatedAt:Date.now()};for(const n of e.files){const e=await this.validateFile(n.path,n.content);s.files[n.path]=e,e.forEach(e=>{"error"===e.level?s.summary.error++:"warning"===e.level?s.summary.warning++:"info"===e.level&&s.summary.info++})}return s}async canSave(e){return 0===(await this.validateStagingGround(e)).summary.error}async validateXMLWellFormed(e,s){try{const n=new DOMParser,i=n.parseFromString(s,"text/xml").querySelector("parsererror");return i?{message:"XML is not well-formed: "+i.textContent,filePath:e}:null}catch(n){return{message:"Failed to parse XML: "+n.message,filePath:e}}}async validateBPMNNamespace(e,s){return s.includes('xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL"')?null:{message:"BPMN file missing correct BPMN 2.0 namespace declaration",filePath:e,suggestion:'Add xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" to root element'}}async validateBPMNStartEvent(e,s){return s.includes("<startEvent")||s.includes("<bpmn:startEvent")?null:{message:"BPMN process should contain at least one start event",filePath:e,suggestion:"Add a start event to begin the process flow"}}async validateDMNNamespace(e,s){return s.includes('xmlns:dmn="https://www.omg.org/spec/DMN/20191111/MODEL/"')?null:{message:"DMN file missing correct DMN 1.3 namespace declaration",filePath:e,suggestion:'Add xmlns:dmn="https://www.omg.org/spec/DMN/20191111/MODEL/" to root element'}}async validateJSONSyntax(e,s){try{return JSON.parse(s),null}catch(n){return{message:"Invalid JSON syntax: "+n.message,filePath:e}}}async validateFHIRResourceType(e,s){try{const n=JSON.parse(s),i=["StructureDefinition","ValueSet","CodeSystem","ConceptMap","Questionnaire","PlanDefinition","ActivityDefinition","Measure","Library","ImplementationGuide","Bundle","Patient","Practitioner"];return n.resourceType&&!i.includes(n.resourceType)?{message:"Unknown FHIR resourceType: ".concat(n.resourceType),filePath:e,suggestion:"Verify the resourceType is correct for FHIR R4"}:null}catch(n){return null}}async validateFileSize(e,s){const n=new Blob([s]).size;return n>1048576?{message:"File size (".concat((n/1024/1024).toFixed(1),"MB) exceeds recommended limit of 1MB"),filePath:e,suggestion:"Consider breaking large files into smaller components"}:null}async validateFilenameConventions(e,s){const n=this.getFileName(e),i=[];return n.includes(" ")&&i.push("avoid spaces in filenames"),/[<>:"|?*]/.test(n)&&i.push('avoid special characters (<>:"|?*)'),n.length>100&&i.push("filename is very long (>100 characters)"),i.length>0?{message:"Filename convention issues: ".concat(i.join(", ")),filePath:e,suggestion:"Use lowercase letters, numbers, hyphens, and underscores"}:null}async validateSushiConfig(e,s){if(!e.endsWith("sushi-config.yaml"))return null;try{let i;try{i=(await(0,r.cb)()).load(s)}catch(n){return{message:"Invalid YAML syntax: ".concat(n.message),filePath:e,suggestion:"Fix YAML syntax errors and ensure proper indentation"}}if(!i||"object"!==typeof i)return{message:"sushi-config.yaml must contain a valid YAML object",filePath:e,suggestion:"Ensure the file contains proper YAML object structure"};if(!this.sushiConfigValidator(i)){const s=this.sushiConfigValidator.errors,n=s.map(e=>{var s,n;const i=e.instancePath?e.instancePath.replace("/",""):(null===(s=e.params)||void 0===s?void 0:s.missingProperty)||"root";let a="".concat(i,": ").concat(e.message);return null!==(n=e.params)&&void 0!==n&&n.allowedValues&&(a+=" (allowed: ".concat(e.params.allowedValues.join(", "),")")),a});return{message:"sushi-config.yaml validation errors: ".concat(n.join("; ")),filePath:e,suggestion:"Review the sushi-config.yaml specification at https://fshschool.org/docs/sushi/configuration/",details:s}}const a=this.validateWHOSmartGuidelines(i);return a||null}catch(i){return{message:"Failed to validate sushi-config.yaml: "+i.message,filePath:e,suggestion:"Check file format and content structure"}}}validateWHOSmartGuidelines(e){const s=[];return e.dependencies&&e.dependencies["smart.who.int.base"]||s.push("missing smart.who.int.base dependency (required for WHO DAK compliance)"),e.canonical&&e.canonical.includes("smart.who.int")&&(e.id.startsWith("smart.who.int")||s.push('id should start with "smart.who.int" when using WHO canonical URL')),e.canonical&&e.canonical.includes("smart.who.int")&&(e.publisher&&e.publisher.toLowerCase().includes("world health organization")||s.push('publisher should include "World Health Organization" for WHO guidelines'),e.jurisdiction&&Array.isArray(e.jurisdiction)||s.push("jurisdiction should be specified for WHO guidelines")),s.length>0?{message:"WHO SMART Guidelines compliance issues: ".concat(s.join(", ")),filePath:"sushi-config.yaml",suggestion:"Ensure compliance with WHO SMART Guidelines requirements"}:null}getFileExtension(e){const s=e.split(".");return s.length>1?s[s.length-1].toLowerCase():""}getFileName(e){return e.split("/").pop()||e}formatValidationResults(e){const s={canSave:0===e.summary.error,summary:e.summary,files:[]};return Object.entries(e.files).forEach(e=>{let[n,i]=e;i.length>0&&s.files.push({path:n,issues:i.map(e=>({level:e.level,message:e.message,description:e.description,suggestion:e.suggestion}))})}),s}getValidationSummary(e){return{error:e.summary.error,warning:e.summary.warning,info:e.summary.info,canSave:0===e.summary.error,hasIssues:e.summary.error+e.summary.warning+e.summary.info>0}}};var d=n(44414);const m=e=>{var s,n;let{isOpen:o,onClose:r,stagingGround:l,validation:m,repository:p,selectedBranch:h,hasWriteAccess:u,onSaveSuccess:g}=e;const[f,v]=(0,i.useState)(""),[b,y]=(0,i.useState)(!1),[x,j]=(0,i.useState)(!1),[N,w]=(0,i.useState)(null),[k,S]=(0,i.useState)(!1);if((0,i.useEffect)(()=>{o&&(v((null===l||void 0===l?void 0:l.message)||""),y(!1),j(!1),w(null),S(!1))},[o,l]),!o)return null;const C=m?c.getValidationSummary(m):null,D=!C||(C.canSave||b),P=!!C&&C.error>0,A=e=>409===e.status?"Conflict detected. The branch has been updated since you started. Please refresh and try again.":403===e.status?"Permission denied. Check that your token has write access to this repository.":404===e.status?"Repository or branch not found. Please verify the repository exists and you have access.":e.message?e.message:"An unexpected error occurred while saving. Please try again.",M=e=>{switch(e){case"error":return"\ud83d\udd34";case"warning":return"\ud83d\udfe1";case"info":return"\ud83d\udfe2";default:return"\u2753"}};return(0,d.jsx)("div",{className:"save-dialog-overlay",children:(0,d.jsxs)("div",{className:"save-dialog",children:[(0,d.jsxs)("div",{className:"dialog-header",children:[(0,d.jsx)("h3",{children:"\ud83d\udcbe Save Changes"}),(0,d.jsx)("button",{className:"dialog-close",onClick:r,disabled:x,children:"\xd7"})]}),(0,d.jsxs)("div",{className:"dialog-content",children:[(0,d.jsxs)("div",{className:"save-summary",children:[(0,d.jsxs)("h4",{children:["Files to be committed (",(null===l||void 0===l||null===(s=l.files)||void 0===s?void 0:s.length)||0,"):"]}),(0,d.jsx)("div",{className:"files-list",children:null===l||void 0===l||null===(n=l.files)||void 0===n?void 0:n.map((e,s)=>(0,d.jsxs)("div",{className:"file-item",children:[(0,d.jsx)("span",{className:"file-icon",children:"\ud83d\udcc4"}),(0,d.jsx)("span",{className:"file-path",children:e.path}),(0,d.jsxs)("span",{className:"file-size",children:[(new Blob([e.content]).size/1024).toFixed(1)," KB"]}),(0,d.jsx)("button",{className:"remove-file-btn",onClick:s=>{var n;s.stopPropagation(),n=e.path,window.confirm('Are you sure you want to remove "'.concat(n,'" from staging? This cannot be undone.'))&&t.A.removeFile(n)},title:"Remove ".concat(e.path," from staging"),disabled:x,children:"\ud83d\uddd1\ufe0f"})]},s))})]}),C&&(0,d.jsxs)("div",{className:"validation-section",children:[(0,d.jsx)("div",{className:"validation-summary ".concat(C.hasIssues?"has-issues":"clean"),onClick:()=>S(!k),children:(0,d.jsxs)("div",{className:"validation-header",children:[(0,d.jsx)("h4",{children:"\ud83d\udea6 Validation Status"}),(0,d.jsxs)("div",{className:"validation-badges",children:[C.error>0&&(0,d.jsxs)("span",{className:"validation-badge error",children:["\ud83d\udd34 ",C.error]}),C.warning>0&&(0,d.jsxs)("span",{className:"validation-badge warning",children:["\ud83d\udfe1 ",C.warning]}),C.info>0&&(0,d.jsxs)("span",{className:"validation-badge info",children:["\ud83d\udfe2 ",C.info]}),!C.hasIssues&&(0,d.jsx)("span",{className:"validation-badge success",children:"\u2705 All clear"})]}),(0,d.jsx)("span",{className:"expand-icon ".concat(k?"expanded":""),children:"\u25bc"})]})}),k&&m&&(0,d.jsx)("div",{className:"validation-details",children:Object.entries(m.files).map(e=>{let[s,n]=e;return n.length>0&&(0,d.jsxs)("div",{className:"file-validation",children:[(0,d.jsxs)("h5",{children:["\ud83d\udcc4 ",s]}),(0,d.jsx)("div",{className:"validation-issues",children:n.map((e,s)=>(0,d.jsxs)("div",{className:"validation-issue ".concat(e.level),children:[(0,d.jsx)("span",{className:"issue-icon",children:M(e.level)}),(0,d.jsxs)("div",{className:"issue-content",children:[(0,d.jsx)("div",{className:"issue-message",children:e.message}),e.suggestion&&(0,d.jsxs)("div",{className:"issue-suggestion",children:["\ud83d\udca1 ",e.suggestion]})]})]},s))})]},s)})}),P&&(0,d.jsxs)("div",{className:"override-section",children:[(0,d.jsxs)("label",{className:"override-checkbox",children:[(0,d.jsx)("input",{type:"checkbox",checked:b,onChange:e=>y(e.target.checked)}),(0,d.jsx)("span",{className:"checkmark"}),"Override validation errors and save anyway"]}),(0,d.jsx)("p",{className:"override-warning",children:"\u26a0\ufe0f Saving with validation errors may cause issues with your DAK. Only enable this if you're sure about your changes."})]})]}),(0,d.jsxs)("div",{className:"commit-message-section",children:[(0,d.jsx)("label",{htmlFor:"commit-message",children:(0,d.jsx)("h4",{children:"\u270d\ufe0f Commit Message"})}),(0,d.jsx)("textarea",{id:"commit-message",className:"commit-message-input",value:f,onChange:e=>v(e.target.value),placeholder:"Describe your changes...",rows:3,disabled:x,required:!0}),(0,d.jsx)("div",{className:"commit-tips",children:(0,d.jsxs)("p",{children:["\ud83d\udca1 ",(0,d.jsx)("strong",{children:"Tip:"})," Write a clear, descriptive message about what you changed and why."]})})]}),N&&(0,d.jsx)("div",{className:"error-section",children:(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsx)("span",{className:"error-icon",children:"\u274c"}),N]})}),(0,d.jsxs)("div",{className:"repo-info",children:[(0,d.jsxs)("div",{className:"info-item",children:[(0,d.jsx)("span",{className:"info-label",children:"Repository:"}),(0,d.jsx)("span",{className:"info-value",children:null===p||void 0===p?void 0:p.full_name})]}),(0,d.jsxs)("div",{className:"info-item",children:[(0,d.jsx)("span",{className:"info-label",children:"Branch:"}),(0,d.jsx)("span",{className:"info-value",children:h})]}),(0,d.jsxs)("div",{className:"info-item",children:[(0,d.jsx)("span",{className:"info-label",children:"Access:"}),(0,d.jsx)("span",{className:"info-value ".concat(u?"write":"read"),children:u?"\u270f\ufe0f Write":"\ud83d\udc41\ufe0f Read-only"})]})]})]}),(0,d.jsxs)("div",{className:"dialog-actions",children:[(0,d.jsx)("button",{className:"action-btn secondary",onClick:r,disabled:x,children:"Cancel"}),(0,d.jsx)("button",{className:"action-btn primary",onClick:async()=>{if(f.trim())if(u)if(!P||b){j(!0),w(null);try{var e;const s=(null===(e=p.owner)||void 0===e?void 0:e.login)||p.full_name.split("/")[0];if(p.isDemo||p.owner&&"demo-user"===p.owner.login)return await new Promise(e=>setTimeout(e,2e3)),void g({sha:"demo-commit-sha",message:f,url:"https://github.com/".concat(p.full_name,"/commit/demo-commit-sha")});const n=await a.A.createCommit(s,p.name,h,f.trim(),l.files);g({sha:n.sha,message:f,url:n.html_url})}catch(s){console.error("Error saving changes:",s),w(A(s))}finally{j(!1)}}else w("Cannot save with validation errors. Enable override option to proceed anyway.");else w("You need write permissions to save changes");else w("Commit message is required")},disabled:!D||!f.trim()||x||!u,children:x?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"saving-spinner",children:"\u23f3"}),"Saving..."]}):(0,d.jsx)(d.Fragment,{children:"\ud83d\udcbe Save Changes"})})]})]})})},p=e=>{let{repository:s,selectedBranch:n,hasWriteAccess:a,profile:o}=e;const[r,l]=(0,i.useState)(null),[p,h]=(0,i.useState)(null),[u,g]=(0,i.useState)(!1),[f,v]=(0,i.useState)(null),[b,y]=(0,i.useState)(!1),x=(0,i.useCallback)(async()=>{g(!0),v(null);try{const e=t.A.getStagingGround();l(e),e.files.length>0&&await j(e)}catch(e){v("Failed to load staging ground data"),console.error("Error loading staging ground:",e)}finally{g(!1)}},[]);(0,i.useEffect)(()=>{if(s&&n){t.A.initialize(s,n),x();return t.A.addListener(e=>{l(e),j(e)})}},[s,n,x]);const j=async e=>{if(e&&0!==e.files.length)try{const s=await c.validateStagingGround(e);h(s)}catch(s){console.error("Error validating staging ground:",s),h(null)}else h(null)},N=p?c.getValidationSummary(p):{error:0,warning:0,info:0,canSave:!0},w=r&&r.files.length>0,k=r?r.files.length:0;return(0,d.jsxs)("div",{className:"staging-ground-section",children:[(0,d.jsxs)("div",{className:"section-header",children:[(0,d.jsxs)("h3",{className:"section-title",children:[(0,d.jsx)("span",{className:"section-icon",children:"\ud83d\udcdd"}),"Staging Ground",w&&(0,d.jsxs)("span",{className:"files-badge",children:[k," file",1!==k?"s":""]})]}),(0,d.jsx)("p",{className:"section-description",children:"Changes made through DAK component editors are staged here before being committed to the repository. Review and commit your changes when ready."})]}),(0,d.jsx)("div",{className:"staging-content",children:u?(0,d.jsxs)("div",{className:"loading-indicator",children:[(0,d.jsx)("span",{className:"loading-spinner",children:"\u23f3"}),"Loading staging ground..."]}):f?(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),f]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"staging-status-bar",children:[(0,d.jsx)("div",{className:"status-indicators",children:(0,d.jsxs)("div",{className:"validation-stoplight",children:[(0,d.jsxs)("div",{className:"stoplight-indicator error ".concat(0===N.error?"lit":""),children:["\ud83d\udd34",N.error>0&&(0,d.jsx)("span",{className:"indicator-badge",children:N.error})]}),(0,d.jsxs)("div",{className:"stoplight-indicator warning ".concat(0===N.warning?"lit":""),children:["\ud83d\udfe1",N.warning>0&&(0,d.jsx)("span",{className:"indicator-badge",children:N.warning})]}),(0,d.jsxs)("div",{className:"stoplight-indicator info ".concat(0===N.info?"lit":""),children:["\ud83d\udfe2",N.info>0&&(0,d.jsx)("span",{className:"indicator-badge",children:N.info})]})]})}),(0,d.jsx)("button",{className:"save-btn ".concat(w&&N.canSave?"":"disabled"),onClick:()=>{a?y(!0):alert("You need write permissions to save changes to this repository.")},disabled:!w||!a,title:w?a?N.canSave?"Save changes to repository":"Fix validation errors first":"Write access required":"No changes to save",children:"\ud83d\udcbe Save Changes"})]}),(0,d.jsxs)("div",{className:"staging-files-section",children:[(0,d.jsx)("h4",{children:"\ud83d\udcc1 Changed Files"}),w?(0,d.jsxs)("div",{className:"changed-files",children:[(r&&r.files?r.files.map(e=>({path:e.path,size:new Blob([e.content]).size,lastModified:e.timestamp})):[]).map((e,s)=>(0,d.jsxs)("div",{className:"file-item",children:[(0,d.jsxs)("div",{className:"file-info",children:[(0,d.jsx)("span",{className:"file-icon",children:"\ud83d\udcc4"}),(0,d.jsx)("span",{className:"file-path",children:e.path})]}),(0,d.jsxs)("div",{className:"file-meta",children:[(0,d.jsxs)("span",{className:"file-size",children:[(e.size/1024).toFixed(1)," KB"]}),(0,d.jsx)("span",{className:"file-time",children:new Date(e.lastModified).toLocaleTimeString()}),(0,d.jsx)("button",{className:"remove-file-btn",onClick:s=>{var n;s.stopPropagation(),n=e.path,window.confirm('Are you sure you want to remove "'.concat(n,'" from staging? This cannot be undone.'))&&t.A.removeFile(n)},title:"Remove ".concat(e.path," from staging"),children:"\ud83d\uddd1\ufe0f"})]})]},s)),(0,d.jsx)("div",{className:"file-actions",children:(0,d.jsx)("button",{className:"action-btn secondary small",onClick:()=>{window.confirm("Are you sure you want to discard all changes? This cannot be undone.")&&t.A.clearStagingGround()},children:"\ud83d\uddd1\ufe0f Clear All Changes"})})]}):(0,d.jsxs)("div",{className:"no-changes",children:[(0,d.jsx)("p",{children:"No changes in staging ground"}),(0,d.jsx)("p",{className:"help-text",children:"Changes made through DAK component editors will appear here before being saved to the repository."})]})]}),w&&r.message&&(0,d.jsxs)("div",{className:"commit-message-section",children:[(0,d.jsx)("h4",{children:"\u270d\ufe0f Commit Message"}),(0,d.jsx)("div",{className:"commit-preview",children:(0,d.jsx)("p",{children:r.message})})]})]})}),(0,d.jsx)(m,{isOpen:b,onClose:()=>y(!1),stagingGround:r,validation:p,repository:s,selectedBranch:n,hasWriteAccess:a,onSaveSuccess:e=>{y(!1),t.A.clearStagingGround(),alert("Changes saved successfully! Commit: ".concat(e.sha.substring(0,7)))}})]})},h=e=>{var s;let{profile:n,repository:a,selectedBranch:t,hasWriteAccess:o}=e;const[r,l]=(0,i.useState)("html"),[c,m]=(0,i.useState)("full"),[p,h]=(0,i.useState)(!1),[u,g]=(0,i.useState)([]),[f,v]=(0,i.useState)(null),b=(null===(s=a.owner)||void 0===s?void 0:s.login)||a.full_name.split("/")[0],y=a.name,x=[{value:"html",label:"HTML Publication",icon:"\ud83c\udf10",description:"Web-ready HTML with WHO styling"},{value:"epub",label:"EPUB E-book",icon:"\ud83d\udcd6",description:"EPUB 3.0 format for e-readers"},{value:"docbook",label:"DocBook XML",icon:"\ud83d\udcc4",description:"Professional publishing format"},{value:"pdf",label:"PDF Document",icon:"\ud83d\udccb",description:"Print to PDF using browser functionality"}],j=[{id:"full",name:"Complete DAK",icon:"\ud83d\udcda",description:"Generate publication for the entire DAK"},{id:"health-interventions",name:"Health Interventions",icon:"\ud83d\udcd6",description:"Clinical guidelines and health intervention specifications"},{id:"generic-personas",name:"Generic Personas",icon:"\ud83d\udc65",description:"Standardized user roles and actor definitions"},{id:"user-scenarios",name:"User Scenarios",icon:"\ud83d\udcdd",description:"Narrative descriptions of system interactions"},{id:"business-processes",name:"Business Processes",icon:"\ud83d\udd04",description:"BPMN workflows and business process definitions"},{id:"core-data-elements",name:"Core Data Elements",icon:"\ud83d\uddc3\ufe0f",description:"Essential data structures and terminology"},{id:"decision-support",name:"Decision Support Logic",icon:"\ud83c\udfaf",description:"DMN decision tables and clinical decision support"},{id:"program-indicators",name:"Program Indicators",icon:"\ud83d\udcca",description:"Performance indicators and measurement definitions"},{id:"functional-requirements",name:"Functional Requirements",icon:"\u2699\ufe0f",description:"System requirements specifications"},{id:"test-scenarios",name:"Test Scenarios",icon:"\ud83e\uddea",description:"Feature files and test scenarios"}],N=async(e,s,n)=>{const i="full"===s?"".concat(y," - WHO SMART Guidelines Implementation Guide"):"".concat(y," - ").concat(n.name),a=(new Date).toLocaleDateString();(new Date).getFullYear();if("html"===e)return w(i,s,n,a);if("epub"===e)return k(i,s,n,a);if("docbook"===e)return S(i,s,n,a);throw new Error("Unsupported format: ".concat(e))},w=(e,s,n,i)=>{const a="full"===s?C():D(n);return'<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>'.concat(e,'</title>\n    <style>\n        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 2rem; color: #333; }\n        .header { background: linear-gradient(135deg, #0078d4 0%, #005a9e 100%); color: white; padding: 2rem; margin: -2rem -2rem 2rem -2rem; }\n        .who-logo { font-size: 2rem; font-weight: bold; margin-bottom: 0.5rem; }\n        h1 { color: #0078d4; border-bottom: 2px solid #0078d4; padding-bottom: 0.5rem; }\n        h2 { color: #005a9e; margin-top: 2rem; }\n        .metadata { background: #f8f9fa; padding: 1rem; border-left: 4px solid #0078d4; margin: 2rem 0; }\n        .component-section { margin: 2rem 0; padding: 1.5rem; border: 1px solid #dee2e6; border-radius: 8px; }\n        @media print { .header { background: #0078d4 !important; -webkit-print-color-adjust: exact; } }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <div class="who-logo">WHO</div>\n        <h1 style="color: white; border: none; margin: 0;">').concat(e,'</h1>\n        <p style="margin: 0.5rem 0 0 0;">WHO SMART Guidelines Implementation Guide</p>\n    </div>\n\n    <div class="metadata">\n        <h2>Publication Information</h2>\n        <p><strong>Repository:</strong> ').concat(b,"/").concat(y,"</p>\n        <p><strong>Branch:</strong> ").concat(t,"</p>\n        <p><strong>Generated:</strong> ").concat(i,"</p>\n        <p><strong>Version:</strong> 1.0.0</p>\n        <p><strong>Copyright:</strong> \xa9 ").concat((new Date).getFullYear()," World Health Organization</p>\n    </div>\n\n    ").concat(a,'\n\n    <footer style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #dee2e6; text-align: center; color: #6c757d;">\n        <p>Generated by SGeX Workbench \u2022 WHO SMART Guidelines Digital Adaptation Kit</p>\n    </footer>\n</body>\n</html>')},k=(e,s,n,i)=>'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml">\n<head>\n    <title>'.concat(e,'</title>\n    <style type="text/css">\n        body { font-family: Georgia, serif; line-height: 1.6; margin: 2em; }\n        h1 { color: #0078d4; border-bottom: 2px solid #0078d4; }\n        h2 { color: #005a9e; margin-top: 2em; }\n        .metadata { background: #f8f9fa; padding: 1em; border-left: 4px solid #0078d4; }\n    </style>\n</head>\n<body>\n    <h1>').concat(e,'</h1>\n    \n    <div class="metadata">\n        <h2>Publication Information</h2>\n        <p><strong>Repository:</strong> ').concat(b,"/").concat(y,"</p>\n        <p><strong>Branch:</strong> ").concat(t,"</p>\n        <p><strong>Generated:</strong> ").concat(i,"</p>\n        <p><strong>Copyright:</strong> \xa9 ").concat((new Date).getFullYear()," World Health Organization</p>\n    </div>\n\n    ").concat("full"===s?C():D(n),"\n</body>\n</html>"),S=(e,s,n,i)=>'<?xml version="1.0" encoding="UTF-8"?>\n<book xmlns="http://docbook.org/ns/docbook" version="5.0">\n    <info>\n        <title>'.concat(e,"</title>\n        <subtitle>WHO SMART Guidelines Implementation Guide</subtitle>\n        <author>\n            <orgname>World Health Organization</orgname>\n        </author>\n        <date>").concat(i,"</date>\n        <copyright>\n            <year>").concat((new Date).getFullYear(),'</year>\n            <holder>World Health Organization</holder>\n        </copyright>\n    </info>\n\n    <chapter xml:id="metadata">\n        <title>Publication Information</title>\n        <para><emphasis>Repository:</emphasis> ').concat(b,"/").concat(y,"</para>\n        <para><emphasis>Branch:</emphasis> ").concat(t,"</para>\n        <para><emphasis>Generated:</emphasis> ").concat(i,'</para>\n        <para><emphasis>Version:</emphasis> 1.0.0</para>\n    </chapter>\n\n    <chapter xml:id="content">\n        <title>').concat("full"===s?"Complete DAK Content":n.name,"</title>\n        ").concat("full"===s?P():A(n),"\n    </chapter>\n</book>"),C=()=>'\n    <div class="component-section">\n        <h2>\ud83d\udd04 Business Processes</h2>\n        <p>This section contains BPMN workflows and business process definitions for the '.concat(y,' DAK.</p>\n        <p><em>Content would be dynamically loaded from the repository\'s business process files.</em></p>\n    </div>\n\n    <div class="component-section">\n        <h2>\ud83c\udfaf Decision Support Logic</h2>\n        <p>DMN decision tables and clinical decision support logic.</p>\n        <p><em>Content would be dynamically loaded from the repository\'s decision support files.</em></p>\n    </div>\n\n    <div class="component-section">\n        <h2>\ud83d\uddc3\ufe0f Core Data Elements</h2>\n        <p>Essential data structures, terminology, and data dictionary.</p>\n        <p><em>Content would be dynamically loaded from the repository\'s data element definitions.</em></p>\n    </div>\n\n    <div class="component-section">\n        <h2>\ud83d\udcd6 Health Interventions</h2>\n        <p>Clinical guidelines and health intervention specifications.</p>\n        <p><em>Content would be dynamically loaded from the repository\'s intervention guidelines.</em></p>\n    </div>\n\n    <div class="component-section">\n        <h2>\ud83d\udcca Program Indicators</h2>\n        <p>Performance indicators and measurement definitions.</p>\n        <p><em>Content would be dynamically loaded from the repository\'s indicator definitions.</em></p>\n    </div>\n\n    <div class="component-section">\n        <h2>\u2699\ufe0f Additional Components</h2>\n        <p>Generic personas, user scenarios, functional requirements, and test scenarios.</p>\n        <p><em>Additional DAK components and documentation.</em></p>\n    </div>'),D=e=>'\n    <div class="component-section">\n        <h2>'.concat(e.icon," ").concat(e.name,"</h2>\n        <p>").concat(e.description,"</p>\n        <p><strong>Component Details:</strong></p>\n        <ul>\n            <li>Repository: ").concat(b,"/").concat(y,"</li>\n            <li>Branch: ").concat(t,"</li>\n            <li>Component Type: ").concat(e.name,"</li>\n            <li>Generated: ").concat((new Date).toLocaleString(),"</li>\n        </ul>\n        <p><em>Detailed content for this component would be dynamically loaded from the repository files specific to ").concat(e.id,".</em></p>\n        \n        <h3>Implementation Notes</h3>\n        <p>This component publication contains targeted content for ").concat(e.name," from the DAK repository. \n        In a full implementation, this would include:</p>\n        <ul>\n            <li>Specific file content from the repository</li>\n            <li>Related documentation and specifications</li>\n            <li>Cross-references to other DAK components</li>\n            <li>Implementation guidance and examples</li>\n        </ul>\n    </div>"),P=()=>'\n        <section xml:id="business-processes">\n            <title>Business Processes</title>\n            <para>BPMN workflows and business process definitions.</para>\n        </section>\n        <section xml:id="decision-support">\n            <title>Decision Support Logic</title>\n            <para>DMN decision tables and clinical decision support.</para>\n        </section>\n        <section xml:id="core-data">\n            <title>Core Data Elements</title>\n            <para>Essential data structures and terminology.</para>\n        </section>',A=e=>'\n        <section xml:id="'.concat(e.id,'">\n            <title>').concat(e.name,"</title>\n            <para>").concat(e.description,"</para>\n            <para>Component-specific content and implementation details.</para>\n        </section>"),M=e=>{switch(e){case"html":return"text/html";case"epub":return"application/epub+zip";case"docbook":return"application/xml";default:return"text/plain"}},F=e=>{switch(e){case"html":return"html";case"epub":return"xhtml";case"docbook":return"xml";default:return"txt"}},G=e=>{if(0===e)return"0 Bytes";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},I=e=>{const s=x.find(s=>s.value===e);return s?s.icon:"\ud83d\udcc4"},O=()=>{const e=j.find(e=>e.id===c);return e?e.name:"Unknown"};return(0,d.jsxs)("div",{className:"dak-publication-generator",children:[(0,d.jsxs)("div",{className:"section-header",children:[(0,d.jsx)("h3",{className:"section-title",children:"\ud83d\udcda DAK Publication Generator"}),(0,d.jsx)("p",{className:"section-description",children:"Generate professional WHO SMART Guidelines publications in multiple formats from your DAK repository content."})]}),(0,d.jsxs)("div",{className:"publication-generator-content",children:[(0,d.jsxs)("div",{className:"publication-scope-selection",children:[(0,d.jsx)("label",{className:"scope-label",children:"Publication Scope:"}),(0,d.jsx)("div",{className:"scope-options",children:j.map(e=>(0,d.jsxs)("div",{className:"scope-option ".concat(c===e.id?"selected":""),onClick:()=>m(e.id),children:[(0,d.jsx)("div",{className:"scope-icon",children:e.icon}),(0,d.jsxs)("div",{className:"scope-info",children:[(0,d.jsx)("div",{className:"scope-name",children:e.name}),(0,d.jsx)("div",{className:"scope-description",children:e.description})]}),c===e.id&&(0,d.jsx)("div",{className:"scope-selected",children:"\u2713"})]},e.id))})]}),(0,d.jsxs)("div",{className:"format-selection",children:[(0,d.jsx)("label",{className:"format-label",children:"Select Publication Format:"}),(0,d.jsx)("div",{className:"format-options",children:x.map(e=>(0,d.jsxs)("div",{className:"format-option ".concat(r===e.value?"selected":""),onClick:()=>l(e.value),children:[(0,d.jsx)("div",{className:"format-icon",children:e.icon}),(0,d.jsxs)("div",{className:"format-info",children:[(0,d.jsx)("div",{className:"format-name",children:e.label}),(0,d.jsx)("div",{className:"format-description",children:e.description})]}),r===e.value&&(0,d.jsx)("div",{className:"format-selected",children:"\u2713"})]},e.value))})]}),(0,d.jsxs)("div",{className:"generation-controls",children:[(0,d.jsx)("button",{className:"generate-btn",onClick:async()=>{if("pdf"!==r)try{h(!0),v(null);const e=j.find(e=>e.id===c),s=e?e.name:"Full DAK",n="full"===c?y:"".concat(y,"-").concat(c),i=await N(r,c,e),a=new Blob([i],{type:M(r)}),o=URL.createObjectURL(a),l={id:"pub-".concat(Date.now()),format:r,scope:c,scopeName:s,filename:"".concat(n,"-").concat(t,"-publication.").concat(F(r)),downloadUrl:o,generatedAt:(new Date).toISOString(),size:G(a.size)};g(e=>[l,...e]),h(!1)}catch(e){console.error("Publication generation error:",e),v(e.message||"Failed to generate publication"),h(!1)}else window.print()},disabled:p,children:p?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"spinner",children:"\u23f3"}),"Generating ",r.toUpperCase(),"..."]}):"pdf"===r?(0,d.jsxs)(d.Fragment,{children:["\ud83d\udda8\ufe0f Print ",O()," to PDF"]}):(0,d.jsxs)(d.Fragment,{children:["\ud83d\ude80 Generate ",O()," ",r.toUpperCase()," Publication"]})}),!o&&!(null!==n&&void 0!==n&&n.isDemo)&&(0,d.jsx)("p",{className:"permission-notice",children:"\u2139\ufe0f Demo mode: Publications will be generated locally for preview"})]}),f&&(0,d.jsxs)("div",{className:"error-message",children:[(0,d.jsx)("span",{className:"error-icon",children:"\u274c"}),(0,d.jsx)("span",{children:f})]}),u.length>0&&(0,d.jsxs)("div",{className:"generated-publications",children:[(0,d.jsx)("h4",{children:"\ud83d\udce5 Generated Publications"}),(0,d.jsx)("div",{className:"publications-list",children:u.map(e=>(0,d.jsxs)("div",{className:"publication-item",children:[(0,d.jsx)("div",{className:"publication-icon",children:I(e.format)}),(0,d.jsxs)("div",{className:"publication-details",children:[(0,d.jsx)("div",{className:"publication-name",children:e.filename}),(0,d.jsxs)("div",{className:"publication-scope",children:[e.scopeName||"Complete DAK"," \u2022 ",e.format.toUpperCase()]}),(0,d.jsxs)("div",{className:"publication-meta",children:["Generated: ",new Date(e.generatedAt).toLocaleString()," \u2022 Size: ",e.size]})]}),(0,d.jsx)("div",{className:"publication-actions",children:(0,d.jsx)("a",{href:e.downloadUrl,className:"download-btn",download:e.filename,target:"_blank",rel:"noopener noreferrer",children:"\ud83d\udcbe Download"})})]},e.id))})]}),(0,d.jsxs)("div",{className:"service-status",children:[(0,d.jsxs)("div",{className:"service-indicator",children:[(0,d.jsx)("span",{className:"status-dot ready"}),(0,d.jsx)("span",{className:"status-text",children:"Client-Side Generation: Ready"})]}),(0,d.jsx)("p",{className:"service-note",children:"Publications are generated directly in your browser using WHO SMART Guidelines templates."})]})]})]})},u=e=>{var s;let{profile:n,repository:t,selectedBranch:o,hasWriteAccess:r}=e;const[l,c]=(0,i.useState)([]),[m,u]=(0,i.useState)([]),[g,f]=(0,i.useState)({}),[v,b]=(0,i.useState)(!0),[y,x]=(0,i.useState)(null),j=(null===(s=t.owner)||void 0===s?void 0:s.login)||t.full_name.split("/")[0],N=t.name;(0,i.useEffect)(()=>{(async()=>{try{if(b(!0),x(null),null!==n&&void 0!==n&&n.isDemo){c([{name:"main",commit:{sha:"abc123"}},{name:"feature/updates",commit:{sha:"def456"}},{name:"dev",commit:{sha:"ghi789"}}]);u([{id:"pages-build",name:"Deploy to GitHub Pages",triggers:["push","manual"]}]);const e={main:{status:"completed",conclusion:"success",html_url:"https://github.com/".concat(j,"/").concat(N,"/actions/runs/123456"),updated_at:(new Date).toISOString()},"feature/updates":{status:"completed",conclusion:"action_required",html_url:"https://github.com/".concat(j,"/").concat(N,"/actions/runs/123457"),updated_at:(new Date).toISOString()},dev:{status:"completed",conclusion:"failure",html_url:"https://github.com/".concat(j,"/").concat(N,"/actions/runs/123458"),updated_at:(new Date).toISOString()}};return f(e),void b(!1)}const s=(await a.A.getBranches(j,N)).filter(e=>"gh-pages"!==e.name);c(s);const i=await a.A.getWorkflows(j,N);u(i);const t=i.find(e=>e.name.toLowerCase().includes("build")||e.name.toLowerCase().includes("publish")||e.name.toLowerCase().includes("pages"));if(t&&t.id){const n={};for(const i of s)try{const e=await a.A.getWorkflowRunsForWorkflow(j,N,t.id,{branch:i.name,per_page:1});e.length>0&&(n[i.name]=e[0])}catch(e){console.warn("Could not fetch workflow runs for branch ".concat(i.name,":"),e)}f(n)}else t&&!t.id&&console.warn("Found workflow but missing ID:",t);b(!1)}catch(e){console.error("Error fetching publication data:",e),x("Failed to load publication data"),b(!1)}})()},[j,N,null===n||void 0===n?void 0:n.isDemo]);return v?(0,d.jsx)("div",{className:"publications-loading",children:(0,d.jsxs)("div",{className:"loading-content",children:[(0,d.jsx)("h3",{children:"Loading Publications..."}),(0,d.jsx)("p",{children:"Fetching branch and workflow information..."})]})}):(0,d.jsxs)("div",{className:"publications-section",children:[(0,d.jsx)(p,{repository:t,selectedBranch:o,hasWriteAccess:r,profile:n}),(0,d.jsx)(h,{repository:t,selectedBranch:o,hasWriteAccess:r,profile:n}),(0,d.jsxs)("div",{className:"section-header",children:[(0,d.jsx)("h3",{className:"section-title",children:"Published DAK Content"}),(0,d.jsx)("p",{className:"section-description",children:"Access published Implementation Guide content for this DAK repository. Each branch is published automatically via GitHub Actions to GitHub Pages."})]}),y?(0,d.jsx)("div",{className:"publications-error",children:(0,d.jsxs)("div",{className:"error-content",children:[(0,d.jsx)("h3",{children:"Error Loading GitHub Pages Data"}),(0,d.jsx)("p",{children:y})]})}):(0,d.jsx)("div",{className:"publications-grid",children:l.map(e=>{const s=e.name===t.default_branch||"main"===e.name,i=(o=e.name)===t.default_branch||"main"===o?"https://".concat(j,".github.io/").concat(N,"/"):"https://".concat(j,".github.io/").concat(N,"/branches/").concat(o,"/");var o;const l=(e=>{const s=g[e];if(!s)return{icon:"\u26aa",title:"No recent workflow runs",link:null};const n=s.status,i=s.conclusion;return"in_progress"===n||"queued"===n?{icon:"\ud83d\udd04",title:"Workflow running",link:s.html_url,className:"running"}:"success"===i?{icon:"\u2705",title:"Last build successful",link:s.html_url,className:"success"}:"failure"===i?{icon:"\u274c",title:"Last build failed",link:s.html_url,className:"failure"}:"action_required"===i?{icon:"\u23f3",title:"Workflow requires approval",link:s.html_url,className:"approval-required"}:{icon:"\u26a0\ufe0f",title:"Build ".concat(i||n),link:s.html_url,className:"warning"}})(e.name);return(0,d.jsxs)("div",{className:"publication-card ".concat(s?"main-branch":""),children:[(0,d.jsxs)("div",{className:"publication-header",children:[(0,d.jsxs)("div",{className:"branch-info",children:[(0,d.jsx)("span",{className:"branch-icon",children:"\ud83c\udf3f"}),(0,d.jsx)("span",{className:"branch-name",children:e.name}),s&&(0,d.jsx)("span",{className:"main-badge",children:"MAIN"})]}),(0,d.jsx)("div",{className:"workflow-status",children:l.link?(0,d.jsx)("a",{href:l.link,target:"_blank",rel:"noopener noreferrer",className:"status-icon ".concat(l.className||""),title:l.title,children:l.icon}):(0,d.jsx)("span",{className:"status-icon ".concat(l.className||""),title:l.title,children:l.icon})})]}),(0,d.jsxs)("div",{className:"publication-content",children:[(0,d.jsxs)("div",{className:"publication-url",children:[(0,d.jsx)("label",{children:"Published at:"}),(0,d.jsxs)("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"publication-link",children:[i,(0,d.jsx)("span",{className:"external-link",children:"\u2197"})]})]}),(0,d.jsxs)("div",{className:"publication-actions",children:[(0,d.jsx)("button",{className:"restart-workflow-btn",onClick:()=>(async e=>{if(null!==n&&void 0!==n&&n.isDemo)return void alert("Demo Mode: Workflow restart simulated for branch: ".concat(e));const s=m.find(e=>e.name.toLowerCase().includes("build")||e.name.toLowerCase().includes("publish")||e.name.toLowerCase().includes("pages"));if(s){if(!s.id)return alert("Workflow found but missing ID - cannot restart"),void console.warn("Workflow missing ID:",s);try{await a.A.triggerWorkflow(j,N,s.id,e),alert("Workflow restarted for branch: ".concat(e)),setTimeout(()=>{window.location.reload()},2e3)}catch(i){console.error("Error restarting workflow:",i),alert("Failed to restart workflow. Please check your permissions.")}}else alert("No suitable workflow found to restart")})(e.name),disabled:!r,title:r?"Restart build workflow for this branch":"Write permissions required",children:"\ud83d\udd04 Rebuild"}),(0,d.jsx)("a",{href:"https://github.com/".concat(j,"/").concat(N,"/tree/").concat(e.name),target:"_blank",rel:"noopener noreferrer",className:"view-source-btn",title:"View source code for this branch",children:"\ud83d\udc41\ufe0f View Source"})]})]})]},e.name)})}),!y&&0===l.length&&(0,d.jsx)("div",{className:"no-branches",children:(0,d.jsx)("p",{children:"No publishable branches found (excluding gh-pages)."})})]})}},44131:e=>{e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://sgex.org/schemas/sushi-config.json","title":"SUSHI Configuration Schema","description":"JSON Schema for validating sushi-config.yaml files used in FHIR Implementation Guides","type":"object","required":["id","canonical","name","status","publisher","version"],"properties":{"id":{"type":"string","pattern":"^[a-z0-9]+(\\\\.[a-z0-9]+)*$","description":"The unique identifier for the Implementation Guide (IG). Must be lowercase alphanumeric with dots."},"canonical":{"type":"string","format":"uri","description":"The canonical URL for the Implementation Guide"},"name":{"type":"string","minLength":1,"description":"The human-readable name of the Implementation Guide"},"title":{"type":"string","description":"The title of the Implementation Guide (optional, defaults to name)"},"description":{"type":"string","description":"A description of the Implementation Guide"},"status":{"type":"string","enum":["draft","active","retired","unknown"],"description":"The publication status of the Implementation Guide"},"version":{"type":"string","pattern":"^\\\\d+\\\\.\\\\d+\\\\.\\\\d+(-[a-zA-Z0-9]+)?$","description":"The version of the Implementation Guide (semantic versioning)"},"fhirVersion":{"type":"string","enum":["4.0.1","4.3.0","5.0.0"],"default":"4.0.1","description":"The version of FHIR to use"},"copyrightYear":{"type":"integer","minimum":1900,"maximum":3000,"description":"The copyright year"},"releaseLabel":{"type":"string","description":"Label for the release"},"publisher":{"type":"string","minLength":1,"description":"The publisher of the Implementation Guide"},"contact":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string"},"telecom":{"type":"array","items":{"type":"object","properties":{"system":{"type":"string","enum":["phone","fax","email","pager","url","sms","other"]},"value":{"type":"string"},"use":{"type":"string","enum":["home","work","temp","old","mobile"]}}}}}},"description":"Contact information for the Implementation Guide"},"license":{"type":"string","enum":["not-open-source","0BSD","AAL","Abstyles","Adobe-2006","Adobe-Glyph","ADSL","AFL-1.1","CC0-1.0"],"description":"The license under which the Implementation Guide is published"},"jurisdiction":{"type":"array","items":{"type":"object","properties":{"coding":{"type":"array","items":{"type":"object","properties":{"system":{"type":"string","format":"uri"},"code":{"type":"string"},"display":{"type":"string"}}}}}},"description":"Jurisdiction for the Implementation Guide"},"dependencies":{"type":"object","properties":{"smart.who.int.base":{"oneOf":[{"type":"string"},{"type":"object","properties":{"id":{"type":"string"},"version":{"type":"string"}}}],"description":"WHO SMART Guidelines base dependency (required for WHO DAK compliance)"}},"additionalProperties":{"oneOf":[{"type":"string"},{"type":"object","properties":{"id":{"type":"string"},"version":{"type":"string"},"uri":{"type":"string","format":"uri"},"reason":{"type":"string"}}}]},"description":"Dependencies on other Implementation Guides"},"global":{"type":"object","additionalProperties":{"type":"string"},"description":"Global profiles applied across the IG"},"groups":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"},"resources":{"type":"array","items":{"type":"string"}}}},"description":"Resource groupings for the IG"},"resources":{"type":"object","additionalProperties":{"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"},"exampleBoolean":{"type":"boolean"},"exampleCanonical":{"type":"string","format":"uri"}}},"description":"Resource definitions and metadata"},"pages":{"type":"object","additionalProperties":{"oneOf":[{"type":"string"},{"type":"object","properties":{"nameUrl":{"type":"string"},"title":{"type":"string"},"generation":{"type":"string","enum":["html","markdown","xml","generated"]}}}]},"description":"Page definitions for the IG"},"parameters":{"type":"object","additionalProperties":{"oneOf":[{"type":"string"},{"type":"boolean"},{"type":"number"}]},"description":"Parameters for IG generation"},"copyrightLabel":{"type":"string","description":"Copyright label for the IG"},"packageId":{"type":"string","description":"Package identifier (defaults to id)"},"menu":{"type":"object","additionalProperties":true,"description":"Menu structure for the IG"},"history":{"type":"object","properties":{"package-id":{"type":"string"},"canonical":{"type":"string","format":"uri"},"title":{"type":"string"},"introduction":{"type":"string"}},"description":"History configuration for the IG"},"indexPageContent":{"type":"string","description":"Content for the index page"},"FSHOnly":{"type":"boolean","description":"Flag to indicate if this is a FSH-only project"},"applyExtensionMetadataToRoot":{"type":"boolean","description":"Whether to apply extension metadata to root"},"instanceOptions":{"type":"object","properties":{"setMetaProfile":{"type":"string","enum":["always","never","inline-only","standalone-only"]},"setId":{"type":"string","enum":["always","standalone-only"]},"manualSliceOrdering":{"type":"boolean"}},"description":"Options for instance processing"}},"allOf":[{"if":{"properties":{"dependencies":{"type":"object","not":{"properties":{"smart.who.int.base":true},"required":["smart.who.int.base"]}}}},"then":{"properties":{"_whoSmartGuidelinesNote":{"const":"This IG is not WHO SMART Guidelines compliant. Add smart.who.int.base dependency for DAK compliance."}}}}]}')},58377:(e,s,n)=>{n.d(s,{A:()=>l});var i=n(9950),a=n(85001),t=n(29946),o=n(1932),r=n(44414);const l=e=>{let{profile:s,repository:n,selectedBranch:l}=e;const c=(0,a.Zp)(),[d,m]=(0,i.useState)(!1),[p,h]=(0,i.useState)([]),[u,g]=(0,i.useState)(!0),[f,v]=(0,i.useState)(null),[b,y]=(0,i.useState)(null),x=i.useCallback(()=>n?"sgex_fork_status_".concat(n.full_name):null,[n]);(0,i.useEffect)(()=>{const e=x();if(e){const s=sessionStorage.getItem(e);null!==s&&m(JSON.parse(s))}},[x]);(0,i.useEffect)(()=>{(async()=>{if(n){g(!0),v(null);try{let s=n;if(!n.parent&&(!0===n.fork||void 0===n.fork))try{s=await t.A.getRepository(n.owner.login,n.name)}catch(e){console.warn("Could not fetch full repository details:",e)}s.fork&&s.parent&&y(s.parent);const i=await t.A.getRepositoryForks(n.owner.login,n.name);h(i)}catch(s){console.error("Error fetching repository information:",s),v(s.message)}finally{g(!1)}}})()},[n]);const j=e=>{const s=e.owner.login,n=e.name,i=e.default_branch||"main";return"/dashboard/".concat(s,"/").concat(n,"/").concat(i)},N=e=>{if(!b)return;const s=j(b),n={profile:{login:b.owner.login,name:b.owner.login,avatar_url:b.owner.avatar_url,type:b.owner.type},repository:b,selectedBranch:b.default_branch||"main"};(0,o.hX)(e,s,c,n)};return!n||u?(0,r.jsx)("div",{className:"fork-status-bar loading",children:(0,r.jsxs)("div",{className:"fork-status-header",children:[(0,r.jsxs)("div",{className:"fork-badge-placeholder",children:[(0,r.jsx)("span",{className:"fork-icon",children:"\ud83c\udf74"}),(0,r.jsx)("span",{className:"fork-count",children:"..."})]}),(0,r.jsx)("span",{className:"fork-status-title",children:"Loading repository info..."})]})}):f?(0,r.jsx)("div",{className:"fork-status-bar error",children:(0,r.jsxs)("div",{className:"fork-status-header",children:[(0,r.jsxs)("div",{className:"fork-badge",children:[(0,r.jsx)("span",{className:"fork-icon",children:"\ud83c\udf74"}),(0,r.jsx)("span",{className:"fork-count",children:"?"})]}),(0,r.jsx)("span",{className:"fork-status-title",children:"Unable to load repository info"})]})}):(0,r.jsxs)("div",{className:"fork-status-bar ".concat(d?"expanded":"collapsed"),children:[(0,r.jsxs)("div",{className:"fork-status-header",onClick:()=>{const e=!d;m(e);const s=x();s&&sessionStorage.setItem(s,JSON.stringify(e))},children:[(0,r.jsxs)("div",{className:"fork-badge",children:[(0,r.jsx)("span",{className:"fork-icon",children:"\ud83c\udf74"}),(0,r.jsx)("span",{className:"fork-count",children:p.length})]}),(0,r.jsx)("span",{className:"fork-status-title",children:b?(0,r.jsxs)(r.Fragment,{children:["Fork of"," ",(0,r.jsxs)("span",{className:"parent-repo-link",onClick:e=>{e.stopPropagation(),N(e)},children:[b.owner.login,"/",b.name]}),p.length>0&&(0,r.jsxs)(r.Fragment,{children:[" \u2022 ",p.length," fork",1!==p.length?"s":""]})]}):(0,r.jsxs)(r.Fragment,{children:[p.length," fork",1!==p.length?"s":""," of ",(null===n||void 0===n?void 0:n.name)||"repository"]})}),(0,r.jsx)("button",{className:"fork-toggle-btn","aria-label":d?"Collapse":"Expand",children:(0,r.jsx)("span",{className:"toggle-icon ".concat(d?"expanded":""),children:"\u25bc"})})]}),d&&(0,r.jsxs)("div",{className:"fork-list",children:[b&&(0,r.jsxs)("div",{className:"parent-section",children:[(0,r.jsx)("h4",{className:"section-title",children:"Parent Repository"}),(0,r.jsxs)("div",{className:"fork-item parent-item",onClick:e=>N(e),children:[(0,r.jsx)("div",{className:"fork-avatar",children:(0,r.jsx)("img",{src:b.owner.avatar_url,alt:b.owner.login,className:"fork-owner-avatar"})}),(0,r.jsxs)("div",{className:"fork-info",children:[(0,r.jsxs)("div",{className:"fork-name",children:[(0,r.jsxs)("strong",{children:[b.owner.login,"/",b.name]}),(0,r.jsx)("span",{className:"parent-badge",children:"Parent"})]}),(0,r.jsx)("div",{className:"fork-description",children:b.description||"No description available"}),(0,r.jsxs)("div",{className:"fork-stats",children:[(0,r.jsxs)("span",{className:"fork-stat",children:["\u2b50 ",b.stargazers_count]}),(0,r.jsxs)("span",{className:"fork-stat",children:["\ud83d\udcdd ",b.open_issues_count," issues"]}),(0,r.jsxs)("span",{className:"fork-stat",children:["\ud83d\udcc5 Updated ",new Date(b.updated_at).toLocaleDateString()]})]})]}),(0,r.jsx)("div",{className:"fork-actions",children:(0,r.jsx)("span",{className:"fork-link-hint",children:"Click to view DAK \u2192"})})]})]}),0===p.length?!b&&(0,r.jsx)("div",{className:"no-forks",children:(0,r.jsx)("p",{children:"No forks found for this repository."})}):(0,r.jsxs)("div",{className:"forks-section",children:[b&&(0,r.jsxs)("h4",{className:"section-title",children:["Forks (",p.length,")"]}),(0,r.jsx)("div",{className:"fork-items",children:p.map(e=>(0,r.jsxs)("div",{className:"fork-item",onClick:s=>((e,s)=>{const n=j(s),i={profile:{login:s.owner.login,name:s.owner.login,avatar_url:s.owner.avatar_url,type:s.owner.type},repository:s,selectedBranch:s.default_branch||"main"};(0,o.hX)(e,n,c,i)})(s,e),children:[(0,r.jsx)("div",{className:"fork-avatar",children:(0,r.jsx)("img",{src:e.owner.avatar_url,alt:e.owner.login,className:"fork-owner-avatar"})}),(0,r.jsxs)("div",{className:"fork-info",children:[(0,r.jsx)("div",{className:"fork-name",children:(0,r.jsxs)("strong",{children:[e.owner.login,"/",e.name]})}),(0,r.jsx)("div",{className:"fork-description",children:e.description||"No description available"}),(0,r.jsxs)("div",{className:"fork-stats",children:[(0,r.jsxs)("span",{className:"fork-stat",children:["\u2b50 ",e.stargazers_count]}),(0,r.jsxs)("span",{className:"fork-stat",children:["\ud83d\udcdd ",e.open_issues_count," issues"]}),(0,r.jsxs)("span",{className:"fork-stat",children:["\ud83d\udcc5 Updated ",new Date(e.updated_at).toLocaleDateString()]})]})]}),(0,r.jsx)("div",{className:"fork-actions",children:(0,r.jsx)("span",{className:"fork-link-hint",children:"Click to view DAK \u2192"})})]},e.id))})]})]})]})}}}]);