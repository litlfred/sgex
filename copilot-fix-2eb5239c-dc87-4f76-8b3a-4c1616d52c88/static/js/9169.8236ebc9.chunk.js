"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[9169],{69169:(e,t,i)=>{i.r(t),i.d(t,{default:()=>m});var n=i(89379),a=i(9950),r=i(53782),s=i(29166),l=i(46901),c=i(3611),o=i(44414);const d=()=>{var e,t,i;const{repository:d,branch:m,isLoading:p}=(0,r.oc)(),[f,x]=(0,a.useState)([]),[v,j]=(0,a.useState)(null),[g,q]=(0,a.useState)(!0),[y,b]=(0,a.useState)(null),[N,w]=(0,a.useState)(!1),[F,C]=(0,a.useState)("functional"),[S,A]=(0,a.useState)(!1),[R,k]=(0,a.useState)(!1),[D,H]=(0,a.useState)(""),[E,L]=(0,a.useState)({id:"",title:"",description:"",activity:"",actor:"",capability:"",benefit:"",classification:""}),[_,I]=(0,a.useState)({id:"",title:"",description:"",requirement:"",category:"",classification:""}),P=(null===d||void 0===d||null===(e=d.owner)||void 0===e?void 0:e.login)||(null===d||void 0===d||null===(t=d.full_name)||void 0===t?void 0:t.split("/")[0]),U=(null===d||void 0===d?void 0:d.name)||(null===d||void 0===d||null===(i=d.full_name)||void 0===i?void 0:i.split("/")[1]);(0,a.useEffect)(()=>{(async()=>{if(P&&U&&m)try{q(!0),b(null);let t=[];try{t=(await l.A.getDirectoryContents(P,U,"input/fsh/requirements",m)).filter(e=>e.name.endsWith(".fsh")&&"file"===e.type).map(e=>({name:e.name,path:e.path,download_url:e.download_url,html_url:e.html_url,sha:e.sha}))}catch(e){if(404!==e.status)throw e}x(t)}catch(e){console.error("Error fetching requirements:",e),b("Failed to load requirements files")}finally{q(!1)}else q(!1)})()},[P,U,m]);const T=async e=>{j(e),w(!0),A(!1);try{const a=await fetch(e.download_url),r=await a.text();try{var t,i;const n=await(0,c.extractFSHMetadata)(r),a=(null===(t=n.name)||void 0===t?void 0:t.toLowerCase().includes("nonfunctional"))||(null===(i=n.name)||void 0===i?void 0:i.toLowerCase().includes("non-functional"))||e.name.toLowerCase().includes("nonfunctional")||e.name.toLowerCase().includes("non-functional");C(a?"nonfunctional":"functional"),a?I({id:h(r,"id")||"",title:n.title||"",description:n.description||"",requirement:h(r,"requirement")||"",category:h(r,"category")||"",classification:h(r,"classification")||""}):L({id:h(r,"id")||"",title:n.title||"",description:n.description||"",activity:h(r,"activity")||"",actor:h(r,"actor")||"",capability:h(r,"capability")||"",benefit:h(r,"benefit")||"",classification:h(r,"classification")||""})}catch(n){console.warn("Could not parse FSH metadata:",n),b("Failed to parse requirement content")}}catch(a){console.error("Error loading requirement:",a),b("Failed to load requirement content")}},M=e=>{C(e),A(!0),w(!0),j(null),"functional"===e?L({id:"",title:"",description:"",activity:"",actor:"",capability:"",benefit:"",classification:""}):I({id:"",title:"",description:"",requirement:"",category:"",classification:""})},W=()=>{if("functional"===F){const e=E,t=u(e.id||"NewFunctionalRequirement",e.title||"New Functional Requirement",e.description||"Description of the functional requirement","FunctionalRequirement"),i=[];return e.id&&i.push('* id = "'.concat(e.id,'"')),e.activity&&i.push('* activity = "'.concat((0,c.escapeFSHString)(e.activity),'"')),e.actor&&i.push("* actor = Reference(".concat(e.actor,")")),e.capability&&i.push('* capability = "'.concat((0,c.escapeFSHString)(e.capability),'"')),e.benefit&&i.push('* benefit = "'.concat((0,c.escapeFSHString)(e.benefit),'"')),e.classification&&i.push("* classification = #".concat(e.classification)),"".concat(t,"\n\n").concat(i.join("\n"),"\n")}{const e=_,t=u(e.id||"NewNonFunctionalRequirement",e.title||"New Non-Functional Requirement",e.description||"Description of the non-functional requirement","NonFunctionalRequirement"),i=[];return e.id&&i.push('* id = "'.concat(e.id,'"')),e.requirement&&i.push('* requirement = "'.concat((0,c.escapeFSHString)(e.requirement),'"')),e.category&&i.push("* category = #".concat(e.category)),e.classification&&i.push("* classification = #".concat(e.classification)),"".concat(t,"\n\n").concat(i.join("\n"),"\n")}};return p||g?(0,o.jsxs)("div",{className:"requirements-editor-loading",children:[(0,o.jsx)("div",{className:"loading-spinner"}),(0,o.jsx)("p",{children:"Loading requirements..."})]}):(0,o.jsxs)("div",{className:"requirements-editor",children:[(0,o.jsx)(s.A,{pageId:"functional-requirements"}),y&&(0,o.jsxs)("div",{className:"error-message",children:[(0,o.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),y]}),(0,o.jsxs)("div",{className:"requirements-layout",children:[(0,o.jsxs)("div",{className:"requirements-sidebar",children:[(0,o.jsxs)("div",{className:"sidebar-header",children:[(0,o.jsxs)("h3",{children:["Requirements (",f.length,")"]}),(0,o.jsxs)("div",{className:"create-buttons",children:[(0,o.jsx)("button",{className:"btn-create-functional",onClick:()=>M("functional"),title:"Create Functional Requirement",children:"+ Functional"}),(0,o.jsx)("button",{className:"btn-create-nonfunctional",onClick:()=>M("nonfunctional"),title:"Create Non-Functional Requirement",children:"+ Non-Functional"})]})]}),(0,o.jsx)("div",{className:"requirements-list",children:0===f.length?(0,o.jsxs)("div",{className:"no-requirements",children:[(0,o.jsx)("p",{children:"No requirements found."}),(0,o.jsx)("p",{children:"Create a new functional or non-functional requirement to get started."})]}):f.map(e=>(0,o.jsxs)("div",{className:"requirement-item ".concat((null===v||void 0===v?void 0:v.path)===e.path?"selected":""),onClick:()=>T(e),onKeyPress:t=>{"Enter"!==t.key&&" "!==t.key||T(e)},role:"button",tabIndex:0,"aria-label":"Select requirement ".concat(e.name),children:[(0,o.jsx)("div",{className:"requirement-icon",children:e.name.toLowerCase().includes("nonfunctional")||e.name.toLowerCase().includes("non-functional")?"\ud83d\udccb":"\u2699\ufe0f"}),(0,o.jsx)("div",{className:"requirement-name",children:e.name})]},e.path))})]}),(0,o.jsx)("div",{className:"requirements-editor-panel",children:N?(0,o.jsxs)("div",{className:"requirement-editor",children:[(0,o.jsxs)("div",{className:"editor-header",children:[(0,o.jsxs)("h3",{children:[S?"New ":"Edit ","functional"===F?"Functional":"Non-Functional"," Requirement"]}),(0,o.jsxs)("div",{className:"editor-actions",children:[(0,o.jsx)("button",{className:"btn-preview",onClick:()=>{const e=W();H(e),k(!0)},children:"\ud83d\udc41\ufe0f Preview FSH"}),!S&&(0,o.jsx)("button",{className:"btn-delete",onClick:async()=>{if(!v)return;if(window.confirm("Are you sure you want to delete ".concat(v.name,"?")))try{await l.A.deleteFile(P,U,v.path,"Delete requirement: ".concat(v.name),m,v.sha),x(f.filter(e=>e.name!==v.name)),w(!1),j(null)}catch(e){console.error("Error deleting requirement:",e),b("Failed to delete requirement")}},children:"\ud83d\uddd1\ufe0f Delete"}),(0,o.jsx)("button",{className:"btn-cancel",onClick:()=>{w(!1),A(!1),j(null),C("functional"),b(null)},children:"Cancel"}),(0,o.jsx)("button",{className:"btn-save",onClick:async()=>{const e="functional"===F?E:_;if(e.id)try{const t=W(),i=S?"".concat("functional"===F?"Functional":"NonFunctional","Requirement-").concat(e.id,".fsh"):v.name,n="input/fsh/requirements/".concat(i),a=S?"Add ".concat(F," requirement: ").concat(e.id):"Update ".concat(F," requirement: ").concat(e.id);await l.A.createOrUpdateFile(P,U,n,t,a,m,S?null:v.sha);const r=[...f];S&&r.push({name:i,path:n,download_url:"https://raw.githubusercontent.com/".concat(P,"/").concat(U,"/").concat(m,"/").concat(n),html_url:"https://github.com/".concat(P,"/").concat(U,"/blob/").concat(m,"/").concat(n)}),x(r),w(!1),A(!1),j(null),b(null)}catch(t){console.error("Error saving requirement:",t),b("Failed to save requirement")}else b("Please provide a requirement ID")},children:"\ud83d\udcbe Save"})]})]}),(0,o.jsx)("div",{className:"editor-content",children:"functional"===F?(0,o.jsxs)("div",{className:"form-fields",children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"req-id",children:"Requirement ID *"}),(0,o.jsx)("input",{type:"text",id:"req-id",value:E.id,onChange:e=>L((0,n.A)((0,n.A)({},E),{},{id:e.target.value})),placeholder:"e.g., FR-001",required:!0}),(0,o.jsx)("span",{className:"help-text",children:"Unique identifier for this requirement"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"req-title",children:"Title *"}),(0,o.jsx)("input",{type:"text",id:"req-title",value:E.title,onChange:e=>L((0,n.A)((0,n.A)({},E),{},{title:e.target.value})),placeholder:"e.g., Patient Registration",required:!0}),(0,o.jsx)("span",{className:"help-text",children:"Short descriptive title"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"req-description",children:"Description"}),(0,o.jsx)("textarea",{id:"req-description",value:E.description,onChange:e=>L((0,n.A)((0,n.A)({},E),{},{description:e.target.value})),placeholder:"Detailed description of the functional requirement",rows:"3"}),(0,o.jsx)("span",{className:"help-text",children:"Detailed explanation of the requirement"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"req-activity",children:"Activity *"}),(0,o.jsx)("textarea",{id:"req-activity",value:E.activity,onChange:e=>L((0,n.A)((0,n.A)({},E),{},{activity:e.target.value})),placeholder:"Description of the activity being performed",rows:"2",required:!0}),(0,o.jsx)("span",{className:"help-text",children:"What activity is being performed"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"req-actor",children:"Actor"}),(0,o.jsx)("input",{type:"text",id:"req-actor",value:E.actor,onChange:e=>L((0,n.A)((0,n.A)({},E),{},{actor:e.target.value})),placeholder:"e.g., HealthWorker"}),(0,o.jsx)("span",{className:"help-text",children:"Actor reference (who performs this)"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"req-capability",children:'Capability ("I want to...")'}),(0,o.jsx)("textarea",{id:"req-capability",value:E.capability,onChange:e=>L((0,n.A)((0,n.A)({},E),{},{capability:e.target.value})),placeholder:"I want to...",rows:"2"}),(0,o.jsx)("span",{className:"help-text",children:"User story capability statement"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"req-benefit",children:'Benefit ("So that...")'}),(0,o.jsx)("textarea",{id:"req-benefit",value:E.benefit,onChange:e=>L((0,n.A)((0,n.A)({},E),{},{benefit:e.target.value})),placeholder:"So that...",rows:"2"}),(0,o.jsx)("span",{className:"help-text",children:"User story benefit statement"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"req-classification",children:"Classification"}),(0,o.jsx)("input",{type:"text",id:"req-classification",value:E.classification,onChange:e=>L((0,n.A)((0,n.A)({},E),{},{classification:e.target.value})),placeholder:"e.g., registration"}),(0,o.jsx)("span",{className:"help-text",children:"Classification code (optional)"})]})]}):(0,o.jsxs)("div",{className:"form-fields",children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"nfr-id",children:"Requirement ID *"}),(0,o.jsx)("input",{type:"text",id:"nfr-id",value:_.id,onChange:e=>I((0,n.A)((0,n.A)({},_),{},{id:e.target.value})),placeholder:"e.g., NFR-001",required:!0}),(0,o.jsx)("span",{className:"help-text",children:"Unique identifier for this requirement"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"nfr-title",children:"Title *"}),(0,o.jsx)("input",{type:"text",id:"nfr-title",value:_.title,onChange:e=>I((0,n.A)((0,n.A)({},_),{},{title:e.target.value})),placeholder:"e.g., Response Time",required:!0}),(0,o.jsx)("span",{className:"help-text",children:"Short descriptive title"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"nfr-description",children:"Description"}),(0,o.jsx)("textarea",{id:"nfr-description",value:_.description,onChange:e=>I((0,n.A)((0,n.A)({},_),{},{description:e.target.value})),placeholder:"Detailed description of the non-functional requirement",rows:"3"}),(0,o.jsx)("span",{className:"help-text",children:"Detailed explanation of the requirement"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"nfr-requirement",children:"Requirement *"}),(0,o.jsx)("textarea",{id:"nfr-requirement",value:_.requirement,onChange:e=>I((0,n.A)((0,n.A)({},_),{},{requirement:e.target.value})),placeholder:"The system SHALL...",rows:"3",required:!0}),(0,o.jsx)("span",{className:"help-text",children:"Description of the requirement"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"nfr-category",children:"Category"}),(0,o.jsxs)("select",{id:"nfr-category",value:_.category,onChange:e=>I((0,n.A)((0,n.A)({},_),{},{category:e.target.value})),children:[(0,o.jsx)("option",{value:"",children:"Select category..."}),(0,o.jsx)("option",{value:"performance",children:"Performance"}),(0,o.jsx)("option",{value:"security",children:"Security"}),(0,o.jsx)("option",{value:"usability",children:"Usability"}),(0,o.jsx)("option",{value:"reliability",children:"Reliability"}),(0,o.jsx)("option",{value:"scalability",children:"Scalability"}),(0,o.jsx)("option",{value:"maintainability",children:"Maintainability"}),(0,o.jsx)("option",{value:"accessibility",children:"Accessibility"})]}),(0,o.jsx)("span",{className:"help-text",children:"Category of non-functional requirement"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"nfr-classification",children:"Classification"}),(0,o.jsx)("input",{type:"text",id:"nfr-classification",value:_.classification,onChange:e=>I((0,n.A)((0,n.A)({},_),{},{classification:e.target.value})),placeholder:"e.g., quality"}),(0,o.jsx)("span",{className:"help-text",children:"Classification code (optional)"})]})]})})]}):(0,o.jsxs)("div",{className:"requirements-welcome",children:[(0,o.jsx)("h2",{children:"Requirements Editor"}),(0,o.jsx)("p",{children:"Select a requirement from the list or create a new one to get started."}),(0,o.jsxs)("div",{className:"requirements-info",children:[(0,o.jsx)("h3",{children:"About Requirements"}),(0,o.jsx)("p",{children:"Requirements define the system capabilities and constraints for a DAK implementation."}),(0,o.jsxs)("ul",{children:[(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"Functional Requirements:"})," Define what the system must do (capabilities, features, behaviors)"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"Non-Functional Requirements:"})," Define how the system should perform (performance, security, usability)"]})]}),(0,o.jsxs)("p",{children:["Requirements are stored as FSH (FHIR Shorthand) files in ",(0,o.jsx)("code",{children:"input/fsh/requirements/"}),"."]})]})]})})]}),R&&(0,o.jsx)("div",{className:"modal-overlay",onClick:()=>k(!1),role:"presentation",children:(0,o.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),role:"dialog","aria-labelledby":"fsh-preview-title","aria-modal":"true",children:[(0,o.jsxs)("div",{className:"modal-header",children:[(0,o.jsx)("h3",{id:"fsh-preview-title",children:"FSH Preview"}),(0,o.jsx)("button",{onClick:()=>k(!1),className:"close-btn",children:"\u2715"})]}),(0,o.jsx)("div",{className:"modal-body",children:(0,o.jsx)("pre",{className:"fsh-preview",children:D})}),(0,o.jsx)("div",{className:"modal-footer",children:(0,o.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(D),alert("FSH copied to clipboard!")},className:"copy-btn",children:"\ud83d\udccb Copy to Clipboard"})})]})})]})};function u(e,t,i,n){const a=[];return a.push("Logical: ".concat(e)),a.push('Title: "'.concat((0,c.escapeFSHString)(t),'"')),a.push('Description: "'.concat((0,c.escapeFSHString)(i),'"')),n&&a.push("Parent: ".concat(n)),a.join("\n")}function h(e,t){const i=[new RegExp("\\*\\s*".concat(t,'\\s*=\\s*"([^"]*)"'),"i"),new RegExp("\\*\\s*".concat(t,"\\s*=\\s*#(\\S+)"),"i"),new RegExp("\\*\\s*".concat(t,"\\s*=\\s*Reference\\(([^)]+)\\)"),"i")];for(const n of i){const t=e.match(n);if(t&&t[1])return t[1]}return""}const m=()=>(0,o.jsx)(r.Mx,{pageName:"functional-requirements",children:(0,o.jsx)(d,{})})}}]);