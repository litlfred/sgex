{"version":3,"file":"static/js/786.946a9318.chunk.js","mappings":"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","sources":["services/helpContentService.js","services/profileSubscriptionService.js","components/framework/PageProvider.js","utils/themeUtils.js","services/userAccessService.js","services/bookmarkService.js","components/PreviewBadge.js","components/framework/PageHeader.js","components/framework/AccessBadge.js","components/framework/PageContext.js","components/framework/ErrorHandler.js","components/framework/PageLayout.js","components/framework/usePageParams.js","components/framework/SaveButtonsContainer.js","components/framework/CommitMessageDialog.js","services/dataAccessLayer.js","components/framework/AssetEditorLayout.js","components/framework/useAssetSave.js","components/framework/ToolDefinition.js","services/cacheManagementService.js","components/LanguageSelector.js","components/ContextualHelpMascot.js","hooks/useThemeImage.js","services/stagingGroundService.js","components/HelpModal.js","services/repositoryCacheService.js","services/secureTokenStorage.js","services/localStorageService.js","services/branchContextService.js","services/dakValidationService.js","utils/concurrency.js","utils/repositoryCompatibilityCache.js","services/githubService.js"],"sourcesContent":["// Help Content Service - Provides page-specific help topics and content\nclass HelpContentService {\n  constructor() {\n    // Universal help topics that appear on all pages\n    this.universalTopics = {\n      documentation: {\n        id: 'sgex-documentation',\n        title: 'View Documentation',\n        badge: '/sgex/cat-paw-info-icon.svg',\n        type: 'action',\n        action: () => {\n          // Navigate to documentation viewer in the same window\n          const currentPath = window.location.pathname;\n          \n          // Check if we're in a feature branch deployment\n          // Feature branch URLs have the pattern: /sgex/branch-name/page-path\n          // Main branch URLs have the pattern: /sgex/page-path\n          let basePath = '';\n          if (currentPath.includes('/sgex')) {\n            const pathParts = currentPath.split('/');\n            const sgexIndex = pathParts.indexOf('sgex');\n            \n            if (sgexIndex !== -1) {\n              // Check if this is a feature branch (has additional path segment after /sgex)\n              if (pathParts.length > sgexIndex + 2 && \n                  pathParts[sgexIndex + 1] && \n                  !['dashboard', 'docs', 'select_profile', 'dak-action', 'dak-selection'].includes(pathParts[sgexIndex + 1])) {\n                // Feature branch: /sgex/branch-name\n                basePath = `/${pathParts.slice(1, sgexIndex + 2).join('/')}`;\n              } else {\n                // Main branch: /sgex\n                basePath = `/${pathParts.slice(1, sgexIndex + 1).join('/')}`;\n              }\n            }\n          }\n          \n          window.location.href = `${basePath}/docs/overview`;\n        },\n        content: `\n          <p>Access comprehensive documentation and guides for using SGEX Workbench.</p>\n          <div class=\"help-tip\">\n            <strong>📖 Available Documentation:</strong> Requirements, Architecture, DAK Components, User Guides, and more.\n          </div>\n        `\n      },\n      bugReport: {\n        id: 'report-sgex-bug',\n        title: 'Report a SGeX bug',\n        badge: '/sgex/cat-paw-bug-icon.svg',\n        type: 'slideshow',\n        content: [\n          {\n            title: 'Report a Bug or Issue',\n            content: `\n              <p>Help us improve SGeX by reporting bugs and issues:</p>\n              <h4>What type of issue are you experiencing?</h4>\n              <div class=\"bug-report-options\">\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('bug')\">\n                  🐛 Bug Report - Something isn't working correctly\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('feature')\">\n                  ✨ Feature Request - Suggest a new feature or improvement\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('question')\">\n                  ❓ Question - Ask for help or clarification\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('documentation')\">\n                  📚 Documentation Issue - Report problems with documentation\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openSgexIssue('blank')\">\n                  📝 Blank Issue - Create an issue without a template\n                </button>\n              </div>\n              <div class=\"help-tip\">\n                <strong>💡 Tip:</strong> Please provide as much detail as possible including steps to reproduce, expected behavior, and actual behavior.\n              </div>\n              <div class=\"help-fallback\">\n                <strong>🔗 Can't access GitHub?</strong> If the buttons above don't work in your environment:\n                <ol>\n                  <li>Email us directly at <a href=\"mailto:smart@who.int?subject=SGEX Bug Report\">smart@who.int</a></li>\n                  <li>Or visit <a href=\"https://github.com/litlfred/sgex/issues/new\" target=\"_blank\">github.com/litlfred/sgex/issues/new</a> manually</li>\n                </ol>\n              </div>\n            `\n          }\n        ]\n      },\n      dakFeedback: {\n        id: 'provide-dak-feedback',\n        title: 'Provide DAK Feedback',\n        type: 'slideshow',\n        content: [\n          {\n            title: 'Provide Feedback on this DAK',\n            content: `\n              <p>Share feedback about this Digital Adaptation Kit (DAK):</p>\n              <h4>What type of feedback do you have?</h4>\n              <div class=\"bug-report-options\">\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('content')\">\n                  📝 Report DAK Content Error - Problems with clinical content or logic\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('bug')\">\n                  🐛 DAK Bug - Issue with this specific DAK content\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('improvement')\">\n                  📈 DAK Improvement - Suggest enhancements to this DAK\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('question')\">\n                  ❓ DAK Question - Ask about this DAK's implementation\n                </button>\n                <button class=\"bug-type-btn\" onclick=\"window.helpModalInstance?.openDakIssue('blank')\">\n                  📝 Blank DAK Issue - Create an issue without a template\n                </button>\n              </div>\n              <div class=\"help-tip\">\n                <strong>💡 Note:</strong> This will open an issue in the selected DAK repository for targeted feedback.\n              </div>\n            `\n          }\n        ]\n      }\n    };\n\n    this.helpTopics = {\n      'landing-page-unauthenticated': [\n        {\n          id: 'github-pat-setup',\n          title: 'How to Create a GitHub Personal Access Token',\n          badge: '/sgex/cat-paw-lock-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Step 1: Go to GitHub Settings',\n              content: `\n                <p>Navigate to your GitHub account settings:</p>\n                <ol>\n                  <li>Click your profile picture in the top right</li>\n                  <li>Select \"Settings\" from the dropdown</li>\n                  <li>Go to \"Developer settings\" → \"Personal access tokens\"</li>\n                  <li>Choose \"Fine-grained tokens\" (recommended) or \"Tokens (classic)\"</li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> Fine-grained tokens provide better security with repository-specific access.\n                </div>\n              `\n            },\n            {\n              title: 'Step 2: Generate New Token',\n              content: `\n                <p>Create your new token:</p>\n                <ol>\n                  <li>Click \"Generate new token\"</li>\n                  <li>Give it a descriptive name like \"SGEX Workbench\"</li>\n                  <li>Set expiration (90 days recommended)</li>\n                  <li>Select repository access (specific repos or all)</li>\n                </ol>\n                <div class=\"help-warning\">\n                  <strong>⚠️ Important:</strong> You'll only see the token once, so copy it immediately!\n                </div>\n              `\n            },\n            {\n              title: 'Step 3: Set Required Permissions',\n              content: `\n                <p>For <strong>fine-grained tokens</strong>, enable:</p>\n                <ul>\n                  <li><strong>Contents:</strong> Read and Write</li>\n                  <li><strong>Metadata:</strong> Read</li>\n                  <li><strong>Pull requests:</strong> Read and Write</li>\n                </ul>\n                <p>For <strong>classic tokens</strong>, select:</p>\n                <ul>\n                  <li><strong>repo</strong> - Full control of private repositories</li>\n                  <li><strong>read:org</strong> - Read org and team membership</li>\n                </ul>\n              `\n            },\n            {\n              title: 'Step 4: Use Your Token',\n              content: `\n                <p>Now you can authenticate with SGEX:</p>\n                <ol>\n                  <li>Copy your newly generated token</li>\n                  <li>Paste it into the login form</li>\n                  <li>Click \"Sign in with Personal Access Token\"</li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>🔒 Security:</strong> Your token is stored securely in your browser and never shared with servers.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'landing-page-authenticated': [\n        {\n          id: 'profile-selection',\n          title: 'Selecting Your Profile or Organization',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Understanding Profile Types',\n              content: `\n                <p>SGEX shows different types of profiles:</p>\n                <ul>\n                  <li><strong>Personal:</strong> Your individual GitHub repositories</li>\n                  <li><strong>Organization:</strong> Repositories belonging to organizations you're a member of</li>\n                  <li><strong>WHO Official:</strong> World Health Organization repositories (always available)</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> DAK count badges show how many SMART Guidelines repositories were found.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'dak-action-selection': [\n        {\n          id: 'choosing-dak-action',\n          title: 'Choosing Your DAK Action',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Understanding DAK Actions',\n              content: `\n                <p>Choose the right action for your workflow:</p>\n                <ul>\n                  <li><strong>Edit Existing DAK:</strong> Modify an existing repository you have write access to</li>\n                  <li><strong>Fork and Edit:</strong> Create your own copy of a repository to work on</li>\n                  <li><strong>Create New DAK:</strong> Start a brand new DAK repository from scratch</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> If you're not sure, start with \"Edit Existing DAK\" if you have permissions, or \"Fork and Edit\" to experiment safely.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'documentation-viewer': [\n        {\n          id: 'navigation-help',\n          title: 'Navigating Documentation',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Using the Documentation Viewer',\n              content: `\n                <p>The documentation viewer provides easy access to all project information:</p>\n                <ul>\n                  <li>Use the sidebar menu to navigate between sections</li>\n                  <li>Use the dropdown to quickly jump to any document</li>\n                  <li>Click \"Back\" to return to the previous page</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>📖 Available Documentation:</strong> Requirements, Architecture, DAK Components, and more.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'dak-dashboard': [\n        {\n          id: 'dak-components-overview',\n          title: 'Understanding DAK Components',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'WHO SMART Guidelines DAK Components',\n              content: `\n                <p>Digital Adaptation Kits (DAKs) contain 8 core components organized in two levels:</p>\n                <h4>Level 2: Business Logic & Processes</h4>\n                <ul>\n                  <li><strong>Business Processes:</strong> BPMN workflows</li>\n                  <li><strong>Decision Support Logic:</strong> DMN decision tables</li>\n                  <li><strong>Indicators & Measures:</strong> Performance metrics</li>\n                  <li><strong>Data Entry Forms:</strong> Structured questionnaires</li>\n                </ul>\n                <h4>Level 3: Technical Implementation</h4>\n                <ul>\n                  <li><strong>Terminology:</strong> Code systems and value sets</li>\n                  <li><strong>FHIR Profiles:</strong> Resource structure definitions</li>\n                  <li><strong>FHIR Extensions:</strong> Custom data elements</li>\n                  <li><strong>Test Data & Examples:</strong> Sample data for validation</li>\n                </ul>\n              `\n            }\n          ]\n        }\n      ],\n      'dak-selection': [\n        {\n          id: 'choosing-dak-repository',\n          title: 'Selecting the Right DAK Repository',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Understanding DAK Repository Types',\n              content: `\n                <p>Choose the right repository based on your workflow:</p>\n                <ul>\n                  <li><strong>Published DAKs:</strong> Official WHO repositories with complete implementations</li>\n                  <li><strong>Community DAKs:</strong> Community-maintained repositories with adaptations</li>\n                  <li><strong>Template DAKs:</strong> Starting templates for creating new DAKs</li>\n                  <li><strong>Private DAKs:</strong> Your private repositories or organization-specific DAKs</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> Look for the \"SMART Guidelines\" badge to ensure compatibility.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'organization-selection': [\n        {\n          id: 'selecting-organization',\n          title: 'Choosing an Organization',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Organization vs Personal Account',\n              content: `\n                <p>Decide where to create or fork your DAK:</p>\n                <ul>\n                  <li><strong>Personal Account:</strong> For individual development and experimentation</li>\n                  <li><strong>Organization Account:</strong> For team collaboration and official implementations</li>\n                  <li><strong>WHO Official:</strong> Only for authorized WHO contributors</li>\n                </ul>\n                <div class=\"help-warning\">\n                  <strong>⚠️ Important:</strong> Make sure you have the necessary permissions for the selected organization.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'bpmn-editor': [\n        {\n          id: 'using-bpmn-editor',\n          title: 'Using the BPMN Editor',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'BPMN Business Process Modeling',\n              content: `\n                <p>The BPMN editor helps you create and modify business process workflows:</p>\n                <ul>\n                  <li><strong>Drag and Drop:</strong> Use the palette to add process elements</li>\n                  <li><strong>Connect Elements:</strong> Click and drag to create sequence flows</li>\n                  <li><strong>Properties Panel:</strong> Configure element properties and conditions</li>\n                  <li><strong>Validation:</strong> The editor highlights errors and warnings</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> BPMN processes define the clinical workflow and decision logic for your DAK.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'component-editor': [\n        {\n          id: 'component-editor-overview',\n          title: 'Understanding the Component Editor',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'DAK Component Types',\n              content: `\n                <p>The component editor provides specialized interfaces for different DAK components:</p>\n                <h4>Business Logic Components</h4>\n                <ul>\n                  <li><strong>Business Processes:</strong> BPMN workflow editor</li>\n                  <li><strong>Decision Logic:</strong> DMN decision table editor</li>\n                  <li><strong>Forms:</strong> Structured questionnaire builder</li>\n                </ul>\n                <h4>Technical Components</h4>\n                <ul>\n                  <li><strong>FHIR Resources:</strong> Profile and extension definitions</li>\n                  <li><strong>Terminology:</strong> Code systems and value sets</li>\n                  <li><strong>Test Data:</strong> Example data and test cases</li>\n                </ul>\n              `\n            }\n          ]\n        }\n      ],\n      'pat-login': [\n        {\n          id: 'pat-authentication-help',\n          title: 'Using Personal Access Tokens',\n          badge: '/sgex/cat-paw-lock-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Why Personal Access Tokens?',\n              content: `\n                <p>SGEX uses GitHub Personal Access Tokens (PATs) for secure authentication:</p>\n                <ul>\n                  <li><strong>No Backend Required:</strong> Works entirely in your browser</li>\n                  <li><strong>Fine-grained Control:</strong> Choose which repositories to access</li>\n                  <li><strong>Enhanced Security:</strong> Can be easily rotated and revoked</li>\n                  <li><strong>Privacy Focused:</strong> Your token never leaves your browser</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>🔒 Security:</strong> SGEX stores your token locally and never transmits it to any server.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'pat-setup-instructions': [\n        {\n          id: 'detailed-pat-setup',\n          title: 'Detailed PAT Setup Guide',\n          badge: '/sgex/cat-paw-lock-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Token Type Comparison',\n              content: `\n                <p>GitHub offers two types of Personal Access Tokens:</p>\n                <h4>Fine-grained Tokens (Recommended)</h4>\n                <ul>\n                  <li>Repository-specific access control</li>\n                  <li>Better security with minimal permissions</li>\n                  <li>More granular permission settings</li>\n                  <li>Shorter default expiration times</li>\n                </ul>\n                <h4>Classic Tokens</h4>\n                <ul>\n                  <li>Broader scope-based permissions</li>\n                  <li>Simpler permission model</li>\n                  <li>Longer expiration options</li>\n                  <li>Works with all GitHub integrations</li>\n                </ul>\n              `\n            }\n          ]\n        }\n      ],\n      'welcome': [\n        {\n          id: 'github-pat-setup',\n          title: 'How to Create a GitHub Personal Access Token',\n          badge: '/sgex/cat-paw-lock-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Step 1: Go to GitHub Settings',\n              content: `\n                <p>Navigate to your GitHub account settings:</p>\n                <ol>\n                  <li>Click your profile picture in the top right</li>\n                  <li>Select \"Settings\" from the dropdown</li>\n                  <li>Go to \"Developer settings\" → \"Personal access tokens\"</li>\n                  <li>Choose \"Fine-grained tokens\" (recommended) or \"Tokens (classic)\"</li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>💡 Tip:</strong> Fine-grained tokens provide better security with repository-specific access.\n                </div>\n              `\n            },\n            {\n              title: 'Step 2: Generate New Token',\n              content: `\n                <p>Create your new token:</p>\n                <ol>\n                  <li>Click \"Generate new token\"</li>\n                  <li>Give it a descriptive name like \"SGEX Workbench\"</li>\n                  <li>Set expiration (90 days recommended)</li>\n                  <li>Select repository access (specific repos or all)</li>\n                </ol>\n                <div class=\"help-warning\">\n                  <strong>⚠️ Important:</strong> You'll only see the token once, so copy it immediately!\n                </div>\n              `\n            },\n            {\n              title: 'Step 3: Set Required Permissions',\n              content: `\n                <p>For <strong>fine-grained tokens</strong>, enable:</p>\n                <ul>\n                  <li><strong>Contents:</strong> Read and Write</li>\n                  <li><strong>Metadata:</strong> Read</li>\n                  <li><strong>Pull requests:</strong> Read and Write</li>\n                </ul>\n                <p>For <strong>classic tokens</strong>, select:</p>\n                <ul>\n                  <li><strong>repo</strong> - Full control of private repositories</li>\n                  <li><strong>read:org</strong> - Read org and team membership</li>\n                </ul>\n              `\n            },\n            {\n              title: 'Step 4: Use Your Token',\n              content: `\n                <p>Now you can authenticate with SGEX:</p>\n                <ol>\n                  <li>Copy your newly generated token</li>\n                  <li>Paste it into the login form</li>\n                  <li>Click \"Sign in with Personal Access Token\"</li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>🔒 Security:</strong> Your token is stored securely in your browser and never shared with servers.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'dak-configuration': [\n        {\n          id: 'dak-configuration-guide',\n          title: 'Configuring Your DAK',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Understanding DAK Configuration',\n              content: `\n                <p>When creating a new DAK, you need to configure both repository and FHIR settings:</p>\n                <h4>Repository Configuration</h4>\n                <ul>\n                  <li><strong>Repository Name:</strong> GitHub repository identifier (lowercase with hyphens)</li>\n                  <li><strong>Description:</strong> Brief description of your DAK's purpose</li>\n                  <li><strong>Topics:</strong> Tags that help others discover your DAK</li>\n                  <li><strong>Visibility:</strong> Public repositories are discoverable by the community</li>\n                </ul>\n                <h4>FHIR Implementation Guide Settings</h4>\n                <ul>\n                  <li><strong>IG ID:</strong> Unique identifier for your Implementation Guide</li>\n                  <li><strong>Name:</strong> Technical name used in code generation</li>\n                  <li><strong>Title:</strong> Human-readable title for documentation</li>\n                  <li><strong>Publisher:</strong> Organization responsible for the DAK</li>\n                </ul>\n              `\n            }\n          ]\n        }\n      ],\n      'core-data-dictionary-viewer': [\n        {\n          id: 'core-data-dictionary-help',\n          title: 'Understanding Core Data Dictionary',\n          badge: '/sgex/cat-paw-info-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'What is the Core Data Dictionary?',\n              content: `\n                <p>The Core Data Dictionary (Component 2) contains the data elements required throughout the different points of the workflow. These data elements are mapped to the International Classification of Diseases version 11 (ICD-11) codes and other established concept mapping standards to ensure the data dictionary is compatible with other digital systems.</p>\n                <h4>Purpose: System Design and Interoperability</h4>\n                <p>To know which data elements need to be logged and how they map to other standard terminologies (e.g. ICD, Systematized Nomenclature of Medicine [SNOMED]) for interoperability with other standards-based systems.</p>\n                <h4>FHIR FSH Source Files</h4>\n                <ul>\n                  <li><strong>CodeSystems:</strong> Define custom codes and concepts used in your DAK</li>\n                  <li><strong>ValueSets:</strong> Specify allowed values for clinical data elements</li>\n                  <li><strong>ConceptMaps:</strong> Map between different terminology systems including ICD-11 and SNOMED</li>\n                  <li><strong>Logical Models:</strong> Define data structures for clinical workflows</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Location:</strong> FSH files are stored in the <code>input/fsh/</code> directory of your repository.\n                </div>\n              `\n            },\n            {\n              title: 'GitHub Pages Integration',\n              content: `\n                <p>When GitHub Pages is configured, your FSH files are automatically compiled into HTML documentation:</p>\n                <h4>Published Artifacts</h4>\n                <ul>\n                  <li><strong>Code Systems:</strong> Browse and search your custom terminologies</li>\n                  <li><strong>Value Sets:</strong> View allowed values with descriptions</li>\n                  <li><strong>Logical Models:</strong> Interactive data structure documentation</li>\n                  <li><strong>Concept Maps:</strong> Visual mapping between terminologies</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>⚡ URL Pattern:</strong> Main branch publishes to <code>user.github.io/repo</code>, feature branches to <code>user.github.io/repo/branches/branch-name</code>\n                </div>\n              `\n            }\n          ]\n        },\n        {\n          id: 'github-pages-setup',\n          title: 'Setting Up GitHub Pages',\n          badge: '/sgex/cat-paw-settings-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'Enable GitHub Pages for Your DAK',\n              content: `\n                <p>Follow these steps to enable automatic publishing of your Implementation Guide:</p>\n                <h4>Step 1: Repository Settings</h4>\n                <ol>\n                  <li>Go to your repository on GitHub</li>\n                  <li>Click on the <strong>Settings</strong> tab</li>\n                  <li>Scroll down to <strong>Pages</strong> in the left sidebar</li>\n                  <li>Under <strong>Source</strong>, select <strong>GitHub Actions</strong></li>\n                </ol>\n                <div class=\"help-tip\">\n                  <strong>📋 Note:</strong> Your repository must contain a valid FHIR Implementation Guide structure with <code>sushi-config.yaml</code>\n                </div>\n              `\n            },\n            {\n              title: 'Configure IG Publisher Workflow',\n              content: `\n                <p>Set up the automated publishing workflow:</p>\n                <h4>Step 2: GitHub Actions</h4>\n                <ol>\n                  <li>Create <code>.github/workflows/</code> directory in your repository</li>\n                  <li>Add an IG Publisher workflow file (e.g., <code>publish.yml</code>)</li>\n                  <li>Configure the workflow to run on push to main branch</li>\n                  <li>Include steps to build and deploy the Implementation Guide</li>\n                </ol>\n                <h4>Step 3: Verify Publishing</h4>\n                <ul>\n                  <li>Check the <strong>Actions</strong> tab for workflow status</li>\n                  <li>Once successful, visit your GitHub Pages URL</li>\n                  <li>Verify that artifacts are accessible from the Core Data Dictionary viewer</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>🔗 Reference:</strong> See the <a href=\"https://smart.who.int/ig-starter-kit/v1.0.0/ig_setup.html#ghpages-build\" target=\"_blank\">WHO IG Starter Kit</a> for detailed setup instructions.\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'business-process-selection': [\n        {\n          id: 'business-process-help',\n          title: 'Understanding Business Processes',\n          badge: '/sgex/cat-paw-workflow-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'What are Business Processes?',\n              content: `\n                <p>Business Processes (Component 5) define the clinical workflows and care processes in your DAK:</p>\n                <h4>BPMN 2.0 Diagrams</h4>\n                <ul>\n                  <li><strong>Clinical Workflows:</strong> Step-by-step patient care processes</li>\n                  <li><strong>Decision Points:</strong> Where clinical decisions are made</li>\n                  <li><strong>Task Assignments:</strong> Who performs each step in the workflow</li>\n                  <li><strong>Data Flows:</strong> How information moves through the process</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Standard:</strong> Uses BPMN 2.0 (Business Process Model and Notation) for workflow modeling\n                </div>\n              `\n            },\n            {\n              title: 'Working with BPMN Files',\n              content: `\n                <p>Business process diagrams are stored as BPMN XML files in your repository:</p>\n                <h4>File Management</h4>\n                <ul>\n                  <li><strong>Location:</strong> Typically stored in <code>input/models/</code> or <code>input/bpmn/</code></li>\n                  <li><strong>Format:</strong> BPMN 2.0 XML standard format</li>\n                  <li><strong>Editing:</strong> Use the built-in BPMN editor or external tools</li>\n                  <li><strong>Validation:</strong> Automatic validation against BPMN 2.0 schema</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>🔧 Tools:</strong> SGeX includes an integrated BPMN editor for creating and modifying workflow diagrams\n                </div>\n              `\n            }\n          ]\n        }\n      ],\n      'pages-manager': [\n        {\n          id: 'page-content-help',\n          title: 'Managing Page Content',\n          badge: '/sgex/cat-paw-document-icon.svg',\n          type: 'slideshow',\n          content: [\n            {\n              title: 'What is Page Content?',\n              content: `\n                <p>Page Content represents the narrative documentation and educational materials in your DAK:</p>\n                <h4>Content Types</h4>\n                <ul>\n                  <li><strong>Clinical Guidelines:</strong> Evidence-based care recommendations</li>\n                  <li><strong>User Guides:</strong> Instructions for healthcare workers</li>\n                  <li><strong>Training Materials:</strong> Educational content and scenarios</li>\n                  <li><strong>Reference Documentation:</strong> Technical specifications and background</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>💡 Format:</strong> Content is typically authored in Markdown format for easy editing and version control\n                </div>\n              `\n            },\n            {\n              title: 'Content Organization',\n              content: `\n                <p>Page content is organized to support different user needs and workflows:</p>\n                <h4>Structure</h4>\n                <ul>\n                  <li><strong>Pages Directory:</strong> Main content files organized by topic</li>\n                  <li><strong>Assets:</strong> Images, diagrams, and multimedia content</li>\n                  <li><strong>Templates:</strong> Reusable content patterns and layouts</li>\n                  <li><strong>Navigation:</strong> Menus and linking between related content</li>\n                </ul>\n                <h4>Publishing</h4>\n                <ul>\n                  <li><strong>GitHub Pages:</strong> Automatic publishing of content as web pages</li>\n                  <li><strong>FHIR IG:</strong> Integration with Implementation Guide publishing</li>\n                  <li><strong>Version Control:</strong> Track changes and collaborate on content</li>\n                </ul>\n                <div class=\"help-tip\">\n                  <strong>📝 Best Practice:</strong> Use clear headings, bullet points, and visual elements to make content accessible to healthcare workers\n                </div>\n              `\n            }\n          ]\n        }\n      ]\n    };\n  }\n\n  // Get help topics for a specific page\n  getHelpTopicsForPage(pageId, contextData = {}) {\n    const pageTopics = this.helpTopics[pageId] || [];\n    const universalTopics = this.getUniversalTopics(contextData);\n    return [...pageTopics, ...universalTopics];\n  }\n\n  // Get universal topics based on context (e.g., if DAK is selected)\n  getUniversalTopics(contextData = {}) {\n    const topics = [\n      this.universalTopics.documentation,\n      this.universalTopics.bugReport\n    ];\n    \n    // Add DAK feedback if we have DAK context\n    if (contextData.selectedDak || contextData.repository) {\n      topics.push(this.universalTopics.dakFeedback);\n    }\n    \n    return topics;\n  }\n\n  // Get a specific help topic by ID\n  getHelpTopic(topicId) {\n    for (const pageTopics of Object.values(this.helpTopics)) {\n      const topic = pageTopics.find(t => t.id === topicId);\n      if (topic) {\n        return topic;\n      }\n    }\n    return null;\n  }\n\n  // Check if a page has help topics (now always true since we have universal topics)\n  hasHelpTopics(pageId, contextData = {}) {\n    return true; // Always true now due to universal topics\n  }\n\n  // Add a help topic to a page\n  addHelpTopicToPage(pageId, helpTopic) {\n    if (!this.helpTopics[pageId]) {\n      this.helpTopics[pageId] = [];\n    }\n    this.helpTopics[pageId].push(helpTopic);\n  }\n\n  // Get all available page IDs that have help content\n  getAvailablePages() {\n    return Object.keys(this.helpTopics);\n  }\n\n  // Helper method to open DAK-specific issues\n  openDakIssue(issueType, dakRepository) {\n    if (!dakRepository) {\n      console.warn('No DAK repository specified for feedback');\n      return;\n    }\n\n    const baseUrl = `https://github.com/${dakRepository.owner}/${dakRepository.name}/issues/new`;\n    let url = baseUrl;\n\n    switch (issueType) {\n      case 'bug':\n        url += '?template=bug_report.md&labels=bug,dak-issue';\n        break;\n      case 'improvement':\n        url += '?template=feature_request.md&labels=enhancement,dak-improvement';\n        break;\n      case 'content':\n        url += '?labels=content-issue,clinical-content';\n        break;\n      case 'question':\n        url += '?template=question.md&labels=question,dak-question';\n        break;\n      default:\n        url += '?labels=dak-feedback';\n    }\n\n    window.open(url, '_blank');\n  }\n}\n\n// Create and export a singleton instance\nconst helpContentService = new HelpContentService();\nexport default helpContentService;","/**\n * Profile Subscription Service - Manages profile subscriptions in localStorage\n * \n * Provides functionality to manage profile subscriptions:\n * - Always includes WorldHealthOrganization\n * - Includes logged-in user when authenticated\n * - Auto-adds users when browsing their profiles\n * - Allows removal of profiles (except WHO and current user)\n */\nclass ProfileSubscriptionService {\n  constructor() {\n    this.storageKey = 'sgex-profile-subscriptions';\n    this.whoProfile = 'WorldHealthOrganization';\n  }\n\n  /**\n   * Get profile subscriptions from localStorage\n   * @returns {Array} Array of profile objects\n   */\n  getSubscriptions() {\n    try {\n      const stored = localStorage.getItem(this.storageKey);\n      const subscriptions = stored ? JSON.parse(stored) : [];\n      \n      // Always ensure WHO is included\n      if (!subscriptions.find(profile => profile.login === this.whoProfile)) {\n        subscriptions.unshift({\n          login: this.whoProfile,\n          name: 'World Health Organization',\n          avatar_url: `https://github.com/${this.whoProfile}.png`,\n          type: 'Organization',\n          isPermanent: true,\n          addedAt: new Date().toISOString()\n        });\n        this.saveSubscriptions(subscriptions);\n      }\n      \n      return subscriptions;\n    } catch (error) {\n      console.warn('Error reading profile subscriptions from localStorage:', error);\n      // Return minimal default with WHO\n      return [{\n        login: this.whoProfile,\n        name: 'World Health Organization',\n        avatar_url: `https://github.com/${this.whoProfile}.png`,\n        type: 'Organization',\n        isPermanent: true,\n        addedAt: new Date().toISOString()\n      }];\n    }\n  }\n\n  /**\n   * Save profile subscriptions to localStorage\n   * @param {Array} subscriptions - Array of profile objects\n   */\n  saveSubscriptions(subscriptions) {\n    try {\n      localStorage.setItem(this.storageKey, JSON.stringify(subscriptions));\n    } catch (error) {\n      console.error('Error saving profile subscriptions to localStorage:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Add a profile to subscriptions\n   * @param {Object} profile - Profile object with login, name, avatar_url, type\n   * @param {boolean} isPermanent - Whether the profile cannot be removed\n   * @returns {Object} The added profile\n   */\n  addSubscription(profile, isPermanent = false) {\n    if (!profile || !profile.login) {\n      throw new Error('Profile must have a login property');\n    }\n\n    const subscriptions = this.getSubscriptions();\n    \n    // Check if already subscribed\n    const existingIndex = subscriptions.findIndex(p => p.login === profile.login);\n    if (existingIndex !== -1) {\n      // Update existing subscription\n      subscriptions[existingIndex] = {\n        ...subscriptions[existingIndex],\n        ...profile,\n        isPermanent: subscriptions[existingIndex].isPermanent || isPermanent,\n        lastUpdated: new Date().toISOString()\n      };\n      this.saveSubscriptions(subscriptions);\n      return subscriptions[existingIndex];\n    }\n\n    // Add new subscription\n    const newSubscription = {\n      login: profile.login,\n      name: profile.name || profile.login,\n      avatar_url: profile.avatar_url || `https://github.com/${profile.login}.png`,\n      type: profile.type || 'User',\n      isPermanent,\n      addedAt: new Date().toISOString(),\n      lastUpdated: new Date().toISOString()\n    };\n\n    subscriptions.push(newSubscription);\n    this.saveSubscriptions(subscriptions);\n    return newSubscription;\n  }\n\n  /**\n   * Remove a profile from subscriptions\n   * @param {string} login - Login/username to remove\n   * @returns {boolean} Success status\n   */\n  removeSubscription(login) {\n    if (!login) {\n      return false;\n    }\n\n    try {\n      const subscriptions = this.getSubscriptions();\n      const profileIndex = subscriptions.findIndex(p => p.login === login);\n      \n      if (profileIndex === -1) {\n        return false; // Profile not found\n      }\n\n      const profile = subscriptions[profileIndex];\n      \n      // Cannot remove permanent profiles (WHO, current user)\n      if (profile.isPermanent) {\n        console.warn(`Cannot remove permanent profile: ${login}`);\n        return false;\n      }\n\n      subscriptions.splice(profileIndex, 1);\n      this.saveSubscriptions(subscriptions);\n      return true;\n    } catch (error) {\n      console.error('Error removing profile subscription:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Check if a profile is subscribed\n   * @param {string} login - Login/username to check\n   * @returns {boolean} Whether the profile is subscribed\n   */\n  isSubscribed(login) {\n    if (!login) return false;\n    const subscriptions = this.getSubscriptions();\n    return subscriptions.some(p => p.login === login);\n  }\n\n  /**\n   * Get a specific subscription by login\n   * @param {string} login - Login/username to find\n   * @returns {Object|null} Profile object or null if not found\n   */\n  getSubscription(login) {\n    if (!login) return null;\n    const subscriptions = this.getSubscriptions();\n    return subscriptions.find(p => p.login === login) || null;\n  }\n\n  /**\n   * Auto-add current user to subscriptions (when logged in)\n   * @param {Object} userProfile - Current user's profile\n   */\n  ensureCurrentUserSubscribed(userProfile) {\n    if (!userProfile || !userProfile.login) {\n      return;\n    }\n\n    const existing = this.getSubscription(userProfile.login);\n    if (!existing) {\n      this.addSubscription({\n        ...userProfile,\n        isPermanent: true // Current user cannot be removed\n      }, true);\n    } else if (!existing.isPermanent) {\n      // Update existing to be permanent\n      this.addSubscription({\n        ...existing,\n        ...userProfile,\n        isPermanent: true\n      }, true);\n    }\n  }\n\n  /**\n   * Auto-add a visited user profile (from browsing)\n   * @param {Object} visitedProfile - Profile that user is browsing\n   */\n  autoAddVisitedProfile(visitedProfile) {\n    if (!visitedProfile || !visitedProfile.login) {\n      return;\n    }\n\n    // Don't auto-add if already subscribed\n    if (this.isSubscribed(visitedProfile.login)) {\n      return;\n    }\n\n    // Don't auto-add demo profiles\n    if (visitedProfile.isDemo) {\n      return;\n    }\n\n    this.addSubscription(visitedProfile, false);\n  }\n\n  /**\n   * Get subscriptions sorted alphabetically by name\n   * @returns {Array} Sorted array of profile objects\n   */\n  getSubscriptionsSorted() {\n    const subscriptions = this.getSubscriptions();\n    return subscriptions.sort((a, b) => {\n      // WHO always first\n      if (a.login === this.whoProfile) return -1;\n      if (b.login === this.whoProfile) return 1;\n      \n      // Then sort by name/login\n      const nameA = a.name || a.login;\n      const nameB = b.name || b.login;\n      return nameA.localeCompare(nameB);\n    });\n  }\n\n  /**\n   * Get subscriptions for profile selection (formatted for UI)\n   * @returns {Array} Array of profile objects formatted for selection UI\n   */\n  getSubscriptionsForSelection() {\n    return this.getSubscriptionsSorted().map(profile => ({\n      ...profile,\n      displayName: profile.name || profile.login,\n      isRemovable: !profile.isPermanent\n    }));\n  }\n\n  /**\n   * Update subscription with latest profile information\n   * @param {string} login - Login/username to update\n   * @param {Object} updatedProfile - Updated profile information\n   * @returns {boolean} Success status\n   */\n  updateSubscription(login, updatedProfile) {\n    if (!login || !updatedProfile) {\n      return false;\n    }\n\n    try {\n      const subscriptions = this.getSubscriptions();\n      const index = subscriptions.findIndex(p => p.login === login);\n      \n      if (index === -1) {\n        return false;\n      }\n\n      subscriptions[index] = {\n        ...subscriptions[index],\n        ...updatedProfile,\n        login, // Preserve original login\n        lastUpdated: new Date().toISOString()\n      };\n\n      this.saveSubscriptions(subscriptions);\n      return true;\n    } catch (error) {\n      console.error('Error updating subscription:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear all subscriptions (except WHO)\n   */\n  clearSubscriptions() {\n    try {\n      const whoProfile = {\n        login: this.whoProfile,\n        name: 'World Health Organization',\n        avatar_url: `https://github.com/${this.whoProfile}.png`,\n        type: 'Organization',\n        isPermanent: true,\n        addedAt: new Date().toISOString()\n      };\n      this.saveSubscriptions([whoProfile]);\n    } catch (error) {\n      console.error('Error clearing subscriptions:', error);\n    }\n  }\n\n  /**\n   * Export subscriptions as JSON\n   * @returns {string} JSON string of subscriptions\n   */\n  exportSubscriptions() {\n    const subscriptions = this.getSubscriptions();\n    return JSON.stringify(subscriptions, null, 2);\n  }\n\n  /**\n   * Import subscriptions from JSON\n   * @param {string} jsonString - JSON string of subscriptions\n   * @param {boolean} merge - Whether to merge with existing subscriptions\n   * @returns {boolean} Success status\n   */\n  importSubscriptions(jsonString, merge = false) {\n    try {\n      const importedSubscriptions = JSON.parse(jsonString);\n      \n      if (!Array.isArray(importedSubscriptions)) {\n        throw new Error('Invalid subscription format');\n      }\n\n      let finalSubscriptions;\n      \n      if (merge) {\n        const existingSubscriptions = this.getSubscriptions();\n        const mergedSubscriptions = [...existingSubscriptions];\n        \n        importedSubscriptions.forEach(imported => {\n          const existingIndex = mergedSubscriptions.findIndex(p => p.login === imported.login);\n          if (existingIndex !== -1) {\n            // Preserve permanence of existing subscriptions\n            mergedSubscriptions[existingIndex] = {\n              ...imported,\n              isPermanent: mergedSubscriptions[existingIndex].isPermanent || imported.isPermanent\n            };\n          } else {\n            mergedSubscriptions.push(imported);\n          }\n        });\n        \n        finalSubscriptions = mergedSubscriptions;\n      } else {\n        finalSubscriptions = importedSubscriptions;\n      }\n\n      // Ensure WHO is always included\n      if (!finalSubscriptions.find(p => p.login === this.whoProfile)) {\n        finalSubscriptions.unshift({\n          login: this.whoProfile,\n          name: 'World Health Organization',\n          avatar_url: `https://github.com/${this.whoProfile}.png`,\n          type: 'Organization',\n          isPermanent: true,\n          addedAt: new Date().toISOString()\n        });\n      }\n      \n      this.saveSubscriptions(finalSubscriptions);\n      return true;\n    } catch (error) {\n      console.error('Error importing subscriptions:', error);\n      return false;\n    }\n  }\n}\n\n// Create and export singleton instance\nconst profileSubscriptionService = new ProfileSubscriptionService();\nexport default profileSubscriptionService;","import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { useParams, useLocation, useNavigate } from 'react-router-dom';\nimport githubService from '../../services/githubService';\nimport dakValidationService from '../../services/dakValidationService';\nimport profileSubscriptionService from '../../services/profileSubscriptionService';\n\n/**\n * Page types supported by the framework\n */\nexport const PAGE_TYPES = {\n  TOP_LEVEL: 'top-level',\n  USER: 'user', \n  DAK: 'dak',\n  ASSET: 'asset'\n};\n\n/**\n * Context for page framework\n */\nconst PageContext = createContext(null);\n\n/**\n * Hook to use page context\n */\nexport const usePage = () => {\n  const context = useContext(PageContext);\n  console.log('usePage: called, context is:', context ? 'available' : 'null');\n  if (!context) {\n    console.error('usePage: PageContext is null - component not wrapped in PageProvider');\n    // Return a default context instead of throwing to make ErrorHandler more resilient\n    return {\n      pageName: 'unknown',\n      user: null,\n      profile: null,\n      repository: null,\n      branch: null,\n      asset: null,\n      type: 'top-level',\n      loading: false,\n      error: null,\n      isAuthenticated: false,\n      navigate: () => {},\n      params: {},\n      location: { pathname: '/' }\n    };\n  }\n  return context;\n};\n\n/**\n * Determine page type from URL parameters\n */\nconst determinePageType = (params) => {\n  const { user, repo } = params;\n  const asset = params['*']; // Wildcard parameter for asset path\n  \n  console.log('PageProvider: determinePageType called with params:', params);\n  console.log('PageProvider: extracted values:', { user, repo, asset });\n  \n  if (asset) return PAGE_TYPES.ASSET;\n  if (user && repo) return PAGE_TYPES.DAK;\n  if (user) return PAGE_TYPES.USER;\n  return PAGE_TYPES.TOP_LEVEL;\n};\n\n/**\n * Provider component for page framework\n */\nexport const PageProvider = ({ children, pageName }) => {\n  const params = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  \n  console.log('PageProvider: initialized with:', {\n    pageName,\n    params,\n    locationPathname: location.pathname\n  });\n  \n  const [pageState, setPageState] = useState({\n    type: determinePageType(params),\n    pageName,\n    loading: false,\n    error: null,\n    user: null,\n    profile: null,\n    repository: null,\n    branch: null,\n    asset: null,\n    isAuthenticated: githubService.isAuth()\n  });\n\n  // Extract URL parameters\n  const { user, repo } = params;\n  const asset = params['*']; // Wildcard parameter for asset path\n\n  // Load data based on page type\n  useEffect(() => {\n    const loadPageData = async () => {\n      try {\n        setPageState(prev => ({ ...prev, loading: true, error: null }));\n\n        // Use location state if available, otherwise fetch from URL params\n        let profile = location.state?.profile;\n        let repository = location.state?.repository;\n        let selectedBranch = location.state?.selectedBranch || params.branch;\n\n        // For DAK and Asset pages, validate and fetch data\n        if (pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n          if (!profile && user) {\n            if (githubService.isAuth()) {\n              try {\n                profile = await githubService.getUser(user);\n              } catch (err) {\n                // For dashboard pages, set error state instead of redirecting\n                if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                  setPageState(prev => ({\n                    ...prev,\n                    loading: false,\n                    error: `User '${user}' not found or not accessible. Please check the username and try again.`,\n                    user,\n                    // Still set available URL parameters for context\n                    repository: repo ? { name: repo, owner: { login: user }, html_url: `https://github.com/${user}/${repo}`, isNotFound: true } : null,\n                    branch: params.branch || 'main'\n                  }));\n                  return;\n                }\n                throw new Error(`User '${user}' not found or not accessible.`);\n              }\n            } else {\n              // Demo mode for DAK validation\n              const isValidDAK = dakValidationService.validateDemoDAKRepository(user, repo);\n              if (!isValidDAK) {\n                // For dashboard pages, set error state instead of redirecting\n                if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                  setPageState(prev => ({\n                    ...prev,\n                    loading: false,\n                    error: `Repository '${user}/${repo}' not found or not accessible. This may be a private repository or the repository doesn't exist.`,\n                    user,\n                    profile: {\n                      login: user,\n                      name: user.charAt(0).toUpperCase() + user.slice(1),\n                      avatar_url: `https://github.com/${user}.png`,\n                      type: 'User',\n                      isDemo: true\n                    },\n                    repository: { name: repo, owner: { login: user }, html_url: `https://github.com/${user}/${repo}`, isNotFound: true },\n                    branch: params.branch || 'main'\n                  }));\n                  return;\n                }\n                throw new Error(`Repository '${user}/${repo}' not found or not accessible.`);\n              }\n              profile = {\n                login: user,\n                name: user.charAt(0).toUpperCase() + user.slice(1),\n                avatar_url: `https://github.com/${user}.png`,\n                type: 'User',\n                isDemo: true\n              };\n            }\n          }\n\n          if (!repository && user && repo) {\n            if (githubService.isAuth()) {\n              try {\n                repository = await githubService.getRepository(user, repo);\n                // Validate it's a DAK repository\n                const isValidDAK = await dakValidationService.validateDAKRepository(user, repo, selectedBranch || repository.default_branch);\n                if (!isValidDAK) {\n                  // For dashboard pages, set error state instead of redirecting\n                  if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                    setPageState(prev => ({\n                      ...prev,\n                      loading: false,\n                      error: `Repository '${user}/${repo}' is not a valid DAK repository. This repository may not contain WHO SMART Guidelines content.`,\n                      user,\n                      profile,\n                      repository: { ...repository, isInvalidDAK: true },\n                      branch: selectedBranch || repository.default_branch\n                    }));\n                    return;\n                  }\n                  throw new Error(`Repository '${user}/${repo}' is not a valid DAK repository.`);\n                }\n              } catch (err) {\n                // For dashboard pages, set error state instead of redirecting\n                if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                  setPageState(prev => ({\n                    ...prev,\n                    loading: false,\n                    error: `Repository '${user}/${repo}' not found or not accessible. Please check the repository name and your access permissions.`,\n                    user,\n                    profile,\n                    repository: { name: repo, owner: { login: user }, html_url: `https://github.com/${user}/${repo}`, isNotFound: true },\n                    branch: selectedBranch || 'main'\n                  }));\n                  return;\n                }\n                throw new Error(`Repository '${user}/${repo}' not found or not accessible.`);\n              }\n            } else {\n              // For demo mode, validate the demo repository exists\n              const isValidDAK = dakValidationService.validateDemoDAKRepository(user, repo);\n              if (!isValidDAK) {\n                // For dashboard pages, set error state instead of redirecting\n                if (pageName === 'dashboard' || pageName.includes('editor') || pageName.includes('viewer') || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET) {\n                  setPageState(prev => ({\n                    ...prev,\n                    loading: false,\n                    error: `Repository '${user}/${repo}' not found or not accessible. This may be a private repository or the repository doesn't exist.`,\n                    user,\n                    profile: {\n                      login: user,\n                      name: user.charAt(0).toUpperCase() + user.slice(1),\n                      avatar_url: `https://github.com/${user}.png`,\n                      type: 'User',\n                      isDemo: true\n                    },\n                    repository: { name: repo, owner: { login: user }, html_url: `https://github.com/${user}/${repo}`, isNotFound: true },\n                    branch: selectedBranch || 'main'\n                  }));\n                  return;\n                }\n                throw new Error(`Repository '${user}/${repo}' not found or not accessible.`);\n              }\n              \n              repository = {\n                name: repo,\n                full_name: `${user}/${repo}`,\n                owner: { login: user },\n                default_branch: selectedBranch || 'main',\n                html_url: `https://github.com/${user}/${repo}`,\n                isDemo: true\n              };\n            }\n          }\n\n          selectedBranch = selectedBranch || repository?.default_branch || 'main';\n\n          // For asset pages, validate the asset exists (when authenticated or public repo)\n          if (pageState.type === PAGE_TYPES.ASSET && asset) {\n            try {\n              await githubService.getFileContent(user, repo, asset, selectedBranch);\n            } catch (err) {\n              // For asset pages, set error state instead of redirecting  \n              if (pageName === 'asset' || pageName.includes('editor') || pageName.includes('viewer')) {\n                setPageState(prev => ({\n                  ...prev,\n                  loading: false,\n                  error: `Asset '${asset}' not found in repository '${user}/${repo}'. The file may have been moved or deleted.`,\n                  user,\n                  profile,\n                  repository,\n                  branch: selectedBranch,\n                  asset\n                }));\n                return;\n              }\n              throw new Error(`Asset '${asset}' not found in repository.`);\n            }\n          }\n        }\n\n        // For User pages, just need profile\n        if (pageState.type === PAGE_TYPES.USER && !profile && user) {\n          if (githubService.isAuth()) {\n            try {\n              profile = await githubService.getUser(user);\n            } catch (err) {\n              // For user pages, set error state instead of redirecting\n              setPageState(prev => ({\n                ...prev,\n                loading: false,\n                error: `User '${user}' not found or not accessible. Please check the username and try again.`,\n                user\n              }));\n              return;\n            }\n          } else {\n            profile = {\n              login: user,\n              name: user.charAt(0).toUpperCase() + user.slice(1),\n              avatar_url: `https://github.com/${user}.png`,\n              type: 'User',\n              isDemo: true\n            };\n          }\n        }\n\n        setPageState(prev => ({\n          ...prev,\n          loading: false,\n          user,\n          profile,\n          repository,\n          branch: selectedBranch,\n          asset,\n          isAuthenticated: githubService.isAuth()\n        }));\n\n        // Handle profile subscriptions asynchronously\n        const handleSubscriptions = async () => {\n          try {\n            const currentUser = await githubService.getCurrentUser();\n            if (currentUser) {\n              profileSubscriptionService.ensureCurrentUserSubscribed(currentUser);\n            }\n          } catch (error) {\n            // Current user fetch failed, but continue with visited profile logic\n            console.debug('Could not fetch current user for subscriptions:', error);\n          }\n\n          // Auto-add visited profiles (if not demo and not already subscribed)\n          if (profile && !profile.isDemo && (pageState.type === PAGE_TYPES.USER || pageState.type === PAGE_TYPES.DAK || pageState.type === PAGE_TYPES.ASSET)) {\n            profileSubscriptionService.autoAddVisitedProfile(profile);\n          }\n        };\n\n        // Run subscription logic without blocking the main page load\n        if (githubService.isAuth()) {\n          handleSubscriptions();\n        }\n\n      } catch (error) {\n        console.error('Page data loading error:', error);\n        setPageState(prev => ({\n          ...prev,\n          loading: false,\n          error: error.message\n        }));\n      }\n    };\n\n    // Only load data if we have URL parameters that require it\n    if ((pageState.type !== PAGE_TYPES.TOP_LEVEL && user) || pageState.type === PAGE_TYPES.TOP_LEVEL) {\n      loadPageData();\n    }\n  }, [user, repo, params.branch, asset, pageState.type, location.state, navigate, pageName]);\n\n  // Monitor authentication state changes\n  useEffect(() => {\n    const checkAuthState = () => {\n      const currentAuthState = githubService.isAuth();\n      if (currentAuthState !== pageState.isAuthenticated) {\n        setPageState(prev => ({\n          ...prev,\n          isAuthenticated: currentAuthState\n        }));\n      }\n    };\n\n    // Check periodically for auth state changes (for logout detection)\n    const interval = setInterval(checkAuthState, 1000);\n    \n    return () => clearInterval(interval);\n  }, [pageState.isAuthenticated]);\n\n  const value = {\n    ...pageState,\n    navigate,\n    params,\n    location\n  };\n\n  return (\n    <PageContext.Provider value={value}>\n      {children}\n    </PageContext.Provider>\n  );\n};","/**\n * Utility function to get the appropriate image path based on the current theme\n * This can be used outside React components\n * @param {string} baseImagePath - The base image path (e.g., \"sgex-mascot.png\")\n * @returns {string} The theme-appropriate image path\n */\nexport const getThemeImagePath = (baseImagePath) => {\n  const isDarkMode = document.body.classList.contains('theme-dark');\n  \n  // Get the correct base path for the deployment environment\n  const publicUrl = process.env.PUBLIC_URL || '';\n  \n  // Normalize the base image path (remove leading slash if present)\n  const normalizedPath = baseImagePath.startsWith('/') ? baseImagePath.slice(1) : baseImagePath;\n  \n  let finalPath;\n  if (isDarkMode) {\n    // Convert base image to dark mode version\n    // e.g., \"sgex-mascot.png\" -> \"sgex-mascot_grey_tabby.png\"\n    const darkImageName = normalizedPath.replace(/\\.png$/, '_grey_tabby.png');\n    finalPath = publicUrl ? `${publicUrl}/${darkImageName}` : `/${darkImageName}`;\n  } else {\n    // Use original image for light mode\n    finalPath = publicUrl ? `${publicUrl}/${normalizedPath}` : `/${normalizedPath}`;\n  }\n  \n  return finalPath;\n};\n\nexport default getThemeImagePath;","/**\n * User Access Service\n * \n * Manages user types and access levels throughout the SGEX Workbench.\n * Supports three user types: authenticated, unauthenticated, and demo users.\n */\n\nimport githubService from './githubService';\nimport logger from '../utils/logger';\nimport { getThemeImagePath } from '../utils/themeUtils';\n\n/**\n * User types supported by the access framework\n */\nexport const USER_TYPES = {\n  AUTHENTICATED: 'authenticated',\n  UNAUTHENTICATED: 'unauthenticated', \n  DEMO: 'demo'\n};\n\n/**\n * Access levels for different operations\n */\nexport const ACCESS_LEVELS = {\n  READ: 'read',\n  WRITE: 'write',\n  NONE: 'none'\n};\n\nclass UserAccessService {\n  constructor() {\n    this.logger = logger.getLogger('UserAccessService');\n    this.currentUser = null;\n    this.userType = USER_TYPES.UNAUTHENTICATED;\n    this.permissions = new Map();\n    this.listeners = new Set();\n  }\n\n  /**\n   * Initialize user access service\n   */\n  async initialize() {\n    this.logger.info('Initializing user access service');\n    await this.detectUserType();\n    this.notifyListeners();\n  }\n\n  /**\n   * Detect current user type based on authentication state\n   */\n  async detectUserType() {\n    try {\n      if (githubService.isAuth()) {\n        // Check if this is a demo user (has demo DAKs configured)\n        const isDemoUser = this.checkIfDemoUser();\n        \n        if (isDemoUser) {\n          this.userType = USER_TYPES.DEMO;\n          this.currentUser = await this.createDemoUser();\n        } else {\n          this.userType = USER_TYPES.AUTHENTICATED;\n          this.currentUser = await githubService.getCurrentUser();\n        }\n      } else {\n        this.userType = USER_TYPES.UNAUTHENTICATED;\n        this.currentUser = null;\n      }\n\n      this.logger.info('User type detected', { \n        userType: this.userType, \n        hasUser: !!this.currentUser \n      });\n    } catch (error) {\n      this.logger.error('Error detecting user type', { error: error.message });\n      // Fallback to unauthenticated\n      this.userType = USER_TYPES.UNAUTHENTICATED;\n      this.currentUser = null;\n    }\n  }\n\n  /**\n   * Check if current authenticated user should be treated as demo user\n   */\n  checkIfDemoUser() {\n    // Demo users are determined by having access to demo DAKs\n    // This can be configured via localStorage or environment variables\n    const demoMode = localStorage.getItem('sgex_demo_mode');\n    const envDemoMode = process.env.REACT_APP_DEMO_MODE;\n    \n    return demoMode === 'true' || envDemoMode === 'true';\n  }\n\n  /**\n   * Create demo user object with demo data\n   */\n  async createDemoUser() {\n    try {\n      const realUser = await githubService.getCurrentUser();\n      return {\n        ...realUser,\n        isDemo: true,\n        demoData: this.getDemoData()\n      };\n    } catch (error) {\n      // If we can't get real user, create a synthetic demo user\n      return {\n        login: 'demo-user',\n        name: 'Demo User',\n        avatar_url: getThemeImagePath('sgex-mascot.png'),\n        type: 'User',\n        isDemo: true,\n        demoData: this.getDemoData()\n      };\n    }\n  }\n\n  /**\n   * Get demo data and DAKs\n   */\n  getDemoData() {\n    return {\n      daks: [\n        {\n          owner: 'WHO',\n          repo: 'smart-anc',\n          name: 'Smart Antenatal Care',\n          description: 'Demo DAK for antenatal care guidelines'\n        },\n        {\n          owner: 'WHO', \n          repo: 'smart-tb',\n          name: 'Smart Tuberculosis',\n          description: 'Demo DAK for tuberculosis care guidelines'\n        }\n      ],\n      sampleAssets: {\n        'input/vocabulary/ValueSet-anc-care-codes.json': {\n          type: 'ValueSet',\n          description: 'Demo value set for antenatal care'\n        }\n      }\n    };\n  }\n\n  /**\n   * Get current user type\n   */\n  getUserType() {\n    return this.userType;\n  }\n\n  /**\n   * Get current user information\n   */\n  getCurrentUser() {\n    return this.currentUser;\n  }\n\n  /**\n   * Check if user is authenticated (includes demo users)\n   */\n  isAuthenticated() {\n    return this.userType === USER_TYPES.AUTHENTICATED || this.userType === USER_TYPES.DEMO;\n  }\n\n  /**\n   * Check if user is in demo mode\n   */\n  isDemoUser() {\n    return this.userType === USER_TYPES.DEMO;\n  }\n\n  /**\n   * Check if user is unauthenticated\n   */\n  isUnauthenticated() {\n    return this.userType === USER_TYPES.UNAUTHENTICATED;\n  }\n\n  /**\n   * Get access level for a specific repository and operation\n   */\n  async getRepositoryAccess(owner, repo, branch = 'main') {\n    const cacheKey = `${owner}/${repo}/${branch}`;\n    \n    // Check cache first\n    if (this.permissions.has(cacheKey)) {\n      return this.permissions.get(cacheKey);\n    }\n\n    let access = ACCESS_LEVELS.NONE;\n\n    try {\n      if (this.userType === USER_TYPES.UNAUTHENTICATED) {\n        // Unauthenticated users only get read access to public repos\n        access = ACCESS_LEVELS.READ;\n      } else if (this.userType === USER_TYPES.DEMO) {\n        // Demo users get read access to demo DAKs, but no write access\n        const isDemoDAK = this.isDemoDAK(owner, repo);\n        access = isDemoDAK ? ACCESS_LEVELS.READ : ACCESS_LEVELS.NONE;\n      } else if (this.userType === USER_TYPES.AUTHENTICATED) {\n        // Authenticated users get access based on GitHub permissions\n        const hasReadAccess = await this.checkGitHubReadAccess(owner, repo);\n        const hasWriteAccess = await this.checkGitHubWriteAccess(owner, repo);\n        \n        if (hasWriteAccess) {\n          access = ACCESS_LEVELS.WRITE;\n        } else if (hasReadAccess) {\n          access = ACCESS_LEVELS.READ;\n        }\n      }\n    } catch (error) {\n      this.logger.error('Error checking repository access', { \n        owner, repo, branch, error: error.message \n      });\n      // Default to read access on error for better UX\n      access = ACCESS_LEVELS.READ;\n    }\n\n    // Cache the result\n    this.permissions.set(cacheKey, access);\n    \n    this.logger.debug('Repository access determined', { \n      owner, repo, branch, access, userType: this.userType \n    });\n\n    return access;\n  }\n\n  /**\n   * Check if a repository is a demo DAK\n   */\n  isDemoDAK(owner, repo) {\n    if (!this.currentUser?.demoData?.daks) {\n      return false;\n    }\n    \n    return this.currentUser.demoData.daks.some(dak => \n      dak.owner === owner && dak.repo === repo\n    );\n  }\n\n  /**\n   * Check GitHub read access for authenticated users\n   */\n  async checkGitHubReadAccess(owner, repo) {\n    try {\n      await githubService.getRepository(owner, repo);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Check GitHub write access for authenticated users\n   */\n  async checkGitHubWriteAccess(owner, repo) {\n    try {\n      return await githubService.hasRepositoryWriteAccess(owner, repo);\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Check if user can save to GitHub for a specific repository\n   */\n  async canSaveToGitHub(owner, repo, branch = 'main') {\n    // Demo users and unauthenticated users never have GitHub write access\n    if (this.userType !== USER_TYPES.AUTHENTICATED) {\n      return false;\n    }\n\n    const access = await this.getRepositoryAccess(owner, repo, branch);\n    return access === ACCESS_LEVELS.WRITE;\n  }\n\n  /**\n   * Check if user can save to local storage (staging ground)\n   */\n  canSaveLocal() {\n    // All user types can save to local storage\n    return true;\n  }\n\n  /**\n   * Get UI behavior configuration for current user type\n   */\n  getUIBehavior() {\n    const behavior = {\n      showEditFeatures: true,\n      showSaveToGitHub: true,\n      showSaveLocal: true,\n      confirmBeforeSave: true,\n      allowCreateNew: true,\n      showAccessBadges: true\n    };\n\n    switch (this.userType) {\n      case USER_TYPES.UNAUTHENTICATED:\n        return {\n          ...behavior,\n          showEditFeatures: false,\n          showSaveToGitHub: false,\n          allowCreateNew: false\n        };\n      \n      case USER_TYPES.DEMO:\n        return {\n          ...behavior,\n          showSaveToGitHub: false, // Demo users see the UI but get blocked at save\n          allowCreateNew: false\n        };\n      \n      case USER_TYPES.AUTHENTICATED:\n        return behavior;\n      \n      default:\n        return {\n          ...behavior,\n          showEditFeatures: false,\n          showSaveToGitHub: false,\n          allowCreateNew: false\n        };\n    }\n  }\n\n  /**\n   * Get access badge information for a repository\n   */\n  async getAccessBadge(owner, repo, branch = 'main') {\n    const access = await this.getRepositoryAccess(owner, repo, branch);\n    \n    const badges = {\n      [ACCESS_LEVELS.WRITE]: {\n        text: 'Write Access',\n        icon: '✏️',\n        color: 'green',\n        description: 'You can edit and save changes to this repository'\n      },\n      [ACCESS_LEVELS.READ]: {\n        text: 'Read Only',\n        icon: '👁️',\n        color: 'blue', \n        description: 'You can view this repository but cannot save changes'\n      },\n      [ACCESS_LEVELS.NONE]: {\n        text: 'No Access',\n        icon: '🚫',\n        color: 'red',\n        description: 'You do not have access to this repository'\n      }\n    };\n\n    return badges[access] || badges[ACCESS_LEVELS.NONE];\n  }\n\n  /**\n   * Enable demo mode for current user\n   */\n  enableDemoMode() {\n    localStorage.setItem('sgex_demo_mode', 'true');\n    this.initialize(); // Re-initialize to update user type\n  }\n\n  /**\n   * Disable demo mode\n   */\n  disableDemoMode() {\n    localStorage.removeItem('sgex_demo_mode');\n    this.initialize(); // Re-initialize to update user type\n  }\n\n  /**\n   * Clear cached permissions\n   */\n  clearPermissionsCache() {\n    this.permissions.clear();\n    this.logger.debug('Permissions cache cleared');\n  }\n\n  /**\n   * Add listener for user access changes\n   */\n  addListener(callback) {\n    this.listeners.add(callback);\n    \n    // Return unsubscribe function\n    return () => {\n      this.listeners.delete(callback);\n    };\n  }\n\n  /**\n   * Notify all listeners of changes\n   */\n  notifyListeners() {\n    const accessState = {\n      userType: this.userType,\n      currentUser: this.currentUser,\n      isAuthenticated: this.isAuthenticated(),\n      isDemoUser: this.isDemoUser(),\n      uiBehavior: this.getUIBehavior()\n    };\n\n    this.listeners.forEach(callback => {\n      try {\n        callback(accessState);\n      } catch (error) {\n        this.logger.error('Error in access service listener', { error: error.message });\n      }\n    });\n  }\n\n  /**\n   * Handle authentication state changes\n   */\n  handleAuthChange() {\n    this.clearPermissionsCache();\n    this.initialize();\n  }\n}\n\n// Create singleton instance\nconst userAccessService = new UserAccessService();\n\nexport default userAccessService;","/**\n * Bookmark Service - Manages user bookmarks in localStorage\n * \n * Provides functionality to bookmark pages with context-aware titles:\n * - DAK: {user}/{repo} for DAK pages\n * - DAK: {user}/{repo}/{branch} for DAK pages with specific branch  \n * - {asset} in DAK: {user}/{repo}/{branch} for asset pages\n */\nclass BookmarkService {\n  constructor() {\n    this.storageKey = 'sgex-bookmarks';\n  }\n\n  /**\n   * Get all bookmarks from localStorage\n   * @returns {Array} Array of bookmark objects\n   */\n  getBookmarks() {\n    try {\n      const stored = localStorage.getItem(this.storageKey);\n      return stored ? JSON.parse(stored) : [];\n    } catch (error) {\n      console.warn('Error reading bookmarks from localStorage:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Save bookmarks to localStorage\n   * @param {Array} bookmarks - Array of bookmark objects\n   */\n  saveBookmarks(bookmarks) {\n    try {\n      localStorage.setItem(this.storageKey, JSON.stringify(bookmarks));\n    } catch (error) {\n      console.error('Error saving bookmarks to localStorage:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Generate bookmark title based on page context\n   * @param {string} pageName - Name of the page\n   * @param {Object} context - Page context (user, repo, branch, asset)\n   * @returns {string} Generated bookmark title\n   */\n  generateBookmarkTitle(pageName, context) {\n    const { user, repository, branch, asset } = context;\n\n    // Asset pages: {asset} in DAK: {user}/{repo}/{branch}\n    if (asset && user && repository) {\n      const repoName = repository.name || repository;\n      const branchName = branch || 'main';\n      return `${asset} in DAK: ${user}/${repoName}/${branchName}`;\n    }\n\n    // DAK pages with branch: DAK: {user}/{repo}/{branch}\n    if (user && repository && branch) {\n      const repoName = repository.name || repository;\n      return `DAK: ${user}/${repoName}/${branch}`;\n    }\n\n    // DAK pages without specific branch: DAK: {user}/{repo}\n    if (user && repository) {\n      const repoName = repository.name || repository;\n      return `DAK: ${user}/${repoName}`;\n    }\n\n    // User pages: {pageName}: {user}\n    if (user) {\n      return `${pageName}: ${user}`;\n    }\n\n    // Top-level pages: just use page name\n    return pageName;\n  }\n\n  /**\n   * Add a bookmark\n   * @param {string} pageName - Name of the page\n   * @param {string} url - URL of the page\n   * @param {Object} context - Page context for generating title\n   * @returns {Object} The created bookmark\n   */\n  addBookmark(pageName, url, context = {}) {\n    const bookmarks = this.getBookmarks();\n    \n    // Check if bookmark already exists\n    const existingIndex = bookmarks.findIndex(b => b.url === url);\n    if (existingIndex !== -1) {\n      // Update existing bookmark\n      bookmarks[existingIndex] = {\n        ...bookmarks[existingIndex],\n        title: this.generateBookmarkTitle(pageName, context),\n        pageName,\n        context,\n        lastUpdated: new Date().toISOString()\n      };\n    } else {\n      // Create new bookmark\n      const bookmark = {\n        id: Date.now().toString(),\n        title: this.generateBookmarkTitle(pageName, context),\n        url,\n        pageName,\n        context,\n        createdAt: new Date().toISOString(),\n        lastUpdated: new Date().toISOString()\n      };\n      bookmarks.push(bookmark);\n    }\n\n    this.saveBookmarks(bookmarks);\n    return bookmarks[existingIndex] || bookmarks[bookmarks.length - 1];\n  }\n\n  /**\n   * Remove a bookmark by ID\n   * @param {string} bookmarkId - ID of the bookmark to remove\n   * @returns {boolean} Success status\n   */\n  removeBookmark(bookmarkId) {\n    try {\n      const bookmarks = this.getBookmarks();\n      const filteredBookmarks = bookmarks.filter(b => b.id !== bookmarkId);\n      \n      if (filteredBookmarks.length !== bookmarks.length) {\n        this.saveBookmarks(filteredBookmarks);\n        return true;\n      }\n      return false;\n    } catch (error) {\n      console.error('Error removing bookmark:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Check if current page is bookmarked\n   * @param {string} url - URL to check\n   * @returns {boolean} Whether the page is bookmarked\n   */\n  isBookmarked(url) {\n    const bookmarks = this.getBookmarks();\n    return bookmarks.some(b => b.url === url);\n  }\n\n  /**\n   * Get bookmark for a specific URL\n   * @param {string} url - URL to find\n   * @returns {Object|null} Bookmark object or null if not found\n   */\n  getBookmarkByUrl(url) {\n    const bookmarks = this.getBookmarks();\n    return bookmarks.find(b => b.url === url) || null;\n  }\n\n  /**\n   * Get bookmarks organized by page name (alphabetically)\n   * @returns {Object} Bookmarks grouped by page name\n   */\n  getBookmarksGroupedByPage() {\n    const bookmarks = this.getBookmarks();\n    const grouped = {};\n\n    bookmarks.forEach(bookmark => {\n      const pageName = bookmark.pageName || 'Other';\n      if (!grouped[pageName]) {\n        grouped[pageName] = [];\n      }\n      grouped[pageName].push(bookmark);\n    });\n\n    // Sort each group by title\n    Object.keys(grouped).forEach(pageName => {\n      grouped[pageName].sort((a, b) => a.title.localeCompare(b.title));\n    });\n\n    // Return as sorted array of objects\n    const sortedPages = Object.keys(grouped).sort();\n    return sortedPages.map(pageName => ({\n      pageName,\n      bookmarks: grouped[pageName]\n    }));\n  }\n\n  /**\n   * Clear all bookmarks\n   */\n  clearBookmarks() {\n    try {\n      localStorage.removeItem(this.storageKey);\n    } catch (error) {\n      console.error('Error clearing bookmarks:', error);\n    }\n  }\n\n  /**\n   * Export bookmarks as JSON\n   * @returns {string} JSON string of bookmarks\n   */\n  exportBookmarks() {\n    const bookmarks = this.getBookmarks();\n    return JSON.stringify(bookmarks, null, 2);\n  }\n\n  /**\n   * Import bookmarks from JSON\n   * @param {string} jsonString - JSON string of bookmarks\n   * @param {boolean} merge - Whether to merge with existing bookmarks\n   * @returns {boolean} Success status\n   */\n  importBookmarks(jsonString, merge = false) {\n    try {\n      const importedBookmarks = JSON.parse(jsonString);\n      \n      if (!Array.isArray(importedBookmarks)) {\n        throw new Error('Invalid bookmark format');\n      }\n\n      if (merge) {\n        const existingBookmarks = this.getBookmarks();\n        const mergedBookmarks = [...existingBookmarks];\n        \n        importedBookmarks.forEach(imported => {\n          const existingIndex = mergedBookmarks.findIndex(b => b.url === imported.url);\n          if (existingIndex !== -1) {\n            mergedBookmarks[existingIndex] = imported;\n          } else {\n            mergedBookmarks.push(imported);\n          }\n        });\n        \n        this.saveBookmarks(mergedBookmarks);\n      } else {\n        this.saveBookmarks(importedBookmarks);\n      }\n      \n      return true;\n    } catch (error) {\n      console.error('Error importing bookmarks:', error);\n      return false;\n    }\n  }\n}\n\n// Create and export singleton instance\nconst bookmarkService = new BookmarkService();\nexport default bookmarkService;","import React, { useState, useEffect, useRef } from 'react';\nimport githubService from '../services/githubService';\n\n/**\n * PreviewBadge component that displays when the app is deployed from a non-main branch\n * Shows branch name and links to the associated PR\n * Can expand to show detailed PR information, comments, and add new comments\n */\nconst PreviewBadge = () => {\n  const [branchInfo, setBranchInfo] = useState(null);\n  const [prInfo, setPrInfo] = useState([]); // Changed to array to support multiple PRs\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [isSticky, setIsSticky] = useState(false);\n  const expandedRef = useRef(null);\n\n  useEffect(() => {\n    const detectBranchAndPR = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n\n        // Detect current branch from environment or URL\n        const currentBranch = getCurrentBranch();\n        \n        if (!currentBranch || currentBranch === 'main') {\n          // Not a preview branch, don't show badge\n          setLoading(false);\n          return;\n        }\n\n        setBranchInfo({\n          name: currentBranch,\n          safeName: currentBranch.replace(/\\//g, '-')\n        });\n\n        // Try to fetch PR information for this branch\n        try {\n          const prData = await fetchPRsForBranch(currentBranch);\n          if (prData && prData.length > 0) {\n            setPrInfo(prData);\n          }\n        } catch (prError) {\n          console.debug('Could not fetch PR info:', prError);\n          // Continue without PR info - still show branch badge\n        }\n\n        setLoading(false);\n      } catch (err) {\n        console.error('Error detecting branch:', err);\n        setError(err.message);\n        setLoading(false);\n      }\n    };\n\n    detectBranchAndPR();\n  }, []);\n\n  // Handle clicks outside the expanded panel to close it (only if not sticky)\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (expandedRef.current && !expandedRef.current.contains(event.target)) {\n        if (isSticky) {\n          setIsSticky(false);\n        }\n        setIsExpanded(false);\n      }\n    };\n\n    if (isExpanded) {\n      // Listen for both mouse and touch events to support mobile devices\n      document.addEventListener('mousedown', handleClickOutside);\n      document.addEventListener('touchstart', handleClickOutside);\n      return () => {\n        document.removeEventListener('mousedown', handleClickOutside);\n        document.removeEventListener('touchstart', handleClickOutside);\n      };\n    }\n  }, [isExpanded, isSticky]);\n\n  const getCurrentBranch = () => {\n    // First try environment variable (set during build)\n    if (process.env.REACT_APP_GITHUB_REF_NAME) {\n      return process.env.REACT_APP_GITHUB_REF_NAME;\n    }\n    \n    // Fallback: detect from URL path\n    const path = window.location.pathname;\n    \n    // Match pattern: /sgex/{branch-name}/\n    const match = path.match(/^\\/sgex\\/([^/]+)\\//);\n    if (match && match[1] !== 'main') {\n      const safeBranchName = match[1];\n      \n      // Convert safe branch name back to original branch name\n      // This handles the common case where slashes are converted to dashes\n      // Note: This is a heuristic and may not be perfect for all edge cases\n      let branchName = safeBranchName;\n      \n      // Common patterns: feature-name -> feature/name, fix-123 -> fix/123\n      if (safeBranchName.includes('-') && !safeBranchName.startsWith('v') && !safeBranchName.match(/^\\d/)) {\n        // Try to detect if this looks like a feature branch\n        if (safeBranchName.match(/^(feature|fix|hotfix|bugfix|chore|docs|style|refactor|test)-/)) {\n          branchName = safeBranchName.replace(/^([^-]+)-/, '$1/');\n        }\n      }\n      \n      return branchName;\n    }\n\n    return null;\n  };\n\n  const fetchPRsForBranch = async (branchName) => {\n    try {\n      // Get current repository context if available\n      // For now, we'll use the main repository\n      const owner = 'litlfred';\n      const repo = 'sgex';\n\n      const prs = await githubService.getPullRequestsForBranch(owner, repo, branchName);\n      \n      return prs;\n\n    } catch (error) {\n      console.debug('Failed to fetch PR info:', error);\n      return [];\n    }\n  };\n\n  const handleBadgeClick = (pr) => {\n    if (pr && pr.html_url) {\n      window.open(pr.html_url, '_blank');\n    }\n  };\n\n  const handleMouseEnter = () => {\n    if (!isSticky && (!prInfo || prInfo.length === 0)) {\n      setIsExpanded(true);\n    }\n  };\n\n  const handleMouseLeave = () => {\n    if (!isSticky && (!prInfo || prInfo.length === 0)) {\n      setIsExpanded(false);\n    }\n  };\n\n  const handleBadgeToggle = (event) => {\n    // Only allow toggle for branch-only badges (no PRs)\n    if (prInfo && prInfo.length > 0) return;\n    \n    // Prevent event from bubbling up\n    event.stopPropagation();\n    event.preventDefault();\n    \n    if (isSticky) {\n      // If already sticky, collapse and remove sticky state\n      setIsSticky(false);\n      setIsExpanded(false);\n    } else {\n      // Make it sticky and ensure it's expanded\n      setIsSticky(true);\n      setIsExpanded(true);\n    }\n  };\n\n  const truncateTitle = (title, maxLength = 30) => {\n    if (title.length <= maxLength) return title;\n    return title.substring(0, maxLength) + '...';\n  };\n\n  // Don't render anything if loading, error, or not a preview branch\n  if (loading || error || !branchInfo) {\n    return null;\n  }\n\n  // Render multiple badges if there are multiple PRs\n  return (\n    <div className=\"preview-badge-container\" ref={expandedRef}>\n      {prInfo && prInfo.length > 0 ? (\n        // Multiple PR badges - each one is clickable and opens the corresponding PR\n        prInfo.map((pr, index) => (\n          <div \n            key={pr.id}\n            className=\"preview-badge clickable\"\n            onClick={() => handleBadgeClick(pr)}\n            title={`Click to view PR: ${pr.title}`}\n          >\n            <div className=\"badge-content\">\n              <span className=\"badge-label\">PR:</span>\n              <span className=\"badge-branch\">#{pr.number}</span>\n              <span className=\"badge-separator\">|</span>\n              <span className=\"badge-pr-title\">{truncateTitle(pr.title)}</span>\n            </div>\n          </div>\n        ))\n      ) : (\n        // Single expandable badge for branch with no PRs\n        <div \n          className={`preview-badge clickable ${isExpanded ? 'expanded' : ''} ${isSticky ? 'sticky' : ''}`}\n          onClick={handleBadgeToggle}\n          onMouseEnter={handleMouseEnter}\n          onMouseLeave={handleMouseLeave}\n          title={isSticky ? \"Click to collapse\" : isExpanded ? \"Click to keep expanded\" : `🔍 Hover for branch details, click to pin: ${branchInfo.name}`}\n        >\n          <div className=\"badge-content\">\n            <span className=\"badge-label\">Preview:</span>\n            <span className=\"badge-branch\">{branchInfo.name}</span>\n            <span className=\"badge-expand-icon\">{isExpanded ? '▼' : '▶'}</span>\n          </div>\n        </div>\n      )}\n\n      {isExpanded && (!prInfo || prInfo.length === 0) && (\n        <div className=\"preview-badge-expanded\">\n          <div className=\"expanded-header\">\n            <div className=\"pr-info\">\n              <h3>Preview Branch: {branchInfo.name}</h3>\n              <div className=\"pr-meta\">\n                <span className=\"pr-state\" data-state=\"unknown\">No PR found</span>\n                <span className=\"pr-author\">Branch preview</span>\n              </div>\n            </div>\n            <button \n              className=\"close-button\"\n              onClick={(e) => {\n                e.stopPropagation();\n                setIsExpanded(false);\n                setIsSticky(false);\n              }}\n              title=\"Close expanded view\"\n            >\n              ×\n            </button>\n          </div>\n\n          <div className=\"pr-description\">\n            <h4>Branch Information</h4>\n            <div className=\"pr-body\">\n              This is a preview deployment from the <code>{branchInfo.name}</code> branch.\n              <div style={{marginTop: '0.5rem'}}>\n                <strong>Preview URL:</strong> <code>{window.location.origin}{window.location.pathname}</code>\n              </div>\n              {!githubService.isAuth() ? (\n                <div style={{marginTop: '0.5rem', padding: '0.5rem', backgroundColor: '#f0f8ff', border: '1px solid #bee5eb', borderRadius: '4px'}}>\n                  <strong>💡 Tip:</strong> Sign in to GitHub to view pull request details, comments, and contribute to this branch.\n                </div>\n              ) : (\n                <div style={{marginTop: '0.5rem', color: '#28a745'}}>\n                  ✅ Authenticated - You can view full PR details when available.\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div className=\"expanded-footer\">\n            <a href={`https://github.com/litlfred/sgex/tree/${branchInfo.name}`} target=\"_blank\" rel=\"noopener noreferrer\" className=\"github-link\">\n              View Branch on GitHub →\n            </a>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PreviewBadge;","import React, { useState, useEffect } from 'react';\nimport { usePage } from './PageProvider';\nimport githubService from '../../services/githubService';\nimport userAccessService from '../../services/userAccessService';\nimport bookmarkService from '../../services/bookmarkService';\nimport PreviewBadge from '../PreviewBadge';\n\n/**\n * Consistent header component for all pages\n */\nconst PageHeader = () => {\n  const { \n    pageName, \n    profile, \n    repository, \n    branch, \n    asset,\n    isAuthenticated,\n    navigate \n  } = usePage();\n\n  const [showUserDropdown, setShowUserDropdown] = useState(false);\n  const [showBookmarkDropdown, setShowBookmarkDropdown] = useState(false);\n  const [authenticatedUser, setAuthenticatedUser] = useState(null);\n\n  // Always fetch the authenticated user for login button display\n  useEffect(() => {\n    if (isAuthenticated) {\n      const fetchAuthenticatedUser = async () => {\n        try {\n          // Use userAccessService to get the current user (handles both authenticated and demo users)\n          const user = userAccessService.getCurrentUser();\n          if (user) {\n            setAuthenticatedUser(user);\n          } else {\n            // Fallback to githubService for backwards compatibility\n            const githubUser = await githubService.getCurrentUser();\n            setAuthenticatedUser(githubUser);\n          }\n        } catch (error) {\n          console.debug('Could not fetch authenticated user:', error);\n        }\n      };\n      \n      fetchAuthenticatedUser();\n    } else {\n      setAuthenticatedUser(null);\n    }\n  }, [isAuthenticated]);\n\n  const handleLogout = () => {\n    githubService.logout();\n    navigate('/');\n  };\n\n  const handleHomeNavigation = () => {\n    navigate('/');\n  };\n\n  const handleGitHubUser = () => {\n    // Always navigate to the authenticated user's GitHub profile, not the DAK owner's\n    if (authenticatedUser?.html_url) {\n      window.open(authenticatedUser.html_url, '_blank');\n    } else if (authenticatedUser?.login) {\n      window.open(`https://github.com/${authenticatedUser.login}`, '_blank');\n    }\n  };\n\n  const handleBookmarkCurrentPage = () => {\n    const context = {\n      user: authenticatedUser?.login, // Use authenticated user for bookmarks\n      repository,\n      branch,\n      asset\n    };\n    \n    const currentUrl = window.location.pathname;\n    bookmarkService.addBookmark(pageName, currentUrl, context);\n    setShowBookmarkDropdown(false);\n  };\n\n  const handleRemoveBookmark = (bookmarkId) => {\n    bookmarkService.removeBookmark(bookmarkId);\n    // Force re-render by toggling dropdown\n    setShowBookmarkDropdown(false);\n    setTimeout(() => setShowBookmarkDropdown(true), 50);\n  };\n\n  const handleBookmarkNavigation = (bookmark) => {\n    navigate(bookmark.url);\n    setShowBookmarkDropdown(false);\n  };\n\n  const getCurrentPageBookmark = () => {\n    return bookmarkService.getBookmarkByUrl(window.location.pathname);\n  };\n\n  const getBookmarksGrouped = () => {\n    return bookmarkService.getBookmarksGroupedByPage();\n  };\n\n  const currentBookmark = getCurrentPageBookmark();\n  const bookmarksGrouped = getBookmarksGrouped();\n\n  return (\n    <header className=\"page-header\">\n      {/* Left side - Logo and context */}\n      <div className=\"page-header-left\">\n        <div className=\"sgex-logo\" onClick={handleHomeNavigation}>\n          <h1>SGEX Workbench</h1>\n          <p className=\"subtitle\">WHO SMART Guidelines Exchange</p>\n        </div>\n        \n        {/* Preview badge for non-main branches */}\n        <PreviewBadge />\n      </div>\n\n      {/* Right side - Navigation and user controls */}\n      <div className=\"page-header-right\">\n        {/* User info and controls */}\n        {(isAuthenticated || profile?.isDemo) && authenticatedUser ? (\n          <div className=\"user-controls\">\n            <div className=\"user-info\" onClick={() => setShowUserDropdown(!showUserDropdown)}>\n              <img src={authenticatedUser.avatar_url} alt=\"User avatar\" className=\"user-avatar\" />\n              <span className=\"user-name\">{authenticatedUser.name || authenticatedUser.login}</span>\n              <span className=\"dropdown-arrow\">▼</span>\n            </div>\n            {showUserDropdown && (\n              <div className=\"user-dropdown\">\n                <button className=\"dropdown-item\" onClick={handleGitHubUser}>\n                  <svg className=\"github-icon\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\">\n                    <path d=\"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z\"/>\n                  </svg>\n                  GitHub Profile\n                </button>\n                \n                {/* Add/Remove current page bookmark - moved to same level as bookmarks */}\n                {currentBookmark ? (\n                  <button \n                    className=\"dropdown-item bookmark-action\"\n                    onClick={() => handleRemoveBookmark(currentBookmark.id)}\n                  >\n                    ⭐ Remove Bookmark\n                  </button>\n                ) : (\n                  <button \n                    className=\"dropdown-item bookmark-action\"\n                    onClick={handleBookmarkCurrentPage}\n                  >\n                    ☆ Add Bookmark\n                  </button>\n                )}\n                \n                {/* Bookmarks submenu */}\n                <div className=\"bookmarks-section\">\n                  <div className=\"dropdown-item bookmarks-header\" onClick={() => setShowBookmarkDropdown(!showBookmarkDropdown)}>\n                    📖 Bookmarks\n                    <span className=\"dropdown-arrow\">{showBookmarkDropdown ? '▲' : '▼'}</span>\n                  </div>\n                  \n                  {showBookmarkDropdown && (\n                    <div className=\"bookmarks-dropdown\">\n                      {/* Bookmarks list grouped by page */}\n                      {bookmarksGrouped.length > 0 ? (\n                        <div className=\"bookmarks-list\">\n                          {bookmarksGrouped.map(group => (\n                            <div key={group.pageName} className=\"bookmark-group\">\n                              <div className=\"bookmark-group-header\">{group.pageName}</div>\n                              {group.bookmarks.map(bookmark => (\n                                <div key={bookmark.id} className=\"bookmark-item\">\n                                  <button \n                                    className=\"bookmark-link\"\n                                    onClick={() => handleBookmarkNavigation(bookmark)}\n                                    title={bookmark.url}\n                                  >\n                                    {bookmark.title}\n                                  </button>\n                                  <button \n                                    className=\"bookmark-remove\"\n                                    onClick={() => handleRemoveBookmark(bookmark.id)}\n                                    title=\"Remove bookmark\"\n                                  >\n                                    ×\n                                  </button>\n                                </div>\n                              ))}\n                            </div>\n                          ))}\n                        </div>\n                      ) : (\n                        <div className=\"no-bookmarks\">No bookmarks yet</div>\n                      )}\n                    </div>\n                  )}\n                </div>\n                \n                <button className=\"dropdown-item logout-btn\" onClick={handleLogout}>\n                  Logout\n                </button>\n              </div>\n            )}\n          </div>\n        ) : (\n          <button className=\"login-btn\" onClick={handleHomeNavigation}>\n            Login\n          </button>\n        )}\n      </div>\n    </header>\n  );\n};\n\nexport default PageHeader;","import React, { useState, useEffect } from 'react';\nimport userAccessService from '../../services/userAccessService';\n\n/**\n * Access Badge Component\n * \n * Displays user's access level (read/write) for the current repository\n * Shows in the title bar with dynamic styling based on permissions\n */\nconst AccessBadge = ({ owner, repo, branch = 'main', className = '' }) => {\n  const [badge, setBadge] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showTooltip, setShowTooltip] = useState(false);\n\n  useEffect(() => {\n    let mounted = true;\n\n    const loadBadge = async () => {\n      if (!owner || !repo) {\n        setLoading(false);\n        return;\n      }\n\n      try {\n        setLoading(true);\n        const badgeInfo = await userAccessService.getAccessBadge(owner, repo, branch);\n        \n        if (mounted) {\n          setBadge(badgeInfo);\n          setLoading(false);\n        }\n      } catch (error) {\n        console.error('Error loading access badge:', error);\n        if (mounted) {\n          setBadge({\n            text: 'Unknown',\n            icon: '❓',\n            color: 'gray',\n            description: 'Unable to determine access level'\n          });\n          setLoading(false);\n        }\n      }\n    };\n\n    loadBadge();\n\n    // Listen for access changes\n    const unsubscribe = userAccessService.addListener(() => {\n      loadBadge();\n    });\n\n    return () => {\n      mounted = false;\n      unsubscribe();\n    };\n  }, [owner, repo, branch]);\n\n  if (loading) {\n    return (\n      <div className={`access-badge loading ${className}`}>\n        <span className=\"access-badge-icon\">⏳</span>\n        <span className=\"access-badge-text\">Loading...</span>\n      </div>\n    );\n  }\n\n  if (!badge) {\n    return null;\n  }\n\n  return (\n    <div \n      className={`access-badge ${badge.color} ${className}`}\n      onMouseEnter={() => setShowTooltip(true)}\n      onMouseLeave={() => setShowTooltip(false)}\n      title={badge.description}\n    >\n      <span className=\"access-badge-icon\" role=\"img\" aria-label={badge.text}>\n        {badge.icon}\n      </span>\n      <span className=\"access-badge-text\">\n        {badge.text}\n      </span>\n      \n      {showTooltip && (\n        <div className=\"access-badge-tooltip\">\n          <div className=\"tooltip-content\">\n            <strong>{badge.text}</strong>\n            <p>{badge.description}</p>\n            {repo && (\n              <small>Repository: {owner}/{repo}</small>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AccessBadge;","import React, { useState, useEffect } from 'react';\nimport { usePage, PAGE_TYPES } from './PageProvider';\nimport AccessBadge from './AccessBadge';\nimport githubService from '../../services/githubService';\n\n/**\n * Page context component that displays profile/repo/branch information and breadcrumbs\n * Unified navigation component with avatar on left and two-row content on right\n */\nconst PageContext = ({ customBreadcrumbs }) => {\n  const { \n    type, \n    pageName,\n    profile, \n    repository, \n    branch,\n    navigate \n  } = usePage();\n\n  // Branch selector state\n  const [branches, setBranches] = useState([]);\n  const [showBranchDropdown, setShowBranchDropdown] = useState(false);\n  const [branchSearchTerm, setBranchSearchTerm] = useState('');\n  const [loadingBranches, setLoadingBranches] = useState(false);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (showBranchDropdown && !event.target.closest('.page-context-branch-selector')) {\n        setShowBranchDropdown(false);\n        setBranchSearchTerm('');\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showBranchDropdown]);\n\n  // Fetch branches when repository changes\n  useEffect(() => {\n    const fetchBranches = async () => {\n      if (!repository || !(type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET)) {\n        setBranches([]);\n        return;\n      }\n\n      try {\n        setLoadingBranches(true);\n        const owner = repository.owner?.login || repository.full_name?.split('/')[0];\n        const branchData = await githubService.getBranches(owner, repository.name);\n        \n        // Sort branches alphabetically as requested\n        const sortedBranches = branchData.sort((a, b) => a.name.localeCompare(b.name));\n        setBranches(sortedBranches);\n      } catch (error) {\n        console.error('Failed to fetch branches for context:', error);\n        setBranches([]);\n      } finally {\n        setLoadingBranches(false);\n      }\n    };\n\n    fetchBranches();\n  }, [repository, type]);\n\n  const handleBranchChange = (newBranch) => {\n    // Update URL with new branch\n    const currentPath = window.location.pathname;\n    const pathParts = currentPath.split('/');\n    \n    // URL structure: /sgex/dashboard/{user}/{repo}/{branch}\n    // After splitting: ['', 'sgex', 'dashboard', '{user}', '{repo}', '{branch}']\n    // So branch is at index 5 when including the empty string at index 0\n    if (pathParts.length >= 5) {\n      if (pathParts.length === 5) {\n        // No branch in URL, append it\n        pathParts.push(newBranch);\n      } else {\n        // Branch exists, replace it\n        pathParts[5] = newBranch;\n      }\n      navigate(pathParts.join('/'));\n    }\n    setShowBranchDropdown(false);\n    setBranchSearchTerm('');\n  };\n\n  // Filter branches based on search term\n  const filteredBranches = branches.filter(b => \n    b.name.toLowerCase().includes(branchSearchTerm.toLowerCase())\n  );\n\n  const handleGitHubRepo = () => {\n    if (repository?.html_url) {\n      window.open(repository.html_url, '_blank');\n    }\n  };\n\n  const handleGitHubUser = () => {\n    if (profile?.html_url) {\n      window.open(profile.html_url, '_blank');\n    } else if (profile?.login) {\n      window.open(`https://github.com/${profile.login}`, '_blank');\n    }\n  };\n\n  // Generate breadcrumbs\n  const getBreadcrumbs = () => {\n    // If custom breadcrumbs are provided, use them\n    if (customBreadcrumbs && customBreadcrumbs.length > 0) {\n      return customBreadcrumbs;\n    }\n\n    // Generate automatic breadcrumbs based on page type\n    const breadcrumbs = [];\n\n    // Always start with home\n    breadcrumbs.push({\n      label: 'Home',\n      path: '/',\n      onClick: () => navigate('/')\n    });\n\n    // Add user context for user/DAK/asset pages\n    if ((type === PAGE_TYPES.USER || type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) && profile) {\n      breadcrumbs.push({\n        label: 'Select Repository',\n        path: `/dak-selection/${profile.login}`,\n        onClick: () => navigate(`/dak-selection/${profile.login}`, { state: { profile } })\n      });\n    }\n\n    // Add DAK context for DAK/asset pages\n    if ((type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) && repository) {\n      const branchPath = branch && branch !== 'main' ? `/${branch}` : '';\n      const ownerLogin = repository.owner?.login || repository.full_name?.split('/')[0];\n      if (ownerLogin) {\n        breadcrumbs.push({\n          label: 'DAK Components',\n          path: `/dashboard/${ownerLogin}/${repository.name}${branchPath}`,\n          onClick: () => navigate(`/dashboard/${ownerLogin}/${repository.name}${branchPath}`)\n        });\n      }\n    }\n\n    // Add current page context\n    const pageLabels = {\n      'landing': 'Home',\n      'landing-unauthenticated': 'Home',\n      'repositories': 'Select Repository', \n      'dak-selection': 'Select DAK',\n      'dak-action': 'Choose DAK Action',\n      'dashboard': 'DAK Components',\n      'dak-dashboard': 'DAK Components',\n      'actor-editor': 'Actor Definitions',\n      'component-editor': 'Component Editor',\n      'bpmn-viewer': 'Business Process Viewer',\n      'bpmn-editor': 'Business Process Editor',\n      'decision-support-logic': 'Decision Support Logic',\n      'core-data-dictionary-viewer': 'Core Data Dictionary',\n      'testing-viewer': 'Testing',\n      'pages-manager': 'Pages',\n      'documentation': 'Documentation'\n    };\n\n    const currentPageLabel = pageLabels[pageName] || pageName;\n    \n    // Don't add duplicate page labels\n    if (breadcrumbs.length === 0 || breadcrumbs[breadcrumbs.length - 1].label !== currentPageLabel) {\n      breadcrumbs.push({\n        label: currentPageLabel,\n        current: true\n      });\n    }\n\n    return breadcrumbs;\n  };\n\n  const breadcrumbs = getBreadcrumbs();\n\n  // Don't render if no context information to show\n  if (!profile && !repository && breadcrumbs.length <= 1) {\n    return null;\n  }\n\n  return (\n    <div className=\"page-context-container\">\n      <div className=\"page-context-content\">\n        {/* Avatar positioned to the far left */}\n        {profile && (\n          <img src={profile.avatar_url} alt={`${profile.login} avatar`} className=\"page-context-avatar\" />\n        )}\n        \n        <div className=\"page-context-info\">\n          {/* First row: Profile / Repository / Branch */}\n          <div className=\"page-context-row page-context-user-repo\">\n            {profile && (\n              <>\n                <span className=\"page-context-profile\" onClick={handleGitHubUser}>\n                  {profile.login}\n                </span>\n                {repository && <span className=\"page-context-separator\">/</span>}\n              </>\n            )}\n            {repository && (\n              <span className=\"page-context-repo\">\n                {repository.name}\n              </span>\n            )}\n            {branch && (type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) && (\n              <>\n                <span className=\"page-context-separator\">@</span>\n                <div className=\"page-context-branch-selector\">\n                  <button \n                    className=\"page-context-branch-btn\"\n                    onClick={() => setShowBranchDropdown(!showBranchDropdown)}\n                    title=\"Switch branch\"\n                  >\n                    <span className=\"branch-icon\">🌿</span>\n                    {branch}\n                    <span className=\"branch-dropdown-arrow\">{showBranchDropdown ? '▲' : '▼'}</span>\n                  </button>\n                  \n                  {showBranchDropdown && (\n                    <div className=\"branch-dropdown\">\n                      <div className=\"branch-search\">\n                        <input\n                          type=\"text\"\n                          placeholder=\"Search branches...\"\n                          value={branchSearchTerm}\n                          onChange={(e) => setBranchSearchTerm(e.target.value)}\n                          className=\"branch-search-input\"\n                          autoFocus\n                        />\n                      </div>\n                      <div className=\"branch-list\">\n                        {loadingBranches ? (\n                          <div className=\"branch-item loading\">Loading branches...</div>\n                        ) : filteredBranches.length > 0 ? (\n                          filteredBranches.map((b) => (\n                            <button\n                              key={b.name}\n                              className={`branch-item ${b.name === branch ? 'current' : ''}`}\n                              onClick={() => handleBranchChange(b.name)}\n                            >\n                              <span className=\"branch-icon\">🌿</span>\n                              {b.name}\n                              {b.name === branch && <span className=\"current-badge\">current</span>}\n                            </button>\n                          ))\n                        ) : (\n                          <div className=\"branch-item no-results\">\n                            {branchSearchTerm ? 'No branches found' : 'No branches available'}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </>\n            )}\n          </div>\n          \n          {/* Second row: Breadcrumbs */}\n          {breadcrumbs.length > 1 && (\n            <nav className=\"page-context-row page-context-breadcrumbs\" aria-label=\"Breadcrumb navigation\">\n              <ol className=\"breadcrumb-list\">\n                {breadcrumbs.map((crumb, index) => (\n                  <li key={index} className=\"breadcrumb-item\">\n                    {!crumb.current ? (\n                      <>\n                        <button \n                          className=\"breadcrumb-link\" \n                          onClick={() => crumb.onClick ? crumb.onClick() : navigate(crumb.path)}\n                          aria-label={`Navigate to ${crumb.label}`}\n                        >\n                          {crumb.label}\n                        </button>\n                        <span className=\"breadcrumb-separator\" aria-hidden=\"true\">›</span>\n                      </>\n                    ) : (\n                      <span className=\"breadcrumb-current\" aria-current=\"page\">\n                        {crumb.label}\n                      </span>\n                    )}\n                  </li>\n                ))}\n              </ol>\n            </nav>\n          )}\n        </div>\n        \n        {/* Actions area for DAK and Asset pages */}\n        {(type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) && repository && (\n          <div className=\"page-context-actions\">\n            {/* Access badge */}\n            <AccessBadge \n              owner={repository.owner?.login || profile?.login}\n              repo={repository.name}\n              branch={branch}\n              className=\"context-access-badge\"\n            />\n            {/* GitHub repository button */}\n            <button className=\"context-btn github-repo-btn\" onClick={handleGitHubRepo} title=\"Open repository on GitHub\">\n              <svg className=\"github-icon\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\">\n                <path d=\"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z\"/>\n              </svg>\n              Repository\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default PageContext;","import React, { useState } from 'react';\nimport { usePage } from './PageProvider';\nimport ContextualHelpMascot from '../ContextualHelpMascot';\nimport useThemeImage from '../../hooks/useThemeImage';\n\n/**\n * Error handler component with automatic bug reporting functionality\n */\nconst ErrorHandler = ({ error, onRetry }) => {\n  const pageContext = usePage();\n  const pageName = pageContext.pageName;\n  const [bugReportSent, setBugReportSent] = useState(false);\n\n  // Theme-aware mascot image\n  const mascotImage = useThemeImage('sgex-mascot.png');\n  const [userExplanation, setUserExplanation] = useState('');\n\n  const generateBugReportUrl = () => {\n    const title = encodeURIComponent('User should not have reached this page');\n    const body = encodeURIComponent(`\n**Error Information:**\n- Page: ${pageName}\n- URL: ${window.location.href}\n- Error: ${error}\n- Timestamp: ${new Date().toISOString()}\n- User Agent: ${navigator.userAgent}\n\n**Context:**\n- Browser: ${navigator.userAgent}\n- Viewport: ${window.innerWidth}x${window.innerHeight}\n- Referrer: ${document.referrer || 'Direct access'}\n\n**User Explanation:**\n${userExplanation || 'No additional details provided'}\n\n**Steps to Reproduce:**\n1. Navigate to: ${window.location.href}\n2. [Please add any additional steps]\n\n**Expected Behavior:**\nThe page should load without errors.\n\n**Actual Behavior:**\n${error}\n    `);\n\n    return `https://github.com/litlfred/sgex/issues/new?title=${title}&body=${body}&labels=bug,user-error`;\n  };\n\n  const handleSendBugReport = () => {\n    const bugReportUrl = generateBugReportUrl();\n    window.open(bugReportUrl, '_blank');\n    setBugReportSent(true);\n  };\n\n  const handleRetry = () => {\n    if (onRetry) {\n      onRetry();\n    } else {\n      window.location.reload();\n    }\n  };\n\n  const handleGoHome = () => {\n    window.location.href = '/sgex/';\n  };\n\n  // Enhanced error message generation for DAK-specific errors\n  const getErrorDisplayInfo = () => {\n    const lowercaseError = error.toLowerCase();\n    \n    // Extract user/repo from URL or page context\n    const user = pageContext?.user;\n    const repo = pageContext?.repository?.name;\n    \n    if (lowercaseError.includes('not found') || lowercaseError.includes('not accessible')) {\n      if (lowercaseError.includes('user')) {\n        return {\n          title: 'User Not Found',\n          message: `The user ${user ? `'${user}'` : 'in the URL'} could not be found on GitHub.`,\n          suggestions: [\n            'Check the spelling of the username',\n            'Verify the user account exists on GitHub',\n            'Try searching for the user on GitHub.com'\n          ],\n          icon: '👤'\n        };\n      } else if (lowercaseError.includes('repository')) {\n        return {\n          title: 'Repository Not Found',\n          message: `The repository ${user && repo ? `'${user}/${repo}'` : 'in the URL'} could not be accessed.`,\n          suggestions: [\n            'Check the spelling of the repository name',\n            'Verify the repository exists and is public',\n            'If it\\'s a private repository, make sure you have access',\n            'Try visiting the repository directly on GitHub.com'\n          ],\n          icon: '📁'\n        };\n      }\n    }\n    \n    if (lowercaseError.includes('not a valid dak') || lowercaseError.includes('invalid dak')) {\n      return {\n        title: 'Not a DAK Repository',\n        message: `The repository ${user && repo ? `'${user}/${repo}'` : 'in the URL'} doesn't appear to contain WHO SMART Guidelines content.`,\n        suggestions: [\n          'Verify this is a WHO SMART Guidelines Digital Adaptation Kit',\n          'Check if the repository has a sushi-config.yaml file',\n          'Look for smart.who.int.base dependencies in the configuration',\n          'Try browsing other DAK repositories for examples'\n        ],\n        icon: '📋'\n      };\n    }\n    \n    if (lowercaseError.includes('asset') && lowercaseError.includes('not found')) {\n      return {\n        title: 'File Not Found',\n        message: `The requested file could not be found in the repository.`,\n        suggestions: [\n          'Check if the file path is correct',\n          'Verify the file exists in the current branch',\n          'The file may have been moved or deleted',\n          'Try browsing the repository to find the correct path'\n        ],\n        icon: '📄'\n      };\n    }\n    \n    // Default error info\n    return {\n      title: 'Something Went Wrong',\n      message: error,\n      suggestions: [\n        'Try refreshing the page',\n        'Check your internet connection',\n        'The service may be temporarily unavailable'\n      ],\n      icon: '⚠️'\n    };\n  };\n\n  const errorInfo = getErrorDisplayInfo();\n\n  return (\n    <div className=\"error-handler\">\n      <div className=\"error-content\">\n        <div className=\"error-mascot-container\">\n          <ContextualHelpMascot\n            helpContent={\n              <div className=\"error-help-content\">\n                <div className=\"error-mascot-large\">\n                  <img \n                    src={mascotImage} \n                    alt=\"SGEX Helper\" \n                    className=\"large-mascot-icon\"\n                  />\n                  <div className=\"mascot-speech-bubble\">\n                    <div className=\"speech-content\">\n                      I'm sorry! Something went wrong.\n                    </div>\n                    <div className=\"speech-tail\"></div>\n                  </div>\n                </div>\n              </div>\n            }\n            position=\"center\"\n          />\n        </div>\n        \n        <div className=\"error-details\">\n          <h2>{errorInfo.icon} {errorInfo.title}</h2>\n          <p className=\"error-message\">{errorInfo.message}</p>\n          \n          {errorInfo.suggestions && (\n            <div className=\"error-suggestions\">\n              <h3>💡 Suggestions:</h3>\n              <ul>\n                {errorInfo.suggestions.map((suggestion, index) => (\n                  <li key={index}>{suggestion}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n          \n          <div className=\"error-actions\">\n            <button className=\"error-btn primary\" onClick={handleRetry}>\n              🔄 Try Again\n            </button>\n            <button className=\"error-btn secondary\" onClick={handleGoHome}>\n              🏠 Go Home\n            </button>\n          </div>\n          \n          <div className=\"bug-report-section\">\n            <h3>Help us improve SGEX</h3>\n            <p>If this error persists, please let us know what happened:</p>\n            \n            <div className=\"user-explanation\">\n              <label htmlFor=\"user-explanation\">\n                What were you trying to do when this error occurred?\n              </label>\n              <textarea\n                id=\"user-explanation\"\n                value={userExplanation}\n                onChange={(e) => setUserExplanation(e.target.value)}\n                placeholder=\"Please describe what you were doing when the error occurred...\"\n                rows={4}\n              />\n            </div>\n            \n            {!bugReportSent ? (\n              <button className=\"bug-report-btn\" onClick={handleSendBugReport}>\n                📧 Send Bug Report\n              </button>\n            ) : (\n              <div className=\"bug-report-sent\">\n                <span className=\"success-icon\">✅</span>\n                Thank you! A bug report has been opened. We'll investigate this issue.\n              </div>\n            )}\n          </div>\n          \n          <div className=\"error-context\">\n            <details>\n              <summary>Technical Details</summary>\n              <div className=\"technical-details\">\n                <p><strong>Page:</strong> {pageName}</p>\n                <p><strong>URL:</strong> {window.location.href}</p>\n                <p><strong>Error:</strong> {error}</p>\n                <p><strong>Timestamp:</strong> {new Date().toISOString()}</p>\n              </div>\n            </details>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ErrorHandler;","import React from 'react';\nimport { PageProvider, usePage } from './PageProvider';\nimport PageHeader from './PageHeader';\nimport PageContext from './PageContext';\nimport ErrorHandler from './ErrorHandler';\nimport ContextualHelpMascot from '../ContextualHelpMascot';\n\n/**\n * Error boundary wrapper for catching React errors\n */\nclass PageErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false, error: null };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true, error: error.message };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error('PageLayout caught an error:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"page-layout-error\">\n          <ErrorHandler \n            error={this.state.error}\n            onRetry={() => {\n              this.setState({ hasError: false, error: null });\n              window.location.reload();\n            }}\n          />\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\n/**\n * Inner layout component that uses page context\n */\nconst PageLayoutInner = ({ \n  children, \n  showHeader = true, \n  showMascot = true, \n  showBreadcrumbs = true, \n  customBreadcrumbs \n}) => {\n  const { loading, error, pageName } = usePage();\n\n  // Show loading state\n  if (loading) {\n    return (\n      <div className=\"page-layout\">\n        {showHeader && <PageHeader />}\n        <main className=\"page-main\">\n          <div className=\"page-loading\">\n            <div className=\"loading-spinner\"></div>\n            <p>Loading...</p>\n          </div>\n        </main>\n        {showMascot && (\n          <ContextualHelpMascot \n            pageId={`${pageName}-loading`}\n            position=\"bottom-right\"\n          />\n        )}\n      </div>\n    );\n  }\n\n  // Show error state\n  if (error) {\n    return (\n      <div className=\"page-layout\">\n        {showHeader && <PageHeader />}\n        <main className=\"page-main\">\n          <ErrorHandler \n            error={error}\n            onRetry={() => window.location.reload()}\n          />\n        </main>\n      </div>\n    );\n  }\n\n  // Show normal page content\n  return (\n    <div className=\"page-layout\">\n      {showHeader && <PageHeader />}\n      <PageContext customBreadcrumbs={showBreadcrumbs ? customBreadcrumbs : []} />\n      <main className=\"page-main\">\n        {children}\n        {showMascot && (\n          <ContextualHelpMascot \n            pageId={pageName}\n            position=\"bottom-right\"\n            contextData={{}}\n          />\n        )}\n      </main>\n    </div>\n  );\n};\n\n/**\n * Main page layout component with framework integration\n */\nconst PageLayout = ({ \n  children, \n  pageName, \n  showHeader = true, \n  showMascot = true,\n  showBreadcrumbs = true,\n  customBreadcrumbs\n}) => {\n  return (\n    <PageErrorBoundary>\n      <PageProvider pageName={pageName}>\n        <PageLayoutInner \n          showHeader={showHeader} \n          showMascot={showMascot}\n          showBreadcrumbs={showBreadcrumbs}\n          customBreadcrumbs={customBreadcrumbs}\n        >\n          {children}\n        </PageLayoutInner>\n      </PageProvider>\n    </PageErrorBoundary>\n  );\n};\n\nexport default PageLayout;","import { usePage, PAGE_TYPES } from './PageProvider';\n\n/**\n * Hook for accessing URL parameters in a type-safe way\n */\nexport const usePageParams = () => {\n  const { type, user, profile, repository, branch, asset, params, navigate } = usePage();\n\n  const updateBranch = (newBranch) => {\n    if (type === PAGE_TYPES.DAK || type === PAGE_TYPES.ASSET) {\n      const currentPath = window.location.pathname;\n      const pathParts = currentPath.split('/');\n      \n      // Update branch in URL path\n      if (pathParts.length >= 5) {\n        if (pathParts.length === 5) {\n          // No branch in URL, append it\n          pathParts.push(newBranch);\n        } else {\n          // Branch exists, replace it\n          pathParts[5] = newBranch;\n        }\n        navigate(pathParts.join('/'));\n      }\n    }\n  };\n\n  const navigateToUser = (userLogin) => {\n    navigate(`/${params.page || 'dak-action'}/${userLogin}`);\n  };\n\n  const navigateToDAK = (userLogin, repoName, branchName = 'main') => {\n    navigate(`/${params.page || 'dashboard'}/${userLogin}/${repoName}/${branchName}`);\n  };\n\n  const navigateToAsset = (userLogin, repoName, branchName, assetPath) => {\n    navigate(`/${params.page || 'editor'}/${userLogin}/${repoName}/${branchName}/${assetPath}`);\n  };\n\n  return {\n    type,\n    user,\n    profile,\n    repository,\n    branch,\n    asset,\n    params,\n    updateBranch,\n    navigateToUser,\n    navigateToDAK,\n    navigateToAsset,\n    navigate\n  };\n};\n\n/**\n * Hook specifically for DAK pages (DAK and Asset page types)\n */\nexport const useDAKParams = () => {\n  try {\n    const pageParams = usePageParams();\n    \n    // Only throw error if page is fully loaded and type is not DAK/ASSET\n    // This prevents errors during initial loading or page type determination\n    if (!pageParams.loading && \n        pageParams.type !== PAGE_TYPES.DAK && \n        pageParams.type !== PAGE_TYPES.ASSET) {\n      throw new Error(`useDAKParams can only be used on DAK or Asset pages. Current page type: ${pageParams.type}`);\n    }\n\n    return {\n      user: pageParams.user,\n      profile: pageParams.profile,\n      repository: pageParams.repository,\n      branch: pageParams.branch,\n      asset: pageParams.asset,\n      updateBranch: pageParams.updateBranch,\n      navigate: pageParams.navigate\n    };\n  } catch (error) {\n    // If PageProvider is not ready yet, return empty object\n    if (error.message.includes('usePage must be used within a PageProvider')) {\n      console.log('useDAKParams: PageProvider not ready yet, returning empty data');\n      return {\n        user: null,\n        profile: null,\n        repository: null,\n        branch: null,\n        asset: null,\n        updateBranch: () => {},\n        navigate: () => {}\n      };\n    }\n    throw error;\n  }\n};\n\n/**\n * Hook specifically for User pages\n */\nexport const useUserParams = () => {\n  const pageParams = usePageParams();\n  \n  if (pageParams.type !== PAGE_TYPES.USER) {\n    throw new Error('useUserParams can only be used on User pages');\n  }\n\n  return {\n    user: pageParams.user,\n    profile: pageParams.profile,\n    navigateToDAK: pageParams.navigateToDAK,\n    navigate: pageParams.navigate\n  };\n};","import React from 'react';\n\n/**\n * Container for save buttons with independent states\n * Provides consistent UI for local and GitHub save operations\n */\nconst SaveButtonsContainer = ({\n  // States\n  hasChanges = false,\n  isSavingLocal = false,\n  isSavingGitHub = false,\n  canSaveToGitHub = false,\n  localSaveSuccess = false,\n  githubSaveSuccess = false,\n  savedLocally = false,\n  \n  // Handlers\n  onSaveLocal,\n  onSaveGitHub,\n  \n  // Configuration\n  isDemo = false,\n  showLocalButton = true,\n  showGitHubButton = true,\n  buttonSize = 'medium', // 'small', 'medium', 'large'\n  layout = 'horizontal' // 'horizontal', 'vertical'\n}) => {\n  \n  // Determine button states\n  const localButtonDisabled = !hasChanges || isSavingLocal || localSaveSuccess;\n  const githubButtonDisabled = !hasChanges || isSavingGitHub || githubSaveSuccess || !canSaveToGitHub;\n  \n  // Button text based on state\n  const getLocalButtonText = () => {\n    if (localSaveSuccess) return 'Saved Locally ✓';\n    if (isSavingLocal) return 'Saving...';\n    return 'Save Local';\n  };\n  \n  const getGitHubButtonText = () => {\n    if (githubSaveSuccess) return 'Committed ✓';\n    if (isSavingGitHub) return 'Committing...';\n    return 'Save to GitHub';\n  };\n\n  // CSS classes\n  const containerClasses = [\n    'save-buttons-container',\n    `layout-${layout}`,\n    `size-${buttonSize}`\n  ].join(' ');\n\n  const getButtonClasses = (type, disabled, success) => {\n    const classes = ['save-button', `save-button-${type}`];\n    if (disabled) classes.push('disabled');\n    if (success) classes.push('success');\n    return classes.join(' ');\n  };\n\n  return (\n    <div className={containerClasses}>\n      {/* Local Save Button */}\n      {showLocalButton && (\n        <button\n          className={getButtonClasses('local', localButtonDisabled, localSaveSuccess)}\n          onClick={onSaveLocal}\n          disabled={localButtonDisabled}\n          title={\n            !hasChanges ? 'No changes to save' :\n            localSaveSuccess ? 'Changes saved to local storage' :\n            isSavingLocal ? 'Saving to local storage...' :\n            'Save changes to browser local storage'\n          }\n        >\n          <span className=\"button-icon\">💾</span>\n          <span className=\"button-text\">{getLocalButtonText()}</span>\n        </button>\n      )}\n\n      {/* GitHub Save Button */}\n      {showGitHubButton && canSaveToGitHub && (\n        <button\n          className={getButtonClasses('github', githubButtonDisabled, githubSaveSuccess)}\n          onClick={onSaveGitHub}\n          disabled={githubButtonDisabled}\n          title={\n            !hasChanges ? 'No changes to save' :\n            githubSaveSuccess ? 'Changes committed to GitHub' :\n            isSavingGitHub ? 'Committing to GitHub...' :\n            'Commit changes to GitHub repository'\n          }\n        >\n          <span className=\"button-icon\">📤</span>\n          <span className=\"button-text\">{getGitHubButtonText()}</span>\n        </button>\n      )}\n\n      {/* GitHub unavailable indicator */}\n      {showGitHubButton && !canSaveToGitHub && !isDemo && (\n        <div className=\"github-unavailable\">\n          <span className=\"unavailable-icon\">🔒</span>\n          <span className=\"unavailable-text\">GitHub save unavailable</span>\n          <small>Login required for GitHub access</small>\n        </div>\n      )}\n\n      {/* Demo mode indicator */}\n      {isDemo && (\n        <div className=\"demo-mode-indicator\">\n          <span className=\"demo-icon\">🧪</span>\n          <span className=\"demo-text\">Demo Mode - Local save only</span>\n        </div>\n      )}\n\n      {/* Local storage indicator */}\n      {savedLocally && (\n        <div className=\"local-storage-indicator\">\n          <span className=\"local-icon\">💾</span>\n          <span className=\"local-text\">Local version available</span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SaveButtonsContainer;","import React, { useEffect, useRef } from 'react';\n\n/**\n * Dialog for entering commit message when saving to GitHub\n * Provides commit message input with validation and cancel functionality\n */\nconst CommitMessageDialog = ({\n  isOpen = false,\n  commitMessage = '',\n  setCommitMessage,\n  onCommit,\n  onCancel,\n  isSaving = false,\n  fileName = '',\n  suggestedMessage = ''\n}) => {\n  const textareaRef = useRef(null);\n  \n  // Auto-focus and suggest message when dialog opens\n  useEffect(() => {\n    if (isOpen && textareaRef.current) {\n      textareaRef.current.focus();\n      \n      // Set suggested message if none provided\n      if (!commitMessage && !suggestedMessage && fileName) {\n        const defaultMessage = `Update ${fileName}`;\n        setCommitMessage(defaultMessage);\n      } else if (suggestedMessage && !commitMessage) {\n        setCommitMessage(suggestedMessage);\n      }\n    }\n  }, [isOpen, commitMessage, suggestedMessage, fileName, setCommitMessage]);\n\n  // Handle key presses\n  const handleKeyDown = (e) => {\n    if (e.key === 'Escape' && !isSaving) {\n      onCancel();\n    } else if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {\n      // Ctrl/Cmd + Enter to commit\n      if (commitMessage.trim() && !isSaving) {\n        onCommit(commitMessage.trim());\n      }\n    }\n  };\n\n  // Handle commit button click\n  const handleCommit = () => {\n    if (commitMessage.trim() && !isSaving) {\n      onCommit(commitMessage.trim());\n    }\n  };\n\n  // Handle overlay click to close\n  const handleOverlayClick = (e) => {\n    if (e.target === e.currentTarget && !isSaving) {\n      onCancel();\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"commit-dialog-overlay\" onClick={handleOverlayClick}>\n      <div className=\"commit-dialog\" onKeyDown={handleKeyDown}>\n        <div className=\"commit-dialog-header\">\n          <h3>Commit Changes to GitHub</h3>\n          <button \n            className=\"close-button\"\n            onClick={onCancel}\n            disabled={isSaving}\n            aria-label=\"Close dialog\"\n          >\n            ✕\n          </button>\n        </div>\n        \n        <div className=\"commit-dialog-content\">\n          {fileName && (\n            <div className=\"file-info\">\n              <span className=\"file-icon\">📄</span>\n              <span className=\"file-name\">{fileName}</span>\n            </div>\n          )}\n          \n          <div className=\"commit-message-section\">\n            <label htmlFor=\"commit-message\" className=\"commit-message-label\">\n              Commit Message *\n            </label>\n            <textarea\n              id=\"commit-message\"\n              ref={textareaRef}\n              className=\"commit-message-input\"\n              value={commitMessage}\n              onChange={(e) => setCommitMessage(e.target.value)}\n              placeholder=\"Describe the changes you made...\"\n              rows={4}\n              disabled={isSaving}\n              required\n            />\n            <div className=\"commit-message-help\">\n              <small>\n                Describe what changes you made and why. This will be visible in the repository's commit history.\n              </small>\n            </div>\n          </div>\n          \n          <div className=\"commit-guidelines\">\n            <details>\n              <summary>Commit Message Guidelines</summary>\n              <ul>\n                <li>Use clear, descriptive language</li>\n                <li>Start with a verb (Add, Update, Fix, Remove, etc.)</li>\n                <li>Keep the first line under 72 characters</li>\n                <li>Add details in additional lines if needed</li>\n              </ul>\n            </details>\n          </div>\n        </div>\n        \n        <div className=\"commit-dialog-footer\">\n          <div className=\"dialog-actions\">\n            <button \n              className=\"btn btn-secondary\"\n              onClick={onCancel}\n              disabled={isSaving}\n            >\n              Cancel\n            </button>\n            <button \n              className=\"btn btn-primary\"\n              onClick={handleCommit}\n              disabled={!commitMessage.trim() || isSaving}\n            >\n              {isSaving ? (\n                <>\n                  <span className=\"spinner\"></span>\n                  Committing...\n                </>\n              ) : (\n                'Commit Changes'\n              )}\n            </button>\n          </div>\n          \n          <div className=\"keyboard-shortcut\">\n            <small>\n              Press <kbd>Ctrl+Enter</kbd> to commit or <kbd>Esc</kbd> to cancel\n            </small>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CommitMessageDialog;","/**\n * Data Access Layer\n * \n * Comprehensive service that integrates user access, staging ground, and GitHub\n * for a unified asset management experience across all user types.\n */\n\nimport userAccessService from './userAccessService';\nimport stagingGroundService from './stagingGroundService';\nimport githubService from './githubService';\nimport logger from '../utils/logger';\n\n/**\n * Save targets for asset operations\n */\nexport const SAVE_TARGETS = {\n  LOCAL: 'local',\n  GITHUB: 'github'\n};\n\n/**\n * Asset operation results\n */\nexport const OPERATION_RESULTS = {\n  SUCCESS: 'success',\n  ERROR: 'error',\n  PERMISSION_DENIED: 'permission_denied',\n  DEMO_MODE_BLOCKED: 'demo_mode_blocked'\n};\n\nclass DataAccessLayer {\n  constructor() {\n    this.logger = logger.getLogger('DataAccessLayer');\n    this.pendingOperations = new Map();\n    this.assetCache = new Map();\n  }\n\n  /**\n   * Initialize data access layer\n   */\n  async initialize(repository, branch) {\n    this.logger.info('Initializing data access layer', { \n      repository: repository?.full_name, \n      branch \n    });\n    \n    // Initialize staging ground for the repository\n    stagingGroundService.initialize(repository, branch);\n    \n    // Initialize user access service if not already done\n    await userAccessService.initialize();\n  }\n\n  /**\n   * Get asset content from GitHub or local storage\n   */\n  async getAsset(owner, repo, branch, assetPath) {\n    const cacheKey = `${owner}/${repo}/${branch}/${assetPath}`;\n    \n    try {\n      // Check if user has read access\n      const access = await userAccessService.getRepositoryAccess(owner, repo, branch);\n      if (access === 'none') {\n        throw new Error('No access to this repository');\n      }\n\n      // First, check if there's a local version in staging ground\n      const stagingGround = stagingGroundService.getStagingGround();\n      const localFile = stagingGround.files.find(f => f.path === assetPath);\n      \n      if (localFile) {\n        this.logger.debug('Asset loaded from staging ground', { assetPath });\n        return {\n          content: localFile.content,\n          source: 'local',\n          metadata: localFile.metadata,\n          hasLocalChanges: true\n        };\n      }\n\n      // If no local version, get from GitHub\n      let content;\n      if (userAccessService.isDemoUser() && userAccessService.isDemoDAK(owner, repo)) {\n        // For demo users, provide demo content\n        content = this.getDemoAssetContent(assetPath);\n      } else {\n        // Get real content from GitHub\n        content = await githubService.getFileContent(owner, repo, assetPath, branch);\n      }\n\n      // Cache the content\n      this.assetCache.set(cacheKey, content);\n\n      this.logger.debug('Asset loaded from GitHub', { assetPath, source: 'github' });\n      return {\n        content,\n        source: 'github',\n        hasLocalChanges: false\n      };\n\n    } catch (error) {\n      this.logger.error('Error getting asset', { \n        owner, repo, branch, assetPath, error: error.message \n      });\n      throw error;\n    }\n  }\n\n  /**\n   * Save asset to local storage (staging ground)\n   */\n  async saveAssetLocal(assetPath, content, metadata = {}) {\n    try {\n      const userType = userAccessService.getUserType();\n      \n      // All user types can save to local storage\n      const success = stagingGroundService.updateFile(assetPath, content, {\n        ...metadata,\n        savedBy: userType,\n        saveTarget: SAVE_TARGETS.LOCAL\n      });\n\n      if (success) {\n        this.logger.info('Asset saved to local storage', { assetPath, userType });\n        return {\n          result: OPERATION_RESULTS.SUCCESS,\n          message: 'Changes saved to local staging area',\n          target: SAVE_TARGETS.LOCAL\n        };\n      } else {\n        throw new Error('Failed to save to local storage');\n      }\n\n    } catch (error) {\n      this.logger.error('Error saving asset locally', { assetPath, error: error.message });\n      return {\n        result: OPERATION_RESULTS.ERROR,\n        message: `Failed to save locally: ${error.message}`,\n        target: SAVE_TARGETS.LOCAL\n      };\n    }\n  }\n\n  /**\n   * Save asset to GitHub\n   */\n  async saveAssetGitHub(owner, repo, branch, assetPath, content, commitMessage, metadata = {}) {\n    try {\n      const userType = userAccessService.getUserType();\n      \n      // Check if user can save to GitHub\n      const canSave = await userAccessService.canSaveToGitHub(owner, repo, branch);\n      \n      if (!canSave) {\n        if (userType === 'demo') {\n          return {\n            result: OPERATION_RESULTS.DEMO_MODE_BLOCKED,\n            message: 'Demo users cannot save to GitHub. Changes can be saved locally.',\n            target: SAVE_TARGETS.GITHUB\n          };\n        } else if (userType === 'unauthenticated') {\n          return {\n            result: OPERATION_RESULTS.PERMISSION_DENIED,\n            message: 'Please authenticate to save changes to GitHub.',\n            target: SAVE_TARGETS.GITHUB\n          };\n        } else {\n          return {\n            result: OPERATION_RESULTS.PERMISSION_DENIED,\n            message: 'You do not have write access to this repository.',\n            target: SAVE_TARGETS.GITHUB\n          };\n        }\n      }\n\n      // For authenticated users with write access, save to GitHub\n      const result = await githubService.updateFileContent(\n        owner, \n        repo, \n        assetPath, \n        content, \n        commitMessage, \n        branch\n      );\n\n      if (result.success) {\n        // Remove from staging ground since it's now committed\n        stagingGroundService.removeFile(assetPath);\n        \n        // Clear cache\n        const cacheKey = `${owner}/${repo}/${branch}/${assetPath}`;\n        this.assetCache.delete(cacheKey);\n\n        this.logger.info('Asset saved to GitHub', { \n          owner, repo, branch, assetPath, commit: result.data?.commit?.sha \n        });\n\n        return {\n          result: OPERATION_RESULTS.SUCCESS,\n          message: 'Changes successfully committed to GitHub',\n          target: SAVE_TARGETS.GITHUB,\n          commitSha: result.data?.commit?.sha,\n          commitUrl: result.data?.commit?.html_url\n        };\n      } else {\n        throw new Error(result.error || 'GitHub commit failed');\n      }\n\n    } catch (error) {\n      this.logger.error('Error saving asset to GitHub', { \n        owner, repo, branch, assetPath, error: error.message \n      });\n      \n      return {\n        result: OPERATION_RESULTS.ERROR,\n        message: `Failed to save to GitHub: ${error.message}`,\n        target: SAVE_TARGETS.GITHUB\n      };\n    }\n  }\n\n  /**\n   * Get demo asset content for demo users\n   */\n  getDemoAssetContent(assetPath) {\n    const demoAssets = {\n      'input/vocabulary/ValueSet-anc-care-codes.json': JSON.stringify({\n        resourceType: \"ValueSet\",\n        id: \"anc-care-codes\",\n        name: \"ANCCareCodes\",\n        title: \"ANC Care Codes (Demo)\",\n        status: \"draft\",\n        description: \"Demo value set for antenatal care codes\",\n        compose: {\n          include: [{\n            system: \"http://example.org/anc-codes\",\n            concept: [\n              { code: \"anc-visit\", display: \"Antenatal Care Visit\" },\n              { code: \"anc-screening\", display: \"Antenatal Screening\" }\n            ]\n          }]\n        }\n      }, null, 2),\n      \n      'input/actors/Patient.json': JSON.stringify({\n        resourceType: \"ActorDefinition\",\n        id: \"patient\",\n        name: \"Patient\",\n        title: \"Patient (Demo)\",\n        status: \"draft\",\n        description: \"Demo patient actor definition\",\n        type: \"person\"\n      }, null, 2),\n\n      'README.md': `# Demo DAK Repository\n\nThis is a demo repository showing the structure of a SMART Guidelines DAK.\n\n## Components\n\n- **ValueSets**: Terminology definitions\n- **Actors**: System and person actors  \n- **Business Processes**: BPMN workflow definitions\n\nThis is demo data and cannot be saved to GitHub.`\n    };\n\n    return demoAssets[assetPath] || `# Demo Asset: ${assetPath}\n\nThis is demo content for the asset located at: ${assetPath}\n\nDemo users can edit this content and save it locally, but cannot commit changes to GitHub.`;\n  }\n\n  /**\n   * Get save options for current user and asset\n   */\n  async getSaveOptions(owner, repo, branch) {\n    const userType = userAccessService.getUserType();\n    const canSaveGitHub = await userAccessService.canSaveToGitHub(owner, repo, branch);\n    const canSaveLocal = userAccessService.canSaveLocal();\n    const uiBehavior = userAccessService.getUIBehavior();\n\n    return {\n      canSaveLocal,\n      canSaveGitHub,\n      showSaveLocal: uiBehavior.showSaveLocal,\n      showSaveGitHub: uiBehavior.showSaveToGitHub,\n      confirmBeforeSave: uiBehavior.confirmBeforeSave,\n      userType,\n      restrictions: this.getSaveRestrictions(userType, canSaveGitHub)\n    };\n  }\n\n  /**\n   * Get save restrictions and messaging for user type\n   */\n  getSaveRestrictions(userType, canSaveGitHub) {\n    switch (userType) {\n      case 'unauthenticated':\n        return {\n          localMessage: 'Changes will be saved to your browser only',\n          githubMessage: 'Please authenticate to save to GitHub',\n          githubDisabled: true\n        };\n      \n      case 'demo':\n        return {\n          localMessage: 'Changes will be saved to your browser only',\n          githubMessage: 'Demo users cannot save to GitHub',\n          githubDisabled: true\n        };\n      \n      case 'authenticated':\n        if (canSaveGitHub) {\n          return {\n            localMessage: 'Save changes to staging area',\n            githubMessage: 'Commit changes to GitHub repository',\n            githubDisabled: false\n          };\n        } else {\n          return {\n            localMessage: 'Changes will be saved to your browser only',\n            githubMessage: 'You do not have write access to this repository',\n            githubDisabled: true\n          };\n        }\n      \n      default:\n        return {\n          localMessage: 'Local saves only',\n          githubMessage: 'GitHub saves not available',\n          githubDisabled: true\n        };\n    }\n  }\n\n  /**\n   * Get staging ground status\n   */\n  getStagingGroundStatus() {\n    return stagingGroundService.getStatus();\n  }\n\n  /**\n   * Clear staging ground\n   */\n  clearStagingGround() {\n    return stagingGroundService.clearStagingGround();\n  }\n\n  /**\n   * Get changed files in staging ground\n   */\n  getChangedFiles() {\n    const stagingGround = stagingGroundService.getStagingGround();\n    return stagingGround.files;\n  }\n\n  /**\n   * Check if asset has local changes\n   */\n  hasLocalChanges(assetPath) {\n    const stagingGround = stagingGroundService.getStagingGround();\n    return stagingGround.files.some(f => f.path === assetPath);\n  }\n\n  /**\n   * Create new asset (when supported by user type)\n   */\n  async createAsset(owner, repo, branch, assetPath, initialContent = '', metadata = {}) {\n    const uiBehavior = userAccessService.getUIBehavior();\n    \n    if (!uiBehavior.allowCreateNew) {\n      throw new Error('Current user type cannot create new assets');\n    }\n\n    // Save as local first\n    return this.saveAssetLocal(assetPath, initialContent, {\n      ...metadata,\n      isNew: true,\n      createdAt: Date.now()\n    });\n  }\n\n  /**\n   * Batch operations for multiple assets\n   */\n  async batchSaveLocal(assets) {\n    const results = [];\n    \n    for (const asset of assets) {\n      const result = await this.saveAssetLocal(\n        asset.path, \n        asset.content, \n        asset.metadata\n      );\n      results.push({ ...result, path: asset.path });\n    }\n\n    return {\n      success: results.every(r => r.result === OPERATION_RESULTS.SUCCESS),\n      results\n    };\n  }\n\n  /**\n   * Get access information for current context\n   */\n  async getAccessInfo(owner, repo, branch) {\n    const [access, badge, saveOptions] = await Promise.all([\n      userAccessService.getRepositoryAccess(owner, repo, branch),\n      userAccessService.getAccessBadge(owner, repo, branch),\n      this.getSaveOptions(owner, repo, branch)\n    ]);\n\n    return {\n      access,\n      badge,\n      saveOptions,\n      userType: userAccessService.getUserType(),\n      isDemo: userAccessService.isDemoUser()\n    };\n  }\n}\n\n// Create singleton instance\nconst dataAccessLayer = new DataAccessLayer();\n\nexport default dataAccessLayer;","import React, { useState, useCallback, useEffect } from 'react';\nimport { PageLayout } from './index';\nimport SaveButtonsContainer from './SaveButtonsContainer';\nimport CommitMessageDialog from './CommitMessageDialog';\nimport dataAccessLayer from '../../services/dataAccessLayer';\n\n/**\n * Enhanced page framework for asset editors\n * Provides consistent save functionality with user access integration\n */\nconst AssetEditorLayout = ({\n  children,\n  pageName,\n  // Asset information\n  file,\n  repository,\n  branch,\n  // Content management\n  content,\n  originalContent,\n  hasChanges = false,\n  // Save callbacks\n  onSave,\n  onContentChange,\n  // Custom save functions (for special cases like BPMN that need XML export)\n  customSaveToGitHub,\n  // UI customization\n  showSaveButtons = true,\n  saveButtonsPosition = 'top', // 'top', 'bottom', 'both'\n  ...pageLayoutProps\n}) => {\n  // Save states\n  const [isSavingLocal, setIsSavingLocal] = useState(false);\n  const [isSavingGitHub, setIsSavingGitHub] = useState(false);\n  const [saveError, setSaveError] = useState(null);\n  const [localSaveSuccess, setLocalSaveSuccess] = useState(false);\n  const [githubSaveSuccess, setGithubSaveSuccess] = useState(false);\n  const [saveOptions, setSaveOptions] = useState(null);\n  \n  // Commit dialog state\n  const [showCommitDialog, setShowCommitDialog] = useState(false);\n  const [commitMessage, setCommitMessage] = useState('');\n\n  // Load save options based on current user and repository\n  useEffect(() => {\n    const loadSaveOptions = async () => {\n      if (repository) {\n        try {\n          const options = await dataAccessLayer.getSaveOptions(\n            repository.owner?.login,\n            repository.name,\n            branch\n          );\n          setSaveOptions(options);\n        } catch (error) {\n          console.error('Error loading save options:', error);\n        }\n      }\n    };\n\n    loadSaveOptions();\n  }, [repository, branch]);\n\n  // Check if user can save to GitHub based on access service\n  const canSaveToGitHub = saveOptions?.canSaveGitHub && saveOptions?.showSaveGitHub;\n\n  // Handle local save\n  const handleSaveLocal = useCallback(async () => {\n    if (!hasChanges || !file?.path) return;\n\n    try {\n      setIsSavingLocal(true);\n      setSaveError(null);\n      setLocalSaveSuccess(false);\n\n      // Use data access layer for local save\n      const result = await dataAccessLayer.saveAssetLocal(file.path, content, {\n        repository: repository?.full_name || `${repository?.owner?.login}/${repository?.name}`,\n        branch: branch || repository?.default_branch || 'main',\n        fileName: file.name,\n        timestamp: new Date().toISOString()\n      });\n      \n      if (result.result === 'success') {\n        setLocalSaveSuccess(true);\n        onSave && onSave(content, 'local');\n        \n        // Auto-hide success message after 3 seconds\n        setTimeout(() => {\n          setLocalSaveSuccess(false);\n        }, 3000);\n      } else {\n        throw new Error(result.message || 'Failed to save to local storage');\n      }\n\n    } catch (error) {\n      console.error('Error saving file locally:', error);\n      setSaveError(`Failed to save locally: ${error.message}`);\n    } finally {\n      setIsSavingLocal(false);\n    }\n  }, [hasChanges, file, content, repository, branch, onSave]);\n\n  // Handle GitHub save - shows commit dialog\n  const handleSaveGitHub = useCallback(() => {\n    if (!hasChanges || !canSaveToGitHub) return;\n    \n    setSaveError(null);\n    setShowCommitDialog(true);\n  }, [hasChanges, canSaveToGitHub]);\n\n  // Handle commit to GitHub with message\n  const handleCommitToGitHub = useCallback(async (message) => {\n    if (!message.trim() || !file?.path) return;\n\n    try {\n      setIsSavingGitHub(true);\n      setSaveError(null);\n      setGithubSaveSuccess(false);\n\n      // Use custom save function if provided (for special cases like BPMN)\n      if (customSaveToGitHub) {\n        const success = await customSaveToGitHub(message.trim());\n        if (success) {\n          setGithubSaveSuccess(true);\n          setShowCommitDialog(false);\n          setCommitMessage('');\n          onSave && onSave(content, 'github');\n          \n          // Auto-hide success message after 3 seconds\n          setTimeout(() => {\n            setGithubSaveSuccess(false);\n          }, 3000);\n        } else {\n          throw new Error('Custom save function failed');\n        }\n        return;\n      }\n\n      // Use data access layer for GitHub save\n      const result = await dataAccessLayer.saveAssetGitHub(\n        repository?.owner?.login,\n        repository?.name,\n        branch,\n        file.path,\n        content,\n        message.trim()\n      );\n\n      if (result.result === 'success') {\n        setGithubSaveSuccess(true);\n        setShowCommitDialog(false);\n        setCommitMessage('');\n        onSave && onSave(content, 'github');\n        \n        // Auto-hide success message after 3 seconds\n        setTimeout(() => {\n          setGithubSaveSuccess(false);\n        }, 3000);\n      } else {\n        // Handle different result types\n        let errorMessage = result.message;\n        if (result.result === 'demo_mode_blocked') {\n          errorMessage = 'Demo users cannot save to GitHub. You can save changes locally instead.';\n        } else if (result.result === 'permission_denied') {\n          errorMessage = 'You do not have permission to save to this repository.';\n        }\n        throw new Error(errorMessage);\n      }\n\n    } catch (error) {\n      console.error('Error saving file to GitHub:', error);\n      setSaveError(`Failed to save to GitHub: ${error.message}`);\n    } finally {\n      setIsSavingGitHub(false);\n    }\n  }, [file, content, repository, branch, onSave, customSaveToGitHub]);\n\n  // Handle commit dialog cancel\n  const handleCancelCommit = useCallback(() => {\n    setShowCommitDialog(false);\n    setCommitMessage('');\n  }, []);\n\n  const saveButtonsProps = {\n    // States\n    hasChanges,\n    isSavingLocal,\n    isSavingGitHub,\n    canSaveToGitHub,\n    localSaveSuccess,\n    githubSaveSuccess,\n    \n    // Handlers\n    onSaveLocal: handleSaveLocal,\n    onSaveGitHub: handleSaveGitHub\n  };\n\n  return (\n    <PageLayout pageName={pageName} {...pageLayoutProps}>\n      <div className=\"asset-editor-layout\">\n        {/* Top save buttons */}\n        {showSaveButtons && (saveButtonsPosition === 'top' || saveButtonsPosition === 'both') && (\n          <div className=\"save-buttons-top\">\n            <SaveButtonsContainer {...saveButtonsProps} />\n          </div>\n        )}\n\n        {/* Error display */}\n        {saveError && (\n          <div className=\"asset-editor-error\">\n            <span className=\"error-icon\">⚠️</span>\n            {saveError}\n            <button \n              className=\"btn-link error-dismiss\"\n              onClick={() => setSaveError(null)}\n            >\n              ✕\n            </button>\n          </div>\n        )}\n\n        {/* Success messages */}\n        {localSaveSuccess && (\n          <div className=\"asset-editor-success\">\n            <span className=\"success-icon\">✅</span>\n            Changes saved locally successfully!\n          </div>\n        )}\n        \n        {githubSaveSuccess && (\n          <div className=\"asset-editor-success\">\n            <span className=\"success-icon\">✅</span>\n            Changes committed to GitHub successfully!\n          </div>\n        )}\n\n        {/* Main content area */}\n        <div className=\"asset-editor-content\">\n          {children}\n        </div>\n\n        {/* Bottom save buttons */}\n        {showSaveButtons && (saveButtonsPosition === 'bottom' || saveButtonsPosition === 'both') && (\n          <div className=\"save-buttons-bottom\">\n            <SaveButtonsContainer {...saveButtonsProps} />\n          </div>\n        )}\n\n        {/* Commit message dialog */}\n        {showCommitDialog && (\n          <CommitMessageDialog\n            isOpen={showCommitDialog}\n            commitMessage={commitMessage}\n            setCommitMessage={setCommitMessage}\n            onCommit={handleCommitToGitHub}\n            onCancel={handleCancelCommit}\n            isSaving={isSavingGitHub}\n            fileName={file?.name}\n          />\n        )}\n      </div>\n    </PageLayout>\n  );\n};\n\nexport default AssetEditorLayout;","import { useState, useCallback, useEffect } from 'react';\nimport githubService from '../../services/githubService';\nimport localStorageService from '../../services/localStorageService';\n\n/**\n * Hook for managing asset editor save state and operations\n * Provides consistent save functionality for asset editors\n */\nexport const useAssetSave = ({\n  file,\n  repository,\n  branch,\n  content,\n  originalContent,\n  isDemo = false,\n  onSave\n}) => {\n  // Save states\n  const [isSavingLocal, setIsSavingLocal] = useState(false);\n  const [isSavingGitHub, setIsSavingGitHub] = useState(false);\n  const [saveError, setSaveError] = useState(null);\n  const [savedLocally, setSavedLocally] = useState(false);\n  const [localSaveSuccess, setLocalSaveSuccess] = useState(false);\n  const [githubSaveSuccess, setGithubSaveSuccess] = useState(false);\n\n  // Derived states\n  const hasChanges = content !== originalContent;\n  const canSaveToGitHub = githubService.isAuth() && !isDemo;\n\n  // Check if there's a local version of this file\n  useEffect(() => {\n    if (file?.path) {\n      const localContent = localStorageService.getLocalContent(file.path);\n      if (localContent && localContent !== originalContent) {\n        setSavedLocally(true);\n      } else {\n        setSavedLocally(false);\n      }\n    }\n  }, [file?.path, originalContent]);\n\n  // Reset success states when content changes\n  useEffect(() => {\n    if (hasChanges) {\n      setLocalSaveSuccess(false);\n      setGithubSaveSuccess(false);\n      setSaveError(null);\n    }\n  }, [hasChanges]);\n\n  // Handle local save\n  const saveLocal = useCallback(async () => {\n    if (!hasChanges || !file?.path) return false;\n\n    try {\n      setIsSavingLocal(true);\n      setSaveError(null);\n      setLocalSaveSuccess(false);\n\n      // Save to local storage\n      const metadata = {\n        repository: repository?.full_name || `${repository?.owner?.login}/${repository?.name}`,\n        branch: branch || repository?.default_branch || 'main',\n        fileName: file.name,\n        timestamp: new Date().toISOString()\n      };\n\n      const saved = localStorageService.saveLocal(file.path, content, metadata);\n      \n      if (saved) {\n        setSavedLocally(true);\n        setLocalSaveSuccess(true);\n        onSave && onSave(content, 'local');\n        \n        // Auto-hide success message after 3 seconds\n        setTimeout(() => {\n          setLocalSaveSuccess(false);\n        }, 3000);\n        \n        return true;\n      } else {\n        throw new Error('Failed to save to local storage');\n      }\n\n    } catch (error) {\n      console.error('Error saving file locally:', error);\n      setSaveError(`Failed to save locally: ${error.message}`);\n      return false;\n    } finally {\n      setIsSavingLocal(false);\n    }\n  }, [hasChanges, file, content, repository, branch, onSave]);\n\n  // Handle GitHub save with commit message\n  const saveToGitHub = useCallback(async (commitMessage) => {\n    if (!commitMessage?.trim() || !file?.path || !canSaveToGitHub) return false;\n\n    try {\n      setIsSavingGitHub(true);\n      setSaveError(null);\n      setGithubSaveSuccess(false);\n\n      let owner, repoName;\n      if (repository?.owner?.login) {\n        owner = repository.owner.login;\n        repoName = repository.name;\n      } else if (repository?.full_name) {\n        [owner, repoName] = repository.full_name.split('/');\n      } else {\n        throw new Error('Repository information not available');\n      }\n\n      await githubService.updateFile(\n        owner,\n        repoName,\n        file.path,\n        content,\n        commitMessage.trim(),\n        branch || repository?.default_branch || 'main'\n      );\n\n      setGithubSaveSuccess(true);\n      onSave && onSave(content, 'github');\n      \n      // Auto-hide success message after 3 seconds\n      setTimeout(() => {\n        setGithubSaveSuccess(false);\n      }, 3000);\n      \n      return true;\n\n    } catch (error) {\n      console.error('Error saving file to GitHub:', error);\n      setSaveError(`Failed to save to GitHub: ${error.message}`);\n      return false;\n    } finally {\n      setIsSavingGitHub(false);\n    }\n  }, [file, content, repository, branch, canSaveToGitHub, onSave]);\n\n  // Load local version of file\n  const loadLocalVersion = useCallback(() => {\n    if (file?.path) {\n      const localContent = localStorageService.getLocalContent(file.path);\n      return localContent;\n    }\n    return null;\n  }, [file?.path]);\n\n  // Discard local version\n  const discardLocalVersion = useCallback(() => {\n    if (file?.path) {\n      localStorageService.removeLocal(file.path);\n      setSavedLocally(false);\n      return true;\n    }\n    return false;\n  }, [file?.path]);\n\n  // Clear save error\n  const clearError = useCallback(() => {\n    setSaveError(null);\n  }, []);\n\n  // Export local changes\n  const exportLocalChanges = useCallback(() => {\n    try {\n      const exportData = localStorageService.exportLocalChanges('json');\n      const url = URL.createObjectURL(exportData);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = `sgex-local-changes-${new Date().toISOString().split('T')[0]}.json`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n      return true;\n    } catch (error) {\n      console.error('Error exporting local changes:', error);\n      setSaveError(`Failed to export: ${error.message}`);\n      return false;\n    }\n  }, []);\n\n  return {\n    // States\n    hasChanges,\n    isSavingLocal,\n    isSavingGitHub,\n    saveError,\n    savedLocally,\n    localSaveSuccess,\n    githubSaveSuccess,\n    canSaveToGitHub,\n    \n    // Actions\n    saveLocal,\n    saveToGitHub,\n    loadLocalVersion,\n    discardLocalVersion,\n    clearError,\n    exportLocalChanges,\n    \n    // Utilities\n    isLoading: isSavingLocal || isSavingGitHub\n  };\n};","/**\n * Tool Definition Framework\n * \n * Provides a simple API for creating new tools in the SGEX Workbench.\n * Handles page setup, user access, data management, and UI integration.\n */\n\nimport React from 'react';\nimport { PageLayout, AssetEditorLayout } from './index';\nimport { usePageParams } from './usePageParams';\nimport userAccessService from '../../services/userAccessService';\nimport dataAccessLayer from '../../services/dataAccessLayer';\n\n/**\n * Tool types supported by the framework\n */\nexport const TOOL_TYPES = {\n  VIEWER: 'viewer',        // Read-only asset viewer\n  EDITOR: 'editor',        // Asset editor with save capabilities\n  DASHBOARD: 'dashboard',  // DAK-level dashboard\n  UTILITY: 'utility'       // General utility tool\n};\n\n/**\n * Base tool definition interface\n */\nexport class ToolDefinition {\n  constructor(config) {\n    this.id = config.id;\n    this.name = config.name;\n    this.title = config.title || config.name;\n    this.description = config.description;\n    this.type = config.type || TOOL_TYPES.UTILITY;\n    this.route = config.route || `/${this.id}`;\n    this.icon = config.icon;\n    this.category = config.category || 'general';\n    \n    // Access requirements\n    this.requiresAuth = config.requiresAuth !== false; // Default to true\n    this.supportsDemo = config.supportsDemo !== false; // Default to true\n    this.requiresDAK = config.requiresDAK || false;\n    \n    // Asset handling\n    this.assetTypes = config.assetTypes || [];\n    this.assetPattern = config.assetPattern;\n    \n    // UI components\n    this.viewerComponent = config.viewerComponent;\n    this.editorComponent = config.editorComponent;\n    this.dashboardComponent = config.dashboardComponent;\n    \n    // Hooks\n    this.onInit = config.onInit;\n    this.onAssetLoad = config.onAssetLoad;\n    this.onAssetSave = config.onAssetSave;\n    this.onError = config.onError;\n  }\n\n  /**\n   * Check if tool supports the given asset type\n   */\n  supportsAsset(assetPath) {\n    if (!this.assetTypes?.length && !this.assetPattern) {\n      return true; // Tool accepts any asset\n    }\n    \n    if (this.assetPattern) {\n      return new RegExp(this.assetPattern).test(assetPath);\n    }\n    \n    return this.assetTypes.some(type => assetPath.includes(type));\n  }\n\n  /**\n   * Check if current user can access this tool\n   */\n  async canAccess() {\n    if (this.requiresAuth && userAccessService.isUnauthenticated()) {\n      return false;\n    }\n    \n    if (!this.supportsDemo && userAccessService.isDemoUser()) {\n      return false;\n    }\n    \n    return true;\n  }\n\n  /**\n   * Generate React component for this tool\n   */\n  createComponent() {\n    const toolDef = this;\n    \n    return function ToolComponent(props) {\n      return <ToolWrapper toolDefinition={toolDef} {...props} />;\n    };\n  }\n}\n\n/**\n * Wrapper component that handles framework integration\n */\nconst ToolWrapper = ({ toolDefinition, ...props }) => {\n  const pageParams = usePageParams();\n  const [toolState, setToolState] = React.useState({\n    loading: true,\n    error: null,\n    canAccess: false,\n    assets: [],\n    content: null\n  });\n\n  const initializeTool = React.useCallback(async () => {\n    try {\n      setToolState(prev => ({ ...prev, loading: true, error: null }));\n\n      // Check access\n      const canAccess = await toolDefinition.canAccess();\n      if (!canAccess) {\n        throw new Error(`Access denied: This tool requires ${toolDefinition.requiresAuth ? 'authentication' : 'different user type'}`);\n      }\n\n      // Initialize data access layer if needed\n      if (pageParams.repository) {\n        await dataAccessLayer.initialize(pageParams.repository, pageParams.branch);\n      }\n\n      // Load assets if this is an asset tool\n      let assets = [];\n      let content = null;\n      \n      if (pageParams.asset && (toolDefinition.type === TOOL_TYPES.VIEWER || toolDefinition.type === TOOL_TYPES.EDITOR)) {\n        if (toolDefinition.supportsAsset(pageParams.asset)) {\n          const assetData = await dataAccessLayer.getAsset(\n            pageParams.user,\n            pageParams.repository?.name,\n            pageParams.branch,\n            pageParams.asset\n          );\n          assets = [{ path: pageParams.asset, ...assetData }];\n          content = assetData.content;\n        } else {\n          throw new Error(`This tool does not support asset type: ${pageParams.asset}`);\n        }\n      }\n\n      // Call tool's initialization hook\n      if (toolDefinition.onInit) {\n        await toolDefinition.onInit({\n          pageParams,\n          assets,\n          content\n        });\n      }\n\n      setToolState({\n        loading: false,\n        error: null,\n        canAccess: true,\n        assets,\n        content\n      });\n\n    } catch (error) {\n      console.error(`Error initializing tool ${toolDefinition.id}:`, error);\n      setToolState({\n        loading: false,\n        error: error.message,\n        canAccess: false,\n        assets: [],\n        content: null\n      });\n\n      // Call tool's error hook\n      if (toolDefinition.onError) {\n        toolDefinition.onError(error, { pageParams });\n      }\n    }\n  }, [toolDefinition, pageParams]);\n\n  React.useEffect(() => {\n    initializeTool();\n  }, [initializeTool]);\n\n  const handleAssetSave = async (newContent, saveType) => {\n    if (!pageParams.asset) return;\n\n    try {\n      let result;\n      if (saveType === 'local') {\n        result = await dataAccessLayer.saveAssetLocal(pageParams.asset, newContent);\n      } else if (saveType === 'github') {\n        // This should be called with commit message from UI\n        throw new Error('GitHub save requires commit message - use handleGitHubSave instead');\n      }\n\n      // Call tool's save hook\n      if (toolDefinition.onAssetSave) {\n        await toolDefinition.onAssetSave({\n          asset: pageParams.asset,\n          content: newContent,\n          saveType,\n          result,\n          pageParams\n        });\n      }\n\n      return result;\n    } catch (error) {\n      console.error(`Error saving asset in tool ${toolDefinition.id}:`, error);\n      throw error;\n    }\n  };\n\n  const handleGitHubSave = async (newContent, commitMessage) => {\n    if (!pageParams.asset) return;\n\n    try {\n      const result = await dataAccessLayer.saveAssetGitHub(\n        pageParams.user,\n        pageParams.repository?.name,\n        pageParams.branch,\n        pageParams.asset,\n        newContent,\n        commitMessage\n      );\n\n      // Call tool's save hook\n      if (toolDefinition.onAssetSave) {\n        await toolDefinition.onAssetSave({\n          asset: pageParams.asset,\n          content: newContent,\n          saveType: 'github',\n          result,\n          commitMessage,\n          pageParams\n        });\n      }\n\n      return result;\n    } catch (error) {\n      console.error(`Error saving asset to GitHub in tool ${toolDefinition.id}:`, error);\n      throw error;\n    }\n  };\n\n  // Show loading state\n  if (toolState.loading) {\n    return (\n      <PageLayout pageName={toolDefinition.id}>\n        <div className=\"tool-loading\">\n          <h2>Loading {toolDefinition.title}...</h2>\n          <p>Initializing tool and checking access permissions.</p>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  // Show error state\n  if (toolState.error || !toolState.canAccess) {\n    return (\n      <PageLayout pageName={toolDefinition.id}>\n        <div className=\"tool-error\">\n          <h2>Cannot Access {toolDefinition.title}</h2>\n          <p>{toolState.error || 'Access denied'}</p>\n          <button onClick={() => window.history.back()}>\n            Go Back\n          </button>\n        </div>\n      </PageLayout>\n    );\n  }\n\n  // Render appropriate component based on tool type\n  const renderToolContent = () => {\n    const commonProps = {\n      toolDefinition,\n      pageParams,\n      toolState,\n      onAssetSave: handleAssetSave,\n      onGitHubSave: handleGitHubSave,\n      ...props\n    };\n\n    switch (toolDefinition.type) {\n      case TOOL_TYPES.EDITOR:\n        if (toolDefinition.editorComponent) {\n          const EditorComponent = toolDefinition.editorComponent;\n          \n          if (pageParams.asset && toolState.assets.length > 0) {\n            // Use AssetEditorLayout for asset editors\n            return (\n              <AssetEditorLayout\n                pageName={toolDefinition.id}\n                file={{ name: pageParams.asset, path: pageParams.asset }}\n                repository={pageParams.repository}\n                branch={pageParams.branch}\n                content={toolState.content}\n                originalContent={toolState.assets[0]?.content}\n                hasChanges={false} // Will be managed by the editor component\n                onSave={handleAssetSave}\n                onContentChange={(content) => {\n                  setToolState(prev => ({ ...prev, content }));\n                }}\n              >\n                <EditorComponent {...commonProps} />\n              </AssetEditorLayout>\n            );\n          } else {\n            // General editor without specific asset\n            return (\n              <PageLayout pageName={toolDefinition.id}>\n                <EditorComponent {...commonProps} />\n              </PageLayout>\n            );\n          }\n        }\n        break;\n\n      case TOOL_TYPES.VIEWER:\n        if (toolDefinition.viewerComponent) {\n          const ViewerComponent = toolDefinition.viewerComponent;\n          return (\n            <PageLayout pageName={toolDefinition.id}>\n              <ViewerComponent {...commonProps} />\n            </PageLayout>\n          );\n        }\n        break;\n\n      case TOOL_TYPES.DASHBOARD:\n        if (toolDefinition.dashboardComponent) {\n          const DashboardComponent = toolDefinition.dashboardComponent;\n          return (\n            <PageLayout pageName={toolDefinition.id}>\n              <DashboardComponent {...commonProps} />\n            </PageLayout>\n          );\n        }\n        break;\n\n      case TOOL_TYPES.UTILITY:\n      default:\n        // Use viewer component as fallback, or dashboard component\n        const Component = toolDefinition.viewerComponent || \n                         toolDefinition.editorComponent || \n                         toolDefinition.dashboardComponent;\n        \n        if (Component) {\n          return (\n            <PageLayout pageName={toolDefinition.id}>\n              <Component {...commonProps} />\n            </PageLayout>\n          );\n        }\n        break;\n    }\n\n    // Fallback if no component is provided\n    return (\n      <PageLayout pageName={toolDefinition.id}>\n        <div className=\"tool-fallback\">\n          <h1>{toolDefinition.title}</h1>\n          <p>{toolDefinition.description}</p>\n          <p>No component defined for this tool.</p>\n        </div>\n      </PageLayout>\n    );\n  };\n\n  return renderToolContent();\n};\n\n/**\n * Registry for managing tool definitions\n */\nclass ToolRegistry {\n  constructor() {\n    this.tools = new Map();\n  }\n\n  /**\n   * Register a new tool\n   */\n  register(config) {\n    const tool = new ToolDefinition(config);\n    this.tools.set(tool.id, tool);\n    return tool;\n  }\n\n  /**\n   * Get tool by ID\n   */\n  get(id) {\n    return this.tools.get(id);\n  }\n\n  /**\n   * Get all tools\n   */\n  getAll() {\n    return Array.from(this.tools.values());\n  }\n\n  /**\n   * Get tools by category\n   */\n  getByCategory(category) {\n    return this.getAll().filter(tool => tool.category === category);\n  }\n\n  /**\n   * Get tools that support a specific asset type\n   */\n  getByAssetType(assetPath) {\n    return this.getAll().filter(tool => tool.supportsAsset(assetPath));\n  }\n\n  /**\n   * Get tools accessible by current user\n   */\n  async getAccessibleTools() {\n    const tools = this.getAll();\n    const accessibleTools = [];\n\n    for (const tool of tools) {\n      if (await tool.canAccess()) {\n        accessibleTools.push(tool);\n      }\n    }\n\n    return accessibleTools;\n  }\n}\n\n// Create singleton registry\nconst toolRegistry = new ToolRegistry();\n\n/**\n * Helper function to create a simple tool\n */\nexport const createTool = (config) => {\n  return toolRegistry.register(config);\n};\n\n/**\n * Helper function to create an asset editor tool\n */\nexport const createAssetEditor = (config) => {\n  return createTool({\n    ...config,\n    type: TOOL_TYPES.EDITOR,\n    requiresDAK: true\n  });\n};\n\n/**\n * Helper function to create an asset viewer tool\n */\nexport const createAssetViewer = (config) => {\n  return createTool({\n    ...config,\n    type: TOOL_TYPES.VIEWER,\n    requiresDAK: true,\n    requiresAuth: false // Viewers can be used by unauthenticated users\n  });\n};\n\n/**\n * Helper function to create a dashboard tool\n */\nexport const createDashboard = (config) => {\n  return createTool({\n    ...config,\n    type: TOOL_TYPES.DASHBOARD,\n    requiresDAK: true\n  });\n};\n\nexport default toolRegistry;","/**\n * Cache Management Service\n * \n * Centralized service for managing all application cache and local storage\n * including repository cache, branch context, staging ground, and user data\n */\n\nimport repositoryCacheService from './repositoryCacheService';\nimport branchContextService from './branchContextService';\nimport logger from '../utils/logger';\n\nclass CacheManagementService {\n  constructor() {\n    this.logger = logger.getLogger('CacheManagementService');\n  }\n\n  /**\n   * Clear all application cache and local context\n   * This includes:\n   * - Repository cache (localStorage)\n   * - Branch context (sessionStorage) \n   * - Staging ground data (localStorage)\n   * - Any other SGEX-related local storage\n   */\n  clearAllCache() {\n    try {\n      this.logger.info('Starting complete cache clear operation');\n      \n      // Clear repository cache\n      const repoCacheCleared = repositoryCacheService.clearAllCaches();\n      this.logger.debug('Repository cache cleared', { success: repoCacheCleared });\n\n      // Clear branch context\n      branchContextService.clearAllBranchContext();\n      this.logger.debug('Branch context cleared');\n\n      // Clear staging ground data\n      this.clearAllStagingGrounds();\n      this.logger.debug('Staging ground data cleared');\n\n      // Clear any other SGEX-related localStorage items\n      this.clearOtherSGEXData();\n      this.logger.debug('Other SGEX data cleared');\n\n      this.logger.info('Complete cache clear operation completed successfully');\n      return true;\n    } catch (error) {\n      this.logger.error('Error during cache clear operation', { error: error.message });\n      console.error('Error clearing cache:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear all staging ground data across repositories and branches\n   */\n  clearAllStagingGrounds() {\n    try {\n      // Find all staging ground keys in localStorage\n      const keys = Object.keys(localStorage);\n      const stagingKeys = keys.filter(key => key.startsWith('sgex_staging_'));\n      \n      stagingKeys.forEach(key => {\n        localStorage.removeItem(key);\n        this.logger.debug('Removed staging ground', { key });\n      });\n\n      // Also clear staging ground history\n      const historyKeys = keys.filter(key => key.startsWith('sgex_staging_history_'));\n      historyKeys.forEach(key => {\n        localStorage.removeItem(key);\n        this.logger.debug('Removed staging ground history', { key });\n      });\n\n      return true;\n    } catch (error) {\n      this.logger.error('Error clearing staging grounds', { error: error.message });\n      console.warn('Error clearing staging grounds:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear other SGEX-related data that might be stored\n   */\n  clearOtherSGEXData() {\n    try {\n      const keys = Object.keys(localStorage);\n      const sgexKeys = keys.filter(key => \n        key.startsWith('sgex_') && \n        !key.startsWith('sgex_repo_cache_') && \n        !key.startsWith('sgex_staging_')\n      );\n      \n      sgexKeys.forEach(key => {\n        localStorage.removeItem(key);\n        this.logger.debug('Removed other SGEX data', { key });\n      });\n\n      // Also check sessionStorage for SGEX data (excluding branch context which is handled separately)\n      const sessionKeys = Object.keys(sessionStorage);\n      const sgexSessionKeys = sessionKeys.filter(key => \n        key.startsWith('sgex_') && key !== 'sgex_branch_context'\n      );\n      \n      sgexSessionKeys.forEach(key => {\n        sessionStorage.removeItem(key);\n        this.logger.debug('Removed SGEX session data', { key });\n      });\n\n      return true;\n    } catch (error) {\n      this.logger.error('Error clearing other SGEX data', { error: error.message });\n      console.warn('Error clearing other SGEX data:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get information about current cache usage\n   * Useful for debugging and showing users what will be cleared\n   */\n  getCacheInfo() {\n    try {\n      const info = {\n        repositoryCache: {\n          count: 0,\n          keys: []\n        },\n        branchContext: {\n          hasData: false,\n          repositoryCount: 0\n        },\n        stagingGround: {\n          count: 0,\n          keys: []\n        },\n        other: {\n          count: 0,\n          keys: []\n        }\n      };\n\n      // Check localStorage\n      const localKeys = Object.keys(localStorage);\n      \n      // Repository cache\n      info.repositoryCache.keys = localKeys.filter(key => key.startsWith('sgex_repo_cache_'));\n      info.repositoryCache.count = info.repositoryCache.keys.length;\n\n      // Staging ground\n      info.stagingGround.keys = localKeys.filter(key => \n        key.startsWith('sgex_staging_') || key.startsWith('sgex_staging_history_')\n      );\n      info.stagingGround.count = info.stagingGround.keys.length;\n\n      // Other SGEX data\n      info.other.keys = localKeys.filter(key => \n        key.startsWith('sgex_') && \n        !key.startsWith('sgex_repo_cache_') && \n        !key.startsWith('sgex_staging_')\n      );\n      info.other.count = info.other.keys.length;\n\n      // Check sessionStorage for branch context\n      try {\n        const branchContext = sessionStorage.getItem('sgex_branch_context');\n        if (branchContext) {\n          const parsed = JSON.parse(branchContext);\n          info.branchContext.hasData = true;\n          info.branchContext.repositoryCount = Object.keys(parsed).length;\n        }\n      } catch (e) {\n        // Ignore parsing errors\n      }\n\n      return info;\n    } catch (error) {\n      this.logger.error('Error getting cache info', { error: error.message });\n      return null;\n    }\n  }\n\n  /**\n   * Check if there's any uncommitted work that would be lost\n   * Returns information about staging grounds with unsaved changes\n   */\n  getUncommittedWork() {\n    try {\n      const uncommittedWork = [];\n      const keys = Object.keys(localStorage);\n      const stagingKeys = keys.filter(key => key.startsWith('sgex_staging_') && !key.includes('_history_'));\n      \n      stagingKeys.forEach(key => {\n        try {\n          const data = JSON.parse(localStorage.getItem(key));\n          if (data && data.files && data.files.length > 0) {\n            // Extract repository and branch from key\n            const keyParts = key.replace('sgex_staging_', '').split('_');\n            const branch = keyParts.pop();\n            const repository = keyParts.join('_');\n            \n            uncommittedWork.push({\n              repository,\n              branch,\n              fileCount: data.files.length,\n              lastModified: data.timestamp ? new Date(data.timestamp) : null,\n              message: data.message || ''\n            });\n          }\n        } catch (e) {\n          // Skip invalid entries\n        }\n      });\n\n      return uncommittedWork;\n    } catch (error) {\n      this.logger.error('Error checking uncommitted work', { error: error.message });\n      return [];\n    }\n  }\n}\n\n// Export singleton instance\nconst cacheManagementService = new CacheManagementService();\nexport default cacheManagementService;","import React, { useState, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\n// Default UN languages\nconst UN_LANGUAGES = [\n  { code: 'en', name: 'language.english', flag: '🇺🇸' },\n  { code: 'fr', name: 'language.french', flag: '🇫🇷' },\n  { code: 'es', name: 'language.spanish', flag: '🇪🇸' },\n  { code: 'ar', name: 'language.arabic', flag: '🇸🇦' },\n  { code: 'zh', name: 'language.chinese', flag: '🇨🇳' },\n  { code: 'ru', name: 'language.russian', flag: '🇷🇺' }\n];\n\n// Comprehensive ISO 639-1 language list with native names and English names for searchability\nconst ADDITIONAL_LANGUAGES = [\n  // European languages\n  { code: 'de', name: 'Deutsch', englishName: 'German', flag: '🇩🇪' },\n  { code: 'it', name: 'Italiano', englishName: 'Italian', flag: '🇮🇹' },\n  { code: 'pt', name: 'Português', englishName: 'Portuguese', flag: '🇵🇹' },\n  { code: 'nl', name: 'Nederlands', englishName: 'Dutch', flag: '🇳🇱' },\n  { code: 'sv', name: 'Svenska', englishName: 'Swedish', flag: '🇸🇪' },\n  { code: 'no', name: 'Norsk', englishName: 'Norwegian', flag: '🇳🇴' },\n  { code: 'da', name: 'Dansk', englishName: 'Danish', flag: '🇩🇰' },\n  { code: 'fi', name: 'Suomi', englishName: 'Finnish', flag: '🇫🇮' },\n  { code: 'pl', name: 'Polski', englishName: 'Polish', flag: '🇵🇱' },\n  { code: 'cs', name: 'Čeština', englishName: 'Czech', flag: '🇨🇿' },\n  { code: 'sk', name: 'Slovenčina', englishName: 'Slovak', flag: '🇸🇰' },\n  { code: 'hu', name: 'Magyar', englishName: 'Hungarian', flag: '🇭🇺' },\n  { code: 'ro', name: 'Română', englishName: 'Romanian', flag: '🇷🇴' },\n  { code: 'bg', name: 'Български', englishName: 'Bulgarian', flag: '🇧🇬' },\n  { code: 'hr', name: 'Hrvatski', englishName: 'Croatian', flag: '🇭🇷' },\n  { code: 'el', name: 'Ελληνικά', englishName: 'Greek', flag: '🇬🇷' },\n  { code: 'sr', name: 'Српски', englishName: 'Serbian', flag: '🇷🇸' },\n  { code: 'sl', name: 'Slovenščina', englishName: 'Slovenian', flag: '🇸🇮' },\n  { code: 'lv', name: 'Latviešu', englishName: 'Latvian', flag: '🇱🇻' },\n  { code: 'lt', name: 'Lietuvių', englishName: 'Lithuanian', flag: '🇱🇹' },\n  { code: 'et', name: 'Eesti', englishName: 'Estonian', flag: '🇪🇪' },\n  { code: 'mt', name: 'Malti', englishName: 'Maltese', flag: '🇲🇹' },\n  { code: 'is', name: 'Íslenska', englishName: 'Icelandic', flag: '🇮🇸' },\n  { code: 'ga', name: 'Gaeilge', englishName: 'Irish', flag: '🇮🇪' },\n  { code: 'cy', name: 'Cymraeg', englishName: 'Welsh', flag: '🏴' },\n  { code: 'eu', name: 'Euskera', englishName: 'Basque', flag: '🇪🇸' },\n  { code: 'ca', name: 'Català', englishName: 'Catalan', flag: '🇪🇸' },\n  { code: 'gl', name: 'Galego', englishName: 'Galician', flag: '🇪🇸' },\n\n  // Middle Eastern & Turkic languages\n  { code: 'tr', name: 'Türkçe', englishName: 'Turkish', flag: '🇹🇷' },\n  { code: 'he', name: 'עברית', englishName: 'Hebrew', flag: '🇮🇱' },\n  { code: 'fa', name: 'فارسی', englishName: 'Persian', flag: '🇮🇷' },\n  { code: 'ur', name: 'اردو', englishName: 'Urdu', flag: '🇵🇰' },\n  { code: 'ku', name: 'Kurdî', englishName: 'Kurdish', flag: '🇹🇷' },\n  { code: 'az', name: 'Azərbaycan', englishName: 'Azerbaijani', flag: '🇦🇿' },\n  { code: 'hy', name: 'Հայերեն', englishName: 'Armenian', flag: '🇦🇲' },\n  { code: 'ka', name: 'ქართული', englishName: 'Georgian', flag: '🇬🇪' },\n\n  // Asian languages\n  { code: 'ja', name: '日本語', englishName: 'Japanese', flag: '🇯🇵' },\n  { code: 'ko', name: '한국어', englishName: 'Korean', flag: '🇰🇷' },\n  { code: 'hi', name: 'हिन्दी', englishName: 'Hindi', flag: '🇮🇳' },\n  { code: 'th', name: 'ไทย', englishName: 'Thai', flag: '🇹🇭' },\n  { code: 'vi', name: 'Tiếng Việt', englishName: 'Vietnamese', flag: '🇻🇳' },\n  { code: 'bn', name: 'বাংলা', englishName: 'Bengali', flag: '🇧🇩' },\n  { code: 'ta', name: 'தமிழ்', englishName: 'Tamil', flag: '🇮🇳' },\n  { code: 'te', name: 'తెలుగు', englishName: 'Telugu', flag: '🇮🇳' },\n  { code: 'ml', name: 'മലയാളം', englishName: 'Malayalam', flag: '🇮🇳' },\n  { code: 'kn', name: 'ಕನ್ನಡ', englishName: 'Kannada', flag: '🇮🇳' },\n  { code: 'gu', name: 'ગુજરાતી', englishName: 'Gujarati', flag: '🇮🇳' },\n  { code: 'mr', name: 'मराठी', englishName: 'Marathi', flag: '🇮🇳' },\n  { code: 'pa', name: 'ਪੰਜਾਬੀ', englishName: 'Punjabi', flag: '🇮🇳' },\n  { code: 'or', name: 'ଓଡ଼ିଆ', englishName: 'Odia', flag: '🇮🇳' },\n  { code: 'as', name: 'অসমীয়া', englishName: 'Assamese', flag: '🇮🇳' },\n  { code: 'ne', name: 'नेपाली', englishName: 'Nepali', flag: '🇳🇵' },\n  { code: 'si', name: 'සිංහල', englishName: 'Sinhala', flag: '🇱🇰' },\n  { code: 'my', name: 'မြန်မာ', englishName: 'Myanmar', flag: '🇲🇲' },\n  { code: 'km', name: 'ខ្មែរ', englishName: 'Khmer', flag: '🇰🇭' },\n  { code: 'lo', name: 'ລາວ', englishName: 'Lao', flag: '🇱🇦' },\n  { code: 'mn', name: 'Монгол', englishName: 'Mongolian', flag: '🇲🇳' },\n  { code: 'bo', name: 'བོད་ཡིག', englishName: 'Tibetan', flag: '🇨🇳' },\n  { code: 'dz', name: 'རྫོང་ཁ', englishName: 'Dzongkha', flag: '🇧🇹' },\n\n  // Southeast Asian languages\n  { code: 'id', name: 'Bahasa Indonesia', englishName: 'Indonesian', flag: '🇮🇩' },\n  { code: 'ms', name: 'Bahasa Melayu', englishName: 'Malay', flag: '🇲🇾' },\n  { code: 'tl', name: 'Filipino', englishName: 'Filipino', flag: '🇵🇭' },\n  { code: 'ceb', name: 'Cebuano', englishName: 'Cebuano', flag: '🇵🇭' },\n  { code: 'jv', name: 'Basa Jawa', englishName: 'Javanese', flag: '🇮🇩' },\n\n  // African languages\n  { code: 'sw', name: 'Kiswahili', englishName: 'Swahili', flag: '🇰🇪' },\n  { code: 'am', name: 'አማርኛ', englishName: 'Amharic', flag: '🇪🇹' },\n  { code: 'yo', name: 'Yorùbá', englishName: 'Yoruba', flag: '🇳🇬' },\n  { code: 'ig', name: 'Igbo', englishName: 'Igbo', flag: '🇳🇬' },\n  { code: 'ha', name: 'Hausa', englishName: 'Hausa', flag: '🇳🇬' },\n  { code: 'zu', name: 'isiZulu', englishName: 'Zulu', flag: '🇿🇦' },\n  { code: 'af', name: 'Afrikaans', englishName: 'Afrikaans', flag: '🇿🇦' },\n  { code: 'xh', name: 'isiXhosa', englishName: 'Xhosa', flag: '🇿🇦' },\n  { code: 'st', name: 'Sesotho', englishName: 'Sotho', flag: '🇱🇸' },\n  { code: 'tn', name: 'Setswana', englishName: 'Tswana', flag: '🇧🇼' },\n  { code: 'ss', name: 'SiSwati', englishName: 'Swati', flag: '🇸🇿' },\n  { code: 've', name: 'Tshivenḓa', englishName: 'Venda', flag: '🇿🇦' },\n  { code: 'ts', name: 'Xitsonga', englishName: 'Tsonga', flag: '🇿🇦' },\n  { code: 'sn', name: 'ChiShona', englishName: 'Shona', flag: '🇿🇼' },\n  { code: 'ny', name: 'ChiCheŵa', englishName: 'Chewa', flag: '🇲🇼' },\n  { code: 'rw', name: 'Kinyarwanda', englishName: 'Kinyarwanda', flag: '🇷🇼' },\n  { code: 'rn', name: 'Kirundi', englishName: 'Kirundi', flag: '🇧🇮' },\n  { code: 'lg', name: 'Luganda', englishName: 'Luganda', flag: '🇺🇬' },\n  { code: 'so', name: 'Soomaali', englishName: 'Somali', flag: '🇸🇴' },\n  { code: 'om', name: 'Afaan Oromoo', englishName: 'Oromo', flag: '🇪🇹' },\n  { code: 'ti', name: 'ትግርኛ', englishName: 'Tigrinya', flag: '🇪🇷' },\n\n  // Latin American indigenous languages\n  { code: 'qu', name: 'Quechua', englishName: 'Quechua', flag: '🇵🇪' },\n  { code: 'gn', name: 'Guaraní', englishName: 'Guarani', flag: '🇵🇾' },\n  { code: 'ay', name: 'Aymará', englishName: 'Aymara', flag: '🇧🇴' },\n\n  // Pacific languages\n  { code: 'mi', name: 'Te Reo Māori', englishName: 'Maori', flag: '🇳🇿' },\n  { code: 'sm', name: 'Gagana Samoa', englishName: 'Samoan', flag: '🇼🇸' },\n  { code: 'to', name: 'Lea Faka-Tonga', englishName: 'Tongan', flag: '🇹🇴' },\n  { code: 'fj', name: 'Na Vosa Vakaviti', englishName: 'Fijian', flag: '🇫🇯' },\n\n  // Additional European languages\n  { code: 'fo', name: 'Føroyskt', englishName: 'Faroese', flag: '🇫🇴' },\n  { code: 'kl', name: 'Kalaallisut', englishName: 'Greenlandic', flag: '🇬🇱' },\n  { code: 'se', name: 'Davvisámegiella', englishName: 'Northern Sami', flag: '🇳🇴' },\n\n  // Other languages\n  { code: 'eo', name: 'Esperanto', englishName: 'Esperanto', flag: '🌍' },\n  { code: 'la', name: 'Latina', englishName: 'Latin', flag: '🇻🇦' },\n  { code: 'sa', name: 'संस्कृतम्', englishName: 'Sanskrit', flag: '🇮🇳' }\n];\n\nconst LanguageSelector = ({ className = '' }) => {\n  const { i18n, t } = useTranslation();\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedLanguages, setSelectedLanguages] = useState(() => {\n    // Get selected languages from localStorage or default to UN languages\n    const saved = localStorage.getItem('sgex-selected-languages');\n    return saved ? JSON.parse(saved) : UN_LANGUAGES.map(lang => lang.code);\n  });\n\n  // Get available languages (UN languages + any additional selected languages)\n  const availableLanguages = useMemo(() => {\n    // Start with all UN languages\n    const languages = [...UN_LANGUAGES];\n    \n    // Add any additional languages that have been selected\n    selectedLanguages.forEach(langCode => {\n      // If this language code is not already in UN_LANGUAGES, find it in ADDITIONAL_LANGUAGES\n      if (!UN_LANGUAGES.some(unLang => unLang.code === langCode)) {\n        const additionalLang = ADDITIONAL_LANGUAGES.find(addLang => addLang.code === langCode);\n        if (additionalLang) {\n          languages.push({\n            code: additionalLang.code,\n            name: additionalLang.name, // Use the native name for additional languages\n            englishName: additionalLang.englishName, // Include English name for consistency\n            flag: additionalLang.flag\n          });\n        }\n      }\n    });\n    \n    // Map the languages to include translated names for UN languages\n    return languages.map(lang => ({\n      ...lang,\n      name: UN_LANGUAGES.some(unLang => unLang.code === lang.code) ? t(lang.name) : lang.name\n    }));\n  }, [selectedLanguages, t]);\n\n  // Get searchable languages (excluding already selected ones)\n  const searchableLanguages = useMemo(() => {\n    if (!searchTerm) return [];\n    \n    const searchLower = searchTerm.toLowerCase();\n    return ADDITIONAL_LANGUAGES.filter(lang => \n      !selectedLanguages.includes(lang.code) &&\n      (lang.name.toLowerCase().includes(searchLower) || \n       lang.englishName.toLowerCase().includes(searchLower) ||\n       lang.code.toLowerCase().includes(searchLower))\n    ).slice(0, 10); // Limit to 10 results\n  }, [searchTerm, selectedLanguages]);\n\n  const currentLanguage = availableLanguages.find(lang => lang.code === i18n.language) || availableLanguages[0];\n\n  const handleLanguageChange = (langCode) => {\n    i18n.changeLanguage(langCode);\n    setIsOpen(false);\n    setSearchTerm('');\n  };\n\n  const handleAddLanguage = (langCode) => {\n    const newSelectedLanguages = [...selectedLanguages, langCode];\n    setSelectedLanguages(newSelectedLanguages);\n    localStorage.setItem('sgex-selected-languages', JSON.stringify(newSelectedLanguages));\n    \n    // Optionally switch to the newly added language\n    i18n.changeLanguage(langCode);\n    setIsOpen(false);\n    setSearchTerm('');\n  };\n\n  const handleSearchChange = (e) => {\n    setSearchTerm(e.target.value);\n  };\n\n  return (\n    <div className={`language-selector ${className}`}>\n      <button\n        className=\"language-toggle\"\n        onClick={() => setIsOpen(!isOpen)}\n        aria-label={t('language.select')}\n        title={t('language.select')}\n      >\n        <span className=\"language-icon\">🐾🎧</span>\n        <span className=\"language-name\">{currentLanguage?.name}</span>\n        <span className={`dropdown-arrow ${isOpen ? 'open' : ''}`}>▼</span>\n      </button>\n      \n      {isOpen && (\n        <div className=\"language-dropdown\">\n          {/* Available Languages */}\n          {availableLanguages.map((language) => (\n            <button\n              key={language.code}\n              className={`language-option ${i18n.language === language.code ? 'active' : ''}`}\n              onClick={() => handleLanguageChange(language.code)}\n            >\n              <span className=\"language-flag\">{language.flag}</span>\n              <span className=\"language-name\">{language.name}</span>\n              {i18n.language === language.code && (\n                <span className=\"language-checkmark\">✓</span>\n              )}\n            </button>\n          ))}\n          \n          {/* Search Section */}\n          <div className=\"language-search-section\">\n            <div className=\"language-search-divider\"></div>\n            <div className=\"language-search-input\">\n              <input\n                type=\"text\"\n                placeholder={t('language.search')}\n                value={searchTerm}\n                onChange={handleSearchChange}\n                className=\"language-search\"\n                autoFocus={false}\n              />\n            </div>\n            \n            {/* Search Results */}\n            {searchableLanguages.map((language) => (\n              <button\n                key={language.code}\n                className=\"language-option language-option-addable\"\n                onClick={() => handleAddLanguage(language.code)}\n              >\n                <span className=\"language-flag\">{language.flag}</span>\n                <span className=\"language-name\">\n                  {language.name}\n                  {language.englishName !== language.name && (\n                    <span className=\"language-english-name\"> ({language.englishName})</span>\n                  )}\n                </span>\n                <span className=\"language-add-icon\">+</span>\n              </button>\n            ))}\n            \n            {searchTerm && searchableLanguages.length === 0 && (\n              <div className=\"language-no-results\">\n                No languages found for \"{searchTerm}\"\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LanguageSelector;","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport helpContentService from '../services/helpContentService';\nimport cacheManagementService from '../services/cacheManagementService';\nimport HelpModal from './HelpModal';\nimport LanguageSelector from './LanguageSelector';\nimport useThemeImage from '../hooks/useThemeImage';\n\nconst ContextualHelpMascot = ({ pageId, helpContent, position = 'bottom-right', contextData = {}, notificationBadge = false }) => {\n  const { t, i18n } = useTranslation();\n  const [showHelp, setShowHelp] = useState(false);\n  const [helpSticky, setHelpSticky] = useState(false);\n  const [selectedHelpTopic, setSelectedHelpTopic] = useState(null);\n  const [isDarkMode, setIsDarkMode] = useState(true);\n  const [cacheClearing, setCacheClearing] = useState(false);\n  const [cacheCleared, setCacheCleared] = useState(false);\n\n  // Theme-aware mascot image\n  const mascotImage = useThemeImage('sgex-mascot.png');\n\n  // Load theme preference from localStorage on mount\n  useEffect(() => {\n    const savedTheme = localStorage.getItem('sgex-theme');\n    if (savedTheme) {\n      setIsDarkMode(savedTheme === 'dark');\n    } else {\n      // Check if user explicitly prefers light mode\n      let prefersLight = false;\n      try {\n        if (window.matchMedia) {\n          prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;\n        }\n      } catch (e) {\n        // Fallback for test environments\n        prefersLight = false;\n      }\n      // Default to dark mode unless user explicitly prefers light\n      setIsDarkMode(!prefersLight);\n    }\n  }, []);\n\n  // Update body class when theme changes\n  useEffect(() => {\n    document.body.className = isDarkMode ? 'theme-dark' : 'theme-light';\n    localStorage.setItem('sgex-theme', isDarkMode ? 'dark' : 'light');\n  }, [isDarkMode]);\n\n  // Update document direction for RTL languages\n  useEffect(() => {\n    const currentLang = i18n.language || 'en';\n    const isRTL = ['ar', 'he', 'fa'].includes(currentLang);\n    document.documentElement.dir = isRTL ? 'rtl' : 'ltr';\n    document.documentElement.lang = currentLang;\n  }, [i18n.language]);\n\n  const toggleTheme = () => {\n    setIsDarkMode(!isDarkMode);\n  };\n\n  // Get help topics for the page\n  const helpTopics = pageId ? helpContentService.getHelpTopicsForPage(pageId, contextData) : [];\n\n  const handleMouseEnter = () => {\n    if (!helpSticky) {\n      setShowHelp(true);\n    }\n  };\n\n  const handleMouseLeave = () => {\n    if (!helpSticky) {\n      setShowHelp(false);\n    }\n  };\n\n  const handleClick = () => {\n    setHelpSticky(!helpSticky);\n    setShowHelp(!helpSticky || showHelp);\n  };\n\n  const handleCloseHelp = () => {\n    setShowHelp(false);\n    setHelpSticky(false);\n  };\n\n  const handleHelpTopicClick = (topic) => {\n    // If it's an action type, execute the action immediately\n    if (topic.type === 'action' && topic.action) {\n      topic.action();\n      setShowHelp(false);\n      setHelpSticky(false);\n    } else {\n      // For slideshow and other types, show in modal\n      setSelectedHelpTopic(topic);\n      setShowHelp(false);\n      setHelpSticky(false);\n    }\n  };\n\n  const handleCloseModal = () => {\n    setSelectedHelpTopic(null);\n  };\n\n  const handleFlushCache = async () => {\n    if (cacheClearing) return; // Prevent multiple clicks\n    \n    setCacheClearing(true);\n    setCacheCleared(false);\n    \n    try {\n      const success = cacheManagementService.clearAllCache();\n      if (success) {\n        setCacheCleared(true);\n        // Auto-hide success message after 3 seconds\n        setTimeout(() => {\n          setCacheCleared(false);\n        }, 3000);\n      } else {\n        console.error('Failed to clear cache');\n        alert('Failed to clear cache. Please try again.');\n      }\n    } catch (error) {\n      console.error('Error clearing cache:', error);\n      alert('Error clearing cache. Please try again.');\n    } finally {\n      setCacheClearing(false);\n    }\n  };\n\n  // Always render the mascot now since we have universal topics\n  // if (!hasTopics) {\n  //   return null;\n  // }\n\n  return (\n    <>\n      <div className={`contextual-help-mascot ${position}`}>\n        <div \n          className=\"mascot-container\"\n          onMouseEnter={handleMouseEnter}\n          onMouseLeave={handleMouseLeave}\n          onClick={handleClick}\n        >\n          <img \n            src={mascotImage} \n            alt=\"SGEX Helper\" \n            className=\"mascot-icon\"\n          />\n          \n          {/* Notification badge for important help messages */}\n          {notificationBadge && (\n            <div className=\"notification-badge\">\n              !\n            </div>\n          )}\n          \n          {/* Question mark thought bubble - always show since we always have topics now */}\n          {!notificationBadge && (\n            <div className={`question-bubble ${showHelp ? 'help-open' : ''}`}>\n              ?\n            </div>\n          )}\n        </div>\n        \n        {showHelp && (\n          <div className=\"help-thought-bubble\">\n            <div className=\"bubble-content\">\n              {helpSticky && (\n                <button \n                  className=\"close-bubble-btn\"\n                  onClick={handleCloseHelp}\n                  aria-label=\"Close help\"\n                >\n                  ×\n                </button>\n              )}\n              <div className=\"help-text\">\n                {helpTopics.length > 0 ? (\n                  <div className=\"help-topics-list\">\n                    <h4>{t('help.title')}</h4>\n                    {helpTopics.map((topic) => (\n                      <button\n                        key={topic.id}\n                        className=\"help-topic-btn\"\n                        onClick={() => handleHelpTopicClick(topic)}\n                      >\n                        {topic.badge && (\n                          <img \n                            src={topic.badge} \n                            alt=\"\" \n                            className=\"help-topic-badge\"\n                          />\n                        )}\n                        <span className=\"help-topic-title\">{topic.title}</span>\n                      </button>\n                    ))}\n                    \n                    {/* Language Selector in Help Menu */}\n                    <div className=\"help-menu-divider\"></div>\n                    <LanguageSelector className=\"help-menu-language-selector\" />\n                    \n                    {/* Theme Toggle in Help Menu */}\n                    <div className=\"help-menu-divider\"></div>\n                    <button \n                      className={`help-theme-toggle-btn ${isDarkMode ? 'dark' : 'light'}`}\n                      onClick={toggleTheme}\n                      aria-label={t('theme.toggle')}\n                      title={t('theme.toggle')}\n                    >\n                      <span className=\"theme-icon\">{isDarkMode ? '🌞' : '🌙'}</span>\n                      <span className=\"theme-label\">{isDarkMode ? t('theme.switchToLight', 'Light Mode') : t('theme.switchToDark', 'Dark Mode')}</span>\n                    </button>\n                    \n                    {/* Flush Cache Option */}\n                    <div className=\"help-menu-divider\"></div>\n                    <div className=\"help-menu-cache-section\">\n                      {cacheCleared ? (\n                        <div className=\"cache-success-message\">\n                          ✅ Cache cleared successfully!\n                        </div>\n                      ) : (\n                        <button\n                          className=\"help-cache-btn\"\n                          onClick={handleFlushCache}\n                          disabled={cacheClearing}\n                          title=\"Clear all cached data including repository info, branch context, and staging ground data\"\n                        >\n                          {cacheClearing ? '🔄 Clearing...' : '🗑️ Flush Cache'}\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                ) : (\n                  <div>\n                    {helpContent}\n                    {/* Language Selector in Help Menu */}\n                    <div className=\"help-menu-divider\"></div>\n                    <LanguageSelector className=\"help-menu-language-selector\" />\n                    \n                    {/* Theme Toggle in Help Menu */}\n                    <div className=\"help-menu-divider\"></div>\n                    <button \n                      className={`help-theme-toggle-btn ${isDarkMode ? 'dark' : 'light'}`}\n                      onClick={toggleTheme}\n                      aria-label={t('theme.toggle')}\n                      title={t('theme.toggle')}\n                    >\n                      <span className=\"theme-icon\">{isDarkMode ? '🌞' : '🌙'}</span>\n                      <span className=\"theme-label\">{isDarkMode ? t('theme.switchToLight', 'Light Mode') : t('theme.switchToDark', 'Dark Mode')}</span>\n                    </button>\n                    \n                    {/* Flush Cache Option */}\n                    <div className=\"help-menu-divider\"></div>\n                    <div className=\"help-menu-cache-section\">\n                      {cacheCleared ? (\n                        <div className=\"cache-success-message\">\n                          ✅ Cache cleared successfully!\n                        </div>\n                      ) : (\n                        <button\n                          className=\"help-cache-btn\"\n                          onClick={handleFlushCache}\n                          disabled={cacheClearing}\n                          title=\"Clear all cached data including repository info, branch context, and staging ground data\"\n                        >\n                          {cacheClearing ? '🔄 Clearing...' : '🗑️ Flush Cache'}\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n            <div className=\"bubble-tail\"></div>\n          </div>\n        )}\n      </div>\n      \n      {/* Help Modal for displaying slideshow content */}\n      {selectedHelpTopic && (\n        <HelpModal\n          helpTopic={selectedHelpTopic}\n          contextData={contextData}\n          onClose={handleCloseModal}\n        />\n      )}\n    </>\n  );\n};\n\nexport default ContextualHelpMascot;","import { useState, useEffect } from 'react';\n\n/**\n * Custom hook that returns the appropriate image path based on the current theme\n * @param {string} baseImagePath - The base image path (e.g., \"sgex-mascot.png\", \"authoring.png\")\n * @returns {string} The theme-appropriate image path\n */\nconst useThemeImage = (baseImagePath) => {\n  const [currentImagePath, setCurrentImagePath] = useState(baseImagePath);\n\n  useEffect(() => {\n    const updateImagePath = () => {\n      const isDarkMode = document.body.classList.contains('theme-dark');\n      \n      // Get the correct base path for the deployment environment\n      const publicUrl = process.env.PUBLIC_URL || '';\n      \n      // Normalize the base image path (remove leading slash if present)\n      const normalizedPath = baseImagePath.startsWith('/') ? baseImagePath.slice(1) : baseImagePath;\n      \n      let finalPath;\n      if (isDarkMode) {\n        // Convert base image to dark mode version\n        // e.g., \"sgex-mascot.png\" -> \"sgex-mascot_grey_tabby.png\"\n        const darkImageName = normalizedPath.replace(/\\.png$/, '_grey_tabby.png');\n        finalPath = publicUrl ? `${publicUrl}/${darkImageName}` : `/${darkImageName}`;\n      } else {\n        // Use original image for light mode\n        finalPath = publicUrl ? `${publicUrl}/${normalizedPath}` : `/${normalizedPath}`;\n      }\n      \n      setCurrentImagePath(finalPath);\n    };\n\n    // Initial update\n    updateImagePath();\n\n    // Create a MutationObserver to watch for body class changes\n    const observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {\n          updateImagePath();\n        }\n      });\n    });\n\n    // Start observing the body for class changes\n    observer.observe(document.body, {\n      attributes: true,\n      attributeFilter: ['class']\n    });\n\n    // Cleanup observer on unmount\n    return () => {\n      observer.disconnect();\n    };\n  }, [baseImagePath]);\n\n  return currentImagePath;\n};\n\nexport default useThemeImage;","/**\n * Staging Ground Service\n * \n * Manages local changes to DAK components before they are committed to GitHub.\n * Provides persistent storage, versioning, and integration interfaces for DAK editing tools.\n */\n\nclass StagingGroundService {\n  constructor() {\n    this.listeners = new Set();\n    this.currentRepository = null;\n    this.currentBranch = null;\n  }\n\n  /**\n   * Initialize staging ground for a specific repository and branch\n   */\n  initialize(repository, branch) {\n    this.currentRepository = repository;\n    this.currentBranch = branch;\n    this.notifyListeners();\n  }\n\n  /**\n   * Get the storage key for current repository and branch\n   */\n  getStorageKey() {\n    if (!this.currentRepository || !this.currentBranch) {\n      throw new Error('Staging ground not initialized');\n    }\n    return `sgex_staging_${this.currentRepository.full_name}_${this.currentBranch}`;\n  }\n\n  /**\n   * Get current staging ground state\n   */\n  getStagingGround() {\n    try {\n      const key = this.getStorageKey();\n      const stored = localStorage.getItem(key);\n      if (!stored) {\n        return this.createEmptyStagingGround();\n      }\n      return JSON.parse(stored);\n    } catch (error) {\n      console.warn('Error reading staging ground from localStorage:', error);\n      return this.createEmptyStagingGround();\n    }\n  }\n\n  /**\n   * Create empty staging ground structure\n   */\n  createEmptyStagingGround() {\n    return {\n      message: '',\n      files: [],\n      timestamp: Date.now(),\n      branch: this.currentBranch,\n      repository: this.currentRepository?.full_name\n    };\n  }\n\n  /**\n   * Save staging ground state to localStorage\n   */\n  saveStagingGround(stagingGround) {\n    try {\n      const key = this.getStorageKey();\n      stagingGround.timestamp = Date.now();\n      stagingGround.branch = this.currentBranch;\n      stagingGround.repository = this.currentRepository?.full_name;\n      \n      localStorage.setItem(key, JSON.stringify(stagingGround));\n      this.saveToHistory(stagingGround);\n      this.notifyListeners();\n      return true;\n    } catch (error) {\n      console.error('Error saving staging ground to localStorage:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Add or update a file in the staging ground\n   */\n  updateFile(filePath, content, metadata = {}) {\n    const stagingGround = this.getStagingGround();\n    \n    // Find existing file or create new one\n    const existingFileIndex = stagingGround.files.findIndex(f => f.path === filePath);\n    const fileObject = {\n      path: filePath,\n      content: content,\n      metadata: {\n        ...metadata,\n        lastModified: Date.now()\n      },\n      timestamp: Date.now()\n    };\n\n    if (existingFileIndex >= 0) {\n      stagingGround.files[existingFileIndex] = fileObject;\n    } else {\n      stagingGround.files.push(fileObject);\n    }\n\n    return this.saveStagingGround(stagingGround);\n  }\n\n  /**\n   * Remove a file from the staging ground\n   */\n  removeFile(filePath) {\n    const stagingGround = this.getStagingGround();\n    stagingGround.files = stagingGround.files.filter(f => f.path !== filePath);\n    return this.saveStagingGround(stagingGround);\n  }\n\n  /**\n   * Update commit message\n   */\n  updateCommitMessage(message) {\n    const stagingGround = this.getStagingGround();\n    stagingGround.message = message;\n    return this.saveStagingGround(stagingGround);\n  }\n\n  /**\n   * Check if staging ground has changes\n   */\n  hasChanges() {\n    const stagingGround = this.getStagingGround();\n    return stagingGround.files.length > 0;\n  }\n\n  /**\n   * Get count of changed files\n   */\n  getChangedFilesCount() {\n    const stagingGround = this.getStagingGround();\n    return stagingGround.files.length;\n  }\n\n  /**\n   * Clear all changes in staging ground\n   */\n  clearStagingGround() {\n    const empty = this.createEmptyStagingGround();\n    return this.saveStagingGround(empty);\n  }\n\n  /**\n   * Save current state to history for rollback\n   */\n  saveToHistory(stagingGround) {\n    try {\n      const historyKey = `${this.getStorageKey()}_history`;\n      const history = this.getHistory();\n      \n      // Add current state to history\n      history.push({\n        ...stagingGround,\n        savedAt: Date.now()\n      });\n\n      // Keep only last 10 saves\n      const recentHistory = history.slice(-10);\n      localStorage.setItem(historyKey, JSON.stringify(recentHistory));\n      \n    } catch (error) {\n      console.warn('Error saving to history:', error);\n    }\n  }\n\n  /**\n   * Get history of saves\n   */\n  getHistory() {\n    try {\n      const historyKey = `${this.getStorageKey()}_history`;\n      const stored = localStorage.getItem(historyKey);\n      return stored ? JSON.parse(stored) : [];\n    } catch (error) {\n      console.warn('Error reading history:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Rollback to a previous save\n   */\n  rollbackToSave(timestamp) {\n    const history = this.getHistory();\n    const save = history.find(s => s.savedAt === timestamp);\n    \n    if (!save) {\n      throw new Error('Save not found in history');\n    }\n\n    // Remove the savedAt timestamp before restoring\n    const { savedAt, ...stagingGroundState } = save;\n    return this.saveStagingGround(stagingGroundState);\n  }\n\n  /**\n   * Export staging ground state for backup/sharing\n   */\n  exportStagingGround() {\n    const stagingGround = this.getStagingGround();\n    const history = this.getHistory();\n    \n    return {\n      current: stagingGround,\n      history: history,\n      exportedAt: Date.now(),\n      repository: this.currentRepository?.full_name,\n      branch: this.currentBranch\n    };\n  }\n\n  /**\n   * Import staging ground state from backup\n   */\n  importStagingGround(exportedData) {\n    if (!exportedData.current || !exportedData.repository || !exportedData.branch) {\n      throw new Error('Invalid export data format');\n    }\n\n    if (exportedData.repository !== this.currentRepository?.full_name ||\n        exportedData.branch !== this.currentBranch) {\n      throw new Error('Export data is for different repository or branch');\n    }\n\n    // Save current state and import new one\n    this.saveStagingGround(exportedData.current);\n    \n    // Import history if available\n    if (exportedData.history) {\n      try {\n        const historyKey = `${this.getStorageKey()}_history`;\n        localStorage.setItem(historyKey, JSON.stringify(exportedData.history));\n      } catch (error) {\n        console.warn('Error importing history:', error);\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Clean up old staging grounds and history\n   */\n  cleanup(maxAge = 7 * 24 * 60 * 60 * 1000) { // 7 days default\n    try {\n      const now = Date.now();\n      const keysToRemove = [];\n\n      // Check all localStorage keys for old staging grounds\n      for (let i = 0; i < localStorage.length; i++) {\n        const key = localStorage.key(i);\n        if (key && key.startsWith('sgex_staging_')) {\n          try {\n            const data = JSON.parse(localStorage.getItem(key));\n            if (data.timestamp && (now - data.timestamp) > maxAge) {\n              keysToRemove.push(key);\n              keysToRemove.push(`${key}_history`);\n            }\n          } catch (error) {\n            // Invalid data, mark for removal\n            keysToRemove.push(key);\n          }\n        }\n      }\n\n      // Remove old entries\n      keysToRemove.forEach(key => {\n        localStorage.removeItem(key);\n      });\n\n      return keysToRemove.length;\n    } catch (error) {\n      console.error('Error during cleanup:', error);\n      return 0;\n    }\n  }\n\n  /**\n   * Add listener for staging ground changes\n   */\n  addListener(callback) {\n    this.listeners.add(callback);\n    \n    // Return unsubscribe function\n    return () => {\n      this.listeners.delete(callback);\n    };\n  }\n\n  /**\n   * Notify all listeners of changes\n   */\n  notifyListeners() {\n    const stagingGround = this.getStagingGround();\n    this.listeners.forEach(callback => {\n      try {\n        callback(stagingGround);\n      } catch (error) {\n        console.error('Error in staging ground listener:', error);\n      }\n    });\n  }\n\n  /**\n   * Interface for DAK editing tools to contribute files\n   */\n  contributeFiles(files, metadata = {}) {\n    if (!Array.isArray(files)) {\n      files = [files];\n    }\n\n    let success = true;\n    const results = [];\n\n    files.forEach(file => {\n      if (!file.path || !file.content) {\n        results.push({ path: file.path, success: false, error: 'Missing path or content' });\n        success = false;\n        return;\n      }\n\n      const result = this.updateFile(file.path, file.content, {\n        ...metadata,\n        source: metadata.tool || 'unknown',\n        contributedAt: Date.now()\n      });\n\n      results.push({ path: file.path, success: result });\n      if (!result) success = false;\n    });\n\n    return { success, results };\n  }\n\n  /**\n   * Get status for DAK editing tools\n   */\n  getStatus() {\n    const stagingGround = this.getStagingGround();\n    return {\n      hasChanges: this.hasChanges(),\n      filesCount: this.getChangedFilesCount(),\n      lastModified: stagingGround.timestamp,\n      branch: this.currentBranch,\n      repository: this.currentRepository?.full_name\n    };\n  }\n}\n\n// Create singleton instance\nconst stagingGroundService = new StagingGroundService();\n\nexport default stagingGroundService;","import React, { useState, useEffect } from 'react';\nimport useThemeImage from '../hooks/useThemeImage';\n\nconst HelpModal = ({ topic, helpTopic, contextData, onClose }) => {\n  const [showMenu, setShowMenu] = useState(false);\n  const [currentSlide, setCurrentSlide] = useState(0);\n\n  // Theme-aware mascot image\n  const mascotImage = useThemeImage('sgex-mascot.png');\n\n  // Set up global reference for inline onclick handlers\n  useEffect(() => {\n    const createContextualUrl = (baseUrl, params) => {\n      const urlParams = new URLSearchParams(params);\n      \n      // Add contextual information\n      if (contextData.pageId) {\n        urlParams.set('sgex_page', contextData.pageId);\n      }\n      \n      const currentUrl = window.location.href;\n      urlParams.set('sgex_current_url', currentUrl);\n      \n      if (contextData.selectedDak?.name) {\n        urlParams.set('sgex_selected_dak', contextData.selectedDak.name);\n      }\n      \n      return `${baseUrl}?${urlParams.toString()}`;\n    };\n\n    window.helpModalInstance = {\n      openSgexIssue: (issueType) => {\n        const baseUrl = `https://github.com/litlfred/sgex/issues/new`;\n        let params = {};\n\n        switch (issueType) {\n          case 'bug':\n            params.template = 'bug_report.yml';\n            params.labels = 'bug';\n            break;\n          case 'feature':\n            params.template = 'feature_request.yml';\n            params.labels = 'enhancement';\n            break;\n          case 'question':\n            params.template = 'question.yml';\n            params.labels = 'question';\n            break;\n          case 'documentation':\n            params.template = 'documentation.yml';\n            params.labels = 'documentation';\n            break;\n          case 'blank':\n            // No template specified - this will allow users to create a blank issue\n            params.labels = 'blank-issue';\n            break;\n          default:\n            params.labels = 'needs-triage';\n        }\n\n        const url = createContextualUrl(baseUrl, params);\n        \n        // Try to open the GitHub issue, but handle cases where external links are blocked\n        try {\n          const newWindow = window.open(url, '_blank');\n          \n          // Check if the window was blocked or failed to open\n          if (!newWindow || newWindow.closed) {\n            // Fallback: show instructions to manually open the link\n            window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, issueType);\n          } else {\n            // Check if the window actually loaded after a brief delay\n            setTimeout(() => {\n              try {\n                if (newWindow.closed || !newWindow.location || newWindow.location.href === 'about:blank') {\n                  newWindow.close();\n                  window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, issueType);\n                }\n              } catch (e) {\n                // Cross-origin restriction means it probably loaded successfully\n                // or the check failed due to security - either way, don't show fallback\n              }\n            }, 1000);\n          }\n        } catch (error) {\n          console.warn('Failed to open GitHub issue:', error);\n          window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, issueType);\n        }\n      },\n\n      openDakIssue: (issueType) => {\n        const repository = contextData.repository || contextData.selectedDak;\n        if (!repository) {\n          console.warn('No DAK repository specified for feedback');\n          return;\n        }\n\n        const baseUrl = `https://github.com/${repository.owner}/${repository.name}/issues/new`;\n        let params = {};\n\n        switch (issueType) {\n          case 'bug':\n            params.template = 'dak_bug_report.yml';\n            params.labels = 'bug,dak-issue';\n            break;\n          case 'improvement':\n            params.template = 'dak_feature_request.yml';\n            params.labels = 'enhancement,dak-improvement';\n            break;\n          case 'content':\n            params.template = 'dak_content_error.yml';\n            params.labels = 'content-issue,clinical-content';\n            break;\n          case 'question':\n            params.template = 'dak_question.yml';\n            params.labels = 'question,dak-question';\n            break;\n          case 'blank':\n            // No template specified - this will allow users to create a blank issue\n            params.labels = 'blank-issue,dak-feedback';\n            break;\n          default:\n            params.labels = 'dak-feedback';\n        }\n\n        // Add DAK-specific context\n        if (repository.name) {\n          params.sgex_dak_repository = `${repository.owner}/${repository.name}`;\n        }\n\n        const url = createContextualUrl(baseUrl, params);\n        \n        // Try to open the GitHub issue, but handle cases where external links are blocked\n        try {\n          const newWindow = window.open(url, '_blank');\n          \n          // Check if the window was blocked or failed to open\n          if (!newWindow || newWindow.closed) {\n            // Fallback: show instructions to manually open the link\n            window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, `dak-${issueType}`);\n          } else {\n            // Check if the window actually loaded after a brief delay\n            setTimeout(() => {\n              try {\n                if (newWindow.closed || !newWindow.location || newWindow.location.href === 'about:blank') {\n                  newWindow.close();\n                  window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, `dak-${issueType}`);\n                }\n              } catch (e) {\n                // Cross-origin restriction means it probably loaded successfully\n                // or the check failed due to security - either way, don't show fallback\n              }\n            }, 1000);\n          }\n        } catch (error) {\n          console.warn('Failed to open DAK issue:', error);\n          window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, `dak-${issueType}`);\n        }\n      },\n\n      // Function to show fallback instructions when GitHub access is blocked\n      showFallbackInstructions: (reason, url, issueType) => {\n        const instructions = {\n          'github-blocked': {\n            title: 'GitHub Access Required',\n            message: `\n              <div class=\"help-fallback-notice\">\n                <h4>🔗 GitHub Link Blocked</h4>\n                <p>It looks like GitHub access is restricted in your current environment.</p>\n                <h5>To report this issue:</h5>\n                <ol>\n                  <li>Copy the link below</li>\n                  <li>Open it in a browser with GitHub access</li>\n                  <li>Fill out the issue template</li>\n                </ol>\n                <div class=\"fallback-url\">\n                  <strong>Link to copy:</strong><br>\n                  <textarea readonly onclick=\"this.select()\" style=\"width: 100%; height: 60px; margin: 5px 0; padding: 5px; font-family: monospace; font-size: 12px;\">${url}</textarea>\n                </div>\n                <p><em>💡 Tip: You can also email us at <a href=\"mailto:smart@who.int\">smart@who.int</a> with your issue details.</em></p>\n              </div>\n            `\n          }\n        };\n\n        const fallback = instructions[reason] || {\n          title: 'External Link Issue',\n          message: `<p>Unable to open external link. Please copy and visit: <br><code>${url}</code></p>`\n        };\n\n        // Create a temporary modal-like alert for fallback instructions\n        const existingFallback = document.querySelector('.help-fallback-overlay');\n        if (existingFallback) {\n          existingFallback.remove();\n        }\n\n        const fallbackOverlay = document.createElement('div');\n        fallbackOverlay.className = 'help-fallback-overlay';\n        fallbackOverlay.style.cssText = `\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background: rgba(0, 0, 0, 0.7);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          z-index: 10000;\n          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n        `;\n\n        const fallbackModal = document.createElement('div');\n        fallbackModal.style.cssText = `\n          background: white;\n          border-radius: 8px;\n          padding: 20px;\n          max-width: 500px;\n          max-height: 80vh;\n          overflow-y: auto;\n          position: relative;\n          box-shadow: 0 10px 25px rgba(0,0,0,0.3);\n        `;\n\n        fallbackModal.innerHTML = `\n          <button onclick=\"this.closest('.help-fallback-overlay').remove()\" style=\"\n            position: absolute;\n            top: 10px;\n            right: 15px;\n            background: none;\n            border: none;\n            font-size: 24px;\n            cursor: pointer;\n            color: #666;\n          \">×</button>\n          <h3 style=\"margin-top: 0; color: #333;\">${fallback.title}</h3>\n          <div style=\"color: #555; line-height: 1.5;\">${fallback.message}</div>\n        `;\n\n        fallbackOverlay.appendChild(fallbackModal);\n        document.body.appendChild(fallbackOverlay);\n\n        // Click outside to close\n        fallbackOverlay.addEventListener('click', (e) => {\n          if (e.target === fallbackOverlay) {\n            fallbackOverlay.remove();\n          }\n        });\n\n        // Auto-remove after 30 seconds\n        setTimeout(() => {\n          if (document.body.contains(fallbackOverlay)) {\n            fallbackOverlay.remove();\n          }\n        }, 30000);\n      }\n    };\n\n    return () => {\n      // Cleanup\n      delete window.helpModalInstance;\n    };\n  }, [contextData]);\n\n  const handleOverlayClick = (e) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  const handleMenuToggle = () => {\n    setShowMenu(!showMenu);\n  };\n\n  const handleBugReport = () => {\n    // Use the new SGEX issue reporting system\n    if (window.helpModalInstance?.openSgexIssue) {\n      window.helpModalInstance.openSgexIssue('bug');\n    } else {\n      // Fallback to direct URL\n      const params = new URLSearchParams({\n        template: 'bug_report.yml',\n        labels: 'bug',\n        sgex_page: contextData.pageId || 'unknown',\n        sgex_current_url: window.location.href\n      });\n      \n      if (contextData.selectedDak?.name) {\n        params.set('sgex_selected_dak', contextData.selectedDak.name);\n      }\n      \n      const url = `https://github.com/litlfred/sgex/issues/new?${params.toString()}`;\n      \n      // Try to open with error handling\n      try {\n        const newWindow = window.open(url, '_blank');\n        if (!newWindow || newWindow.closed) {\n          window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, 'bug');\n        }\n      } catch (error) {\n        console.warn('Failed to open GitHub issue:', error);\n        window.helpModalInstance?.showFallbackInstructions?.('github-blocked', url, 'bug');\n      }\n    }\n  };\n\n  const handleDAKFeedback = () => {\n    if (contextData.repository) {\n      // Default to opening content error as the primary DAK feedback type\n      if (window.helpModalInstance?.openDakIssue) {\n        window.helpModalInstance.openDakIssue('content');\n      }\n    }\n  };\n\n  const handleEmailSupport = () => {\n    const topicTitle = helpTopic?.title || topic;\n    const subject = encodeURIComponent(`SGEX Workbench Support: ${topicTitle}`);\n    const body = encodeURIComponent(`\nHello SMART Guidelines Team,\n\nI need assistance with the SGEX Workbench.\n\nTopic: ${topicTitle}\nPage: ${window.location.pathname}\n\nPlease describe your question or issue:\n\n\nBest regards,\n    `.trim());\n    \n    window.open(`mailto:smart@who.int?subject=${subject}&body=${body}`);\n  };\n\n  const handleDocumentation = () => {\n    window.open('/sgex/docs/overview', '_blank');\n  };\n\n  const handlePrevSlide = () => {\n    if (currentSlide > 0) {\n      setCurrentSlide(currentSlide - 1);\n    }\n  };\n\n  const handleNextSlide = () => {\n    if (helpTopic?.content && currentSlide < helpTopic.content.length - 1) {\n      setCurrentSlide(currentSlide + 1);\n    }\n  };\n\n  const renderSlideshow = () => {\n    if (!helpTopic?.content || helpTopic.type !== 'slideshow') {\n      return null;\n    }\n\n    const slides = helpTopic.content;\n    const currentSlideData = slides[currentSlide];\n\n    // Handle DAK feedback buttons by replacing onclick handlers\n    let processedContent = currentSlideData.content;\n    if (helpTopic.id === 'provide-dak-feedback') {\n      processedContent = processedContent.replace(\n        /onclick=\"this\\.openDakIssue\\('([^']+)'\\)\"/g,\n        `onclick=\"window.helpModalInstance?.openDakIssue('$1')\"`\n      );\n    }\n\n    return (\n      <div className=\"help-slideshow\">\n        <div className=\"slideshow-header\">\n          <h3>{currentSlideData.title}</h3>\n          <div className=\"slide-counter\">\n            {currentSlide + 1} of {slides.length}\n          </div>\n        </div>\n        \n        <div \n          className=\"slideshow-content\"\n          dangerouslySetInnerHTML={{ __html: processedContent }}\n        />\n        \n        <div className=\"slideshow-controls\">\n          <button \n            onClick={handlePrevSlide}\n            disabled={currentSlide === 0}\n            className=\"slide-nav-btn\"\n          >\n            ← Previous\n          </button>\n          \n          <div className=\"slide-dots\">\n            {slides.map((_, index) => (\n              <button\n                key={index}\n                className={`slide-dot ${index === currentSlide ? 'active' : ''}`}\n                onClick={() => setCurrentSlide(index)}\n                aria-label={`Go to slide ${index + 1}`}\n              />\n            ))}\n          </div>\n          \n          <button \n            onClick={handleNextSlide}\n            disabled={currentSlide === slides.length - 1}\n            className=\"slide-nav-btn\"\n          >\n            Next →\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  const getHelpContent = () => {\n    // If we have a specific help topic, use it\n    if (helpTopic) {\n      return {\n        title: helpTopic.title,\n        content: helpTopic.type === 'slideshow' ? renderSlideshow() : (\n          <div className=\"help-content\">\n            <div className=\"mascot-message\">\n              <img src={mascotImage} alt=\"SGEX Helper\" className=\"help-mascot\" />\n              <div className=\"message-bubble\">\n                <div dangerouslySetInnerHTML={{ __html: helpTopic.content }} />\n              </div>\n            </div>\n          </div>\n        )\n      };\n    }\n\n    // Legacy support for old topic strings\n    switch (topic) {\n      case 'github-token':\n      case 'pat-help':\n        return {\n          title: 'GitHub Authentication Help',\n          content: (\n            <div className=\"help-content\">\n              <div className=\"mascot-message\">\n                <img src={mascotImage} alt=\"SGEX Helper\" className=\"help-mascot\" />\n                <div className=\"message-bubble\">\n                  <p>SGEX Workbench uses GitHub Personal Access Tokens for secure authentication!</p>\n                  <p><strong>How it works:</strong></p>\n                  <ul>\n                    <li>Create a Personal Access Token in your GitHub settings</li>\n                    <li>Enter the token in the login form</li>\n                    <li>SGEX will securely connect to your GitHub repositories</li>\n                    <li>No backend server required - works entirely in your browser!</li>\n                  </ul>\n                  <p>This approach ensures compliance with our no-backend requirement while keeping your data secure.</p>\n                  <p>If you're having trouble, please use the menu above to get additional support.</p>\n                </div>\n              </div>\n            </div>\n          )\n        };\n      default:\n        return {\n          title: 'SGEX Workbench Help',\n          content: (\n            <div className=\"help-content\">\n              <div className=\"mascot-message\">\n                <img src={mascotImage} alt=\"SGEX Helper\" className=\"help-mascot\" />\n                <div className=\"message-bubble\">\n                  <p>Hi! I'm here to help you with the SGEX Workbench.</p>\n                  <p>Use the menu in the top right to get additional support options.</p>\n                </div>\n              </div>\n            </div>\n          )\n        };\n    }\n  };\n\n  const { title, content } = getHelpContent();\n\n  return (\n    <div className=\"help-modal-overlay\" onClick={handleOverlayClick}>\n      <div className=\"help-modal\">\n        <div className=\"help-modal-header\">\n          <h2>{title}</h2>\n          <div className=\"help-modal-actions\">\n            <button \n              className=\"hamburger-menu-btn\"\n              onClick={handleMenuToggle}\n              aria-label=\"More options\"\n            >\n              <span></span>\n              <span></span>\n              <span></span>\n            </button>\n            <button \n              className=\"close-btn\"\n              onClick={onClose}\n              aria-label=\"Close help\"\n            >\n              ×\n            </button>\n          </div>\n          \n          {showMenu && (\n            <div className=\"help-menu-dropdown\">\n              <button onClick={handleDocumentation} className=\"menu-item\">\n                <span className=\"menu-icon\">📖</span>\n                Documentation\n              </button>\n              \n              <button onClick={handleBugReport} className=\"menu-item\">\n                <img src=\"/sgex/bug-report-icon.svg\" alt=\"Bug\" className=\"menu-icon\" />\n                File Bug Report\n              </button>\n              \n              {contextData.repository && (\n                <button onClick={handleDAKFeedback} className=\"menu-item\">\n                  <span className=\"menu-icon\">📝</span>\n                  Provide DAK Feedback\n                </button>\n              )}\n              \n              <button onClick={handleEmailSupport} className=\"menu-item\">\n                <span className=\"menu-icon\">📧</span>\n                Email Support\n              </button>\n            </div>\n          )}\n        </div>\n        \n        <div className=\"help-modal-content\">\n          {content}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default HelpModal;","/**\n * Repository Cache Service\n * Manages caching of discovered SMART Guidelines repositories with expiry\n */\n\nimport logger from '../utils/logger';\n\nclass RepositoryCacheService {\n  constructor() {\n    this.CACHE_KEY_PREFIX = 'sgex_repo_cache_';\n    this.CACHE_EXPIRY_HOURS = 24; // Cache expires after 24 hours\n    this.logger = logger.getLogger('RepositoryCacheService');\n    this.logger.debug('RepositoryCacheService initialized', { \n      cacheExpiryHours: this.CACHE_EXPIRY_HOURS \n    });\n  }\n\n  /**\n   * Generate cache key for a user/organization\n   */\n  getCacheKey(owner, type = 'user') {\n    return `${this.CACHE_KEY_PREFIX}${type}_${owner}`;\n  }\n\n  /**\n   * Check if cached data is stale (older than 24 hours)\n   */\n  isStale(timestamp) {\n    const now = Date.now();\n    const cacheAge = now - timestamp;\n    const maxAge = this.CACHE_EXPIRY_HOURS * 60 * 60 * 1000; // 24 hours in milliseconds\n    return cacheAge > maxAge;\n  }\n\n  /**\n   * Get cached repositories for a user/organization\n   * Returns null if cache doesn't exist or is stale\n   */\n  getCachedRepositories(owner, type = 'user') {\n    try {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.cache('get', cacheKey);\n      \n      const cachedData = localStorage.getItem(cacheKey);\n      \n      if (!cachedData) {\n        this.logger.cache('miss', cacheKey, 'No cached data found');\n        return null;\n      }\n\n      const parsed = JSON.parse(cachedData);\n      \n      // Check if cache is stale\n      if (this.isStale(parsed.timestamp)) {\n        // Remove stale cache\n        this.logger.cache('expired', cacheKey, { age: Date.now() - parsed.timestamp });\n        localStorage.removeItem(cacheKey);\n        return null;\n      }\n\n      this.logger.cache('hit', cacheKey, { \n        repositoryCount: parsed.repositories?.length || 0,\n        age: Date.now() - parsed.timestamp\n      });\n\n      return {\n        repositories: parsed.repositories,\n        timestamp: parsed.timestamp,\n        owner: parsed.owner,\n        type: parsed.type\n      };\n    } catch (error) {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.error('Error reading repository cache', { cacheKey, error: error.message });\n      console.warn('Error reading repository cache:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Cache repositories for a user/organization\n   */\n  setCachedRepositories(owner, type = 'user', repositories) {\n    try {\n      const cacheKey = this.getCacheKey(owner, type);\n      const cacheData = {\n        repositories,\n        timestamp: Date.now(),\n        owner,\n        type\n      };\n\n      this.logger.cache('set', cacheKey, { \n        repositoryCount: repositories?.length || 0,\n        owner, \n        type \n      });\n\n      localStorage.setItem(cacheKey, JSON.stringify(cacheData));\n      return true;\n    } catch (error) {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.error('Error caching repositories', { cacheKey, error: error.message });\n      console.warn('Error caching repositories:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear cache for a specific user/organization\n   */\n  clearCache(owner, type = 'user') {\n    try {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.cache('clear', cacheKey, { owner, type });\n      localStorage.removeItem(cacheKey);\n      return true;\n    } catch (error) {\n      const cacheKey = this.getCacheKey(owner, type);\n      this.logger.error('Error clearing repository cache', { cacheKey, error: error.message });\n      console.warn('Error clearing repository cache:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear all repository caches\n   */\n  clearAllCaches() {\n    try {\n      const keys = Object.keys(localStorage);\n      keys.forEach(key => {\n        if (key.startsWith(this.CACHE_KEY_PREFIX)) {\n          localStorage.removeItem(key);\n        }\n      });\n      return true;\n    } catch (error) {\n      console.warn('Error clearing all repository caches:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get cache info for debugging\n   */\n  getCacheInfo(owner, type = 'user') {\n    const cached = this.getCachedRepositories(owner, type);\n    if (!cached) {\n      return { exists: false, stale: true };\n    }\n\n    const age = Date.now() - cached.timestamp;\n    const ageHours = Math.round(age / (60 * 60 * 1000));\n    \n    return {\n      exists: true,\n      stale: this.isStale(cached.timestamp),\n      age: age,\n      ageHours: ageHours,\n      repositoryCount: cached.repositories.length,\n      timestamp: new Date(cached.timestamp).toISOString()\n    };\n  }\n}\n\n// Create singleton instance\nconst repositoryCacheService = new RepositoryCacheService();\n\nexport default repositoryCacheService;","/**\n * SecureTokenStorage - Secure storage for GitHub Personal Access Tokens\n * \n * Features:\n * - XOR encryption using browser fingerprint-based keys\n * - Token format validation (classic and fine-grained PATs)\n * - Automatic token expiration (24 hours)\n * - Secure token masking for logs and error messages\n */\n\nimport logger from '../utils/logger';\n\nclass SecureTokenStorage {\n  constructor() {\n    this.logger = logger.getLogger('SecureTokenStorage');\n    this.storageKey = 'sgex_secure_token';\n    this.expirationHours = 24;\n    this.logger.debug('SecureTokenStorage instance created');\n  }\n\n  /**\n   * Generate a browser fingerprint for encryption key\n   * @returns {string} Browser fingerprint\n   */\n  generateBrowserFingerprint() {\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    ctx.textBaseline = 'top';\n    ctx.font = '14px Arial';\n    ctx.fillText('Browser fingerprint', 2, 2);\n    \n    const fingerprint = [\n      navigator.userAgent,\n      navigator.language,\n      window.screen.width + 'x' + window.screen.height,\n      window.screen.colorDepth,\n      new Date().getTimezoneOffset(),\n      canvas.toDataURL()\n    ].join('|');\n    \n    // Create a simple hash of the fingerprint\n    let hash = 0;\n    for (let i = 0; i < fingerprint.length; i++) {\n      const char = fingerprint.charCodeAt(i);\n      hash = ((hash << 5) - hash) + char;\n      hash = hash & hash; // Convert to 32-bit integer\n    }\n    \n    return Math.abs(hash).toString(36);\n  }\n\n  /**\n   * XOR encrypt/decrypt text using a key\n   * @param {string} text - Text to encrypt/decrypt\n   * @param {string} key - Encryption key\n   * @returns {string} Encrypted/decrypted text\n   */\n  xorCipher(text, key) {\n    let result = '';\n    for (let i = 0; i < text.length; i++) {\n      result += String.fromCharCode(\n        text.charCodeAt(i) ^ key.charCodeAt(i % key.length)\n      );\n    }\n    return result;\n  }\n\n  /**\n   * Validate GitHub Personal Access Token format\n   * @param {string} token - Token to validate\n   * @returns {object} Validation result with type and validity\n   */\n  validateTokenFormat(token) {\n    if (!token || typeof token !== 'string') {\n      return { isValid: false, type: 'invalid', reason: 'Token is empty or not a string' };\n    }\n\n    // Remove any whitespace\n    const cleanToken = token.trim();\n\n    // Classic Personal Access Token format: ghp_[36 characters A-Za-z0-9]\n    if (cleanToken.match(/^ghp_[A-Za-z0-9]{36}$/)) {\n      return { isValid: true, type: 'classic', token: cleanToken };\n    }\n\n    // Fine-grained Personal Access Token format: github_pat_[22 characters]_[59 characters]\n    if (cleanToken.match(/^github_pat_[A-Za-z0-9]{22}_[A-Za-z0-9]{59}$/)) {\n      return { isValid: true, type: 'fine-grained', token: cleanToken };\n    }\n\n    // OAuth token format: gho_[36 characters] (for completeness)\n    if (cleanToken.match(/^gho_[A-Za-z0-9]{36}$/)) {\n      return { isValid: true, type: 'oauth', token: cleanToken };\n    }\n\n    // Check for old-style tokens (40 hex characters) - deprecated but might still work\n    if (cleanToken.match(/^[a-fA-F0-9]{40}$/)) {\n      return { isValid: true, type: 'legacy', token: cleanToken };\n    }\n\n    return { \n      isValid: false, \n      type: 'invalid', \n      reason: 'Token does not match expected GitHub PAT format'\n    };\n  }\n\n  /**\n   * Mask token for safe logging\n   * @param {string} token - Token to mask\n   * @returns {string} Masked token\n   */\n  maskToken(token) {\n    if (!token || typeof token !== 'string') {\n      return '[INVALID_TOKEN]';\n    }\n\n    const cleanToken = token.trim();\n    if (cleanToken.length < 8) {\n      return '[INVALID_TOKEN]';\n    }\n\n    // Show first 4 and last 4 characters for debugging purposes\n    return `${cleanToken.substring(0, 4)}${'*'.repeat(cleanToken.length - 8)}${cleanToken.substring(cleanToken.length - 4)}`;\n  }\n\n  /**\n   * Store token securely with encryption and expiration\n   * @param {string} token - GitHub Personal Access Token\n   * @returns {boolean} Success status\n   */\n  storeToken(token) {\n    try {\n      this.logger.debug('Starting secure token storage');\n\n      // Validate token format\n      const validation = this.validateTokenFormat(token);\n      if (!validation.isValid) {\n        this.logger.warn('Token validation failed', { \n          reason: validation.reason,\n          tokenMask: this.maskToken(token)\n        });\n        return false;\n      }\n\n      this.logger.debug('Token validation successful', { \n        type: validation.type,\n        tokenMask: this.maskToken(token)\n      });\n\n      // Generate encryption key\n      const fingerprint = this.generateBrowserFingerprint();\n      const encryptionKey = `sgex_${fingerprint}_${Date.now().toString(36)}`;\n\n      // Encrypt token\n      const encryptedToken = this.xorCipher(validation.token, encryptionKey);\n      \n      // Create storage object with metadata\n      const storageData = {\n        token: btoa(encryptedToken), // Base64 encode for safe storage\n        key: btoa(encryptionKey), // Base64 encode the key\n        type: validation.type,\n        created: Date.now(),\n        expires: Date.now() + (this.expirationHours * 60 * 60 * 1000),\n        fingerprint: fingerprint\n      };\n\n      // Store in sessionStorage (more secure than localStorage for tokens)\n      sessionStorage.setItem(this.storageKey, JSON.stringify(storageData));\n      \n      // Clear any old tokens from localStorage\n      localStorage.removeItem('github_token');\n      sessionStorage.removeItem('github_token');\n\n      this.logger.debug('Token stored securely', { \n        type: validation.type,\n        expires: new Date(storageData.expires).toISOString(),\n        tokenMask: this.maskToken(token)\n      });\n\n      return true;\n    } catch (error) {\n      this.logger.error('Failed to store token securely', { \n        error: error.message,\n        tokenMask: this.maskToken(token)\n      });\n      return false;\n    }\n  }\n\n  /**\n   * Retrieve and decrypt stored token\n   * @returns {object|null} Token data or null if not found/expired\n   */\n  retrieveToken() {\n    try {\n      this.logger.debug('Attempting to retrieve secure token');\n\n      const storedData = sessionStorage.getItem(this.storageKey);\n      if (!storedData) {\n        this.logger.debug('No secure token found in storage');\n        return null;\n      }\n\n      const data = JSON.parse(storedData);\n      \n      // Check expiration\n      if (Date.now() > data.expires) {\n        this.logger.warn('Stored token has expired');\n        this.clearToken();\n        return null;\n      }\n\n      // Verify browser fingerprint\n      const currentFingerprint = this.generateBrowserFingerprint();\n      if (data.fingerprint !== currentFingerprint) {\n        this.logger.warn('Browser fingerprint mismatch - possible security issue');\n        this.clearToken();\n        return null;\n      }\n\n      // Decrypt token\n      const encryptionKey = atob(data.key);\n      const encryptedToken = atob(data.token);\n      const decryptedToken = this.xorCipher(encryptedToken, encryptionKey);\n\n      // Validate decrypted token\n      const validation = this.validateTokenFormat(decryptedToken);\n      if (!validation.isValid) {\n        this.logger.error('Decrypted token failed validation');\n        this.clearToken();\n        return null;\n      }\n\n      this.logger.debug('Token retrieved and decrypted successfully', { \n        type: data.type,\n        expires: new Date(data.expires).toISOString(),\n        tokenMask: this.maskToken(decryptedToken)\n      });\n\n      return {\n        token: validation.token,\n        type: data.type,\n        created: data.created,\n        expires: data.expires\n      };\n    } catch (error) {\n      this.logger.error('Failed to retrieve secure token', { error: error.message });\n      this.clearToken();\n      return null;\n    }\n  }\n\n  /**\n   * Check if a valid token exists without retrieving it\n   * @returns {boolean} True if valid token exists\n   */\n  hasValidToken() {\n    try {\n      const storedData = sessionStorage.getItem(this.storageKey);\n      if (!storedData) {\n        return false;\n      }\n\n      const data = JSON.parse(storedData);\n      \n      // Check expiration\n      if (Date.now() > data.expires) {\n        this.clearToken();\n        return false;\n      }\n\n      // Verify browser fingerprint\n      const currentFingerprint = this.generateBrowserFingerprint();\n      if (data.fingerprint !== currentFingerprint) {\n        this.clearToken();\n        return false;\n      }\n\n      return true;\n    } catch (error) {\n      this.logger.error('Error checking token validity', { error: error.message });\n      this.clearToken();\n      return false;\n    }\n  }\n\n  /**\n   * Clear stored token and cleanup\n   */\n  clearToken() {\n    this.logger.debug('Clearing secure token storage');\n    \n    sessionStorage.removeItem(this.storageKey);\n    \n    // Also clear legacy token storage\n    sessionStorage.removeItem('github_token');\n    localStorage.removeItem('github_token');\n  }\n\n  /**\n   * Get token expiration info\n   * @returns {object|null} Expiration info or null if no token\n   */\n  getTokenInfo() {\n    try {\n      const storedData = sessionStorage.getItem(this.storageKey);\n      if (!storedData) {\n        return null;\n      }\n\n      const data = JSON.parse(storedData);\n      const timeRemaining = data.expires - Date.now();\n      \n      return {\n        type: data.type,\n        created: new Date(data.created),\n        expires: new Date(data.expires),\n        timeRemaining: Math.max(0, timeRemaining),\n        isExpired: timeRemaining <= 0,\n        isValid: this.hasValidToken()\n      };\n    } catch (error) {\n      this.logger.error('Error getting token info', { error: error.message });\n      return null;\n    }\n  }\n\n  /**\n   * Migrate from legacy token storage\n   * @returns {boolean} True if migration was successful\n   */\n  migrateLegacyToken() {\n    try {\n      // Check for tokens in legacy storage\n      const legacyToken = sessionStorage.getItem('github_token') || localStorage.getItem('github_token');\n      \n      if (!legacyToken) {\n        this.logger.debug('No legacy token found for migration');\n        return false;\n      }\n\n      this.logger.debug('Migrating legacy token to secure storage');\n\n      // Store using new secure method\n      const success = this.storeToken(legacyToken);\n      \n      if (success) {\n        // Clear legacy storage\n        sessionStorage.removeItem('github_token');\n        localStorage.removeItem('github_token');\n        this.logger.debug('Legacy token migration completed successfully');\n        return true;\n      } else {\n        this.logger.error('Failed to migrate legacy token');\n        return false;\n      }\n    } catch (error) {\n      this.logger.error('Error during legacy token migration', { error: error.message });\n      return false;\n    }\n  }\n}\n\n// Create singleton instance\nconst secureTokenStorage = new SecureTokenStorage();\n\nexport default secureTokenStorage;","/**\n * Service for managing feature file changes in browser localStorage\n * This allows users to edit and save feature files locally without requiring GitHub authentication\n */\n\nclass LocalStorageService {\n  constructor() {\n    this.storageKey = 'sgex_feature_files';\n    this.metadataKey = 'sgex_feature_files_metadata';\n  }\n\n  /**\n   * Get all locally stored feature file changes\n   * @returns {Object} Object with file paths as keys and content as values\n   */\n  getAllLocalChanges() {\n    try {\n      const data = localStorage.getItem(this.storageKey);\n      return data ? JSON.parse(data) : {};\n    } catch (error) {\n      console.error('Error reading local changes:', error);\n      return {};\n    }\n  }\n\n  /**\n   * Get locally stored content for a specific file\n   * @param {string} filePath - The file path\n   * @returns {string|null} The stored content or null if not found\n   */\n  getLocalContent(filePath) {\n    const changes = this.getAllLocalChanges();\n    return changes[filePath] || null;\n  }\n\n  /**\n   * Save feature file content to localStorage\n   * @param {string} filePath - The file path\n   * @param {string} content - The file content\n   * @param {Object} metadata - Additional metadata (repository, branch, etc.)\n   */\n  saveLocal(filePath, content, metadata = {}) {\n    try {\n      // Save the content\n      const changes = this.getAllLocalChanges();\n      changes[filePath] = content;\n      localStorage.setItem(this.storageKey, JSON.stringify(changes));\n\n      // Save metadata\n      const allMetadata = this.getAllMetadata();\n      allMetadata[filePath] = {\n        ...metadata,\n        lastModified: new Date().toISOString(),\n        originalPath: filePath\n      };\n      localStorage.setItem(this.metadataKey, JSON.stringify(allMetadata));\n\n      return true;\n    } catch (error) {\n      console.error('Error saving to localStorage:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Remove locally stored content for a file\n   * @param {string} filePath - The file path\n   */\n  removeLocal(filePath) {\n    try {\n      const changes = this.getAllLocalChanges();\n      delete changes[filePath];\n      localStorage.setItem(this.storageKey, JSON.stringify(changes));\n\n      const metadata = this.getAllMetadata();\n      delete metadata[filePath];\n      localStorage.setItem(this.metadataKey, JSON.stringify(metadata));\n\n      return true;\n    } catch (error) {\n      console.error('Error removing from localStorage:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get metadata for all locally stored files\n   * @returns {Object} Metadata object\n   */\n  getAllMetadata() {\n    try {\n      const data = localStorage.getItem(this.metadataKey);\n      return data ? JSON.parse(data) : {};\n    } catch (error) {\n      console.error('Error reading metadata:', error);\n      return {};\n    }\n  }\n\n  /**\n   * Get metadata for a specific file\n   * @param {string} filePath - The file path\n   * @returns {Object|null} The metadata or null if not found\n   */\n  getMetadata(filePath) {\n    const metadata = this.getAllMetadata();\n    return metadata[filePath] || null;\n  }\n\n  /**\n   * Check if there are any local changes\n   * @returns {boolean} True if there are local changes\n   */\n  hasLocalChanges() {\n    const changes = this.getAllLocalChanges();\n    return Object.keys(changes).length > 0;\n  }\n\n  /**\n   * Get the number of locally changed files\n   * @returns {number} Number of files with local changes\n   */\n  getLocalChangesCount() {\n    const changes = this.getAllLocalChanges();\n    return Object.keys(changes).length;\n  }\n\n  /**\n   * Export local changes as a downloadable file\n   * @param {string} format - Export format ('json' or 'zip')\n   * @returns {Blob} The export data as a Blob\n   */\n  exportLocalChanges(format = 'json') {\n    const changes = this.getAllLocalChanges();\n    const metadata = this.getAllMetadata();\n\n    if (format === 'json') {\n      const exportData = {\n        exported: new Date().toISOString(),\n        version: '1.0',\n        changes,\n        metadata\n      };\n      \n      return new Blob(\n        [JSON.stringify(exportData, null, 2)], \n        { type: 'application/json' }\n      );\n    }\n\n    // For future expansion - could support ZIP format with individual files\n    throw new Error(`Export format '${format}' not supported`);\n  }\n\n  /**\n   * Import local changes from exported data\n   * @param {string} jsonData - The exported JSON data\n   * @returns {boolean} True if import was successful\n   */\n  importLocalChanges(jsonData) {\n    try {\n      const importData = JSON.parse(jsonData);\n      \n      if (!importData.changes || !importData.metadata) {\n        throw new Error('Invalid import data format');\n      }\n\n      // Merge with existing data\n      const existingChanges = this.getAllLocalChanges();\n      const existingMetadata = this.getAllMetadata();\n\n      const mergedChanges = { ...existingChanges, ...importData.changes };\n      const mergedMetadata = { ...existingMetadata, ...importData.metadata };\n\n      localStorage.setItem(this.storageKey, JSON.stringify(mergedChanges));\n      localStorage.setItem(this.metadataKey, JSON.stringify(mergedMetadata));\n\n      return true;\n    } catch (error) {\n      console.error('Error importing local changes:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Clear all local changes\n   */\n  clearAllLocalChanges() {\n    localStorage.removeItem(this.storageKey);\n    localStorage.removeItem(this.metadataKey);\n  }\n\n  /**\n   * Get storage usage information\n   * @returns {Object} Storage usage stats\n   */\n  getStorageInfo() {\n    const changes = this.getAllLocalChanges();\n    const metadata = this.getAllMetadata();\n    \n    const changesSize = JSON.stringify(changes).length;\n    const metadataSize = JSON.stringify(metadata).length;\n    const totalSize = changesSize + metadataSize;\n\n    return {\n      fileCount: Object.keys(changes).length,\n      totalSize,\n      changesSize,\n      metadataSize,\n      formattedSize: this.formatBytes(totalSize)\n    };\n  }\n\n  /**\n   * Format bytes into human readable string\n   * @param {number} bytes - Number of bytes\n   * @returns {string} Formatted string\n   */\n  formatBytes(bytes) {\n    if (bytes === 0) return '0 Bytes';\n\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  }\n}\n\n// Create and export a singleton instance\nconst localStorageService = new LocalStorageService();\nexport default localStorageService;","/**\n * Service for managing DAK branch context in session storage\n * Stores selected branch per repository to maintain context during DAK editing\n */\n\nclass BranchContextService {\n  constructor() {\n    this.storageKey = 'sgex_branch_context';\n  }\n\n  // Get the storage key for a specific repository\n  getRepositoryKey(repository) {\n    if (!repository || !repository.name) return null;\n    const owner = repository.owner?.login || repository.full_name?.split('/')[0];\n    if (!owner) return null;\n    return `${owner}/${repository.name}`;\n  }\n\n  // Get the selected branch for a repository\n  getSelectedBranch(repository) {\n    if (!repository) return null;\n    \n    try {\n      const branchContext = this.getBranchContext();\n      const repoKey = this.getRepositoryKey(repository);\n      return branchContext[repoKey] || null;\n    } catch (error) {\n      console.warn('Failed to get branch context:', error);\n      return null;\n    }\n  }\n\n  // Set the selected branch for a repository\n  setSelectedBranch(repository, branch) {\n    if (!repository || !branch) return;\n\n    try {\n      const branchContext = this.getBranchContext();\n      const repoKey = this.getRepositoryKey(repository);\n      branchContext[repoKey] = branch;\n      this.setBranchContext(branchContext);\n    } catch (error) {\n      console.warn('Failed to set branch context:', error);\n    }\n  }\n\n  // Clear branch context for a specific repository\n  clearRepositoryBranch(repository) {\n    if (!repository) return;\n\n    try {\n      const branchContext = this.getBranchContext();\n      const repoKey = this.getRepositoryKey(repository);\n      delete branchContext[repoKey];\n      this.setBranchContext(branchContext);\n    } catch (error) {\n      console.warn('Failed to clear repository branch context:', error);\n    }\n  }\n\n  // Clear all branch context (e.g., on logout)\n  clearAllBranchContext() {\n    try {\n      sessionStorage.removeItem(this.storageKey);\n    } catch (error) {\n      console.warn('Failed to clear branch context:', error);\n    }\n  }\n\n  // Get all branch context from storage\n  getBranchContext() {\n    try {\n      const stored = sessionStorage.getItem(this.storageKey);\n      return stored ? JSON.parse(stored) : {};\n    } catch (error) {\n      console.warn('Failed to parse branch context from storage:', error);\n      return {};\n    }\n  }\n\n  // Set branch context to storage\n  setBranchContext(context) {\n    try {\n      sessionStorage.setItem(this.storageKey, JSON.stringify(context));\n    } catch (error) {\n      console.warn('Failed to save branch context to storage:', error);\n    }\n  }\n\n  // Get default branch name (prefer 'main' over 'master')\n  getDefaultBranchName(repository, availableBranches = []) {\n    if (!repository) return 'main';\n\n    // First try 'main'\n    if (availableBranches.some(b => b.name === 'main')) {\n      return 'main';\n    }\n\n    // Then try the repository's default branch\n    if (repository.default_branch && \n        availableBranches.some(b => b.name === repository.default_branch)) {\n      return repository.default_branch;\n    }\n\n    // Finally fall back to the first available branch or 'main'\n    return availableBranches.length > 0 ? availableBranches[0].name : 'main';\n  }\n\n  // Check if a branch context exists for a repository\n  hasBranchContext(repository) {\n    return this.getSelectedBranch(repository) !== null;\n  }\n\n  // Get a formatted display string for the current branch context\n  getBranchDisplayInfo(repository) {\n    const selectedBranch = this.getSelectedBranch(repository);\n    if (!selectedBranch) return null;\n\n    const isDefault = selectedBranch === (repository?.default_branch || 'main');\n    return {\n      branch: selectedBranch,\n      isDefault,\n      displayText: isDefault ? `${selectedBranch} (default)` : selectedBranch\n    };\n  }\n}\n\n// Create a singleton instance\nconst branchContextService = new BranchContextService();\n\nexport default branchContextService;","import yaml from 'js-yaml';\nimport githubService from './githubService';\n\n/**\n * Service for validating WHO SMART Guidelines Digital Adaptation Kit repositories\n * \n * A repository is considered a valid DAK if:\n * 1. It has a sushi-config.yaml file in the root\n * 2. The sushi-config.yaml contains a 'dependencies' section\n * 3. The dependencies section contains the key 'smart.who.int.base'\n */\nclass DAKValidationService {\n  /**\n   * Validates if a repository is a WHO SMART Guidelines Digital Adaptation Kit\n   * @param {string} owner - Repository owner (username or organization)\n   * @param {string} repo - Repository name\n   * @param {string} branch - Branch to check (defaults to 'main')\n   * @returns {Promise<boolean>} - True if repository is a valid DAK\n   */\n  async validateDAKRepository(owner, repo, branch = 'main') {\n    try {\n      // First, check if this is an existing GitHub repository\n      const repositoryExists = await this.checkRepositoryExists(owner, repo);\n      \n      // Try to fetch the sushi-config.yaml file from the repository root\n      const sushiConfigContent = await this.fetchSushiConfig(owner, repo, branch);\n      \n      if (!sushiConfigContent) {\n        // If no sushi-config.yaml but repository exists, still allow it\n        // This handles cases like litlfred/smart-ips-pilgrimage that exist but may not have full DAK structure\n        if (repositoryExists) {\n          console.log(`Repository ${owner}/${repo} exists on GitHub - allowing access even without sushi-config.yaml`);\n          return true;\n        }\n        console.log(`No sushi-config.yaml found in ${owner}/${repo} and repository doesn't exist`);\n        return false;\n      }\n\n      // Parse the YAML content\n      const config = yaml.load(sushiConfigContent);\n      \n      if (!config || typeof config !== 'object') {\n        // If YAML is invalid but repository exists, still allow it\n        if (repositoryExists) {\n          console.log(`Invalid YAML format in sushi-config.yaml for ${owner}/${repo} but repository exists - allowing access`);\n          return true;\n        }\n        console.log(`Invalid YAML format in sushi-config.yaml for ${owner}/${repo}`);\n        return false;\n      }\n\n      // Check if dependencies section exists\n      if (!config.dependencies || typeof config.dependencies !== 'object') {\n        // If no dependencies but repository exists, still allow it\n        if (repositoryExists) {\n          console.log(`No dependencies section found in sushi-config.yaml for ${owner}/${repo} but repository exists - allowing access`);\n          return true;\n        }\n        console.log(`No dependencies section found in sushi-config.yaml for ${owner}/${repo}`);\n        return false;\n      }\n\n      // Check if smart.who.int.base dependency exists\n      const hasSmartBase = 'smart.who.int.base' in config.dependencies;\n      \n      if (hasSmartBase) {\n        console.log(`Valid DAK repository found: ${owner}/${repo} (has smart.who.int.base dependency)`);\n        return true;\n      } else {\n        // If no smart.who.int.base dependency but repository exists, still allow it\n        if (repositoryExists) {\n          console.log(`Repository ${owner}/${repo} has sushi-config.yaml but missing smart.who.int.base dependency - allowing access since repository exists`);\n          return true;\n        }\n        console.log(`Repository ${owner}/${repo} has sushi-config.yaml but missing smart.who.int.base dependency`);\n        return false;\n      }\n\n    } catch (error) {\n      console.log(`Error validating DAK repository ${owner}/${repo}:`, error.message);\n      return false;\n    }\n  }\n\n  /**\n   * Checks if a repository exists on GitHub\n   * @param {string} owner - Repository owner\n   * @param {string} repo - Repository name\n   * @returns {Promise<boolean>} - True if repository exists\n   */\n  async checkRepositoryExists(owner, repo) {\n    try {\n      // Use the same approach as githubService - get the octokit instance\n      const octokit = githubService.isAuth() ? githubService.octokit : null;\n      \n      if (!octokit) {\n        // In unauthenticated mode, we can't reliably check repository existence\n        console.log(`Cannot check repository existence for ${owner}/${repo} - not authenticated`);\n        return false;\n      }\n\n      await octokit.rest.repos.get({\n        owner,\n        repo\n      });\n      \n      console.log(`Repository ${owner}/${repo} exists on GitHub`);\n      return true;\n    } catch (error) {\n      if (error.status === 404) {\n        console.log(`Repository ${owner}/${repo} does not exist on GitHub`);\n        return false;\n      }\n      // For other errors (like rate limiting, network issues, firewall blocks), \n      // we can't determine if the repository exists, so we'll be permissive\n      console.log(`Error checking repository existence for ${owner}/${repo}:`, error.message, '- assuming it might exist');\n      return true; // Changed from false to true for non-404 errors\n    }\n  }\n\n  /**\n   * Fetches the sushi-config.yaml file content from a repository\n   * @param {string} owner - Repository owner\n   * @param {string} repo - Repository name  \n   * @param {string} branch - Branch to check\n   * @returns {Promise<string|null>} - YAML content or null if not found\n   */\n  async fetchSushiConfig(owner, repo, branch = 'main') {\n    try {\n      // Use the same approach as githubService - get the octokit instance\n      const octokit = githubService.isAuth() ? githubService.octokit : null;\n      \n      if (!octokit) {\n        // In unauthenticated mode, we can't fetch file contents reliably\n        console.log(`Cannot fetch sushi-config.yaml for ${owner}/${repo} - not authenticated`);\n        return null;\n      }\n\n      // Try main branch first if no branch specified\n      const branchesToTry = branch === 'main' ? ['main', 'master'] : [branch];\n      \n      for (const branchName of branchesToTry) {\n        try {\n          const { data } = await octokit.rest.repos.getContent({\n            owner,\n            repo,\n            path: 'sushi-config.yaml',\n            ref: branchName\n          });\n          \n          if (data.type === 'file' && data.content) {\n            // Decode base64 content\n            const content = decodeURIComponent(escape(atob(data.content)));\n            console.log(`Found sushi-config.yaml in ${owner}/${repo} on branch ${branchName}`);\n            return content;\n          }\n        } catch (branchError) {\n          console.log(`sushi-config.yaml not found on branch ${branchName} for ${owner}/${repo}:`, branchError.status === 404 ? 'File not found' : branchError.message);\n          continue;\n        }\n      }\n      \n      return null;\n    } catch (error) {\n      console.log(`Error fetching sushi-config.yaml for ${owner}/${repo}:`, error.message);\n      return null;\n    }\n  }\n\n  /**\n   * Validates DAK repository in demo mode based on basic format\n   * A repository is valid if it has proper org/repo format. In demo mode,\n   * we cannot reliably fetch sushi-config.yaml due to authentication limitations,\n   * so we allow any repository that follows the basic org/repo pattern.\n   * @param {string} owner - Repository owner\n   * @param {string} repo - Repository name\n   * @returns {boolean} - True if repository has valid org/repo format\n   */\n  validateDemoDAKRepository(owner, repo) {\n    // Validate basic format: must look like org/repo\n    if (!owner || !repo || owner.includes('/') || repo.includes('/')) {\n      console.log(`Demo mode: Invalid repository format ${owner}/${repo}`);\n      return false;\n    }\n\n    // Basic validation for reasonable org and repo names\n    // Allow alphanumeric characters, hyphens, underscores, and dots\n    const validNamePattern = /^[a-zA-Z0-9._-]+$/;\n    \n    if (!validNamePattern.test(owner) || !validNamePattern.test(repo)) {\n      console.log(`Demo mode: Invalid characters in repository name ${owner}/${repo}`);\n      return false;\n    }\n\n    const fullName = `${owner}/${repo}`;\n    console.log(`Demo mode: ${fullName} accepted as valid DAK repository (proper org/repo format)`);\n    return true;\n  }\n}\n\nconst dakValidationService = new DAKValidationService();\n\nexport default dakValidationService;","/**\n * Utility for managing concurrent async operations with rate limiting\n */\n\n/**\n * Processes items concurrently with a specified concurrency limit\n * @param {Array} items - Items to process\n * @param {Function} processor - Async function to process each item\n * @param {Object} options - Options for concurrency control\n * @param {number} options.concurrency - Maximum concurrent operations (default: 5)\n * @param {Function} options.onProgress - Progress callback (current, total, item, result)\n * @param {Function} options.onItemComplete - Callback when item completes (item, result, error)\n * @param {Function} options.onItemStart - Callback when item starts processing (item, index)\n * @returns {Promise<Array>} Array of results (in original order)\n */\nexport async function processConcurrently(items, processor, options = {}) {\n  const {\n    concurrency = 5,\n    onProgress = null,\n    onItemComplete = null,\n    onItemStart = null\n  } = options;\n\n  if (!items || items.length === 0) {\n    return [];\n  }\n\n  const results = new Array(items.length);\n  const total = items.length;\n  let completed = 0;\n\n  // Create a queue of work items\n  const queue = items.map((item, index) => ({ item, index }));\n  \n  // Worker function that processes items from the queue\n  const worker = async () => {\n    while (queue.length > 0) {\n      const { item, index } = queue.shift();\n      \n      // Notify that processing is starting\n      if (onItemStart) {\n        onItemStart(item, index);\n      }\n      \n      try {\n        const result = await processor(item, index);\n        results[index] = result;\n        \n        completed++;\n        \n        // Call callbacks\n        if (onProgress) {\n          onProgress(completed, total, item, result);\n        }\n        if (onItemComplete) {\n          onItemComplete(item, result, null);\n        }\n      } catch (error) {\n        // Store error as result\n        results[index] = { error, item };\n        \n        completed++;\n        \n        // Call callbacks\n        if (onProgress) {\n          onProgress(completed, total, item, null);\n        }\n        if (onItemComplete) {\n          onItemComplete(item, null, error);\n        }\n      }\n    }\n  };\n\n  // Start worker promises (limited by concurrency)\n  const workers = Array(Math.min(concurrency, items.length))\n    .fill()\n    .map(() => worker());\n\n  // Wait for all workers to complete\n  await Promise.all(workers);\n\n  return results;\n}\n\n/**\n * Rate-limited function executor\n * Useful for API calls that need to respect rate limits\n */\nexport class RateLimiter {\n  constructor(requestsPerSecond = 5) {\n    this.requestsPerSecond = requestsPerSecond;\n    this.requests = [];\n    this.interval = 1000 / requestsPerSecond; // ms between requests\n  }\n\n  /**\n   * Execute a function with rate limiting\n   * @param {Function} fn - Function to execute\n   * @returns {Promise} Result of the function\n   */\n  async execute(fn) {\n    const now = Date.now();\n    \n    // Remove requests older than 1 second\n    this.requests = this.requests.filter(time => now - time < 1000);\n    \n    // If we're at the limit, wait\n    if (this.requests.length >= this.requestsPerSecond) {\n      const oldestRequest = Math.min(...this.requests);\n      const waitTime = 1000 - (now - oldestRequest) + 10; // Add 10ms buffer\n      if (waitTime > 0) {\n        await new Promise(resolve => setTimeout(resolve, waitTime));\n      }\n    }\n    \n    // Record this request\n    this.requests.push(Date.now());\n    \n    // Execute the function\n    return await fn();\n  }\n}","/**\n * Simple in-memory cache for repository compatibility checks\n * Prevents redundant sushi-config.yaml downloads during scanning\n */\n\nclass RepositoryCompatibilityCache {\n  constructor(ttlMinutes = 30) {\n    this.cache = new Map();\n    this.ttl = ttlMinutes * 60 * 1000; // Convert to milliseconds\n  }\n\n  /**\n   * Generate cache key for a repository\n   * @param {string} owner - Repository owner\n   * @param {string} repo - Repository name\n   * @returns {string} Cache key\n   */\n  _getCacheKey(owner, repo) {\n    return `${owner}/${repo}`;\n  }\n\n  /**\n   * Check if cache entry is still valid\n   * @param {Object} entry - Cache entry\n   * @returns {boolean} True if valid\n   */\n  _isValid(entry) {\n    return Date.now() - entry.timestamp < this.ttl;\n  }\n\n  /**\n   * Get cached compatibility result\n   * @param {string} owner - Repository owner\n   * @param {string} repo - Repository name\n   * @returns {boolean|null} Cached result or null if not cached/expired\n   */\n  get(owner, repo) {\n    const key = this._getCacheKey(owner, repo);\n    const entry = this.cache.get(key);\n    \n    if (!entry) {\n      return null;\n    }\n    \n    if (!this._isValid(entry)) {\n      this.cache.delete(key);\n      return null;\n    }\n    \n    return entry.compatible;\n  }\n\n  /**\n   * Set cached compatibility result\n   * @param {string} owner - Repository owner\n   * @param {string} repo - Repository name\n   * @param {boolean} compatible - Whether repository is SMART guidelines compatible\n   */\n  set(owner, repo, compatible) {\n    const key = this._getCacheKey(owner, repo);\n    this.cache.set(key, {\n      compatible,\n      timestamp: Date.now()\n    });\n  }\n\n  /**\n   * Clear all cached entries\n   */\n  clear() {\n    this.cache.clear();\n  }\n\n  /**\n   * Clean up expired entries\n   */\n  cleanup() {\n    const now = Date.now();\n    for (const [key, entry] of this.cache.entries()) {\n      if (now - entry.timestamp >= this.ttl) {\n        this.cache.delete(key);\n      }\n    }\n  }\n\n  /**\n   * Get cache statistics\n   * @returns {Object} Cache stats\n   */\n  getStats() {\n    this.cleanup();\n    return {\n      size: this.cache.size,\n      ttlMinutes: this.ttl / (60 * 1000),\n      entries: Array.from(this.cache.entries()).map(([key, entry]) => ({\n        repository: key,\n        compatible: entry.compatible,\n        ageMinutes: Math.round((Date.now() - entry.timestamp) / (60 * 1000))\n      }))\n    };\n  }\n}\n\n// Create a singleton instance\nconst repositoryCompatibilityCache = new RepositoryCompatibilityCache();\n\nexport default repositoryCompatibilityCache;","import { Octokit } from '@octokit/rest';\nimport { processConcurrently } from '../utils/concurrency';\nimport repositoryCompatibilityCache from '../utils/repositoryCompatibilityCache';\nimport secureTokenStorage from './secureTokenStorage';\nimport logger from '../utils/logger';\n\nclass GitHubService {\n  constructor() {\n    this.octokit = null;\n    this.isAuthenticated = false;\n    this.permissions = null;\n    this.tokenType = null; // 'classic', 'fine-grained', or 'oauth'\n    this.logger = logger.getLogger('GitHubService');\n    this.logger.debug('GitHubService instance created');\n  }\n\n  // Initialize with a GitHub token (supports both OAuth and PAT tokens)\n  authenticate(token) {\n    const startTime = Date.now();\n    this.logger.auth('Starting authentication', { \n      tokenProvided: !!token, \n      tokenMask: token ? secureTokenStorage.maskToken(token) : 'none'\n    });\n    \n    try {\n      // Validate token format using SecureTokenStorage\n      const validation = secureTokenStorage.validateTokenFormat(token);\n      if (!validation.isValid) {\n        this.logger.warn('Token validation failed during authentication', { \n          reason: validation.reason,\n          tokenMask: secureTokenStorage.maskToken(token)\n        });\n        this.isAuthenticated = false;\n        return false;\n      }\n\n      this.octokit = new Octokit({\n        auth: validation.token,\n      });\n      this.isAuthenticated = true;\n      this.tokenType = validation.type;\n      \n      // Store token securely\n      const stored = secureTokenStorage.storeToken(validation.token);\n      if (!stored) {\n        this.logger.warn('Failed to store token securely, authentication will not persist');\n      }\n      \n      const duration = Date.now() - startTime;\n      this.logger.auth('Authentication successful', { \n        duration, \n        tokenType: this.tokenType,\n        tokenMask: secureTokenStorage.maskToken(token),\n        securelyStored: stored\n      });\n      this.logger.performance('GitHub authentication', duration);\n      \n      return true;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      this.logger.auth('Authentication failed', { \n        error: error.message, \n        duration,\n        tokenMask: secureTokenStorage.maskToken(token)\n      });\n      console.error('Failed to authenticate with GitHub:', error);\n      this.isAuthenticated = false;\n      secureTokenStorage.clearToken(); // Clear any partially stored data\n      return false;\n    }\n  }\n\n  // Initialize with an existing Octokit instance (for OAuth flow)\n  authenticateWithOctokit(octokitInstance) {\n    this.logger.auth('Starting OAuth authentication with Octokit instance');\n    \n    try {\n      this.octokit = octokitInstance;\n      this.isAuthenticated = true;\n      this.tokenType = 'oauth';\n      \n      this.logger.auth('OAuth authentication successful', { tokenType: this.tokenType });\n      return true;\n    } catch (error) {\n      this.logger.auth('OAuth authentication failed', { error: error.message });\n      console.error('Failed to authenticate with Octokit instance:', error);\n      this.isAuthenticated = false;\n      return false;\n    }\n  }\n\n  // Initialize authentication from securely stored token\n  initializeFromStoredToken() {\n    this.logger.auth('Attempting to initialize from stored token');\n    \n    try {\n      // First try to migrate any legacy tokens\n      const migrated = secureTokenStorage.migrateLegacyToken();\n      if (migrated) {\n        this.logger.debug('Successfully migrated legacy token to secure storage');\n      }\n\n      // Retrieve token from secure storage\n      const tokenData = secureTokenStorage.retrieveToken();\n      if (!tokenData) {\n        this.logger.debug('No valid stored token found');\n        return false;\n      }\n\n      // Initialize Octokit with stored token\n      this.octokit = new Octokit({\n        auth: tokenData.token,\n      });\n      this.isAuthenticated = true;\n      this.tokenType = tokenData.type;\n      \n      this.logger.auth('Successfully initialized from stored token', {\n        tokenType: this.tokenType,\n        tokenMask: secureTokenStorage.maskToken(tokenData.token),\n        expires: new Date(tokenData.expires).toISOString()\n      });\n      \n      return true;\n    } catch (error) {\n      this.logger.auth('Failed to initialize from stored token', { error: error.message });\n      this.isAuthenticated = false;\n      secureTokenStorage.clearToken();\n      return false;\n    }\n  }\n\n  // Check if there's a valid stored token\n  hasStoredToken() {\n    return secureTokenStorage.hasValidToken();\n  }\n\n  // Get information about stored token\n  getStoredTokenInfo() {\n    return secureTokenStorage.getTokenInfo();\n  }\n\n  // Check token permissions and type\n  async checkTokenPermissions() {\n    if (!this.isAuth()) {\n      const error = new Error('Not authenticated with GitHub');\n      this.logger.error('Token permission check failed - not authenticated');\n      throw error;\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', '/user', null);\n\n    try {\n      // Try to get token info to determine type and permissions\n      const response = await this.octokit.request('GET /user');\n      this.logger.apiResponse('GET', '/user', response.status, Date.now() - startTime);\n      \n      // Check if this is a fine-grained token by trying to access rate limit info\n      try {\n        const rateLimitStart = Date.now();\n        this.logger.apiCall('GET', '/rate_limit', null);\n        const rateLimit = await this.octokit.rest.rateLimit.get();\n        this.logger.apiResponse('GET', '/rate_limit', rateLimit.status, Date.now() - rateLimitStart);\n        \n        // Fine-grained tokens have different rate limit structure\n        this.tokenType = rateLimit.data.resources.core ? 'classic' : 'fine-grained';\n        this.logger.debug('Token type determined', { tokenType: this.tokenType, hasCore: !!rateLimit.data.resources.core });\n      } catch (rateLimitError) {\n        this.tokenType = 'unknown';\n        this.logger.warn('Could not determine token type from rate limit', { error: rateLimitError.message });\n      }\n\n      const permissions = {\n        type: this.tokenType,\n        user: response.data\n      };\n      \n      this.permissions = permissions;\n      this.logger.debug('Token permissions checked successfully', { \n        tokenType: this.tokenType, \n        username: response.data.login \n      });\n      \n      return permissions;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      this.logger.apiError('GET', '/user', error);\n      this.logger.performance('Token permission check (failed)', duration);\n      console.error('Failed to check token permissions:', error);\n      throw error;\n    }\n  }\n\n  // Check if we have write permissions for a specific repository\n  async checkRepositoryWritePermissions(owner, repo) {\n    if (!this.isAuth()) {\n      this.logger.warn('Cannot check repository write permissions - not authenticated', { owner, repo });\n      return false;\n    }\n\n    const startTime = Date.now();\n    this.logger.debug('Checking write permissions for repository', { owner, repo });\n\n    try {\n      // Get current user first\n      const currentUser = await this.getCurrentUser();\n      const username = currentUser.login;\n      \n      this.logger.apiCall('GET', `/repos/${owner}/${repo}/collaborators/${username}/permission`, null);\n      \n      // Try to get repository collaborator permissions\n      const { data } = await this.octokit.rest.repos.getCollaboratorPermissionLevel({\n        owner,\n        repo,\n        username\n      });\n      \n      const duration = Date.now() - startTime;\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/collaborators/${username}/permission`, 200, duration);\n      \n      const hasWriteAccess = ['write', 'admin'].includes(data.permission);\n      this.logger.debug('Repository write permissions checked', { \n        owner, \n        repo, \n        permission: data.permission, \n        hasWriteAccess \n      });\n      \n      return hasWriteAccess;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      this.logger.apiError('GET', `/repos/${owner}/${repo}/collaborators/*/permission`, error);\n      this.logger.performance('Repository write permission check (failed)', duration);\n      \n      // If we can't check permissions, assume we don't have write access\n      console.warn('Could not check repository write permissions:', error);\n      this.logger.warn('Assuming no write access due to permission check failure', { owner, repo, error: error.message });\n      return false;\n    }\n  }\n\n  // Alias method for backward compatibility - delegates to checkRepositoryWritePermissions\n  async checkRepositoryPermissions(owner, repo) {\n    return this.checkRepositoryWritePermissions(owner, repo);\n  }\n\n  // Check if authenticated\n  isAuth() {\n    return this.isAuthenticated && this.octokit !== null;\n  }\n\n  // Get current user data\n  async getCurrentUser() {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.users.getAuthenticated();\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch user data:', error);\n      throw error;\n    }\n  }\n\n  // Get user's organizations\n  async getUserOrganizations() {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.orgs.listForAuthenticatedUser();\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch organizations:', error);\n      throw error;\n    }\n  }\n\n  // Get specific organization data (public data, no auth required)\n  async getOrganization(orgLogin) {\n    try {\n      // Create a temporary Octokit instance for public API calls if we don't have one\n      const octokit = this.octokit || new Octokit();\n      \n      const { data } = await octokit.rest.orgs.get({\n        org: orgLogin\n      });\n      return data;\n    } catch (error) {\n      console.error(`Failed to fetch organization ${orgLogin}:`, error);\n      throw error;\n    }\n  }\n\n  // Get specific user data (public data, no auth required)\n  async getUser(username) {\n    try {\n      // Create a temporary Octokit instance for public API calls if we don't have one\n      const octokit = this.octokit || new Octokit();\n      \n      const { data } = await octokit.rest.users.getByUsername({\n        username\n      });\n      return data;\n    } catch (error) {\n      console.error(`Failed to fetch user ${username}:`, error);\n      throw error;\n    }\n  }\n\n  // Get WHO organization data with fresh avatar\n  async getWHOOrganization() {\n    try {\n      const whoData = await this.getOrganization('WorldHealthOrganization');\n      return {\n        id: whoData.id,\n        login: whoData.login,\n        display_name: whoData.name || 'World Health Organization',\n        description: whoData.description || 'The World Health Organization is a specialized agency of the United Nations responsible for international public health.',\n        avatar_url: whoData.avatar_url,\n        html_url: whoData.html_url,\n        type: 'Organization',\n        permissions: {\n          can_create_repositories: true,\n          can_create_private_repositories: true\n        },\n        plan: {\n          name: 'Organization',\n          private_repos: 'unlimited'\n        },\n        isWHO: true\n      };\n    } catch (error) {\n      console.warn('Could not fetch WHO organization data from API, using fallback:', error);\n      // Return hardcoded fallback data\n      return {\n        id: 'who-organization',\n        login: 'WorldHealthOrganization',\n        display_name: 'World Health Organization',\n        description: 'The World Health Organization is a specialized agency of the United Nations responsible for international public health.',\n        avatar_url: 'https://avatars.githubusercontent.com/u/12261302?s=200&v=4',\n        html_url: 'https://github.com/WorldHealthOrganization',\n        type: 'Organization',\n        permissions: {\n          can_create_repositories: true,\n          can_create_private_repositories: true\n        },\n        plan: {\n          name: 'Organization',\n          private_repos: 'unlimited'\n        },\n        isWHO: true\n      };\n    }\n  }\n\n  // Get repositories for a user or organization (now filters by SMART Guidelines compatibility)\n  async getRepositories(owner, type = 'user', isDemo = false) {\n    // Handle demo mode - return demo repositories without requiring authentication\n    if (isDemo || owner === 'demo-user') {\n      return this.getDemoRepositories(owner);\n    }\n    \n    // Use the new SMART guidelines filtering method\n    return this.getSmartGuidelinesRepositories(owner, type);\n  }\n\n  // Get demo repositories for demo mode (no authentication required)\n  getDemoRepositories(owner) {\n    const demoRepos = [\n      {\n        id: 'demo-smart-anc',\n        name: 'smart-anc',\n        full_name: `${owner}/smart-anc`,\n        description: 'Demo SMART Guidelines Digital Adaptation Kit for Antenatal Care',\n        private: false,\n        owner: {\n          login: owner,\n          id: 'demo-owner',\n          avatar_url: `https://github.com/${owner}.png`,\n          type: 'User'\n        },\n        html_url: `https://github.com/${owner}/smart-anc`,\n        clone_url: `https://github.com/${owner}/smart-anc.git`,\n        language: 'FSH',\n        stargazers_count: 15,\n        forks_count: 3,\n        open_issues_count: 2,\n        topics: ['who', 'smart-guidelines', 'dak', 'antenatal-care', 'health'],\n        created_at: '2023-01-15T10:00:00Z',\n        updated_at: '2024-12-15T14:30:00Z',\n        pushed_at: '2024-12-15T14:30:00Z',\n        default_branch: 'main',\n        smart_guidelines_compatible: true,\n        isDemo: true\n      },\n      {\n        id: 'demo-smart-tb',\n        name: 'smart-tb',\n        full_name: `${owner}/smart-tb`,\n        description: 'Demo SMART Guidelines Digital Adaptation Kit for Tuberculosis Care',\n        private: false,\n        owner: {\n          login: owner,\n          id: 'demo-owner',\n          avatar_url: `https://github.com/${owner}.png`,\n          type: 'User'\n        },\n        html_url: `https://github.com/${owner}/smart-tb`,\n        clone_url: `https://github.com/${owner}/smart-tb.git`,\n        language: 'FSH',\n        stargazers_count: 8,\n        forks_count: 1,\n        open_issues_count: 0,\n        topics: ['who', 'smart-guidelines', 'dak', 'tuberculosis', 'health'],\n        created_at: '2023-03-20T15:00:00Z',\n        updated_at: '2024-11-30T09:15:00Z',\n        pushed_at: '2024-11-30T09:15:00Z',\n        default_branch: 'main',\n        smart_guidelines_compatible: true,\n        isDemo: true\n      },\n      {\n        id: 'demo-smart-ips-pilgrimage',\n        name: 'smart-ips-pilgrimage',\n        full_name: `${owner}/smart-ips-pilgrimage`,\n        description: 'Demo SMART Guidelines International Patient Summary for Pilgrimage',\n        private: false,\n        owner: {\n          login: owner,\n          id: 'demo-owner',\n          avatar_url: `https://github.com/${owner}.png`,\n          type: 'User'\n        },\n        html_url: `https://github.com/${owner}/smart-ips-pilgrimage`,\n        clone_url: `https://github.com/${owner}/smart-ips-pilgrimage.git`,\n        language: 'FSH',\n        stargazers_count: 12,\n        forks_count: 2,\n        open_issues_count: 1,\n        topics: ['who', 'smart-guidelines', 'dak', 'ips', 'pilgrimage', 'health'],\n        created_at: '2023-06-10T12:00:00Z',\n        updated_at: '2024-12-01T16:45:00Z',\n        pushed_at: '2024-12-01T16:45:00Z',\n        default_branch: 'main',\n        smart_guidelines_compatible: true,\n        isDemo: true\n      }\n    ];\n\n    return Promise.resolve(demoRepos);\n  }\n\n  // Check if a repository has sushi-config.yaml with smart.who.int.base dependency\n  async checkSmartGuidelinesCompatibility(owner, repo, retryCount = 2) {\n    if (!this.isAuth()) {\n      return false;\n    }\n\n    // Check cache first to prevent redundant downloads\n    const cachedResult = repositoryCompatibilityCache.get(owner, repo);\n    if (cachedResult !== null) {\n      return cachedResult;\n    }\n\n    try {\n      // Try to get sushi-config.yaml from the repository root\n      const { data } = await this.octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path: 'sushi-config.yaml',\n      });\n\n      if (data.type === 'file' && data.content) {\n        // Decode base64 content (browser-compatible)\n        const content = decodeURIComponent(escape(atob(data.content)));\n        \n        // Check if the content contains smart.who.int.base in dependencies\n        const isCompatible = content.includes('smart.who.int.base');\n        \n        // Cache the result\n        repositoryCompatibilityCache.set(owner, repo, isCompatible);\n        return isCompatible;\n      }\n      \n      // Cache negative result\n      repositoryCompatibilityCache.set(owner, repo, false);\n      return false;\n    } catch (error) {\n      // If it's a 404 (file not found), retry once more in case of temporary issues\n      if (error.status === 404 && retryCount > 0) {\n        console.warn(`File not found for ${owner}/${repo}, retrying... (${retryCount} attempts left)`);\n        // Use shorter delay in test environment\n        const delay = process.env.NODE_ENV === 'test' ? 10 : 1000;\n        await new Promise(resolve => setTimeout(resolve, delay));\n        return this.checkSmartGuidelinesCompatibility(owner, repo, retryCount - 1);\n      }\n      \n      // For any error (including rate limiting, network errors, or file not found after retries),\n      // strictly return false - no fallback logic\n      console.warn(`Failed to check ${owner}/${repo} for sushi-config.yaml with smart.who.int.base dependency:`, error.message);\n      \n      // Cache negative result\n      repositoryCompatibilityCache.set(owner, repo, false);\n      return false;\n    }\n  }\n\n\n\n  // Get repositories that are SMART guidelines compatible\n  async getSmartGuidelinesRepositories(owner, type = 'user') {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      let repositories = [];\n      let page = 1;\n      let hasMorePages = true;\n\n      // Fetch all repositories using pagination\n      while (hasMorePages) {\n        let response;\n        if (type === 'user') {\n          response = await this.octokit.rest.repos.listForUser({\n            username: owner,\n            sort: 'updated',\n            per_page: 100,\n            page: page,\n          });\n        } else {\n          response = await this.octokit.rest.repos.listForOrg({\n            org: owner,\n            sort: 'updated',\n            per_page: 100,\n            page: page,\n          });\n        }\n\n        repositories = repositories.concat(response.data);\n        \n        // Check if there are more pages\n        hasMorePages = response.data.length === 100;\n        page++;\n      }\n\n      // Check each repository for SMART guidelines compatibility\n      const smartGuidelinesRepos = [];\n      for (const repo of repositories) {\n        const isCompatible = await this.checkSmartGuidelinesCompatibility(repo.owner.login, repo.name);\n        if (isCompatible) {\n          smartGuidelinesRepos.push({\n            ...repo,\n            smart_guidelines_compatible: true\n          });\n        }\n      }\n\n      return smartGuidelinesRepos;\n    } catch (error) {\n      console.error('Failed to fetch SMART guidelines repositories:', error);\n      throw error;\n    }\n  }\n\n  // Get repositories with progressive scanning (for real-time updates)\n  async getSmartGuidelinesRepositoriesProgressive(owner, type = 'user', onRepositoryFound = null, onProgress = null) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      let repositories = [];\n      let page = 1;\n      let hasMorePages = true;\n\n      // Fetch all repositories using pagination\n      while (hasMorePages) {\n        let response;\n        if (type === 'user') {\n          response = await this.octokit.rest.repos.listForUser({\n            username: owner,\n            sort: 'updated',\n            per_page: 100,\n            page: page,\n          });\n        } else {\n          response = await this.octokit.rest.repos.listForOrg({\n            org: owner,\n            sort: 'updated',\n            per_page: 100,\n            page: page,\n          });\n        }\n\n        repositories = repositories.concat(response.data);\n        \n        // Check if there are more pages\n        hasMorePages = response.data.length === 100;\n        page++;\n      }\n\n      // Handle case where user has no repositories\n      if (repositories.length === 0) {\n        console.log('📊 No repositories found for user, completing scan immediately');\n        // Call progress callback to indicate completion\n        if (onProgress) {\n          onProgress({\n            current: 0,\n            total: 0,\n            currentRepo: 'none',\n            progress: 100,\n            completed: true\n          });\n        }\n        return [];\n      }\n\n      // Process repositories concurrently with rate limiting and enhanced display\n      const processor = async (repo, index) => {\n        // Add a small delay to make scanning progress visible (similar to demo mode)\n        await new Promise(resolve => setTimeout(resolve, 100 + Math.random() * 200));\n        \n        const isCompatible = await this.checkSmartGuidelinesCompatibility(repo.owner.login, repo.name);\n        \n        if (isCompatible) {\n          const smartRepo = {\n            ...repo,\n            smart_guidelines_compatible: true\n          };\n          \n          // Notify that a repository was found\n          if (onRepositoryFound) {\n            onRepositoryFound(smartRepo);\n          }\n          \n          return smartRepo;\n        }\n        \n        return null;\n      };\n\n      // Use concurrent processing with max 5 parallel requests\n      const results = await processConcurrently(repositories, processor, {\n        concurrency: 5,\n        onProgress: (completed, total, repo, result) => {\n          // Progress callback for completed items\n          if (onProgress) {\n            onProgress({\n              current: completed,\n              total: total,\n              currentRepo: repo.name,\n              progress: Math.round((completed / total) * 100),\n              completed: true\n            });\n          }\n        },\n        onItemStart: (repo, index) => {\n          // Progress callback for started items\n          if (onProgress) {\n            onProgress({\n              current: index + 1,\n              total: repositories.length,\n              currentRepo: repo.name,\n              progress: Math.round(((index + 1) / repositories.length) * 100),\n              completed: false,\n              started: true\n            });\n          }\n        }\n      });\n\n      // Filter out null results and collect smart repositories\n      const validResults = results.filter(result => result !== null && !result.error);\n      \n      return validResults;\n    } catch (error) {\n      console.error('Failed to fetch SMART guidelines repositories:', error);\n      throw error;\n    }\n  }\n\n  // Get a specific repository\n  async getRepository(owner, repo) {\n    try {\n      // Use authenticated octokit if available, otherwise create a public instance for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const { data } = await octokit.rest.repos.get({\n        owner,\n        repo,\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch repository:', error);\n      throw error;\n    }  \n  }\n\n  // Get repository branches\n  async getBranches(owner, repo) {\n    try {\n      console.log(`githubService.getBranches: Fetching branches for ${owner}/${repo}`);\n      console.log('githubService.getBranches: Authentication status:', this.isAuth());\n      \n      // Use authenticated octokit if available, otherwise create a public instance for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      console.log('githubService.getBranches: Using', this.isAuth() ? 'authenticated' : 'public', 'octokit instance');\n      \n      const { data } = await octokit.rest.repos.listBranches({\n        owner,\n        repo,\n        per_page: 100\n      });\n      \n      console.log(`githubService.getBranches: Successfully fetched ${data.length} branches`);\n      return data;\n    } catch (error) {\n      console.error('githubService.getBranches: Failed to fetch branches:', error);\n      console.error('githubService.getBranches: Error details:', {\n        status: error.status,\n        message: error.message,\n        owner,\n        repo\n      });\n      throw error;\n    }\n  }\n\n  // Create a new branch\n  async createBranch(owner, repo, branchName, fromBranch = 'main') {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      // First get the SHA of the source branch\n      const { data: refData } = await this.octokit.rest.git.getRef({\n        owner,\n        repo,\n        ref: `heads/${fromBranch}`\n      });\n\n      // Create the new branch\n      const { data } = await this.octokit.rest.git.createRef({\n        owner,\n        repo,\n        ref: `refs/heads/${branchName}`,\n        sha: refData.object.sha\n      });\n\n      return data;\n    } catch (error) {\n      console.error('Failed to create branch:', error);\n      throw error;\n    }\n  }\n\n  // Get a specific branch\n  async getBranch(owner, repo, branch) {\n    try {\n      // Use authenticated octokit if available, otherwise create a public instance for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const { data } = await octokit.rest.repos.getBranch({\n        owner,\n        repo,\n        branch\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch branch:', error);\n      throw error;\n    }\n  }\n\n  // GitHub Actions API methods\n  \n  // Get workflows for a repository (using GitHub API to include workflow IDs)\n  async getWorkflows(owner, repo) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      // Use GitHub Actions API to get workflows with their IDs\n      const { data } = await this.octokit.rest.actions.listRepoWorkflows({\n        owner,\n        repo\n      });\n\n      return data.workflows.map(workflow => ({\n        id: workflow.id, // This is the crucial missing piece!\n        name: workflow.name,\n        filename: workflow.path.split('/').pop(), // Extract filename from path\n        path: workflow.path,\n        state: workflow.state,\n        created_at: workflow.created_at,\n        updated_at: workflow.updated_at,\n        url: workflow.html_url,\n        triggers: ['unknown'], // GitHub API doesn't provide trigger info directly\n        lastModified: workflow.updated_at\n      }));\n    } catch (error) {\n      if (error.status === 404) {\n        // No workflows or repository not found\n        return [];\n      }\n      console.error('Failed to fetch workflows:', error);\n      throw error;\n    }\n  }\n\n  // Get workflow runs for a repository\n  async getWorkflowRuns(owner, repo, options = {}) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const params = {\n        owner,\n        repo,\n        per_page: options.per_page || 10,\n        page: options.page || 1\n      };\n\n      if (options.branch) {\n        params.branch = options.branch;\n      }\n\n      if (options.workflow_id) {\n        params.workflow_id = options.workflow_id;\n      }\n\n      const { data } = await this.octokit.rest.actions.listWorkflowRunsForRepo(params);\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch workflow runs:', error);\n      throw error;\n    }\n  }\n\n  // Get workflow runs for a specific workflow\n  async getWorkflowRunsForWorkflow(owner, repo, workflow_id, options = {}) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const params = {\n        owner,\n        repo,\n        workflow_id,\n        per_page: options.per_page || 10,\n        page: options.page || 1\n      };\n\n      if (options.branch) {\n        params.branch = options.branch;\n      }\n\n      const { data } = await this.octokit.rest.actions.listWorkflowRuns(params);\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch workflow runs for workflow:', error);\n      throw error;\n    }\n  }\n\n  // Trigger a workflow run\n  async triggerWorkflow(owner, repo, workflow_id, ref = 'main', inputs = {}) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.actions.createWorkflowDispatch({\n        owner,\n        repo,\n        workflow_id,\n        ref,\n        inputs\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to trigger workflow:', error);\n      throw error;\n    }\n  }\n\n  // Re-run a workflow\n  async rerunWorkflow(owner, repo, run_id) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.actions.reRunWorkflow({\n        owner,\n        repo,\n        run_id\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to re-run workflow:', error);\n      throw error;\n    }\n  }\n\n  // Get workflow run logs\n  async getWorkflowRunLogs(owner, repo, run_id) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.actions.downloadWorkflowRunLogs({\n        owner,\n        repo,\n        run_id\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to get workflow run logs:', error);\n      throw error;\n    }\n  }\n\n  // Approve a workflow run\n  async approveWorkflowRun(owner, repo, run_id) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.actions.approveWorkflowRun({\n        owner,\n        repo,\n        run_id\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to approve workflow run:', error);\n      throw error;\n    }\n  }\n\n  // Get commit comparison (diff)\n  async getCommitDiff(owner, repo, base, head) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.repos.compareCommits({\n        owner,\n        repo,\n        base,\n        head\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to get commit diff:', error);\n      throw error;\n    }\n  }\n\n  // Get commit details\n  async getCommit(owner, repo, sha) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.repos.getCommit({\n        owner,\n        repo,\n        ref: sha\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to get commit details:', error);\n      throw error;\n    }\n  }\n\n  // Releases API methods\n\n  // Get releases for a repository\n  async getReleases(owner, repo, options = {}) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.repos.listReleases({\n        owner,\n        repo,\n        per_page: options.per_page || 10,\n        page: options.page || 1\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch releases:', error);\n      throw error;\n    }\n  }\n\n  // Get latest release\n  async getLatestRelease(owner, repo) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const { data } = await this.octokit.rest.repos.getLatestRelease({\n        owner,\n        repo\n      });\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch latest release:', error);\n      throw error;\n    }\n  }\n\n  // Recursively fetch BPMN files from a directory and its subdirectories\n  async getBpmnFilesRecursive(owner, repo, path, ref = 'main', allFiles = []) {\n    try {\n      // Use authenticated octokit if available, otherwise create a public instance\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const { data } = await octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path,\n        ref\n      });\n\n      // Handle single file response\n      if (!Array.isArray(data)) {\n        if (data.name.endsWith('.bpmn')) {\n          allFiles.push(data);\n        }\n        return allFiles;\n      }\n\n      // Handle directory response\n      for (const item of data) {\n        if (item.type === 'file' && item.name.endsWith('.bpmn')) {\n          allFiles.push(item);\n        } else if (item.type === 'dir') {\n          // Recursively search subdirectories\n          await this.getBpmnFilesRecursive(owner, repo, item.path, ref, allFiles);\n        }\n      }\n\n      return allFiles;\n    } catch (error) {\n      // If directory doesn't exist, return empty array (not an error)\n      if (error.status === 404) {\n        return allFiles;\n      }\n      throw error;\n    }\n  }\n\n  // Get all BPMN files from a repository's business process directories\n  async getBpmnFiles(owner, repo, ref = 'main') {\n    const allBpmnFiles = [];\n    \n    // Try multiple possible directory names where BPMN files might be stored\n    const possiblePaths = [\n      'input/business-processes',\n      'input/business-process',\n      'public/docs/workflows',\n      'docs/workflows',\n      'workflows',\n      'bpmn',\n      'processes'\n    ];\n\n    for (const path of possiblePaths) {\n      try {\n        const files = await this.getBpmnFilesRecursive(owner, repo, path, ref);\n        allBpmnFiles.push(...files);\n      } catch (error) {\n        console.warn(`Could not fetch BPMN files from ${path}:`, error.message);\n        // Continue trying other paths\n      }\n    }\n\n    // Remove duplicates based on path (in case both directories exist and have overlapping files)\n    const uniqueFiles = allBpmnFiles.filter((file, index, self) => \n      index === self.findIndex(f => f.path === file.path)\n    );\n\n    return uniqueFiles;\n  }\n\n  // Get file content from GitHub repository with timeout handling\n  async getFileContent(owner, repo, path, ref = 'main') {\n    const timeoutMs = 15000; // 15 second timeout\n    \n    try {\n      console.log(`🚀 githubService.getFileContent: Starting request for ${owner}/${repo}/${path} (ref: ${ref})`);\n      console.log('🔐 githubService.getFileContent: Authentication status:', this.isAuth());\n      console.log('📋 githubService.getFileContent: Request parameters:', { owner, repo, path, ref });\n      \n      // Use authenticated octokit if available, otherwise create a public instance for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      console.log('🔧 githubService.getFileContent: Using', this.isAuth() ? 'authenticated' : 'public', 'octokit instance');\n      \n      // Create a promise that rejects after timeout\n      const timeoutPromise = new Promise((_, reject) => {\n        console.log(`⏰ githubService.getFileContent: Setting up ${timeoutMs}ms timeout`);\n        setTimeout(() => {\n          console.error(`⏰ githubService.getFileContent: Request timed out after ${timeoutMs}ms`);\n          reject(new Error(`Request timeout after ${timeoutMs}ms`));\n        }, timeoutMs);\n      });\n      \n      // Race the GitHub API call against the timeout\n      console.log('🌐 githubService.getFileContent: Creating GitHub API promise...');\n      const apiPromise = octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path,\n        ref\n      });\n      \n      console.log('📡 githubService.getFileContent: API request initiated, waiting for response...');\n      const startTime = Date.now();\n      \n      const { data } = await Promise.race([apiPromise, timeoutPromise]);\n      const responseTime = Date.now() - startTime;\n      \n      console.log(`✅ githubService.getFileContent: API response received in ${responseTime}ms`);\n      console.log('📂 githubService.getFileContent: Response data type:', data.type);\n      console.log('📊 githubService.getFileContent: Response details:', {\n        type: data.type,\n        name: data.name,\n        size: data.size,\n        encoding: data.encoding,\n        hasContent: !!data.content\n      });\n\n      // Handle file content\n      if (data.type === 'file' && data.content) {\n        // Decode base64 content\n        console.log('🔧 githubService.getFileContent: Decoding base64 content...');\n        console.log('📊 githubService.getFileContent: Base64 content length:', data.content.length);\n        \n        const content = decodeURIComponent(escape(atob(data.content)));\n        console.log(`✅ githubService.getFileContent: Successfully fetched and decoded file content`);\n        console.log('📏 githubService.getFileContent: Final content length:', content.length, 'characters');\n        console.log('👀 githubService.getFileContent: Content preview (first 200 chars):', content.substring(0, 200));\n        \n        return content;\n      } else {\n        console.error('❌ githubService.getFileContent: Invalid response - not a file or no content');\n        console.error('🔍 githubService.getFileContent: Full response data:', JSON.stringify(data, null, 2));\n        throw new Error('File not found or is not a file');\n      }\n    } catch (error) {\n      console.error(`💥 githubService.getFileContent: Failed to fetch file content from ${owner}/${repo}/${path}:`, error);\n      console.error('🔍 githubService.getFileContent: Error analysis:', {\n        type: typeof error,\n        status: error.status,\n        message: error.message,\n        name: error.name,\n        stack: error.stack?.substring(0, 500) + '...'\n      });\n      \n      // Provide more specific error messages\n      if (error.message.includes('timeout')) {\n        console.error('⏰ githubService.getFileContent: Timeout error detected');\n        throw new Error(`GitHub API request timed out after ${timeoutMs / 1000} seconds. Please try again.`);\n      } else if (error.status === 403) {\n        console.error('🔒 githubService.getFileContent: 403 Forbidden error detected');\n        throw new Error('Access denied. This repository may be private or you may have hit rate limits.');\n      } else if (error.status === 404) {\n        console.error('🔍 githubService.getFileContent: 404 Not Found error detected');\n        throw new Error('File not found in the repository.');\n      } else if (error.message.includes('rate limit')) {\n        console.error('🚦 githubService.getFileContent: Rate limit error detected');\n        throw new Error('GitHub API rate limit exceeded. Please try again later.');\n      } else if (error.message.includes('Network Error') || error.message.includes('Failed to fetch')) {\n        console.error('🌐 githubService.getFileContent: Network error detected');\n        throw new Error('Network error occurred. Please check your internet connection and try again.');\n      }\n      \n      console.error('❓ githubService.getFileContent: Unknown error type, re-throwing original error');\n      throw error;\n    }\n  }\n\n  // Create a commit with multiple files\n  async createCommit(owner, repo, branch, message, files) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      // Get the latest commit SHA\n      const { data: refData } = await this.octokit.rest.git.getRef({\n        owner,\n        repo,\n        ref: `heads/${branch}`\n      });\n      const latestCommitSha = refData.object.sha;\n\n      // Get the tree SHA from the latest commit\n      const { data: commitData } = await this.octokit.rest.git.getCommit({\n        owner,\n        repo,\n        commit_sha: latestCommitSha\n      });\n      const baseTreeSha = commitData.tree.sha;\n\n      // Create blobs for all files\n      const blobs = await Promise.all(\n        files.map(async (file) => {\n          const { data: blobData } = await this.octokit.rest.git.createBlob({\n            owner,\n            repo,\n            content: file.content,\n            encoding: 'utf-8'\n          });\n          return {\n            path: file.path,\n            mode: '100644',\n            type: 'blob',\n            sha: blobData.sha\n          };\n        })\n      );\n\n      // Create a new tree with the blobs\n      const { data: treeData } = await this.octokit.rest.git.createTree({\n        owner,\n        repo,\n        base_tree: baseTreeSha,\n        tree: blobs\n      });\n\n      // Create the commit\n      const { data: newCommitData } = await this.octokit.rest.git.createCommit({\n        owner,\n        repo,\n        message,\n        tree: treeData.sha,\n        parents: [latestCommitSha]\n      });\n\n      // Update the branch reference\n      await this.octokit.rest.git.updateRef({\n        owner,\n        repo,\n        ref: `heads/${branch}`,\n        sha: newCommitData.sha\n      });\n\n      return {\n        sha: newCommitData.sha,\n        html_url: `https://github.com/${owner}/${repo}/commit/${newCommitData.sha}`,\n        message: newCommitData.message,\n        author: newCommitData.author,\n        committer: newCommitData.committer\n      };\n    } catch (error) {\n      console.error('Failed to create commit:', error);\n      throw error;\n    }\n  }\n\n  // Get recent commits for a repository branch\n  async getRecentCommits(owner, repo, branch = 'main', per_page = 5) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/commits`, { sha: branch, per_page });\n\n    try {\n      const response = await this.octokit.rest.repos.listCommits({\n        owner,\n        repo,\n        sha: branch,\n        per_page\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/commits`, response.status, Date.now() - startTime);\n      \n      return response.data.map(commit => ({\n        sha: commit.sha,\n        message: commit.commit.message,\n        author: {\n          name: commit.commit.author.name,\n          email: commit.commit.author.email,\n          date: commit.commit.author.date\n        },\n        committer: {\n          name: commit.commit.committer.name,\n          email: commit.commit.committer.email,\n          date: commit.commit.committer.date\n        },\n        html_url: commit.html_url,\n        stats: commit.stats\n      }));\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/commits`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch recent commits:', error);\n      throw error;\n    }\n  }\n\n  // Get open pull requests count\n  async getOpenPullRequestsCount(owner, repo) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/pulls`, { state: 'open', per_page: 1 });\n\n    try {\n      const response = await this.octokit.rest.pulls.list({\n        owner,\n        repo,\n        state: 'open',\n        per_page: 1\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, response.status, Date.now() - startTime);\n      \n      // GitHub includes the total count in the response headers\n      const linkHeader = response.headers.link;\n      if (linkHeader && linkHeader.includes('rel=\"last\"')) {\n        const lastPageMatch = linkHeader.match(/page=(\\d+)>; rel=\"last\"/);\n        if (lastPageMatch) {\n          return parseInt(lastPageMatch[1], 10);\n        }\n      }\n      \n      // Fallback: use the length of returned items (may not be accurate for large counts)\n      return response.data.length;\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull requests count:', error);\n      throw error;\n    }\n  }\n\n  // Get pull request for a specific branch (returns first PR only for backward compatibility)\n  async getPullRequestForBranch(owner, repo, branchName) {\n    const prs = await this.getPullRequestsForBranch(owner, repo, branchName);\n    return prs && prs.length > 0 ? prs[0] : null;\n  }\n\n  // Get all pull requests for a specific branch\n  async getPullRequestsForBranch(owner, repo, branchName) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/pulls`, { state: 'open', head: `${owner}:${branchName}` });\n\n    try {\n      const response = await this.octokit.rest.pulls.list({\n        owner,\n        repo,\n        state: 'open',\n        head: `${owner}:${branchName}`,\n        per_page: 100 // Get up to 100 PRs for a branch\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, response.status, Date.now() - startTime);\n      \n      // Return all matching PRs or empty array if none found\n      return response.data || [];\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull requests for branch:', error);\n      return []; // Return empty array instead of throwing to allow graceful fallback\n    }\n  }\n\n  // Get pull request comments\n  async getPullRequestComments(owner, repo, pullNumber) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/pulls/${pullNumber}/comments`, {});\n\n    try {\n      const response = await this.octokit.rest.pulls.listReviewComments({\n        owner,\n        repo,\n        pull_number: pullNumber,\n        per_page: 100\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls/${pullNumber}/comments`, response.status, Date.now() - startTime);\n      return response.data;\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls/${pullNumber}/comments`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull request comments:', error);\n      throw error;\n    }\n  }\n\n  // Get pull request issue comments (general comments on the PR conversation)\n  async getPullRequestIssueComments(owner, repo, pullNumber) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, {});\n\n    try {\n      const response = await this.octokit.rest.issues.listComments({\n        owner,\n        repo,\n        issue_number: pullNumber,\n        per_page: 100\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, response.status, Date.now() - startTime);\n      return response.data;\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull request issue comments:', error);\n      throw error;\n    }\n  }\n\n  // Create a comment on a pull request\n  async createPullRequestComment(owner, repo, pullNumber, body) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('POST', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, { body });\n\n    try {\n      const response = await this.octokit.rest.issues.createComment({\n        owner,\n        repo,\n        issue_number: pullNumber,\n        body\n      });\n\n      this.logger.apiResponse('POST', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, response.status, Date.now() - startTime);\n      return response.data;\n    } catch (error) {\n      this.logger.apiResponse('POST', `/repos/${owner}/${repo}/issues/${pullNumber}/comments`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to create pull request comment:', error);\n      throw error;\n    }\n  }\n\n  // Get open issues count\n  async getOpenIssuesCount(owner, repo) {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/issues`, { state: 'open', per_page: 1 });\n\n    try {\n      const response = await this.octokit.rest.issues.listForRepo({\n        owner,\n        repo,\n        state: 'open',\n        per_page: 1\n      });\n\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/issues`, response.status, Date.now() - startTime);\n      \n      // GitHub includes the total count in the response headers\n      const linkHeader = response.headers.link;\n      if (linkHeader && linkHeader.includes('rel=\"last\"')) {\n        const lastPageMatch = linkHeader.match(/page=(\\d+)>; rel=\"last\"/);\n        if (lastPageMatch) {\n          return parseInt(lastPageMatch[1], 10);\n        }\n      }\n      \n      // Fallback: use the length of returned items (may not be accurate for large counts)\n      return response.data.length;\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/issues`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch issues count:', error);\n      throw error;\n    }\n  }\n\n  // Get repository statistics (combined method for efficiency)\n  async getRepositoryStats(owner, repo, branch = 'main') {\n    if (!this.isAuth()) {\n      throw new Error('Not authenticated with GitHub');\n    }\n\n    try {\n      const [recentCommits, openPRsCount, openIssuesCount] = await Promise.allSettled([\n        this.getRecentCommits(owner, repo, branch, 1),\n        this.getOpenPullRequestsCount(owner, repo),\n        this.getOpenIssuesCount(owner, repo)\n      ]);\n\n      return {\n        recentCommits: recentCommits.status === 'fulfilled' ? recentCommits.value : [],\n        openPullRequestsCount: openPRsCount.status === 'fulfilled' ? openPRsCount.value : 0,\n        openIssuesCount: openIssuesCount.status === 'fulfilled' ? openIssuesCount.value : 0,\n        errors: {\n          recentCommits: recentCommits.status === 'rejected' ? recentCommits.reason : null,\n          openPullRequestsCount: openPRsCount.status === 'rejected' ? openPRsCount.reason : null,\n          openIssuesCount: openIssuesCount.status === 'rejected' ? openIssuesCount.reason : null\n        }\n      };\n    } catch (error) {\n      console.error('Failed to fetch repository stats:', error);\n      throw error;\n    }\n  }\n\n  // Get directory contents (supports both authenticated and unauthenticated access)\n  async getDirectoryContents(owner, repo, path = '', ref = 'main') {\n    try {\n      // Create temporary Octokit instance for unauthenticated access if needed\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const { data } = await octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path,\n        ref\n      });\n\n      if (Array.isArray(data)) {\n        return data;\n      } else {\n        throw new Error('Not a directory');\n      }\n    } catch (error) {\n      console.error(`Failed to get directory contents for ${path}:`, error);\n      throw error;\n    }\n  }\n\n  // Update file content (requires authentication)\n  async updateFile(owner, repo, path, content, message, branch = 'main') {\n    if (!this.isAuth()) {\n      throw new Error('Authentication required to update files');\n    }\n\n    try {\n      // First, get the current file to get its SHA\n      const { data: currentFile } = await this.octokit.rest.repos.getContent({\n        owner,\n        repo,\n        path,\n        ref: branch\n      });\n\n      if (Array.isArray(currentFile)) {\n        throw new Error('Path is a directory, not a file');\n      }\n\n      // Update the file\n      const { data } = await this.octokit.rest.repos.createOrUpdateFileContents({\n        owner,\n        repo,\n        path,\n        message,\n        content: btoa(unescape(encodeURIComponent(content))),\n        sha: currentFile.sha,\n        branch\n      });\n\n      return data;\n    } catch (error) {\n      console.error(`Failed to update file ${path}:`, error);\n      throw error;\n    }\n  }\n\n  // Get commits for a repository (supports unauthenticated access)\n  async getCommits(owner, repo, options = {}) {\n    try {\n      // Create temporary Octokit instance for unauthenticated access if needed\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const params = {\n        owner,\n        repo,\n        per_page: options.per_page || 10,\n        page: options.page || 1\n      };\n\n      if (options.sha) {\n        params.sha = options.sha;\n      }\n\n      if (options.since) {\n        params.since = options.since;\n      }\n\n      if (options.until) {\n        params.until = options.until;\n      }\n\n      const { data } = await octokit.rest.repos.listCommits(params);\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch commits:', error);\n      throw error;\n    }\n  }\n\n  // Get issues for a repository (supports unauthenticated access)\n  async getIssues(owner, repo, options = {}) {\n    try {\n      // Create temporary Octokit instance for unauthenticated access if needed\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const params = {\n        owner,\n        repo,\n        state: options.state || 'all',\n        per_page: options.per_page || 30,\n        page: options.page || 1\n      };\n\n      if (options.labels) {\n        params.labels = options.labels;\n      }\n\n      if (options.milestone) {\n        params.milestone = options.milestone;\n      }\n\n      const { data } = await octokit.rest.issues.listForRepo(params);\n      return data;\n    } catch (error) {\n      console.error('Failed to fetch issues:', error);\n      throw error;\n    }\n  }\n\n  // Alias method for backward compatibility - delegates to getIssues\n  async getRepositoryIssues(owner, repo, options = {}) {\n    return this.getIssues(owner, repo, options);\n  }\n\n  // Get repository forks\n  async getForks(owner, repo, options = {}) {\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/forks`, options);\n\n    try {\n      // Use the GitHub API to fetch forks, no authentication required for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const params = {\n        owner,\n        repo,\n        sort: options.sort || 'newest',\n        per_page: options.per_page || 100,\n        page: options.page || 1\n      };\n\n      const { data } = await octokit.rest.repos.listForks(params);\n      \n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/forks`, 200, Date.now() - startTime);\n      \n      // Return formatted fork data\n      return data.map(fork => ({\n        id: fork.id,\n        name: fork.name,\n        full_name: fork.full_name,\n        owner: {\n          login: fork.owner.login,\n          avatar_url: fork.owner.avatar_url,\n          html_url: fork.owner.html_url,\n          type: fork.owner.type\n        },\n        description: fork.description,\n        html_url: fork.html_url,\n        clone_url: fork.clone_url,\n        created_at: fork.created_at,\n        updated_at: fork.updated_at,\n        pushed_at: fork.pushed_at,\n        stargazers_count: fork.stargazers_count,\n        forks_count: fork.forks_count,\n        open_issues_count: fork.open_issues_count,\n        default_branch: fork.default_branch,\n        private: fork.private,\n        fork: fork.fork,\n        parent: fork.parent ? {\n          full_name: fork.parent.full_name,\n          html_url: fork.parent.html_url\n        } : null\n      }));\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/forks`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch repository forks:', error);\n      throw error;\n    }\n  }\n\n  // Get pull requests for a specific repository\n  async getPullRequests(owner, repo, options = {}) {\n    const startTime = Date.now();\n    this.logger.apiCall('GET', `/repos/${owner}/${repo}/pulls`, options);\n\n    try {\n      // Use the GitHub API to fetch pull requests, no authentication required for public repos\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      const params = {\n        owner,\n        repo,\n        state: options.state || 'open',\n        sort: options.sort || 'updated',\n        direction: options.direction || 'desc',\n        per_page: options.per_page || 30,\n        page: options.page || 1\n      };\n\n      // Add optional filters\n      if (options.head) {\n        params.head = options.head;\n      }\n      if (options.base) {\n        params.base = options.base;\n      }\n\n      const { data } = await octokit.rest.pulls.list(params);\n      \n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, 200, Date.now() - startTime);\n      \n      // Return formatted pull request data\n      return data.map(pr => ({\n        id: pr.id,\n        number: pr.number,\n        title: pr.title,\n        body: pr.body,\n        state: pr.state,\n        locked: pr.locked,\n        user: {\n          login: pr.user.login,\n          avatar_url: pr.user.avatar_url,\n          html_url: pr.user.html_url,\n          type: pr.user.type\n        },\n        created_at: pr.created_at,\n        updated_at: pr.updated_at,\n        closed_at: pr.closed_at,\n        merged_at: pr.merged_at,\n        html_url: pr.html_url,\n        diff_url: pr.diff_url,\n        patch_url: pr.patch_url,\n        head: {\n          ref: pr.head.ref,\n          sha: pr.head.sha,\n          repo: pr.head.repo ? {\n            name: pr.head.repo.name,\n            full_name: pr.head.repo.full_name,\n            owner: {\n              login: pr.head.repo.owner.login,\n              avatar_url: pr.head.repo.owner.avatar_url\n            },\n            html_url: pr.head.repo.html_url\n          } : null\n        },\n        base: {\n          ref: pr.base.ref,\n          sha: pr.base.sha,\n          repo: {\n            name: pr.base.repo.name,\n            full_name: pr.base.repo.full_name,\n            owner: {\n              login: pr.base.repo.owner.login,\n              avatar_url: pr.base.repo.owner.avatar_url\n            },\n            html_url: pr.base.repo.html_url\n          }\n        },\n        draft: pr.draft,\n        mergeable: pr.mergeable,\n        mergeable_state: pr.mergeable_state,\n        comments: pr.comments,\n        review_comments: pr.review_comments,\n        commits: pr.commits,\n        additions: pr.additions,\n        deletions: pr.deletions,\n        changed_files: pr.changed_files\n      }));\n    } catch (error) {\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/pulls`, error.status || 'error', Date.now() - startTime);\n      console.error('Failed to fetch pull requests:', error);\n      throw error;\n    }\n  }\n\n  // Logout\n  logout() {\n    this.logger.auth('Logging out and clearing stored token');\n    \n    this.octokit = null;\n    this.isAuthenticated = false;\n    this.tokenType = null;\n    this.permissions = null;\n    \n    // Clear secure token storage\n    secureTokenStorage.clearToken();\n    \n    // Clear branch context on logout\n    try {\n      const { default: branchContextService } = require('../services/branchContextService');\n      branchContextService.clearAllBranchContext();\n    } catch (error) {\n      // Service might not be available during testing\n      sessionStorage.removeItem('sgex_branch_context');\n    }\n  }\n\n  // Get repository forks\n  async getRepositoryForks(owner, repo, options = {}) {\n    const startTime = Date.now();\n    this.logger.debug('Fetching repository forks', { owner, repo, options });\n\n    try {\n      // Create temporary Octokit instance for unauthenticated access if needed\n      const octokit = this.isAuth() ? this.octokit : new Octokit();\n      \n      this.logger.apiCall('GET', `/repos/${owner}/${repo}/forks`, options);\n      \n      const { data } = await octokit.rest.repos.listForks({\n        owner,\n        repo,\n        sort: 'newest', // Sort by newest first\n        per_page: options.per_page || 100,\n        page: options.page || 1\n      });\n\n      const duration = Date.now() - startTime;\n      this.logger.apiResponse('GET', `/repos/${owner}/${repo}/forks`, 200, duration, { forkCount: data.length });\n      this.logger.performance('Repository forks fetch', duration);\n\n      return data;\n    } catch (error) {\n      const duration = Date.now() - startTime;\n      this.logger.apiError('GET', `/repos/${owner}/${repo}/forks`, error);\n      this.logger.performance('Repository forks fetch (failed)', duration);\n      console.error(`Failed to fetch forks for ${owner}/${repo}:`, error);\n      throw error;\n    }\n  }\n}\n\n// Create a singleton instance\nconst githubService = new GitHubService();\n\nexport default githubService;"],"names":["constructor","this","universalTopics","documentation","id","title","badge","type","action","currentPath","window","location","pathname","basePath","includes","pathParts","split","sgexIndex","indexOf","length","concat","slice","join","href","content","bugReport","dakFeedback","helpTopics","getHelpTopicsForPage","pageId","contextData","arguments","undefined","getUniversalTopics","topics","selectedDak","repository","push","getHelpTopic","topicId","pageTopics","Object","values","topic","find","t","hasHelpTopics","addHelpTopicToPage","helpTopic","getAvailablePages","keys","openDakIssue","issueType","dakRepository","console","warn","url","owner","name","open","storageKey","whoProfile","getSubscriptions","stored","localStorage","getItem","subscriptions","JSON","parse","profile","login","unshift","avatar_url","isPermanent","addedAt","Date","toISOString","saveSubscriptions","error","setItem","stringify","addSubscription","Error","existingIndex","findIndex","p","_objectSpread","lastUpdated","newSubscription","removeSubscription","profileIndex","splice","isSubscribed","some","getSubscription","ensureCurrentUserSubscribed","userProfile","existing","autoAddVisitedProfile","visitedProfile","isDemo","getSubscriptionsSorted","sort","a","b","nameA","nameB","localeCompare","getSubscriptionsForSelection","map","displayName","isRemovable","updateSubscription","updatedProfile","index","clearSubscriptions","exportSubscriptions","importSubscriptions","jsonString","merge","importedSubscriptions","Array","isArray","finalSubscriptions","mergedSubscriptions","forEach","imported","PAGE_TYPES","PageContext","createContext","usePage","context","useContext","log","pageName","user","branch","asset","loading","isAuthenticated","navigate","params","determinePageType","repo","PageProvider","_ref","children","useParams","useLocation","useNavigate","locationPathname","pageState","setPageState","useState","githubService","isAuth","useEffect","async","_location$state","_location$state2","_location$state3","prev","state","selectedBranch","_repository","getUser","err","html_url","isNotFound","dakValidationService","validateDemoDAKRepository","charAt","toUpperCase","getRepository","validateDAKRepository","default_branch","isInvalidDAK","full_name","getFileContent","handleSubscriptions","currentUser","getCurrentUser","profileSubscriptionService","debug","message","loadPageData","interval","setInterval","checkAuthState","currentAuthState","clearInterval","value","_jsx","Provider","getThemeImagePath","baseImagePath","isDarkMode","document","body","classList","contains","publicUrl","process","normalizedPath","startsWith","finalPath","darkImageName","replace","USER_TYPES","ACCESS_LEVELS","logger","getLogger","userType","permissions","Map","listeners","Set","initialize","info","detectUserType","notifyListeners","checkIfDemoUser","createDemoUser","hasUser","REACT_APP_DEMO_MODE","realUser","demoData","getDemoData","daks","description","sampleAssets","getUserType","isDemoUser","isUnauthenticated","getRepositoryAccess","cacheKey","has","get","access","isDemoDAK","hasReadAccess","checkGitHubReadAccess","checkGitHubWriteAccess","set","_this$currentUser","_this$currentUser$dem","dak","hasRepositoryWriteAccess","canSaveToGitHub","canSaveLocal","getUIBehavior","behavior","showEditFeatures","showSaveToGitHub","showSaveLocal","confirmBeforeSave","allowCreateNew","showAccessBadges","getAccessBadge","badges","text","icon","color","enableDemoMode","disableDemoMode","removeItem","clearPermissionsCache","clear","addListener","callback","add","delete","accessState","uiBehavior","handleAuthChange","getBookmarks","saveBookmarks","bookmarks","generateBookmarkTitle","repoName","branchName","addBookmark","bookmark","now","toString","createdAt","removeBookmark","bookmarkId","filteredBookmarks","filter","isBookmarked","getBookmarkByUrl","getBookmarksGroupedByPage","grouped","clearBookmarks","exportBookmarks","importBookmarks","importedBookmarks","mergedBookmarks","PreviewBadge","branchInfo","setBranchInfo","prInfo","setPrInfo","setLoading","setError","isExpanded","setIsExpanded","isSticky","setIsSticky","expandedRef","useRef","currentBranch","getCurrentBranch","safeName","prData","fetchPRsForBranch","prError","detectBranchAndPR","handleClickOutside","event","current","target","addEventListener","removeEventListener","getPullRequestsForBranch","truncateTitle","maxLength","substring","_jsxs","className","ref","pr","onClick","handleBadgeClick","number","stopPropagation","preventDefault","onMouseEnter","handleMouseEnter","onMouseLeave","handleMouseLeave","e","style","marginTop","origin","padding","backgroundColor","border","borderRadius","rel","PageHeader","showUserDropdown","setShowUserDropdown","showBookmarkDropdown","setShowBookmarkDropdown","authenticatedUser","setAuthenticatedUser","userAccessService","githubUser","fetchAuthenticatedUser","handleHomeNavigation","handleRemoveBookmark","bookmarkService","setTimeout","currentBookmark","bookmarksGrouped","src","alt","handleGitHubUser","viewBox","width","height","d","handleBookmarkCurrentPage","currentUrl","group","handleBookmarkNavigation","handleLogout","logout","setBadge","showTooltip","setShowTooltip","mounted","loadBadge","badgeInfo","unsubscribe","role","_repository$owner3","customBreadcrumbs","branches","setBranches","showBranchDropdown","setShowBranchDropdown","branchSearchTerm","setBranchSearchTerm","loadingBranches","setLoadingBranches","closest","_repository$owner","_repository$full_name","sortedBranches","getBranches","fetchBranches","filteredBranches","toLowerCase","breadcrumbs","getBreadcrumbs","label","path","_repository$owner2","_repository$full_name2","branchPath","ownerLogin","currentPageLabel","_Fragment","placeholder","onChange","autoFocus","newBranch","handleBranchChange","crumb","AccessBadge","handleGitHubRepo","onRetry","pageContext","bugReportSent","setBugReportSent","mascotImage","useThemeImage","userExplanation","setUserExplanation","errorInfo","getErrorDisplayInfo","_pageContext$reposito","lowercaseError","suggestions","ContextualHelpMascot","helpContent","position","suggestion","handleRetry","reload","handleGoHome","htmlFor","rows","handleSendBugReport","bugReportUrl","generateBugReportUrl","encodeURIComponent","navigator","userAgent","innerWidth","innerHeight","referrer","PageErrorBoundary","React","props","super","hasError","getDerivedStateFromError","componentDidCatch","render","ErrorHandler","setState","PageLayoutInner","showHeader","showMascot","showBreadcrumbs","_ref2","usePageParams","updateBranch","navigateToUser","userLogin","page","navigateToDAK","navigateToAsset","assetPath","useDAKParams","pageParams","hasChanges","isSavingLocal","isSavingGitHub","localSaveSuccess","githubSaveSuccess","savedLocally","onSaveLocal","onSaveGitHub","showLocalButton","showGitHubButton","buttonSize","layout","localButtonDisabled","githubButtonDisabled","containerClasses","getButtonClasses","disabled","success","classes","isOpen","commitMessage","setCommitMessage","onCommit","onCancel","isSaving","fileName","suggestedMessage","textareaRef","focus","defaultMessage","currentTarget","onKeyDown","key","ctrlKey","metaKey","trim","required","handleCommit","SAVE_TARGETS","OPERATION_RESULTS","pendingOperations","assetCache","stagingGroundService","getAsset","localFile","getStagingGround","files","f","source","metadata","hasLocalChanges","getDemoAssetContent","saveAssetLocal","updateFile","savedBy","saveTarget","result","saveAssetGitHub","updateFileContent","_result$data","_result$data$commit","_result$data2","_result$data2$commit","_result$data3","_result$data3$commit","removeFile","commit","data","sha","commitSha","commitUrl","resourceType","status","compose","include","system","concept","code","display","getSaveOptions","canSaveGitHub","showSaveGitHub","restrictions","getSaveRestrictions","localMessage","githubMessage","githubDisabled","getStagingGroundStatus","getStatus","clearStagingGround","getChangedFiles","createAsset","initialContent","isNew","batchSaveLocal","assets","results","every","r","getAccessInfo","saveOptions","Promise","all","file","originalContent","onSave","onContentChange","customSaveToGitHub","showSaveButtons","saveButtonsPosition","pageLayoutProps","_objectWithoutProperties","_excluded","setIsSavingLocal","setIsSavingGitHub","saveError","setSaveError","setLocalSaveSuccess","setGithubSaveSuccess","setSaveOptions","showCommitDialog","setShowCommitDialog","options","dataAccessLayer","loadSaveOptions","handleSaveLocal","useCallback","timestamp","handleSaveGitHub","handleCommitToGitHub","errorMessage","handleCancelCommit","saveButtonsProps","PageLayout","SaveButtonsContainer","CommitMessageDialog","TOOL_TYPES","ToolDefinition","config","route","category","requiresAuth","supportsDemo","requiresDAK","assetTypes","assetPattern","viewerComponent","editorComponent","dashboardComponent","onInit","onAssetLoad","onAssetSave","onError","supportsAsset","_this$assetTypes","RegExp","test","canAccess","createComponent","toolDef","ToolWrapper","toolDefinition","toolState","setToolState","initializeTool","_pageParams$repositor","assetData","handleAssetSave","newContent","saveType","handleGitHubSave","_pageParams$repositor2","history","back","renderToolContent","commonProps","onGitHubSave","EditorComponent","_toolState$assets$","AssetEditorLayout","ViewerComponent","DashboardComponent","Component","tools","register","tool","getAll","from","getByCategory","getByAssetType","getAccessibleTools","accessibleTools","clearAllCache","repoCacheCleared","repositoryCacheService","clearAllCaches","branchContextService","clearAllBranchContext","clearAllStagingGrounds","clearOtherSGEXData","sessionKeys","sessionStorage","getCacheInfo","repositoryCache","count","branchContext","hasData","repositoryCount","stagingGround","other","localKeys","parsed","getUncommittedWork","uncommittedWork","keyParts","pop","fileCount","lastModified","UN_LANGUAGES","flag","ADDITIONAL_LANGUAGES","englishName","i18n","useTranslation","setIsOpen","searchTerm","setSearchTerm","selectedLanguages","setSelectedLanguages","saved","lang","availableLanguages","useMemo","languages","langCode","unLang","additionalLang","addLang","searchableLanguages","searchLower","currentLanguage","language","handleLanguageChange","changeLanguage","newSelectedLanguages","handleAddLanguage","notificationBadge","showHelp","setShowHelp","helpSticky","setHelpSticky","selectedHelpTopic","setSelectedHelpTopic","setIsDarkMode","cacheClearing","setCacheClearing","cacheCleared","setCacheCleared","savedTheme","prefersLight","matchMedia","matches","currentLang","isRTL","documentElement","dir","toggleTheme","helpContentService","handleFlushCache","cacheManagementService","alert","handleClick","handleCloseHelp","handleHelpTopicClick","LanguageSelector","HelpModal","onClose","handleCloseModal","currentImagePath","setCurrentImagePath","updateImagePath","observer","MutationObserver","mutations","mutation","attributeName","observe","attributes","attributeFilter","disconnect","currentRepository","getStorageKey","createEmptyStagingGround","_this$currentReposito","saveStagingGround","_this$currentReposito2","saveToHistory","filePath","existingFileIndex","fileObject","updateCommitMessage","getChangedFilesCount","empty","historyKey","getHistory","savedAt","recentHistory","rollbackToSave","save","s","stagingGroundState","exportStagingGround","_this$currentReposito3","exportedAt","importStagingGround","exportedData","_this$currentReposito4","cleanup","maxAge","keysToRemove","i","contributeFiles","contributedAt","_this$currentReposito5","filesCount","showMenu","setShowMenu","currentSlide","setCurrentSlide","createContextualUrl","baseUrl","_contextData$selected","urlParams","URLSearchParams","helpModalInstance","openSgexIssue","template","labels","newWindow","_window$helpModalInst","_window$helpModalInst2","closed","showFallbackInstructions","call","_window$helpModalInst3","_window$helpModalInst4","close","_window$helpModalInst5","_window$helpModalInst6","sgex_dak_repository","_window$helpModalInst7","_window$helpModalInst8","_window$helpModalInst9","_window$helpModalInst0","_window$helpModalInst1","_window$helpModalInst10","reason","fallback","existingFallback","querySelector","remove","fallbackOverlay","createElement","cssText","fallbackModal","innerHTML","appendChild","handlePrevSlide","handleNextSlide","renderSlideshow","slides","currentSlideData","processedContent","dangerouslySetInnerHTML","__html","_","getHelpContent","handleMenuToggle","handleDocumentation","handleBugReport","_window$helpModalInst11","_contextData$selected2","sgex_page","sgex_current_url","_window$helpModalInst12","_window$helpModalInst13","_window$helpModalInst14","_window$helpModalInst15","handleDAKFeedback","_window$helpModalInst16","handleEmailSupport","topicTitle","subject","CACHE_KEY_PREFIX","CACHE_EXPIRY_HOURS","cacheExpiryHours","getCacheKey","isStale","getCachedRepositories","_parsed$repositories","cache","cachedData","age","repositories","setCachedRepositories","cacheData","clearCache","cached","exists","stale","ageHours","Math","round","expirationHours","generateBrowserFingerprint","canvas","ctx","getContext","textBaseline","font","fillText","fingerprint","screen","colorDepth","getTimezoneOffset","toDataURL","hash","charCodeAt","abs","xorCipher","String","fromCharCode","validateTokenFormat","token","isValid","cleanToken","match","maskToken","repeat","storeToken","validation","tokenMask","encryptionKey","encryptedToken","storageData","btoa","created","expires","retrieveToken","storedData","clearToken","currentFingerprint","atob","decryptedToken","hasValidToken","getTokenInfo","timeRemaining","max","isExpired","migrateLegacyToken","legacyToken","metadataKey","getAllLocalChanges","getLocalContent","saveLocal","changes","allMetadata","getAllMetadata","originalPath","removeLocal","getMetadata","getLocalChangesCount","exportLocalChanges","format","exportData","exported","version","Blob","importLocalChanges","jsonData","importData","existingChanges","existingMetadata","mergedChanges","mergedMetadata","clearAllLocalChanges","getStorageInfo","changesSize","metadataSize","totalSize","formattedSize","formatBytes","bytes","floor","parseFloat","pow","toFixed","getRepositoryKey","getSelectedBranch","getBranchContext","setSelectedBranch","setBranchContext","clearRepositoryBranch","getDefaultBranchName","availableBranches","hasBranchContext","getBranchDisplayInfo","isDefault","displayText","repositoryExists","checkRepositoryExists","sushiConfigContent","fetchSushiConfig","yaml","dependencies","octokit","rest","repos","branchesToTry","getContent","decodeURIComponent","escape","branchError","validNamePattern","fullName","processConcurrently","items","processor","concurrency","onProgress","onItemComplete","onItemStart","total","completed","queue","item","workers","min","fill","shift","worker","ttlMinutes","ttl","_getCacheKey","_isValid","entry","compatible","entries","getStats","size","ageMinutes","tokenType","authenticate","startTime","auth","tokenProvided","secureTokenStorage","Octokit","duration","securelyStored","performance","authenticateWithOctokit","octokitInstance","initializeFromStoredToken","tokenData","hasStoredToken","getStoredTokenInfo","checkTokenPermissions","apiCall","response","request","apiResponse","rateLimitStart","rateLimit","resources","core","hasCore","rateLimitError","username","apiError","checkRepositoryWritePermissions","getCollaboratorPermissionLevel","hasWriteAccess","permission","checkRepositoryPermissions","users","getAuthenticated","getUserOrganizations","orgs","listForAuthenticatedUser","getOrganization","orgLogin","org","getByUsername","getWHOOrganization","whoData","display_name","can_create_repositories","can_create_private_repositories","plan","private_repos","isWHO","getRepositories","getDemoRepositories","getSmartGuidelinesRepositories","demoRepos","private","clone_url","stargazers_count","forks_count","open_issues_count","created_at","updated_at","pushed_at","smart_guidelines_compatible","resolve","checkSmartGuidelinesCompatibility","retryCount","cachedResult","repositoryCompatibilityCache","isCompatible","delay","hasMorePages","listForUser","per_page","listForOrg","smartGuidelinesRepos","getSmartGuidelinesRepositoriesProgressive","onRepositoryFound","currentRepo","progress","random","smartRepo","started","listBranches","createBranch","fromBranch","refData","git","getRef","createRef","object","getBranch","getWorkflows","actions","listRepoWorkflows","workflows","workflow","filename","triggers","getWorkflowRuns","workflow_id","listWorkflowRunsForRepo","getWorkflowRunsForWorkflow","listWorkflowRuns","triggerWorkflow","inputs","createWorkflowDispatch","rerunWorkflow","run_id","reRunWorkflow","getWorkflowRunLogs","downloadWorkflowRunLogs","approveWorkflowRun","getCommitDiff","base","head","compareCommits","getCommit","getReleases","listReleases","getLatestRelease","getBpmnFilesRecursive","allFiles","endsWith","getBpmnFiles","allBpmnFiles","possiblePaths","self","timeoutMs","timeoutPromise","reject","apiPromise","race","responseTime","encoding","hasContent","_error$stack","stack","createCommit","latestCommitSha","commitData","commit_sha","baseTreeSha","tree","blobs","blobData","createBlob","mode","treeData","createTree","base_tree","newCommitData","parents","updateRef","author","committer","getRecentCommits","listCommits","email","date","stats","getOpenPullRequestsCount","pulls","list","linkHeader","headers","link","lastPageMatch","parseInt","getPullRequestForBranch","prs","getPullRequestComments","pullNumber","listReviewComments","pull_number","getPullRequestIssueComments","issues","listComments","issue_number","createPullRequestComment","createComment","getOpenIssuesCount","listForRepo","getRepositoryStats","recentCommits","openPRsCount","openIssuesCount","allSettled","openPullRequestsCount","errors","getDirectoryContents","currentFile","createOrUpdateFileContents","unescape","getCommits","since","until","getIssues","milestone","getRepositoryIssues","getForks","listForks","fork","parent","getPullRequests","direction","locked","closed_at","merged_at","diff_url","patch_url","draft","mergeable","mergeable_state","comments","review_comments","commits","additions","deletions","changed_files","default","require","getRepositoryForks","forkCount"],"sourceRoot":""}