"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[8196],{18196:(e,s,a)=>{a.r(s),a.d(s,{default:()=>h});var n=a(89379),i=a(9950),r=a(29946),t=a(53782),c=a(29166),l=a(44414);const o=(0,i.lazy)(()=>Promise.all([a.e(3738),a.e(7845),a.e(2383),a.e(5743)]).then(a.bind(a,25743))),d=()=>{const{profile:e,repository:s,branch:a}=(0,t.N5)(),d=null===e||void 0===e?void 0:e.login,h=null===s||void 0===s?void 0:s.name,[m,p]=(0,i.useState)([]),[u,x]=(0,i.useState)(!0),[j,v]=(0,i.useState)(null),[g,b]=(0,i.useState)(null),[N,f]=(0,i.useState)(""),[y,w]=(0,i.useState)(!1),[C,S]=(0,i.useState)(!1),[k,A]=(0,i.useState)(!1),[F,D]=(0,i.useState)(""),[E,I]=(0,i.useState)(""),L=(0,i.useCallback)(async()=>{if(d&&h&&a)try{x(!0),v(null);const e="input/pagecontent",s=(await r.A.getDirectoryContents(d,h,e,a)).filter(e=>"file"===e.type&&e.name.startsWith("userscenario-")&&e.name.endsWith(".md")).map(e=>(0,n.A)((0,n.A)({},e),{},{id:e.name.replace("userscenario-","").replace(".md",""),title:e.name.replace("userscenario-","").replace(".md","").replace(/-/g," ")}));p(s)}catch(e){console.error("Error loading scenario files:",e),v("Failed to load user scenarios: ".concat(e.message))}finally{x(!1)}},[d,h,a]),P=(0,i.useCallback)(async e=>{if(d&&h&&a&&e)try{x(!0);const s=await r.A.getFileContent(d,h,e.path,a);f(s),b(e)}catch(s){console.error("Error loading scenario content:",s),v("Failed to load scenario: ".concat(s.message))}finally{x(!1)}},[d,h,a]),z=(0,i.useCallback)(async()=>{if(d&&h&&a&&g)try{S(!0);const e="Update user scenario: ".concat(g.id);await r.A.updateFile(d,h,g.path,N,e,g.sha,a),await L();const s=(await r.A.getDirectoryContents(d,h,"input/pagecontent",a)).find(e=>e.path===g.path);s&&b((0,n.A)((0,n.A)({},g),{},{sha:s.sha})),w(!1)}catch(e){console.error("Error saving scenario:",e),v("Failed to save scenario: ".concat(e.message))}finally{S(!1)}},[d,h,a,g,N,L]),U=(0,i.useCallback)(async()=>{var e;if(d&&h&&a&&F&&E)try{if(S(!0),!(/^[a-z0-9]+(-[a-z0-9]+)*$/.test(e=F)&&e.length>=3&&e.length<=50))return v("Scenario ID must be lowercase, use hyphens instead of spaces, and contain only letters, numbers, and hyphens."),void S(!1);const n="userscenario-".concat(F,".md"),i="input/pagecontent/".concat(n);try{return await r.A.getFileContent(d,h,i,a),v("A scenario with this ID already exists. Please choose a different ID."),void S(!1)}catch(s){}const t="# ".concat(E,"\n\n## Overview\nBrief description of this user scenario.\n\n## Actors\n- Primary actor: [Actor name]\n- Secondary actors: [List other actors if applicable]\n\n## Preconditions\n- [List any preconditions]\n\n## Flow of Events\n1. [Step 1]\n2. [Step 2]\n3. [Continue with the main flow]\n\n## Postconditions\n- [List the expected outcomes]\n\n## Alternative Flows\n### [Alternative Flow Name]\n- [Describe alternative scenarios]\n\n## Exception Flows\n### [Exception Flow Name]\n- [Describe error handling scenarios]\n\n## Notes\n- [Additional notes or considerations]\n"),c="Create new user scenario: ".concat(E);await r.A.createFile(d,h,i,t,c,a),await L(),A(!1),D(""),I("")}catch(s){console.error("Error creating scenario:",s),v("Failed to create scenario: ".concat(s.message))}finally{S(!1)}},[d,h,a,F,E,L]);return(0,i.useEffect)(()=>{L()},[L]),(0,i.useEffect)(()=>{if(E){const e=E.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");D(e)}},[E]),u&&!g?(0,l.jsx)("div",{className:"user-scenarios-container",children:(0,l.jsxs)("div",{className:"loading-container",children:[(0,l.jsx)("div",{className:"loading-spinner"}),(0,l.jsx)("p",{children:"Loading user scenarios..."})]})}):j&&!g?(0,l.jsx)("div",{className:"user-scenarios-container",children:(0,l.jsxs)("div",{className:"error-container",children:[(0,l.jsx)("h2",{children:"Error Loading User Scenarios"}),(0,l.jsx)("p",{children:j}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),children:"Retry"})]})}):(0,l.jsxs)("div",{className:"user-scenarios-container",children:[(0,l.jsxs)("div",{className:"user-scenarios-header",children:[(0,l.jsx)("h1",{children:"User Scenarios"}),(0,l.jsx)("p",{children:"Narrative descriptions of how different personas interact with the system in specific healthcare contexts."}),(0,l.jsx)("div",{className:"header-actions",children:(0,l.jsx)("button",{className:"btn-primary",onClick:()=>A(!0),disabled:C,children:"Create New Scenario"})})]}),(0,l.jsxs)("div",{className:"user-scenarios-content",children:[(0,l.jsxs)("div",{className:"scenarios-sidebar",children:[(0,l.jsxs)("h3",{children:["Available Scenarios (",m.length,")"]}),0===m.length?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("p",{children:"No user scenarios found."}),(0,l.jsx)("p",{children:'Click "Create New Scenario" to get started.'})]}):(0,l.jsx)("div",{className:"scenarios-list",children:m.map(e=>(0,l.jsxs)("div",{className:"scenario-item ".concat((null===g||void 0===g?void 0:g.path)===e.path?"selected":""),onClick:()=>P(e),onKeyDown:s=>{"Enter"!==s.key&&" "!==s.key||(s.preventDefault(),P(e))},role:"button",tabIndex:0,"aria-label":"Select user scenario: ".concat(e.title),children:[(0,l.jsx)("h4",{children:e.title}),(0,l.jsxs)("p",{className:"scenario-id",children:["ID: ",e.id]})]},e.path))})]}),(0,l.jsx)("div",{className:"scenario-editor",children:g?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"editor-header",children:[(0,l.jsx)("h2",{children:g.title}),(0,l.jsx)("div",{className:"editor-actions",children:y?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{className:"btn-secondary",onClick:()=>w(!1),disabled:C,children:"Cancel"}),(0,l.jsx)("button",{className:"btn-primary",onClick:z,disabled:C,children:C?"Saving...":"Save"})]}):(0,l.jsx)("button",{className:"btn-primary",onClick:()=>w(!0),children:"Edit"})})]}),(0,l.jsx)("div",{className:"editor-content",children:y?(0,l.jsx)(i.Suspense,{fallback:(0,l.jsx)("div",{children:"Loading editor..."}),children:(0,l.jsx)(o,{value:N,onChange:f,height:600,"data-color-mode":"light"})}):(0,l.jsx)(i.Suspense,{fallback:(0,l.jsx)("div",{children:"Loading preview..."}),children:(0,l.jsx)(o.Markdown,{source:N,style:{whiteSpace:"pre-wrap"}})})})]}):(0,l.jsx)("div",{className:"editor-placeholder",children:(0,l.jsx)("p",{children:"Select a scenario from the list to view or edit it."})})})]}),k&&(0,l.jsx)("div",{className:"modal-overlay",children:(0,l.jsxs)("div",{className:"modal",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h3",{children:"Create New User Scenario"}),(0,l.jsx)("button",{className:"modal-close",onClick:()=>A(!1),children:"\xd7"})]}),(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"scenario-title",children:"Scenario Title:"}),(0,l.jsx)("input",{id:"scenario-title",type:"text",value:E,onChange:e=>I(e.target.value),placeholder:"e.g., Patient Registration Flow"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"scenario-id",children:"Scenario ID:"}),(0,l.jsx)("input",{id:"scenario-id",type:"text",value:F,onChange:e=>D(e.target.value),placeholder:"e.g., patient-registration-flow"}),(0,l.jsx)("small",{className:"form-help",children:"ID must be lowercase, use hyphens instead of spaces, and contain only letters, numbers, and hyphens."})]}),j&&(0,l.jsx)("div",{className:"error-message",children:j})]}),(0,l.jsxs)("div",{className:"modal-actions",children:[(0,l.jsx)("button",{className:"btn-secondary",onClick:()=>A(!1),disabled:C,children:"Cancel"}),(0,l.jsx)("button",{className:"btn-primary",onClick:U,disabled:C||!E.trim()||!F.trim(),children:C?"Creating...":"Create Scenario"})]})]})}),j&&g&&(0,l.jsxs)("div",{className:"error-banner",children:[(0,l.jsx)("p",{children:j}),(0,l.jsx)("button",{onClick:()=>v(null),children:"Dismiss"})]}),(0,l.jsx)(c.A,{pageId:"user-scenarios",style:{position:"fixed",bottom:"20px",right:"20px"}})]})},h=()=>(0,l.jsx)(t.Mx,{pageName:"user-scenarios",children:(0,l.jsx)(d,{})})}}]);