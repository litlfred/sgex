"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[426],{5426:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Td});var i=n(79417),o=n(80197),r=n(65763);function a(e){r.A.call(this,e),this.on("import.parse.complete",function(e){e.error||this._collectIds(e.definitions,e.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}(0,i.A)(a,r.A),a.prototype._createModdle=function(e){var t=r.A.prototype._createModdle.call(this,e);return t.ids=new o.A([32,36,1]),t},a.prototype._collectIds=function(e,t){var n,i=e.$model.ids;for(n in i.clear(),t)i.claim(n,t[n])};var s=n(9011),c=n(9225),p=n(75649),l=n(57324),u=n(41036),h=n(69857);function d(e){return e&&e[e.length-1]}function f(e){return e.y}function m(e){return e.x}var v={left:m,center:m,right:function(e){return e.x+e.width},top:f,middle:f,bottom:function(e){return e.y+e.height}};function g(e,t){this._modeling=e,this._rules=t}g.$inject=["modeling","rules"],g.prototype._getOrientationDetails=function(e){var t="x",n="width";return-1!==["top","bottom","middle"].indexOf(e)&&(t="y",n="height"),{axis:t,dimension:n}},g.prototype._isType=function(e,t){return-1!==t.indexOf(e)},g.prototype._alignmentPosition=function(e,t){var n,i,o,r=this._getOrientationDetails(e),a=r.axis,s=r.dimension,c={},p={},l=!1;if(this._isType(e,["left","top"]))c[e]=t[0][a];else if(this._isType(e,["right","bottom"]))o=d(t),c[e]=o[a]+o[s];else if(this._isType(e,["center","middle"])){if((0,h.jJ)(t,function(e){var t=e[a]+Math.round(e[s]/2);p[t]?p[t].elements.push(e):p[t]={elements:[e],center:t}}),n=(0,h.Ul)(p,function(e){return e.elements.length>1&&(l=!0),e.elements.length}),l)return c[e]=d(n).center,c;i=t[0],o=d(t=(0,h.Ul)(t,function(e){return e[a]+e[s]})),c[e]=function(e,t){return Math.round((e[a]+t[a]+t[s])/2)}(i,o)}return c},g.prototype.trigger=function(e,t){var n,i=this._modeling,o=(0,h.pb)(e,function(e){return!(e.waypoints||e.host||e.labelTarget)});if(n=this._rules.allowed("elements.align",{elements:o}),(0,h.cy)(n)&&(o=n),!(o.length<2)&&n){var r=v[t],a=(0,h.Ul)(o,r),s=this._alignmentPosition(t,a);i.alignElements(a,s)}};const y={__init__:["alignElements"],alignElements:["type",g]};var b=n(93817),_=n(60019),x=n(8487);const w=new x.A;function E(e){this._scheduled={},e.on("diagram.destroy",()=>{Object.keys(this._scheduled).forEach(e=>{this.cancel(e)})})}E.$inject=["eventBus"],E.prototype.schedule=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.next();this.cancel(t);const n=this._schedule(e,t);return this._scheduled[t]=n,n.promise},E.prototype._schedule=function(e,t){const n=function(){const e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e}(),i=setTimeout(()=>{try{this._scheduled[t]=null;try{n.resolve(e())}catch(pu){n.reject(pu)}}catch(pu){console.error("Scheduler#_schedule execution failed",pu)}});return{executionId:i,promise:n.promise}},E.prototype.cancel=function(e){const t=this._scheduled[e];t&&(this._cancel(t),this._scheduled[e]=null)},E.prototype._cancel=function(e){clearTimeout(e.executionId)};const S={scheduler:["type",E]};var C=n(89232),k=n(4406),P=n(52532),T=".entry";function A(e,t,n,i){this._canvas=e,this._elementRegistry=t,this._eventBus=n,this._scheduler=i,this._current=null,this._init()}A.$inject=["canvas","elementRegistry","eventBus","scheduler"],A.prototype._init=function(){var e=this;this._eventBus.on("selection.changed",function(t){var n=t.newSelection,i=n.length?1===n.length?n[0]:n:null;i?e.open(i,!0):e.close()}),this._eventBus.on("elements.changed",function(t){var n=t.elements,i=e._current;if(i){var o=i.target,r=(0,h.cy)(o)?o:[o];if(r.filter(function(e){return n.includes(e)}).length){e.close();var a=r.filter(function(t){return e._elementRegistry.get(t.id)});a.length&&e._updateAndOpen(a.length>1?a:a[0])}}}),this._eventBus.on("canvas.viewbox.changed",function(){e._updatePosition()}),this._eventBus.on("element.marker.update",function(t){if(e.isOpen()){var n=t.element,i=e._current;((0,h.cy)(i.target)?i.target:[i.target]).includes(n)&&e._updateVisibility()}}),this._container=this._createContainer()},A.prototype._createContainer=function(){var e=(0,C.zm)('<div class="djs-context-pad-parent"></div>');return this._canvas.getContainer().appendChild(e),e},A.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("contextPad.getProviders",e,function(e){e.providers.push(t)})},A.prototype.getEntries=function(e){var t=this._getProviders(),n=(0,h.cy)(e)?"getMultiElementContextPadEntries":"getContextPadEntries",i={};return(0,h.jJ)(t,function(t){if((0,h.Tn)(t[n])){var o=t[n](e);(0,h.Tn)(o)?i=o(i):(0,h.jJ)(o,function(e,t){i[t]=e})}}),i},A.prototype.trigger=function(e,t,n){var i,o,r=this,a=t.delegateTarget||t.target;return a?(i=(0,C.CF)(a,"data-action"),o=t.originalEvent||t,"mouseover"!==e?"mouseout"===e?(clearTimeout(this._timeout),void(this._mouseout&&(this._mouseout(),this._mouseout=null))):this.triggerEntry(i,e,o,n):void(this._timeout=setTimeout(function(){r._mouseout=r.triggerEntry(i,"hover",o,n)},300))):t.preventDefault()},A.prototype.triggerEntry=function(e,t,n,i){if(this.isShown()){var o=this._current.target,r=this._current.entries[e];if(r){var a=r.action;if(!1!==this._eventBus.fire("contextPad.trigger",{entry:r,event:n})){if((0,h.Tn)(a)){if("click"===t)return a(n,o,i)}else if(a[t])return a[t](n,o,i);n.preventDefault()}}}},A.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))},A.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers},A.prototype._updateAndOpen=function(e){var t,n=this.getEntries(e),i=this._createHtml(e);(0,h.jJ)(n,function(e,n){var o,r=e.group||"default",a=(0,C.zm)(e.html||'<div class="entry" draggable="true"></div>');(0,C.CF)(a,"data-action",n),(o=(0,C.P)("[data-group="+(0,k.F)(r)+"]",i))||(o=(0,C.zm)('<div class="group"></div>'),(0,C.CF)(o,"data-group",r),i.appendChild(o)),o.appendChild(a),e.className&&function(e,t){var n=(0,C.Ly)(e);(t=(0,h.cy)(t)?t:t.split(/\s+/g)).forEach(function(e){n.add(e)})}(a,e.className),e.title&&(0,C.CF)(a,"title",e.title),e.imageUrl&&(t=(0,C.zm)("<img>"),(0,C.CF)(t,"src",e.imageUrl),t.style.width="100%",t.style.height="100%",a.appendChild(t))}),(0,C.Ly)(i).add("open"),this._current={entries:n,html:i,target:e},this._updatePosition(),this._updateVisibility(),this._eventBus.fire("contextPad.open",{current:this._current})},A.prototype._createHtml=function(e){var t=this,n=(0,C.zm)('<div class="djs-context-pad"></div>');return C.Mm.bind(n,T,"click",function(e){t.trigger("click",e)}),C.Mm.bind(n,T,"dragstart",function(e){t.trigger("dragstart",e)}),C.Mm.bind(n,T,"mouseover",function(e){t.trigger("mouseover",e)}),C.Mm.bind(n,T,"mouseout",function(e){t.trigger("mouseout",e)}),C.f0.bind(n,"mousedown",function(e){e.stopPropagation()}),this._container.appendChild(n),this._eventBus.fire("contextPad.create",{target:e,pad:n}),n},A.prototype.getPad=function(e){let t;return console.warn(new Error("ContextPad#getPad is deprecated and will be removed in future library versions, cf. https://github.com/bpmn-io/diagram-js/pull/888")),t=this.isOpen()&&function(e,t){return e=(0,h.cy)(e)?e:[e],t=(0,h.cy)(t)?t:[t],e.length===t.length&&(0,h.Si)(e,function(e){return t.includes(e)})}(this._current.target,e)?this._current.html:this._createHtml(e),{html:t}},A.prototype.close=function(){this.isOpen()&&(clearTimeout(this._timeout),this._container.innerHTML="",this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},A.prototype.isOpen=function(e){var t=this._current;if(!t)return!1;if(!e)return!0;var n=t.target;return(0,h.cy)(e)===(0,h.cy)(n)&&((0,h.cy)(e)?e.length===n.length&&(0,h.Si)(e,function(e){return n.includes(e)}):n===e)},A.prototype.isShown=function(){return this.isOpen()&&(0,C.Ly)(this._current.html).has("open")},A.prototype.show=function(){this.isOpen()&&((0,C.Ly)(this._current.html).add("open"),this._updatePosition(),this._eventBus.fire("contextPad.show",{current:this._current}))},A.prototype.hide=function(){this.isOpen()&&((0,C.Ly)(this._current.html).remove("open"),this._eventBus.fire("contextPad.hide",{current:this._current}))},A.prototype._getPosition=function(e){if(!(0,h.cy)(e)&&(0,P.fX)(e)){var t=this._canvas.viewbox(),n=(r=e).waypoints[r.waypoints.length-1],i=n.x*t.scale-t.x*t.scale,o=n.y*t.scale-t.y*t.scale;return{left:i+8*this._canvas.zoom(),top:o}}var r,a=this._canvas.getContainer().getBoundingClientRect(),s=this._getTargetBounds(e);return{left:s.right-a.left+8*this._canvas.zoom(),top:s.top-a.top}},A.prototype._updatePosition=function(){this._scheduler.schedule(()=>{if(this.isOpen()){var e=this._current.html,t=this._getPosition(this._current.target);"x"in t&&"y"in t?(e.style.left=t.x+"px",e.style.top=t.y+"px"):["top","right","bottom","left"].forEach(function(n){n in t&&(e.style[n]=t[n]+"px")})}},"ContextPad#_updatePosition")},A.prototype._updateVisibility=function(){this._scheduler.schedule(()=>{if(this.isOpen()){var e=this,t=this._current.target;((0,h.cy)(t)?t:[t]).some(function(t){return e._canvas.hasMarker(t,"djs-element-hidden")})?e.hide():e.show()}},"ContextPad#_updateVisibility")},A.prototype._getTargetBounds=function(e){var t=this;return((0,h.cy)(e)?e:[e]).map(function(e){return t._canvas.getGraphics(e)}).reduce(function(e,t){const n=t.getBoundingClientRect();return e.top=Math.min(e.top,n.top),e.right=Math.max(e.right,n.right),e.bottom=Math.max(e.bottom,n.bottom),e.left=Math.min(e.left,n.left),e.x=e.left,e.y=e.top,e.width=e.right-e.left,e.height=e.bottom-e.top,e},{top:1/0,right:-1/0,bottom:-1/0,left:1/0})};const j={__depends__:[b.A,S,_.A],contextPad:["type",A]};function B(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var D,R,M,N,F,L,O,z,I,$,H,J=n(89379),G={},U=[],W=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,V=Array.isArray;function q(e,t){for(var n in t)e[n]=t[n];return e}function X(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Q(e,t,n){var i,o,r,a={};for(r in t)"key"==r?i=t[r]:"ref"==r?o=t[r]:a[r]=t[r];if(arguments.length>2&&(a.children=arguments.length>3?D.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===a[r]&&(a[r]=e.defaultProps[r]);return K(e,a,i,o,null)}function K(e,t,n,i,o){var r={type:e,props:t,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==o?++M:o,__i:-1,__u:0};return null==o&&null!=R.vnode&&R.vnode(r),r}function Z(e){return e.children}function Y(e,t){this.props=e,this.context=t}function ee(e,t){if(null==t)return e.__?ee(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?ee(e):null}function te(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return te(e)}}function ne(e){(!e.__d&&(e.__d=!0)&&N.push(e)&&!ie.__r++||F!=R.debounceRendering)&&((F=R.debounceRendering)||L)(ie)}function ie(){for(var e,t,n,i,o,r,a,s=1;N.length;)N.length>s&&N.sort(O),e=N.shift(),s=N.length,e.__d&&(n=void 0,i=void 0,o=(i=(t=e).__v).__e,r=[],a=[],t.__P&&((n=q({},i)).__v=i.__v+1,R.vnode&&R.vnode(n),ue(t.__P,n,i,t.__n,t.__P.namespaceURI,32&i.__u?[o]:null,r,null==o?ee(i):o,!!(32&i.__u),a),n.__v=i.__v,n.__.__k[n.__i]=n,de(r,n,a),i.__e=i.__=null,n.__e!=o&&te(n)));ie.__r=0}function oe(e,t,n,i,o,r,a,s,c,p,l){var u,h,d,f,m,v,g,y=i&&i.__k||U,b=t.length;for(c=re(n,t,y,c,b),u=0;u<b;u++)null!=(d=n.__k[u])&&(h=-1==d.__i?G:y[d.__i]||G,d.__i=u,v=ue(e,d,h,o,r,a,s,c,p,l),f=d.__e,d.ref&&h.ref!=d.ref&&(h.ref&&ve(h.ref,null,d),l.push(d.ref,d.__c||f,d)),null==m&&null!=f&&(m=f),(g=!!(4&d.__u))||h.__k===d.__k?c=ae(d,c,e,g):"function"==typeof d.type&&void 0!==v?c=v:f&&(c=f.nextSibling),d.__u&=-7);return n.__e=m,c}function re(e,t,n,i,o){var r,a,s,c,p,l=n.length,u=l,h=0;for(e.__k=new Array(o),r=0;r<o;r++)null!=(a=t[r])&&"boolean"!=typeof a&&"function"!=typeof a?(c=r+h,(a=e.__k[r]="string"==typeof a||"number"==typeof a||"bigint"==typeof a||a.constructor==String?K(null,a,null,null,null):V(a)?K(Z,{children:a},null,null,null):null==a.constructor&&a.__b>0?K(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=e,a.__b=e.__b+1,s=null,-1!=(p=a.__i=se(a,n,c,u))&&(u--,(s=n[p])&&(s.__u|=2)),null==s||null==s.__v?(-1==p&&(o>l?h--:o<l&&h++),"function"!=typeof a.type&&(a.__u|=4)):p!=c&&(p==c-1?h--:p==c+1?h++:(p>c?h--:h++,a.__u|=4))):e.__k[r]=null;if(u)for(r=0;r<l;r++)null!=(s=n[r])&&0==(2&s.__u)&&(s.__e==i&&(i=ee(s)),ge(s,s));return i}function ae(e,t,n,i){var o,r;if("function"==typeof e.type){for(o=e.__k,r=0;o&&r<o.length;r++)o[r]&&(o[r].__=e,t=ae(o[r],t,n,i));return t}e.__e!=t&&(i&&(t&&e.type&&!t.parentNode&&(t=ee(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function se(e,t,n,i){var o,r,a,s=e.key,c=e.type,p=t[n],l=null!=p&&0==(2&p.__u);if(null===p&&null==e.key||l&&s==p.key&&c==p.type)return n;if(i>(l?1:0))for(o=n-1,r=n+1;o>=0||r<t.length;)if(null!=(p=t[a=o>=0?o--:r++])&&0==(2&p.__u)&&s==p.key&&c==p.type)return a;return-1}function ce(e,t,n){"-"==t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||W.test(t)?n:n+"px"}function pe(e,t,n,i,o){var r,a;e:if("style"==t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||ce(e.style,t,"");if(n)for(t in n)i&&n[t]==i[t]||ce(e.style,t,n[t])}else if("o"==t[0]&&"n"==t[1])r=t!=(t=t.replace(z,"$1")),a=t.toLowerCase(),t=a in e||"onFocusOut"==t||"onFocusIn"==t?a.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?i?n.u=i.u:(n.u=I,e.addEventListener(t,r?H:$,r)):e.removeEventListener(t,r?H:$,r);else{if("http://www.w3.org/2000/svg"==o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==n?"":n))}}function le(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.t)t.t=I++;else if(t.t<n.u)return;return n(R.event?R.event(t):t)}}}function ue(e,t,n,i,o,r,a,s,c,p){var l,u,h,d,f,m,v,g,y,b,_,x,w,E,S,C,k,P=t.type;if(null!=t.constructor)return null;128&n.__u&&(c=!!(32&n.__u),r=[s=t.__e=n.__e]),(l=R.__b)&&l(t);e:if("function"==typeof P)try{if(g=t.props,y="prototype"in P&&P.prototype.render,b=(l=P.contextType)&&i[l.__c],_=l?b?b.props.value:l.__:i,n.__c?v=(u=t.__c=n.__c).__=u.__E:(y?t.__c=u=new P(g,_):(t.__c=u=new Y(g,_),u.constructor=P,u.render=ye),b&&b.sub(u),u.props=g,u.state||(u.state={}),u.context=_,u.__n=i,h=u.__d=!0,u.__h=[],u._sb=[]),y&&null==u.__s&&(u.__s=u.state),y&&null!=P.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=q({},u.__s)),q(u.__s,P.getDerivedStateFromProps(g,u.__s))),d=u.props,f=u.state,u.__v=t,h)y&&null==P.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),y&&null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(y&&null==P.getDerivedStateFromProps&&g!==d&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(g,_),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(g,u.__s,_)||t.__v==n.__v){for(t.__v!=n.__v&&(u.props=g,u.state=u.__s,u.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(e){e&&(e.__=t)}),x=0;x<u._sb.length;x++)u.__h.push(u._sb[x]);u._sb=[],u.__h.length&&a.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(g,u.__s,_),y&&null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(d,f,m)})}if(u.context=_,u.props=g,u.__P=e,u.__e=!1,w=R.__r,E=0,y){for(u.state=u.__s,u.__d=!1,w&&w(t),l=u.render(u.props,u.state,u.context),S=0;S<u._sb.length;S++)u.__h.push(u._sb[S]);u._sb=[]}else do{u.__d=!1,w&&w(t),l=u.render(u.props,u.state,u.context),u.state=u.__s}while(u.__d&&++E<25);u.state=u.__s,null!=u.getChildContext&&(i=q(q({},i),u.getChildContext())),y&&!h&&null!=u.getSnapshotBeforeUpdate&&(m=u.getSnapshotBeforeUpdate(d,f)),C=l,null!=l&&l.type===Z&&null==l.key&&(C=fe(l.props.children)),s=oe(e,V(C)?C:[C],t,n,i,o,r,a,s,c,p),u.base=t.__e,t.__u&=-161,u.__h.length&&a.push(u),v&&(u.__E=u.__=null)}catch(e){if(t.__v=null,c||null!=r)if(e.then){for(t.__u|=c?160:128;s&&8==s.nodeType&&s.nextSibling;)s=s.nextSibling;r[r.indexOf(s)]=null,t.__e=s}else{for(k=r.length;k--;)X(r[k]);he(t)}else t.__e=n.__e,t.__k=n.__k,e.then||he(t);R.__e(e,t,n)}else null==r&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):s=t.__e=me(n.__e,t,n,i,o,r,a,c,p);return(l=R.diffed)&&l(t),128&t.__u?void 0:s}function he(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(he)}function de(e,t,n){for(var i=0;i<n.length;i++)ve(n[i],n[++i],n[++i]);R.__c&&R.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){R.__e(e,t.__v)}})}function fe(e){return"object"!=typeof e||null==e||e.__b&&e.__b>0?e:V(e)?e.map(fe):q({},e)}function me(e,t,n,i,o,r,a,s,c){var p,l,u,h,d,f,m,v=n.props,g=t.props,y=t.type;if("svg"==y?o="http://www.w3.org/2000/svg":"math"==y?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),null!=r)for(p=0;p<r.length;p++)if((d=r[p])&&"setAttribute"in d==!!y&&(y?d.localName==y:3==d.nodeType)){e=d,r[p]=null;break}if(null==e){if(null==y)return document.createTextNode(g);e=document.createElementNS(o,y,g.is&&g),s&&(R.__m&&R.__m(t,r),s=!1),r=null}if(null==y)v===g||s&&e.data==g||(e.data=g);else{if(r=r&&D.call(e.childNodes),v=n.props||G,!s&&null!=r)for(v={},p=0;p<e.attributes.length;p++)v[(d=e.attributes[p]).name]=d.value;for(p in v)if(d=v[p],"children"==p);else if("dangerouslySetInnerHTML"==p)u=d;else if(!(p in g)){if("value"==p&&"defaultValue"in g||"checked"==p&&"defaultChecked"in g)continue;pe(e,p,null,d,o)}for(p in g)d=g[p],"children"==p?h=d:"dangerouslySetInnerHTML"==p?l=d:"value"==p?f=d:"checked"==p?m=d:s&&"function"!=typeof d||v[p]===d||pe(e,p,d,v[p],o);if(l)s||u&&(l.__html==u.__html||l.__html==e.innerHTML)||(e.innerHTML=l.__html),t.__k=[];else if(u&&(e.innerHTML=""),oe("template"==t.type?e.content:e,V(h)?h:[h],t,n,i,"foreignObject"==y?"http://www.w3.org/1999/xhtml":o,r,a,r?r[0]:n.__k&&ee(n,0),s,c),null!=r)for(p=r.length;p--;)X(r[p]);s||(p="value","progress"==y&&null==f?e.removeAttribute("value"):null!=f&&(f!==e[p]||"progress"==y&&!f||"option"==y&&f!=v[p])&&pe(e,p,f,v[p],o),p="checked",null!=m&&m!=e[p]&&pe(e,p,m,v[p],o))}return e}function ve(e,t,n){try{if("function"==typeof e){var i="function"==typeof e.__u;i&&e.__u(),i&&null==t||(e.__u=e(t))}else e.current=t}catch(e){R.__e(e,n)}}function ge(e,t,n){var i,o;if(R.unmount&&R.unmount(e),(i=e.ref)&&(i.current&&i.current!=e.__e||ve(i,null,t)),null!=(i=e.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){R.__e(e,t)}i.base=i.__P=null}if(i=e.__k)for(o=0;o<i.length;o++)i[o]&&ge(i[o],t,n||"function"!=typeof e.type);n||X(e.__e),e.__c=e.__=e.__e=void 0}function ye(e,t,n){return this.constructor(e,n)}function be(e,t,n){var i,o,r,a;t==document&&(t=document.documentElement),R.__&&R.__(e,t),o=(i="function"==typeof n)?null:n&&n.__k||t.__k,r=[],a=[],ue(t,e=(!i&&n||t).__k=Q(Z,null,[e]),o||G,G,t.namespaceURI,!i&&n?[n]:o?null:t.firstChild?D.call(t.childNodes):null,r,!i&&n?n:o?o.__e:t.firstChild,i,a),de(r,e,a)}D=U.slice,R={__e:function(e,t,n,i){for(var o,r,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((r=o.constructor)&&null!=r.getDerivedStateFromError&&(o.setState(r.getDerivedStateFromError(e)),a=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(e,i||{}),a=o.__d),a)return o.__E=o}catch(t){e=t}throw e}},M=0,Y.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=q({},this.state),"function"==typeof e&&(e=e(q({},n),this.props)),e&&q(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),ne(this))},Y.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),ne(this))},Y.prototype.render=Z,N=[],L="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,O=function(e,t){return e.__v.__b-t.__v.__b},ie.__r=0,z=/(PointerCapture)$|Capture$/i,I=0,$=le(!1),H=le(!0);var _e=function(e,t,n,i){var o;t[0]=0;for(var r=1;r<t.length;r++){var a=t[r++],s=t[r]?(t[0]|=a?1:2,n[t[r++]]):t[++r];3===a?i[0]=s:4===a?i[1]=Object.assign(i[1]||{},s):5===a?(i[1]=i[1]||{})[t[++r]]=s:6===a?i[1][t[++r]]+=s+"":a?(o=e.apply(s,_e(e,s,n,["",null])),i.push(o),s[0]?t[0]|=2:(t[r-2]=0,t[r]=o)):i.push(s)}return i},xe=new Map;var we,Ee,Se,Ce,ke=function(e){var t=xe.get(this);return t||(t=new Map,xe.set(this,t)),(t=_e(this,t.get(e)||(t.set(e,t=function(e){for(var t,n,i=1,o="",r="",a=[0],s=function(e){1===i&&(e||(o=o.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(0,e,o):3===i&&(e||o)?(a.push(3,e,o),i=2):2===i&&"..."===o&&e?a.push(4,e,0):2===i&&o&&!e?a.push(5,0,!0,o):i>=5&&((o||!e&&5===i)&&(a.push(i,0,o,n),i=6),e&&(a.push(i,e,0,n),i=6)),o=""},c=0;c<e.length;c++){c&&(1===i&&s(),s(c));for(var p=0;p<e[c].length;p++)t=e[c][p],1===i?"<"===t?(s(),a=[a],i=3):o+=t:4===i?"--"===o&&">"===t?(i=1,o=""):o=t+o[0]:r?t===r?r="":o+=t:'"'===t||"'"===t?r=t:">"===t?(s(),i=1):i&&("="===t?(i=5,n=o,o=""):"/"===t&&(i<5||">"===e[c][p+1])?(s(),3===i&&(a=a[0]),i=a,(a=a[0]).push(2,0,i),i=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(s(),i=2):o+=t),3===i&&"!--"===o&&(i=4,a=a[0])}return s(),a}(e)),t),arguments,[])).length>1?t:t[0]}.bind(Q),Pe=0,Te=[],Ae=R,je=Ae.__b,Be=Ae.__r,De=Ae.diffed,Re=Ae.__c,Me=Ae.unmount,Ne=Ae.__;function Fe(e,t){Ae.__h&&Ae.__h(Ee,e,Pe||t),Pe=0;var n=Ee.__H||(Ee.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function Le(e){return Pe=1,function(e,t,n){var i=Fe(we++,2);if(i.t=e,!i.__c&&(i.__=[n?n(t):Xe(void 0,t),function(e){var t=i.__N?i.__N[0]:i.__[0],n=i.t(t,e);t!==n&&(i.__N=[n,i.__[1]],i.__c.setState({}))}],i.__c=Ee,!Ee.__f)){var o=function(e,t,n){if(!i.__c.__H)return!0;var o=i.__c.__H.__.filter(function(e){return!!e.__c});if(o.every(function(e){return!e.__N}))return!r||r.call(this,e,t,n);var a=i.__c.props!==e;return o.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(a=!0)}}),r&&r.call(this,e,t,n)||a};Ee.__f=!0;var r=Ee.shouldComponentUpdate,a=Ee.componentWillUpdate;Ee.componentWillUpdate=function(e,t,n){if(this.__e){var i=r;r=void 0,o(e,t,n),r=i}a&&a.call(this,e,t,n)},Ee.shouldComponentUpdate=o}return i.__N||i.__}(Xe,e)}function Oe(e,t){var n=Fe(we++,3);!Ae.__s&&qe(n.__H,t)&&(n.__=e,n.u=t,Ee.__H.__h.push(n))}function ze(e,t){var n=Fe(we++,4);!Ae.__s&&qe(n.__H,t)&&(n.__=e,n.u=t,Ee.__h.push(n))}function Ie(e){return Pe=5,$e(function(){return{current:e}},[])}function $e(e,t){var n=Fe(we++,7);return qe(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function He(e,t){return Pe=8,$e(function(){return e},t)}function Je(){for(var e;e=Te.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(We),e.__H.__h.forEach(Ve),e.__H.__h=[]}catch(t){e.__H.__h=[],Ae.__e(t,e.__v)}}Ae.__b=function(e){Ee=null,je&&je(e)},Ae.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Ne&&Ne(e,t)},Ae.__r=function(e){Be&&Be(e),we=0;var t=(Ee=e.__c).__H;t&&(Se===Ee?(t.__h=[],Ee.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(We),t.__h.forEach(Ve),t.__h=[],we=0)),Se=Ee},Ae.diffed=function(e){De&&De(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Te.push(t)&&Ce===Ae.requestAnimationFrame||((Ce=Ae.requestAnimationFrame)||Ue)(Je)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),Se=Ee=null},Ae.__c=function(e,t){t.some(function(e){try{e.__h.forEach(We),e.__h=e.__h.filter(function(e){return!e.__||Ve(e)})}catch(F){t.some(function(e){e.__h&&(e.__h=[])}),t=[],Ae.__e(F,e.__v)}}),Re&&Re(e,t)},Ae.unmount=function(e){Me&&Me(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(e){try{We(e)}catch(e){t=e}}),n.__H=void 0,t&&Ae.__e(t,n.__v))};var Ge="function"==typeof requestAnimationFrame;function Ue(e){var t,n=function(){clearTimeout(i),Ge&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,35);Ge&&(t=requestAnimationFrame(n))}function We(e){var t=Ee,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),Ee=t}function Ve(e){var t=Ee;e.__c=e.__(),Ee=t}function qe(e,t){return!e||e.length!==t.length||t.some(function(t,n){return t!==e[n]})}function Xe(e,t){return"function"==typeof t?t(e):t}function Qe(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=Qe(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}const Ke=function(){for(var e,t,n=0,i="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=Qe(e))&&(i&&(i+=" "),i+=t);return i};var Ze,Ye,et,tt,nt,it;function ot(e){const{headerEntries:t,onSelect:n,selectedEntry:i,setSelectedEntry:o,title:r}=e,a=$e(()=>t.reduce((e,t)=>{const n=t.group||"default",i=e.find(e=>e.id===n);return i?i.entries.push(t):e.push({id:n,entries:[t]}),e},[]),[t]),s=e=>e.action&&!e.disabled;return ke(Ze||(Ze=B(['\n    <div class="djs-popup-header">\n      <h3 class="djs-popup-title" title=',">","</h3>\n      ","\n    </div>\n  "])),r,r,a.map(e=>ke(Ye||(Ye=B(["\n        <ul key=",' class="djs-popup-header-group" data-header-group=',">\n\n          ","\n        </ul>\n      "])),e.id,e.id,e.entries.map(e=>ke(et||(et=B(["\n            <li key=",">\n              <","\n                class=","\n                onClick=","\n                title=","\n                data-id=","\n                aria-disabled=","\n                onMouseEnter=","\n                onMouseLeave=","\n                onFocus=","\n                onBlur=","\n              >\n                ","\n                ","\n              </",">\n            </li>\n          "])),e.id,s(e)?"button":"span",function(e,t){return Ke("entry",e.className,e.active?"active":"",e.disabled?"disabled":"",t?"selected":"")}(e,e===i),t=>((e,t)=>{if(s(t))return n(e,t)})(t,e),e.title||e.label,e.id,e.disabled||void 0,()=>s(e)&&o(e),()=>s(e)&&o(null),()=>s(e)&&o(e),()=>s(e)&&o(null),e.imageUrl&&ke(tt||(tt=B(['<img class="djs-popup-entry-icon" src=',' alt="" />'])),e.imageUrl)||e.imageHtml&&ke(nt||(nt=B(['<div class="djs-popup-entry-icon" dangerouslySetInnerHTML='," />"])),{__html:e.imageHtml}),e.label?ke(it||(it=B(['\n                  <span class="djs-popup-label">',"</span>\n                "])),e.label):null,e.action?"button":"span")))))}var rt,at,st,ct,pt,lt,ut,ht,dt,ft,mt=n(80045);function vt(e){const{entry:t,selected:n,onMouseEnter:i,onMouseLeave:o,onAction:r}=e,a=(e,n)=>{if(!t.disabled)return r(e,t,n)};return ke(rt||(rt=B(["\n    <li\n      class=","\n      data-id=","\n      title=","\n      aria-disabled=",'\n      tabIndex="0"\n      onClick=',"\n      onFocus=","\n      onBlur=","\n      onMouseEnter=","\n      onMouseLeave=","\n      onDragStart=","\n      draggable=",'\n    >\n      <div class="djs-popup-entry-content">\n        <span\n          class=',"\n        >\n          ","\n\n          ","\n        </span>\n        ","\n      </div>\n      ","\n    </li>\n  "])),Ke("entry",{selected:n,disabled:t.disabled}),t.id,t.title||t.label,t.disabled||void 0,a,i,o,i,o,e=>a(e,"dragstart"),!0,Ke("djs-popup-entry-name",t.className),t.imageUrl&&ke(at||(at=B(['<img class="djs-popup-entry-icon" src=',' alt="" />'])),t.imageUrl)||t.imageHtml&&ke(st||(st=B(['<div class="djs-popup-entry-icon" dangerouslySetInnerHTML='," />"])),{__html:t.imageHtml}),t.label?ke(ct||(ct=B(['\n            <span class="djs-popup-label">\n              ',"\n            </span>\n          "])),t.label):null,t.description&&ke(pt||(pt=B(['\n          <span\n            class="djs-popup-entry-description"\n            title=',"\n          >\n            ","\n          </span>\n        "])),t.description,t.description),t.documentationRef&&ke(lt||(lt=B(['\n        <div class="djs-popup-entry-docs">\n          <a\n            href="','"\n            onClick=','\n            title="Open element documentation"\n            target="_blank"\n            rel="noopener"\n          >\n            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path fill-rule="evenodd" clip-rule="evenodd" d="M10.6368 10.6375V5.91761H11.9995V10.6382C11.9995 10.9973 11.8623 11.3141 11.5878 11.5885C11.3134 11.863 10.9966 12.0002 10.6375 12.0002H1.36266C0.982345 12.0002 0.660159 11.8681 0.396102 11.6041C0.132044 11.34 1.52588e-05 11.0178 1.52588e-05 10.6375V1.36267C1.52588e-05 0.98236 0.132044 0.660173 0.396102 0.396116C0.660159 0.132058 0.982345 2.95639e-05 1.36266 2.95639e-05H5.91624V1.36267H1.36266V10.6375H10.6368ZM12 0H7.2794L7.27873 1.36197H9.68701L3.06507 7.98391L4.01541 8.93425L10.6373 2.31231V4.72059H12V0Z" fill="#818798"/>\n            </svg>\n          </a>\n        </div>\n      '])),t.documentationRef,e=>e.stopPropagation()))}const gt=["selectedEntry","setSelectedEntry","groupedEntries"];function yt(e){const{selectedEntry:t,setSelectedEntry:n,groupedEntries:i}=e,o=(0,mt.A)(e,gt),r=Ie();return ze(()=>{const e=r.current;if(!e)return;const t=e.querySelector(".selected");var n;t&&("function"===typeof(n=t).scrollIntoViewIfNeeded?n.scrollIntoViewIfNeeded():n.scrollIntoView({scrollMode:"if-needed",block:"nearest"}))},[t]),ke(ut||(ut=B(['\n    <div class="djs-popup-results" ref=',">\n      ","\n    </div>\n  "])),r,i.map(e=>ke(ht||(ht=B(["\n        ",'\n        <ul class="djs-popup-group" data-group=',">\n          ","\n        </ul>\n      "])),e.name&&ke(dt||(dt=B(["\n          <div key=",' class="entry-header" title=',">\n            ","\n          </div>\n        "])),e.id,e.name,e.name),e.id,e.entries.map(e=>ke(ft||(ft=B(["\n            <","\n              key=","\n              entry=","\n              selected=","\n              onMouseEnter=","\n              onMouseLeave=","\n              ...","\n            />\n          "])),vt,e.id,e,e===t,()=>n(e),()=>n(null),o)))))}var bt,_t,xt,wt,Et,St,Ct;function kt(e){const{onClose:t,onSelect:n,className:i,headerEntries:o,position:r,title:a,width:s,scale:c,search:p,emptyPlaceholder:l,searchFn:u,entries:d,onOpened:f,onClosed:m}=e,v=$e(()=>!!(0,h.O9)(p)&&d.length>5,[p,d]),[g,y]=Le(""),b=He((e,t)=>{if(!v)return e;if(!t.trim())return e.filter(e=>{let{rank:t=0}=e;return t>=0});const n=e.filter(e=>{let{searchable:t}=e;return!1!==t});return u(n,t,{keys:["label","search","description"]}).map(e=>{let{item:t}=e;return t})},[v]),[_,x]=Le(b(d,g)),[w,E]=Le(_[0]),S=$e(()=>function(e){const t=[],n=e=>t.find(t=>e.id===t.id),i=e=>!!n(e),o=e=>"string"===typeof e?{id:e}:e;return e.forEach(e=>{const r=e.group?o(e.group):{id:"default"};i(r)?n(r).entries.push(e):t.push((0,J.A)((0,J.A)({},r),{},{entries:[e]}))}),t}(_),[_]),k=He(e=>{E(e[0]),x(e)},[x,E]);Oe(()=>{k(b(d,g))},[g,d]);const P=He(e=>{const t=function(e){const t=[];return e.forEach(e=>{e.entries.forEach(e=>{t.push(e)})}),t}(S);let n=t.indexOf(w)+e;n<0&&(n=t.length-1),n>=t.length&&(n=0),E(t[n])},[S,w,E]),T=He(e=>{if("Enter"===e.key&&w){if(w.disabled)return;return n(e,w)}return"ArrowUp"===e.key?(P(-1),e.preventDefault()):"ArrowDown"===e.key?(P(1),e.preventDefault()):void 0},[n,w,P]),A=He(e=>{(0,C.cK)(e.target,"input")&&y(()=>e.target.value)},[y]);Oe(()=>(f(),()=>{m()}),[]);const j=$e(()=>a||o.length>0,[a,o]);return ke(bt||(bt=B(["\n    <","\n      onClose=","\n      onKeyup=","\n      onKeydown=","\n      className=","\n      position=","\n      width=","\n      scale=","\n    >\n      ","\n      ","\n    ","\n    </",">\n  "])),Pt,t,A,T,i,r,s,c,j&&ke(_t||(_t=B(["\n        <","\n          headerEntries=","\n          onSelect=","\n          selectedEntry=","\n          setSelectedEntry=","\n          title=","\n        />\n      "])),ot,o,n,w,E,a),d.length>0&&ke(xt||(xt=B(['\n        <div class="djs-popup-body">\n\n          ',"\n\n          <","\n            groupedEntries=","\n            selectedEntry=","\n            setSelectedEntry=","\n            onAction=","\n          />\n        </div>\n      "])),v&&ke(wt||(wt=B(['\n          <div class="djs-popup-search">\n            <svg class="djs-popup-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>\n            </svg>\n            <input type="text" spellcheck=',' aria-label="','" />\n          </div>\n          '])),!1,a),yt,S,w,E,n),l&&0===_.length&&ke(Et||(Et=B(['\n      <div class="djs-popup-no-results">',"</div>\n    "])),(0,h.Tn)(l)?l(g):l),Pt)}function Pt(e){const{onClose:t,onKeydown:n,onKeyup:i,className:o,children:r,position:a}=e,s=Ie();return ze(()=>{if("function"!==typeof a)return;const e=s.current,t=a(e);e.style.left="".concat(t.x,"px"),e.style.top="".concat(t.y,"px")},[s.current,a]),ze(()=>{const e=s.current;if(!e)return;(e.querySelector("input")||e).focus()},[]),Oe(()=>{const e=e=>{if("Escape"===e.key)return e.preventDefault(),t()},n=e=>{if(!(0,C.kp)(e.target,".djs-popup",!0))return t()};return document.documentElement.addEventListener("keydown",e),document.body.addEventListener("click",n),()=>{document.documentElement.removeEventListener("keydown",e),document.body.removeEventListener("click",n)}},[]),ke(St||(St=B(["\n    <div\n      class=","\n      style=","\n      onKeydown=","\n      onKeyup=","\n      ref=",'\n      tabIndex="-1"\n    >\n      ',"\n    </div>\n  "])),Ke("djs-popup",o),function(e){return{transform:"scale(".concat(e.scale,")"),width:"".concat(e.width,"px"),"transform-origin":"top left"}}(e),n,i,s,r)}var Tt=["contextPad.close","canvas.viewbox.changing","commandStack.changed"];function At(e,t,n,i){this._eventBus=t,this._canvas=n,this._search=i,this._current=null;var o=(0,h.O9)(e&&e.scale)?e.scale:{min:1,max:1};this._config={scale:o},t.on("diagram.destroy",()=>{this.close()}),t.on("element.changed",e=>{const t=this.isOpen()&&this._current.target;e.element===t&&this.refresh()})}function jt(e,t){return Bt(t)-Bt(e)}function Bt(e){return e.reduce((e,t)=>e+Dt(t),0)}function Dt(e){if((0,h.cy)(e))return Math.max(...e.map(Dt));const t=Math.log(e.value.length);return e.match?(e.start?e.end?131.9:7.87:e.wordStart?2.19:1)*t:-.07*t}function Rt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,h.cy)(e)?e.join(", "):e}function Mt(e,t){return Rt(e).localeCompare(Rt(t))}function Nt(e,t){if(!e)return{tokens:[],matchedWords:{}};const n=[],i={},o=t.map(Ft),r=["(?<all>".concat(o.join("\\s+"),")"),...o].join("|"),a=new RegExp(r,"ig");let s,c=0;for(;s=a.exec(e);){const[o]=s,r=s.index,a=s.index+o.length,p=0===r,l=a===e.length,u=!!s.groups.all,h=p||/\s/.test(e.charAt(r-1)),d=l||/\s/.test(e.charAt(a));s.index>c&&n.push({value:e.slice(c,s.index),index:c}),n.push({value:o,index:s.index,match:!0,wordStart:h,wordEnd:d,start:p,end:l,all:u});const f=u?t:[o];for(const e of f)i[e.toLowerCase()]=!0;c=s.index+o.length}return c<e.length&&n.push({value:e.slice(c),index:c}),{tokens:n,matchedWords:i}}function Ft(e){return e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}At.$inject=["config.popupMenu","eventBus","canvas","search"],At.prototype._render=function(){const{position:e,providerId:t,entries:n,headerEntries:i,emptyPlaceholder:o,options:r}=this._current,a=Object.entries(n).map(e=>{let[t,n]=e;return(0,J.A)({id:t},n)}),s=Object.entries(i).map(e=>{let[t,n]=e;return(0,J.A)({id:t},n)}),c=e&&(t=>this._ensureVisible(t,e)),p=this._updateScale(this._current.container);be(ke(Ct||(Ct=B(["\n      <","\n        onClose=","\n        onSelect=","\n        position=","\n        className=","\n        entries=","\n        headerEntries=","\n        emptyPlaceholder=","\n        scale=","\n        onOpened=","\n        onClosed=","\n        searchFn=","\n        ...","\n      />\n    "])),kt,e=>this.close(e),(e,t,n)=>this.trigger(e,t,n),c,t,a,s,o,p,this._onOpened.bind(this),this._onClosed.bind(this),this._search,(0,J.A)({},r)),this._current.container)},At.prototype.open=function(e,t,n,i){if(!e)throw new Error("target is missing");if(!t)throw new Error("providers for <"+t+"> not found");if(!n)throw new Error("position is missing");this.isOpen()&&this.close();const{entries:o,headerEntries:r,emptyPlaceholder:a}=this._getContext(e,t);this._current={position:n,providerId:t,target:e,entries:o,headerEntries:r,emptyPlaceholder:a,container:this._createContainer({provider:t}),options:i},this._emit("open"),this._bindAutoClose(),this._render()},At.prototype.refresh=function(){if(!this.isOpen())return;const{target:e,providerId:t}=this._current,{entries:n,headerEntries:i,emptyPlaceholder:o}=this._getContext(e,t);this._current=(0,J.A)((0,J.A)({},this._current),{},{entries:n,headerEntries:i,emptyPlaceholder:o}),this._emit("refresh"),this._render()},At.prototype._getContext=function(e,t){const n=this._getProviders(t);if(!n||!n.length)throw new Error("provider for <"+t+"> not found");const i=this._getEntries(e,n),o=this._getHeaderEntries(e,n);return{entries:i,headerEntries:o,emptyPlaceholder:this._getEmptyPlaceholder(n),empty:!(Object.keys(i).length||Object.keys(o).length)}},At.prototype.close=function(){this.isOpen()&&(this._emit("close"),this.reset(),this._canvas.restoreFocus(),this._current=null)},At.prototype.reset=function(){const e=this._current.container;be(null,e),(0,C.TF)(e)},At.prototype._emit=function(e,t){this._eventBus.fire("popupMenu.".concat(e),t)},At.prototype._onOpened=function(){this._emit("opened")},At.prototype._onClosed=function(){this._emit("closed")},At.prototype._createContainer=function(e){var t=this._canvas.getContainer();const n=(0,C.zm)('<div class="djs-popup-parent djs-scrollable" data-popup='.concat(e.provider,"></div>"));return t.appendChild(n),n},At.prototype._bindAutoClose=function(){this._eventBus.once(Tt,this.close,this)},At.prototype._unbindAutoClose=function(){this._eventBus.off(Tt,this.close,this)},At.prototype._updateScale=function(){var e,t,n=this._canvas.zoom(),i=this._config.scale,o=n;return!0!==i&&(!1===i?(e=1,t=1):(e=i.min,t=i.max),(0,h.O9)(e)&&n<e&&(o=e),(0,h.O9)(t)&&n>t&&(o=t)),o},At.prototype._ensureVisible=function(e,t){var n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect(),o={},r=t.x,a=t.y;return t.x+i.width>n.width&&(o.x=!0),t.y+i.height>n.height&&(o.y=!0),o.x&&o.y?(r=t.x-i.width,a=t.y-i.height):o.x?(r=t.x-i.width,a=t.y):o.y&&t.y<i.height?(r=t.x,a=10):o.y&&(r=t.x,a=t.y-i.height),t.y<n.top&&(a=t.y+i.height),{x:r,y:a}},At.prototype.isEmpty=function(e,t){if(!e)throw new Error("target is missing");if(!t)throw new Error("provider ID is missing");const n=this._getProviders(t);return!n||!n.length||this._getContext(e,t).empty},At.prototype.registerProvider=function(e,t,n){n||(n=t,t=1e3),this._eventBus.on("popupMenu.getProviders."+e,t,function(e){e.providers.push(n)})},At.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers},At.prototype._getEntries=function(e,t){var n={};return(0,h.jJ)(t,function(t){if(t.getPopupMenuEntries){var i=t.getPopupMenuEntries(e);(0,h.Tn)(i)?n=i(n):(0,h.jJ)(i,function(e,t){n[t]=e})}else(0,h.jJ)(t.getEntries(e),function(e){var t=e.id;if(!t)throw new Error("entry ID is missing");n[t]=(0,h.cJ)(e,["id"])})}),n},At.prototype._getHeaderEntries=function(e,t){var n={};return(0,h.jJ)(t,function(t){if(t.getPopupMenuHeaderEntries){var i=t.getPopupMenuHeaderEntries(e);(0,h.Tn)(i)?n=i(n):(0,h.jJ)(i,function(e,t){n[t]=e})}else{if(!t.getHeaderEntries)return;(0,h.jJ)(t.getHeaderEntries(e),function(e){var t=e.id;if(!t)throw new Error("entry ID is missing");n[t]=(0,h.cJ)(e,["id"])})}}),n},At.prototype._getEmptyPlaceholder=function(e){const t=e.find(e=>(0,h.Tn)(e.getEmptyPlaceholder));return t&&t.getEmptyPlaceholder()},At.prototype.isOpen=function(){return!!this._current},At.prototype.trigger=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"click";if(e.preventDefault(),!t){let n=(0,C.kp)(e.delegateTarget||e.target,".entry",!0),i=(0,C.CF)(n,"data-id");t=(0,J.A)({id:i},this._getEntry(i))}const i=t.action;if(!1!==this._emit("trigger",{entry:t,event:e}))if((0,h.Tn)(i)){if("click"===n)return i(e,t)}else if(i[n])return i[n](e,t)},At.prototype._getEntry=function(e){var t=this._current.entries[e]||this._current.headerEntries[e];if(!t)throw new Error("entry not found");return t};const Lt={search:["value",function(e,t,n){const{keys:i}=n;if(!(t=t.trim().toLowerCase()))throw new Error("<pattern> must not be empty");const o=t.trim().toLowerCase().split(/\s+/);return e.flatMap(e=>{const t=function(e,t,n){const{matchedWords:i,tokens:o}=n.reduce((n,i)=>{const o=e[i],{tokens:r,matchedWords:a}=(0,h.cy)(o)?o.reduce((e,n)=>{const{tokens:i,matchedWords:o}=Nt(n,t);return{tokens:[...e.tokens,i],matchedWords:(0,J.A)((0,J.A)({},e.matchedWords),o)}},{matchedWords:{},tokens:[]}):Nt(o,t);return{tokens:(0,J.A)((0,J.A)({},n.tokens),{},{[i]:r}),matchedWords:(0,J.A)((0,J.A)({},n.matchedWords),a)}},{matchedWords:{},tokens:{}});if(Object.keys(i).length!==t.length)return null;return o}(e,o,i);return t?{item:e,tokens:t}:[]}).sort(function(e){return(t,n)=>{let i=0,o=1;for(const r of e){const e=jt(t.tokens[r],n.tokens[r]);if(0!==e){i+=e*o,o*=.9;continue}const a=Mt(t.item[r],n.item[r]);0===a||(i+=a*o,o*=.9)}return i}}(i))}]},Ot={__depends__:[Lt],__init__:["popupMenu"],popupMenu:["type",At]};const zt={align:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 2000">\n              <line x1="200" y1="150" x2="200" y2="1850" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n              <rect x="500" y="150" width="1300" height="700" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n              <rect x="500" y="1150" width="700" height="700" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',bottom:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="150" y1="1650" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="150" y="350" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="1050" y="850" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',center:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="900" y1="150" x2="900" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="250" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="500" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',left:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="100" y1="150" x2="100" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="100" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="100" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',right:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="1650" y1="150" x2="1650" y2="1650" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="350" y="150" width="1300" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="850" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',top:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="150" y1="150" x2="1650" y2="150" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="150" y="150" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="1050" y="150" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>',middle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n            <line x1="150" y1="900" x2="1650" y2="900" style="stroke:currentColor;stroke-width:100;stroke-linecap:round;"/>\n            <rect x="150" y="250" width="600" height="1300" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n            <rect x="1050" y="500" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n          </svg>'};function It(e,t,n,i){e.registerProvider(900,this),this._contextPad=e,this._popupMenu=t,this._translate=n,this._canvas=i}It.$inject=["contextPad","popupMenu","translate","canvas"],It.prototype.getMultiElementContextPadEntries=function(e){var t={};return this._isAllowed(e)&&(0,h.kp)(t,this._getEntries(e)),t},It.prototype._isAllowed=function(e){return!this._popupMenu.isEmpty(e,"align-elements")},It.prototype._getEntries=function(){var e=this;return{"align-elements":{group:"align-elements",title:e._translate("Align elements"),html:'<div class="entry">'.concat(zt.align,"</div>"),action:{click:function(t,n){var i=e._getMenuPosition(n);(0,h.kp)(i,{cursor:{x:t.x,y:t.y}}),e._popupMenu.open(n,"align-elements",i)}}}}},It.prototype._getMenuPosition=function(e){var t=this._contextPad.getPad(e).html.getBoundingClientRect();return{x:t.left,y:t.bottom+5}};var $t=["left","center","right","top","middle","bottom"];function Ht(e,t,n,i){this._alignElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",this)}Ht.$inject=["popupMenu","alignElements","translate","rules"],Ht.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&(0,h.kp)(t,this._getEntries(e)),t},Ht.prototype._isAllowed=function(e){return this._rules.allowed("elements.align",{elements:e})},Ht.prototype._getEntries=function(e){var t=this._alignElements,n=this._translate,i=this._popupMenu,o={};return(0,h.jJ)($t,function(r){o["align-elements-"+r]={group:"align",title:n("Align elements "+r),className:"bjs-align-elements-menu-entry",imageHtml:zt[r],action:function(){t.trigger(e,r),i.close()}}}),o};var Jt=n(99152);function Gt(e){Jt.A.call(this,e),this.init()}Gt.$inject=["eventBus"],(0,i.A)(Gt,Jt.A),Gt.prototype.addRule=function(e,t,n){var i=this;"string"===typeof e&&(e=[e]),e.forEach(function(e){i.canExecute(e,t,function(e,t,i){return n(e)},!0)})},Gt.prototype.init=function(){};var Ut=n(34132);function Wt(e){Gt.call(this,e)}Wt.$inject=["eventBus"],(0,i.A)(Wt,Gt),Wt.prototype.init=function(){this.addRule("elements.align",function(e){var t=e.elements,n=(0,h.pb)(t,function(e){return!(e.waypoints||e.host||e.labelTarget)});return!((n=(0,Ut.wT)(n)).length<2)&&n})};const Vt={__depends__:[y,j,Ot],__init__:["alignElementsContextPadProvider","alignElementsMenuProvider","bpmnAlignElements"],alignElementsContextPadProvider:["type",It],alignElementsMenuProvider:["type",Ht],bpmnAlignElements:["type",Wt]};var qt=n(66681);function Xt(e,t,n,i){for(var o;o=Kt(e,n,t);)n=i(t,n,o);return n}function Qt(e){return function(t,n,i){var o={x:n.x,y:n.y};return["x","y"].forEach(function(r){var a=e[r];if(a){var s="x"===r?"width":"height",c=a.margin,p=a.minDistance;o[r]=c<0?Math.min(i[r]+c-t[s]/2,n[r]-p+c):Math.max(i[r]+i[s]+c+t[s]/2,n[r]+p+c)}}),o}}function Kt(e,t,n){var i={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height},o=function(e){var t=Zt(e);e.host&&(t=t.concat(Zt(e.host)));e.attachers&&(t=t.concat(e.attachers.reduce(function(e,t){return e.concat(Zt(t))},[])));return t}(e);return(0,h.I6)(o,function(e){return e!==n&&"intersect"===(0,qt.vc)(e,i,10)})}function Zt(e){return(t=e,t.outgoing.map(function(e){return e.target})).concat(function(e){return e.incoming.map(function(e){return e.source})}(e));var t}function Yt(){return!0}function en(e,t,n){e.on("autoPlace",100,function(e){var t=e.shape;return function(e,t,n){n||(n={});var i=n.defaultDistance||50,o=(0,qt.pp)(e),r=(0,qt.Fy)(e);return{x:r.right+i+t.width/2,y:o.y}}(e.source,t)}),e.on("autoPlace.end",function(e){n.scrollToElement(e.shape)}),this.append=function(n,i,o){e.fire("autoPlace.start",{source:n,shape:i});var r=e.fire("autoPlace",{source:n,shape:i}),a=t.appendShape(n,i,r,n.parent,o);return e.fire("autoPlace.end",{source:n,shape:a}),a}}function tn(e,t){e.on("autoPlace.end",500,function(e){t.select(e.shape)})}en.$inject=["eventBus","modeling","canvas"],tn.$inject=["eventBus","selection"];const nn={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",en],autoPlaceSelectionBehavior:["type",tn]};var on=n(59130),rn=n(31608);function an(e,t){for((0,h.Kg)(t)&&(t=[t]);e=e.parent;)if((0,on.f7)(e,t))return e;return null}function sn(e,t){var n=an(e,"bpmn:Process");if(n)return!0;var i,o=["bpmn:Participant","bpmn:Lane"];if(n=an(e,o))return(0,rn.$b)(n);if((0,on.f7)(e,o))return(0,rn.$b)(e);for(i=(0,on.Cf)(e);i&&!(0,on.is)(i,"bpmn:Process");i=i.$parent);if(!t)return!0;var r=t.find(function(e){var t=(0,on.Cf)(e);return t&&t.get("processRef")===i});return!r||(0,rn.$b)(r)}function cn(e,t,n){var i=sn(e,n);return(0,on.is)(t,"bpmn:TextAnnotation")?function(e,t,n){var i=(0,qt.Fy)(e),o=n?{x:i.right+t.width/2,y:i.top-50-t.height/2}:{x:i.right+50+t.width/2,y:i.bottom+t.height/2};(0,P.fX)(e)&&(o=(0,qt.pp)(e),n?(o.x+=100,o.y-=50):(o.x+=100,o.y+=50));var r={margin:n?-30:30,minDistance:20},a=n?{y:r}:{x:r};return Xt(e,t,o,Qt(a))}(e,t,i):(0,on.f7)(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])?function(e,t,n){var i=(0,qt.Fy)(e),o=n?{x:i.right-10+t.width/2,y:i.bottom+40+t.width/2}:{x:i.left-40-t.width/2,y:i.bottom-10+t.height/2},r={margin:30,minDistance:30},a=n?{x:r}:{y:r};return Xt(e,t,o,Qt(a))}(e,t,i):(0,on.is)(t,"bpmn:FlowNode")?function(e,t,n){var i=(0,qt.Fy)(e),o=(0,qt.pp)(e),r=n?{directionHint:"e",minDistance:80,baseOrientation:"left",boundaryOrientation:"top",start:"top",end:"bottom"}:{directionHint:"s",minDistance:90,baseOrientation:"top",boundaryOrientation:"left",start:"left",end:"right"},a=function(e,t){t||(t={});var n=t.defaultDistance||50,i=t.direction||"e",o=t.filter,r=t.getWeight||function(t){return t.source===e?1:-1},a=t.maxDistance||250,s=t.reference||"start";function c(e,t){return"n"===i?"start"===s?(0,qt.Fy)(e).top-(0,qt.Fy)(t).bottom:"center"===s?(0,qt.Fy)(e).top-(0,qt.pp)(t).y:(0,qt.Fy)(e).top-(0,qt.Fy)(t).top:"w"===i?"start"===s?(0,qt.Fy)(e).left-(0,qt.Fy)(t).right:"center"===s?(0,qt.Fy)(e).left-(0,qt.pp)(t).x:(0,qt.Fy)(e).left-(0,qt.Fy)(t).left:"s"===i?"start"===s?(0,qt.Fy)(t).top-(0,qt.Fy)(e).bottom:"center"===s?(0,qt.pp)(t).y-(0,qt.Fy)(e).bottom:(0,qt.Fy)(t).bottom-(0,qt.Fy)(e).bottom:"start"===s?(0,qt.Fy)(t).left-(0,qt.Fy)(e).right:"center"===s?(0,qt.pp)(t).x-(0,qt.Fy)(e).right:(0,qt.Fy)(t).right-(0,qt.Fy)(e).right}o||(o=Yt);var p=e.incoming.filter(o).map(function(t){var n=r(t),i=n<0?c(t.source,e):c(e,t.source);return{id:t.source.id,distance:i,weight:n}}),l=e.outgoing.filter(o).map(function(t){var n=r(t),i=n>0?c(e,t.target):c(t.target,e);return{id:t.target.id,distance:i,weight:n}}),u=p.concat(l).reduce(function(e,t){return e[t.id+"__weight_"+t.weight]=t,e},{});return(0,h.TS)(u,function(e,t){var n=t.distance,i=t.weight;return n<0||n>a||(e[String(n)]||(e[String(n)]=0),e[String(n)]+=1*i,(!e.distance||e[e.distance]<e[String(n)])&&(e.distance=n)),e},{}).distance||n}(e,{filter:function(e){return(0,on.is)(e,"bpmn:SequenceFlow")},direction:r.directionHint}),s=30,c=r.minDistance,p=r.baseOrientation;(0,on.is)(e,"bpmn:BoundaryEvent")&&-1!==(p=(0,qt.vc)(e,e.host,-25)).indexOf(r.boundaryOrientation)&&(s*=-1);var l=n?{x:i.right+a+t.width/2,y:o.y+pn(p,c,r)}:{x:o.x+pn(p,c,r),y:i.bottom+a+t.height/2},u={margin:s,minDistance:c},d=n?{y:u}:{x:u};return Xt(e,t,l,Qt(d))}(e,t,i):void 0}function pn(e,t,n){return e.includes(n.start)?-1*t:e.includes(n.end)?t:0}function ln(e,t){e.on("autoPlace",function(e){var n=e.shape;return cn(e.source,n,t)})}ln.$inject=["eventBus","elementRegistry"];const un={__depends__:[nn],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",ln]};function hn(e,t,n,i){Jt.A.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var o=this;this.postExecuted(["shape.create"],function(e){var t=e.context,n=t.hints||{},i=t.shape,r=t.parent||t.newParent;!1!==n.autoResize&&o._expand([i],r)}),this.postExecuted(["elements.move"],function(e){var t=e.context,n=(0,h.Bq)((0,h.zu)(t.closure.topLevel)),i=t.hints,r=!i||i.autoResize;if(!1!==r){var a=(0,h.$z)(n,function(e){return e.parent.id});(0,h.jJ)(a,function(e,t){(0,h.cy)(r)&&(e=e.filter(function(e){return(0,h.I6)(r,(0,h.gH)({id:e.id}))})),o._expand(e,t)})}}),this.postExecuted(["shape.toggleCollapse"],function(e){var t=e.context,n=t.hints,i=t.shape;n&&!1===n.autoResize||i.collapsed||o._expand(i.children||[],i)}),this.postExecuted(["shape.resize"],function(e){var t=e.context,n=t.hints,i=t.shape,r=i.parent;n&&!1===n.autoResize||r&&o._expand([i],r)})}function dn(e){e.invoke(hn,this)}function fn(e){Gt.call(this,e);var t=this;this.addRule("element.autoResize",function(e){return t.canResize(e.elements,e.target)})}function mn(e,t){fn.call(this,e),this._modeling=t}hn.$inject=["eventBus","elementRegistry","modeling","rules"],(0,i.A)(hn,Jt.A),hn.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),o=(0,qt.Fy)((0,Ut.U7)(e)),r=(0,qt.Fy)(t),a={};return o.top-r.top<i.top&&(a.top=o.top-n.top),o.left-r.left<i.left&&(a.left=o.left-n.left),r.right-o.right<i.right&&(a.right=o.right+n.right),r.bottom-o.bottom<i.bottom&&(a.bottom=o.bottom+n.bottom),(0,qt.cD)((0,h.kp)({},r,a))},hn.prototype._expand=function(e,t){if("string"===typeof t&&(t=this._elementRegistry.get(t)),this._rules.allowed("element.autoResize",{elements:e,target:t})){var n=this._getOptimalBounds(e,t);if(function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}(n,t)){var i=function(e,t){var n="";e=(0,qt.Fy)(e),t=(0,qt.Fy)(t),e.top>t.top&&(n=n.concat("n"));e.right<t.right&&(n=n.concat("w"));e.bottom<t.bottom&&(n=n.concat("s"));e.left>t.left&&(n=n.concat("e"));return n}((0,h.Up)(t,["x","y","width","height"]),n);this.resize(t,n,{autoResize:i});var o=t.parent;o&&this._expand([t],o)}}},hn.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}},hn.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}},hn.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)},dn.$inject=["injector"],(0,i.A)(dn,hn),dn.prototype.resize=function(e,t,n){(0,on.is)(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)},fn.$inject=["eventBus"],(0,i.A)(fn,Gt),fn.prototype.canResize=function(e,t){return!1},(0,i.A)(mn,fn),mn.$inject=["eventBus","modeling"],mn.prototype.canResize=function(e,t){if((0,on.is)(t.di,"bpmndi:BPMNPlane"))return!1;if(!(0,on.is)(t,"bpmn:Participant")&&!(0,on.is)(t,"bpmn:Lane")&&!(0,on.is)(t,"bpmn:SubProcess"))return!1;var n=!0;return(0,h.jJ)(e,function(e){((0,on.is)(e,"bpmn:Lane")||(0,P.J2)(e))&&(n=!1)}),n};const vn={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",dn],bpmnAutoResizeProvider:["type",mn]};var gn=n(26317);function yn(e,t,n){var i=this,o=n.get("dragging",!1);o&&t.on("drag.start",function(n){t.once("drag.move",1500,function(t){!function(t){if(!t.hover){var n=t.originalEvent,r=i._findTargetGfx(n),a=r&&e.get(r);r&&a&&(t.stopPropagation(),o.hover({element:a,gfx:r}),o.move(n))}}(t)})}),function(){var e,n;t.on("element.hover",function(t){e=t.gfx,n=t.element}),t.on("element.hover",1500,function(i){n&&t.fire("element.out",{element:n,gfx:e})}),t.on("element.out",function(){e=null,n=null})}(),this._findTargetGfx=function(e){var t;if(e instanceof MouseEvent)return t=(0,gn.gK)(e),function(e){return(0,C.kp)(e,"svg, .djs-element",!0)}(document.elementFromPoint(t.x,t.y))}}yn.$inject=["elementRegistry","eventBus","injector"];const bn={__init__:["hoverFix"],hoverFix:["type",yn]};var _n=n(37116),xn=n(82531),wn=n(76070),En=n(70574),Sn=n(30941),Cn=Math.round,kn="djs-drag-active";function Pn(e){e.preventDefault()}function Tn(e,t,n,i){var o,r={threshold:5,trapClick:!0};function a(e){var n=t.viewbox(),i=t._container.getBoundingClientRect();return{x:n.x+(e.x-i.left)/n.scale,y:n.y+(e.y-i.top)/n.scale}}function s(t,n){n=n||o;var i=e.createEvent((0,h.kp)({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==e.fire("drag."+t,i)&&e.fire(n.prefix+"."+t,i)}function c(e,i){var r,c=o.payload,p=o.displacement,l=o.globalStart,u=(0,gn.gK)(e),d=(0,En.p)(u,l),f=o.localStart,m=a(u),g=(0,En.p)(m,f);if(!o.active&&(i||(r=d,Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))>o.threshold))){if((0,h.kp)(c,{x:Cn(f.x+p.x),y:Cn(f.y+p.y),dx:0,dy:0},{originalEvent:e}),!1===s("start"))return v();o.active=!0,o.keepSelection||(c.previousSelection=n.get(),n.select(null)),o.cursor&&(0,xn.hZ)(o.cursor),t.addMarker(t.getRootElement(),kn)}(0,gn.dG)(e),o.active&&((0,h.kp)(c,{x:Cn(m.x+p.x),y:Cn(m.y+p.y),dx:Cn(g.x),dy:Cn(g.y)},{originalEvent:e}),s("move"))}function p(e){var t=!0;o.active&&(e&&(o.payload.originalEvent=e,(0,gn.dG)(e)),t=s("end")),!1===t&&s("rejected"),s("ended",g(!0!==t))}function l(e){(0,Sn.m0)("Escape",e)&&(Pn(e),v())}function u(t){var n;o.active&&(n=(0,wn.a)(e),setTimeout(n,400),Pn(t)),p(t)}function d(e){c(e)}function f(e){var t=o.payload;t.hoverGfx=e.gfx,t.hover=e.element,s("hover")}function m(e){s("out");var t=o.payload;t.hoverGfx=null,t.hover=null}function v(e){var t;if(o){var n=o.active;n&&s("cancel"),t=g(e),n&&s("canceled",t)}}function g(r){var a,h;s("cleanup"),(0,xn.wC)(),h=o.trapClick?u:p,C.f0.unbind(document,"mousemove",c),C.f0.unbind(document,"dragstart",Pn),C.f0.unbind(document,"selectstart",Pn),C.f0.unbind(document,"mousedown",h,!0),C.f0.unbind(document,"mouseup",h,!0),C.f0.unbind(document,"keyup",l),C.f0.unbind(document,"touchstart",d,!0),C.f0.unbind(document,"touchcancel",v,!0),C.f0.unbind(document,"touchmove",c,!0),C.f0.unbind(document,"touchend",p,!0),e.off("element.hover",f),e.off("element.out",m),t.removeMarker(t.getRootElement(),kn);var g=o.payload.previousSelection;return!1!==r&&g&&!n.get().length&&function(e){var t=e.filter(function(e){return i.get(e.id)});t.length&&n.select(t)}(g),a=o,o=null,a}e.on("diagram.destroy",v),this.init=function(t,n,i,g){o&&v(!1),"string"===typeof n&&(g=i,i=n,n=null);var y,b,_,x,w,E=(g=(0,h.kp)({},r,g||{})).data||{};x=g.trapClick?u:p,t?(y=(0,gn.AF)(t)||t,b=(0,gn.gK)(t),(0,gn.dG)(t),"dragstart"===y.type&&Pn(y)):(y=null,b={x:0,y:0}),_=a(b),n||(n=_),w=function(e){return"undefined"!==typeof TouchEvent&&e instanceof TouchEvent}(y),o=(0,h.kp)({prefix:i,data:E,payload:{},globalStart:b,displacement:(0,En.p)(n,_),localStart:_,isTouch:w},g),g.manual||(w?(C.f0.bind(document,"touchstart",d,!0),C.f0.bind(document,"touchcancel",v,!0),C.f0.bind(document,"touchmove",c,!0),C.f0.bind(document,"touchend",p,!0)):(C.f0.bind(document,"mousemove",c),C.f0.bind(document,"dragstart",Pn),C.f0.bind(document,"selectstart",Pn),C.f0.bind(document,"mousedown",x,!0),C.f0.bind(document,"mouseup",x,!0)),C.f0.bind(document,"keyup",l),e.on("element.hover",f),e.on("element.out",m)),s("init"),g.autoActivate&&c(t,!0)},this.move=c,this.hover=f,this.out=m,this.end=p,this.cancel=v,this.context=function(){return o},this.setOptions=function(e){(0,h.kp)(r,e)}}Tn.$inject=["eventBus","canvas","selection","elementRegistry"];const An={__depends__:[bn,_n.A],dragging:["type",Tn]};function jn(e,t,n){this._canvas=n,this._opts=(0,h.kp)({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(e){var t=i._toBorderPoint(e);i.startScroll(t)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}function Bn(e,t,n){return t<e&&e<n}jn.$inject=["config.autoScroll","eventBus","canvas"],jn.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,o=t.getContainer().getBoundingClientRect(),r=[e.x,e.y,o.width-e.x,o.height-e.y];this.stopScroll();for(var a=0,s=0,c=0;c<4;c++)Bn(r[c],n.scrollThresholdOut[c],n.scrollThresholdIn[c])&&(0===c?a=n.scrollStep:1==c?s=n.scrollStep:2==c?a=-n.scrollStep:3==c&&(s=-n.scrollStep));0===a&&0===s||(t.scroll({dx:a,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))},jn.prototype.stopScroll=function(){clearTimeout(this._scrolling)},jn.prototype.setOptions=function(e){this._opts=(0,h.kp)({},this._opts,e)},jn.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=(0,gn.gK)(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};const Dn={__depends__:[An],__init__:["autoScroll"],autoScroll:["type",jn]};function Rn(e){this._commandStack=e.get("commandStack",!1)}Rn.$inject=["injector"],Rn.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),void 0===n||n};const Mn={__init__:["rules"],rules:["type",Rn]};var Nn=n(53717),Fn=n(14922),Ln=n(43659),On=n(55842),zn=Math.round,In=Math.max;function $n(e,t){return function(e,t){var n,i;for(n=0;i=e[n];n++)if((0,Nn.cK)(i,t)<=10)return{point:e[n],bendpoint:!0,index:n};return null}(e,t)||function(e,t){var n,i=(0,On.A)(function(e,t){return[["M",e.x,e.y],["m",0,-t],["a",t,t,0,1,1,0,2*t],["a",t,t,0,1,1,0,-2*t],["z"]]}(t,10),function(e){var t=[];return e.forEach(function(e,n){t.push([0===n?"M":"L",e.x,e.y])}),t}(e)),o=i[0],r=i[i.length-1];return o?o!==r?o.segment2!==r.segment2?{point:e[n=In(o.segment2,r.segment2)-1],bendpoint:!0,index:n}:{point:{x:zn(o.x+r.x)/2,y:zn(o.y+r.y)/2},index:o.segment2}:{point:{x:zn(o.x),y:zn(o.y)},index:o.segment2}:null}(e,t)}function Hn(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function Jn(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function Gn(e,t){var n=t[0],i=t[1],o={x:i.x-n.x,y:i.y-n.y},r=function(e,t,n){var i=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}];return-(i[0].n*t[0]+i[1].n*t[1])/(i[0].lambda*t[0]+i[1].lambda*t[1])}([n.x,n.y],[o.x,o.y],[e.x,e.y]);return{x:n.x+r*o.x,y:n.y+r*o.y}}function Un(e,t){var n=Gn(e,t);return Hn({x:n.x-e.x,y:n.y-e.y})}function Wn(e,t){return Hn({x:e.x-t.x,y:e.y-t.y})}var Vn="djs-bendpoint",qn="djs-segment-dragger";function Xn(e,t,n){var i=function(e,t){var n,i=(0,gn.gK)(t),o=e._container.getBoundingClientRect();n={x:o.left,y:o.top};var r=e.viewbox();return{x:r.x+(i.x-n.x)/r.scale,y:r.y+(i.y-n.y)/r.scale}}(e,n);return $n(t,i)}function Qn(e,t){var n=(0,Fn.vt)("g");(0,Fn.Ly)(n).add(Vn),(0,Fn.BC)(e,n);var i=(0,Fn.vt)("circle");(0,Fn.CF)(i,{cx:0,cy:0,r:4}),(0,Fn.Ly)(i).add("djs-visual"),(0,Fn.BC)(n,i);var o=(0,Fn.vt)("circle");return(0,Fn.CF)(o,{cx:0,cy:0,r:10}),(0,Fn.Ly)(o).add("djs-hit"),(0,Fn.BC)(n,o),t&&(0,Fn.Ly)(n).add(t),n}function Kn(e,t,n,i){var o=(0,Fn.vt)("g");(0,Fn.BC)(e,o);var r=function(e,t,n){var i=t.x-e.x,o=t.y-e.y;return Yn("h"===n?i:o)}(t,n,i),a=(0,Fn.vt)("rect");(0,Fn.CF)(a,{x:-9,y:-3,width:18,height:6}),(0,Fn.Ly)(a).add("djs-visual"),(0,Fn.BC)(o,a);var s=(0,Fn.vt)("rect");return(0,Fn.CF)(s,{x:-r/2,y:-8.5,width:r,height:17}),(0,Fn.Ly)(s).add("djs-hit"),(0,Fn.BC)(o,s),(0,Ln.e$)(o,"v"===i?90:0,0,0),o}function Zn(e,t,n){var i=(0,Fn.vt)("g"),o=(0,Nn.P8)(t,n),r=(0,Nn.ke)(t,n);return(0,Fn.BC)(e,i),Kn(i,t,n,r),(0,Fn.Ly)(i).add(qn),(0,Fn.Ly)(i).add("h"===r?"horizontal":"vertical"),(0,Ln.Tl)(i,o.x,o.y),i}function Yn(e){return Math.abs(Math.round(2*e/3))}function ei(e,t){var n=function(e,t){for(var n,i=t.waypoints,o=1/0,r=0;r<i.length-1;r++){var a=Un(e,[i[r],i[r+1]]);a<o&&(o=a,n=r)}return[i[n],i[n+1]]}(e,t);return Gn(e,n)}var ti=n(17486);function ni(e,t,n,i,o){function r(e,n){var r,a=n.waypoints,s=Xn(t,a,e);if(s)return r=function(e,t){var n,i,o=e.waypoints;return t.index<=0||t.bendpoint?null:(n={start:o[t.index-1],end:o[t.index]},(i=(0,Nn.ke)(n.start,n.end))?Yn("h"===i?n.end.x-n.start.x:n.end.y-n.start.y)/2:null)}(n,s),!function(e,t,n){var i,o,r,a,s,c,p=e.index,l=e.point;return!(p<=0||e.bendpoint)&&(i=t[p-1],o=t[p],r=(0,Nn.P8)(i,o),a=(0,Nn.ke)(i,o),s=Math.abs(l.x-r.x),c=Math.abs(l.y-r.y),a&&s<=n&&c<=n)}(s,a,r)?i.start(e,n,s.index,!s.bendpoint):o.start(e,n,s.index),!0}function a(e,t,i){C.f0.bind(e,t,function(e){n.triggerMouseEvent(t,e,i),e.stopPropagation()})}function s(e,n){var i=t.getLayer("overlays"),o=(0,C.P)('.djs-bendpoints[data-element-id="'+(0,k.F)(e.id)+'"]',i);return!o&&n&&(o=(0,Fn.vt)("g"),(0,Fn.CF)(o,{"data-element-id":e.id}),(0,Fn.Ly)(o).add("djs-bendpoints"),(0,Fn.BC)(i,o),a(o,"mousedown",e),a(o,"click",e),a(o,"dblclick",e)),o}function c(e,t){return(0,C.P)('.djs-segment-dragger[data-segment-idx="'+e+'"]',t)}function p(e,t){t.waypoints.forEach(function(t,n){var i=Qn(e);(0,Fn.BC)(e,i),(0,Ln.Tl)(i,t.x,t.y)}),Qn(e,"floating")}function l(e,t){for(var n,i,o,r=t.waypoints,s=1;s<r.length;s++)n=r[s-1],i=r[s],(0,Nn.ke)(n,i)&&(o=Zn(e,n,i),(0,Fn.CF)(o,{"data-segment-idx":s}),a(o,"mousemove",t))}function u(e){var t=s(e);return t||(p(t=s(e,!0),e),l(t,e)),t}function d(e){var t=s(e);t&&(!function(e){(0,h.jJ)((0,C.YG)("."+qn,e),function(e){(0,Fn.TF)(e)})}(t),function(e){(0,h.jJ)((0,C.YG)("."+Vn,e),function(e){(0,Fn.TF)(e)})}(t),l(t,e),p(t,e))}function f(e,t,n){var i,o,r=c(t.index,e),a=n[t.index-1],s=n[t.index],p=t.point,l=(0,Nn.P8)(a,s),u=(0,Nn.ke)(a,s);r&&(i=function(e){return(0,C.P)(".djs-visual",e)}(r),o={x:p.x-l.x,y:p.y-l.y},"v"===u&&(o={x:o.y,y:o.x}),(0,Ln.Tl)(i,o.x,o.y))}e.on("connection.changed",function(e){d(e.element)}),e.on("connection.remove",function(e){var t=s(e.element);t&&(0,Fn.TF)(t)}),e.on("element.marker.update",function(e){var t,n=e.element;n.waypoints&&(t=u(n),e.add?(0,Fn.Ly)(t).add(e.marker):(0,Fn.Ly)(t).remove(e.marker))}),e.on("element.mousemove",function(e){var n,i,o=e.element,r=o.waypoints;if(r){if(n=s(o,!0),!(i=Xn(t,r,e.originalEvent)))return;!function(e,t){var n=(0,C.P)(".floating",e),i=t.point;n&&(0,Ln.Tl)(n,i.x,i.y)}(n,i),i.bendpoint||f(n,i,r)}}),e.on("element.mousedown",function(e){if((0,ti.ls)(e)){var t=e.originalEvent,n=e.element;if(n.waypoints)return r(t,n)}}),e.on("selection.changed",function(e){var t=e.newSelection[0];t&&t.waypoints&&u(t)}),e.on("element.hover",function(e){var t=e.element;t.waypoints&&(u(t),n.registerEvent(e.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(e){n.unregisterEvent(e.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(e){var t=e.element,n=e.newId;if(t.waypoints){var i=s(t);i&&(0,Fn.CF)(i,{"data-element-id":n})}}),this.addHandles=u,this.updateHandles=d,this.getBendpointsContainer=s,this.getSegmentDragger=c}ni.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var ii=Math.round,oi="reconnectStart",ri="reconnectEnd",ai="updateWaypoints";function si(e,t,n,i,o,r){this._injector=e,this.start=function(e,t,r,a){var s,c=n.getGraphics(t),p=t.source,l=t.target,u=t.waypoints,h=(s=a||0!==r?a||r!==u.length-1?ai:ri:oi)===ai?"connection.updateWaypoints":"connection.reconnect",d=o.allowed(h,{connection:t,source:p,target:l});!1===d&&(d=o.allowed(h,{connection:t,source:l,target:p})),!1!==d&&i.init(e,"bendpoint.move",{data:{connection:t,connectionGfx:c,context:{allowed:d,bendpointIndex:r,connection:t,source:p,target:l,insert:a,type:s}}})},t.on("bendpoint.move.hover",function(e){var t,n=e.context,i=n.connection,r=i.source,a=i.target,s=e.hover,c=n.type;if(n.hover=s,s){var p=c===ai?"connection.updateWaypoints":"connection.reconnect";if(t=n.allowed=o.allowed(p,{connection:i,source:c===oi?s:r,target:c===ri?s:a}))return n.source=c===oi?s:r,void(n.target=c===ri?s:a);!1===t&&(t=n.allowed=o.allowed(p,{connection:i,source:c===ri?s:a,target:c===oi?s:r})),t&&(n.source=c===ri?s:a,n.target=c===oi?s:r)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(e){var t=e.context,n=t.type;t.hover=null,t.source=null,t.target=null,n!==ai&&(t.allowed=!1)}),t.on("bendpoint.move.end",function(e){var t=e.context,n=t.allowed,i=t.bendpointIndex,o=t.connection,a=t.insert,s=o.waypoints.slice(),c=t.source,p=t.target,l=t.type,u=t.hints||{},h={x:ii(e.x),y:ii(e.y)};if(!n)return!1;l===ai?(a?s.splice(i,0,h):s[i]=h,u.bendpointMove={insert:a,bendpointIndex:i},s=this.cropWaypoints(o,s),r.updateWaypoints(o,(0,qt.Wy)(s),u)):(l===oi?(u.docking="source",ci(t)&&(u.docking="target",u.newWaypoints=s.reverse())):l===ri&&(u.docking="target",ci(t)&&(u.docking="source",u.newWaypoints=s.reverse())),r.reconnect(o,c,p,h,u))},this)}function ci(e){var t=e.hover,n=e.source,i=e.target,o=e.type;return o===oi?t&&i&&t===i&&n!==i:o===ri?t&&n&&t===n&&n!==i:void 0}si.$inject=["injector","eventBus","canvas","dragging","rules","modeling"],si.prototype.cropWaypoints=function(e,t){var n=this._injector.get("connectionDocking",!1);if(!n)return t;var i=e.waypoints;return e.waypoints=t,e.waypoints=n.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=i,t};var pi="updateWaypoints",li="connect-ok",ui="connect-not-ok",hi="connect-hover",di="djs-updating",fi="djs-dragging";function mi(e,t,n,i){this._injector=t;var o=t.get("connectionPreview",!1);n.on("bendpoint.move.start",function(e){var t=e.context,n=t.bendpointIndex,o=t.connection,r=t.insert,a=o.waypoints,s=a.slice();t.waypoints=a,r&&s.splice(n,0,{x:e.x,y:e.y}),o.waypoints=s;var c=t.draggerGfx=Qn(i.getLayer("overlays"));(0,Fn.Ly)(c).add("djs-dragging"),i.addMarker(o,fi),i.addMarker(o,di)}),n.on("bendpoint.move.hover",function(e){var t=e.context,n=t.allowed,o=t.hover,r=t.type;if(o){if(i.addMarker(o,hi),r===pi)return;n?(i.removeMarker(o,ui),i.addMarker(o,li)):!1===n&&(i.removeMarker(o,li),i.addMarker(o,ui))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],1100,function(e){var t=e.context,n=t.hover,o=t.target;n&&(i.removeMarker(n,hi),i.removeMarker(n,o?li:ui))}),n.on("bendpoint.move.move",function(t){var n=t.context,i=n.allowed,r=n.bendpointIndex,a=n.draggerGfx,s=n.hover,c=n.type,p=n.connection,l=p.source,u=p.target,h=p.waypoints.slice(),d={x:t.x,y:t.y},f=n.hints||{},m={};o&&(f.connectionStart&&(m.connectionStart=f.connectionStart),f.connectionEnd&&(m.connectionEnd=f.connectionEnd),"reconnectStart"===c?ci(n)?(m.connectionEnd=m.connectionEnd||d,m.source=u,m.target=s||l,h=h.reverse()):(m.connectionStart=m.connectionStart||d,m.source=s||l,m.target=u):"reconnectEnd"===c?ci(n)?(m.connectionStart=m.connectionStart||d,m.source=s||u,m.target=l,h=h.reverse()):(m.connectionEnd=m.connectionEnd||d,m.source=l,m.target=s||u):(m.noCropping=!0,m.noLayout=!0,h[r]=d),c===pi&&(h=e.cropWaypoints(p,h)),m.waypoints=h,o.drawPreview(n,i,m)),(0,Ln.Tl)(a,t.x,t.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],1100,function(e){var t=e.context,n=t.connection,r=t.draggerGfx,a=t.hover,s=t.target,c=t.waypoints;n.waypoints=c,(0,Fn.TF)(r),i.removeMarker(n,di),i.removeMarker(n,fi),a&&(i.removeMarker(a,li),i.removeMarker(a,s?li:ui)),o&&o.cleanUp(t)})}mi.$inject=["bendpointMove","injector","eventBus","canvas"];var vi="connect-hover",gi="djs-updating";function yi(e,t,n){return bi(e,t,e[t]+n)}function bi(e,t,n){return{x:"x"===t?n:e.x,y:"y"===t?n:e.y}}function _i(e){return"x"===e?"y":"x"}function xi(e,t,n){var i,o;return e.original?e.original:(i=(0,qt.pp)(t),bi(e,o=_i(n),i[o]))}function wi(e,t,n,i,o,r){var a=e.get("connectionDocking",!1);function s(e,t){if(!a)return t;var n,i=e.waypoints;return e.waypoints=t,n=a.getCroppedWaypoints(e),e.waypoints=i,n}function c(e){o.update("connection",e.connection,e.connectionGfx)}function p(e,t,n){var i=e.newWaypoints,o=function(e,t,n,i){var o=Math.max(t[i],n[i]),r=Math.min(t[i],n[i]);return bi(t,i,Math.min(Math.max(r+20,e[i]),o-20))}(n,i[e.segmentStartIndex+t],i[e.segmentEndIndex+t],_i(e.axis));(0,Ln.Tl)(e.draggerGfx,o.x,o.y)}this.start=function(e,t,o){var r,a,s,c,p=n.getGraphics(t),l=o-1,u=o,h=t.waypoints,d=h[l],f=h[u],m=Xn(n,h,e);(a=(0,Nn.ke)(d,f))&&(s="v"===a?"x":"y",0===l&&(d=xi(d,t.source,s)),u===h.length-1&&(f=xi(f,t.target,s)),r={connection:t,segmentStartIndex:l,segmentEndIndex:u,segmentStart:d,segmentEnd:f,axis:s,dragPosition:c=m?m.point:{x:(d.x+f.x)/2,y:(d.y+f.y)/2}},i.init(e,c,"connectionSegment.move",{cursor:"x"===s?"resize-ew":"resize-ns",data:{connection:t,connectionGfx:p,context:r}}))},t.on("connectionSegment.move.start",function(e){var t=e.context,i=e.connection,o=n.getLayer("overlays");t.originalWaypoints=i.waypoints.slice(),t.draggerGfx=Zn(o,t.segmentStart,t.segmentEnd),(0,Fn.Ly)(t.draggerGfx).add("djs-dragging"),n.addMarker(i,gi)}),t.on("connectionSegment.move.move",function(e){var t,n,i=e.context,o=i.connection,r=i.segmentStartIndex,a=i.segmentEndIndex,l=i.segmentStart,u=i.segmentEnd,h=i.axis,d=i.originalWaypoints.slice(),f=yi(l,h,e["d"+h]),m=yi(u,h,e["d"+h]),v=d.length,g=0;d[r]=f,d[a]=m,r<2&&(t=(0,qt.vc)(o.source,f),1===r?"intersect"===t&&(d.shift(),d[0]=f,g--):"intersect"!==t&&(d.unshift(l),g++)),a>v-3&&(n=(0,qt.vc)(o.target,m),a===v-2?"intersect"===n&&(d.pop(),d[d.length-1]=m):"intersect"!==n&&d.push(u)),i.newWaypoints=o.waypoints=s(o,d),p(i,g,e),i.newSegmentStartIndex=r+g,c(e)}),t.on("connectionSegment.move.hover",function(e){e.context.hover=e.hover,n.addMarker(e.hover,vi)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(e){var t=e.context.hover;t&&n.removeMarker(t,vi)}),t.on("connectionSegment.move.cleanup",function(e){var t=e.context,i=t.connection;t.draggerGfx&&(0,Fn.TF)(t.draggerGfx),n.removeMarker(i,gi)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(e){var t=e.context;t.connection.waypoints=t.originalWaypoints,c(e)}),t.on("connectionSegment.move.end",function(e){var t=e.context,n=t.connection,i=t.newWaypoints,o=t.newSegmentStartIndex;i=i.map(function(e){return{original:e.original,x:Math.round(e.x),y:Math.round(e.y)}});var a=function(e,t){var n=0,i=e.filter(function(i,o){return!(0,Nn.XP)(e[o-1],e[o+1],i)||(n=o<=t?n-1:n,!1)});return{waypoints:i,segmentOffset:n}}(i,o),c=s(n,a.waypoints),p=a.segmentOffset,l={segmentMove:{segmentStartIndex:t.segmentStartIndex,newSegmentStartIndex:o+p}};r.updateWaypoints(n,c,l)})}wi.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var Ei=Math.abs,Si=Math.round;function Ci(e){return{x:e.x,y:e.y}}function ki(e){return{x:e.x+e.width,y:e.y+e.height}}function Pi(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:Si(e.x+e.width/2),y:Si(e.y+e.height/2)}}function Ti(e,t){var n=e.snapped;return!!n&&("string"===typeof t?n[t]:n.x&&n.y)}function Ai(e,t,n){if("string"!==typeof t)throw new Error("axis must be in [x, y]");if("number"!==typeof n&&!1!==n)throw new Error("value must be Number or false");var i,o=e[t],r=e.snapped=e.snapped||{};return!1===n?r[t]=!1:(r[t]=!0,i=n-o,e[t]+=i,e["d"+t]+=i),o}function ji(e){return e.children||[]}var Bi=Math.abs,Di=Math.round;function Ri(e){function t(e,t){if((0,h.cy)(e)){for(var n=e.length;n--;)if(Bi(e[n]-t)<=10)return e[n]}else{var i=t%(e=+e);if(i<10)return t-i;if(i>e-10)return t-i+e}return t}function n(e,t){return e.waypoints?ei(t,e):e.width?{x:Di(e.width/2+e.x),y:Di(e.height/2+e.y)}:void 0}e.on("connectionSegment.move.move",1500,function(e){var i,o,r=function(e){var t=e.context,i=t.snapPoints,o=t.connection,r=o.waypoints,a=t.segmentStart,s=t.segmentStartIndex,c=t.segmentEnd,p=t.segmentEndIndex,l=t.axis;if(i)return i;var u=[r[s-1],a,c,r[p+1]];return s<2&&u.unshift(n(o.source,e)),p>r.length-3&&u.unshift(n(o.target,e)),t.snapPoints=i={horizontal:[],vertical:[]},(0,h.jJ)(u,function(e){e&&(e=e.original||e,"y"===l&&i.horizontal.push(e.y),"x"===l&&i.vertical.push(e.x))}),i}(e),a=e.x,s=e.y;if(r){var c=a-(i=t(r.vertical,a)),p=s-(o=t(r.horizontal,s));(0,h.kp)(e,{dx:e.dx-c,dy:e.dy-p,x:i,y:o}),(c||-1!==r.vertical.indexOf(a))&&Ai(e,"x",i),(p||-1!==r.horizontal.indexOf(s))&&Ai(e,"y",o)}}),e.on(["connect.hover","connect.move","connect.end"],1500,function(e){var t=e.context.hover,i=t&&n(t,e);(0,P.fX)(t)&&i&&i.x&&i.y&&(Ai(e,"x",i.x),Ai(e,"y",i.y))}),e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(e){var i,o,r=e.context,a=function(e){var t=e.snapPoints,n=e.connection.waypoints,i=e.bendpointIndex;if(t)return t;var o=[n[i-1],n[i+1]];return e.snapPoints=t={horizontal:[],vertical:[]},(0,h.jJ)(o,function(e){e&&(e=e.original||e,t.horizontal.push(e.y),t.vertical.push(e.x))}),t}(r),s=r.hover,c=s&&n(s,e),p=e.x,l=e.y;if(a){var u=p-(i=t(c?a.vertical.concat([c.x]):a.vertical,p)),d=l-(o=t(c?a.horizontal.concat([c.y]):a.horizontal,l));(0,h.kp)(e,{dx:e.dx-u,dy:e.dy-d,x:e.x-u,y:e.y-d}),(u||-1!==a.vertical.indexOf(p))&&Ai(e,"x",i),(d||-1!==a.horizontal.indexOf(l))&&Ai(e,"y",o)}})}Ri.$inject=["eventBus"];const Mi={__depends__:[An,Mn],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",ni],bendpointMove:["type",si],bendpointMovePreview:["type",mi],connectionSegmentMove:["type",wi],bendpointSnapping:["type",Ri]};function Ni(e,t,n,i){function o(e,t){return i.allowed("connection.create",{source:e,target:t})}e.on("connect.hover",function(e){var t,n=e.context,i=n.start,r=e.hover;if(n.hover=r,t=n.canExecute=o(i,r),!(0,h.gD)(t)){if(!1!==t)return n.source=i,void(n.target=r);t=n.canExecute=o(r,i),(0,h.gD)(t)||!1!==t&&(n.source=r,n.target=i)}}),e.on(["connect.out","connect.cleanup"],function(e){var t=e.context;t.hover=null,t.source=null,t.target=null,t.canExecute=!1}),e.on("connect.end",function(e){var t=e.context,i=t.canExecute,o=t.connectionStart,r={x:e.x,y:e.y},a=t.source,s=t.target;if(!i)return!1;var c=null,p={connectionStart:Fi(t)?r:o,connectionEnd:Fi(t)?o:r};(0,h.Gv)(i)&&(c=i),t.connection=n.connect(a,s,c,p)}),this.start=function(e,n,i,o){(0,h.Gv)(i)||(o=i,i=(0,qt.pp)(n)),t.init(e,"connect",{autoActivate:o,data:{shape:n,context:{start:n,connectionStart:i}}})}}function Fi(e){var t=e.hover,n=e.source,i=e.target;return t&&n&&t===n&&n!==i}Ni.$inject=["eventBus","dragging","modeling","rules"];var Li="connect-ok",Oi="connect-not-ok";function zi(e,t,n){var i=e.get("connectionPreview",!1);i&&t.on("connect.move",function(e){var t=e.context,n=t.canExecute,o=t.hover,r=t.source,a=t.start,s=t.startPosition,c=t.target,p=t.connectionStart||s,l=t.connectionEnd||{x:e.x,y:e.y},u=p,h=l;Fi(t)&&(u=l,h=p),i.drawPreview(t,n,{source:r||a,target:c||o,connectionStart:u,connectionEnd:h})}),t.on("connect.hover",900,function(e){var t=e.context,i=e.hover,o=t.canExecute;null!==o&&n.addMarker(i,o?Li:Oi)}),t.on(["connect.out","connect.cleanup"],1100,function(e){var t=e.hover;t&&(n.removeMarker(t,Li),n.removeMarker(t,Oi))}),i&&t.on("connect.cleanup",function(e){i.cleanUp(e.context)})}zi.$inject=["injector","eventBus","canvas"];const Ii={__depends__:[_n.A,Mn,An],__init__:["connectPreview"],connect:["type",Ni],connectPreview:["type",zi]};var $i=n(51785);function Hi(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}Hi.$inject=["injector","canvas","graphicsFactory","elementFactory"],Hi.prototype.drawPreview=function(e,t,n){n=n||{};var i,o=e.connectionPreviewGfx,r=e.getConnection,a=n.source,s=n.target,c=n.waypoints,p=n.connectionStart,l=n.connectionEnd,u=n.noLayout,h=n.noCropping,d=n.noNoop,f=this;o||(o=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),(0,Fn.IU)(o),r||(r=e.getConnection=function(e){var t={};return function(n){var i=JSON.stringify(n),o=t[i];return o||(o=t[i]=e.apply(null,arguments)),o}}(function(e,t,n){return f.getConnection(e,t,n)})),t&&(i=r(t,a,s)),i?(i.waypoints=c||[],this._layouter&&!u&&(i.waypoints=this._layouter.layoutConnection(i,{source:a,target:s,connectionStart:p,connectionEnd:l,waypoints:n.waypoints||i.waypoints})),i.waypoints&&i.waypoints.length||(i.waypoints=[a?(0,qt.pp)(a):p,s?(0,qt.pp)(s):l]),this._connectionDocking&&(a||s)&&!h&&(i.waypoints=this._connectionDocking.getCroppedWaypoints(i,a,s)),this._graphicsFactory.drawConnection(o,i,{stroke:"var(--element-dragger-color)"})):!d&&this.drawNoopPreview(o,n)},Hi.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,o=t.connectionStart||(0,qt.pp)(n),r=t.connectionEnd||(0,qt.pp)(i),a=this.cropWaypoints(o,r,n,i),s=this.createNoopConnection(a[0],a[1]);(0,Fn.BC)(e,s)},Hi.prototype.cropWaypoints=function(e,t,n,i){var o=this._graphicsFactory,r=n&&o.getShapePath(n),a=i&&o.getShapePath(i),s=o.getConnectionPath({waypoints:[e,t]});return[e=n&&(0,qt.ki)(r,s,!0)||e,t=i&&(0,qt.ki)(a,s,!1)||t]},Hi.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&(0,Fn.TF)(e.connectionPreviewGfx)},Hi.prototype.getConnection=function(e){var t=function(e){return(0,h.Gv)(e)?e:{}}(e);return this._elementFactory.createConnection(t)},Hi.prototype.createConnectionPreviewGfx=function(){var e=(0,Fn.vt)("g");return(0,Fn.CF)(e,{pointerEvents:"none"}),(0,Fn.Ly)(e).add("djs-dragger"),(0,Fn.BC)(this._canvas.getActiveLayer(),e),e},Hi.prototype.createNoopConnection=function(e,t){return(0,$i.RJ)([e,t],{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"})};const Ji={__init__:["connectionPreview"],connectionPreview:["type",Hi]};var Gi=n(21708);const Ui=new x.A("ps");var Wi=["marker-start","marker-mid","marker-end"],Vi=["circle","ellipse","line","path","polygon","polyline","path","rect"];function qi(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i}qi.$inject=["elementRegistry","eventBus","canvas","styles"],qi.prototype.cleanUp=function(){console.warn("PreviewSupport#cleanUp is deprecated and will be removed in future versions. You do not need to manually clean up previews anymore. cf. https://github.com/bpmn-io/diagram-js/pull/906")},qi.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)},qi.prototype.addDragger=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"djs-dragger";n=n||this.getGfx(e);var o=(0,Fn.o8)(n),r=n.getBoundingClientRect();return this._cloneMarkers((0,Gi.P)(o),i),(0,Fn.CF)(o,this._styles.cls(i,[],{x:r.top,y:r.left})),(0,Fn.BC)(t,o),(0,Fn.CF)(o,"data-preview-support-element-id",e.id),o},qi.prototype.addFrame=function(e,t){var n=(0,Fn.vt)("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return(0,Fn.BC)(t,n),(0,Fn.CF)(n,"data-preview-support-element-id",e.id),n},qi.prototype._cloneMarkers=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"djs-dragger",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;var i,o=this;(e.childNodes&&e.childNodes.forEach(e=>{o._cloneMarkers(e,t,n)}),i=e,-1!==Vi.indexOf(i.nodeName))&&Wi.forEach(function(i){if((0,Fn.CF)(e,i)){var r=function(e,t,n){var i=(o=(0,Fn.CF)(e,t),o.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]);var o;return(0,C.P)("marker#"+i,n||document)}(e,i,o._canvas.getContainer());r&&o._cloneMarker(n,e,r,i,t)}})},qi.prototype._cloneMarker=function(e,t,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"djs-dragger";var r=[n.id,o,Ui.next()].join("-"),a=(0,C.P)("marker#"+n.id,e);e=e||this._canvas._svg;var s=a||(0,Fn.o8)(n);s.id=r,(0,Fn.Ly)(s).add(o);var c=(0,C.P)(":scope > defs",e);c||(c=(0,Fn.vt)("defs"),(0,Fn.BC)(e,c)),(0,Fn.BC)(c,s);var p="url(#"+s.id+")";(0,Fn.CF)(t,i,p)};const Xi={__init__:["previewSupport"],previewSupport:["type",qi]},Qi="complex-preview";class Ki{constructor(e,t,n){this._canvas=e,this._graphicsFactory=t,this._previewSupport=n,this._markers=[]}create(e){this.cleanUp();const{created:t=[],moved:n=[],removed:i=[],resized:o=[]}=e,r=this._canvas.getLayer(Qi);t.filter(e=>!function(e){return e.hidden}(e)).forEach(e=>{let t;(0,P.fX)(e)?(t=this._graphicsFactory._createContainer("connection",(0,Fn.vt)("g")),this._graphicsFactory.drawConnection((0,Gi.P)(t),e)):(t=this._graphicsFactory._createContainer("shape",(0,Fn.vt)("g")),this._graphicsFactory.drawShape((0,Gi.P)(t),e),(0,Ln.Tl)(t,e.x,e.y)),this._previewSupport.addDragger(e,r,t)}),n.forEach(e=>{let{element:t,delta:n}=e;this._previewSupport.addDragger(t,r,void 0,"djs-dragging"),this._canvas.addMarker(t,"djs-element-hidden"),this._markers.push([t,"djs-element-hidden"]);const i=this._previewSupport.addDragger(t,r);(0,P.fX)(t)?(0,Ln.Tl)(i,n.x,n.y):(0,Ln.Tl)(i,t.x+n.x,t.y+n.y)}),i.forEach(e=>{this._previewSupport.addDragger(e,r,void 0,"djs-dragging"),this._canvas.addMarker(e,"djs-element-hidden"),this._markers.push([e,"djs-element-hidden"])}),o.forEach(e=>{let{shape:t,bounds:n}=e;this._canvas.addMarker(t,"djs-hidden"),this._markers.push([t,"djs-hidden"]),this._previewSupport.addDragger(t,r,void 0,"djs-dragging");const i=this._graphicsFactory._createContainer("shape",(0,Fn.vt)("g"));this._graphicsFactory.drawShape((0,Gi.P)(i),t,{width:n.width,height:n.height}),(0,Ln.Tl)(i,n.x,n.y),this._previewSupport.addDragger(t,r,i)})}cleanUp(){(0,Fn.IU)(this._canvas.getLayer(Qi)),this._markers.forEach(e=>{let[t,n]=e;return this._canvas.removeMarker(t,n)}),this._markers=[]}show(){this._canvas.showLayer(Qi)}hide(){this._canvas.hideLayer(Qi)}}Ki.$inject=["canvas","graphicsFactory","previewSupport"];const Zi={__depends__:[Xi],__init__:["complexPreview"],complexPreview:["type",Ki]};var Yi=n(46941),eo=["top","bottom","left","right"],to=10;function no(e,t){function n(e){if((0,Yi.ur)(e)&&!(0,P.fX)(e)){var n=function(e){var t=(0,qt.pp)(e.label),n=(0,qt.pp)(e),i=io(n,t);if(o=i,-1===eo.indexOf(o))return;var o;var r=function(e){var t=(0,qt.pp)(e),n=[].concat(e.incoming.map(function(e){return e.waypoints[e.waypoints.length-2]}),e.outgoing.map(function(e){return e.waypoints[1]})).map(function(e){return io(t,e)});return n}(e);if(e.host){var a=function(e){var t,n=e.host,i=(0,qt.pp)(e),o=(0,qt.vc)(i,n);t=o.indexOf("-")>=0?o.split("-"):[o];var r=eo.filter(function(e){return-1===t.indexOf(e)});return r}(e);r=r.concat(a)}var s=eo.filter(function(e){return-1===r.indexOf(e)});if(-1!==s.indexOf(i))return;return s[0]}(e);n&&function(e,n){var i=(0,qt.pp)(e),o=e.label,r=(0,qt.pp)(o);if(!o.parent)return;var a,s=(0,qt.Fy)(e);switch(n){case"top":a={x:i.x,y:s.top-to-o.height/2};break;case"left":a={x:s.left-to-o.width/2,y:i.y};break;case"bottom":a={x:i.x,y:s.bottom+to+o.height/2};break;case"right":a={x:s.right+to+o.width/2,y:i.y}}var c=(0,En.p)(a,r);t.moveShape(o,c)}(e,n)}}Jt.A.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(e){var t=e.context,i=t.connection,o=i.source,r=i.target;!1!==(t.hints||{}).createElementsBehavior&&(n(o),n(r))}),this.postExecuted(["label.create"],function(e){var t=e.context,i=t.shape;!1!==(t.hints||{}).createElementsBehavior&&n(i.labelTarget)}),this.postExecuted(["elements.create"],function(e){var t=e.context,i=t.elements;!1!==(t.hints||{}).createElementsBehavior&&i.forEach(function(e){n(e)})})}function io(e,t){return(0,qt.vc)(t,e,5)}function oo(e){Jt.A.call(this,e),this.preExecute("shape.append",function(e){var t=e.source,n=e.shape;e.position||((0,on.is)(n,"bpmn:TextAnnotation")?e.position={x:t.x+t.width/2+75,y:t.y-50-n.height/2}:e.position={x:t.x+t.width+80+n.width/2,y:t.y+t.height/2})},!0)}function ro(e,t){e.invoke(Jt.A,this),this.postExecute("shape.move",function(e){var n=e.newParent,i=e.shape,o=(0,h.pb)(i.incoming.concat(i.outgoing),function(e){return(0,on.is)(e,"bpmn:Association")});(0,h.jJ)(o,function(e){t.moveConnection(e,{x:0,y:0},n)})},!0)}(0,i.A)(no,Jt.A),no.$inject=["eventBus","modeling"],(0,i.A)(oo,Jt.A),oo.$inject=["eventBus"],(0,i.A)(ro,Jt.A),ro.$inject=["injector","modeling"];function ao(e,t){t.invoke(Jt.A,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,function(e){var t=e.elements;1===(t=t.filter(function(e){return so(e,e.host)})).length&&t.map(function(e){return t.indexOf(e)}).forEach(function(i){var o=t[i];e.elements[i]=n._replaceShape(t[i],o)})},!0),this.preExecute("elements.move",500,function(e){var t=e.shapes,i=e.newHost;if(1===t.length){var o=t[0];so(o,i)&&(e.shapes=[n._replaceShape(o,i)])}},!0)}function so(e,t){return!(0,P.J2)(e)&&(0,on.f7)(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}function co(e,t){function n(e){return(0,h.pb)(e.attachers,function(e){return(0,on.is)(e,"bpmn:BoundaryEvent")})}Jt.A.call(this,e),this.postExecute("connection.create",function(e){var i=e.context.source,o=e.context.target,r=n(o);(0,on.is)(i,"bpmn:EventBasedGateway")&&(0,on.is)(o,"bpmn:ReceiveTask")&&r.length>0&&t.removeElements(r)}),this.postExecute("connection.reconnect",function(e){var i=e.context.oldSource,o=e.context.newSource;(0,on.is)(i,"bpmn:Gateway")&&(0,on.is)(o,"bpmn:EventBasedGateway")&&(0,h.jJ)(o.outgoing,function(e){var i=e.target,o=n(i);(0,on.is)(i,"bpmn:ReceiveTask")&&o.length>0&&t.removeElements(o)})})}function po(e,t,n){function i(e){t.updateProperties(e,{isForCompensation:!0})}function o(e){t.updateProperties(e,{isForCompensation:void 0})}Jt.A.call(this,e),this.preExecute("shape.replace",function(e){const{newData:n,oldShape:i}=e;if(uo(e.oldShape)&&"bpmn:CompensateEventDefinition"!==n.eventDefinitionType||"bpmn:BoundaryEvent"!==n.type){const t=i.outgoing.find(e=>{let{target:t}=e;return lo(t)});t&&t.target&&(e._connectionTarget=t.target)}else if(!uo(e.oldShape)&&"bpmn:CompensateEventDefinition"===n.eventDefinitionType&&"bpmn:BoundaryEvent"===n.type){const n=i.outgoing.find(e=>{let{target:t}=e;return ho(t)});n&&n.target&&(e._connectionTarget=n.target),function(e){const n=e.outgoing.filter(e=>(0,on.is)(e,"bpmn:SequenceFlow"));t.removeElements(n)}(i)}},!0),this.postExecuted("shape.replace",function(e){const{_connectionTarget:n,newShape:i}=e;n&&t.connect(i,n)},!0),this.preExecute("connection.create",function(e){const n=e.connection,o=e.source,r=e.target;uo(o)&&ho(r)&&(i(r),function(e,n){const i=e.outgoing.filter(e=>(0,on.is)(e,"bpmn:Association"));i.filter(e=>lo(e.target)&&!n.includes(e)).forEach(e=>t.removeConnection(e))}(o,[n]))},!0),this.postExecuted("connection.delete",function(e){const t=e.source,n=e.target;uo(t)&&lo(n)&&o(n)},!0),this.postExecuted("connection.reconnect",function(e){const t=e.newTarget,n=e.oldSource,r=e.oldTarget;if(r!==t){const e=n;lo(r)&&o(r),uo(e)&&ho(t)&&i(t)}},!0),this.postExecuted("element.updateProperties",function(e){const{element:i}=e;lo(i)?(function(e){for(const i of e.incoming)n.canConnect(i.source,e)||t.removeConnection(i);for(const i of e.outgoing)n.canConnect(e,i.target)||t.removeConnection(i)}(i),function(e){const n=e.attachers.slice();if(!n.length)return;t.removeElements(n)}(i)):ho(i)&&function(e){const n=e.incoming.filter(e=>uo(e.source));t.removeElements(n)}(i)},!0)}function lo(e){const t=(0,on.Cf)(e);return t&&t.get("isForCompensation")}function uo(e){return e&&(0,on.is)(e,"bpmn:BoundaryEvent")&&(0,rn.Ip)(e,"bpmn:CompensateEventDefinition")}function ho(e){return e&&(0,on.is)(e,"bpmn:Activity")&&!(0,rn.Q1)(e)}function fo(e){e.invoke(Jt.A,this),this.preExecute("shape.create",1500,function(e){var t=e.context,n=t.parent,i=t.shape;(0,on.is)(n,"bpmn:Lane")&&!(0,on.is)(i,"bpmn:Lane")&&(t.parent=an(n,"bpmn:Participant"))})}function mo(e,t){Jt.A.call(this,e),this.preExecute("shape.create",function(e){var n=e.context.shape;if((0,on.is)(n,"bpmn:DataObjectReference")&&"label"!==n.type){var i=t.create("bpmn:DataObject");n.businessObject.dataObjectRef=i}})}ao.$inject=["bpmnReplace","injector"],(0,i.A)(ao,Jt.A),ao.prototype._replaceShape=function(e,t){var n=function(e){var t=(0,on.Cf)(e).eventDefinitions;return t&&t[0]}(e),i={type:"bpmn:BoundaryEvent",host:t};return n&&(i.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,i,{layoutConnection:!1})},co.$inject=["eventBus","modeling"],(0,i.A)(co,Jt.A),(0,i.A)(po,Jt.A),po.$inject=["eventBus","modeling","bpmnRules"],fo.$inject=["injector"],(0,i.A)(fo,Jt.A),mo.$inject=["eventBus","bpmnFactory"],(0,i.A)(mo,Jt.A);var vo=20,go=20,yo=2e3;function bo(e,t,n){function i(){var t=e.getRootElement();return(0,on.is)(t,"bpmn:Collaboration")?t:n.makeCollaboration()}Jt.A.call(this,t),t.on(["create.start","shape.move.start"],yo,function(t){var n=t.context,i=n.shape,o=e.getRootElement();if((0,on.is)(i,"bpmn:Participant")&&(0,on.is)(o,"bpmn:Process")&&o.children.length){var r=o.children.filter(function(e){return!(0,on.is)(e,"bpmn:Group")&&!(0,P.J2)(e)&&!(0,P.fX)(e)});if(r.length){var a=(0,Ut.U7)(r),s=function(e,t){t={width:t.width+40+30,height:t.height+40};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}(i,a);(0,h.kp)(i,s),n.createConstraints=function(e,t){return t=(0,qt.Fy)(t),{bottom:t.top+e.height/2-go,left:t.right-e.width/2+vo,top:t.bottom-e.height/2+go,right:t.left+e.width/2-vo-30}}(i,a)}}}),t.on("create.start",yo,function(n){var i=n.context.shape,o=e.getRootElement(),r=e.getGraphics(o);function a(e){e.element=o,e.gfx=r}(0,on.is)(i,"bpmn:Participant")&&(0,on.is)(o,"bpmn:Process")&&(t.on("element.hover",yo,a),t.once("create.cleanup",function(){t.off("element.hover",a)}))}),this.preExecute("elements.create",yo,function(e){var t,n=e.elements,o=e.parent,r=function(e){return(0,h.I6)(e,function(e){return(0,on.is)(e,"bpmn:Participant")})}(n);r&&(0,on.is)(o,"bpmn:Process")&&(e.parent=i(),(t=e.hints=e.hints||{}).participant=r,t.process=o,t.processRef=(0,on.Cf)(r).get("processRef"))},!0),this.preExecute("shape.create",function(e){var t=e.parent,n=e.shape;(0,on.is)(n,"bpmn:Participant")&&(0,on.is)(t,"bpmn:Process")&&(e.parent=i(),e.process=t,e.processRef=(0,on.Cf)(n).get("processRef"))},!0),this.execute("shape.create",function(e){var t=e.hints||{},n=e.process||t.process,i=e.shape,o=t.participant;!n||o&&i!==o||(0,on.Cf)(i).set("processRef",(0,on.Cf)(n))},!0),this.revert("shape.create",function(e){var t=e.hints||{},n=e.process||t.process,i=e.processRef||t.processRef,o=e.shape,r=t.participant;!n||r&&o!==r||(0,on.Cf)(o).set("processRef",i)},!0),this.postExecute("shape.create",function(e){var t=e.hints||{},i=e.process||e.hints.process,o=e.shape,r=t.participant;if(i){var a=i.children.slice();r?o===r&&n.moveElements(a,{x:0,y:0},r):n.moveElements(a,{x:0,y:0},o)}},!0)}bo.$inject=["canvas","eventBus","modeling"],(0,i.A)(bo,Jt.A);var _o=n(74524),xo="__targetRef_placeholder";function wo(e,t){function n(e,n){var i=e.get("properties"),o=(0,h.I6)(i,function(e){return e.name===xo});return!o&&n&&(o=t.create("bpmn:Property",{name:xo}),(0,_o.WQ)(i,o)),o}function i(e,t){var i=n(e);i&&(function(e,t,n){var i=e.get("dataInputAssociations");return(0,h.I6)(i,function(e){return e!==n&&e.targetRef===t})}(e,i,t)||(0,_o.TF)(e.get("properties"),i))}function o(e){var t,o=e.context,r=o.connection,a=r.businessObject,s=r.target,c=s&&s.businessObject,p=o.newTarget,l=p&&p.businessObject,u=o.oldTarget||o.target,h=u&&u.businessObject,d=r.businessObject;h&&h!==c&&i(h,a),l&&l!==c&&i(l,a),c?(t=n(c,!0),d.targetRef=t):d.targetRef=null}Jt.A.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],Eo(o)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],Eo(o))}function Eo(e){return function(t){var n=t.context.connection;if((0,on.is)(n,"bpmn:DataInputAssociation"))return e(t)}}function So(e){this._bpmnUpdater=e}function Co(e,t,n,i){function o(e){return e.children.filter(function(e){return(0,on.is)(e,"bpmn:DataStoreReference")&&!e.labelTarget})}function r(e,i){var o=e.businessObject||e;if(i=i||n.filter(function(e){return(0,on.is)(e,"bpmn:Participant")&&(0,on.Cf)(e).processRef})[0]){var r=i.businessObject||i;t.execute("dataStore.updateContainment",{dataStoreBo:o,dataStoreDi:(0,on.S2)(e),newSemanticParent:r.processRef||r,newDiParent:(0,on.S2)(i)})}}Jt.A.call(this,i),t.registerHandler("dataStore.updateContainment",So),this.preExecute("shape.create",function(e){var t=e.context,n=t.shape;(0,on.is)(n,"bpmn:DataStoreReference")&&"label"!==n.type&&(t.hints||(t.hints={}),t.hints.autoResize=!1)}),this.preExecute("elements.move",function(e){var t=e.context,n=t.shapes;n.filter(function(e){return(0,on.is)(e,"bpmn:DataStoreReference")}).length&&(t.hints||(t.hints={}),t.hints.autoResize=n.filter(function(e){return!(0,on.is)(e,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(e){var t=e.context.shape,n=t.parent;(0,on.is)(t,"bpmn:DataStoreReference")&&"label"!==t.type&&(0,on.is)(n,"bpmn:Collaboration")&&r(t)}),this.postExecute("shape.move",function(e){var t=e.context,n=t.shape,i=t.oldParent,o=n.parent;(0,on.is)(i,"bpmn:Collaboration")||(0,on.is)(n,"bpmn:DataStoreReference")&&"label"!==n.type&&(0,on.is)(o,"bpmn:Collaboration")&&r(n,(0,on.is)(i,"bpmn:Participant")?i:function(e,t){for(;e.parent;){if((0,on.is)(e.parent,t))return e.parent;e=e.parent}}(i,"bpmn:Participant"))}),this.postExecute("shape.delete",function(t){var n=t.context.shape,i=e.getRootElement();(0,on.f7)(n,["bpmn:Participant","bpmn:SubProcess"])&&(0,on.is)(i,"bpmn:Collaboration")&&o(i).filter(function(e){return function(e,t){var n=e.businessObject||e,i=t.businessObject||t;for(;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}(e,n)}).forEach(function(e){r(e)})}),this.postExecute("canvas.updateRoot",function(e){var t=e.context,n=t.oldRoot,i=t.newRoot;o(n).forEach(function(e){(0,on.is)(i,"bpmn:Process")&&r(e,i)})})}wo.$inject=["eventBus","bpmnFactory"],(0,i.A)(wo,Jt.A),So.$inject=["bpmnUpdater"],So.prototype.execute=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.newSemanticParent,o=e.newDiParent;return e.oldSemanticParent=t.$parent,e.oldDiParent=n.$parent,this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,o),[]},So.prototype.revert=function(e){var t=e.dataStoreBo,n=e.dataStoreDi,i=e.oldSemanticParent,o=e.oldDiParent;return this._bpmnUpdater.updateSemanticParent(t,i),this._bpmnUpdater.updateDiParent(n,o),[]},Co.$inject=["canvas","commandStack","elementRegistry","eventBus"],(0,i.A)(Co,Jt.A);var ko=Math.max,Po=Math.min;function To(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function Ao(e,t){return{x:e.x+(t.left||0),y:e.y+(t.top||0),width:e.width-(t.left||0)+(t.right||0),height:e.height-(t.top||0)+(t.bottom||0)}}function jo(e,t,n){var i=t[e],o=n.min&&n.min[e],r=n.max&&n.max[e];return(0,h.Et)(o)&&(i=(/top|left/.test(e)?Po:ko)(i,o)),(0,h.Et)(r)&&(i=(/top|left/.test(e)?ko:Po)(i,r)),i}function Bo(e,t){return"undefined"!==typeof e?e:20}function Do(e){return!e.waypoints&&"label"!==e.type}function Ro(e,t){var n;if((n=void 0===e.length?(0,h.pb)(e.children,Do):e).length)return function(e,t){var n,i,o,r;return"object"===typeof t?(n=Bo(t.left),i=Bo(t.right),o=Bo(t.top),r=Bo(t.bottom)):n=i=o=r=Bo(t),{x:e.x-n,y:e.y-o,width:e.width+n+i,height:e.height+o+r}}((0,Ut.U7)(n),t)}var Mo=Math.abs;var No=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],Fo=30;function Lo(e,t){return t=t||[],e.children.filter(function(e){(0,on.is)(e,"bpmn:Lane")&&(Lo(e,t),t.push(e))}),t}function Oo(e){return e.children.filter(function(e){return(0,on.is)(e,"bpmn:Lane")})}function zo(e){return an(e,No)||e}function Io(e,t){var n=zo(e),i=Lo(n,(0,on.is)(n,"bpmn:Process")?[]:[n]),o=(0,qt.Fy)(e),r=(0,qt.Fy)(t),a=function(e,t){return To((0,qt.Fy)(t),(0,qt.Fy)(e))}(e,t),s=[],c=(0,rn.$b)(e);return i.forEach(function(t){if(t!==e){var n=c?0:a.top,i=c?a.right:0,p=c?0:a.bottom,l=c?a.left:0,u=(0,qt.Fy)(t);a.top&&(Mo(u.bottom-o.top)<10&&(p=r.top-u.bottom),Mo(u.top-o.top)<5&&(n=r.top-u.top)),a.left&&(Mo(u.right-o.left)<10&&(i=r.left-u.right),Mo(u.left-o.left)<5&&(l=r.left-u.left)),a.bottom&&(Mo(u.top-o.bottom)<10&&(n=r.bottom-u.top),Mo(u.bottom-o.bottom)<5&&(p=r.bottom-u.bottom)),a.right&&(Mo(u.left-o.right)<10&&(l=r.right-u.left),Mo(u.right-o.right)<5&&(i=r.right-u.right)),(n||i||p||l)&&s.push({shape:t,newBounds:Ao(t,{top:n,right:i,bottom:p,left:l})})}}),s}function $o(e,t){Jt.A.call(this,e),this.postExecuted("shape.delete",500,function(e){var n=e.context,i=n.hints,o=n.shape,r=n.oldParent;(0,on.is)(o,"bpmn:Lane")&&(i&&i.nested||function(e,n){var i,o,r,a,s,c=(0,rn.$b)(e),p=Oo(n),l=[],u=[],h=[],d=[];(0,Ut.qO)(p,function(t){return c?t.y>e.y?u.push(t):l.push(t):t.x>e.x?d.push(t):h.push(t),t.children}),p.length&&(i=c?u.length&&l.length?e.height/2:e.height:d.length&&h.length?e.width/2:e.width,l.length&&(o=t.calculateAdjustments(l,"y",i,e.y-10),t.makeSpace(o.movingShapes,o.resizingShapes,{x:0,y:i},"s")),u.length&&(r=t.calculateAdjustments(u,"y",-i,e.y+e.height+10),t.makeSpace(r.movingShapes,r.resizingShapes,{x:0,y:-i},"n")),h.length&&(a=t.calculateAdjustments(h,"x",i,e.x-10),t.makeSpace(a.movingShapes,a.resizingShapes,{x:i,y:0},"e")),d.length&&(s=t.calculateAdjustments(d,"x",-i,e.x+e.width+10),t.makeSpace(s.movingShapes,s.resizingShapes,{x:-i,y:0},"w")))}(o,r))})}$o.$inject=["eventBus","spaceTool"],(0,i.A)($o,Jt.A);function Ho(e,t){t.invoke(Jt.A,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,function(e){var t=e.elements;t.filter(function(e){return Jo(e,e.host)}).map(function(e){return t.indexOf(e)}).forEach(function(i){e.elements[i]=n._replaceShape(t[i])})},!0),this.preExecute("elements.move",500,function(e){var t=e.shapes,i=e.newHost;t.forEach(function(e,o){var r,a=e.host;Jo(e,(r=a,-1!==t.indexOf(r)?a:i))&&(t[o]=n._replaceShape(e))})},!0)}function Jo(e,t){return!(0,P.J2)(e)&&(0,on.is)(e,"bpmn:BoundaryEvent")&&!t}function Go(e,t,n){function i(e,i,o){var r,a,s,c,p,l,u,d,f=i.waypoints,m=e.outgoing.slice(),v=e.incoming.slice(),g=$n(f,d=(0,h.Et)(o.width)?(0,qt.pp)(o):o);if(g){if(r=f.slice(0,g.index),a=f.slice(g.index+(g.bendpoint?1:0)),!r.length||!a.length)return;s=g.bendpoint?f[g.index]:d,1!==r.length&&Uo(e,r[r.length-1])||r.push(Wo(s)),1!==a.length&&Uo(e,a[0])||a.unshift(Wo(s))}c=i.source,p=i.target,t.canConnect(c,e,i)&&(n.reconnectEnd(i,e,r||d),l=i),t.canConnect(e,p,i)&&(l?u=n.connect(e,p,{type:i.type,waypoints:a}):(n.reconnectStart(i,e,a||d),u=i));var y=[].concat(l&&(0,h.pb)(v,function(e){return e.source===l.source})||[],u&&(0,h.pb)(m,function(e){return e.target===u.target})||[]);y.length&&n.removeElements(y)}Jt.A.call(this,e),this.preExecute("elements.move",function(e){var n=e.newParent,i=e.shapes,o=e.delta,r=i[0];if(r&&n){n&&n.waypoints&&(e.newParent=n=n.parent);var a=(0,qt.pp)(r),s={x:a.x+o.x,y:a.y+o.y},c=(0,h.I6)(n.children,function(e){return t.canInsert(i,e)&&$n(e.waypoints,s)});c&&(e.targetFlow=c,e.position=s)}},!0),this.postExecuted("elements.move",function(e){var t=e.shapes,n=e.targetFlow,o=e.position;n&&i(t[0],n,o)},!0),this.preExecute("shape.create",function(e){var n=e.parent,i=e.shape;t.canInsert(i,n)&&(e.targetFlow=n,e.parent=n.parent)},!0),this.postExecuted("shape.create",function(e){var t=e.shape,n=e.targetFlow,o=e.position;n&&i(t,n,o)},!0)}function Uo(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function Wo(e){return(0,h.kp)({},e)}function Vo(e,t){Jt.A.call(this,e),this.preExecuted("connection.create",function(e){var n=e.context,i=n.connection,o=n.source,r=n.target,a=n.hints;if((!a||!1!==a.createElementsBehavior)&&qo(i)){((0,on.is)(o,"bpmn:EventBasedGateway")?r.incoming.filter(e=>e!==i&&qo(e)):r.incoming.filter(e=>e!==i&&qo(e)&&(0,on.is)(e.source,"bpmn:EventBasedGateway"))).forEach(function(e){t.removeConnection(e)})}}),this.preExecuted("shape.replace",function(e){var n=e.context.newShape;(0,on.is)(n,"bpmn:EventBasedGateway")&&n.outgoing.filter(qo).reduce(function(e,t){return e.includes(t.target)?e:e.concat(t.target)},[]).forEach(function(e){e.incoming.filter(qo).forEach(function(i){const o=e.incoming.filter(qo).filter(function(e){return e.source===n});(i.source!==n||o.length>1)&&t.removeConnection(i)})})})}function qo(e){return(0,on.is)(e,"bpmn:SequenceFlow")}Ho.$inject=["bpmnReplace","injector"],(0,i.A)(Ho,Jt.A),Ho.prototype._replaceShape=function(e){var t,n=function(e){var t=(0,on.Cf)(e).eventDefinitions;return t&&t[0]}(e);return t=n?{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:n.$type}:{type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,t,{layoutConnection:!1})},(0,i.A)(Go,Jt.A),Go.$inject=["eventBus","bpmnRules","modeling"],Vo.$inject=["eventBus","modeling"],(0,i.A)(Vo,Jt.A);var Xo=1500;function Qo(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],Xo,function(t){var i=t.context.shape||t.shape,o=t.hover;(0,on.is)(o,"bpmn:Lane")&&!(0,on.f7)(i,["bpmn:Lane","bpmn:Participant"])&&(t.hover=zo(o),t.hoverGfx=e.getGraphics(t.hover));var r=n.getRootElement();o!==r&&(i.labelTarget||(0,on.f7)(i,["bpmn:Group","bpmn:TextAnnotation"]))&&(t.hover=r,t.hoverGfx=e.getGraphics(t.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],Xo,function(t){var n=t.hover;(0,on.is)(n,"bpmn:Lane")&&(t.hover=zo(n)||n,t.hoverGfx=e.getGraphics(t.hover))}),t.on(["bendpoint.move.hover"],Xo,function(t){var n=t.context,i=t.hover,o=n.type;(0,on.is)(i,"bpmn:Lane")&&/reconnect/.test(o)&&(t.hover=zo(i)||i,t.hoverGfx=e.getGraphics(t.hover))}),t.on(["connect.start"],Xo,function(e){var t=e.context,n=t.start;(0,on.is)(n,"bpmn:Lane")&&(t.start=zo(n)||n)}),t.on("shape.move.start",2e3,function(e){var t=e.shape;(0,on.is)(t,"bpmn:Lane")&&(e.shape=zo(t)||t)}),t.on("spaceTool.move",2e3,function(e){var t=e.hover;t&&(0,on.is)(t,"bpmn:Lane")&&(e.hover=zo(t))})}Qo.$inject=["elementRegistry","eventBus","canvas"];function Ko(e,t,n,i,o,r){function a(e,t,i){var o=n.filter(function(e){return(0,on.is)(e,"bpmn:Group")}).filter(function(e){return e.businessObject!==i});t&&!function(e,t){return e.some(function(e){var n=(0,on.Cf)(e);return(n.categoryValueRef&&n.categoryValueRef.$parent)===t})}(o,t)&&function(e){var t=e.$parent;t&&((0,_o.TF)(t.get("rootElements"),e),e.$parent=null)}(t),e&&!function(e,t){return e.some(function(e){return(0,on.Cf)(e).categoryValueRef===t})}(o,e)&&function(e){var t=e.$parent;t&&((0,_o.TF)(t.get("categoryValue"),e),e.$parent=null)}(e)}function s(e,n){return function(e,t,n){return(0,_o.WQ)(t.get("categoryValue"),e),e.$parent=t,(0,_o.WQ)(n.get("rootElements"),t),t.$parent=n,e}(e,n,t.getDefinitions())}function c(n,i){var o=(0,on.Cf)(n),r=o.categoryValueRef;r||(r=o.categoryValueRef=i.categoryValue=i.categoryValue||function(e){return e.create("bpmn:CategoryValue")}(e));var a=r.$parent;a||(a=r.$parent=i.category=i.category||function(e){return e.create("bpmn:Category")}(e)),s(r,a,t.getDefinitions())}function p(e,t){var n=t.category,i=t.categoryValue,o=(0,on.Cf)(e);i?(o.categoryValueRef=null,a(i,n,o)):a(null,o.categoryValueRef.$parent,o)}function l(t,n){var i=e.create(t.$type);return r.copyElement(t,i,null,n)}o.invoke(Jt.A,this),this.execute("label.create",function(e){var t=e.context,n=t.labelTarget;(0,on.is)(n,"bpmn:Group")&&c(n,t)}),this.revert("label.create",function(e){var t=e.context,n=t.labelTarget;(0,on.is)(n,"bpmn:Group")&&p(n,t)}),this.execute("shape.delete",function(e){var t=e.context,n=t.shape,i=(0,on.Cf)(n);if((0,on.is)(n,"bpmn:Group")&&!n.labelTarget){var o=t.categoryValue=i.categoryValueRef;o&&(a(o,t.category=o.$parent,i),i.categoryValueRef=null)}}),this.reverted("shape.delete",function(e){var t=e.context,n=t.shape;if((0,on.is)(n,"bpmn:Group")&&!n.labelTarget){var i=t.category,o=t.categoryValue,r=(0,on.Cf)(n);o&&(r.categoryValueRef=o,s(o,i))}}),this.execute("shape.create",function(e){var t=e.context,n=t.shape;(0,on.is)(n,"bpmn:Group")&&!n.labelTarget&&(0,on.Cf)(n).categoryValueRef&&c(n,t)}),this.reverted("shape.create",function(e){var t=e.context,n=t.shape;(0,on.is)(n,"bpmn:Group")&&!n.labelTarget&&(0,on.Cf)(n).categoryValueRef&&p(n,t)}),i.on("copyPaste.copyElement",770,function(e){var t=e.descriptor,n=e.element;if((0,on.is)(n,"bpmn:Group")&&!n.labelTarget){var i=(0,on.Cf)(n);if(i.categoryValueRef){var o=i.categoryValueRef;t.categoryValue=l(o,!0),o.$parent&&(t.category=l(o.$parent,!0))}}}),i.on("copyPaste.pasteElement",770,function(e){var t=e.descriptor,n=t.businessObject,i=t.categoryValue,o=t.category;i&&(i=n.categoryValueRef=l(i)),o&&(i.$parent=l(o)),delete t.category,delete t.categoryValue})}function Zo(e,t,n,i){var o,r,a,s;return 0==(o=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y))?null:(r=e.y-n.y,a=e.x-n.x,s=((i.x-n.x)*r-(i.y-n.y)*a)/o,{x:Math.round(e.x+s*(t.x-e.x)),y:Math.round(e.y+s*(t.y-e.y))})}function Yo(e){function t(e,t,n){var i,o={x:n.x,y:n.y-50},r={x:n.x-50,y:n.y},a=Zo(e,t,n,o),s=Zo(e,t,n,r);i=a&&s?er(a,n)>er(s,n)?s:a:a||s,e.original=i}e.on("bpmnElement.added",function(e){var n=e.element;n.waypoints&&function(e){var n=e.waypoints;t(n[0],n[1],(0,qt.pp)(e.source)),t(n[n.length-1],n[n.length-2],(0,qt.pp)(e.target))}(n)})}function er(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function tr(e){Jt.A.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(e){var n=e.context.shape,i=(0,on.Cf)(n),o=(0,on.S2)(n);if((0,on.f7)(i,t)){var r=o.get("isHorizontal");void 0===r&&(r=!0),o.set("isHorizontal",r)}})}Ko.$inject=["bpmnFactory","bpmnjs","elementRegistry","eventBus","injector","moddleCopy"],(0,i.A)(Ko,Jt.A),Yo.$inject=["eventBus"],tr.$inject=["eventBus"],(0,i.A)(tr,Jt.A);var nr=Math.sqrt,ir=Math.min,or=Math.max,rr=Math.abs;function ar(e){return Math.pow(e,2)}function sr(e,t){return nr(ar(e.x-t.x)+ar(e.y-t.y))}function cr(e,t,n,i){var o=t.x-e.x,r=t.y-e.y,a=n.x-e.x,s=n.y-e.y,c=o*o+r*r,p=(o*a+r*s)/c,l=p*p-(a*a+s*s-i*i)/c;if(l<0&&l>-1e-6&&(l=0),l<0)return[];var u=nr(l),h=-p+u,d=-p-u,f={x:e.x-o*h,y:e.y-r*h};return 0===l?[f]:[f,{x:e.x-o*d,y:e.y-r*d}].filter(function(n){return function(e,t,n){return pr(e.x,t.x,n.x)&&pr(e.y,t.y,n.y)}(n,e,t)})}function pr(e,t,n){return e>=ir(t,n)-ur&&e<=or(t,n)+ur}function lr(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var ur=.1;function hr(e,t){return rr(e.x-t.x)<=ur&&rr(e.y-t.y)<=ur}function dr(e,t,n,i){var o=0,r=0,a={point:e,delta:{x:0,y:0}},s=function(e,t){var n,i,o,r,a,s,c,p,l,u,h=0;for(h=0;h<t.length-1;h++){if(hr(n=t[h],i=t[h+1])?s=[n]:(o=sr(e,n),r=sr(e,i),s=cr(n,i,e,ir(o,r))),s.length<1)throw new Error("expected between [1, 2] circle -> line intersections");1===s.length&&(c={type:"bendpoint",position:s[0],segmentIndex:h,bendpointIndex:hr(n,s[0])?h:h+1}),2===s.length&&(c={type:"segment",position:a=lr(s[0],s[1]),segmentIndex:h,relativeLocation:sr(n,a)/sr(n,i)}),p=sr(c.position,e),(!u||l>p)&&(u=c,l=p)}return u}(e,n),c=s.segmentIndex,p=function(e,t,n,i){var o=n.segmentIndex,r=t.length-e.length;if(i.segmentMove){var a=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return o===a?s:o>=s?o+r<s?s:o+r:o}if(i.bendpointMove){var c,p=i.bendpointMove.insert,l=i.bendpointMove.bendpointIndex;return 0===r?o:(o>=l&&(c=p?o+1:o-1),o<l&&(c=o,p&&"bendpoint"!==n.type&&l-1===o&&fr(t,l)<n.relativeLocation&&c++),c)}return 0===r?o:i.connectionStart&&0===o?0:i.connectionEnd&&o===e.length-2?t.length-2:Math.floor((t.length-2)/2)}(n,t,s,i);if(p<0||p>t.length-2||null===p)return a;var l=mr(n,c),u=mr(t,p),h=s.position,d=function(e,t){var n=Wn(e[0],e[1]),i=Wn(e[0],t);return 0===n?0:i/n}(l,h),f=function(e,t){var n=Jn(e);return Jn(t)-n}(l,u);if("bendpoint"===s.type){var m=t.length-n.length,v=s.bendpointIndex,g=n[v];if(-1!==t.indexOf(g))return a;if(0===m){var y=t[v];return{delta:{x:o=y.x-s.position.x,y:r=y.y-s.position.y},point:{x:e.x+o,y:e.y+r}}}m<0&&0!==v&&v<n.length-1&&(d=fr(n,v))}var b,_,x={x:(u[1].x-u[0].x)*d+u[0].x,y:(u[1].y-u[0].y)*d+u[0].y},w=(b={x:e.x-h.x,y:e.y-h.y},(_=f)?{x:Math.cos(_)*b.x-Math.sin(_)*b.y,y:Math.sin(_)*b.x+Math.cos(_)*b.y}:b);return o=x.x+w.x-e.x,r=x.y+w.y-e.y,{point:(0,qt.PG)(x),delta:(0,qt.PG)({x:o,y:r})}}function fr(e,t){var n=Wn(e[t-1],e[t]);return n/(n+Wn(e[t],e[t+1]))}function mr(e,t){return[e[t],e[t+1]]}function vr(e,t,n){var i=(0,En.g)(t),o=(0,En.g)(n),r=(0,En.p)(e,i),a=r.x*(n.width/t.width),s=r.y*(n.height/t.height);return(0,qt.PG)({x:o.x+a,y:o.y+s})}function gr(e,t,n){var i=(0,En.g)(e),o=(0,En.g)(t),r=(0,En.g)(n),a=(0,En.p)(e,i),s=(0,En.p)(i,o),c=function(e,t,n){var i=(0,qt.Fy)(t),o=(0,qt.Fy)(n);if(function(e,t){return function(e,t){return e.right!==t.right&&e.left!==t.left}(e,t)||function(e,t){return e.top!==t.top&&e.bottom!==t.bottom}(e,t)}(i,o))return null;var r,a,s,c=(0,qt.vc)(t,e);if("top"===c)r={x:0,y:o.bottom-i.bottom};else if("bottom"===c)r={x:0,y:o.top-i.top};else if("right"===c)r={x:o.left-i.left,y:0};else{if("left"!==c)return null;r={x:o.right-i.right,y:0}}if(a={x:e.x+r.x,y:e.y+r.y},s=(0,qt.vc)(n,a),s!==c)return null;return r}(i,t,n);if(c)return c;var p=s.x*(n.width/t.width),l=s.y*(n.height/t.height),u=r.x+p,h=r.y+l;return(0,qt.PG)({x:u+a.x-e.x,y:h+a.y-e.y})}var yr="name",br="text";function _r(e,t,n,i){function o(e){var n=e.context,o=n.element,r=n.properties;if(yr in r&&t.updateLabel(o,r[yr]),br in r&&(0,on.is)(o,"bpmn:TextAnnotation")){var a=i.getTextAnnotationBounds({x:o.x,y:o.y,width:o.width,height:o.height},r[br]||"");t.updateLabel(o,r.text,a)}}function r(e){var t=e.context,n=t.connection,i=n.label,o=(0,h.kp)({},t.hints),r=t.newWaypoints||n.waypoints,a=t.oldWaypoints;return"undefined"===typeof o.startChanged&&(o.startChanged=!!o.connectionStart),"undefined"===typeof o.endChanged&&(o.endChanged=!!o.connectionEnd),function(e,t,n,i){return dr((0,qt.pp)(e),t,n,i).delta}(i,r,a,o)}Jt.A.call(this,e),this.postExecute("element.updateProperties",o),this.postExecute("element.updateModdleProperties",e=>{(0,on.Cf)(e.context.element)===e.context.moddleElement&&o(e)}),this.postExecute(["shape.create","connection.create"],function(e){var n=e.context;if(!1!==(n.hints||{}).createElementsBehavior){var i=n.shape||n.connection;!(0,P.J2)(i)&&(0,Yi.UC)(i)&&(0,Yi.p9)(i)&&t.updateLabel(i,(0,Yi.p9)(i))}}),this.postExecute("shape.delete",function(e){var n=e.context,i=n.labelTarget,o=n.hints||{};i&&!1!==o.unsetLabel&&t.updateLabel(i,null,null,{removeShape:!1})}),this.postExecute(["connection.layout","connection.updateWaypoints"],function(e){var n=e.context;if(!1!==(n.hints||{}).labelBehavior){var i,o=n.connection.label;o&&o.parent&&(i=r(e),t.moveShape(o,i))}}),this.postExecute(["shape.replace"],function(e){var t=e.context,n=t.newShape,i=t.oldShape,o=(0,on.Cf)(n);o&&(0,Yi.UC)(o)&&i.label&&n.label&&(n.label.x=i.label.x,n.label.y=i.label.y)}),this.postExecute("shape.resize",function(e){var n,i=e.context,o=i.shape,r=i.newBounds,a=i.oldBounds;if((0,Yi.ur)(o)){var s=o.label,c=function(e,t){if(!t.length)return;var n=function(e,t){var n=t.map(function(t){return{line:t,distance:Un(e,t)}});return(0,h.Ul)(n,"distance")[0].line}(e,t);return Gn(e,n)}((0,qt.pp)(s),[[{x:(n=a).x,y:n.y},{x:n.x+(n.width||0),y:n.y}],[{x:n.x+(n.width||0),y:n.y},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y+(n.height||0)},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y},{x:n.x,y:n.y+(n.height||0)}]]),p=function(e,t,n){var i=vr(e,t,n);return(0,qt.PG)((0,En.p)(i,e))}(c,a,r);t.moveShape(s,p)}})}function xr(e,t){function n(e,t){var n=e.context,i=n.connection,o=(0,h.kp)({},n.hints),r=n.newWaypoints||i.waypoints,a=n.oldWaypoints;return"undefined"===typeof o.startChanged&&(o.startChanged=!!o.connectionStart),"undefined"===typeof o.endChanged&&(o.endChanged=!!o.connectionEnd),function(e,t,n,i){return dr(e,t,n,i).point}(t,r,a,o)}Jt.A.call(this,e),this.postExecute(["connection.layout","connection.updateWaypoints"],function(e){var i=e.context.connection,o=i.outgoing;i.incoming.forEach(function(i){var o=i.waypoints[i.waypoints.length-1],r=n(e,o),a=[].concat(i.waypoints.slice(0,-1),[r]);t.updateWaypoints(i,a)}),o.forEach(function(i){var o=i.waypoints[0],r=n(e,o),a=[].concat([r],i.waypoints.slice(1));t.updateWaypoints(i,a)})}),this.postExecute(["connection.move"],function(e){var n=e.context,i=n.connection,o=i.outgoing,r=i.incoming,a=n.delta;r.forEach(function(e){var n=e.waypoints[e.waypoints.length-1],i={x:n.x+a.x,y:n.y+a.y},o=[].concat(e.waypoints.slice(0,-1),[i]);t.updateWaypoints(e,o)}),o.forEach(function(e){var n=e.waypoints[0],i={x:n.x+a.x,y:n.y+a.y},o=[].concat([i],e.waypoints.slice(1));t.updateWaypoints(e,o)})})}function wr(e,t,n){var i=Pr(e),o=Tr(i,t),r=i[0];return o.length?o[o.length-1]:vr(r.original||r,n,t)}function Er(e,t,n){var i=Pr(e),o=Tr(i,t),r=i[i.length-1];return o.length?o[0]:vr(r.original||r,n,t)}function Sr(e,t,n){var i=Pr(e),o=kr(t,n),r=i[0];return vr(r.original||r,o,t)}function Cr(e,t,n){var i=Pr(e),o=kr(t,n),r=i[i.length-1];return vr(r.original||r,o,t)}function kr(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function Pr(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function Tr(e,t){var n=(0,h.Tj)(e,Ar);return(0,h.pb)(n,function(e){return function(e,t){return"intersect"===(0,qt.vc)(t,e,1)}(e,t)})}function Ar(e){return e.original||e}function jr(e,t){Jt.A.call(this,e),this.postExecute("shape.replace",function(e){var n=e.oldShape,i=e.newShape;if(function(e,t){return(0,on.is)(e,"bpmn:Participant")&&(0,rn.Av)(e)&&(0,on.is)(t,"bpmn:Participant")&&!(0,rn.Av)(t)}(n,i)){var o=function(e){var t=(0,Ut.cZ)([e],!1),n=[],i=[];return t.forEach(function(t){t!==e&&(t.incoming.forEach(function(e){(0,on.is)(e,"bpmn:MessageFlow")&&n.push(e)}),t.outgoing.forEach(function(e){(0,on.is)(e,"bpmn:MessageFlow")&&i.push(e)}))},[]),{incoming:n,outgoing:i}}(n);o.incoming.forEach(function(e){var o=Er(e,i,n);t.reconnectEnd(e,i,o)}),o.outgoing.forEach(function(e){var o=wr(e,i,n);t.reconnectStart(e,i,o)})}},!0)}(0,i.A)(_r,Jt.A),_r.$inject=["eventBus","modeling","bpmnFactory","textRenderer"],(0,i.A)(xr,Jt.A),xr.$inject=["eventBus","modeling"],jr.$inject=["eventBus","modeling"],(0,i.A)(jr,Jt.A);const Br=["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:EscalationEventDefinition","bpmn:ConditionalEventDefinition","bpmn:SignalEventDefinition"];function Dr(e){const t=(0,on.Cf)(e);if(!(0,on.is)(t,"bpmn:BoundaryEvent")&&(!(0,on.is)(t,"bpmn:StartEvent")||!(0,rn.Q1)(t.$parent)))return!1;const n=t.get("eventDefinitions");return!(!n||!n.length)&&Br.some(e=>(0,on.is)(n[0],e))}function Rr(e){return(0,on.is)(e,"bpmn:BoundaryEvent")?"cancelActivity":"isInterrupting"}function Mr(e,t){e.invoke(Jt.A,this),this.postExecuted("shape.replace",function(e){const n=e.context.oldShape,i=e.context.newShape,o=e.context.hints;if(!Dr(i))return;const r=Rr(i);if(o.targetElement&&void 0!==o.targetElement[r])return;const a=(0,on.Cf)(n).get(r);a!==(0,on.Cf)(i).get(r)&&t.updateProperties(i,{[r]:a})})}function Nr(e,t){Jt.A.call(this,e),this.preExecute("shape.resize",function(e){var n=e.shape,i=(0,on.S2)(n),o=i&&i.get("label");o&&o.get("bounds")&&t.updateModdleProperties(n,o,{bounds:void 0})},!0)}function Fr(e,t,n){Jt.A.call(this,e),this.preExecute("shape.delete",function(e){var i=e.context.shape;if(1===i.incoming.length&&1===i.outgoing.length){var o=i.incoming[0],r=i.outgoing[0];if((0,on.is)(o,"bpmn:SequenceFlow")&&(0,on.is)(r,"bpmn:SequenceFlow")&&t.canConnect(o.source,r.target,o)){var a=function(e,t){var n=Zo(Lr(e[e.length-2]),Lr(e[e.length-1]),Lr(t[1]),Lr(t[0]));return n?[].concat(e.slice(0,e.length-1),[n],t.slice(1)):[Lr(e[0]),Lr(t[t.length-1])]}(o.waypoints,r.waypoints);n.reconnectEnd(o,r.target,a)}}})}function Lr(e){return e.original||e}function Or(e,t){Jt.A.call(this,e),this.preExecute("shape.delete",function(e){var t=e.shape,n=t.parent;(0,on.is)(t,"bpmn:Participant")&&(e.collaborationRoot=n)},!0),this.postExecute("shape.delete",function(e){var n=e.collaborationRoot;if(n&&!n.businessObject.participants.length){var i=t.makeProcess(),o=n.children.slice();t.moveElements(o,{x:0,y:0},i)}},!0)}function zr(e,t,n,i){Jt.A.call(this,e);var o=i.get("dragging",!1);function r(e){var i,o,r=e.source,a=e.target;e.parent&&((0,on.is)(e,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(r,a)||(o=!0),n.canConnectMessageFlow(r,a)&&(i="bpmn:MessageFlow")),(0,on.is)(e,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(r,a)||(o=!0),n.canConnectSequenceFlow(r,a)&&(i="bpmn:SequenceFlow")),o&&t.removeConnection(e),i&&t.connect(r,a,{type:i,waypoints:e.waypoints.slice()}))}this.postExecuted("elements.move",function(e){var t=e.closure.allConnections;(0,h.jJ)(t,r)},!0),this.preExecute("connection.reconnect",function(e){var i,r,a=e.context,s=a.connection,c=a.newSource||s.source,p=a.newTarget||s.target;(i=n.canConnect(c,p))&&i.type!==s.type&&(r=t.connect(c,p,{type:i.type,associationDirection:i.associationDirection,waypoints:s.waypoints.slice()}),s.parent&&t.removeConnection(s),a.connection=r,o&&function(e,t){var n,i=o.context(),r=i&&i.payload.previousSelection;if(!r||!r.length)return;if(-1===(n=r.indexOf(e)))return;r.splice(n,1,t)}(s,r))}),this.postExecuted("element.updateProperties",function(e){var n,i=e.context,o=i.properties,r=i.element,a=r.businessObject;o.default&&(n=(0,h.I6)(r.outgoing,(0,h.gH)({id:r.businessObject.default.id})))&&t.updateProperties(n,{conditionExpression:void 0}),o.conditionExpression&&a.sourceRef.default===a&&t.updateProperties(r.source,{default:void 0})})}function Ir(e,t,n,i,o,r){i.invoke(Jt.A,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=r,this.postExecuted(["elements.create"],500,function(e){var n=e.context,i=n.parent,o=n.elements,r=(0,h.TS)(o,function(e,n){var o=t.canReplace([n],n.host||n.parent||i);return o?e.concat(o.replacements):e},[]);r.length&&this._replaceElements(o,r)},this),this.postExecuted(["elements.move"],500,function(e){var n=e.context,i=n.newParent,o=n.newHost,r=[];(0,h.jJ)(n.closure.topLevel,function(e){r=(0,rn.Q1)(e)?r.concat(e.children):r.concat(e)}),1===r.length&&o&&(i=o);var a=t.canReplace(r,i);a&&this._replaceElements(r,a.replacements,o)},this),this.postExecute(["shape.replace"],1500,function(e){var n,i=e.context,o=i.oldShape,r=i.newShape,a=o.attachers;a&&a.length&&(n=t.canReplace(a,r),this._replaceElements(a,n.replacements))},this),this.postExecuted(["shape.replace"],1500,function(e){var t=e.context,n=t.oldShape,i=t.newShape;o.unclaimId(n.businessObject.id,n.businessObject),o.updateProperties(i,{id:n.id})})}Mr.$inject=["injector","modeling"],(0,i.A)(Mr,Jt.A),(0,i.A)(Nr,Jt.A),Nr.$inject=["eventBus","modeling"],(0,i.A)(Fr,Jt.A),Fr.$inject=["eventBus","bpmnRules","modeling"],Or.$inject=["eventBus","modeling"],(0,i.A)(Or,Jt.A),(0,i.A)(zr,Jt.A),zr.$inject=["eventBus","modeling","bpmnRules","injector"],(0,i.A)(Ir,Jt.A),Ir.prototype._replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,o=this._selection;(0,h.jJ)(t,function(t){var o={type:t.newElementType},r=n.get(t.oldElementId),a=e.indexOf(r);e[a]=i.replaceElement(r,o,{select:!1})}),t&&o.select(e)},Ir.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var $r={width:140,height:120},Hr={width:300,height:60},Jr={width:60,height:300},Gr={width:300,height:150},Ur={width:150,height:300},Wr={width:140,height:120},Vr={width:50,height:30};function qr(e){e.on("resize.start",1500,function(e){var t=e.context,n=t.shape,i=t.direction,o=t.balanced;((0,on.is)(n,"bpmn:Lane")||(0,on.is)(n,"bpmn:Participant"))&&(t.resizeConstraints=function(e,t,n){var i=zo(e),o=!0,r=!0,a=Lo(i,[i]),s=(0,qt.Fy)(e),c={},p={},l=(0,rn.$b)(e),u=l?Hr:Jr;/n/.test(t)?p.top=s.bottom-u.height:/e/.test(t)?p.right=s.left+u.width:/s/.test(t)?p.bottom=s.top+u.height:/w/.test(t)&&(p.left=s.right-u.width);a.forEach(function(e){var i=(0,qt.Fy)(e);l?(i.top<s.top-10&&(o=!1),i.bottom>s.bottom+10&&(r=!1)):(i.left<s.left-10&&(o=!1),i.right>s.right+10&&(r=!1)),/n/.test(t)&&(n&&Xr(s.top-i.bottom)<10&&ea(c,"top",i.top+u.height),Xr(s.top-i.top)<5&&Yr(p,"top",i.bottom-u.height)),/e/.test(t)&&(n&&Xr(s.right-i.left)<10&&Yr(c,"right",i.right-u.width),Xr(s.right-i.right)<5&&ea(p,"right",i.left+u.width)),/s/.test(t)&&(n&&Xr(s.bottom-i.top)<10&&Yr(c,"bottom",i.bottom-u.height),Xr(s.bottom-i.bottom)<5&&ea(p,"bottom",i.top+u.height)),/w/.test(t)&&(n&&Xr(s.left-i.right)<10&&ea(c,"left",i.left+u.width),Xr(s.left-i.left)<5&&Yr(p,"left",i.right-u.width))});var h=i.children.filter(function(e){return!e.hidden&&!e.waypoints&&((0,on.is)(e,"bpmn:FlowElement")||(0,on.is)(e,"bpmn:Artifact"))}),d=l?ta:na;return h.forEach(function(e){var n=(0,qt.Fy)(e);!/n/.test(t)||l&&!o||Yr(p,"top",n.top-d.top),/e/.test(t)&&(l||r)&&ea(p,"right",n.right+d.right),!/s/.test(t)||l&&!r||ea(p,"bottom",n.bottom+d.bottom),/w/.test(t)&&(l||o)&&Yr(p,"left",n.left-d.left)}),{min:p,max:c}}(n,i,o)),(0,on.is)(n,"bpmn:SubProcess")&&(0,rn.Av)(n)&&(t.minDimensions=Wr),(0,on.is)(n,"bpmn:TextAnnotation")&&(t.minDimensions=Vr)})}qr.$inject=["eventBus"];var Xr=Math.abs,Qr=Math.min,Kr=Math.max;function Zr(e,t,n,i){var o=e[t];e[t]=void 0===o?n:i(n,o)}function Yr(e,t,n){return Zr(e,t,n,Qr)}function ea(e,t,n){return Zr(e,t,n,Kr)}var ta={top:20,left:50,right:20,bottom:20},na={top:50,left:20,right:20,bottom:20};function ia(e,t){e.on("resize.start",1501,function(e){var t=e.context,n=t.shape;((0,on.is)(n,"bpmn:Lane")||(0,on.is)(n,"bpmn:Participant"))&&(t.balanced=!(0,ti.Io)(e))}),e.on("resize.end",1001,function(e){var n=e.context,i=n.shape,o=n.canExecute,r=n.newBounds;if((0,on.is)(i,"bpmn:Lane")||(0,on.is)(i,"bpmn:Participant"))return o&&(r=(0,qt.Au)(r),t.resizeLane(i,r,n.balanced)),!1})}ia.$inject=["eventBus","modeling"];function oa(e,t,n,i,o){function r(e){return(0,on.f7)(e,["bpmn:ReceiveTask","bpmn:SendTask"])||function(e,t){(0,h.cy)(t)||(t=[t]);return(0,h.zN)(t,function(t){return(0,rn.Ip)(e,t)})}(e,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function a(t){var n=e.getDefinitions().get("rootElements");return!!(0,h.I6)(n,(0,h.gH)({id:t.id}))}function s(e){return(0,on.is)(e,"bpmn:ErrorEventDefinition")?"errorRef":(0,on.is)(e,"bpmn:EscalationEventDefinition")?"escalationRef":(0,on.is)(e,"bpmn:MessageEventDefinition")?"messageRef":(0,on.is)(e,"bpmn:SignalEventDefinition")?"signalRef":void 0}function c(e){if((0,on.f7)(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.get("messageRef");var t=e.get("eventDefinitions")[0];return t.get(s(t))}n.invoke(Jt.A,this),this.executed(["shape.create","element.updateProperties","element.updateModdleProperties"],function(t){var n=t.shape||t.element;if(r(n)){var i,o=c((0,on.Cf)(n));o&&!a(o)&&(i=e.getDefinitions().get("rootElements"),(0,_o.WQ)(i,o),t.addedRootElement=o)}},!0),this.reverted(["shape.create","element.updateProperties","element.updateModdleProperties"],function(t){var n=t.addedRootElement;if(n){var i=e.getDefinitions().get("rootElements");(0,_o.TF)(i,n)}},!0),t.on("copyPaste.copyElement",function(e){var t=e.descriptor,n=e.element;if(!n.labelTarget&&r(n)){var i=c((0,on.Cf)(n));i&&(t.referencedRootElement=i)}}),t.on("copyPaste.pasteElement",500,function(e){var t=e.descriptor,n=t.businessObject,r=t.referencedRootElement;r&&(a(r)||(r=i.copyElement(r,o.create(r.$type))),function(e,t){if((0,on.f7)(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.set("messageRef",t);var n=e.get("eventDefinitions")[0];n.set(s(n),t)}(n,r),delete t.referencedRootElement)})}oa.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"],(0,i.A)(oa,Jt.A);var ra=Math.max;function aa(e){e.on("spaceTool.getMinDimensions",function(e){var t=e.shapes,n=e.axis,i=e.start,o={};return(0,h.jJ)(t,function(e){var t=e.id;(0,on.is)(e,"bpmn:Participant")&&(o[t]=function(e,t,n){var i=(0,rn.$b)(e);if(o=e,!Oo(o).length)return i?Gr:Ur;var o;var r=function(e){return"x"===e}(t),a={};a=r?i?Gr:{width:ca(e,n,r),height:Ur.height}:i?{width:Gr.width,height:sa(e,n,r)}:Ur;return a}(e,n,i)),(0,on.is)(e,"bpmn:Lane")&&(o[t]=(0,rn.$b)(e)?Hr:Jr),(0,on.is)(e,"bpmn:SubProcess")&&(0,rn.Av)(e)&&(o[t]=Wr),(0,on.is)(e,"bpmn:TextAnnotation")&&(o[t]=Vr),(0,on.is)(e,"bpmn:Group")&&(o[t]=$r)}),o})}function sa(e,t,n){var i;return i=function(e,t,n){var i,o=Oo(e);return i=pa(o,t,n),e.height-i.height+Hr.height}(e,t,n),ra(Gr.height,i)}function ca(e,t,n){var i;return i=function(e,t,n){var i,o=Oo(e);return i=pa(o,t,n),e.width-i.width+Jr.width}(e,t,n),ra(Ur.width,i)}function pa(e,t,n){var i,o,r;for(i=0;i<e.length;i++)if(o=e[i],!n&&t>=o.y&&t<=o.y+o.height||n&&t>=o.x&&t<=o.x+o.width)return(r=Oo(o)).length?pa(r,t,n):o}aa.$inject=["eventBus"];var la=n(51366),ua=180,ha=160;function da(e,t,n,i,o,r,a){Jt.A.call(this,t),this._canvas=e,this._eventBus=t,this._modeling=n,this._elementFactory=i,this._bpmnFactory=o,this._bpmnjs=r,this._elementRegistry=a;var s=this;function c(e){return(0,on.is)(e,"bpmn:SubProcess")&&!(0,rn.Av)(e)}function p(t){var n=t.shape,i=t.newRootElement,o=(0,on.Cf)(n);i=s._addDiagram(i||o),t.newRootElement=e.addRootElement(i)}function l(t){var n=t.shape,i=(0,on.Cf)(n);s._removeDiagram(i);var o=t.newRootElement=a.get((0,la.hJ)(i));e.removeRootElement(o)}this.executed("shape.create",function(e){c(e.shape)&&p(e)},!0),this.postExecuted("shape.create",function(e){var t=e.shape,n=e.newRootElement;n&&t.children&&(s._showRecursively(t.children),s._moveChildrenToShape(t,n))},!0),this.reverted("shape.create",function(e){c(e.shape)&&l(e)},!0),this.preExecuted("shape.delete",function(e){var t=e.shape;if(c(t)){var i=a.get((0,la.hJ)(t));i&&n.removeElements(i.children.slice())}},!0),this.executed("shape.delete",function(e){c(e.shape)&&l(e)},!0),this.reverted("shape.delete",function(e){c(e.shape)&&p(e)},!0),this.preExecuted("shape.replace",function(t){var n=t.oldShape,i=t.newShape;c(n)&&c(i)&&(t.oldRoot=e.removeRootElement((0,la.hJ)(n)))},!0),this.postExecuted("shape.replace",function(t){var i=t.newShape,o=t.oldRoot,r=e.findRoot((0,la.hJ)(i));if(o&&r){var a=o.children;n.moveElements(a,{x:0,y:0},r)}},!0),this.executed("element.updateProperties",function(e){var t=e.element;if((0,on.is)(t,"bpmn:SubProcess")){var n=e.properties,i=e.oldProperties.id,o=n.id;if(i!==o){if((0,la.hC)(t))return a.updateId(t,(0,la.vY)(o)),void a.updateId(i,o);a.get((0,la.vY)(i))&&a.updateId((0,la.vY)(i),(0,la.vY)(o))}}},!0),this.reverted("element.updateProperties",function(e){var t=e.element;if((0,on.is)(t,"bpmn:SubProcess")){var n=e.properties,i=e.oldProperties.id,o=n.id;if(i!==o){if((0,la.hC)(t))return a.updateId(t,(0,la.vY)(i)),void a.updateId(o,i);var r=a.get((0,la.vY)(o));r&&a.updateId(r,(0,la.vY)(i))}}},!0),t.on("element.changed",function(e){var n=e.element;if((0,la.hC)(n)){var i=n,o=a.get((0,la.rr)(i));o&&o!==i&&t.fire("element.changed",{element:o})}}),this.executed("shape.toggleCollapse",400,function(e){var t=e.shape;(0,on.is)(t,"bpmn:SubProcess")&&((0,rn.Av)(t)?l(e):(p(e),s._showRecursively(t.children)))},!0),this.reverted("shape.toggleCollapse",400,function(e){var t=e.shape;(0,on.is)(t,"bpmn:SubProcess")&&((0,rn.Av)(t)?l(e):(p(e),s._showRecursively(t.children)))},!0),this.postExecuted("shape.toggleCollapse",600,function(e){var t=e.shape;if((0,on.is)(t,"bpmn:SubProcess")){var n=e.newRootElement;n&&((0,rn.Av)(t)?s._moveChildrenToShape(n,t):s._moveChildrenToShape(t,n))}},!0),t.on("copyPaste.createTree",function(e){var t=e.element,n=e.children;if(c(t)){var i=(0,la.hJ)(t),o=a.get(i);o&&n.push.apply(n,o.children)}}),t.on("copyPaste.copyElement",function(e){var t=e.descriptor,n=e.element,i=e.elements,o=n.parent;if((0,on.is)((0,on.S2)(o),"bpmndi:BPMNPlane")){var r=(0,la.rr)(o),a=(0,h.I6)(i,function(e){return e.id===r});a&&(t.parent=a.id)}}),t.on("copyPaste.pasteElement",function(e){var t=e.descriptor;t.parent&&(c(t.parent)||t.parent.hidden)&&(t.hidden=!0)})}function fa(e,t){e.invoke(Jt.A,this),this.postExecuted("shape.replace",function(e){var n=e.context.oldShape,i=e.context.newShape;if((0,on.is)(i,"bpmn:SubProcess")&&!(0,on.is)(i,"bpmn:AdHocSubProcess")&&((0,on.is)(n,"bpmn:Task")||(0,on.is)(n,"bpmn:CallActivity"))&&(0,rn.Av)(i)){var o,r={x:(o=i).x+o.width/6,y:o.y+o.height/2};t.createShape({type:"bpmn:StartEvent"},r,i)}})}function ma(e){Jt.A.call(this,e),this.preExecute("connection.create",function(e){const{target:t}=e;(0,on.is)(t,"bpmn:TextAnnotation")&&(e.parent=t.parent)},!0),this.preExecute(["shape.create","shape.resize","elements.move"],function(e){const t=e.shapes||[e.shape];1===t.length&&(0,on.is)(t[0],"bpmn:TextAnnotation")&&(e.hints=e.hints||{},e.hints.autoResize=!1)},!0)}function va(e,t){Jt.A.call(this,e),this.postExecuted("shape.toggleCollapse",1500,function(e){var n=e.shape;if(!(0,rn.Av)(n)){var i=(0,Ut.cZ)(n);i.forEach(function(e){var t=e.incoming.slice(),n=e.outgoing.slice();(0,h.jJ)(t,function(e){o(e,!0)}),(0,h.jJ)(n,function(e){o(e,!1)})})}function o(e,o){-1!==i.indexOf(e.source)&&-1!==i.indexOf(e.target)||(o?t.reconnectEnd(e,n,(0,qt.pp)(n)):t.reconnectStart(e,n,(0,qt.pp)(n)))}},!0)}(0,i.A)(da,Jt.A),da.prototype._moveChildrenToShape=function(e,t){var n,i=this._modeling,o=e.children;if(o){var r=(o=o.concat(o.reduce(function(t,n){return n.label&&n.label.parent!==e?t.concat(n.label):t},[]))).filter(function(e){return!e.hidden});if(r.length){var a=(0,Ut.U7)(r);if(t.x){var s=(0,qt.pp)(t),c=(0,qt.pp)(a);n={x:s.x-c.x,y:s.y-c.y}}else n={x:ua-a.x,y:ha-a.y};i.moveElements(o,n,t,{autoResize:!1})}else i.moveElements(o,{x:0,y:0},t,{autoResize:!1})}},da.prototype._showRecursively=function(e,t){var n=this,i=[];return e.forEach(function(e){e.hidden=!!t,i=i.concat(e),e.children&&(i=i.concat(n._showRecursively(e.children,e.collapsed||t)))}),i},da.prototype._addDiagram=function(e){var t=this._bpmnjs.getDefinitions().diagrams;return e.businessObject||(e=this._createNewDiagram(e)),t.push(e.di.$parent),e},da.prototype._createNewDiagram=function(e){var t=this._bpmnFactory,n=this._elementFactory,i=t.create("bpmndi:BPMNPlane",{bpmnElement:e}),o=t.create("bpmndi:BPMNDiagram",{plane:i});return i.$parent=o,n.createRoot({id:(0,la.hJ)(e),type:e.$type,di:i,businessObject:e,collapsed:!0})},da.prototype._removeDiagram=function(e){var t=this._bpmnjs.getDefinitions().diagrams,n=(0,h.I6)(t,function(t){return t.plane.bpmnElement.id===e.id});return t.splice(t.indexOf(n),1),n},da.$inject=["canvas","eventBus","modeling","elementFactory","bpmnFactory","bpmnjs","elementRegistry"],fa.$inject=["injector","modeling"],(0,i.A)(fa,Jt.A),(0,i.A)(ma,Jt.A),ma.$inject=["eventBus"],(0,i.A)(va,Jt.A),va.$inject=["eventBus","modeling"];function ga(e,t,n){Jt.A.call(this,e),this.executed(["shape.toggleCollapse"],500,function(e){var t,n=e.context.shape;(0,on.is)(n,"bpmn:SubProcess")&&(n.collapsed?(0,on.S2)(n).isExpanded=!1:((t=n.children).length&&t.forEach(function(e){"label"!==e.type||e.businessObject.name||(e.hidden=!0)}),(0,on.S2)(n).isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],500,function(e){var t=e.context.shape;t.collapsed?(0,on.S2)(t).isExpanded=!1:(0,on.S2)(t).isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],500,function(e){var i,o=e.context.shape,r=t.getDefaultSize(o);i=o.collapsed?function(e,t){return{x:e.x+(e.width-t.width)/2,y:e.y+(e.height-t.height)/2,width:t.width,height:t.height}}(o,r):function(e,t){var n,i,o,r=e.children,a=t;return n=(o=r,o.filter(function(e){return!e.hidden})).concat([e]),(i=Ro(n))?(a.width=Math.max(i.width,a.width),a.height=Math.max(i.height,a.height),a.x=i.x+(i.width-a.width)/2,a.y=i.y+(i.height-a.height)/2):(a.x=e.x+(e.width-a.width)/2,a.y=e.y+(e.height-a.height)/2),a}(o,r),n.resizeShape(o,i,null,{autoResize:!o.collapsed&&"nwse"})})}function ya(e,t,n,i){t.invoke(Jt.A,this),this.preExecute("shape.delete",function(e){var t=e.context.shape,o=t.businessObject;(0,P.J2)(t)||((0,on.is)(t,"bpmn:Participant")&&(0,rn.Av)(t)&&n.ids.unclaim(o.processRef.id),i.unclaimId(o.id,o))}),this.preExecute("connection.delete",function(e){var t=e.context.connection.businessObject;i.unclaimId(t.id,t)}),this.preExecute("canvas.updateRoot",function(){var t=e.getRootElement(),i=t.businessObject;(0,on.is)(t,"bpmn:Collaboration")&&n.ids.unclaim(i.id)})}function ba(e,t){Jt.A.call(this,e),this.preExecute("connection.delete",function(e){var n=e.context.connection,i=n.source;(function(e,t){if(!(0,on.is)(e,"bpmn:SequenceFlow"))return!1;var n=(0,on.Cf)(t),i=(0,on.Cf)(e);return n.get("default")===i})(n,i)&&t.updateProperties(i,{default:null})})}(0,i.A)(ga,Jt.A),ga.$inject=["eventBus","elementFactory","modeling"],(0,i.A)(ya,Jt.A),ya.$inject=["canvas","injector","moddle","modeling"],(0,i.A)(ba,Jt.A),ba.$inject=["eventBus","modeling"];function _a(e,t){var n;function i(){if(!n)throw new Error("out of bounds release");return n}Jt.A.call(this,e);var o=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(o,5e3,function(e){(n=n||new xa).enter()}),this.postExecuted(o,500,function(e){!function(){if(!n)throw new Error("out of bounds release");var e=n.leave();e&&(t.updateLaneRefs(n.flowNodes,n.lanes),n=null)}()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(e){var t=e.context.shape,n=i();t.labelTarget||((0,on.is)(t,"bpmn:Lane")&&n.addLane(t),(0,on.is)(t,"bpmn:FlowNode")&&n.addFlowNode(t))})}function xa(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function wa(e,t){Jt.A.call(this,e),this.postExecuted("elements.create",function(e){const n=e.context.elements;for(const i of n)Ea(i)&&!Sa(i)&&t.updateProperties(i,{isForCompensation:void 0})})}function Ea(e){const t=(0,on.Cf)(e);return t&&t.isForCompensation}function Sa(e){return e.incoming.filter(e=>function(e){return e&&(0,on.is)(e,"bpmn:BoundaryEvent")&&(0,rn.Ip)(e,"bpmn:CompensateEventDefinition")}(e.source)).length>0}_a.$inject=["eventBus","modeling"],(0,i.A)(_a,Jt.A),(0,i.A)(wa,Jt.A),wa.$inject=["eventBus","modeling"];const Ca={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","compensateBoundaryEventBehaviour","createBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","fixHoverBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","layoutConnectionBehavior","messageFlowBehavior","nonInterruptingBehavior","removeElementBehavior","removeEmbeddedLabelBoundsBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","rootElementReferenceBehavior","spaceToolBehavior","subProcessPlaneBehavior","subProcessStartEventBehavior","textAnnotationBehavior","toggleCollapseConnectionBehaviour","toggleElementCollapseBehaviour","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior","setCompensationActivityAfterPasteBehavior"],adaptiveLabelPositioningBehavior:["type",no],appendBehavior:["type",oo],associationBehavior:["type",ro],attachEventBehavior:["type",ao],boundaryEventBehavior:["type",co],compensateBoundaryEventBehaviour:["type",po],createBehavior:["type",fo],createDataObjectBehavior:["type",mo],createParticipantBehavior:["type",bo],dataInputAssociationBehavior:["type",wo],dataStoreBehavior:["type",Co],deleteLaneBehavior:["type",$o],detachEventBehavior:["type",Ho],dropOnFlowBehavior:["type",Go],eventBasedGatewayBehavior:["type",Vo],fixHoverBehavior:["type",Qo],groupBehavior:["type",Ko],importDockingFix:["type",Yo],isHorizontalFix:["type",tr],labelBehavior:["type",_r],layoutConnectionBehavior:["type",xr],messageFlowBehavior:["type",jr],nonInterruptingBehavior:["type",Mr],removeElementBehavior:["type",Fr],removeEmbeddedLabelBoundsBehavior:["type",Nr],removeParticipantBehavior:["type",Or],replaceConnectionBehavior:["type",zr],replaceElementBehaviour:["type",Ir],resizeBehavior:["type",qr],resizeLaneBehavior:["type",ia],rootElementReferenceBehavior:["type",oa],spaceToolBehavior:["type",aa],subProcessPlaneBehavior:["type",da],subProcessStartEventBehavior:["type",fa],textAnnotationBehavior:["type",ma],toggleCollapseConnectionBehaviour:["type",va],toggleElementCollapseBehaviour:["type",ga],unclaimIdBehavior:["type",ya],unsetDefaultFlowBehavior:["type",ba],updateFlowNodeRefsBehavior:["type",_a],setCompensationActivityAfterPasteBehavior:["type",wa]};function ka(e,t){var n=(0,qt.vc)(e,t,-15);return"intersect"!==n?n:null}function Pa(e){Gt.call(this,e)}function Ta(e){return!e||(0,P.J2)(e)}function Aa(e){do{if((0,on.is)(e,"bpmn:Process"))return(0,on.Cf)(e);if((0,on.is)(e,"bpmn:Participant"))return(0,on.Cf)(e).processRef||(0,on.Cf)(e)}while(e=e.parent)}function ja(e){return(0,on.is)(e,"bpmn:TextAnnotation")}function Ba(e){return(0,on.is)(e,"bpmn:Group")&&!e.labelTarget}function Da(e){return(0,on.is)(e,"bpmn:BoundaryEvent")&&Fa(e,"bpmn:CompensateEventDefinition")}function Ra(e){return(0,on.Cf)(e).isForCompensation}function Ma(e){for(var t=e;t=t.parent;){if((0,on.is)(t,"bpmn:FlowElementsContainer"))return(0,on.Cf)(t);if((0,on.is)(t,"bpmn:Participant"))return(0,on.Cf)(t).processRef}return null}function Na(e,t){return Ma(e)===Ma(t)}function Fa(e,t){var n=(0,on.Cf)(e);return!!(0,h.I6)(n.eventDefinitions||[],function(e){return(0,on.is)(e,t)})}function La(e,t){return((0,on.Cf)(e).eventDefinitions||[]).every(function(e){return(0,on.is)(e,t)})}function Oa(e,t){var n=function(e){for(var t=[];e;)(e=e.parent)&&t.push(e);return t}(t);return-1!==n.indexOf(e)}function za(e,t,n){if(Ta(e)||Ta(t))return null;if(!(0,on.is)(n,"bpmn:DataAssociation")){if(Ya(e,t))return{type:"bpmn:MessageFlow"};if(es(e,t))return{type:"bpmn:SequenceFlow"}}var i=ts(e,t);return i||(Za(e,t)?{type:"bpmn:Association",associationDirection:"One"}:!!Ka(e,t)&&{type:"bpmn:Association",associationDirection:"None"})}function Ia(e,t){return!(!(0,P.J2)(e)&&!Ba(e))||!((0,on.is)(t,"bpmn:Participant")&&!(0,rn.Av)(t))&&((0,on.is)(e,"bpmn:Participant")?(0,on.is)(t,"bpmn:Process")||(0,on.is)(t,"bpmn:Collaboration"):(0,on.f7)(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:(0,on.is)(e,"bpmn:Lane")?(0,on.is)(t,"bpmn:Participant")||(0,on.is)(t,"bpmn:Lane"):!((0,on.is)(e,"bpmn:BoundaryEvent")&&(n=e,!(0,on.Cf)(n).cancelActivity||!Ja(n)&&!Ga(n)))&&((0,on.is)(e,"bpmn:FlowElement")&&!(0,on.is)(e,"bpmn:DataStoreReference")?(0,on.is)(t,"bpmn:FlowElementsContainer")?(0,rn.Av)(t):(0,on.f7)(t,["bpmn:Participant","bpmn:Lane"]):(0,on.is)(e,"bpmn:DataStoreReference")&&(0,on.is)(t,"bpmn:Collaboration")?(0,h.zN)((0,on.Cf)(t).get("participants"),function(e){return!!e.get("processRef")}):(0,on.f7)(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?(0,on.f7)(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):!!(0,on.is)(e,"bpmn:MessageFlow")&&((0,on.is)(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t)));var n}function $a(e){return(0,on.is)(e,"bpmn:Lane")}function Ha(e){return!!function(e){return!(0,P.J2)(e)&&(0,on.is)(e,"bpmn:BoundaryEvent")}(e)||(!(!(0,on.is)(e,"bpmn:IntermediateThrowEvent")||!Ja(e))||(0,on.is)(e,"bpmn:IntermediateCatchEvent")&&Ga(e))}function Ja(e){var t=(0,on.Cf)(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function Ga(e){return Ua(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function Ua(e,t){return t.some(function(t){return Fa(e,t)})}function Wa(e,t,n,i){if(Array.isArray(e)||(e=[e]),1!==e.length)return!1;var o=e[0];return!(0,P.J2)(o)&&(!!Ha(o)&&(!(0,rn.Q1)(t)&&(!(!(0,on.is)(t,"bpmn:Activity")||Ra(t))&&(!(i&&!ka(i,t))&&(!function(e){return(0,on.is)(e,"bpmn:ReceiveTask")&&(0,h.I6)(e.incoming,function(e){return(0,on.is)(e.source,"bpmn:EventBasedGateway")})}(t)&&"attach")))))}function Va(e,t,n){if(!t)return!1;var i={replacements:[]};return(0,h.jJ)(e,function(e){(0,rn.Q1)(t)||(0,on.is)(e,"bpmn:StartEvent")&&"label"!==e.type&&Ia(e,t)&&((0,rn.oh)(e)||i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),((0,rn.GM)(e)||(0,rn.ph)(e)||(0,rn.fP)(e))&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),Ua(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&(0,on.is)(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"})),(0,on.is)(t,"bpmn:Transaction")||Fa(e,"bpmn:CancelEventDefinition")&&"label"!==e.type&&((0,on.is)(e,"bpmn:EndEvent")&&Ia(e,t)&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:EndEvent"}),(0,on.is)(e,"bpmn:BoundaryEvent")&&Wa(e,t,0,n)&&i.replacements.push({oldElementId:e.id,newElementType:"bpmn:BoundaryEvent"}))}),!!i.replacements.length&&i}function qa(e,t){return!(0,h.zN)(e,$a)&&(!t||e.every(function(e){return Ia(e,t)}))}function Xa(e,t,n,i){return!!t&&(!(!(0,P.J2)(e)&&!Ba(e))||!function(e,t){return e===t}(n,t)&&((!n||!Oa(n,t))&&(Ia(e,t)||ns(e,t,i))))}function Qa(e,t){return(0,on.is)(e,"bpmn:SubProcess")?(0,rn.Av)(e)&&(!t||t.width>=100&&t.height>=80):!!(0,on.is)(e,"bpmn:Lane")||(!!(0,on.is)(e,"bpmn:Participant")||(!!ja(e)||!!Ba(e)))}function Ka(e,t){return!Oa(t,e)&&!Oa(e,t)&&(!!function(e,t){var n=ja(e),i=ja(t);return(n||i)&&n!==i}(e,t)||!!ts(e,t))}function Za(e,t){return Na(e,t)&&Da(e)&&(0,on.is)(t,"bpmn:Activity")&&(n=e,!t.attachers.includes(n))&&!(0,rn.Q1)(t);var n}function Ya(e,t){return!(os(e)&&!os(t))&&(n=e,(0,on.is)(n,"bpmn:InteractionNode")&&!(0,on.is)(n,"bpmn:BoundaryEvent")&&(!(0,on.is)(n,"bpmn:Event")||(0,on.is)(n,"bpmn:ThrowEvent")&&La(n,"bpmn:MessageEventDefinition"))&&function(e){return(0,on.is)(e,"bpmn:InteractionNode")&&!Ra(e)&&(!(0,on.is)(e,"bpmn:Event")||(0,on.is)(e,"bpmn:CatchEvent")&&La(e,"bpmn:MessageEventDefinition"))&&!((0,on.is)(e,"bpmn:BoundaryEvent")&&!Fa(e,"bpmn:MessageEventDefinition"))}(t)&&!function(e,t){return Aa(e)===Aa(t)}(e,t));var n}function es(e,t){return n=e,(0,on.is)(n,"bpmn:FlowNode")&&!(0,on.is)(n,"bpmn:EndEvent")&&!(0,rn.Q1)(n)&&!((0,on.is)(n,"bpmn:IntermediateThrowEvent")&&Fa(n,"bpmn:LinkEventDefinition"))&&!Da(n)&&!Ra(n)&&function(e){return(0,on.is)(e,"bpmn:FlowNode")&&!(0,on.is)(e,"bpmn:StartEvent")&&!(0,on.is)(e,"bpmn:BoundaryEvent")&&!(0,rn.Q1)(e)&&!((0,on.is)(e,"bpmn:IntermediateCatchEvent")&&Fa(e,"bpmn:LinkEventDefinition"))&&!Ra(e)}(t)&&Na(e,t)&&!((0,on.is)(e,"bpmn:EventBasedGateway")&&!function(e){return(0,on.is)(e,"bpmn:ReceiveTask")||(0,on.is)(e,"bpmn:IntermediateCatchEvent")&&(Fa(e,"bpmn:MessageEventDefinition")||Fa(e,"bpmn:TimerEventDefinition")||Fa(e,"bpmn:ConditionalEventDefinition")||Fa(e,"bpmn:SignalEventDefinition"))}(t));var n}function ts(e,t){return(0,on.f7)(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,on.f7)(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:!(!(0,on.f7)(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])||!(0,on.f7)(e,["bpmn:Activity","bpmn:CatchEvent"]))&&{type:"bpmn:DataOutputAssociation"}}function ns(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(1!==e.length)return!1;e=e[0]}return t.source!==e&&t.target!==e&&((0,on.f7)(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!(0,P.J2)(t)&&(0,on.is)(e,"bpmn:FlowNode")&&!(0,on.is)(e,"bpmn:BoundaryEvent")&&Ia(e,t.parent))}function is(e,t){return!!(0,P.J2)(t)||!((0,on.is)(t,"bpmn:Lane")&&!function(e,t){return e&&t&&-1!==e.indexOf(t)}(e,t.parent))}function os(e){return an(e,"bpmn:Process")||an(e,"bpmn:Collaboration")}(0,i.A)(Pa,Gt),Pa.$inject=["eventBus"],Pa.prototype.init=function(){this.addRule("connection.start",function(e){return function(e){if(Ta(e))return null;return(0,on.f7)(e,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}(e.source)}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},o=i.targetParent;if(i.targetAttach)return!1;o&&(n.parent=o);try{return za(t,n)}finally{o&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection;return za(e.source,e.target,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){return Qa(e.shape,e.newBounds)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return!((0,P.fX)(i)&&!ns(t,i,n))&&(0,h.Si)(t,function(e){return(0,P.fX)(e)?za(e.source,e.target,e):e.host?Wa(e,e.host,null,n):Xa(e,i,null,n)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position;return Wa(n,t,null,i)||Va(n,t,i)||qa(n,t)||ns(n,t,i)}),this.addRule("shape.create",function(e){return Xa(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return Wa(e.shape,e.target,null,e.position)}),this.addRule("element.copy",function(e){var t=e.element;return is(e.elements,t)})},Pa.prototype.canConnectMessageFlow=Ya,Pa.prototype.canConnectSequenceFlow=es,Pa.prototype.canConnectDataAssociation=ts,Pa.prototype.canConnectAssociation=Ka,Pa.prototype.canConnectCompensationAssociation=Za,Pa.prototype.canMove=qa,Pa.prototype.canAttach=Wa,Pa.prototype.canReplace=Va,Pa.prototype.canDrop=Ia,Pa.prototype.canInsert=ns,Pa.prototype.canCreate=Xa,Pa.prototype.canConnect=za,Pa.prototype.canResize=Qa,Pa.prototype.canCopy=is;const rs={__depends__:[Mn],__init__:["bpmnRules"],bpmnRules:["type",Pa]};function as(e,t){e.on("saveXML.start",2e3,function(){var e=t.getRootElements();(0,h.jJ)(e,function(e){var t,n,i=(0,on.S2)(e);t=(0,Ut.cZ)([e],!1),t=(0,h.pb)(t,function(t){return t!==e&&!t.labelTarget}),n=(0,h.Tj)(t,on.S2),i.set("planeElement",n)})})}as.$inject=["eventBus","canvas"];const ss={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",as]};function cs(e){Jt.A.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(e){var n=e.context,i=n.shape||n.connection,o=n.parent,r=t.getOrdering(i,o);r&&(void 0!==r.parent&&(n.parent=r.parent),n.parentIndex=r.index)}),this.preExecute(["shape.move","connection.move"],function(e){var n=e.context,i=n.shape||n.connection,o=n.newParent||i.parent,r=t.getOrdering(i,o);r&&(void 0!==r.parent&&(n.newParent=r.parent),n.newParentIndex=r.index)})}function ps(e,t){cs.call(this,e);var n=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:9,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:TextAnnotation",order:{level:9}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:FlowElementsContainer"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function i(e){var t=e.order;if(t||(e.order=t=function(e){if(e.labelTarget)return{level:10};var t=(0,h.I6)(n,function(t){return(0,on.f7)(e,[t.type])});return t&&t.order||{level:1}}(e)),!t)throw new Error("no order for <".concat(e.id,">"));return t}this.getOrdering=function(e,n){if(e.labelTarget||(0,on.is)(e,"bpmn:TextAnnotation"))return{parent:t.findRoot(n)||t.getRootElement(),index:-1};var o=i(e);o.containers&&(n=function(e,t,n){for(var i=t;i&&!(0,on.f7)(i,n);)i=i.parent;if(!i)throw new Error("no parent for <".concat(e.id,"> in <").concat(t&&t.id,">"));return i}(e,n,o.containers));var r=n.children.indexOf(e),a=(0,h.SL)(n.children,function(t){return!(!e.labelTarget&&t.labelTarget)&&o.level<i(t).level});return-1!==a&&-1!==r&&r<a&&(a-=1),{index:a,parent:n}}}cs.prototype.getOrdering=function(e,t){return null},(0,i.A)(cs,Jt.A),ps.$inject=["eventBus","canvas"],(0,i.A)(ps,cs);const ls={__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",ps]};function us(){}us.prototype.get=function(){return this._data},us.prototype.set=function(e){this._data=e},us.prototype.clear=function(){var e=this._data;return delete this._data,e},us.prototype.isEmpty=function(){return!this._data};const hs={clipboard:["type",us]};var ds="drop-ok",fs="drop-not-ok",ms="attach-ok",vs="new-parent",gs="create";function ys(e,t,n,i,o){function r(t,n){[ms,ds,fs,vs].forEach(function(i){i===n?e.addMarker(t,i):e.removeMarker(t,i)})}function a(){var e=t.context();e&&e.prefix===gs&&t.cancel()}n.on(["create.move","create.hover"],function(e){var t=e.context,n=t.elements,i=e.hover,a=t.source,s=t.hints||{};if(!i)return t.canExecute=!1,void(t.target=null);bs(e);var c={x:e.x,y:e.y},p=t.canExecute=i&&function(e,t,n,i,r){if(!t)return!1;e=(0,h.pb)(e,function(t){var n=t.labelTarget;return!t.parent&&!((0,P.J2)(t)&&-1!==e.indexOf(n))});var a=(0,h.I6)(e,function(e){return!(0,P.fX)(e)}),s=!1,c=!1,p=!1;_s(e)&&(s=o.allowed("shape.attach",{position:n,shape:a,target:t})),s||(p=_s(e)?o.allowed("shape.create",{position:n,shape:a,source:i,target:t}):o.allowed("elements.create",{elements:e,position:n,target:t}));var l=r.connectionTarget;return p||s?(a&&i&&(c=o.allowed("connection.create",{source:l===i?a:i,target:l===i?i:a,hints:{targetParent:t,targetAttach:s}})),{attach:s,connect:c}):(null===p||null===s)&&null}(n,i,c,a,s);i&&null!==p&&(t.target=i,p&&p.attach?r(i,ms):r(i,p?vs:fs))}),n.on(["create.end","create.out","create.cleanup"],function(e){var t=e.hover;t&&r(t,null)}),n.on("create.end",function(e){var t=e.context,n=t.source,o=t.shape,r=t.elements,a=t.target,s=t.canExecute,c=s&&s.attach,p=s&&s.connect,l=t.hints||{};if(!1===s||!a)return!1;bs(e);var u={x:e.x,y:e.y};p?o=i.appendShape(n,o,u,a,{attach:c,connection:!0===p?{}:p,connectionTarget:l.connectionTarget}):(r=i.createElements(r,u,a,(0,h.kp)({},l,{attach:c})),o=(0,h.I6)(r,function(e){return!(0,P.fX)(e)})),(0,h.kp)(t,{elements:r,shape:o}),(0,h.kp)(e,{elements:r,shape:o})}),n.on("create.init",function(){n.on("elements.changed",a),n.once(["create.cancel","create.end"],2e3,function(){n.off("elements.changed",a)})}),this.start=function(e,n,i){(0,h.cy)(n)||(n=[n]);var o=(0,h.I6)(n,function(e){return!(0,P.fX)(e)});if(o){i=(0,h.kp)({elements:n,hints:{},shape:o},i||{}),(0,h.jJ)(n,function(e){(0,h.Et)(e.x)||(e.x=0),(0,h.Et)(e.y)||(e.y=0)});var r=(0,h.pb)(n,function(e){return!e.hidden}),a=(0,Ut.U7)(r);(0,h.jJ)(n,function(e){(0,P.fX)(e)&&(e.waypoints=(0,h.Tj)(e.waypoints,function(e){return{x:e.x-a.x-a.width/2,y:e.y-a.y-a.height/2}})),(0,h.kp)(e,{x:e.x-a.x-a.width/2,y:e.y-a.y-a.height/2})}),t.init(e,gs,{cursor:"grabbing",autoActivate:!0,data:{shape:o,elements:n,context:i}})}}}function bs(e){var t=e.context.createConstraints;t&&(t.left&&(e.x=Math.max(e.x,t.left)),t.right&&(e.x=Math.min(e.x,t.right)),t.top&&(e.y=Math.max(e.y,t.top)),t.bottom&&(e.y=Math.min(e.y,t.bottom)))}function _s(e){return e&&1===e.length&&!(0,P.fX)(e[0])}ys.$inject=["canvas","dragging","eventBus","modeling","rules"];function xs(e,t,n,i,o){t.on("create.move",750,function(t){var r,a=t.hover,s=t.context,c=s.elements,p=s.dragGroup;p||(p=s.dragGroup=function(e){var t=(0,Fn.vt)("g");(0,Fn.CF)(t,o.cls("djs-drag-group",["no-events"]));var r=(0,Fn.vt)("g");return e.forEach(function(e){var o;e.hidden||(e.waypoints?(o=n._createContainer("connection",r),n.drawConnection((0,Gi.P)(o),e)):(o=n._createContainer("shape",r),n.drawShape((0,Gi.P)(o),e),(0,Ln.Tl)(o,e.x,e.y)),i.addDragger(e,t,o))}),t}(c)),a?(p.parentNode||(r=e.getActiveLayer(),(0,Fn.BC)(r,p)),(0,Ln.Tl)(p,t.x,t.y)):(0,Fn.TF)(p)}),t.on("create.cleanup",function(e){var t=e.context.dragGroup;t&&(0,Fn.TF)(t)})}xs.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];const ws={__depends__:[An,Xi,Mn,_n.A],__init__:["create","createPreview"],create:["type",ys],createPreview:["type",xs]};function Es(e){var t=this;function n(e){t._lastMoveEvent=e}this._lastMoveEvent=null,e.on("canvas.init",function(e){(t._svg=e.svg).addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}Es.$inject=["eventBus"],Es.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||function(e,t){var n=document.createEvent("MouseEvent"),i=e,o=t,r=e,a=t;n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,o,r,a,!1,!1,!1,!1,0,null);return n}(0,0)};const Ss={__init__:["mouse"],mouse:["type",Es]};function Cs(e,t,n,i,o,r,a,s){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=o,this._modeling=r,this._mouse=a,this._rules=s,o.on("copyPaste.copyElement",function(e){var t=e.descriptor,n=e.element,i=e.elements;t.priority=1,t.id=n.id;var o=(0,h.I6)(i,function(e){return e===n.parent});o&&(t.parent=n.parent.id),function(e){return!!e.host}(n)&&(t.priority=2,t.host=n.host.id),(0,P.fX)(n)&&(t.priority=3,t.source=n.source.id,t.target=n.target.id,t.waypoints=function(e){return(0,h.Tj)(e.waypoints,function(e){return(e=ks(e)).original&&(e.original=ks(e.original)),e})}(n)),(0,P.J2)(n)&&(t.priority=4,t.labelTarget=n.labelTarget.id),(0,h.jJ)(["x","y","width","height"],function(e){(0,h.Et)(n[e])&&(t[e]=n[e])}),t.hidden=n.hidden,t.collapsed=n.collapsed}),o.on("copyPaste.pasteElements",function(e){var t=e.hints;(0,h.kp)(t,{createElementsBehavior:!1})})}function ks(e){return(0,h.kp)({},e)}function Ps(e,t){var n=t.indexOf(e);return-1===n?t:t.splice(n,1)}Cs.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"],Cs.prototype.copy=function(e){var t,n;return(0,h.cy)(e)||(e=e?[e]:[]),n=!1===(t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}))?{}:this.createTree((0,h.cy)(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n},Cs.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}},Cs.prototype._paste=function(e,t,n,i){(0,h.jJ)(e,function(e){(0,h.Et)(e.x)||(e.x=0),(0,h.Et)(e.y)||(e.y=0)});var o=(0,Ut.U7)(e);return(0,h.jJ)(e,function(e){(0,P.fX)(e)&&(e.waypoints=(0,h.Tj)(e.waypoints,function(e){return{x:e.x-o.x-o.width/2,y:e.y-o.y-o.height/2}})),(0,h.kp)(e,{x:e.x-o.x-o.width/2,y:e.y-o.y-o.height/2})}),this._modeling.createElements(e,n,t,(0,h.kp)({},i))},Cs.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},o=[];return(0,h.jJ)(e,function(e,r){r=parseInt(r,10),e=(0,h.Ul)(e,"priority"),(0,h.jJ)(e,function(e){var r,a=(0,h.kp)({},(0,h.cJ)(e,["priority"]));return i[e.parent]?a.parent=i[e.parent]:delete a.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:a}),(0,P.fX)(a)?(a.source=i[e.source],a.target=i[e.target],r=i[e.id]=t.createConnection(a),void o.push(r)):(0,P.J2)(a)?(a.labelTarget=i[a.labelTarget],r=i[e.id]=t.createLabel(a),void o.push(r)):(a.host&&(a.host=i[a.host]),r=i[e.id]=t.createShape(a),void o.push(r))})}),o},Cs.prototype.createConnection=function(e){return this._elementFactory.createConnection((0,h.cJ)(e,["id"]))},Cs.prototype.createLabel=function(e){return this._elementFactory.createLabel((0,h.cJ)(e,["id"]))},Cs.prototype.createShape=function(e){return this._elementFactory.createShape((0,h.cJ)(e,["id"]))},Cs.prototype.hasRelations=function(e,t){var n,i;return!((0,P.fX)(e)&&(n=(0,h.I6)(t,(0,h.gH)({id:e.source.id})),i=(0,h.I6)(t,(0,h.gH)({id:e.target.id})),!n||!i))&&!((0,P.J2)(e)&&!(0,h.I6)(t,(0,h.gH)({id:e.labelTarget.id})))},Cs.prototype.createTree=function(e){var t=this._rules,n=this,i={},o=[],r=(0,Ut.wT)(e);function a(e,t){var n=(0,h.I6)(o,function(t){return e===t.element});n?n.depth<t&&(o=function(e,t){var n=t.indexOf(e);-1!==n&&t.splice(n,1);return t}(n,o)).push({element:n.element,depth:t}):o.push({element:e,depth:t})}return(0,Ut.qO)(r,function(e,t,i){if(!(0,P.J2)(e)){(0,h.jJ)(e.labels,function(e){a(e,i)}),(0,h.jJ)([e.attachers,e.incoming,e.outgoing],function(e){e&&e.length&&(0,h.jJ)(e,function(e){(0,h.jJ)(e.labels,function(e){a(e,i)}),a(e,i)})}),a(e,i);var o=[];return e.children&&(o=e.children.slice()),n._eventBus.fire("copyPaste.createTree",{element:e,children:o}),o}}),e=(0,h.Tj)(o,function(e){return e.element}),o=(0,h.Tj)(o,function(t){return t.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:t.descriptor,element:t.element,elements:e}),t}),o=(0,h.Ul)(o,function(e){return e.descriptor.priority}),e=(0,h.Tj)(o,function(e){return e.element}),(0,h.jJ)(o,function(o){var r=o.depth;n.hasRelations(o.element,e)?!function(e,n){return t.allowed("element.copy",{element:e,elements:n})}(o.element,e)?Ps(o.element,e):(i[r]||(i[r]=[]),i[r].push(o.descriptor)):Ps(o.element,e)}),i};const Ts={__depends__:[hs,ws,Ss,Mn],__init__:["copyPaste"],copyPaste:["type",Cs]};function As(e,t,n){(0,h.cy)(n)||(n=[n]),(0,h.jJ)(n,function(n){(0,h.b0)(e[n])||(t[n]=e[n])})}function js(e,t,n){function i(t,i){var o=e.create(t.$type);return n.copyElement(t,o,null,i)}t.on("copyPaste.copyElement",750,function(e){var t=e.descriptor,n=e.element,o=(0,on.Cf)(n);if((0,P.J2)(n))return t;var r=t.businessObject=i(o,!0),a=t.di=i((0,on.S2)(n),!0);a.bpmnElement=r,As(r,t,"name"),As(a,t,"isExpanded"),o.default&&(t.default=o.default.id)});var o="-bpmn-js-refs";t.on("copyPaste.pasteElement",function(e){var t=e.cache,n=e.descriptor,o=n.businessObject,r=n.di;if((0,P.J2)(n))return n.businessObject=(0,on.Cf)(t[n.labelTarget]),void(n.di=(0,on.S2)(t[n.labelTarget]));o=n.businessObject=i(o),(r=n.di=i(r)).bpmnElement=o,As(n,o,["isExpanded","name"]),n.type=o.$type}),t.on("copyPaste.copyElement",750,function(e){var t=e.descriptor,n=e.element;if((0,on.is)(n,"bpmn:Participant")){var o=(0,on.Cf)(n);o.processRef&&(t.processRef=i(o.processRef,!0))}}),t.on("copyPaste.pasteElement",function(e){var t=e.descriptor,n=t.processRef;n&&(t.processRef=i(n))}),t.on("copyPaste.pasteElement",750,function(e){var t=e.cache;!function(e,t){e[o]=t}(t,function(e,t,n){var i=(0,on.Cf)(e);return e.default&&(n[e.default]={element:i,property:"default"}),e.host&&((0,on.Cf)(e).attachedToRef=(0,on.Cf)(t[e.host])),(0,h.cJ)(n,(0,h.TS)(n,function(t,n,o){var r=n.element,a=n.property;return o===e.id&&(r.set(a,i),t.push(e.id)),t},[]))}(e.descriptor,t,function(e){return e[o]=e[o]||{}}(t)))})}js.$inject=["bpmnFactory","eventBus","moddleCopy"];const Bs=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing","categoryValue"],Ds=["errorRef","escalationRef","messageRef","signalRef"];function Rs(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",e=>{const{propertyNames:t}=e;if(t&&t.length)return(0,h.Ul)(t,e=>"extensionElements"===e)}),e.on("moddleCopy.canCopyProperty",e=>{const{parent:t,property:n,propertyName:i}=e,o=(0,h.Gv)(t)&&t.$descriptor;return i&&Ds.includes(i)?n:(!i||!Bs.includes(i))&&(!(i&&o&&!(0,h.I6)(o.properties,(0,h.gH)({name:i})))&&void 0)}),e.on("moddleCopy.canSetCopiedProperty",e=>{const{property:t}=e;if((0,on.is)(t,"bpmn:ExtensionElements")&&(!t.values||!t.values.length))return!1})}function Ms(e,t){return(0,h.TS)(e.properties,(e,n)=>t&&n.default?e:e.concat(n.name),[])}Rs.$inject=["eventBus","bpmnFactory","moddle"],Rs.prototype.copyElement=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n&&!(0,h.cy)(n)&&(n=[n]),n=n||Ms(e.$descriptor);const o=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t,clone:i});return!1===o||((0,h.cy)(o)&&(n=o),(0,h.jJ)(n,n=>{let o;(0,h.zy)(e,n)&&(o=e.get(n));const r=this.copyProperty(o,t,n,i);if(!(0,h.O9)(r))return;!1!==this._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:r,propertyName:n})&&t.set(n,r)})),t},Rs.prototype.copyProperty=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n,clone:i});if(!1===o)return;if(o)return(0,h.Gv)(o)&&o.$type&&!o.$parent&&(o.$parent=t),o;const r=this._moddle.getPropertyDescriptor(t,n);if(!r.isReference){if(r.isId)return e&&this._copyId(e,t,i);if((0,h.cy)(e))return(0,h.TS)(e,(e,o)=>{const r=this.copyProperty(o,t,n,i);return r?e.concat(r):e},[]);if((0,h.Gv)(e)&&e.$type){if(this._moddle.getElementDescriptor(e).isGeneric)return;return o=this._bpmnFactory.create(e.$type),o.$parent=t,o=this.copyElement(e,o,null,i),o}return e}},Rs.prototype._copyId=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e:this._moddle.ids.assigned(e)?void 0:(this._moddle.ids.claim(e,t),e)};const Ns={__depends__:[Ts],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",js],moddleCopy:["type",Rs]};var Fs=Math.round;function Ls(e,t){this._modeling=e,this._eventBus=t}function Os(e,t){t.on("replace.end",500,function(t){const{newElement:n,hints:i={}}=t;!1!==i.select&&e.select(n)})}Ls.$inject=["modeling","eventBus"],Ls.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,o=this._eventBus;o.fire("replace.start",{element:e,attrs:t,hints:n});var r=t.width||e.width,a=t.height||e.height,s=t.x||e.x,c=t.y||e.y,p=Fs(s+r/2),l=Fs(c+a/2),u=i.replaceShape(e,(0,h.kp)({},t,{x:p,y:l,width:r,height:a}),n);return o.fire("replace.end",{element:e,newElement:u,hints:n}),u},Os.$inject=["selection","eventBus"];const zs={__init__:["replace","replaceSelectionBehavior"],replaceSelectionBehavior:["type",Os],replace:["type",Ls]};var Is=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function $s(e,t,n,i,o,r){this.replaceElement=function(a,s,c){c=c||{};var p=s.type,l=a.businessObject;if(Hs(l)&&("bpmn:SubProcess"===p||"bpmn:AdHocSubProcess"===p)&&function(e,t){var n=e&&(0,h.zy)(e,"collapsed")?e.collapsed:!(0,rn.Av)(e);return n!==(t&&((0,h.zy)(t,"collapsed")||(0,h.zy)(t,"isExpanded"))?(0,h.zy)(t,"collapsed")?t.collapsed:!t.isExpanded:n)}(a,s))return i.toggleCollapse(a),a;var u=e.create(p),d={type:p,businessObject:u,di:{}};"bpmn:ExclusiveGateway"===p&&(d.di.isMarkerVisible=!0),function(e,t,n){(0,h.cy)(n)||(n=[n]),(0,h.jJ)(n,function(n){(0,h.b0)(e[n])||(t[n]=e[n])})}(a.di,d.di,["fill","stroke","background-color","border-color","color"]);var f=function(e,t){return e.filter(function(e){return t.includes(e)})}(Ms(l.$descriptor),Ms(u.$descriptor,!0));(0,h.kp)(u,(0,h.Up)(s,Is));var m=(0,h.pb)(f,function(e){return"eventDefinitions"===e?Js(a,s.eventDefinitionType):"loopCharacteristics"===e?!(0,rn.Q1)(u):!(0,h.zy)(u,e)&&(("processRef"!==e||!1!==s.isExpanded)&&("triggeredByEvent"!==e&&("isForCompensation"!==e||!(0,rn.Q1)(u))))});if(u=n.copyElement(l,u,m),s.eventDefinitionType&&(Js(u,s.eventDefinitionType)||(d.eventDefinitionType=s.eventDefinitionType,d.eventDefinitionAttrs=s.eventDefinitionAttrs)),(0,on.is)(l,"bpmn:Activity")){if(Hs(l))d.isExpanded=(0,rn.Av)(a);else if(s&&(0,h.zy)(s,"isExpanded")){d.isExpanded=s.isExpanded;var v=t.getDefaultSize(u,{isExpanded:d.isExpanded});d.width=v.width,d.height=v.height,d.x=a.x-(d.width-a.width)/2,d.y=a.y-(d.height-a.height)/2}(0,rn.Av)(a)&&!(0,on.is)(l,"bpmn:Task")&&d.isExpanded&&(d.width=a.width,d.height=a.height)}if(Hs(l)&&!Hs(u)&&(c.moveChildren=!1),(0,on.is)(l,"bpmn:Participant")){!0===s.isExpanded?u.processRef=e.create("bpmn:Process"):c.moveChildren=!1;var g=(0,rn.$b)(a);(0,on.S2)(a).isHorizontal||((0,on.S2)(d).isHorizontal=g),d.width=g?a.width:t.getDefaultSize(d).width,d.height=g?t.getDefaultSize(d).height:a.height}return r.allowed("shape.resize",{shape:u})||(d.height=t.getDefaultSize(d).height,d.width=t.getDefaultSize(d).width),u.name=l.name,(0,on.f7)(l,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(0,on.f7)(u,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(u.default=l.default),s.host&&!(0,on.is)(l,"bpmn:BoundaryEvent")&&(0,on.is)(u,"bpmn:BoundaryEvent")&&(d.host=s.host),"bpmn:DataStoreReference"!==d.type&&"bpmn:DataObjectReference"!==d.type||(d.x=a.x+(a.width-d.width)/2),o.replaceElement(a,d,(0,J.A)((0,J.A)({},c),{},{targetElement:s}))}}function Hs(e){return(0,on.is)(e,"bpmn:SubProcess")}function Js(e,t){var n=(0,on.Cf)(e);return t&&n.get("eventDefinitions").some(function(e){return(0,on.is)(e,t)})}$s.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules"];const Gs={__depends__:[Ns,zs,_n.A],bpmnReplace:["type",$s]};function Us(e){this._eventBus=e,this._tools=[],this._active=null}Us.$inject=["eventBus"],Us.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error('A tool has to be registered with it\'s "events"');n.push(e),this.bindEvents(e,t)},Us.prototype.isActive=function(e){return e&&this._active===e},Us.prototype.length=function(e){return this._tools.length},Us.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))},Us.prototype.bindEvents=function(e,t){var n=this._eventBus,i=[];n.on(t.tool+".init",function(t){t.context.reactivate||!this.isActive(e)?this.setActive(e):this.setActive(null)},this),(0,h.jJ)(t,function(e){i.push(e+".ended"),i.push(e+".canceled")}),n.on(i,250,function(e){this._active&&(function(e){var t=e.originalEvent&&e.originalEvent.target;return t&&(0,C.kp)(t,'.group[data-group="tools"]')}(e)||this.setActive(null))},this)};const Ws={__depends__:[An],__init__:["toolManager"],toolManager:["type",Us]};function Vs(e,t){return-1!==e.indexOf(t)}var qs=Math.abs,Xs=Math.round,Qs={x:"width",y:"height"},Ks="crosshair",Zs={n:"top",w:"left",s:"bottom",e:"right"},Ys={n:"s",w:"e",s:"n",e:"w"};function ec(e,t,n,i,o,r,a){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=o,this._toolManager=r,this._mouse=a;var s=this;r.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(e){n.once("spaceTool.selection.ended",function(){s.activateMakeSpace(e.originalEvent)})}),n.on("spaceTool.move",1500,function(e){var t=e.context,n=t.initialized;n||(n=t.initialized=s.init(e,t)),n&&nc(e)}),n.on("spaceTool.end",function(e){var t=e.context,i=t.axis,o=t.direction,r=t.movingShapes,a=t.resizingShapes,c=t.start;if(t.initialized){nc(e);var p={x:0,y:0};p[i]=Xs(e["d"+i]),s.makeSpace(r,a,p,o,c),n.once("spaceTool.ended",function(e){s.activateSelection(e.originalEvent,!0,!0)})}})}function tc(e){return{top:e.top-20,right:e.right+20,bottom:e.bottom+20,left:e.left-20}}function nc(e){var t,n,i=e.context.spaceToolConstraints;i&&((0,h.Et)(i.left)&&(t=Math.max(e.x,i.left),e.dx=e.dx+t-e.x,e.x=t),(0,h.Et)(i.right)&&(t=Math.min(e.x,i.right),e.dx=e.dx+t-e.x,e.x=t),(0,h.Et)(i.top)&&(n=Math.max(e.y,i.top),e.dy=e.dy+n-e.y,e.y=n),(0,h.Et)(i.bottom)&&(n=Math.min(e.y,i.bottom),e.dy=e.dy+n-e.y,e.y=n))}function ic(e,t){return-1!==e.indexOf(t)}ec.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"],ec.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:Ks,data:{context:{reactivate:n}},trapClick:!1})},ec.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:Ks,data:{context:{}}})},ec.prototype.makeSpace=function(e,t,n,i,o){return this._modeling.createSpace(e,t,n,i,o)},ec.prototype.init=function(e,t){var n=qs(e.dx)>qs(e.dy)?"x":"y",i=e["d"+n],o=e[n]-i;if(qs(i)<5)return!1;i<0&&(i*=-1),(0,ti.Io)(e)&&(i*=-1);var r=function(e,t){if("x"===e){if(t>0)return"e";if(t<0)return"w"}if("y"===e){if(t>0)return"s";if(t<0)return"n"}return null}(n,i),a=this._canvas.getRootElement();!(0,ti.KH)(e)&&e.hover&&(a=e.hover);var s=[...(0,Ut.cZ)(a,!0),...a.attachers||[]],c=this.calculateAdjustments(s,n,i,o),p=function(e,t,n,i,o){var r=e.movingShapes,a=e.resizingShapes;if(!a.length)return;var s,c,p={};return(0,h.jJ)(a,function(e){var l,u,d,f,m,v,g=e.attachers,y=e.children,b=(0,qt.Fy)(e),_=(0,h.pb)(y,function(e){return!(0,P.fX)(e)&&!(0,P.J2)(e)&&!ic(r,e)&&!ic(a,e)}),x=(0,h.pb)(y,function(e){return!(0,P.fX)(e)&&!(0,P.J2)(e)&&ic(r,e)}),w=[],E=[];_.length&&(u=tc((0,qt.Fy)((0,Ut.U7)(_))),l=i-b[Zs[n]]+u[Zs[n]],"n"===n?p.bottom=c=(0,h.Et)(c)?Math.min(c,l):l:"w"===n?p.right=c=(0,h.Et)(c)?Math.min(c,l):l:"s"===n?p.top=s=(0,h.Et)(s)?Math.max(s,l):l:"e"===n&&(p.left=s=(0,h.Et)(s)?Math.max(s,l):l)),x.length&&(d=tc((0,qt.Fy)((0,Ut.U7)(x))),l=i-d[Zs[Ys[n]]]+b[Zs[Ys[n]]],"n"===n?p.bottom=c=(0,h.Et)(c)?Math.min(c,l):l:"w"===n?p.right=c=(0,h.Et)(c)?Math.min(c,l):l:"s"===n?p.top=s=(0,h.Et)(s)?Math.max(s,l):l:"e"===n&&(p.left=s=(0,h.Et)(s)?Math.max(s,l):l)),g&&g.length&&(g.forEach(function(e){ic(r,e)?w.push(e):E.push(e)}),w.length&&(f=(0,qt.Fy)((0,Ut.U7)(w.map(qt.pp))),m=b[Zs[Ys[n]]]-(f[Zs[Ys[n]]]-i)),E.length&&(v=(0,qt.Fy)((0,Ut.U7)(E.map(qt.pp)))[Zs[n]]-(b[Zs[n]]-i)),"n"===n?(l=Math.min(m||1/0,v||1/0),p.bottom=c=(0,h.Et)(c)?Math.min(c,l):l):"w"===n?(l=Math.min(m||1/0,v||1/0),p.right=c=(0,h.Et)(c)?Math.min(c,l):l):"s"===n?(l=Math.max(m||-1/0,v||-1/0),p.top=s=(0,h.Et)(s)?Math.max(s,l):l):"e"===n&&(l=Math.max(m||-1/0,v||-1/0),p.left=s=(0,h.Et)(s)?Math.max(s,l):l));var S=o&&o[e.id];S&&("n"===n?(l=i+e[Qs[t]]-S[Qs[t]],p.bottom=c=(0,h.Et)(c)?Math.min(c,l):l):"w"===n?(l=i+e[Qs[t]]-S[Qs[t]],p.right=c=(0,h.Et)(c)?Math.min(c,l):l):"s"===n?(l=i-e[Qs[t]]+S[Qs[t]],p.top=s=(0,h.Et)(s)?Math.max(s,l):l):"e"===n&&(l=i-e[Qs[t]]+S[Qs[t]],p.left=s=(0,h.Et)(s)?Math.max(s,l):l))}),p}(c,n,r,o,this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:r,shapes:c.resizingShapes,start:o}));return(0,h.kp)(t,c,{axis:n,direction:r,spaceToolConstraints:p,start:o}),(0,xn.hZ)("resize-"+("x"===n?"ew":"ns")),!0},ec.prototype.calculateAdjustments=function(e,t,n,i){var o=this._rules,r=[],a=[],s=[],c=[];function p(e){r.includes(e)||r.push(e);var t=e.label;t&&!r.includes(t)&&r.push(t)}(0,h.jJ)(e,function(e){if(e.parent&&!(0,P.J2)(e))if((0,P.fX)(e))c.push(e);else{var r=e[t],l=r+e[Qs[t]];if(function(e){return!!e.host}(e)&&(n>0&&(0,qt.pp)(e)[t]>i||n<0&&(0,qt.pp)(e)[t]<i))s.push(e);else{var u;if(!(n>0&&r>i||n<0&&l<i))return r<i&&l>i&&o.allowed("shape.resize",{shape:e})?(u=e,void(a.includes(u)||a.push(u))):void 0;p(e)}}}),(0,h.jJ)(r,function(e){var t=e.attachers;t&&(0,h.jJ)(t,function(e){p(e)})});var l=r.concat(a);return(0,h.jJ)(s,function(e){var t=e.host;ic(l,t)&&p(e)}),l=r.concat(a),(0,h.jJ)(c,function(e){var t=e.source,n=e.target,i=e.label;ic(l,t)&&ic(l,n)&&i&&p(i)}),{movingShapes:r,resizingShapes:a}},ec.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)},ec.prototype.isActive=function(){var e=this._dragging.context();return!!e&&/^spaceTool/.test(e.prefix)};var oc="djs-dragging",rc="djs-resizing",ac=Math.max;function sc(e,t,n,i,o){function r(e,t){(0,h.jJ)(e,function(e){o.addDragger(e,t),n.addMarker(e,oc)})}e.on("spaceTool.selection.start",function(e){var t=n.getLayer("space"),o=e.context,r="M 0,-10000 L 0,10000",a="M -10000,0 L 10000,0",s=(0,Fn.vt)("g");(0,Fn.CF)(s,i.cls("djs-crosshair-group",["no-events"])),(0,Fn.BC)(t,s);var c=(0,Fn.vt)("path");(0,Fn.CF)(c,"d",r),(0,Fn.Ly)(c).add("djs-crosshair"),(0,Fn.BC)(s,c);var p=(0,Fn.vt)("path");(0,Fn.CF)(p,"d",a),(0,Fn.Ly)(p).add("djs-crosshair"),(0,Fn.BC)(s,p),o.crosshairGroup=s}),e.on("spaceTool.selection.move",function(e){var t=e.context.crosshairGroup;(0,Ln.Tl)(t,e.x,e.y)}),e.on("spaceTool.selection.cleanup",function(e){var t=e.context.crosshairGroup;t&&(0,Fn.TF)(t)}),e.on("spaceTool.move",250,function(e){var a=e.context,s=a.line,c=a.axis,p=a.movingShapes,l=a.resizingShapes;if(a.initialized){if(!a.dragGroup){var u=n.getLayer("space");s=(0,Fn.vt)("path"),(0,Fn.CF)(s,"d","M0,0 L0,0"),(0,Fn.Ly)(s).add("djs-crosshair"),(0,Fn.BC)(u,s),a.line=s;var d=(0,Fn.vt)("g");(0,Fn.CF)(d,i.cls("djs-drag-group",["no-events"])),(0,Fn.BC)(n.getActiveLayer(),d),r(p,d),r(a.movingConnections=t.filter(function(e){var t=!1;(0,h.jJ)(p,function(n){(0,h.jJ)(n.outgoing,function(n){e===n&&(t=!0)})});var n=!1;(0,h.jJ)(p,function(t){(0,h.jJ)(t.incoming,function(t){e===t&&(n=!0)})});var i=!1;(0,h.jJ)(l,function(t){(0,h.jJ)(t.outgoing,function(t){e===t&&(i=!0)})});var o=!1;return(0,h.jJ)(l,function(t){(0,h.jJ)(t.incoming,function(t){e===t&&(o=!0)})}),(0,P.fX)(e)&&(t||i)&&(n||o)}),d),a.dragGroup=d}if(!a.frameGroup){var f=(0,Fn.vt)("g");(0,Fn.CF)(f,i.cls("djs-frame-group",["no-events"])),(0,Fn.BC)(n.getActiveLayer(),f);var m=[];(0,h.jJ)(l,function(e){var t=o.addFrame(e,f),i=t.getBBox();m.push({element:t,initialBounds:i}),n.addMarker(e,rc)}),a.frameGroup=f,a.frames=m}var v={x:"M"+e.x+", -10000 L"+e.x+", 10000",y:"M -10000, "+e.y+" L 10000, "+e.y};(0,Fn.CF)(s,{d:v[c]});var g={x:e.dx,y:e.dy};g[{x:"y",y:"x"}[a.axis]]=0,(0,Ln.Tl)(a.dragGroup,g.x,g.y),(0,h.jJ)(a.frames,function(e){var t,n,i=e.element,o=e.initialBounds;"e"===a.direction?(0,Fn.CF)(i,{width:ac(o.width+g.x,5)}):(t=ac(o.width-g.x,5),(0,Fn.CF)(i,{width:t,x:o.x+o.width-t})),"s"===a.direction?(0,Fn.CF)(i,{height:ac(o.height+g.y,5)}):(n=ac(o.height-g.y,5),(0,Fn.CF)(i,{height:n,y:o.y+o.height-n}))})}}),e.on("spaceTool.cleanup",function(e){var t=e.context,i=t.movingShapes,o=t.movingConnections,r=t.resizingShapes,a=t.line,s=t.dragGroup,c=t.frameGroup;(0,h.jJ)(i,function(e){n.removeMarker(e,oc)}),(0,h.jJ)(o,function(e){n.removeMarker(e,oc)}),s&&((0,Fn.TF)(a),(0,Fn.TF)(s)),(0,h.jJ)(r,function(e){n.removeMarker(e,rc)}),c&&(0,Fn.TF)(c)})}sc.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];const cc={__init__:["spaceToolPreview"],__depends__:[An,Mn,Ws,Xi,Ss],spaceTool:["type",ec],spaceToolPreview:["type",sc]};function pc(e,t){e.invoke(ec,this),this._canvas=t}pc.$inject=["injector","canvas"],(0,i.A)(pc,ec),pc.prototype.calculateAdjustments=function(e,t,n,i){var o=this._canvas.getRootElement(),r=e[0]===o?null:e[0],a=[];r&&(a=(0,h.zu)((0,Ut.rx)(o.children.filter(e=>(0,on.is)(e,"bpmn:Artifact")),(0,Ut.U7)(r))));const s=[...e,...a];var c=ec.prototype.calculateAdjustments.call(this,s,t,n,i);return c.resizingShapes=c.resizingShapes.filter(function(e){return!(0,on.is)(e,"bpmn:TextAnnotation")&&(!function(e){return(0,on.is)(e,"bpmn:Participant")&&!(0,on.Cf)(e).processRef}(e)||!("y"===t&&(0,rn.$b)(e)||"x"===t&&!(0,rn.$b)(e)))}),c};const lc={__depends__:[cc],spaceTool:["type",pc]};function uc(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}uc.$inject=["eventBus","injector"],uc.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";const n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction()},uc.prototype.canExecute=function(e,t){const n={command:e,context:t},i=this._getHandler(e);let o=this._fire(e,"canExecute",n);if(void 0===o){if(!i)return!1;i.canExecute&&(o=i.canExecute(t))}return o},uc.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,!1!==e&&this._fire("changed",{trigger:"clear"})},uc.prototype.undo=function(){let e,t=this._getUndoAction();if(t){for(this._currentExecution.trigger="undo",this._pushAction(t);t&&(this._internalUndo(t),e=this._getUndoAction(),e&&e.id===t.id);)t=e;this._popAction()}},uc.prototype.redo=function(){let e,t=this._getRedoAction();if(t){for(this._currentExecution.trigger="redo",this._pushAction(t);t&&(this._internalExecute(t,!0),e=this._getRedoAction(),e&&e.id===t.id);)t=e;this._popAction()}},uc.prototype.register=function(e,t){this._setHandler(e,t)},uc.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");const n=this._injector.instantiate(t);this.register(e,n)},uc.prototype.canUndo=function(){return!!this._getUndoAction()},uc.prototype.canRedo=function(){return!!this._getRedoAction()},uc.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},uc.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},uc.prototype._internalUndo=function(e){const t=e.command,n=e.context,i=this._getHandler(t);this._atomicDo(()=>{this._fire(t,"revert",e),i.revert&&this._markDirty(i.revert(n)),this._revertedAction(e),this._fire(t,"reverted",e)})},uc.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);const i=t?[e+"."+t,t]:[e];let o;n=this._eventBus.createEvent(n);for(const r of i)if(o=this._eventBus.fire("commandStack."+r,n),n.cancelBubble)break;return o},uc.prototype._createId=function(){return this._uid++},uc.prototype._atomicDo=function(e){const t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}},uc.prototype._internalExecute=function(e,t){const n=e.command,i=e.context,o=this._getHandler(n);if(!o)throw new Error("no command handler registered for <"+n+">");this._pushAction(e),t||(this._fire(n,"preExecute",e),o.preExecute&&o.preExecute(i),this._fire(n,"preExecuted",e)),this._atomicDo(()=>{this._fire(n,"execute",e),o.execute&&this._markDirty(o.execute(i)),this._executedAction(e,t),this._fire(n,"executed",e)}),t||(this._fire(n,"postExecute",e),o.postExecute&&o.postExecute(i),this._fire(n,"postExecuted",e)),this._popAction()},uc.prototype._pushAction=function(e){const t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)},uc.prototype._popAction=function(){const e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:(0,h.pD)("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)},uc.prototype._markDirty=function(e){const t=this._currentExecution;e&&(e=(0,h.cy)(e)?e:[e],t.dirty=t.dirty.concat(e))},uc.prototype._executedAction=function(e,t){const n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)},uc.prototype._revertedAction=function(e){this._stackIdx--},uc.prototype._getHandler=function(e){return this._handlerMap[e]},uc.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};const hc={commandStack:["type",uc]};function dc(e,t){if("function"!==typeof t)throw new Error("removeFn iterator must be a function");if(e){for(var n;n=e[0];)t(n);return e}}function fc(e,t,n){Jt.A.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",1400,function(e){var t=e.context,n=t.shapes,i=t.validatedShapes;t.shapes=mc(n),t.validatedShapes=mc(i)}),i&&t.on("shape.move.start",250,function(e){var t=e.context,n=t.shapes,o=[];(0,h.jJ)(n,function(e){(0,h.jJ)(e.labels,function(n){n.hidden||-1!==t.shapes.indexOf(n)||o.push(n),e.labelTarget&&o.push(e)})}),(0,h.jJ)(o,function(e){i.makeDraggable(t,e,!0)})}),this.preExecuted("elements.move",1400,function(e){var t=e.context.closure,n=t.enclosedElements,i=[];(0,h.jJ)(n,function(e){(0,h.jJ)(e.labels,function(e){n[e.id]||i.push(e)})}),t.addAll(i)}),this.preExecute(["connection.delete","shape.delete"],function(e){var t=e.context;dc((t.connection||t.shape).labels,function(e){n.removeShape(e,{nested:!0})})}),this.execute("shape.delete",function(e){var t=e.context,n=t.shape,i=n.labelTarget;i&&(t.labelTargetIndex=(0,_o.qh)(i.labels,n),t.labelTarget=i,n.labelTarget=null)}),this.revert("shape.delete",function(e){var t=e.context,n=t.shape,i=t.labelTarget,o=t.labelTargetIndex;i&&((0,_o.WQ)(i.labels,n,o),n.labelTarget=i)})}function mc(e){return(0,h.pb)(e,function(t){return-1===e.indexOf(t.labelTarget)})}(0,i.A)(fc,Jt.A),fc.$inject=["injector","eventBus","modeling"];const vc={__init__:["labelSupport"],labelSupport:["type",fc]};var gc="attach-ok";function yc(e,t,n,i,o){Jt.A.call(this,t);var r=e.get("movePreview",!1);t.on("shape.move.start",1401,function(e){var t=e.context,n=t.shapes,i=t.validatedShapes;t.shapes=function(e){var t=bc(e);return(0,h.RK)("id",e,t)}(n),t.validatedShapes=function(e){var t=(0,h.$z)(e,"id");return(0,h.pb)(e,function(e){for(;e;){if(e.host&&t[e.host.id])return!1;e=e.parent}return!0})}(i)}),r&&t.on("shape.move.start",251,function(e){var t=e.context,n=bc(t.shapes);(0,h.jJ)(n,function(e){r.makeDraggable(t,e,!0),(0,h.jJ)(e.labels,function(e){r.makeDraggable(t,e,!0)})})}),r&&t.on("shape.move.start",function(e){var i=e.context.shapes;if(1===i.length){var o=i[0].host;o&&(n.addMarker(o,gc),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(o,gc)}))}}),this.preExecuted("elements.move",1401,function(e){var t=e.context,n=t.closure,i=bc(t.shapes);(0,h.jJ)(i,function(e){n.add(e,n.topLevel[e.host.id])})}),this.postExecuted("elements.move",function(e){var t,n=e.context,i=n.shapes,r=n.newHost;r&&1!==i.length||(t=r?i:(0,h.pb)(i,function(e){var t,n=e.host;return function(e){return!!e.host}(e)&&(t=n,!(-1!==i.indexOf(t)))}),(0,h.jJ)(t,function(e){o.updateAttachment(e,r)}))}),this.postExecuted("elements.move",function(e){var t=e.context.shapes;(0,h.jJ)(t,function(e){(0,h.jJ)(e.attachers,function(e){(0,h.jJ)(e.outgoing.slice(),function(e){i.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||o.removeConnection(e)}),(0,h.jJ)(e.incoming.slice(),function(e){i.allowed("connection.reconnect",{connection:e,source:e.source,target:e.target})||o.removeConnection(e)})})})}),this.postExecute("shape.create",function(e){var t=e.context,n=t.shape,i=t.host;i&&o.updateAttachment(n,i)}),this.postExecute("shape.replace",function(e){var t=e.context,n=t.oldShape,r=t.newShape;dc(n.attachers,function(e){"attach"===i.allowed("elements.move",{target:r,shapes:[e]})?o.updateAttachment(e,r):o.removeShape(e)}),r.attachers.length&&(0,h.jJ)(r.attachers,function(e){var t=gr(e,n,r);o.moveShape(e,t,e.parent)})}),this.postExecute("shape.resize",function(e){var t=e.context,n=t.shape,i=t.oldBounds,r=t.newBounds,a=n.attachers;!1!==(t.hints||{}).attachSupport&&(0,h.jJ)(a,function(e){var t=gr(e,i,r);o.moveShape(e,t,e.parent),(0,h.jJ)(e.labels,function(e){o.moveShape(e,t,e.parent)})})}),this.preExecute("shape.delete",function(e){var t=e.context.shape;dc(t.attachers,function(e){o.removeShape(e)}),t.host&&o.updateAttachment(t,null)})}function bc(e){return(0,h.Bq)((0,h.Tj)(e,function(e){return e.attachers||[]}))}(0,i.A)(yc,Jt.A),yc.$inject=["injector","eventBus","canvas","rules","modeling"];const _c={__depends__:[Mn],__init__:["attachSupport"],attachSupport:["type",yc]};var xc=n(31868);function wc(e){this._model=e}function Ec(e,t,n){Jt.A.call(this,e),this._bpmnFactory=t;var i=this;function o(e){var t=e.context.oldRoot.children;(0,h.jJ)(t,function(e){(0,on.is)(e,"bpmn:BaseElement")&&i.updateParent(e)})}function r(e){var t=e.context.shape;(0,on.is)(t,"bpmn:BaseElement")&&i.updateBounds(t)}function a(e){i.updateConnection(e.context)}function s(e){i.updateConnectionWaypoints(e.context.connection)}function c(e){i.updateAttachment(e.context)}function p(e){const{element:n}=e.context,i=(0,Yi.p9)(n),o=(0,on.S2)(n),r=o&&o.get("label");(0,Yi.UC)(n)||(0,la.hC)(n)||(i&&!r?o.set("label",t.create("bpmndi:BPMNLabel")):!i&&r&&o.set("label",void 0))}this.executed(["connection.layout","connection.create"],function(e){var t,i=e.context,o=i.hints||{};i.cropped||!1===o.createElementsBehavior||((t=i.connection).waypoints=n.getCroppedWaypoints(t),i.cropped=!0)}),this.reverted(["connection.layout"],function(e){delete e.context.cropped}),this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Sc(function(e){var t=e.context;i.updateParent(t.shape||t.connection,t.oldParent)})),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Sc(function(e){var t=e.context,n=t.shape||t.connection,o=t.parent||t.newParent;i.updateParent(n,o)})),this.executed(["canvas.updateRoot"],o),this.reverted(["canvas.updateRoot"],o),this.executed(["shape.move","shape.create","shape.resize"],Sc(function(e){"label"!==e.context.shape.type&&r(e)})),this.reverted(["shape.move","shape.create","shape.resize"],Sc(function(e){"label"!==e.context.shape.type&&r(e)})),e.on("shape.changed",function(e){"label"===e.element.type&&r({context:{shape:e.element}})}),this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],Sc(a)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],Sc(a)),this.executed(["connection.layout","connection.move","connection.updateWaypoints"],Sc(s)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],Sc(s)),this.executed("connection.reconnect",Sc(function(e){var t=e.context,n=t.connection,i=t.oldSource,o=t.newSource,r=(0,on.Cf)(n),a=(0,on.Cf)(i),s=(0,on.Cf)(o);r.conditionExpression&&!(0,on.f7)(s,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(t.oldConditionExpression=r.conditionExpression,delete r.conditionExpression),i!==o&&a.default===r&&(t.oldDefault=a.default,delete a.default)})),this.reverted("connection.reconnect",Sc(function(e){var t=e.context,n=t.connection,i=t.oldSource,o=t.newSource,r=(0,on.Cf)(n),a=(0,on.Cf)(i),s=(0,on.Cf)(o);t.oldConditionExpression&&(r.conditionExpression=t.oldConditionExpression),t.oldDefault&&(a.default=t.oldDefault,delete s.default)})),this.executed(["element.updateAttachment"],Sc(c)),this.reverted(["element.updateAttachment"],Sc(c)),this.executed("element.updateLabel",Sc(p)),this.reverted("element.updateLabel",Sc(p))}function Sc(e){return function(t){var n=t.context,i=n.shape||n.connection||n.element;(0,on.is)(i,"bpmn:BaseElement")&&e(t)}}wc.$inject=["moddle"],wc.prototype._needsId=function(e){return(0,on.f7)(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])},wc.prototype._ensureId=function(e){var t;e.id?this._model.ids.claim(e.id,e):(t=(0,on.is)(e,"bpmn:Activity")?"Activity":(0,on.is)(e,"bpmn:Event")?"Event":(0,on.is)(e,"bpmn:Gateway")?"Gateway":(0,on.f7)(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?"Flow":(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e)))},wc.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n},wc.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})},wc.prototype.createDiShape=function(e,t){return this.create("bpmndi:BPMNShape",(0,h.kp)({bpmnElement:e,bounds:this.createDiBounds()},t))},wc.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},wc.prototype.createDiWaypoints=function(e){var t=this;return(0,h.Tj)(e,function(e){return t.createDiWaypoint(e)})},wc.prototype.createDiWaypoint=function(e){return this.create("dc:Point",(0,h.Up)(e,["x","y"]))},wc.prototype.createDiEdge=function(e,t){return this.create("bpmndi:BPMNEdge",(0,h.kp)({bpmnElement:e,waypoint:this.createDiWaypoints([])},t))},wc.prototype.createDiPlane=function(e,t){return this.create("bpmndi:BPMNPlane",(0,h.kp)({bpmnElement:e},t))},(0,i.A)(Ec,Jt.A),Ec.$inject=["eventBus","bpmnFactory","connectionDocking"],Ec.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject},Ec.prototype.updateParent=function(e,t){if(!(0,P.J2)(e)&&!((0,on.is)(e,"bpmn:DataStoreReference")&&e.parent&&(0,on.is)(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,o=(0,on.S2)(e),r=n&&n.businessObject,a=(0,on.S2)(n);(0,on.is)(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,r,t&&t.businessObject),(0,on.is)(e,"bpmn:DataOutputAssociation")&&(r=e.source?e.source.businessObject:null),(0,on.is)(e,"bpmn:DataInputAssociation")&&(r=e.target?e.target.businessObject:null),this.updateSemanticParent(i,r),(0,on.is)(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,r),this.updateDiParent(o,a)}},Ec.prototype.updateBounds=function(e){var t=(0,on.S2)(e),n=function(e){if(!(0,on.is)(e,"bpmn:Activity"))return;var t=(0,on.S2)(e);if(!t)return;var n=t.get("label");if(!n)return;return n.get("bounds")}(e);if(n){var i=(0,En.p)(n,t.get("bounds"));(0,h.kp)(n,{x:e.x+i.x,y:e.y+i.y})}var o=(0,P.J2)(e)?this._getLabel(t):t,r=o.bounds;r||(r=this._bpmnFactory.createDiBounds(),o.set("bounds",r)),(0,h.kp)(r,{x:e.x,y:e.y,width:e.width,height:e.height})},Ec.prototype.updateFlowNodeRefs=function(e,t,n){var i,o;n!==t&&((0,on.is)(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),(0,_o.TF)(i,e)),(0,on.is)(t,"bpmn:Lane")&&(o=t.get("flowNodeRef"),(0,_o.WQ)(o,e)))},Ec.prototype.updateDiConnection=function(e,t,n){var i=(0,on.S2)(e),o=(0,on.S2)(t),r=(0,on.S2)(n);i.sourceElement&&i.sourceElement.bpmnElement!==(0,on.Cf)(t)&&(i.sourceElement=t&&o),i.targetElement&&i.targetElement.bpmnElement!==(0,on.Cf)(n)&&(i.targetElement=n&&r)},Ec.prototype.updateDiParent=function(e,t){if(t&&!(0,on.is)(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):((0,_o.TF)(n,e),e.$parent=null)}},Ec.prototype.getLaneSet=function(e){var t,n;return(0,on.is)(e,"bpmn:Lane")?((t=e.childLaneSet)||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):((0,on.is)(e,"bpmn:Participant")&&(e=e.processRef),(t=(n=e.get("laneSets"))[0])||((t=this._bpmnFactory.create("bpmn:LaneSet")).$parent=e,n.push(t)),t)},Ec.prototype.updateSemanticParent=function(e,t,n){var i;if(e.$parent!==t&&(!(0,on.is)(e,"bpmn:DataInput")&&!(0,on.is)(e,"bpmn:DataOutput")||((0,on.is)(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),!("ioSpecification"in t)||t.ioSpecification!==e.$parent))){if((0,on.is)(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if((0,on.is)(e,"bpmn:FlowElement")){if(t)if((0,on.is)(t,"bpmn:Participant"))t=t.processRef;else if((0,on.is)(t,"bpmn:Lane"))do{t=t.$parent.$parent}while((0,on.is)(t,"bpmn:Lane"));i="flowElements"}else if((0,on.is)(e,"bpmn:Artifact")){for(;t&&!(0,on.is)(t,"bpmn:Process")&&!(0,on.is)(t,"bpmn:SubProcess")&&!(0,on.is)(t,"bpmn:Collaboration");){if((0,on.is)(t,"bpmn:Participant")){t=t.processRef;break}t=t.$parent}i="artifacts"}else if((0,on.is)(e,"bpmn:MessageFlow"))i="messageFlows";else if((0,on.is)(e,"bpmn:Participant")){i="participants";var o,r=e.processRef;r&&(o=function(e){for(;e&&!(0,on.is)(e,"bpmn:Definitions");)e=e.$parent;return e}(e.$parent||t),e.$parent&&((0,_o.TF)(o.get("rootElements"),r),r.$parent=null),t&&((0,_o.WQ)(o.get("rootElements"),r),r.$parent=o))}else(0,on.is)(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":(0,on.is)(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error("no parent for <".concat(e.id,"> in <").concat(t.id,">"));var a;if(e.$parent&&(a=e.$parent.get(i),(0,_o.TF)(a,e)),t?((a=t.get(i)).push(e),e.$parent=t):e.$parent=null,n){var s=n.get(i);(0,_o.TF)(a,e),t&&(s||(s=[],t.set(i,s)),s.push(e))}}},Ec.prototype.updateConnectionWaypoints=function(e){(0,on.S2)(e).set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))},Ec.prototype.updateConnection=function(e){var t,n=e.connection,i=(0,on.Cf)(n),o=n.source,r=(0,on.Cf)(o),a=n.target,s=(0,on.Cf)(n.target);if((0,on.is)(i,"bpmn:DataAssociation"))(0,on.is)(i,"bpmn:DataInputAssociation")?(i.get("sourceRef")[0]=r,t=e.parent||e.newParent||s,this.updateSemanticParent(i,s,t)):(0,on.is)(i,"bpmn:DataOutputAssociation")&&(t=e.parent||e.newParent||r,this.updateSemanticParent(i,r,t),i.targetRef=s);else{var c=(0,on.is)(i,"bpmn:SequenceFlow");i.sourceRef!==r&&(c&&((0,_o.TF)(i.sourceRef&&i.sourceRef.get("outgoing"),i),r&&r.get("outgoing")&&r.get("outgoing").push(i)),i.sourceRef=r),i.targetRef!==s&&(c&&((0,_o.TF)(i.targetRef&&i.targetRef.get("incoming"),i),s&&s.get("incoming")&&s.get("incoming").push(i)),i.targetRef=s)}this.updateConnectionWaypoints(n),this.updateDiConnection(n,o,a)},Ec.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};var Cc=n(89522),kc=n(22339);function Pc(e,t){Cc.A.call(this),this._bpmnFactory=e,this._moddle=t}function Tc(e,t,n){return void 0===t[n]?t:(e[n]=t[n],(0,h.cJ)(t,[n]))}function Ac(e,t){this._modeling=e,this._canvas=t}function jc(e){this._modeling=e}function Bc(e,t){this._canvas=e,this._layouter=t}(0,i.A)(Pc,Cc.A),Pc.$inject=["bpmnFactory","moddle"],Pc.prototype._baseCreate=Cc.A.prototype.create,Pc.prototype.create=function(e,t){if("label"===e){var n=t.di||this._bpmnFactory.createDiLabel();return this._baseCreate(e,(0,h.kp)({type:"label",di:n},Yi.X9,t))}return this.createElement(e,t)},Pc.prototype.createElement=function(e,t){var n,i,o,r,a=(t=(0,h.kp)({},t||{})).businessObject,s=t.di;if(!a){if(!t.type)throw new Error("no shape type specified");a=this._bpmnFactory.create(t.type),(0,kc.R)(a)}if(i=s,!(0,on.f7)(i,["bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane"])){var c=(0,h.kp)({},s||{},{id:a.id+"_di"});s="root"===e?this._bpmnFactory.createDiPlane(a,c):"connection"===e?this._bpmnFactory.createDiEdge(a,c):this._bpmnFactory.createDiShape(a,c)}return(0,on.is)(a,"bpmn:Group")&&(t=(0,h.kp)({isFrame:!0},t)),t=function(e,t,n){return(0,h.jJ)(n,function(n){t=Tc(e,t,n)}),t}(a,t,["processRef","isInterrupting","associationDirection","isForCompensation"]),t.isExpanded&&(t=Tc(s,t,"isExpanded")),(0,on.f7)(a,["bpmn:Lane","bpmn:Participant"])&&(t=Tc(s,t,"isHorizontal")),(0,on.is)(a,"bpmn:SubProcess")&&(t.collapsed=!(0,rn.Av)(a,s)),(0,on.is)(a,"bpmn:ExclusiveGateway")&&((0,h.zy)(s,"isMarkerVisible")?void 0===s.isMarkerVisible&&(s.isMarkerVisible=!1):s.isMarkerVisible=!0),(0,h.O9)(t.triggeredByEvent)&&(a.triggeredByEvent=t.triggeredByEvent,delete t.triggeredByEvent),(0,h.O9)(t.cancelActivity)&&(a.cancelActivity=t.cancelActivity,delete t.cancelActivity),t.eventDefinitionType&&(o=a.get("eventDefinitions")||[],r=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),"bpmn:ConditionalEventDefinition"===t.eventDefinitionType&&(r.condition=this._bpmnFactory.create("bpmn:FormalExpression")),o.push(r),r.$parent=a,a.eventDefinitions=o,delete t.eventDefinitionType),n=this.getDefaultSize(a,s),t=(0,h.kp)({id:a.id},n,t,{businessObject:a,di:s}),this._baseCreate(e,t)},Pc.prototype.getDefaultSize=function(e,t){var n=(0,on.Cf)(e);if(t=t||(0,on.S2)(e),(0,on.is)(n,"bpmn:SubProcess"))return(0,rn.Av)(n,t)?{width:350,height:200}:{width:100,height:80};if((0,on.is)(n,"bpmn:Task"))return{width:100,height:80};if((0,on.is)(n,"bpmn:Gateway"))return{width:50,height:50};if((0,on.is)(n,"bpmn:Event"))return{width:36,height:36};if((0,on.is)(n,"bpmn:Participant")){var i=void 0===t.isHorizontal||!0===t.isHorizontal;return(0,rn.Av)(n,t)?i?{width:600,height:250}:{width:250,height:600}:i?{width:400,height:60}:{width:60,height:400}}return(0,on.is)(n,"bpmn:Lane")?{width:400,height:100}:(0,on.is)(n,"bpmn:DataObjectReference")?{width:36,height:50}:(0,on.is)(n,"bpmn:DataStoreReference")?{width:50,height:50}:(0,on.is)(n,"bpmn:TextAnnotation")?{width:100,height:30}:(0,on.is)(n,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}},Pc.prototype.createParticipantShape=function(e){return(0,h.Gv)(e)||(e={isExpanded:e}),!1!==(e=(0,h.kp)({type:"bpmn:Participant"},e||{})).isExpanded&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)},Ac.$inject=["modeling","canvas"],Ac.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;(0,h.jJ)(n,function(e){var n={x:0,y:0};(0,h.O9)(i.left)?n.x=i.left-e.x:(0,h.O9)(i.right)?n.x=i.right-e.width-e.x:(0,h.O9)(i.center)?n.x=i.center-Math.round(e.width/2)-e.x:(0,h.O9)(i.top)?n.y=i.top-e.y:(0,h.O9)(i.bottom)?n.y=i.bottom-e.height-e.y:(0,h.O9)(i.middle)&&(n.y=i.middle-Math.round(e.height/2)-e.y),t.moveElements([e],n,e.parent)})},Ac.prototype.postExecute=function(e){},jc.$inject=["modeling"],jc.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape,o=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:o.attach}),e.shape=i},jc.prototype.postExecute=function(e){var t,n,i=e.hints||{};t=e.source,n=e.shape,(0,h.zN)(t.outgoing,function(e){return e.target===n})||(i.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))},Bc.$inject=["canvas","layouter"],Bc.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,o=e.parent,r=e.parentIndex,a=e.hints;if(!n||!i)throw new Error("source and target required");if(!o)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,o,r),t},Bc.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var Dc=Math.round;function Rc(e){this._modeling=e}Rc.$inject=["modeling"],Rc.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,o=e.position,r=e.hints,a=this._modeling;(0,h.jJ)(t,function(e){(0,h.Et)(e.x)||(e.x=0),(0,h.Et)(e.y)||(e.y=0)});var s=(0,h.pb)(t,function(e){return!e.hidden}),c=(0,Ut.U7)(s);(0,h.jJ)(t,function(e){(0,P.fX)(e)&&(e.waypoints=(0,h.Tj)(e.waypoints,function(e){return{x:Dc(e.x-c.x-c.width/2+o.x),y:Dc(e.y-c.y-c.height/2+o.y)}})),(0,h.kp)(e,{x:Dc(e.x-c.x-c.width/2+o.x),y:Dc(e.y-c.y-c.height/2+o.y)})});var p=(0,Ut.wT)(t),l={};(0,h.jJ)(t,function(e){if((0,P.fX)(e))l[e.id]=(0,h.Et)(i)?a.createConnection(l[e.source.id],l[e.target.id],i,e,e.parent||n,r):a.createConnection(l[e.source.id],l[e.target.id],e,e.parent||n,r);else{var t=(0,h.kp)({},r);-1===p.indexOf(e)&&(t.autoResize=!1),(0,P.J2)(e)&&(t=(0,h.cJ)(t,["attach"])),l[e.id]=(0,h.Et)(i)?a.createShape(e,(0,h.Up)(e,["x","y","width","height"]),e.parent||n,i,t):a.createShape(e,(0,h.Up)(e,["x","y","width","height"]),e.parent||n,t)}}),e.elements=(0,h.zu)(l)};var Mc=Math.round;function Nc(e){this._canvas=e}function Fc(e){Nc.call(this,e)}Nc.$inject=["canvas"],Nc.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,o=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return void 0!==n.width?(0,h.kp)(t,n):(0,h.kp)(t,{x:n.x-Mc(t.width/2),y:n.y-Mc(t.height/2)}),this._canvas.addShape(t,i,o),t},Nc.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t},(0,i.A)(Fc,Nc),Fc.$inject=["canvas"];var Lc=Nc.prototype.execute;Fc.prototype.execute=function(e){var t=e.shape;return function(e){["width","height"].forEach(function(t){"undefined"===typeof e[t]&&(e[t]=0)})}(t),t.labelTarget=e.labelTarget,Lc.call(this,e)};var Oc=Nc.prototype.revert;function zc(e,t){this._canvas=e,this._modeling=t}function Ic(e,t){this._modeling=e,this._elementRegistry=t}function $c(e,t){this._canvas=e,this._modeling=t}function Hc(e){this._modeling=e}Fc.prototype.revert=function(e){return e.shape.labelTarget=null,Oc.call(this,e)},zc.$inject=["canvas","modeling"],zc.prototype.preExecute=function(e){var t=this._modeling,n=e.connection;dc(n.incoming,function(e){t.removeConnection(e,{nested:!0})}),dc(n.outgoing,function(e){t.removeConnection(e,{nested:!0})})},zc.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=(0,_o.qh)(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t},zc.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,(0,_o.WQ)(n.children,t,i),this._canvas.addConnection(t,n),t},Ic.$inject=["modeling","elementRegistry"],Ic.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;(0,h.jJ)(i,function(e){n.get(e.id)&&(e.waypoints?t.removeConnection(e):t.removeShape(e))})},$c.$inject=["canvas","modeling"],$c.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;dc(n.incoming,function(e){t.removeConnection(e,{nested:!0})}),dc(n.outgoing,function(e){t.removeConnection(e,{nested:!0})}),dc(n.children,function(e){(0,P.fX)(e)?t.removeConnection(e,{nested:!0}):t.removeShape(e,{nested:!0})})},$c.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=(0,_o.qh)(i.children,n),t.removeShape(n),n},$c.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,o=e.oldParentIndex;return(0,_o.WQ)(i.children,n,o),t.addShape(n,i),n},Hc.$inject=["modeling"];var Jc={x:"y",y:"x"};function Gc(e,t){this._layouter=e,this._canvas=t}function Uc(){}function Wc(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}function Vc(e){this._modeling=e}function qc(e){this._helper=new Vc(e)}function Xc(e){this._modeling=e,this._helper=new Vc(e)}function Qc(e){this._modeling=e}function Kc(e){return e.original||e}function Zc(e,t){this._modeling=e,this._rules=t}function Yc(e){this._modeling=e}function ep(e){this._modeling=e}function tp(e){return(0,h.kp)({},e)}function np(e){switch(e){case"n":case"s":return"y";case"w":case"e":return"x"}}function ip(e,t,n){var i=np(n);return/e|s/.test(n)?e[i]>t:/n|w/.test(n)?e[i]<t:void 0}function op(e,t){return-1!==e.indexOf(t)}function rp(e){this._modeling=e}function ap(e){var t={};return(0,h.jJ)(e,function(e){t[e.id]=e.hidden,e.children&&(t=(0,h.kp)({},t,ap(e.children)))}),t}function sp(e,t){var n=[];return(0,h.jJ)(e,function(e){e.hidden=t,n=n.concat(e),e.children&&(n=n.concat(sp(e.children,e.collapsed||t)))}),n}function cp(e,t){var n=[];return(0,h.jJ)(e,function(e){e.hidden=t[e.id],n=n.concat(e),e.children&&(n=n.concat(cp(e.children,t)))}),n}function pp(e){this._modeling=e}function lp(e,t){return(0,_o.TF)(e&&e.attachers,t)}function up(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),(0,_o.WQ)(i,t,n)}}function hp(){}Hc.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,o=e.dimension;function r(e,t){e.range.min=Math.min(t[i],e.range.min),e.range.max=Math.max(t[i]+t[o],e.range.max)}function a(e){return e[i]+e[o]/2}function s(e){return e.length-1}function c(e){return e.max-e.min}var p,l,u=n[0],d=s(n),f=n[d],m=0;(0,h.jJ)(n,function(e,p){var l,u,f;e.elements.length<2?p&&p!==n.length-1&&(r(e,e.elements[0]),m+=c(e.range)):(u=(l=(0,h.Ul)(e.elements,i))[0],p===d&&(u=l[s(l)]),f=a(u),e.range=null,(0,h.jJ)(l,function(n){!function(e,n){var o={y:0};o[i]=e-a(n),o[i]&&(o[Jc[i]]=0,t.moveElements([n],o,n.parent))}(f,n),null!==e.range?r(e,n):e.range={min:n[i],max:n[i]+n[o]}}),p&&p!==n.length-1&&(m+=c(e.range)))}),l=Math.abs(f.range.min-u.range.max),(p=Math.round((l-m)/(n.length-1)))<n.length-1||(0,h.jJ)(n,function(e,r){var a,s={};e!==u&&e!==f&&(a=n[r-1],e.range.max=0,(0,h.jJ)(e.elements,function(n,r){s[Jc[i]]=0,s[i]=a.range.max-n[i]+p,e.range.min!==n[i]&&(s[i]+=n[i]-e.range.min),s[i]&&t.moveElements([n],s,n.parent),e.range.max=Math.max(n[i]+n[o],r?e.range.max:0)}))})},Hc.prototype.postExecute=function(e){},Gc.$inject=["layouter","canvas"],Gc.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return(0,h.kp)(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t},Gc.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t},Uc.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,o=e.newParentIndex,r=t.parent;return e.oldParent=r,e.oldParentIndex=(0,_o.TF)(r.children,t),(0,_o.WQ)(i.children,t,o),t.parent=i,(0,h.jJ)(t.waypoints,function(e){e.x+=n.x,e.y+=n.y,e.original&&(e.original.x+=n.x,e.original.y+=n.y)}),t},Uc.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,o=e.oldParentIndex,r=e.delta;return(0,_o.TF)(n.children,t),(0,_o.WQ)(i.children,t,o),t.parent=i,(0,h.jJ)(t.waypoints,function(e){e.x-=r.x,e.y-=r.y,e.original&&(e.original.x-=r.x,e.original.y-=r.y)}),t},Wc.prototype.add=function(e,t){return this.addAll([e],t)},Wc.prototype.addAll=function(e,t){var n=(0,Ut.yO)(e,!!t,this);return(0,h.kp)(this,n),this},Vc.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]},Vc.prototype.moveClosure=function(e,t,n,i,o){var r=this._modeling,a=e.allShapes,s=e.allConnections,c=e.enclosedConnections,p=e.topLevel,l=!1;o&&o.parent===n&&(l=!0),(0,h.jJ)(a,function(e){r.moveShape(e,t,p[e.id]&&!l&&n,{recurse:!1,layout:!1})}),(0,h.jJ)(s,function(e){var i=!!a[e.source.id],o=!!a[e.target.id];c[e.id]&&i&&o?r.moveConnection(e,t,p[e.id]&&!l&&n):r.layoutConnection(e,{connectionStart:i&&Sr(e,e.source,t),connectionEnd:o&&Cr(e,e.target,t)})})},Vc.prototype.getClosure=function(e){return(new Wc).addAll(e,!0)},qc.$inject=["modeling"],qc.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)},qc.prototype.postExecute=function(e){var t,n=e.hints;n&&n.primaryShape&&(t=n.primaryShape,n.oldParent=t.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,t)},Xc.$inject=["modeling"],Xc.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,o=e.newParentIndex,r=t.parent;return e.oldBounds=(0,h.Up)(t,["x","y","width","height"]),e.oldParent=r,e.oldParentIndex=(0,_o.TF)(r.children,t),(0,_o.WQ)(i.children,t,o),(0,h.kp)(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t},Xc.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,o=this._modeling;!1!==i.layout&&((0,h.jJ)(t.incoming,function(e){o.layoutConnection(e,{connectionEnd:Cr(e,t,n)})}),(0,h.jJ)(t.outgoing,function(e){o.layoutConnection(e,{connectionStart:Sr(e,t,n)})})),!1!==i.recurse&&this.moveChildren(e)},Xc.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,o=e.delta;return(0,_o.WQ)(n.children,t,i),(0,h.kp)(t,{parent:n,x:t.x-o.x,y:t.y-o.y}),t},Xc.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)},Xc.prototype.getNewParent=function(e){return e.newParent||e.shape.parent},Qc.$inject=["modeling"],Qc.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,o=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget required");return(0,h.cy)(o)&&(e.oldWaypoints=i.waypoints,i.waypoints=o),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i},Qc.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,o=e.dockingOrPoints,r=e.hints||{},a={};r.connectionStart&&(a.connectionStart=r.connectionStart),r.connectionEnd&&(a.connectionEnd=r.connectionEnd),!1!==r.layoutConnection&&(!n||i&&"source"!==r.docking||(a.connectionStart=a.connectionStart||Kc((0,h.cy)(o)?o[0]:o)),!i||n&&"target"!==r.docking||(a.connectionEnd=a.connectionEnd||Kc((0,h.cy)(o)?o[o.length-1]:o)),r.newWaypoints&&(a.waypoints=r.newWaypoints),this._modeling.layoutConnection(t,a))},Qc.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,o=e.connection;return t&&(o.source=t),n&&(o.target=n),i&&(o.waypoints=i),o},Zc.$inject=["modeling","rules"],Zc.prototype.preExecute=function(e){var t,n=this,i=this._modeling,o=this._rules,r=e.oldShape,a=e.newData,s=e.hints||{};function c(e,t,n){return o.allowed("connection.reconnect",{connection:n,source:e,target:t})}var p,l={x:a.x,y:a.y},u={x:r.x,y:r.y,width:r.width,height:r.height};t=e.newShape=e.newShape||n.createShape(a,l,r.parent,s),r.host&&i.updateAttachment(t,r.host),!1!==s.moveChildren&&(p=r.children.slice(),i.moveElements(p,{x:0,y:0},t,s));var d=r.incoming.slice(),f=r.outgoing.slice();(0,h.jJ)(d,function(e){c(e.source,t,e)&&n.reconnectEnd(e,t,Er(e,t,u),s)}),(0,h.jJ)(f,function(e){var i=e.target;c(t,i,e)&&n.reconnectStart(e,t,wr(e,t,u),s)})},Zc.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)},Zc.prototype.execute=function(e){},Zc.prototype.revert=function(e){},Zc.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)},Zc.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)},Zc.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)},Yc.$inject=["modeling"],Yc.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},(0,h.kp)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},Yc.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds;!1!==(e.hints||{}).layout&&((0,h.jJ)(n.incoming,function(e){t.layoutConnection(e,{connectionEnd:Er(e,n,i)})}),(0,h.jJ)(n.outgoing,function(e){t.layoutConnection(e,{connectionStart:wr(e,n,i)})}))},Yc.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return(0,h.kp)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},ep.$inject=["modeling"],ep.prototype.preExecute=function(e){var t=e.delta,n=e.direction,i=e.movingShapes,o=e.resizingShapes,r=e.start,a={};this.moveShapes(i,t),(0,h.jJ)(o,function(e){a[e.id]=function(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}(e)}),this.resizeShapes(o,t,n),this.updateConnectionWaypoints(function(e,t){var n=[];return(0,h.jJ)(e.concat(t),function(i){var o=i.incoming,r=i.outgoing;(0,h.jJ)(o.concat(r),function(i){var o=i.source,r=i.target;(Vs(e,o)||Vs(e,r)||Vs(t,o)||Vs(t,r))&&(Vs(n,i)||n.push(i))})}),n}(i,o),t,n,r,i,o,a)},ep.prototype.execute=function(){},ep.prototype.revert=function(){},ep.prototype.moveShapes=function(e,t){var n=this;(0,h.jJ)(e,function(e){n._modeling.moveShape(e,t,null,{autoResize:!1,layout:!1,recurse:!1})})},ep.prototype.resizeShapes=function(e,t,n){var i=this;(0,h.jJ)(e,function(e){var o=function(e,t,n){var i=e.x,o=e.y,r=e.width,a=e.height,s=n.x,c=n.y;switch(t){case"n":return{x:i,y:o+c,width:r,height:a-c};case"s":return{x:i,y:o,width:r,height:a+c};case"w":return{x:i+s,y:o,width:r-s,height:a};case"e":return{x:i,y:o,width:r+s,height:a};default:throw new Error("unknown direction: "+t)}}(e,n,t);i._modeling.resizeShape(e,o,null,{attachSupport:!1,autoResize:!1,layout:!1})})},ep.prototype.updateConnectionWaypoints=function(e,t,n,i,o,r,a){var s=this,c=o.concat(r);(0,h.jJ)(e,function(e){var p=e.source,l=e.target,u=function(e){return(0,h.Tj)(e.waypoints,function(e){return(e=tp(e)).original&&(e.original=tp(e.original)),e})}(e),d=np(n),f={};op(c,p)&&op(c,l)?(u=(0,h.Tj)(u,function(e){return ip(e,i,n)&&(e[d]=e[d]+t[d]),e.original&&ip(e.original,i,n)&&(e.original[d]=e.original[d]+t[d]),e}),s._modeling.updateWaypoints(e,u,{labelBehavior:!1})):(op(c,p)||op(c,l))&&(op(o,p)?f.connectionStart=Sr(e,p,t):op(o,l)?f.connectionEnd=Cr(e,l,t):op(r,p)?f.connectionStart=wr(e,p,a[p.id]):op(r,l)&&(f.connectionEnd=Er(e,l,a[l.id])),s._modeling.layoutConnection(e,f))})},rp.$inject=["modeling"],rp.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=ap(n),t.collapsed=!t.collapsed;var i=sp(n,t.collapsed);return[t].concat(i)},rp.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=cp(t.children,n);return t.collapsed=!t.collapsed,[t].concat(i)},pp.$inject=["modeling"],pp.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=lp(i,t),up(n,t),t.host=n,t},pp.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,o=e.attacherIdx;return t.host=i,lp(n,t),up(i,t,o),t},hp.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t},hp.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};var dp=n(29707);function fp(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}function mp(e){this._elementRegistry=e}function vp(e,t){(0,h.jJ)(t,function(t,n){e.set(n,t)})}fp.$inject=["eventBus","elementFactory","commandStack"],fp.prototype.getHandlers=function(){return{"shape.append":jc,"shape.create":Nc,"shape.delete":$c,"shape.move":Xc,"shape.resize":Yc,"shape.replace":Zc,"shape.toggleCollapse":rp,spaceTool:ep,"label.create":Fc,"connection.create":Bc,"connection.delete":zc,"connection.move":Uc,"connection.layout":Gc,"connection.updateWaypoints":hp,"connection.reconnect":Qc,"elements.create":Rc,"elements.move":qc,"elements.delete":Ic,"elements.distribute":Hc,"elements.align":Ac,"element.updateAttachment":pp}},fp.prototype.registerHandlers=function(e){(0,h.jJ)(this.getHandlers(),function(t,n){e.registerHandler(n,t)})},fp.prototype.moveShape=function(e,t,n,i,o){"object"===typeof i&&(o=i,i=null);var r={shape:e,delta:t,newParent:n,newParentIndex:i,hints:o||{}};this._commandStack.execute("shape.move",r)},fp.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)},fp.prototype.moveElements=function(e,t,n,i){var o,r=(i=i||{}).attach,a=n;!0===r?(o=n,a=n.parent):!1===r&&(o=null);var s={shapes:e,delta:t,newParent:a,newHost:o,hints:i};this._commandStack.execute("elements.move",s)},fp.prototype.moveConnection=function(e,t,n,i,o){"object"===typeof i&&(o=i,i=void 0);var r={connection:e,delta:t,newParent:n,newParentIndex:i,hints:o||{}};this._commandStack.execute("connection.move",r)},fp.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)},fp.prototype.createConnection=function(e,t,n,i,o,r){"object"===typeof n&&(r=o,o=i,i=n,n=void 0);var a={source:e,target:t,parent:o,parentIndex:n,connection:i=this._create("connection",i),hints:r};return this._commandStack.execute("connection.create",a),a.connection},fp.prototype.createShape=function(e,t,n,i,o){"number"!==typeof i&&(o=i,i=void 0);var r,a,s=(o=o||{}).attach;e=this._create("shape",e),s?(r=n.parent,a=n):r=n;var c={position:t,shape:e,parent:r,parentIndex:i,host:a,hints:o};return this._commandStack.execute("shape.create",c),c.shape},fp.prototype.createElements=function(e,t,n,i,o){(0,h.cy)(e)||(e=[e]),"number"!==typeof i&&(o=i,i=void 0);var r={position:t,elements:e,parent:n,parentIndex:i,hints:o=o||{}};return this._commandStack.execute("elements.create",r),r.elements},fp.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var o={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",o),o.shape},fp.prototype.appendShape=function(e,t,n,i,o){o=o||{};var r={source:e,position:n,target:i,shape:t=this._create("shape",t),connection:o.connection,connectionParent:o.connectionParent,hints:o};return this._commandStack.execute("shape.append",r),r.shape},fp.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)},fp.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)},fp.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)},fp.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)},fp.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape},fp.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)},fp.prototype.resizeShape=function(e,t,n,i){var o={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",o)},fp.prototype.createSpace=function(e,t,n,i,o){var r={delta:n,direction:i,movingShapes:e,resizingShapes:t,start:o};this._commandStack.execute("spaceTool",r)},fp.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)},fp.prototype.reconnect=function(e,t,n,i,o){var r={connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:o||{}};this._commandStack.execute("connection.reconnect",r)},fp.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,(0,h.kp)(i,{docking:"source"}))},fp.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,(0,h.kp)(i,{docking:"target"}))},fp.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)},fp.prototype._create=function(e,t){return(0,dp.w)(t)?t:this._elementFactory.create(e,t)},fp.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)},mp.$inject=["elementRegistry"],mp.prototype.execute=function(e){var t=e.element,n=e.moddleElement,i=e.properties;if(!n)throw new Error("<moddleElement> required");var o=e.changed||this._getVisualReferences(n).concat(t),r=e.oldProperties||function(e,t){return(0,h.TS)(t,function(t,n){return t[n]=e.get(n),t},{})}(n,(0,h.HP)(i));return vp(n,i),e.oldProperties=r,e.changed=o,o},mp.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return vp(n,t),i},mp.prototype._getVisualReferences=function(e){var t=this._elementRegistry;return(0,on.is)(e,"bpmn:DataObject")?function(e,t){return t.filter(function(t){return(0,on.is)(t,"bpmn:DataObjectReference")&&(0,on.Cf)(t).dataObjectRef===e})}(e,t):[]};var gp="default",yp="id",bp="di",_p={width:0,height:0};function xp(e,t,n,i){this._elementRegistry=e,this._moddle=t,this._modeling=n,this._textRenderer=i}function wp(e,t){return yp in e&&e[yp]!==t[yp]}function Ep(e,t){var n=e.businessObject,i=(0,on.S2)(e);(0,h.jJ)(t,function(e,t){t!==bp?n.set(t,e):i&&function(e,t){(0,h.jJ)(t,function(t,n){e.set(n,t)})}(i,e)})}xp.$inject=["elementRegistry","moddle","modeling","textRenderer"],xp.prototype.execute=function(e){var t=e.element,n=[t];if(!t)throw new Error("element required");var i=this._elementRegistry,o=this._moddle.ids,r=t.businessObject,a=function(e){var t=(0,h.kp)({},e);return Sp.forEach(function(n){n in e&&(t[n]=(0,on.Cf)(t[n]))}),t}(e.properties),s=e.oldProperties||function(e,t){var n=(0,h.HP)(t),i=e.businessObject,o=(0,on.S2)(e);return(0,h.TS)(n,function(e,n){return e[n]=n!==bp?i.get(n):function(e,t){return(0,h.TS)(t,function(t,n){return t[n]=e&&e.get(n),t},{})}(o,(0,h.HP)(t.di)),e},{})}(t,a);return wp(a,r)&&(o.unclaim(r[yp]),i.updateId(t,a[yp]),o.claim(a[yp],r)),gp in a&&(a[gp]&&n.push(i.get(a[gp].id)),r[gp]&&n.push(i.get(r[gp].id))),Ep(t,a),e.oldProperties=s,e.changed=n,n},xp.prototype.postExecute=function(e){var t=e.element.label,n=t&&(0,on.Cf)(t).name;if(n){var i=this._textRenderer.getExternalLabelBounds(t,n);this._modeling.resizeShape(t,i,_p)}},xp.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,o=t.businessObject,r=this._elementRegistry,a=this._moddle.ids;return Ep(t,i),wp(n,o)&&(a.unclaim(n[yp]),r.updateId(t,i[yp]),a.claim(i[yp],o)),e.changed};var Sp=["default"];function Cp(e,t){this._canvas=e,this._modeling=t}function kp(e,t){this._modeling=e,this._spaceTool=t}function Pp(e){this._modeling=e}function Tp(e,t){this._modeling=e,this._spaceTool=t}Cp.$inject=["canvas","modeling"],Cp.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,o=t.getRootElement(),r=o.businessObject,a=r.$parent,s=(0,on.S2)(o);return t.setRootElement(n),t.removeRootElement(o),(0,_o.WQ)(a.rootElements,i),i.$parent=a,(0,_o.TF)(a.rootElements,r),r.$parent=null,o.di=null,s.bpmnElement=i,n.di=s,e.oldRoot=o,[]},Cp.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,o=e.oldRoot,r=o.businessObject,a=i.$parent,s=(0,on.S2)(n);return t.setRootElement(o),t.removeRootElement(n),(0,_o.TF)(a.rootElements,i),i.$parent=null,(0,_o.WQ)(a.rootElements,r),r.$parent=a,n.di=null,s.bpmnElement=r,o.di=s,[]},kp.$inject=["modeling","spaceTool"],kp.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,o=e.location,r=zo(i),a=r===i,s=a?i:i.parent,c=Oo(s),p=(0,rn.$b)(i);if(p?"left"===o?o="top":"right"===o&&(o="bottom"):"top"===o?o="left":"bottom"===o&&(o="right"),!c.length){var l=p?{x:i.x+Fo,y:i.y,width:i.width-Fo,height:i.height}:{x:i.x,y:i.y+Fo,width:i.width,height:i.height-Fo};n.createShape({type:"bpmn:Lane",isHorizontal:p},l,s)}var u,d,f,m,v,g=[];(0,Ut.qO)(r,function(e){return g.push(e),e.label&&g.push(e.label),e===i?[]:(0,h.pb)(e.children,function(e){return e!==i})}),"top"===o?(u=-120,f=(d=i.y)+10,m="n",v="y"):"left"===o?(u=-120,f=(d=i.x)+10,m="w",v="x"):"bottom"===o?(u=120,f=(d=i.y+i.height)-10,m="s",v="y"):"right"===o&&(u=120,f=(d=i.x+i.width)-10,m="e",v="x");var y=t.calculateAdjustments(g,v,u,f),b=p?{x:0,y:u}:{x:u,y:0};t.makeSpace(y.movingShapes,y.resizingShapes,b,m,f);var _=p?{x:i.x+(a?Fo:0),y:d-("top"===o?120:0),width:i.width-(a?Fo:0),height:120}:{x:d-("left"===o?120:0),y:i.y+(a?Fo:0),width:120,height:i.height-(a?Fo:0)};e.newLane=n.createShape({type:"bpmn:Lane",isHorizontal:p},_,s)},Pp.$inject=["modeling"],Pp.prototype.preExecute=function(e){var t=this._modeling,n=e.shape,i=e.count,o=Oo(n),r=o.length;if(r>i)throw new Error("more than <".concat(i,"> child lanes"));var a,s,c,p,l=(0,rn.$b)(n),u=l?n.height:n.width,h=Math.round(u/i);for(p=0;p<i;p++)a=p===i-1?u-h*p:h,s=l?{x:n.x+Fo,y:n.y+p*h,width:n.width-Fo,height:a}:{x:n.x+p*h,y:n.y+Fo,width:a,height:n.height-Fo},p<r?t.resizeShape(o[p],s):(c={type:"bpmn:Lane",isHorizontal:l},t.createShape(c,s,n))},Tp.$inject=["modeling","spaceTool"],Tp.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds;!1!==e.balanced?this.resizeBalanced(t,n):this.resizeSpace(t,n)},Tp.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=Io(e,t);n.resizeShape(e,t),i.forEach(function(e){n.resizeShape(e.shape,e.newBounds)})},Tp.prototype.resizeSpace=function(e,t){var n,i,o,r,a,s=this._spaceTool,c=(0,qt.Fy)(e),p=To((0,qt.Fy)(t),c),l=zo(e),u=[],h=[];(0,Ut.qO)(l,function(e){return u.push(e),((0,on.is)(e,"bpmn:Lane")||(0,on.is)(e,"bpmn:Participant"))&&h.push(e),e.children}),(p.bottom||p.top)&&(n=p.bottom||p.top,i=e.y+(p.bottom?e.height:0)+(p.bottom?-10:10),o=p.bottom?"s":"n",r=p.top>0||p.bottom<0?-n:n,a=s.calculateAdjustments(u,"y",r,i),s.makeSpace(a.movingShapes,a.resizingShapes,{x:0,y:n},o)),(p.left||p.right)&&(n=p.right||p.left,i=e.x+(p.right?e.width:0)+(p.right?-10:100),o=p.right?"e":"w",r=p.left>0||p.right<0?-n:n,a=s.calculateAdjustments(h,"x",r,i),s.makeSpace(a.movingShapes,a.resizingShapes,{x:n,y:0},o))};var Ap="flowNodeRef",jp="lanes";function Bp(e){this._elementRegistry=e}function Dp(e){this._moddle=e}Bp.$inject=["elementRegistry"],Bp.prototype._computeUpdates=function(e,t){var n=[],i=[],o={},r=[];function a(e){-1===n.indexOf(e)&&(r.push(e),n.push(e))}function s(e){if(!e.parent)return[];var t=function(e){var t=zo(e);return o[t.id]||(o[t.id]=Lo(t)),o[t.id]}(e);return t.filter(function(t){return function(e,t){var n=(0,qt.Fy)(t),i=e.x+e.width/2,o=e.y+e.height/2;return i>n.left&&i<n.right&&o>n.top&&o<n.bottom}(e,t)}).map(function(e){return e.businessObject})}return t.forEach(function(e){var t=zo(e);if(t&&-1===n.indexOf(t)){var i=t.children.filter(function(e){return(0,on.is)(e,"bpmn:FlowNode")});i.forEach(a),n.push(t)}}),e.forEach(a),r.forEach(function(e){var t=e.businessObject,n=t.get(jp).slice(),o=s(e);i.push({flowNode:t,remove:n,add:o})}),t.forEach(function(e){var t=e.businessObject;e.parent||t.get(Ap).forEach(function(e){i.push({flowNode:e,remove:[t],add:[]})})}),i},Bp.prototype.execute=function(e){var t=e.updates;return t||(t=e.updates=this._computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(e){var t=e.flowNode,n=t.get(jp);e.remove.forEach(function(e){(0,_o.TF)(n,e),(0,_o.TF)(e.get(Ap),t)}),e.add.forEach(function(e){(0,_o.WQ)(n,e),(0,_o.WQ)(e.get(Ap),t)})}),[]},Bp.prototype.revert=function(e){return e.updates.forEach(function(e){var t=e.flowNode,n=t.get(jp);e.add.forEach(function(e){(0,_o.TF)(n,e),(0,_o.TF)(e.get(Ap),t)}),e.remove.forEach(function(e){(0,_o.WQ)(n,e),(0,_o.WQ)(e.get(Ap),t)})}),[]},Dp.$inject=["moddle"],Dp.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element;return e.claiming?t.claim(n,i):t.unclaim(n),[]},Dp.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element;return e.claiming?t.unclaim(n):t.claim(n,i),[]};var Rp={fill:void 0,stroke:void 0};function Mp(e){this._commandStack=e,this._normalizeColor=function(e){if(e){if((0,h.Kg)(e)){var t=function(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}(e);if(t)return t}throw new Error("invalid color value: ".concat(e))}}}Mp.$inject=["commandStack"],Mp.prototype.postExecute=function(e){var t=e.elements,n=e.colors||Rp,i=this,o={};"fill"in n&&(0,h.kp)(o,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&(0,h.kp)(o,{"border-color":this._normalizeColor(n.stroke)}),(0,h.jJ)(t,function(e){var t=(0,P.fX)(e)?(0,h.Up)(o,["border-color"]):o,n=(0,on.S2)(e);if(function(e){"border-color"in e&&(e.stroke=e["border-color"]);"background-color"in e&&(e.fill=e["background-color"])}(t),(0,P.J2)(e))i._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:n.label,properties:{color:o["border-color"]}});else{if(!(0,on.f7)(n,["bpmndi:BPMNEdge","bpmndi:BPMNShape"]))return;i._commandStack.execute("element.updateProperties",{element:e,properties:{di:t}})}})};var Np={width:0,height:0};function Fp(e,t,n){function i(e,t){var n=e.label||e,i=e.labelTarget||e;return(0,Yi.je)(n,t,i!==n),[n,i]}this.preExecute=function(t){var n=t.element,i=n.businessObject,o=t.newLabel;if(!(0,P.J2)(n)&&(0,Yi.UC)(n)&&!(0,Yi.ur)(n)&&!Lp(o)){var r=(0,Yi.QX)(n);r={x:r.x,y:r.y+7},e.createLabel(n,r,{id:i.id+"_label",businessObject:i,di:n.di})}},this.execute=function(e){return e.oldLabel=(0,Yi.p9)(e.element),i(e.element,e.newLabel)},this.revert=function(e){return i(e.element,e.oldLabel)},this.postExecute=function(n){var i=n.element,o=i.label||i,r=n.newLabel,a=n.newBounds,s=n.hints||{};if((0,P.J2)(o)||(0,on.is)(o,"bpmn:TextAnnotation"))if((0,P.J2)(o)&&Lp(r))!1!==s.removeShape&&e.removeShape(o,{unsetLabel:!1});else{var c=(0,Yi.p9)(i);"undefined"===typeof a&&(a=t.getExternalLabelBounds(o,c)),a&&e.resizeShape(o,a,Np)}}}function Lp(e){return!e||!e.trim()}function Op(e,t,n,i){fp.call(this,e,t,n),this._bpmnRules=i}function zp(){}Fp.$inject=["modeling","textRenderer","bpmnFactory"],(0,i.A)(Op,fp),Op.$inject=["eventBus","elementFactory","commandStack","bpmnRules"],Op.prototype.getHandlers=function(){var e=fp.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=mp,e["element.updateProperties"]=xp,e["canvas.updateRoot"]=Cp,e["lane.add"]=kp,e["lane.resize"]=Tp,e["lane.split"]=Pp,e["lane.updateRefs"]=Bp,e["id.updateClaim"]=Dp,e["element.setColor"]=Mp,e["element.updateLabel"]=Fp,e},Op.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})},Op.prototype.connect=function(e,t,n,i){var o=this._bpmnRules;if(n||(n=o.canConnect(e,t)),n)return this.createConnection(e,t,n,e.parent,i)},Op.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})},Op.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})},Op.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})},Op.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane},Op.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})},Op.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e},Op.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e},Op.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})},Op.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},Op.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})},Op.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})},zp.prototype.layoutConnection=function(e,t){return[(t=t||{}).connectionStart||(0,qt.pp)(t.source||e.source),t.connectionEnd||(0,qt.pp)(t.target||e.target)]};var Ip=Math.round,$p={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function Hp(e,t,n){var i,o,r,a=(0,qt.vc)(t,e,5),s=n.split(":")[0],c=Ip((t.x-e.x)/2+e.x),p=Ip((t.y-e.y)/2+e.y),l=(r=a,{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[s].test(r)),u=/h|r|l/.test(s),h=!1,d=!1;return l?(i=u?{x:c,y:e.y}:{x:e.x,y:p},o=u?"h:h":"v:v"):(h=function(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}(a,s),o=u?"h:v":"v:h",h?u?(d=p===e.y,i={x:e.x+20*(/l/.test(s)?-1:1),y:d?p+20:p}):i={x:(d=c===e.x)?c+20:c,y:e.y+20*(/t/.test(s)?-1:1)}:i={x:c,y:p}),{waypoints:Gp(e,i,o).concat(i),directions:o,turnNextDirections:d}}function Jp(e){return e.split(":").reverse().join(":")}function Gp(e,t,n){if(!function(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}(n=n||"h:h"))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Xp(n)){var i=function(e,t,n){return Hp(e,t,n)}(e,t,n),o=function(e,t,n){var i=Hp(t,e,Jp(n));return{waypoints:i.waypoints.slice().reverse(),directions:Jp(i.directions),turnNextDirections:i.turnNextDirections}}(e,t,n),r=function(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n="h"==n?"v":"h"),t.turnNextDirections&&(i="h"==i?"v":"h");var o=n+":"+i;return{waypoints:Gp(e.waypoints[e.waypoints.length-1],t.waypoints[0],o),directions:o}}(i,o);return[].concat(i.waypoints,r.waypoints,o.waypoints)}return function(e,t,n){var i=Ip((t.x-e.x)/2+e.x),o=Ip((t.y-e.y)/2+e.y);if("h:v"===n)return[{x:t.x,y:e.y}];if("v:h"===n)return[{x:e.x,y:t.y}];if("h:h"===n)return[{x:i,y:e.y},{x:i,y:t.y}];if("v:v"===n)return[{x:e.x,y:o},{x:t.x,y:o}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}(e,t,n)}function Up(e,t,n,i,o){var r=o&&o.preferredLayouts||[],a=(0,h.FF)(r,"straight")[0]||"h:h",s=$p[a]||0,c=(0,qt.vc)(e,t,s),p=function(e,t){if(Xp(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}(c,a);n=n||(0,qt.pp)(e),i=i||(0,qt.pp)(t);var l=p.split(":"),u=Qp(n,e,l[0],function(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}(c));return function(e,t,n){var i=Gp(e,t,n);return i.unshift(e),i.push(t),Kp(i)}(u,Qp(i,t,l[1],c),p)}function Wp(e,t,n,i,o,r){var a;return(0,h.cy)(n)&&(o=n,r=i,n=(0,qt.pp)(e),i=(0,qt.pp)(t)),o=o||[],a=-1!==(r=(0,h.kp)({preferredLayouts:[]},r)).preferredLayouts.indexOf("straight")&&function(e,t,n,i,o){var r,a,s={};if(a=(0,qt.vc)(e,t),!/^(top|bottom|left|right)$/.test(a))return null;/top|bottom/.test(a)&&(r="x");/left|right/.test(a)&&(r="y");return"target"===o.preserveDocking?Vp(r,i,e)?(s[r]=i[r],[{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y,original:{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y}},{x:i.x,y:i.y}]):null:Vp(r,n,t)?(s[r]=n[r],[{x:n.x,y:n.y},{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y,original:{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y}}]):null}(e,t,n,i,r),a||(a=r.connectionEnd&&function(e,t,n,i){var o=i.slice().reverse();return o=qp(e,t,n,o),o?o.reverse():null}(t,e,i,o),a||((a=r.connectionStart&&qp(e,t,n,o))||(!r.connectionStart&&!r.connectionEnd&&o&&o.length?o:Up(e,t,n,i,r))))}function Vp(e,t,n){return function(e,t,n){return e>=t&&e<=n}(t[e],n[e],n[e]+n[{x:"width",y:"height"}[e]])}function qp(e,t,n,i){if(function(e){return e.length<3||!(e.length>4)&&!!(0,h.I6)(e,function(t,n){var i=e[n-1];return i&&(0,Nn.cK)(t,i)<3})}(i))return null;var o,r=i[0],a=i.slice();return a[0]=n,a[1]=function(e,t,n){switch((0,Nn.ke)(t,e)){case"v":return{x:n.x,y:e.y};case"h":return{x:e.x,y:n.y}}return{x:e.x,y:e.y}}(a[1],r,n),o=function(e,t,n){var i;for(i=e.length-2;0!==i;i--)if((0,Nn.El)(e[i],t,20)||(0,Nn.El)(e[i],n,20))return e.slice(i);return e}(a,e,t),o!==a&&(a=qp(e,t,n,o)),a&&(0,Nn.ke)(a)?null:a}function Xp(e){return e&&/t|r|b|l/.test(e)}function Qp(e,t,n,i){if("h"===n&&(n=/left/.test(i)?"l":"r"),"v"===n&&(n=/top/.test(i)?"t":"b"),"t"===n)return{original:e,x:e.x,y:t.y};if("r"===n)return{original:e,x:t.x+t.width,y:e.y};if("b"===n)return{original:e,x:e.x,y:t.y+t.height};if("l"===n)return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function Kp(e){return e.reduce(function(t,n,i){var o=t[t.length-1],r=e[i+1];return(0,Nn.XP)(o,r,n,0)||t.push(n),t},[])}var Zp={default:["h:h"],fromGateway:["v:h"],toGateway:["h:v"],loop:{fromTop:["t:r"],fromRight:["r:b"],fromLeft:["l:t"],fromBottom:["b:l"]},boundaryLoop:{alternateHorizontalSide:"b",alternateVerticalSide:"l",default:"v"},messageFlow:["straight","v:v"],subProcess:["straight","h:h"],isHorizontal:!0},Yp={default:["v:v"],fromGateway:["h:v"],toGateway:["v:h"],loop:{fromTop:["t:l"],fromRight:["r:t"],fromLeft:["l:b"],fromBottom:["b:r"]},boundaryLoop:{alternateHorizontalSide:"t",alternateVerticalSide:"r",default:"h"},messageFlow:["straight","h:h"],subProcess:["straight","v:v"],isHorizontal:!1},el={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},tl={top:"t",right:"r",bottom:"b",left:"l"};function nl(e){this._elementRegistry=e}function il(e,t){return(0,on.is)(t,"bpmn:Participant")?"source":(0,on.is)(e,"bpmn:Participant")?"target":sl(t)?"source":sl(e)||(0,on.is)(t,"bpmn:Event")?"target":(0,on.is)(e,"bpmn:Event")?"source":null}function ol(e){return sl(e)?"target":"source"}function rl(e,t){return e?e.original||e:(0,qt.pp)(t)}function al(e,t){return(0,on.is)(t,"bpmn:Activity")&&(0,on.is)(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function sl(e){return(0,on.is)(e,"bpmn:SubProcess")&&(0,rn.Av)(e)}function cl(e,t){return e===t}function pl(e){var t=/right|left/.exec(e);return t&&t[0]}function ll(e){var t=/top|bottom/.exec(e);return t&&t[0]}function ul(e,t){return el[e]===t}function hl(e){return"right"===e||"left"===e}function dl(e,t,n){var i=t.waypoints,o=i&&i.length&&(0,qt.vc)(i[0],e);return"top"===o?n.loop.fromTop:"right"===o?n.loop.fromRight:"left"===o?n.loop.fromLeft:n.loop.fromBottom}function fl(e,t,n,i){var o,r,a=(0,qt.pp)(e),s=(0,qt.pp)(t),c=function(e){var t=e.host;return(0,qt.vc)((0,qt.pp)(e),t,-10)}(e),p=cl(e.host,t),l=-1!==["top","right","bottom","left"].indexOf(c),u=(0,qt.vc)(s,a,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return p?function(e,t,n,i,o,r){var a,s=t?e:r.isHorizontal?ll(e):pl(e),c=tl[s];a=t?hl(e)?ml("y",n,i,o)?"h":r.boundaryLoop.alternateHorizontalSide:ml("x",n,i,o)?"v":r.boundaryLoop.alternateVerticalSide:r.boundaryLoop.default;return[c+":"+a]}(c,l,e,t,n,i):(o=function(e,t,n,i){if(n)return tl[e];var o=ll(e),r=pl(e),a=ll(t),s=pl(t);if(i){if(cl(o,a)||ul(r,s))return tl[o]}else if(cl(r,s)||ul(o,a))return tl[r];return tl[i?r:o]}(c,u,l,i.isHorizontal),r=function(e,t,n,i){if(n)return hl(e)?function(e,t){var n=pl(e),i=el[n];return-1!==t.indexOf(i)}(e,t)||cl(e,t)?"h":"v":function(e,t){var n=ll(e),i=el[n];return-1!==t.indexOf(i)}(e,t)||cl(e,t)?"v":"h";return i?cl(ll(e),ll(t))?"h":"v":cl(pl(e),pl(t))?"v":"h"}(c,u,l,i.isHorizontal),[o+":"+r])}function ml(e,t,n,i){return!(vl(e,i,n,40)||vl(e,i,{x:n.x+n.width,y:n.y+n.height},40)||vl(e,i,(0,qt.pp)(t),40))}function vl(e,t,n,i){return Math.abs(t[e]-n[e])<i}function gl(e){return(0,h.kp)({original:e.point.original||e.point},e.actual)}function yl(e,t){this._elementRegistry=e,this._graphicsFactory=t}(0,i.A)(nl,zp),nl.prototype.layoutConnection=function(e,t){t||(t={});var n,i,o=t.source||e.source,r=t.target||e.target,a=t.waypoints||e.waypoints,s=t.connectionStart,c=t.connectionEnd,p=this._elementRegistry;if(s||(s=rl(a&&a[0],o)),c||(c=rl(a&&a[a.length-1],r)),((0,on.is)(e,"bpmn:Association")||(0,on.is)(e,"bpmn:DataAssociation"))&&a&&!al(o,r))return[].concat([s],a.slice(1,-1),[c]);var l=sn(o,p)?Zp:Yp;return(0,on.is)(e,"bpmn:MessageFlow")?n=function(e,t,n){return{preferredLayouts:n.messageFlow,preserveDocking:il(e,t)}}(o,r,l):((0,on.is)(e,"bpmn:SequenceFlow")||al(o,r))&&(n=o===r?{preferredLayouts:dl(o,e,l)}:(0,on.is)(o,"bpmn:BoundaryEvent")?{preferredLayouts:fl(o,r,c,l)}:sl(o)||sl(r)?{preferredLayouts:l.subProcess,preserveDocking:ol(o)}:(0,on.is)(o,"bpmn:Gateway")?{preferredLayouts:l.fromGateway}:(0,on.is)(r,"bpmn:Gateway")?{preferredLayouts:l.toGateway}:{preferredLayouts:l.default}),n&&(i=Kp(Wp(o,r,s,c,a,n=(0,h.kp)(n,t)))),i||[s,c]},nl.$inject=["elementRegistry"],yl.$inject=["elementRegistry","graphicsFactory"],yl.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),o=this.getDockingPoint(e,n),r=e.waypoints.slice(i.idx+1,o.idx);return r.unshift(gl(i)),r.push(gl(o)),r},yl.prototype.getDockingPoint=function(e,t,n){var i,o,r=e.waypoints;return{point:o=r[i=n?0:r.length-1],actual:this._getIntersection(t,e,n)||o,idx:i}},yl.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),o=this._getConnectionPath(t);return(0,qt.ki)(i,o,n)},yl.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)},yl.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)},yl.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};const bl={__init__:["modeling","bpmnUpdater"],__depends__:[Ca,rs,ss,ls,Gs,hc,vc,_c,_n.A,xc.A,lc],bpmnFactory:["type",wc],bpmnUpdater:["type",Ec],elementFactory:["type",Pc],modeling:["type",Op],layouter:["type",nl],connectionDocking:["type",yl]},_l=Math.round;function xl(e,t,n,i,o,r){this._complexPreview=e,this._connectionDocking=t,this._elementFactory=n,this._eventBus=i,this._layouter=o,this._rules=r}xl.prototype.create=function(e,t,n){const i=this._complexPreview,o=this._connectionDocking,r=this._elementFactory,a=this._eventBus,s=this._layouter,c=this._rules,p=r.createShape((0,h.kp)({type:t},n)),l=a.fire("autoPlace",{source:e,shape:p});if(!l)return;(0,h.kp)(p,{x:l.x-_l(p.width/2),y:l.y-_l(p.height/2)});const u=c.allowed("connection.create",{source:e,target:p,hints:{targetParent:e.parent}});let d=null;u&&(d=r.createConnection(u),d.waypoints=s.layoutConnection(d,{source:e,target:p}),d.waypoints=o.getCroppedWaypoints(d,e,p)),i.create({created:[p,d].filter(e=>!(0,h.gD)(e))})},xl.prototype.cleanUp=function(){this._complexPreview.cleanUp()},xl.$inject=["complexPreview","connectionDocking","elementFactory","eventBus","layouter","rules"];const wl={__depends__:[un,Zi,bl],__init__:["appendPreview"],appendPreview:["type",xl]};var El=Math.min,Sl=Math.max;function Cl(e){e.preventDefault()}function kl(e){e.stopPropagation()}function Pl(e){this.container=e.container,this.parent=(0,C.zm)('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=(0,C.P)("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=(0,h.oI)(this.autoResize,this),this.handlePaste=(0,h.oI)(this.handlePaste,this)}function Tl(e,t){this._eventBus=e,this._canvas=t,this._providers=[],this._textbox=new Pl({container:t.getContainer(),keyHandler:(0,h.oI)(this._handleKey,this),resizeHandler:(0,h.oI)(this._handleResize,this)})}Pl.prototype.create=function(e,t,n,i){var o=this.parent,r=this.content,a=this.container;i=this.options=i||{},t=this.style=t||{};var s=(0,h.Up)(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);(0,h.kp)(o.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},s);var c=(0,h.Up)(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return(0,h.kp)(r.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&(0,h.kp)(r.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),r.innerText=n,C.f0.bind(r,"keydown",this.keyHandler),C.f0.bind(r,"mousedown",kl),C.f0.bind(r,"paste",this.handlePaste),i.autoResize&&C.f0.bind(r,"input",this.autoResize),i.resizable&&this.resizable(t),a.appendChild(o),this.setSelection(r.lastChild,r.lastChild&&r.lastChild.length),o},Pl.prototype.handlePaste=function(e){var t,n=this.options,i=this.style;if(e.preventDefault(),t=e.clipboardData?e.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),this.insertText(t),n.autoResize){var o=this.autoResize(i);o&&this.resizeHandler(o)}},Pl.prototype.insertText=function(e){e=e.replace(/\r\n|\r|\n/g,"\n"),document.execCommand("insertText",!1,e)||this._insertTextIE(e)},Pl.prototype._insertTextIE=function(e){var t,n,i,o=this.getSelection(),r=o.startContainer,a=o.endContainer,s=o.startOffset,c=o.endOffset,p=o.commonAncestorContainer,l=(t=p.childNodes,[].slice.call(t));if(p.nodeType===Node.TEXT_NODE){var u=r.textContent;r.textContent=u.substring(0,s)+e+u.substring(c),n=r,i=s+e.length}else if(r===this.content&&a===this.content){var h=document.createTextNode(e);this.content.insertBefore(h,l[s]),n=h,i=h.textContent.length}else{var d=l.indexOf(r),f=l.indexOf(a);l.forEach(function(t,n){n===d?t.textContent=r.textContent.substring(0,s)+e+a.textContent.substring(c):n>d&&n<=f&&(0,C.TF)(t)}),n=r,i=s+e.length}n&&void 0!==i&&setTimeout(function(){self.setSelection(n,i)})},Pl.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),o=t.scrollHeight;e.style.height=o+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:o-i.height})}},Pl.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,o=parseInt(this.style.minHeight)||0,r=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){var s,c,p,l;n=this.resizeHandle=(0,C.zm)('<div class="djs-direct-editing-resize-handle"></div>');var u=function(n){Cl(n),kl(n);var u=El(Sl(p+n.clientX-s,i),r),h=El(Sl(l+n.clientY-c,o),a);t.style.width=u+"px",t.style.height=h+"px",e.resizeHandler({width:p,height:l,dx:n.clientX-s,dy:n.clientY-c})},d=function(e){Cl(e),kl(e),C.f0.unbind(document,"mousemove",u,!1),C.f0.unbind(document,"mouseup",d,!1)};C.f0.bind(n,"mousedown",function(e){Cl(e),kl(e),s=e.clientX,c=e.clientY;var n=t.getBoundingClientRect();p=n.width,l=n.height,C.f0.bind(document,"mousemove",u),C.f0.bind(document,"mouseup",d)})}(0,h.kp)(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)},Pl.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),C.f0.unbind(t,"keydown",this.keyHandler),C.f0.unbind(t,"mousedown",kl),C.f0.unbind(t,"input",this.autoResize),C.f0.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),(0,C.TF)(n)),(0,C.TF)(e)},Pl.prototype.getValue=function(){return this.content.innerText.trim()},Pl.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},Pl.prototype.setSelection=function(e,t){var n=document.createRange();null===e?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)},Tl.$inject=["eventBus","canvas"],Tl.prototype.registerProvider=function(e){this._providers.push(e)},Tl.prototype.isActive=function(e){return!(!this._active||e&&this._active.element!==e)},Tl.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},Tl.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})},Tl.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0,this._canvas.restoreFocus&&this._canvas.restoreFocus()},Tl.prototype.complete=function(){var e=this._active;if(e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),o=this.getValue();o===e.context.text&&i.height===n.height&&i.width===n.width||(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,o,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}},Tl.prototype.getValue=function(){return this._textbox.getValue()},Tl.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;return 27===t?(e.preventDefault(),this.cancel()):13!==t||e.shiftKey?void 0:(e.preventDefault(),this.complete())},Tl.prototype._handleResize=function(e){this._fire("resize",e)},Tl.prototype.activate=function(e){var t;this.isActive()&&this.cancel();var n=(0,h.I6)(this._providers,function(n){return(t=n.activate(e))?n:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};const Al={__depends__:[b.A],__init__:["directEditing"],directEditing:["type",Tl]};var jl=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],Bl=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],Dl=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link intermediate catch event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link intermediate throw event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],Rl=[{label:"Start event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate throw event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel end event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate end event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],Ml=[{label:"Exclusive gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event-based gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],Nl=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],Fl=[{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}}],Ll=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Sub-process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}},{label:"Event sub-process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],Ol=Ll,zl=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"User task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Service task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Send task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"Manual task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business rule task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Script task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub-process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub-process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Ad-hoc sub-process (collapsed)",actionName:"replace-with-collapsed-ad-hoc-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:AdHocSubProcess",isExpanded:!1}},{label:"Ad-hoc sub-process (expanded)",actionName:"replace-with-ad-hoc-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:AdHocSubProcess",isExpanded:!0}}],Il=[{label:"Data store reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],$l=[{label:"Data object reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],Hl=[{label:"Message boundary event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!0}},{label:"Timer boundary event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!0}},{label:"Escalation boundary event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!0}},{label:"Conditional boundary event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!0}},{label:"Error boundary event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",cancelActivity:!0}},{label:"Cancel boundary event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition",cancelActivity:!0}},{label:"Signal boundary event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!0}},{label:"Compensation boundary event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",cancelActivity:!0}},{label:"Message boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal boundary event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],Jl=[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!0}},{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!0}},{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!0}},{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!0}},{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition",isInterrupting:!0}},{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!0}},{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition",isInterrupting:!0}},{label:"Message start event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer start event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional start event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal start event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation start event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],Gl=[{label:"Sequence flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],Ul=[{label:"Expanded pool/participant",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty pool/participant";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}],Wl={"bpmn:MessageEventDefinition":[{label:"Message start event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate catch event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message intermediate throw event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message end event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}}],"bpmn:TimerEventDefinition":[{label:"Timer start event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Timer intermediate catch event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}}],"bpmn:ConditionalEventDefinition":[{label:"Conditional start event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Conditional intermediate catch event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}}],"bpmn:SignalEventDefinition":[{label:"Signal start event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate catch event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal intermediate throw event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal end event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],"bpmn:ErrorEventDefinition":[{label:"Error start event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Error end event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}}],"bpmn:EscalationEventDefinition":[{label:"Escalation start event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation intermediate throw event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Escalation end event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}}],"bpmn:CompensateEventDefinition":[{label:"Compensation start event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation intermediate throw event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Compensation end event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}}]};const Vl='\n  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">\n    <g transform="translate(0 995.64)">\n      <path d="m1899 28.357c21.545 567.43-598.38 1023.5-1133.6 835.92-548.09-147.21-801.57-873.95-463.59-1330 302.62-480.3 1071.7-507.54 1407.6-49.847 122.14 153.12 190.07 348.07 189.59 543.91z" fill="none" stroke="currentColor" stroke-dasharray="418.310422, 361.2328165" stroke-linecap="round" stroke-width="100"/>\n    </g>\n  </svg>',ql='\n  <svg viewBox="0 0 2048 2048" xmlns="http://www.w3.org/2000/svg">\n     <g transform="translate(0 995.64)" fill="none" stroke="currentColor" stroke-linecap="round">\n        <circle cx="1024" cy="28.357" r="875" stroke-dasharray="418.310422, 361.2328165" stroke-width="100"/>\n        <circle cx="1024" cy="28.357" r="685" stroke-dasharray="348.31044857,261.23283643" stroke-dashoffset="500" stroke-width="100"/>\n     </g>\n  </svg>';function Xl(e,t,n,i,o,r,a,s){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=o,this._rules=r,this._translate=a,this._moddleCopy=s,this._register()}Xl.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate","moddleCopy"],Xl.prototype._register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},Xl.prototype.getPopupMenuEntries=function(e){var t,n=e.businessObject,i=this._rules,o=[],r=[];if((0,h.cy)(e)||!i.allowed("shape.replace",{element:e}))return{};var a,s,c=(a=e,function(e){var t=e.target,n=(0,on.Cf)(a),i=n.eventDefinitions&&n.eventDefinitions[0],o=n.$type===t.type,r=(i&&i.$type)===t.eventDefinitionType,s=!!t.triggeredByEvent===!!n.triggeredByEvent,c=void 0===t.isExpanded||t.isExpanded===(0,rn.Av)(a);return!o||!r||!s||!c});if((0,on.is)(n,"bpmn:DataObjectReference"))return this._createEntries(e,Il);if((0,on.is)(n,"bpmn:DataStoreReference")&&!(0,on.is)(e.parent,"bpmn:Collaboration"))return this._createEntries(e,$l);(0,on.is)(n,"bpmn:Event")&&!(0,on.is)(n,"bpmn:BoundaryEvent")&&(t=null===(s=n.get("eventDefinitions")[0])||void 0===s?void 0:s.$type,o=Wl[t]||[],!(0,rn.Q1)(n.$parent)&&(0,on.is)(n.$parent,"bpmn:SubProcess")&&(o=(0,h.pb)(o,function(e){return"bpmn:StartEvent"!==e.target.type})));return(0,on.is)(n,"bpmn:StartEvent")&&!(0,on.is)(n.$parent,"bpmn:SubProcess")?(r=(0,h.pb)(jl.concat(o),c),this._createEntries(e,r)):(0,on.is)(n,"bpmn:Participant")?(r=(0,h.pb)(Ul,function(t){return(0,rn.Av)(e)!==t.target.isExpanded}),this._createEntries(e,r)):(0,on.is)(n,"bpmn:StartEvent")&&(0,rn.Q1)(n.$parent)?(r=(0,h.pb)(Jl.concat(o),function(e){var t=!1!==e.target.isInterrupting,i=n.isInterrupting===t;return c(e)||!c(e)&&!i}),this._createEntries(e,r)):(0,on.is)(n,"bpmn:StartEvent")&&!(0,rn.Q1)(n.$parent)&&(0,on.is)(n.$parent,"bpmn:SubProcess")?(r=(0,h.pb)(Bl.concat(o),c),this._createEntries(e,r)):(0,on.is)(n,"bpmn:EndEvent")?(r=(0,h.pb)(Rl.concat(o),function(e){return!("bpmn:CancelEventDefinition"==e.target.eventDefinitionType&&!(0,on.is)(n.$parent,"bpmn:Transaction"))&&c(e)}),this._createEntries(e,r)):(0,on.is)(n,"bpmn:BoundaryEvent")?(r=(0,h.pb)(Hl,function(e){var t=e.target;if("bpmn:CancelEventDefinition"==t.eventDefinitionType&&!(0,on.is)(n.attachedToRef,"bpmn:Transaction"))return!1;var i=!1!==t.cancelActivity,o=n.cancelActivity==i;return c(e)||!c(e)&&!o}),this._createEntries(e,r)):(0,on.is)(n,"bpmn:IntermediateCatchEvent")||(0,on.is)(n,"bpmn:IntermediateThrowEvent")?(r=(0,h.pb)(Dl.concat(o),c),this._createEntries(e,r)):(0,on.is)(n,"bpmn:Gateway")?(r=(0,h.pb)(Ml,c),this._createEntries(e,r)):(0,on.is)(n,"bpmn:Transaction")?(r=(0,h.pb)(Ll,c),this._createEntries(e,r)):(0,rn.Q1)(n)&&(0,rn.Av)(e)?(r=(0,h.pb)(Ol,c),this._createEntries(e,r)):(0,on.is)(n,"bpmn:AdHocSubProcess")&&(0,rn.Av)(e)?(r=(0,h.pb)(Fl,c),this._createEntries(e,r)):(0,on.is)(n,"bpmn:SubProcess")&&(0,rn.Av)(e)?(r=(0,h.pb)(Nl,c),this._createEntries(e,r)):(0,on.is)(n,"bpmn:SubProcess")&&!(0,rn.Av)(e)?(r=(0,h.pb)(zl,function(t){return t.target.type===e.type===(!0===t.target.isExpanded)}),this._createEntries(e,r)):(0,on.is)(n,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,Gl):(0,on.is)(n,"bpmn:FlowNode")?(r=(0,h.pb)(zl,c),this._createEntries(e,r)):{}},Xl.prototype.getPopupMenuHeaderEntries=function(e){var t={};return(0,on.is)(e,"bpmn:Activity")&&!(0,rn.Q1)(e)&&(t=(0,J.A)((0,J.A)({},t),this._getLoopCharacteristicsHeaderEntries(e))),(0,on.is)(e,"bpmn:DataObjectReference")&&(t=(0,J.A)((0,J.A)({},t),this._getCollectionHeaderEntries(e))),(0,on.is)(e,"bpmn:Participant")&&(t=(0,J.A)((0,J.A)({},t),this._getParticipantMultiplicityHeaderEntries(e))),Dr(e)&&(t=(0,J.A)((0,J.A)({},t),this._getNonInterruptingHeaderEntries(e))),t},Xl.prototype._createEntries=function(e,t){var n={},i=this;return(0,h.jJ)(t,function(t){n[t.actionName]=i._createEntry(t,e)}),n},Xl.prototype._createSequenceFlowEntries=function(e,t){var n=(0,on.Cf)(e),i={},o=this._modeling,r=this._moddle,a=this;return(0,h.jJ)(t,function(t){switch(t.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&((0,on.is)(n.sourceRef,"bpmn:ExclusiveGateway")||(0,on.is)(n.sourceRef,"bpmn:InclusiveGateway")||(0,on.is)(n.sourceRef,"bpmn:ComplexGateway")||(0,on.is)(n.sourceRef,"bpmn:Activity"))&&(i=(0,J.A)((0,J.A)({},i),{},{[t.actionName]:a._createEntry(t,e,function(){o.updateProperties(e.source,{default:n})})}));break;case"replace-with-conditional-flow":!n.conditionExpression&&(0,on.is)(n.sourceRef,"bpmn:Activity")&&(i=(0,J.A)((0,J.A)({},i),{},{[t.actionName]:a._createEntry(t,e,function(){var t=r.create("bpmn:FormalExpression",{body:""});o.updateProperties(e,{conditionExpression:t})})}));break;default:(0,on.is)(n.sourceRef,"bpmn:Activity")&&n.conditionExpression&&(i=(0,J.A)((0,J.A)({},i),{},{[t.actionName]:a._createEntry(t,e,function(){o.updateProperties(e,{conditionExpression:void 0})})})),((0,on.is)(n.sourceRef,"bpmn:ExclusiveGateway")||(0,on.is)(n.sourceRef,"bpmn:InclusiveGateway")||(0,on.is)(n.sourceRef,"bpmn:ComplexGateway")||(0,on.is)(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n&&(i=(0,J.A)((0,J.A)({},i),{},{[t.actionName]:a._createEntry(t,e,function(){o.updateProperties(e.source,{default:void 0})})}))}}),i},Xl.prototype._createEntry=function(e,t,n){var i=this._translate,o=this._bpmnReplace.replaceElement,r=e.label;return r&&"function"===typeof r&&(r=r(t)),n=n||function(){return o(t,e.target)},{label:i(r),className:e.className,action:n}},Xl.prototype._getLoopCharacteristicsHeaderEntries=function(e){var t=this,n=this._translate;function i(n,i){if(i.active)t._modeling.updateProperties(e,{loopCharacteristics:void 0});else{var o=e.businessObject.get("loopCharacteristics");o&&(0,on.is)(o,i.options.loopCharacteristics)?t._modeling.updateModdleProperties(e,o,{isSequential:i.options.isSequential}):(o=t._moddle.create(i.options.loopCharacteristics,{isSequential:i.options.isSequential}),t._modeling.updateProperties(e,{loopCharacteristics:o}))}}var o,r,a,s=(0,on.Cf)(e).loopCharacteristics;return s&&(o=s.isSequential,r=void 0===s.isSequential,a=void 0!==s.isSequential&&!s.isSequential),{"toggle-parallel-mi":{className:"bpmn-icon-parallel-mi-marker",title:n("Parallel multi-instance"),active:a,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},"toggle-sequential-mi":{className:"bpmn-icon-sequential-mi-marker",title:n("Sequential multi-instance"),active:o,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},"toggle-loop":{className:"bpmn-icon-loop-marker",title:n("Loop"),active:r,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}}},Xl.prototype._getCollectionHeaderEntries=function(e){var t=this,n=this._translate,i=e.businessObject.dataObjectRef;if(!i)return{};var o=i.isCollection;return{"toggle-is-collection":{className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:o,action:function(n,o){t._modeling.updateModdleProperties(e,i,{isCollection:!o.active})}}}},Xl.prototype._getParticipantMultiplicityHeaderEntries=function(e){var t=this,n=this._bpmnFactory,i=this._translate;var o=e.businessObject.participantMultiplicity;return{"toggle-participant-multiplicity":{className:"bpmn-icon-parallel-mi-marker",title:i("Participant multiplicity"),active:!!o,action:function(i,o){var r;o.active||(r=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:r})}}}},Xl.prototype._getNonInterruptingHeaderEntries=function(e){const t=this._translate,n=(0,on.Cf)(e),i=this,o=Rr(e),r=(0,on.is)(e,"bpmn:BoundaryEvent")?ql:Vl,a=!n[o];return{"toggle-non-interrupting":{imageHtml:r,title:t("Toggle non-interrupting"),active:a,action:function(){i._modeling.updateProperties(e,{[o]:!!a})}}}};const Ql={__depends__:[Ot,Gs,un],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",Xl]};function Kl(e,t,n,i,o,r,a,s,c,p,l,u,h){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=o,this._elementFactory=r,this._connect=a,this._create=s,this._popupMenu=c,this._canvas=p,this._rules=l,this._translate=u,this._eventBus=n,this._appendPreview=h,!1!==e.autoPlace&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(e){var t=e.context.shape;if((0,ti.Io)(e)&&i.isOpen(t)){var n=i.getEntries(t);n.replace&&n.replace.action.click(e,t)}}),n.on("contextPad.close",function(){h.cleanUp()})}function Zl(e,t,n){var i=e.$instanceOf(t),o=!1,r=e.eventDefinitions||[];return(0,h.jJ)(r,function(e){e.$type===n&&(o=!0)}),i&&o}Kl.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate","appendPreview"],Kl.prototype.getMultiElementContextPadEntries=function(e){var t=this._modeling,n={};return this._isDeleteAllowed(e)&&(0,h.kp)(n,{delete:{group:"edit",className:"bpmn-icon-trash",title:this._translate("Delete"),action:{click:function(e,n){t.removeElements(n.slice())}}}}),n},Kl.prototype._isDeleteAllowed=function(e){var t=this._rules.allowed("elements.delete",{elements:e});return(0,h.cy)(t)?(0,h.Si)(e,e=>t.includes(e)):t},Kl.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,o=this._connect,r=this._create,a=this._popupMenu,s=this._autoPlace,c=this._translate,p=this._appendPreview,l={};if("label"===e.type)return this._isDeleteAllowed([e])&&(0,h.kp)(l,m()),l;var u=e.businessObject;function d(e,t){o.start(e,t)}function f(e,t){n.removeElements([t])}function m(){return{delete:{group:"edit",className:"bpmn-icon-trash",title:c("Delete"),action:{click:f}}}}function v(e,t,n,o){function a(t,n){var a=i.createShape((0,h.kp)({type:e},o));r.start(t,a,{source:n})}var c=s?function(t,n){var r=i.createShape((0,h.kp)({type:e},o));s.append(n,r)}:a,l=s?function(t,n){return p.create(n,e,o),()=>{p.cleanUp()}}:null;return{group:"model",className:t,title:n,action:{dragstart:a,click:c,hover:l}}}function g(e){return function(i,o){n.splitLane(o,e),t.open(o,!0)}}if((0,on.f7)(u,["bpmn:Lane","bpmn:Participant"])&&(0,rn.Av)(e)){var y=Oo(e);(0,h.kp)(l,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:c("Add lane above"),action:{click:function(e,t){n.addLane(t,"top")}}}}),y.length<2&&(((0,rn.$b)(e)?e.height>=120:e.width>=120)&&(0,h.kp)(l,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:c("Divide into two lanes"),action:{click:g(2)}}}),((0,rn.$b)(e)?e.height>=180:e.width>=180)&&(0,h.kp)(l,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:c("Divide into three lanes"),action:{click:g(3)}}})),(0,h.kp)(l,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:c("Add lane below"),action:{click:function(e,t){n.addLane(t,"bottom")}}}})}return(0,on.is)(u,"bpmn:FlowNode")&&((0,on.is)(u,"bpmn:EventBasedGateway")?(0,h.kp)(l,{"append.receive-task":v("bpmn:ReceiveTask","bpmn-icon-receive-task",c("Append receive task")),"append.message-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",c("Append message intermediate catch event"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",c("Append timer intermediate catch event"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",c("Append conditional intermediate catch event"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":v("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",c("Append signal intermediate catch event"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):Zl(u,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?(0,h.kp)(l,{"append.compensation-activity":v("bpmn:Task","bpmn-icon-task",c("Append compensation activity"),{isForCompensation:!0})}):(0,on.is)(u,"bpmn:EndEvent")||u.isForCompensation||Zl(u,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")||(0,rn.Q1)(u)||(0,h.kp)(l,{"append.end-event":v("bpmn:EndEvent","bpmn-icon-end-event-none",c("Append end event")),"append.gateway":v("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",c("Append gateway")),"append.append-task":v("bpmn:Task","bpmn-icon-task",c("Append task")),"append.intermediate-event":v("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",c("Append intermediate/boundary event"))})),a.isEmpty(e,"bpmn-replace")||(0,h.kp)(l,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:c("Change element"),action:{click:function(e,n){var i=(0,h.kp)(function(e){var n=t.getPad(e).html.getBoundingClientRect();return{x:n.left,y:n.bottom+5}}(n),{cursor:{x:e.x,y:e.y}});a.open(n,"bpmn-replace",i,{title:c("Change element"),width:300,search:!0})}}}}),(0,on.is)(u,"bpmn:SequenceFlow")&&(0,h.kp)(l,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))}),(0,on.is)(u,"bpmn:MessageFlow")&&(0,h.kp)(l,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))}),(0,on.f7)(u,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,h.kp)(l,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation")),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect to other element"),action:{click:d,dragstart:d}}}),(0,on.is)(u,"bpmn:TextAnnotation")&&(0,h.kp)(l,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect using association"),action:{click:d,dragstart:d}}}),(0,on.f7)(u,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&(0,h.kp)(l,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:c("Connect using data input association"),action:{click:d,dragstart:d}}}),(0,on.is)(u,"bpmn:Group")&&(0,h.kp)(l,{"append.text-annotation":v("bpmn:TextAnnotation","bpmn-icon-text-annotation",c("Add text annotation"))}),this._isDeleteAllowed([e])&&(0,h.kp)(l,m()),l};const Yl={__depends__:[wl,Al,j,_n.A,Ii,ws,Ql],__init__:["contextPadProvider"],contextPadProvider:["type",Kl]};var eu={horizontal:["x","width"],vertical:["y","height"]};function tu(e,t){this._modeling=e,this._filters=[],this.registerFilter(function(e){var n=t.allowed("elements.distribute",{elements:e});return(0,h.cy)(n)?n:n?e:[]})}tu.$inject=["modeling","rules"],tu.prototype.registerFilter=function(e){if("function"!==typeof e)throw new Error("the filter has to be a function");this._filters.push(e)},tu.prototype.trigger=function(e,t){var n,i,o=this._modeling;if(!(e.length<3)&&(this._setOrientation(t),i=this._filterElements(e),!((n=this._createGroups(i)).length<=2)))return o.distributeElements(n,this._axis,this._dimension),n},tu.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,o=[].concat(e);return t.length?((0,h.jJ)(t,function(e){o=e(o,n,i)}),o):e},tu.prototype._createGroups=function(e){var t=[],n=this,i=this._axis,o=this._dimension;if(!i)throw new Error('must have a defined "axis" and "dimension"');var r=(0,h.Ul)(e,i);return(0,h.jJ)(r,function(e,r){var a,s=n._findRange(e,i,o),c=t[t.length-1];c&&n._hasIntersection(c.range,s)?t[t.length-1].elements.push(e):(a={range:s,elements:[e]},t.push(a))}),t},tu.prototype._setOrientation=function(e){var t=eu[e];this._axis=t[0],this._dimension=t[1]},tu.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)},tu.prototype._findRange=function(e){var t=e[this._axis];return{min:t+5,max:t+e[this._dimension]-5}};const nu={__init__:["distributeElements"],distributeElements:["type",tu]};function iu(e){Gt.call(this,e)}iu.$inject=["eventBus"],(0,i.A)(iu,Gt),iu.prototype.init=function(){this.addRule("elements.distribute",function(e){var t=e.elements;return t=(0,h.pb)(t,function(e){var t=(0,on.f7)(e,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(e.labelTarget||t)}),!((t=(0,Ut.wT)(t)).length<3)&&t})};const ou={horizontal:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n                <polyline points="450 400 450 150 1350 150 1350 400" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>\n                <rect x="150" y="450" width="600" height="1200" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n                <rect x="1050" y="450" width="600" height="800" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n              </svg>',vertical:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1800 1800">\n              <polyline points="400 1350 150 1350 150 450 400 450" style="fill:none;stroke:currentColor;stroke-width:100;stroke-linejoin:round;"/>\n              <rect x="450" y="150" width="1200" height="600" rx="1" style="fill:none;stroke:currentColor;stroke-width:100;"></rect>\n              <rect x="450" y="1050" width="800" height="600" rx="1" style="fill:currentColor;stroke:currentColor;stroke-width:100;opacity:.5;"></rect>\n            </svg>'};function ru(e,t,n,i){this._distributeElements=t,this._translate=n,this._popupMenu=e,this._rules=i,e.registerProvider("align-elements",900,this)}ru.$inject=["popupMenu","distributeElements","translate","rules"],ru.prototype.getPopupMenuEntries=function(e){var t={};return this._isAllowed(e)&&(0,h.kp)(t,this._getEntries(e)),t},ru.prototype._isAllowed=function(e){return this._rules.allowed("elements.distribute",{elements:e})},ru.prototype._getEntries=function(e){var t=this._distributeElements,n=this._translate,i=this._popupMenu;return{"distribute-elements-horizontal":{group:"distribute",title:n("Distribute elements horizontally"),className:"bjs-align-elements-menu-entry",imageHtml:ou.horizontal,action:function(n,o){t.trigger(e,"horizontal"),i.close()}},"distribute-elements-vertical":{group:"distribute",title:n("Distribute elements vertically"),imageHtml:ou.vertical,action:function(n,o){t.trigger(e,"vertical"),i.close()}}}};const au={__depends__:[Ot,nu],__init__:["bpmnDistributeElements","distributeElementsMenuProvider"],bpmnDistributeElements:["type",iu],distributeElementsMenuProvider:["type",ru]};var su="is not a registered action";function cu(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}function pu(e,t){return new Error(e+" "+t)}cu.$inject=["eventBus","injector"],cu.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),o=e.get("zoomScroll",!1),r=e.get("copyPaste",!1),a=e.get("canvas",!1),s=e.get("rules",!1),c=e.get("keyboardMove",!1),p=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),r&&i&&this.register("copy",function(){var e=i.get();if(e.length)return r.copy(e)}),r&&this.register("paste",function(){r.paste()}),o&&this.register("stepZoom",function(e){o.stepZoom(e.value)}),a&&this.register("zoom",function(e){a.zoom(e.value)}),n&&i&&s&&this.register("removeSelection",function(){var e=i.get();if(e.length){var t,o=s.allowed("elements.delete",{elements:e});!1!==o&&(t=(0,h.cy)(o)?o:e).length&&n.removeElements(t.slice())}}),c&&this.register("moveCanvas",function(e){c.moveCanvas(e)}),p&&this.register("moveSelection",function(e){p.moveSelection(e.direction,e.accelerated)})},cu.prototype.trigger=function(e,t){if(!this._actions[e])throw pu(e,su);return this._actions[e](t)},cu.prototype.register=function(e,t){var n=this;if("string"===typeof e)return this._registerAction(e,t);(0,h.jJ)(e,function(e,t){n._registerAction(t,e)})},cu.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw pu(e,"is already registered");this._actions[e]=t},cu.prototype.unregister=function(e){if(!this.isRegistered(e))throw pu(e,su);this._actions[e]=void 0},cu.prototype.getActions=function(){return Object.keys(this._actions)},cu.prototype.isRegistered=function(e){return!!this._actions[e]};const lu={__init__:["editorActions"],editorActions:["type",cu]};function uu(e){e.invoke(cu,this)}(0,i.A)(uu,cu),uu.$inject=["injector"],uu.prototype._registerDefaultActions=function(e){cu.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),o=e.get("spaceTool",!1),r=e.get("lassoTool",!1),a=e.get("handTool",!1),s=e.get("globalConnect",!1),c=e.get("distributeElements",!1),p=e.get("alignElements",!1),l=e.get("directEditing",!1),u=e.get("searchPad",!1),d=e.get("modeling",!1),f=e.get("contextPad",!1);t&&n&&i&&this._registerAction("selectElements",function(){var e=t.getRootElement(),o=n.filter(function(t){return t!==e});return i.select(o),o}),o&&this._registerAction("spaceTool",function(){o.toggle()}),r&&this._registerAction("lassoTool",function(){r.toggle()}),a&&this._registerAction("handTool",function(){a.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&c&&this._registerAction("distributeElements",function(e){var t=i.get(),n=e.type;t.length&&c.trigger(t,n)}),i&&p&&this._registerAction("alignElements",function(e){var t=i.get(),n=[],o=e.type;t.length&&(n=(0,h.pb)(t,function(e){return!(0,on.is)(e,"bpmn:Lane")}),p.trigger(n,o))}),i&&d&&this._registerAction("setColor",function(e){var t=i.get();t.length&&d.setColor(t,e)}),i&&l&&this._registerAction("directEditing",function(){var e=i.get();e.length&&l.activate(e[0])}),u&&this._registerAction("find",function(){u.toggle()}),t&&d&&this._registerAction("moveToOrigin",function(){var e,i,o=t.getRootElement();i=(0,on.is)(o,"bpmn:Collaboration")?n.filter(function(e){return(0,on.is)(e.parent,"bpmn:Collaboration")}):n.filter(function(e){return e!==o&&!(0,on.is)(e.parent,"bpmn:SubProcess")}),e=(0,Ut.U7)(i),d.moveElements(i,{x:-e.x,y:-e.y},o)}),i&&f&&this._registerAction("replaceElement",function(e){f.triggerEntry("replace","click",e)})};const hu={__depends__:[lu],editorActions:["type",uu]};function du(e){e.on(["create.init","shape.move.init"],function(e){var t=e.context,n=e.shape;(0,on.f7)(n,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(t.gridSnappingContext||(t.gridSnappingContext={}),t.gridSnappingContext.snapLocation="top-left")})}du.$inject=["eventBus"];function fu(e,t,n){return n||(n="round"),Math[n](e/t)*t}function mu(e,t,n){var i=!n||!1!==n.active;this._eventBus=t;var o=this;t.on("diagram.init",800,function(){o.setActive(i)}),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],1200,function(t){var n=t.originalEvent;if(!(!o.active||n&&(0,Sn.nM)(n))){var i=t.context,r=i.gridSnappingContext;r||(r=i.gridSnappingContext={}),["x","y"].forEach(function(n){var i={},r=function(e,t,n){var i=e.context,o=e.shape,r=i.gridSnappingContext,a=r.snapLocation,s=r.snapOffset;if(s&&(0,h.Et)(s[t]))return s[t];s||(s=r.snapOffset={});(0,h.Et)(s[t])||(s[t]=0);if(!o)return s[t];n.get(o.id)||(vu(t)?s[t]+=o[t]+o.width/2:s[t]+=o[t]+o.height/2);if(!a)return s[t];"x"===t?/left/.test(a)?s[t]-=o.width/2:/right/.test(a)&&(s[t]+=o.width/2):/top/.test(a)?s[t]-=o.height/2:/bottom/.test(a)&&(s[t]+=o.height/2);return s[t]}(t,n,e);r&&(i.offset=r);var a=function(e,t){var n=e.context,i=n.createConstraints,o=n.resizeConstraints||{},r=n.gridSnappingContext,a=r.snapConstraints;if(a&&a[t])return a[t];a||(a=r.snapConstraints={});a[t]||(a[t]={});var s=n.direction;i&&(vu(t)?(a.x.min=i.left,a.x.max=i.right):(a.y.min=i.top,a.y.max=i.bottom));var c=o.min,p=o.max;c&&(vu(t)?yu(s)?a.x.max=c.left:a.x.min=c.right:gu(s)?a.y.max=c.top:a.y.min=c.bottom);p&&(vu(t)?yu(s)?a.x.min=p.left:a.x.max=p.right:gu(s)?a.y.min=p.top:a.y.max=p.bottom);return a[t]}(t,n);a&&(0,h.kp)(i,a),Ti(t,n)||o.snapEvent(t,n,i)})}})}function vu(e){return"x"===e}function gu(e){return-1!==e.indexOf("n")}function yu(e){return-1!==e.indexOf("w")}function bu(e,t){Jt.A.call(this,e),this._gridSnapping=t;var n=this;this.preExecute("shape.resize",function(e){var t=e.context,i=(t.hints||{}).autoResize;if(i){var o=t.shape,r=t.newBounds;(0,h.Kg)(i)?t.newBounds=n.snapComplex(r,i):t.newBounds=n.snapSimple(o,r)}})}mu.prototype.snapEvent=function(e,t,n){Ai(e,t,this.snapValue(e[t],n))},mu.prototype.getGridSpacing=function(){return 10},mu.prototype.snapValue=function(e,t){var n,i,o=0;return t&&t.offset&&(o=t.offset),e=fu(e+=o,10),t&&t.min&&(n=t.min,(0,h.Et)(n)&&(n=fu(n+o,10,"ceil"),e=Math.max(e,n))),t&&t.max&&(i=t.max,(0,h.Et)(i)&&(i=fu(i+o,10,"floor"),e=Math.min(e,i))),e-=o},mu.prototype.isActive=function(){return this.active},mu.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})},mu.prototype.toggleActive=function(){this.setActive(!this.active)},mu.$inject=["elementRegistry","eventBus","config.gridSnapping"],bu.$inject=["eventBus","gridSnapping","modeling"],(0,i.A)(bu,Jt.A),bu.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t},bu.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e},bu.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),o=/e/.test(t),r={};return r.width=n.snapValue(e.width,{min:e.width}),o&&(i?(r.x=n.snapValue(e.x,{max:e.x}),r.width+=n.snapValue(e.x-r.x,{min:e.x-r.x})):e.x=e.x+e.width-r.width),(0,h.kp)(e,r),e},bu.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),o=/s/.test(t),r={};return r.height=n.snapValue(e.height,{min:e.height}),i&&(o?(r.y=n.snapValue(e.y,{max:e.y}),r.height+=n.snapValue(e.y-r.y,{min:e.y-r.y})):e.y=e.y+e.height-r.height),(0,h.kp)(e,r),e};function _u(e,t){e.on(["spaceTool.move","spaceTool.end"],2e3,function(e){var n,i=e.context;i.initialized&&("x"===i.axis?(n=t.snapValue(e.dx),e.x=e.x+n-e.dx,e.dx=n):(n=t.snapValue(e.dy),e.y=e.y+n-e.dy,e.dy=n))})}_u.$inject=["eventBus","gridSnapping"];const xu={__depends__:[{__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",bu],gridSnappingSpaceToolBehavior:["type",_u]}],__init__:["gridSnapping"],gridSnapping:["type",mu]};function wu(e,t,n){e.on("autoPlace",2e3,function(e){var i=e.source,o=(0,qt.pp)(i),r=e.shape,a=cn(i,r,n);return["x","y"].forEach(function(e){var n={};a[e]!==o[e]&&(a[e]>o[e]?n.min=a[e]:n.max=a[e],(0,on.is)(r,"bpmn:TextAnnotation")&&(!function(e){return"x"===e}(e)?n.offset=-r.height/2:n.offset=-r.width/2),a[e]=t.snapValue(a[e],n))}),a})}wu.$inject=["eventBus","gridSnapping","elementRegistry"];function Eu(e,t,n){t.on(["create.start","shape.move.start"],1750,function(t){var i=t.context,o=i.shape,r=e.getRootElement();(0,on.is)(o,"bpmn:Participant")&&(0,on.is)(r,"bpmn:Process")&&r.children.length&&(i.createConstraints&&(o.width=n.snapValue(o.width,{min:o.width}),o.height=n.snapValue(o.height,{min:o.height})))})}Eu.$inject=["canvas","eventBus","gridSnapping"];function Su(e,t,n){Jt.A.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],3e3,function(e){var t=e.context,o=t.connection,r=t.hints||{},a=o.waypoints;r.connectionStart||r.connectionEnd||!1===r.createElementsBehavior||function(e){return e.length>3}(a)&&n.updateWaypoints(o,i.snapMiddleSegments(a))})}function Cu(e,t,n){var i=(0,Nn.ke)(t,n),o={};return function(e){return"h"===e}(i)&&(o.y=e.snapValue(t.y)),function(e){return"v"===e}(i)&&(o.x=e.snapValue(t.x)),("x"in o||"y"in o)&&(t=(0,h.kp)({},t,o),n=(0,h.kp)({},n,o)),[t,n]}Su.$inject=["eventBus","gridSnapping","modeling"],(0,i.A)(Su,Jt.A),Su.prototype.snapMiddleSegments=function(e){var t,n=this._gridSnapping;e=e.slice();for(var i=1;i<e.length-2;i++)t=Cu(n,e[i],e[i+1]),e[i]=t[0],e[i+1]=t[1];return e};const ku={__depends__:[xu,{__init__:["gridSnappingAutoPlaceBehavior","gridSnappingParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",wu],gridSnappingParticipantBehavior:["type",Eu],gridSnappingLayoutConnectionBehavior:["type",Su]}],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",du]};function Pu(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(e){var t=e.element,i=e.gfx;return(0,on.is)(t,"bpmn:Lane")?n._createParticipantHit(t,i):(0,on.is)(t,"bpmn:Participant")?(0,rn.Av)(t)?n._createParticipantHit(t,i):n._createDefaultHit(t,i):(0,on.is)(t,"bpmn:SubProcess")?(0,rn.Av)(t)?n._createSubProcessHit(t,i):n._createDefaultHit(t,i):void 0})}Pu.$inject=["eventBus","interactionEvents"],Pu.prototype._createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0},Pu.prototype._createParticipantHit=function(e,t){this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height});var n=(0,rn.$b)(e)?{width:30,height:e.height}:{width:e.width,height:30};return this._interactionEvents.createBoxHit(t,"all",n),!0},Pu.prototype._createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"no-move",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:30}),!0};const Tu={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",Pu]};var Au=n(34912),ju=n(23767);function Bu(e){e.invoke(ju.Ay,this)}(0,i.A)(Bu,ju.Ay),Bu.$inject=["injector"],Bu.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}ju.Ay.prototype.registerBindings.call(this,e,t),n("selectElements",function(n){var i=n.keyEvent;if(e.isKey(["a","A"],i)&&e.isCmd(i))return t.trigger("selectElements"),!0}),n("find",function(n){var i=n.keyEvent;if(e.isKey(["f","F"],i)&&e.isCmd(i))return t.trigger("find"),!0}),n("spaceTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["s","S"],i)?(t.trigger("spaceTool"),!0):void 0}),n("lassoTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["l","L"],i)?(t.trigger("lassoTool"),!0):void 0}),n("handTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["h","H"],i)?(t.trigger("handTool"),!0):void 0}),n("globalConnectTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["c","C"],i)?(t.trigger("globalConnectTool"),!0):void 0}),n("directEditing",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["e","E"],i)?(t.trigger("directEditing"),!0):void 0}),n("replaceElement",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["r","R"],i)?(t.trigger("replaceElement",i),!0):void 0})};const Du={__depends__:[Au.A],__init__:["keyboardBindings"],keyboardBindings:["type",Bu]};var Ru={moveSpeed:1,moveSpeedAccelerated:10},Mu="left",Nu="right",Fu="down",Lu={ArrowLeft:Mu,Left:Mu,ArrowUp:"up",Up:"up",ArrowRight:Nu,Right:Nu,ArrowDown:Fu,Down:Fu},Ou={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function zu(e,t,n,i,o){var r=this;this._config=(0,h.kp)({},Ru,e||{}),t.addListener(1500,function(e){var n=e.keyEvent,i=Lu[n.key];if(i&&!t.isCmd(n)){var o=t.isShift(n);return r.moveSelection(i,o),!0}}),this.moveSelection=function(e,t){var r=o.get();if(r.length){var a=this._config[t?"moveSpeedAccelerated":"moveSpeed"],s=Ou[e](a);i.allowed("elements.move",{shapes:r})&&n.moveElements(r,s)}}}zu.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];const Iu={__depends__:[Au.A,_n.A],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",zu]};function $u(e,t,n,i){this._dragging=i,this._rules=t;var o=this;function r(e,t){var n,i=e.shape,r=e.direction,a=e.resizeConstraints;e.delta=t,n=function(e,t,n){var i=n.x,o=n.y,r={x:e.x,y:e.y,width:e.width,height:e.height};return-1!==t.indexOf("n")?(r.y=e.y+o,r.height=e.height-o):-1!==t.indexOf("s")&&(r.height=e.height+o),-1!==t.indexOf("e")?r.width=e.width+i:-1!==t.indexOf("w")&&(r.x=e.x+i,r.width=e.width-i),r}(i,r,t),e.newBounds=function(e,t){if(!t)return e;var n=(0,qt.Fy)(e);return(0,qt.cD)({top:jo("top",n,t),right:jo("right",n,t),bottom:jo("bottom",n,t),left:jo("left",n,t)})}(n,a),e.canExecute=o.canResize(e)}e.on("resize.start",function(e){!function(e){var t=e.resizeConstraints,n=e.minBounds;void 0===t&&(void 0===n&&(n=o.computeMinResizeBox(e)),e.resizeConstraints={min:(0,qt.Fy)(n)})}(e.context)}),e.on("resize.move",function(e){var t={x:e.dx,y:e.dy};r(e.context,t)}),e.on("resize.end",function(e){!function(e){var t=e.shape,i=e.canExecute,o=e.newBounds;if(i){if(!function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}(t,o=(0,qt.Au)(o)))return;n.resizeShape(t,o)}}(e.context)})}function Hu(e,t){var n=(0,qt.pp)(e),i=(0,qt.Fy)(e),o={x:n.x,y:n.y};return-1!==t.indexOf("n")?o.y=i.top:-1!==t.indexOf("s")&&(o.y=i.bottom),-1!==t.indexOf("e")?o.x=i.right:-1!==t.indexOf("w")&&(o.x=i.left),o}function Ju(e){var t="resize-";return"n"===e||"s"===e?t+"ns":"e"===e||"w"===e?t+"ew":"nw"===e||"se"===e?t+"nwse":t+"nesw"}$u.prototype.canResize=function(e){var t=this._rules,n=(0,h.Up)(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)},$u.prototype.activate=function(e,t,n){var i,o,r=this._dragging;if("string"===typeof n&&(n={direction:n}),!(o=(i=(0,h.kp)({shape:t},n)).direction))throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");r.init(e,Hu(t,o),"resize",{autoActivate:!0,cursor:Ju(o),data:{shape:t,context:i}})},$u.prototype.computeMinResizeBox=function(e){var t=e.shape;return function(e,t,n,i){var o=(0,qt.Fy)(t),r={top:/n/.test(e)?o.bottom-n.height:o.top,left:/w/.test(e)?o.right-n.width:o.left,bottom:/s/.test(e)?o.top+n.height:o.bottom,right:/e/.test(e)?o.left+n.width:o.right},a=i?(0,qt.Fy)(i):r,s={top:Po(r.top,a.top),left:Po(r.left,a.left),bottom:ko(r.bottom,a.bottom),right:ko(r.right,a.right)};return(0,qt.cD)(s)}(e.direction,t,e.minDimensions||{width:10,height:10},Ro(t,e.childrenBoxPadding))},$u.$inject=["eventBus","rules","modeling","dragging"];var Gu="djs-resizing",Uu="resize-not-ok";function Wu(e,t,n){e.on("resize.move",500,function(e){!function(e){var i=e.shape,o=e.newBounds,r=e.frame;r||(r=e.frame=n.addFrame(i,t.getActiveLayer()),t.addMarker(i,Gu)),o.width>5&&(0,Fn.CF)(r,{x:o.x,width:o.width}),o.height>5&&(0,Fn.CF)(r,{y:o.y,height:o.height}),e.canExecute?(0,Fn.Ly)(r).remove(Uu):(0,Fn.Ly)(r).add(Uu)}(e.context)}),e.on("resize.cleanup",function(e){!function(e){var n=e.shape;e.frame&&(0,Fn.TF)(e.frame),t.removeMarker(n,Gu)}(e.context)})}Wu.$inject=["eventBus","canvas","previewSupport"];var Vu=-6,qu="djs-resizer",Xu=["n","w","s","e","nw","ne","se","sw"];function Qu(e,t,n,i){this._resize=i,this._canvas=t;var o=this;e.on("selection.changed",function(e){var t=e.newSelection;o.removeResizers(),1===t.length&&(0,h.jJ)(t,(0,h.oI)(o.addResizer,o))}),e.on("shape.changed",function(e){var t=e.element;n.isSelected(t)&&(o.removeResizers(),o.addResizer(t))})}Qu.prototype.makeDraggable=function(e,t,n){var i=this._resize;function o(t){(0,ti.ls)(t)&&i.activate(t,e,n)}C.f0.bind(t,"mousedown",o),C.f0.bind(t,"touchstart",o)},Qu.prototype._createResizer=function(e,t,n,i){var o=this._getResizersParent(),r=function(e){var t={x:0,y:0};-1!==e.indexOf("e")?t.x=6:-1!==e.indexOf("w")&&(t.x=Vu);-1!==e.indexOf("s")?t.y=6:-1!==e.indexOf("n")&&(t.y=Vu);return t}(i),a=(0,Fn.vt)("g");(0,Fn.Ly)(a).add(qu),(0,Fn.Ly)(a).add(qu+"-"+e.id),(0,Fn.Ly)(a).add(qu+"-"+i),(0,Fn.BC)(o,a);var s=(0,Fn.vt)("rect");(0,Fn.CF)(s,{x:-4+r.x,y:-4+r.y,width:8,height:8}),(0,Fn.Ly)(s).add(qu+"-visual"),(0,Fn.BC)(a,s);var c=(0,Fn.vt)("rect");return(0,Fn.CF)(c,{x:-10+r.x,y:-10+r.y,width:20,height:20}),(0,Fn.Ly)(c).add(qu+"-hit"),(0,Fn.BC)(a,c),(0,Ln.pd)(a,t,n),a},Qu.prototype.createResizer=function(e,t){var n=Hu(e,t),i=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,i,t)},Qu.prototype.addResizer=function(e){var t=this;!(0,P.fX)(e)&&this._resize.canResize({shape:e})&&(0,h.jJ)(Xu,function(n){t.createResizer(e,n)})},Qu.prototype.removeResizers=function(){var e=this._getResizersParent();(0,Fn.IU)(e)},Qu.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},Qu.$inject=["eventBus","canvas","selection","resize"];const Ku={__depends__:[Mn,An,Xi],__init__:["resize","resizePreview","resizeHandles"],resize:["type",$u],resizePreview:["type",Wu],resizeHandles:["type",Qu]};function Zu(e,t,n,i,o,r,a){function s(e,t){(t||(0,on.f7)(e,["bpmn:Task","bpmn:TextAnnotation","bpmn:Participant"])||Yu(e))&&i.activate(e)}this._bpmnFactory=t,this._canvas=n,this._modeling=o,this._textRenderer=a,i.registerProvider(this),e.on("element.dblclick",function(e){s(e.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open","root.set","selection.changed"],function(){i.isActive()&&i.complete()}),e.on(["shape.remove","connection.remove"],2e3,function(e){i.isActive(e.element)&&i.cancel()}),e.on(["commandStack.changed"],function(e){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(e){r.removeResizers()}),e.on("create.end",500,function(e){var t=e.context,n=t.shape,i=e.context.canExecute;e.isTouch||i&&(t.hints&&!1===t.hints.createElementsBehavior||s(n))}),e.on("autoPlace.end",500,function(e){s(e.shape)})}function Yu(e){return(0,on.is)(e,"bpmn:SubProcess")&&!(0,rn.Av)(e)}Zu.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"],Zu.prototype.activate=function(e){var t=(0,Yi.p9)(e);if(void 0!==t){var n={text:t},i=this.getEditingBBox(e);(0,h.kp)(n,i);var o={},r=n.style||{};return(0,h.kp)(r,{backgroundColor:null,border:null}),((0,on.f7)(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||Yu(e))&&(0,h.kp)(o,{centerVertically:!0}),(0,Yi.UC)(e)&&((0,h.kp)(o,{autoResize:!0}),(0,h.kp)(r,{backgroundColor:"#ffffff",border:"1px solid #ccc"})),(0,on.is)(e,"bpmn:TextAnnotation")&&((0,h.kp)(o,{resizable:!0,autoResize:!0}),(0,h.kp)(r,{backgroundColor:"#ffffff",border:"1px solid #ccc"})),(0,h.kp)(n,{options:o,style:r}),n}},Zu.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),o=i.x+i.width/2,r=i.y+i.height/2,a={x:i.x,y:i.y},s=t.zoom(),c=this._textRenderer.getDefaultStyle(),p=this._textRenderer.getExternalStyle(),l=p.fontSize*s,u=p.lineHeight,d=c.fontSize*s,f=c.lineHeight,m={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};if((0,on.is)(e,"bpmn:Lane")||function(e){return(0,on.is)(e,"bpmn:Participant")&&(0,rn.Av)(e)}(e)){var v=(0,rn.$b)(e),g=v?{width:i.height,height:30*s,x:i.x-i.height/2+15*s,y:r-30*s/2}:{width:i.width,height:30*s};(0,h.kp)(a,g),(0,h.kp)(m,{fontSize:d+"px",lineHeight:f,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px",transform:v?"rotate(-90deg)":null})}if(function(e){return(0,on.is)(e,"bpmn:Participant")&&!(0,rn.Av)(e)}(e)){var y=(0,rn.$b)(e),b=y?{width:i.width,height:i.height}:{width:i.height,height:i.width,x:o-i.height/2,y:r-i.width/2};(0,h.kp)(a,b),(0,h.kp)(m,{fontSize:d+"px",lineHeight:f,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px",transform:y?null:"rotate(-90deg)"})}((0,on.f7)(e,["bpmn:Task","bpmn:CallActivity"])||Yu(e))&&((0,h.kp)(a,{width:i.width,height:i.height}),(0,h.kp)(m,{fontSize:d+"px",lineHeight:f,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px"})),function(e){return(0,on.is)(e,"bpmn:SubProcess")&&(0,rn.Av)(e)}(e)&&((0,h.kp)(a,{width:i.width,x:i.x}),(0,h.kp)(m,{fontSize:d+"px",lineHeight:f,paddingTop:7*s+"px",paddingBottom:7*s+"px",paddingLeft:5*s+"px",paddingRight:5*s+"px"}));var _=90*s,x=7*s,w=4*s;if(n.labelTarget&&((0,h.kp)(a,{width:_,height:i.height+x+w,x:o-_/2,y:i.y-x}),(0,h.kp)(m,{fontSize:l+"px",lineHeight:u,paddingTop:x+"px",paddingBottom:w+"px"})),(0,Yi.UC)(n)&&!(0,Yi.ur)(n)&&!(0,P.J2)(n)){var E=(0,Yi.QX)(e),S=t.getAbsoluteBBox({x:E.x,y:E.y,width:0,height:0}),C=l+x+w;(0,h.kp)(a,{width:_,height:C,x:S.x-_/2,y:S.y-C/2}),(0,h.kp)(m,{fontSize:l+"px",lineHeight:u,paddingTop:x+"px",paddingBottom:w+"px"})}return(0,on.is)(e,"bpmn:TextAnnotation")&&((0,h.kp)(a,{width:i.width,height:i.height,minWidth:30*s,minHeight:10*s}),(0,h.kp)(m,{textAlign:"left",paddingTop:5*s+"px",paddingBottom:7*s+"px",paddingLeft:7*s+"px",paddingRight:5*s+"px",fontSize:d+"px",lineHeight:f})),{bounds:a,style:m}},Zu.prototype.update=function(e,t,n,i){var o,r,a;(0,on.is)(e,"bpmn:TextAnnotation")&&(r=this._canvas.getAbsoluteBBox(e),o={x:e.x,y:e.y,width:e.width/r.width*i.width,height:e.height/r.height*i.height}),(a=t)&&a.trim()||(t=null),this._modeling.updateLabel(e,t,o)};var eh="djs-element-hidden",th="djs-label-hidden";function nh(e,t,n){var i,o,r,a=this,s=t.getDefaultLayer();e.on("directEditing.activate",function(e){var c=e.active;if(i=c.element.label||c.element,(0,on.is)(i,"bpmn:TextAnnotation")){o=t.getAbsoluteBBox(i),r=(0,Fn.vt)("g");var p=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:i.width,containerHeight:i.height,position:{mx:0,my:0}}),l=a.path=(0,Fn.vt)("path");(0,Fn.CF)(l,{d:p,strokeWidth:2,stroke:ih(i)}),(0,Fn.BC)(r,l),(0,Fn.BC)(s,r),(0,Ln.Tl)(r,i.x,i.y)}(0,on.is)(i,"bpmn:TextAnnotation")||i.labelTarget?t.addMarker(i,eh):((0,on.is)(i,"bpmn:Task")||(0,on.is)(i,"bpmn:CallActivity")||(0,on.is)(i,"bpmn:SubProcess")||(0,on.is)(i,"bpmn:Participant")||(0,on.is)(i,"bpmn:Lane"))&&t.addMarker(i,th)}),e.on("directEditing.resize",function(e){if((0,on.is)(i,"bpmn:TextAnnotation")){var t=e.height,r=e.dy,s=Math.max(i.height/o.height*(t+r),0),c=n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:i.width,containerHeight:s,position:{mx:0,my:0}});(0,Fn.CF)(a.path,{d:c})}}),e.on(["directEditing.complete","directEditing.cancel"],function(e){var n=e.active;n&&(t.removeMarker(n.element.label||n.element,eh),t.removeMarker(i,th)),i=void 0,o=void 0,r&&((0,Fn.TF)(r),r=void 0)})}function ih(e,t){return(0,on.S2)(e).get("stroke")||t||"black"}nh.$inject=["eventBus","canvas","pathMap"];const oh={__depends__:[xc.A,Ku,Al],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",Zu],labelEditingPreview:["type",nh]};var rh=new x.A("tt");function ah(e,t){e.style.display=!1===t?"none":""}var sh="djs-tooltip",ch="."+sh;function ph(e,t){this._eventBus=e,this._canvas=t,this._ids=rh,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=function(e){var t=(0,C.zm)('<div class="djs-tooltip-container" />');return(0,C.HZ)(t,{position:"absolute",width:"0",height:"0"}),e.insertBefore(t,e.firstChild),t}(t.getContainer());var n=this;C.Mm.bind(this._tooltipRoot,ch,"mousedown",function(e){e.stopPropagation()}),C.Mm.bind(this._tooltipRoot,ch,"mouseover",function(e){n.trigger("mouseover",e)}),C.Mm.bind(this._tooltipRoot,ch,"mouseout",function(e){n.trigger("mouseout",e)}),this._init()}ph.$inject=["eventBus","canvas"],ph.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=(0,h.kp)({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t},ph.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get((0,C.CF)(n,"data-tooltip-id"));i&&("mouseover"===e&&i.timeout&&this.clearTimeout(i),"mouseout"===e&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))},ph.prototype.get=function(e){return"string"!==typeof e&&(e=e.id),this._tooltips[e]},ph.prototype.clearTimeout=function(e){if(e=this.get(e)){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}},ph.prototype.setTimeout=function(e){if(e=this.get(e)){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}},ph.prototype.remove=function(e){var t=this.get(e);t&&((0,C.TF)(t.html),(0,C.TF)(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])},ph.prototype.show=function(){ah(this._tooltipRoot)},ph.prototype.hide=function(){ah(this._tooltipRoot,!1)},ph.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i},ph.prototype._addTooltip=function(e){var t,n=e.id,i=e.html,o=this._tooltipRoot;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),(0,h.Kg)(i)&&(i=(0,C.zm)(i)),t=(0,C.zm)('<div data-tooltip-id="'+n+'" class="'+sh+'">'),(0,C.HZ)(t,{position:"absolute"}),t.appendChild(i),e.type&&(0,C.Ly)(t).add("djs-tooltip-"+e.type),e.className&&(0,C.Ly)(t).add(e.className),e.htmlContainer=t,o.appendChild(t),this._tooltips[n]=e,this._updateTooltip(e)},ph.prototype._updateTooltip=function(e){var t=e.position;!function(e,t,n){(0,C.HZ)(e,{left:t+"px",top:n+"px"})}(e.htmlContainer,t.x,t.y)},ph.prototype._updateTooltipVisibilty=function(e){(0,h.jJ)(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,o=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(o=!1),ah(i,o))})},ph.prototype._init=function(){var e=this;this._eventBus.on("canvas.viewbox.changing",function(t){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(t){var n;n=t.viewbox,e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()})};const lh={__init__:["tooltips"],tooltips:["type",ph]};function uh(e,t,n){function i(e,n,i){t.add({position:{x:e.x+5,y:e.y+5},type:"error",timeout:i||2e3,html:"<div>"+n+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(e){var t=e.context,o=t.shape,r=t.target;(0,on.is)(r,"bpmn:Collaboration")&&((0,on.is)(o,"bpmn:FlowNode")?i(e,n("flow elements must be children of pools/participants")):(0,on.is)(o,"bpmn:DataObjectReference")&&i(e,n("Data object must be placed within a pool/participant.")))})}uh.$inject=["eventBus","tooltips","translate"];const hh={__depends__:[lh],__init__:["modelingFeedback"],modelingFeedback:["type",uh]};function dh(e,t){this._eventBus=e,this.offset=5;var n=t.cls("djs-outline",["no-fill"]),i=this;function o(e){var t=(0,Fn.vt)("rect");return(0,Fn.CF)(t,(0,h.kp)({x:0,y:0,rx:4,width:100,height:100},n)),t}e.on(["shape.added","shape.changed"],500,function(e){var t=e.element,n=e.gfx,r=(0,C.P)(".djs-outline",n);r||(r=i.getOutline(t)||o(),(0,Fn.BC)(n,r)),i.updateShapeOutline(r,t)}),e.on(["connection.added","connection.changed"],function(e){var t=e.element,n=e.gfx,r=(0,C.P)(".djs-outline",n);r||(r=o(),(0,Fn.BC)(n,r)),i.updateConnectionOutline(r,t)})}dh.prototype.updateShapeOutline=function(e,t){var n=!1,i=this._getProviders();i.length&&(0,h.jJ)(i,function(i){n=n||i.updateOutline(t,e)}),n||(0,Fn.CF)(e,{x:-this.offset,y:-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},dh.prototype.updateConnectionOutline=function(e,t){var n=(0,Ut.U7)(t);(0,Fn.CF)(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},dh.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("outline.getProviders",e,function(e){e.providers.push(t)})},dh.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"outline.getProviders",providers:[]});return this._eventBus.fire(e),e.providers},dh.prototype.getOutline=function(e){var t,n=this._getProviders();return(0,h.jJ)(n,function(n){(0,h.Tn)(n.getOutline)&&(t=t||n.getOutline(e))}),t},dh.$inject=["eventBus","styles","elementRegistry"];function fh(e,t,n){this._canvas=t;var i=this;e.on("element.changed",function(e){n.isSelected(e.element)&&i._updateMultiSelectionOutline(n.get())}),e.on("selection.changed",function(e){var t=e.newSelection;i._updateMultiSelectionOutline(t)})}fh.prototype._updateMultiSelectionOutline=function(e){var t=this._canvas.getLayer("selectionOutline");(0,Fn.IU)(t);var n=e.length>1,i=this._canvas.getContainer();if((0,Fn.Ly)(i)[n?"add":"remove"]("djs-multi-select"),n){var o=function(e){return{x:e.x-6,y:e.y-6,width:e.width+12,height:e.height+12}}((0,Ut.U7)(e)),r=(0,Fn.vt)("rect");(0,Fn.CF)(r,(0,h.kp)({rx:3},o)),(0,Fn.Ly)(r).add("djs-selection-outline"),(0,Fn.BC)(t,r)}},fh.$inject=["eventBus","canvas","selection"];const mh={__depends__:[_n.A],__init__:["outline","multiSelectionOutline"],outline:["type",dh],multiSelectionOutline:["type",fh]};var vh=Math.round;function gh(e,t,n,i,o){function r(e,t,n,i){return o.allowed("elements.move",{shapes:e,delta:t,position:n,target:i})}function a(e,n,i,o){if((0,h.Gv)(i)&&(o=i,i=!1),!n.waypoints&&n.parent&&!(0,Fn.Ly)(e.target).has("djs-hit-no-move")){var r=function(e){return{x:e.x+vh(e.width/2),y:e.y+vh(e.height/2)}}(n);return t.init(e,r,"shape.move",{cursor:"grabbing",autoActivate:i,data:{shape:n,context:o||{}}}),!0}}e.on("shape.move.start",1500,function(e){var t=e.context,n=e.shape,o=i.get().slice();-1===o.indexOf(n)&&(o=[n]),o=function(e){var t=(0,h.$z)(e,"id");return(0,h.pb)(e,function(e){for(;e=e.parent;)if(t[e.id])return!1;return!0})}(o),(0,h.kp)(t,{shapes:o,validatedShapes:o,shape:n})}),e.on("shape.move.start",1250,function(e){var t=e.context,n=t.validatedShapes;if(!(t.canExecute=r(n)))return!1}),e.on("shape.move.move",500,function(e){var t,n=e.context,i=n.validatedShapes,o=e.hover,a={x:e.dx,y:e.dy};t=r(i,a,{x:e.x,y:e.y},o),n.delta=a,n.canExecute=t,n.target=null!==t?o:null}),e.on("shape.move.end",function(e){var t=e.context,i=t.delta,o=t.canExecute,r="attach"===o,a=t.shapes;if(!1===o)return!1;i.x=vh(i.x),i.y=vh(i.y),0===i.x&&0===i.y||n.moveElements(a,i,t.target,{primaryShape:t.shape,attach:r})}),e.on("element.mousedown",function(e){if((0,ti.ls)(e)){var t=(0,gn.AF)(e);if(!t)throw new Error("must supply DOM mousedown event");return a(t,e.element)}}),this.start=a}gh.$inject=["eventBus","dragging","modeling","selection","rules"];var yh="djs-dragging",bh="drop-ok",_h="drop-not-ok",xh="new-parent",wh="attach-ok";function Eh(e,t,n,i){function o(e){var t=function(e){var t=(0,h.pb)(e,function(t){return!(0,P.fX)(t)||(0,h.I6)(e,(0,h.gH)({id:t.source.id}))&&(0,h.I6)(e,(0,h.gH)({id:t.target.id}))});return t}(r(e));return t}function r(e){var t=(0,Ut.cZ)(e,!0),n=t.flatMap(e=>(e.incoming||[]).concat(e.outgoing||[])),i=t.concat(n);return[...new Set(i)]}function a(e,n){[wh,bh,_h,xh].forEach(function(i){i===n?t.addMarker(e,i):t.removeMarker(e,i)})}e.on("shape.move.start",499,function(e){var a,s=e.context,c=s.shapes,p=s.allDraggedElements,l=o(c);if(!s.dragGroup){var u=(0,Fn.vt)("g");(0,Fn.CF)(u,n.cls("djs-drag-group",["no-events"]));var d=t.getActiveLayer();(0,Fn.BC)(d,u),s.dragGroup=u}l.forEach(function(e){i.addDragger(e,s.dragGroup)}),p=p?(0,h.Bq)([p,r(c)]):r(c),(0,h.jJ)(p,function(e){t.addMarker(e,yh)}),s.allDraggedElements=p,s.differentParents=(a=c,1!==(0,h.Ej)((0,h.$z)(a,function(e){return e.parent&&e.parent.id})))}),e.on("shape.move.move",499,function(e){var t=e.context,n=t.dragGroup,i=t.target,o=t.shape.parent,r=t.canExecute;i&&("attach"===r?a(i,wh):t.canExecute&&o&&i.id!==o.id?a(i,xh):a(i,t.canExecute?bh:_h)),(0,Ln.Tl)(n,e.dx,e.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(e){var t=e.context.target;t&&a(t,null)}),e.on("shape.move.cleanup",function(e){var n=e.context,i=n.allDraggedElements,o=n.dragGroup;(0,h.jJ)(i,function(e){t.removeMarker(e,yh)}),o&&(0,Fn.TF)(o)}),this.makeDraggable=function(e,n,o){i.addDragger(n,e.dragGroup),o&&t.addMarker(n,yh),e.allDraggedElements?e.allDraggedElements.push(n):e.allDraggedElements=[n]}}Eh.$inject=["eventBus","canvas","styles","previewSupport"];const Sh={__depends__:[b.A,_n.A,mh,Mn,An,Xi],__init__:["move","movePreview"],move:["type",gh],movePreview:["type",Eh]};var Ch=".djs-palette-toggle",kh=".entry",Ph=Ch+", "+kh,Th="djs-palette-",Ah="open",jh="two-column";function Bh(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(e){var t=e.tool;n.updateToolHighlight(t)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}function Dh(e,t){var n=t.getPaletteEntries();return(0,h.Tn)(n)?n(e):((0,h.jJ)(n,function(t,n){e[n]=t}),e)}Bh.$inject=["eventBus","canvas"],Bh.prototype.registerProvider=function(e,t){t||(t=e,e=1e3),this._eventBus.on("palette.getProviders",e,function(e){e.providers.push(t)}),this._rebuild()},Bh.prototype.getEntries=function(){return this._getProviders().reduce(Dh,{})},Bh.prototype._rebuild=function(){this._diagramInitialized&&(this._getProviders().length&&(this._container||this._init(),this._update()))},Bh.prototype._init=function(){var e=this,t=this._eventBus,n=this._getParentContainer(),i=this._container=(0,C.zm)(Bh.HTML_MARKUP);n.appendChild(i),(0,C.Ly)(n).add(Th+"shown"),C.Mm.bind(i,Ph,"click",function(t){var n=t.delegateTarget;if((0,C.cK)(n,Ch))return e.toggle();e.trigger("click",t)}),C.f0.bind(i,"mousedown",function(e){e.stopPropagation()}),C.Mm.bind(i,kh,"dragstart",function(t){e.trigger("dragstart",t)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})},Bh.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers},Bh.prototype._toggleState=function(e){e=e||{};var t,n=this._getParentContainer(),i=this._container,o=this._eventBus,r=(0,C.Ly)(i),a=(0,C.Ly)(n);t="twoColumn"in e?e.twoColumn:this._needsCollapse(n.clientHeight,this._entries||{}),r.toggle(jh,t),a.toggle(Th+jh,t),"open"in e&&(r.toggle(Ah,e.open),a.toggle(Th+Ah,e.open)),o.fire("palette.changed",{twoColumn:t,open:this.isOpen()})},Bh.prototype._update=function(){var e=(0,C.P)(".djs-palette-entries",this._container),t=this._entries=this.getEntries();(0,C.IU)(e),(0,h.jJ)(t,function(t,n){var i=t.group||"default",o=(0,C.P)("[data-group="+(0,k.F)(i)+"]",e);o||(o=(0,C.zm)('<div class="group"></div>'),(0,C.CF)(o,"data-group",i),e.appendChild(o));var r=t.html||(t.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),a=(0,C.zm)(r);if(o.appendChild(a),!t.separator&&((0,C.CF)(a,"data-action",n),t.title&&(0,C.CF)(a,"title",t.title),t.className&&function(e,t){var n=(0,C.Ly)(e);((0,h.cy)(t)?t:t.split(/\s+/g)).forEach(function(e){n.add(e)})}(a,t.className),t.imageUrl)){var s=(0,C.zm)("<img>");(0,C.CF)(s,"src",t.imageUrl),a.appendChild(s)}}),this.open()},Bh.prototype.trigger=function(e,t,n){var i,o,r=t.delegateTarget||t.target;return r?(i=(0,C.CF)(r,"data-action"),o=t.originalEvent||t,this.triggerEntry(i,e,o,n)):t.preventDefault()},Bh.prototype.triggerEntry=function(e,t,n,i){var o,r;if((o=this._entries[e])&&(r=o.action,!1!==this._eventBus.fire("palette.trigger",{entry:o,event:n}))){if((0,h.Tn)(r)){if("click"===t)return r(n,i)}else if(r[t])return r[t](n,i);n.preventDefault()}},Bh.prototype._layoutChanged=function(){this._toggleState({})},Bh.prototype._needsCollapse=function(e,t){return e<46*Object.keys(t).length+50},Bh.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},Bh.prototype.open=function(){this._toggleState({open:!0})},Bh.prototype.toggle=function(){this.isOpen()?this.close():this.open()},Bh.prototype.isActiveTool=function(e){return e&&this._activeTool===e},Bh.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=(0,C.P)(".djs-palette-entries",this._container),this._toolsContainer=(0,C.P)("[data-group=tools]",t)),n=this._toolsContainer,(0,h.jJ)(n.children,function(t){var n=t.getAttribute("data-action");if(n){var i=(0,C.Ly)(t);n=n.replace("-tool",""),i.contains("entry")&&n===e?i.add("highlighted-entry"):i.remove("highlighted-entry")}})},Bh.prototype.isOpen=function(){return(0,C.Ly)(this._container).has(Ah)},Bh.prototype._getParentContainer=function(){return this._canvas.getContainer()},Bh.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';const Rh={__init__:["palette"],palette:["type",Bh]};var Mh="crosshair";function Nh(e,t,n,i,o,r,a){this._selection=o,this._dragging=n,this._mouse=a;var s=this,c=function(e){var n,i=t.getActiveLayer();n=e.frame=(0,Fn.vt)("rect"),(0,Fn.CF)(n,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),(0,Fn.BC)(i,n)},p=function(e){var t=e.frame,n=e.bbox;(0,Fn.CF)(t,{x:n.x,y:n.y,width:n.width,height:n.height})},l=function(e){e.frame&&(0,Fn.TF)(e.frame)};r.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(t){var n=t.originalEvent.target;(t.hover||n instanceof SVGElement)&&e.once("lasso.selection.ended",function(){s.activateLasso(t.originalEvent,!0)})}),e.on("lasso.end",0,function(e){var t=e.context,n=Fh(e),o=i.filter(function(e){return e}),r=(0,ti.KH)(e);s.select(o,n,r?t.selection:[])}),e.on("lasso.start",function(e){var t=e.context;t.bbox=Fh(e),c(t),t.selection=o.get()}),e.on("lasso.move",function(e){var t=e.context;t.bbox=Fh(e),p(t)}),e.on("lasso.cleanup",function(e){var t=e.context;l(t)}),e.on("element.mousedown",1500,function(e){if((0,ti.KH)(e))return s.activateLasso(e.originalEvent),!0})}function Fh(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y};return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?{x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?{x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?{x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?{x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:{x:n.x,y:n.y,width:0,height:0}}Nh.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"],Nh.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:Mh,data:{context:{}}})},Nh.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:Mh,data:{context:{}},keepSelection:!0})},Nh.prototype.select=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];var i=(0,Ut.rx)(e,t);this._selection.select([...n,...(0,h.zu)(i)])},Nh.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)},Nh.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};const Lh={__depends__:[Ws,Ss],__init__:["lassoTool"],lassoTool:["type",Nh]};var Oh=1500,zh="grab";function Ih(e,t,n,i,o,r){this._dragging=n,this._mouse=r;var a=this,s=i.get("keyboard",!1);o.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",Oh,function(e){if((0,ti.Io)(e))return a.activateMove(e.originalEvent,!0),!1}),s&&s.addListener(Oh,function(e){if($h(e.keyEvent)&&!a.isActive()){var t=a._mouse.getLastMoveEvent();a.activateMove(t,!!t)}},"keyboard.keydown"),s&&s.addListener(Oh,function(e){$h(e.keyEvent)&&a.isActive()&&a.toggle()},"keyboard.keyup"),e.on("hand.end",function(t){var n=t.originalEvent.target;if(!t.hover&&!(n instanceof SVGElement))return!1;e.once("hand.ended",function(){a.activateMove(t.originalEvent,{reactivate:!0})})}),e.on("hand.move.move",function(e){var n=t.viewbox().scale;t.scroll({dx:e.dx*n,dy:e.dy*n})}),e.on("hand.move.end",function(t){var n=t.context.reactivate;return!(0,ti.Io)(t)&&n&&e.once("hand.move.ended",function(e){a.activateHand(e.originalEvent,!0,!0)}),!1})}function $h(e){return(0,Sn.m0)("Space",e)}Ih.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"],Ih.prototype.activateMove=function(e,t,n){"object"===typeof t&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:zh,data:{context:n||{}}})},Ih.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:zh,data:{context:{reactivate:n}}})},Ih.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)},Ih.prototype.isActive=function(){var e=this._dragging.context();return!!e&&/^(hand|hand\.move)$/.test(e.prefix)};const Hh={__depends__:[Ws,Ss],__init__:["handTool"],handTool:["type",Ih]};var Jh="connect-ok",Gh="connect-not-ok";function Uh(e,t,n,i,o,r,a){var s=this;this._dragging=t,this._rules=r,this._mouse=a,o.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(e){var t=e.context,n=e.hover,o=t.canStartConnect=s.canStartConnect(n);null!==o&&(t.startTarget=n,i.addMarker(n,o?Jh:Gh))}),e.on(["global-connect.out","global-connect.cleanup"],function(e){var t=e.context.startTarget,n=e.context.canStartConnect;t&&i.removeMarker(t,n?Jh:Gh)}),e.on(["global-connect.ended"],function(t){var i=t.context.startTarget,o={x:t.x,y:t.y};if(s.canStartConnect(i))return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,i,o)}),!1})}Uh.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"],Uh.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})},Uh.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)},Uh.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)},Uh.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};const Wh={__depends__:[Ii,Mn,An,Ws,Ss],globalConnect:["type",Uh]};var Vh=n(32328);function qh(e,t,n,i,o,r,a,s){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=o,this._handTool=r,this._globalConnect=a,this._translate=s,e.registerProvider(this)}qh.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"],qh.prototype.getPaletteEntries=function(){var e={},t=this._create,n=this._elementFactory,i=this._spaceTool,o=this._lassoTool,r=this._handTool,a=this._globalConnect,s=this._translate;function c(e,i,o,r,a){function s(i){var o=n.createShape((0,h.kp)({type:e},a));t.start(i,o)}return{group:i,className:o,title:r,action:{dragstart:s,click:s}}}function p(e){var i=n.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),o=n.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:i});t.start(e,[i,o],{hints:{autoSelect:[i]}})}function l(e){t.start(e,n.createParticipantShape())}return(0,h.kp)(e,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:s("Activate hand tool"),action:{click:function(e){r.activateHand(e)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:s("Activate lasso tool"),action:{click:function(e){o.activateSelection(e)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:s("Activate create/remove space tool"),action:{click:function(e){i.activateSelection(e)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:s("Activate global connect tool"),action:{click:function(e){a.start(e)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":c("bpmn:StartEvent","event","bpmn-icon-start-event-none",s("Create start event")),"create.intermediate-event":c("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",s("Create intermediate/boundary event")),"create.end-event":c("bpmn:EndEvent","event","bpmn-icon-end-event-none",s("Create end event")),"create.exclusive-gateway":c("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",s("Create gateway")),"create.task":c("bpmn:Task","activity","bpmn-icon-task",s("Create task")),"create.data-object":c("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",s("Create data object reference")),"create.data-store":c("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",s("Create data store reference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:s("Create expanded sub-process"),action:{dragstart:p,click:p}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:s("Create pool/participant"),action:{dragstart:l,click:l}},"create.group":c("bpmn:Group","artifact","bpmn-icon-group",s("Create group"))}),e};const Xh={__depends__:[Rh,ws,lc,Lh,Hh,Wh,Vh.A],__init__:["paletteProvider"],paletteProvider:["type",qh]};function Qh(e,t,n,i,o){Jt.A.call(this,e),e.on("shape.move.move",250,function(e){var r=e.context,a=r.canExecute;r.visualReplacements||(r.visualReplacements={}),a&&a.replacements?function(e){var r=e.canExecute.replacements;(0,h.jJ)(r,function(r){var a=r.oldElementId,s={type:r.newElementType};if(!e.visualReplacements[a]){var c=t.get(a);(0,h.kp)(s,{x:c.x,y:c.y});var p=n.createShape(s);i.addShape(p,c.parent);var l=(0,C.P)('[data-element-id="'+(0,k.F)(c.id)+'"]',e.dragGroup);l&&(0,Fn.CF)(l,{display:"none"});var u=o.addDragger(p,e.dragGroup);e.visualReplacements[a]=u,i.removeShape(p)}})}(r):function(e){var t=e.visualReplacements;(0,h.jJ)(t,function(n,i){var o=(0,C.P)('[data-element-id="'+(0,k.F)(i)+'"]',e.dragGroup);o&&(0,Fn.CF)(o,{display:"inline"}),n.remove(),t[i]&&delete t[i]})}(r)})}Qh.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"],(0,i.A)(Qh,Jt.A);const Kh={__depends__:[Xi],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",Qh]};var Zh=40,Yh=["x","y"],ed=Math.abs;function td(e){e.on(["connect.hover","connect.move","connect.end"],1250,function(e){var t,n,i=e.context,o=i.canExecute,r=i.start,a=i.hover,s=i.source,c=i.target;e.originalEvent&&(0,Sn.nM)(e.originalEvent)||(i.initialConnectionStart||(i.initialConnectionStart=i.connectionStart),o&&a&&function(e,t,n){Yh.forEach(function(i){var o=od(i,t);e[i]<t[i]+n?Ai(e,i,t[i]+n):e[i]>t[i]+o-n&&Ai(e,i,t[i]+o-n)})}(e,a,function(e){return(0,on.is)(e,"bpmn:Task")?10:20}(a)),a&&(t=o,n=["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"],(0,h.zN)(n,function(e){return id(t,e)}))?(i.connectionStart=Pi(r),(0,on.f7)(a,["bpmn:Event","bpmn:Gateway"])&&nd(e,Pi(a)),(0,on.f7)(a,["bpmn:Task","bpmn:SubProcess"])&&function(e,t){var n=Pi(t);Yh.forEach(function(i){(function(e,t,n){return e[n]>t[n]+20&&e[n]<t[n]+od(n,t)-20})(e,t,i)&&Ai(e,i,n[i])})}(e,a),(0,on.is)(s,"bpmn:BoundaryEvent")&&c===s.host&&function(e){var t=e.context,n=t.source,i=t.target;if(function(e){var t=e.hover,n=e.source;return t&&n&&t===n}(t))return;var o=Pi(n),r=(0,qt.vc)(o,i,-10),a=[];/top|bottom/.test(r)&&a.push("x");/left|right/.test(r)&&a.push("y");a.forEach(function(t){var n,i=e[t];ed(i-o[t])<Zh&&(n=i>o[t]?o[t]+Zh:o[t]-Zh,Ai(e,t,n))})}(e)):id(o,"bpmn:MessageFlow")?((0,on.is)(r,"bpmn:Event")&&(i.connectionStart=Pi(r)),(0,on.is)(a,"bpmn:Event")&&nd(e,Pi(a))):i.connectionStart=i.initialConnectionStart)})}function nd(e,t){Ai(e,"x",t.x),Ai(e,"y",t.y)}function id(e,t){return e&&e.type===t}function od(e,t){return"x"===e?t.width:t.height}function rd(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function ad(){this._snapValues={}}td.$inject=["eventBus"],rd.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]},rd.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,-1===this._snapLocations.indexOf(e)&&this._snapLocations.push(e)},rd.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)},rd.prototype.getSnapLocations=function(){return this._snapLocations},rd.prototype.setSnapLocations=function(e){this._snapLocations=e},rd.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new ad).initDefaults(this._defaultSnaps),n},ad.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),-1===n.x.indexOf(t.x)&&n.x.push(t.x),-1===n.y.indexOf(t.y)&&n.y.push(t.y)},ad.prototype.snap=function(e,t,n,i){var o=this._snapValues[t];return o&&function(e,t,n){var i,o;for(n=void 0===n?10:n,i=0;i<t.length;i++)if(o=t[i],Ei(o-e)<=n)return o}(e[n],o[n],i)},ad.prototype.initDefaults=function(e){var t=this;(0,h.jJ)(e||{},function(e,n){(0,h.jJ)(e,function(e){t.add(n,e)})})};function sd(e,t,n){var i=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(e){i.initSnap(e)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],1250,function(e){var t=e.context,o=t.shape,r=t.snapContext,a=t.target;if((!e.originalEvent||!(0,Sn.nM)(e.originalEvent))&&!Ti(e)&&a){var s=r.pointsForTarget(a);s.initialized||((s=i.addSnapTargetPoints(s,o,a)).initialized=!0),n.snap(e,s)}}),t.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}sd.$inject=["elementRegistry","eventBus","snapping"],sd.prototype.initSnap=function(e){var t,n=this._elementRegistry,i=e.context,o=i.shape,r=i.snapContext;r||(r=i.snapContext=new rd);var a=(t=n.get(o.id)?Pi(o,e):{x:e.x+Pi(o).x,y:e.y+Pi(o).y}).x-o.width/2,s=t.y-o.height/2,c=t.x+o.width/2,p=t.y+o.height/2;return r.setSnapOrigin("mid",{x:t.x-e.x,y:t.y-e.y}),(0,P.J2)(o)||(r.setSnapOrigin("top-left",{x:a-e.x,y:s-e.y}),r.setSnapOrigin("bottom-right",{x:c-e.x,y:p-e.y})),r},sd.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return(0,h.jJ)(i,function(n){if((0,P.J2)(n))(0,P.J2)(t)&&e.add("mid",Pi(n));else if((0,P.fX)(n)){if(n.waypoints.length<3)return;var i=n.waypoints.slice(1,-1);(0,h.jJ)(i,function(t){e.add("mid",t)})}else e.add("mid",Pi(n))}),(0,h.Et)(t.x)&&(0,h.Et)(t.y)?(this._elementRegistry.get(t.id)&&e.add("mid",Pi(t)),e):e},sd.prototype.getSnapTargets=function(e,t){return ji(t).filter(function(e){return!e.hidden})};function cd(e,t){t.invoke(sd,this),e.on(["create.move","create.end"],1500,pd),e.on(["create.move","create.end","shape.move.move","shape.move.end"],1500,function(e){var t=e.context,n=t.canExecute,i=t.target;n&&("attach"===n||n.attach)&&!Ti(e)&&function(e,t){var n,i=(0,qt.Fy)(t),o=ka(e,t),r=e.context,a=r.shape;n=a.parent?{x:0,y:0}:(0,qt.pp)(a);/top/.test(o)?Ai(e,"y",i.top-n.y):/bottom/.test(o)&&Ai(e,"y",i.bottom-n.y);/left/.test(o)?Ai(e,"x",i.left-n.x):/right/.test(o)&&Ai(e,"x",i.right-n.x)}(e,i)})}function pd(e){var t=e.context.createConstraints;if(t){var n=t.top,i=t.right,o=t.bottom,r=t.left;(r&&r>=e.x||i&&i<=e.x)&&Ai(e,"x",e.x),(n&&n>=e.y||o&&o<=e.y)&&Ai(e,"y",e.y)}}function ld(e,t){return-1!==e.indexOf(t)}function ud(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}(0,i.A)(cd,sd),cd.$inject=["eventBus","injector"],cd.prototype.initSnap=function(e){var t=sd.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return(0,h.jJ)(n.outgoing,function(n){var o=n.waypoints[0];o=o.original||o,t.setSnapOrigin(n.id+"-docking",ud(o,i,e))}),(0,h.jJ)(n.incoming,function(n){var o=n.waypoints[n.waypoints.length-1];o=o.original||o,t.setSnapOrigin(n.id+"-docking",ud(o,i,e))}),(0,on.is)(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t},cd.prototype.addSnapTargetPoints=function(e,t,n){sd.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);(0,h.jJ)(i,function(n){var i;(function(e){if((0,on.is)(e,"bpmn:SubProcess")&&(0,rn.Av)(e))return!0;return(0,on.is)(e,"bpmn:Participant")}(n)||(i="bpmn:TextAnnotation",[t,n].every(function(e){return(0,on.is)(e,i)})))&&(e.add("top-left",Ci(n)),e.add("bottom-right",ki(n)))});var o=this._elementRegistry;return(0,h.jJ)(t.incoming,function(n){if(o.get(t.id)){ld(i,n.source)||e.add("mid",(0,qt.pp)(n.source));var r=n.waypoints[0];e.add(n.id+"-docking",r.original||r)}}),(0,h.jJ)(t.outgoing,function(n){if(o.get(t.id)){ld(i,n.target)||e.add("mid",(0,qt.pp)(n.target));var r=n.waypoints[n.waypoints.length-1];e.add(n.id+"-docking",r.original||r)}}),(0,on.is)(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e},cd.prototype.getSnapTargets=function(e,t){return sd.prototype.getSnapTargets.call(this,e,t).filter(function(e){return!(0,on.is)(e,"bpmn:Lane")})};function hd(e,t){var n=this;e.on(["resize.start"],function(e){n.initSnap(e)}),e.on(["resize.move","resize.end"],1250,function(e){var i=e.context,o=i.shape,r=o.parent,a=i.direction,s=i.snapContext;if((!e.originalEvent||!(0,Sn.nM)(e.originalEvent))&&!Ti(e)){var c=s.pointsForTarget(r);c.initialized||((c=n.addSnapTargetPoints(c,o,r,a)).initialized=!0),function(e){return"n"===e||"s"===e}(a)&&Ai(e,"x",e.x),function(e){return"e"===e||"w"===e}(a)&&Ai(e,"y",e.y),t.snap(e,c)}}),e.on(["resize.cleanup"],function(){t.hide()})}function dd(e,t){var n=(0,qt.pp)(e),i=(0,qt.Fy)(e),o={x:n.x,y:n.y};return-1!==t.indexOf("n")?o.y=i.top:-1!==t.indexOf("s")&&(o.y=i.bottom),-1!==t.indexOf("e")?o.x=i.right:-1!==t.indexOf("w")&&(o.x=i.left),o}hd.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,o=t.snapContext;o||(o=t.snapContext=new rd);var r=dd(n,i);return o.setSnapOrigin("corner",{x:r.x-e.x,y:r.y-e.y}),o},hd.prototype.addSnapTargetPoints=function(e,t,n,i){var o=this.getSnapTargets(t,n);return(0,h.jJ)(o,function(t){e.add("corner",ki(t)),e.add("corner",Ci(t))}),e.add("corner",dd(t,i)),e},hd.$inject=["eventBus","snapping"],hd.prototype.getSnapTargets=function(e,t){return ji(t).filter(function(t){return n=e,!(t.host===n)&&!(0,P.fX)(t)&&!function(e){return!!e.hidden}(t)&&!(0,P.J2)(t);var n})};function fd(e){this._canvas=e,this._asyncHide=(0,h.sg)((0,h.oI)(this.hide,this),1e3)}fd.$inject=["canvas"],fd.prototype.snap=function(e,t){var n=e.context.snapContext,i=n.getSnapLocations(),o={x:Ti(e,"x"),y:Ti(e,"y")};(0,h.jJ)(i,function(i){var r=n.getSnapOrigin(i),a={x:e.x+r.x,y:e.y+r.y};if((0,h.jJ)(["x","y"],function(e){var n;o[e]||void 0!==(n=t.snap(a,i,e,7))&&(o[e]={value:n,originValue:n-r[e]})}),o.x&&o.y)return!1}),this.showSnapLine("vertical",o.x&&o.x.value),this.showSnapLine("horizontal",o.y&&o.y.value),(0,h.jJ)(["x","y"],function(t){var n=o[t];(0,h.Gv)(n)&&Ai(e,t,n.originValue)})},fd.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=(0,Fn.vt)("path");return(0,Fn.CF)(n,{d:"M0,0 L0,0"}),(0,Fn.Ly)(n).add("djs-snap-line"),(0,Fn.BC)(t,n),{update:function(t){(0,h.Et)(t)?"horizontal"===e?(0,Fn.CF)(n,{d:"M-100000,"+t+" L+100000,"+t,display:""}):(0,Fn.CF)(n,{d:"M "+t+",-100000 L "+t+", +100000",display:""}):(0,Fn.CF)(n,{display:"none"})}}},fd.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},fd.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()},fd.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]},fd.prototype.hide=function(){(0,h.jJ)(this._snapLines,function(e){e.update()})};const md={__depends__:[{__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",sd],resizeSnapping:["type",hd],snapping:["type",fd]}],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",td],createMoveSnapping:["type",cd]};function vd(e,t,n,i){this._open=!1,this._results={},this._eventMaps=[],this._cachedRootElement=null,this._cachedSelection=null,this._cachedViewbox=null,this._canvas=e,this._eventBus=t,this._selection=n,this._translate=i,this._container=this._getBoxHtml(),this._searchInput=(0,C.P)(vd.INPUT_SELECTOR,this._container),this._resultsContainer=(0,C.P)(vd.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy","drag.init","elements.changed"],this.close,this)}function gd(e,t,n){var i=function(e){var t="";return e.forEach(function(e){var n=(0,k.Z)(e.value||e.matched||e.normal),i=e.match||e.matched;t+=i?'<b class="'+vd.RESULT_HIGHLIGHT_CLASS+'">'+n+"</b>":n}),""!==t?t:null}(t),o=(0,C.zm)(n);o.innerHTML=i,e.appendChild(o)}vd.$inject=["canvas","eventBus","selection","translate"],vd.prototype._bindEvents=function(){var e=this;function t(t,n,i,o){e._eventMaps.push({el:t,type:i,listener:C.Mm.bind(t,n,i,o)})}t(document,"html","click",function(t){e.close(!1)}),t(this._container,vd.INPUT_SELECTOR,"click",function(e){e.stopPropagation(),e.delegateTarget.focus()}),t(this._container,vd.RESULT_SELECTOR,"mouseover",function(t){t.stopPropagation(),e._scrollToNode(t.delegateTarget),e._preselect(t.delegateTarget)}),t(this._container,vd.RESULT_SELECTOR,"click",function(t){t.stopPropagation(),e._select(t.delegateTarget)}),t(this._container,vd.INPUT_SELECTOR,"keydown",function(e){(0,Sn.m0)("ArrowUp",e)&&e.preventDefault(),(0,Sn.m0)("ArrowDown",e)&&e.preventDefault()}),t(this._container,vd.INPUT_SELECTOR,"keyup",function(t){if((0,Sn.m0)("Escape",t))return e.close();if((0,Sn.m0)("Enter",t)){var n=e._getCurrentResult();return n?e._select(n):e.close(!1)}return(0,Sn.m0)("ArrowUp",t)?e._scrollToDirection(!0):(0,Sn.m0)("ArrowDown",t)?e._scrollToDirection():void((0,Sn.m0)(["ArrowLeft","ArrowRight"],t)||e._search(t.delegateTarget.value))})},vd.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){C.Mm.unbind(e.el,e.type,e.listener)})},vd.prototype._search=function(e){var t=this;if(this._clearResults(),e.trim()){var n=this._searchProvider.find(e);if((n=n.filter(function(e){return!t._canvas.getRootElements().includes(e.element)})).length){n.forEach(function(e){var n=e.element.id,i=t._createResultNode(e,n);t._results[n]={element:e.element,node:i}});var i=(0,C.P)(vd.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}else this._selection.select(null)}},vd.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}},vd.prototype._scrollToNode=function(e){if(e&&e!==this._getCurrentResult()){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}},vd.prototype._clearResults=function(){(0,C.IU)(this._resultsContainer),this._results={},this._eventBus.fire("searchPad.cleared")},vd.prototype._getCurrentResult=function(){return(0,C.P)(vd.RESULT_SELECTED_SELECTOR,this._resultsContainer)},vd.prototype._createResultNode=function(e,t){var n=(0,C.zm)(vd.RESULT_HTML);return e.primaryTokens.length>0&&gd(n,e.primaryTokens,vd.RESULT_PRIMARY_HTML),gd(n,e.secondaryTokens,vd.RESULT_SECONDARY_HTML),(0,C.CF)(n,vd.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n},vd.prototype.registerProvider=function(e){this._searchProvider=e},vd.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._cachedRootElement=this._canvas.getRootElement(),this._cachedSelection=this._selection.get(),this._cachedViewbox=this._canvas.viewbox(),this._selection.select(null),this._bindEvents(),this._open=!0,(0,C.Ly)(this._canvas.getContainer()).add("djs-search-open"),(0,C.Ly)(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))},vd.prototype.close=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isOpen()&&(e&&(this._cachedRootElement&&this._canvas.setRootElement(this._cachedRootElement),this._cachedSelection&&this._selection.select(this._cachedSelection),this._cachedViewbox&&this._canvas.viewbox(this._cachedViewbox),this._eventBus.fire("searchPad.restored")),this._cachedRootElement=null,this._cachedSelection=null,this._cachedViewbox=null,this._unbindEvents(),this._open=!1,(0,C.Ly)(this._canvas.getContainer()).remove("djs-search-open"),(0,C.Ly)(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._eventBus.fire("searchPad.closed"),this._canvas.restoreFocus())},vd.prototype.toggle=function(){this.isOpen()?this.close():this.open()},vd.prototype.isOpen=function(){return this._open},vd.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&(0,C.Ly)(t).remove(vd.RESULT_SELECTED_CLASS);var n=(0,C.CF)(e,vd.RESULT_ID_ATTRIBUTE),i=this._results[n].element;(0,C.Ly)(e).add(vd.RESULT_SELECTED_CLASS),this._canvas.scrollToElement(i,{top:300}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}},vd.prototype._select=function(e){var t=(0,C.CF)(e,vd.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this._cachedSelection=null,this._cachedViewbox=null,this.close(!1),this._canvas.scrollToElement(n,{top:300}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)},vd.prototype._getBoxHtml=function(){const e=(0,C.zm)(vd.BOX_HTML),t=(0,C.P)(vd.INPUT_SELECTOR,e);return t&&t.setAttribute("aria-label",this._translate("Search in diagram")),e},vd.CONTAINER_SELECTOR=".djs-search-container",vd.INPUT_SELECTOR=".djs-search-input input",vd.RESULTS_CONTAINER_SELECTOR=".djs-search-results",vd.RESULT_SELECTOR=".djs-search-result",vd.RESULT_SELECTED_CLASS="djs-search-result-selected",vd.RESULT_SELECTED_SELECTOR="."+vd.RESULT_SELECTED_CLASS,vd.RESULT_ID_ATTRIBUTE="data-result-id",vd.RESULT_HIGHLIGHT_CLASS="djs-search-highlight",vd.BOX_HTML='<div class="djs-search-container djs-scrollable">\n  <div class="djs-search-input">\n    <svg class="djs-search-icon" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path fill-rule="evenodd" clip-rule="evenodd" d="M9.0325 8.5H9.625L13.3675 12.25L12.25 13.3675L8.5 9.625V9.0325L8.2975 8.8225C7.4425 9.5575 6.3325 10 5.125 10C2.4325 10 0.25 7.8175 0.25 5.125C0.25 2.4325 2.4325 0.25 5.125 0.25C7.8175 0.25 10 2.4325 10 5.125C10 6.3325 9.5575 7.4425 8.8225 8.2975L9.0325 8.5ZM1.75 5.125C1.75 6.9925 3.2575 8.5 5.125 8.5C6.9925 8.5 8.5 6.9925 8.5 5.125C8.5 3.2575 6.9925 1.75 5.125 1.75C3.2575 1.75 1.75 3.2575 1.75 5.125Z" fill="#22242A"/>\n    </svg>\n    <input type="text" spellcheck="false" />\n  </div>\n  <div class="djs-search-results" />\n</div>',vd.RESULT_HTML='<div class="djs-search-result"></div>',vd.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',vd.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';const yd={__depends__:[Vh.A,_.A,_n.A],searchPad:["type",vd]};function bd(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._search=i,t.registerProvider(this)}function _d(e){const{item:{element:t},tokens:n}=e;return{element:t,primaryTokens:n.label,secondaryTokens:n.id}}bd.$inject=["elementRegistry","searchPad","canvas","search"],bd.prototype.find=function(e){var t=this._canvas.getRootElements(),n=this._elementRegistry.filter(function(e){return!(0,P.J2)(e)&&!t.includes(e)});return this._search(n.map(e=>({element:e,label:(0,Yi.p9)(e),id:e.id})),e,{keys:["label","id"]}).map(_d)};const xd={__depends__:[yd,Lt],__init__:["bpmnSearch"],bpmnSearch:["type",bd]},wd={width:36,height:50},Ed={width:50,height:50};function Sd(e,t,n){return(0,Fn.vt)("path",(0,J.A)({d:e,strokeWidth:2,transform:"translate(".concat(t.x,", ").concat(t.y,")")},n))}function Cd(e,t){this._styles=t,e.registerProvider(this)}function kd(e,t){var n;return"bpmn:DataObjectReference"===t?n=wd:"bpmn:DataStoreReference"===t&&(n=Ed),e.width===n.width&&e.height===n.height}Cd.$inject=["outline","styles"],Cd.prototype.getOutline=function(e){const t=this._styles.cls("djs-outline",["no-fill"]);var n;if(!(0,P.J2)(e))return(0,on.is)(e,"bpmn:Gateway")?(n=(0,Fn.vt)("rect"),(0,h.kp)(n.style,{"transform-box":"fill-box",transform:"rotate(45deg)","transform-origin":"center"}),(0,Fn.CF)(n,(0,h.kp)({x:2,y:2,rx:4,width:e.width-4,height:e.height-4},t))):(0,on.f7)(e,["bpmn:Task","bpmn:SubProcess","bpmn:Group","bpmn:CallActivity"])?(n=(0,Fn.vt)("rect"),(0,Fn.CF)(n,(0,h.kp)({x:-5,y:-5,rx:14,width:e.width+10,height:e.height+10},t))):(0,on.is)(e,"bpmn:EndEvent")?(n=(0,Fn.vt)("circle"),(0,Fn.CF)(n,(0,h.kp)({cx:e.width/2,cy:e.height/2,r:e.width/2+5+1},t))):(0,on.is)(e,"bpmn:Event")?(n=(0,Fn.vt)("circle"),(0,Fn.CF)(n,(0,h.kp)({cx:e.width/2,cy:e.height/2,r:e.width/2+5},t))):(0,on.is)(e,"bpmn:DataObjectReference")&&kd(e,"bpmn:DataObjectReference")?n=Sd("M44.7648 11.3263L36.9892 2.64074C36.0451 1.58628 34.5651 0.988708 33.1904 0.988708H5.98667C3.22688 0.988708 0.989624 3.34892 0.989624 6.26039V55.0235C0.989624 57.9349 3.22688 60.2952 5.98667 60.2952H40.966C43.7257 60.2952 45.963 57.9349 45.963 55.0235V14.9459C45.963 13.5998 45.6407 12.3048 44.7648 11.3263Z",{x:-6,y:-6},t):(0,on.is)(e,"bpmn:DataStoreReference")&&kd(e,"bpmn:DataStoreReference")&&(n=Sd("M1.03845 48.1347C1.03845 49.3511 1.07295 50.758 1.38342 52.064C1.69949 53.3938 2.32428 54.7154 3.56383 55.6428C6.02533 57.4841 10.1161 58.7685 14.8212 59.6067C19.5772 60.4538 25.1388 60.8738 30.6831 60.8738C36.2276 60.8738 41.7891 60.4538 46.545 59.6067C51.2504 58.7687 55.3412 57.4842 57.8028 55.6429C59.0424 54.7156 59.6673 53.3938 59.9834 52.064C60.2938 50.7579 60.3285 49.351 60.3285 48.1344V13.8415C60.3285 12.6249 60.2938 11.218 59.9834 9.91171C59.6673 8.58194 59.0423 7.2602 57.8027 6.33294C55.341 4.49168 51.2503 3.20723 46.545 2.36914C41.7891 1.522 36.2276 1.10204 30.6831 1.10205C25.1388 1.10206 19.5772 1.52206 14.8213 2.36923C10.1162 3.20734 6.02543 4.49183 3.5639 6.33314C2.32433 7.26038 1.69951 8.58206 1.38343 9.91181C1.07295 11.2179 1.03845 12.6247 1.03845 13.8411V48.1347Z",{x:-6,y:-6},t)),n},Cd.prototype.updateOutline=function(e,t){if(!(0,P.J2)(e))return(0,on.f7)(e,["bpmn:SubProcess","bpmn:Group"])?((0,Fn.CF)(t,{width:e.width+10,height:e.height+10}),!0):!!(0,on.f7)(e,["bpmn:Event","bpmn:Gateway","bpmn:DataStoreReference","bpmn:DataObjectReference"])};const Pd={__depends__:[mh],__init__:["outlineProvider"],outlineProvider:["type",Cd]};function Td(e){a.call(this,e)}(0,i.A)(Td,a),Td.Viewer=s.A,Td.NavigatedViewer=c.default,Td.prototype.createDiagram=function(){return this.importXML('<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>')},Td.prototype._interactionModules=[p.A,l.A,u.A],Td.prototype._modelingModules=[Vt,un,Dn,vn,Mi,Ii,Ji,Yl,Ns,ws,au,hu,ku,Tu,Du,Iu,oh,bl,hh,Sh,Xh,Kh,Ku,md,xd,Pd],Td.prototype._modules=[].concat(s.A.prototype._modules,Td.prototype._interactionModules,Td.prototype._modelingModules)}}]);