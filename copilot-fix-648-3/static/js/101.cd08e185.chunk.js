"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[101],{12101:(e,a,i)=>{i.r(a),i.d(a,{default:()=>c});var n=i(89379),t=i(9950),s=i(7306),o=i(29946),r=i(51635),l=i(44414);const c=()=>{var e;const a=(0,s.zy)(),i=(0,s.Zp)(),[c,d]=(0,t.useState)([]),[p,h]=(0,t.useState)(null),[u,g]=(0,t.useState)(!0),[m,v]=(0,t.useState)(null),[_,b]=(0,t.useState)(!0),{profile:x,sourceRepository:j,action:y}=a.state||{},z=()=>{switch(y){case"fork":return{title:"Select Destination for Fork",description:'Choose where to create a fork of "'.concat(null===j||void 0===j?void 0:j.name,'".'),buttonText:"Fork Repository",nextRoute:"/dashboard"};case"create":return{title:"Select Destination for New DAK",description:'Choose where to create your new DAK based on "'.concat(null===j||void 0===j?void 0:j.name,'".'),buttonText:"Continue to Configuration",nextRoute:"/dak-configuration"};default:return{title:"Select Organization",description:"Choose an organization for your DAK.",buttonText:"Continue",nextRoute:"/dashboard"}}},N=(0,t.useCallback)(async()=>{g(!0),v(null);try{let a=[];a=o.A.isAuth()?await o.A.getUserOrganizations():await f();try{const e=await o.A.getWHOOrganization(),i=a.findIndex(e=>"WorldHealthOrganization"===e.login);i>=0?a[i]=(0,n.A)((0,n.A)({},a[i]),e):a.unshift(e)}catch(e){console.warn("Could not fetch WHO organization data, using fallback:",e);const i={id:"who-organization",login:"WorldHealthOrganization",display_name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0};a.some(e=>"WorldHealthOrganization"===e.login)||a.unshift(i)}d(a)}catch(m){console.error("Error fetching organizations:",m),v("Failed to fetch organizations. Please check your connection and try again.");try{const e=await f();d(e)}catch(a){d([{id:"who-organization",login:"WorldHealthOrganization",display_name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0}])}}finally{g(!1)}},[]),f=async()=>{try{return[await o.A.getWHOOrganization(),{id:1,login:"my-health-org",display_name:"My Health Organization",description:"Healthcare technology organization focused on digital health solutions",avatar_url:"https://avatars.githubusercontent.com/u/1?s=200&v=4",html_url:"https://github.com/my-health-org",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Team",private_repos:10}},{id:2,login:"global-health-initiative",display_name:"Global Health Initiative",description:"International organization working on global health standards",avatar_url:"https://avatars.githubusercontent.com/u/2?s=200&v=4",html_url:"https://github.com/global-health-initiative",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!1},plan:{name:"Free",private_repos:0}}]}catch(m){return console.warn("Could not fetch WHO data for mock organizations, using fallback:",m),[{id:"who-organization",login:"WorldHealthOrganization",display_name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Organization",private_repos:"unlimited"},isWHO:!0},{id:1,login:"my-health-org",display_name:"My Health Organization",description:"Healthcare technology organization focused on digital health solutions",avatar_url:"https://avatars.githubusercontent.com/u/1?s=200&v=4",html_url:"https://github.com/my-health-org",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},plan:{name:"Team",private_repos:10}},{id:2,login:"global-health-initiative",display_name:"Global Health Initiative",description:"International organization working on global health standards",avatar_url:"https://avatars.githubusercontent.com/u/2?s=200&v=4",html_url:"https://github.com/global-health-initiative",type:"Organization",permissions:{can_create_repositories:!0,can_create_private_repositories:!1},plan:{name:"Free",private_repos:0}}]}};(0,t.useEffect)(()=>{x&&j&&y?N():i("/")},[x,j,y,i,N]);const O=z(),k=[];return _&&k.push((0,n.A)((0,n.A)({},x),{},{type:"User",display_name:x.name||x.login,description:"Your personal GitHub account",permissions:{can_create_repositories:!0,can_create_private_repositories:!0},isPersonal:!0})),k.push(...c),(0,l.jsx)(r.Mx,{pageName:"organization-selection",children:x&&j&&y?(0,l.jsxs)("div",{className:"org-content",children:[(0,l.jsxs)("div",{className:"breadcrumb",children:[(0,l.jsx)("button",{onClick:()=>i("/"),className:"breadcrumb-link",children:"Select Profile"}),(0,l.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,l.jsx)("button",{onClick:()=>i("/dak-action",{state:{profile:x}}),className:"breadcrumb-link",children:"Choose DAK Action"}),(0,l.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,l.jsx)("button",{onClick:()=>{i("/dak-selection/".concat(x.login),{state:{profile:x,action:y}})},className:"breadcrumb-link",children:"Select DAK"}),(0,l.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,l.jsx)("span",{className:"breadcrumb-current",children:"Select Organization"})]}),(0,l.jsxs)("div",{className:"org-main",children:[(0,l.jsxs)("div",{className:"org-intro",children:[(0,l.jsx)("h2",{children:O.title}),(0,l.jsx)("p",{children:O.description}),j&&(0,l.jsxs)("div",{className:"source-repo-info",children:[(0,l.jsx)("span",{className:"repo-label",children:"Source Repository:"}),(0,l.jsxs)("div",{className:"repo-badge",children:[(0,l.jsx)("span",{className:"repo-name",children:j.name}),(0,l.jsxs)("span",{className:"repo-owner",children:["@",null===(e=j.full_name)||void 0===e?void 0:e.split("/")[0]]})]})]})]}),(0,l.jsxs)("div",{className:"options-section",children:[(0,l.jsx)("div",{className:"include-personal",children:(0,l.jsxs)("label",{className:"checkbox-label",children:[(0,l.jsx)("input",{type:"checkbox",checked:_,onChange:e=>b(e.target.checked)}),(0,l.jsx)("span",{children:"Include my personal account as an option"})]})}),u?(0,l.jsxs)("div",{className:"loading",children:[(0,l.jsx)("div",{className:"spinner"}),(0,l.jsx)("p",{children:"Loading organizations..."})]}):m?(0,l.jsxs)("div",{className:"error-state",children:[(0,l.jsx)("h3",{children:"Error loading organizations"}),(0,l.jsx)("p",{children:m}),(0,l.jsx)("button",{onClick:N,className:"retry-btn",children:"Try Again"})]}):0===k.length?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("h3",{children:"No organizations available"}),(0,l.jsx)("p",{children:"Enable personal account option or join organizations to see options here."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"org-grid",children:k.map(e=>{var a,i,n,t;return(0,l.jsxs)("div",{className:"org-card ".concat((null===p||void 0===p?void 0:p.id)===e.id&&(null===p||void 0===p?void 0:p.type)===e.type?"selected":""," ").concat(e.isPersonal?"personal":""," ").concat(e.isWHO?"who-org":""),onClick:()=>(e=>{h(e)})(e),children:[(0,l.jsxs)("div",{className:"org-header-info",children:[(0,l.jsx)("img",{src:e.avatar_url||"https://github.com/".concat(e.login,".png"),alt:"".concat(e.display_name||e.login," avatar"),className:"org-avatar"}),(0,l.jsxs)("div",{className:"org-details",children:[(0,l.jsx)("h3",{children:e.display_name||e.login}),(0,l.jsxs)("p",{className:"org-login",children:["@",e.login]}),e.isPersonal&&(0,l.jsx)("span",{className:"personal-badge",children:"Personal"}),e.isWHO&&(0,l.jsx)("span",{className:"who-badge",children:"WHO Official"})]})]}),(0,l.jsx)("p",{className:"org-description",children:e.description||"No description available"}),(0,l.jsxs)("div",{className:"org-permissions",children:[(0,l.jsxs)("div",{className:"permission-item",children:[(0,l.jsx)("span",{className:"permission-icon ".concat(null!==(a=e.permissions)&&void 0!==a&&a.can_create_repositories?"allowed":"denied"),children:null!==(i=e.permissions)&&void 0!==i&&i.can_create_repositories?"\u2713":"\u2717"}),(0,l.jsx)("span",{children:"Create repositories"})]}),(0,l.jsxs)("div",{className:"permission-item",children:[(0,l.jsx)("span",{className:"permission-icon ".concat(null!==(n=e.permissions)&&void 0!==n&&n.can_create_private_repositories?"allowed":"denied"),children:null!==(t=e.permissions)&&void 0!==t&&t.can_create_private_repositories?"\u2713":"\u2717"}),(0,l.jsx)("span",{children:"Create private repositories"})]})]}),e.plan&&(0,l.jsxs)("div",{className:"org-plan",children:[(0,l.jsxs)("span",{className:"plan-name",children:[e.plan.name," Plan"]}),void 0!==e.plan.private_repos&&(0,l.jsxs)("span",{className:"plan-repos",children:[e.plan.private_repos," private repos"]})]}),(null===p||void 0===p?void 0:p.id)===e.id&&(null===p||void 0===p?void 0:p.type)===e.type&&(0,l.jsx)("div",{className:"selection-indicator",children:(0,l.jsx)("span",{children:"\u2713 Selected"})})]},"".concat(e.type,"-").concat(e.id))})}),(0,l.jsx)("div",{className:"org-footer",children:(0,l.jsx)("button",{className:"continue-btn",onClick:()=>{if(!p)return void alert("Please select an organization to continue");const e=z();"fork"===y?i(e.nextRoute,{state:{profile:x,repository:(0,n.A)((0,n.A)({},j),{},{full_name:"".concat(p.login,"/").concat(j.name),html_url:"https://github.com/".concat(p.login,"/").concat(j.name),owner:p}),sourceRepository:j,destinationOrganization:p,action:y}}):"create"===y&&i(e.nextRoute,{state:{profile:x,templateRepository:j,destinationOrganization:p,action:y}})},disabled:!p,children:O.buttonText})})]})]})]})]}):(0,l.jsx)("div",{children:"Redirecting..."})})}}}]);