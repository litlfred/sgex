<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Test Fixed Route Validation</title>
    <script src="./routeConfig.js"></script>
</head>
<body>
    <h1>Testing Fixed Route Validation for Issue #903</h1>
    <div id="test-results"></div>
    
    <script>
        function testFix() {
            console.log('Testing the fix for issue #903...');
            
            // Get route configuration 
            var config = getSGEXRouteConfig();
            if (!config) {
                document.getElementById('test-results').innerHTML = 
                    '<p style="color: red;">‚ùå Route configuration failed to load</p>';
                return;
            }
            
            // Test the specific case from the issue
            var testCases = [
                {
                    description: 'select_profile should be recognized as valid component',
                    test: 'select_profile',
                    expected: true
                },
                {
                    description: 'dak-action should be recognized as valid component',
                    test: 'dak-action', 
                    expected: true
                },
                {
                    description: 'dashboard should be recognized as valid component',
                    test: 'dashboard',
                    expected: true
                },
                {
                    description: 'invalid-component should NOT be recognized',
                    test: 'invalid-component',
                    expected: false
                }
            ];
            
            var results = ['<h2>Test Results:</h2>'];
            var allPassed = true;
            
            testCases.forEach(function(testCase) {
                var result = config.isValidComponent(testCase.test);
                var passed = result === testCase.expected;
                var status = passed ? '‚úÖ' : '‚ùå';
                
                results.push(
                    '<p>' + status + ' ' + testCase.description + 
                    '<br>&nbsp;&nbsp;&nbsp;&nbsp;Result: ' + result + 
                    ' (expected: ' + testCase.expected + ')</p>'
                );
                
                if (!passed) allPassed = false;
            });
            
            if (allPassed) {
                results.unshift('<p style="color: green; font-weight: bold;">üéâ All tests passed! Issue #903 should be fixed.</p>');
            } else {
                results.unshift('<p style="color: red; font-weight: bold;">üí• Some tests failed.</p>');
            }
            
            // Test the specific URL pattern that was failing
            results.push('<h3>URL Pattern Analysis:</h3>');
            results.push('<p><strong>Original failing URL:</strong> /sgex/copilot-fix-895/select_profile</p>');
            results.push('<p><strong>Path segments:</strong> ["sgex", "copilot-fix-895", "select_profile"]</p>');
            results.push('<p><strong>Third segment (select_profile) is valid:</strong> ' + 
                        (config.isValidComponent('select_profile') ? 'YES ‚úÖ' : 'NO ‚ùå') + '</p>');
            results.push('<p><strong>This should now route to branch deployment pattern</strong></p>');
            
            document.getElementById('test-results').innerHTML = results.join('');
        }
        
        // Run test when page loads
        window.onload = testFix;
    </script>
</body>
</html>