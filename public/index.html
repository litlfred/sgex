<!DOCTYPE html>
<!--
ðŸš¨ COPILOT PROHIBITION WARNING ðŸš¨

THIS FILE IS ABSOLUTELY CRITICAL TO THE MAIN APPLICATION ENTRY POINT

â›” COPILOT AGENTS ARE STRICTLY PROHIBITED FROM MAKING ANY CHANGES TO THIS FILE
â›” WITHOUT EXPLICIT WRITTEN CONSENT FROM THE REPOSITORY OWNER (@litlfred)

This file is the main entry point for the React application and contains critical
SPA routing restoration logic, security headers, and application initialization.
Any unauthorized changes can break the entire application for all users.

ðŸ”’ REQUIRED PROCESS FOR CHANGES:
1. Request explicit consent from @litlfred in a GitHub comment
2. Wait for written approval before making ANY changes
3. Document the explicit consent in the commit message
4. Test extensively in a separate environment before merging

Violation of this prohibition will result in immediate reversion and 
potential blocking of copilot access to this repository.

ðŸš¨ END PROHIBITION WARNING ðŸš¨
-->
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="SGEX Workbench - WHO SMART Guidelines Exchange collaborative editor"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>SGEX Workbench</title>
    
    <!-- Security Headers for Production -->
    <!-- Content Security Policy (CSP) - Prevents code injection attacks -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://litlfred.github.io https://unpkg.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https://github.com https://avatars.githubusercontent.com; connect-src 'self' https://api.github.com https://github.com https://raw.githubusercontent.com https://iris.who.int https://avatars.githubusercontent.com; font-src 'self'; object-src 'none'; media-src 'self'; frame-src 'none'; child-src 'none'; manifest-src 'self';">
    
    <!-- X-Content-Type-Options - Prevents MIME sniffing -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    
    <!-- Referrer Policy - Controls referrer information leakage -->
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <!-- Permissions Policy - Restricts browser features -->
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), payment=(), usb=(), bluetooth=(), serial=(), midi=(), magnetometer=(), gyroscope=(), accelerometer=(), ambient-light-sensor=(), autoplay=(), display-capture=(), document-domain=(), fullscreen=(), picture-in-picture=(), publickey-credentials-get=(), screen-wake-lock=(), web-share=(), xr-spatial-tracking=()">
    
    <!-- Load SGEX route configuration service -->
    <script src="./routeConfig.js"></script>
    
    <!-- Simplified SPA Routing for GitHub Pages -->
    <!-- Only handles the final route restoration, 404.html handles initial routing -->
    <script type="text/javascript">
      // Simplified SPA routing - just restore routes processed by 404.html
      (function(l) {
        if (l.search[1] === '/' ) {
          var decoded = l.search.slice(1).split('&').map(function(s) { 
            return s.replace(/~and~/g, '&')
          }).join('?');
          var restoredPath = l.pathname.slice(0, -1) + decoded + l.hash;
          
          console.log('SPA Route Restoration:', {
            originalSearch: l.search,
            restoredPath: restoredPath
          });
          
          window.history.replaceState(null, null, restoredPath);
        }
      }(window.location));
    </script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>