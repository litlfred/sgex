"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[1008],{81008:(e,s,i)=>{i.r(s),i.d(s,{default:()=>l});var a=i(9950),r=i(85001),o=i(29946),t=i(29473),n=i(53782),c=i(44414);const l=()=>{var e;const s=(0,r.zy)(),i=(0,r.Zp)(),{user:l}=(0,r.g)(),[d,p]=(0,a.useState)([]),[h,g]=(0,a.useState)(!0),[x,m]=(0,a.useState)(null),[u,j]=(0,a.useState)(null===(e=s.state)||void 0===e?void 0:e.profile);(0,a.useEffect)(()=>{(async()=>{if(l&&!u)try{if(o.A.isAuth()){const e=await o.A.getUser(l);j(e)}else j({login:l,name:l.charAt(0).toUpperCase()+l.slice(1),avatar_url:"https://github.com/".concat(l,".png"),type:"User"})}catch(x){console.error("Error fetching user profile:",x),i("/",{state:{warningMessage:"User '".concat(l,"' not found or not accessible.")}})}})()},[l,u,i]);const v=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g(!0),m(null);try{const i=u.type;if(!e){let e=null;try{e=t.A.getCachedRepositories(u.login,i)}catch(s){console.warn("Error accessing repository cache:",s)}if(e)return console.log("Using cached repositories for ".concat(u.login," (").concat(i,")")),p(e.repositories),void g(!1)}console.log("Fetching fresh repositories for ".concat(u.login," (").concat(i,")"));const a=await o.A.getRepositories(u.login,i);try{t.A.setCachedRepositories(u.login,i,a)}catch(s){console.warn("Error caching repositories:",s)}p(a)}catch(x){console.error("Error fetching repositories:",x),m("Failed to fetch repositories. Please check your connection and try again.")}finally{g(!1)}},[u]);(0,a.useEffect)(()=>{u||l?u&&v():i("/")},[u,l,i,v]);return(0,c.jsx)(n.Mx,{pageName:"repository-selection",children:u?(0,c.jsx)("div",{className:"repo-content",children:(0,c.jsx)("div",{className:"repo-main",children:(0,c.jsxs)("div",{className:"repo-selection",children:[(0,c.jsx)("h2",{children:"Select DAK Repository"}),(0,c.jsx)("p",{children:"Choose a repository containing WHO SMART Guidelines Digital Adaptation Kit content:"}),h?(0,c.jsxs)("div",{className:"loading",children:[(0,c.jsx)("div",{className:"spinner"}),(0,c.jsx)("p",{children:"Loading repositories..."})]}):x?(0,c.jsxs)("div",{className:"error-state",children:[(0,c.jsx)("h3",{children:"Error loading repositories"}),(0,c.jsx)("p",{children:x}),(0,c.jsx)("button",{onClick:()=>v(!0),className:"retry-btn",children:"Try Again"})]}):0===d.length?(0,c.jsxs)("div",{className:"empty-state",children:[(0,c.jsx)("h3",{children:"No DAK repositories found"}),(0,c.jsx)("p",{children:"No repositories found with DAK-related topics or keywords. Create a new repository or add topics like 'who', 'smart-guidelines', 'dak', or 'health' to existing repositories."})]}):(0,c.jsx)("div",{className:"repo-grid",children:d.map(e=>{return(0,c.jsxs)("div",{className:"repo-card",onClick:()=>(e=>{i("/dashboard/".concat(e.owner.login,"/").concat(e.name),{state:{profile:u,repository:e}})})(e),children:[(0,c.jsxs)("div",{className:"repo-header-info",children:[(0,c.jsx)("h3",{children:e.name}),(0,c.jsxs)("div",{className:"repo-meta",children:[e.private&&(0,c.jsx)("span",{className:"private-badge",children:"Private"}),e.language&&(0,c.jsx)("span",{className:"language-badge",children:e.language})]})]}),(0,c.jsx)("p",{className:"repo-description",children:e.description||"No description available"}),(0,c.jsxs)("div",{className:"repo-topics",children:[(e.topics||[]).slice(0,3).map(e=>(0,c.jsx)("span",{className:"topic-tag",children:e},e)),(e.topics||[]).length>3&&(0,c.jsxs)("span",{className:"topic-more",children:["+",(e.topics||[]).length-3," more"]})]}),(0,c.jsxs)("div",{className:"repo-stats",children:[(0,c.jsxs)("div",{className:"stat",children:[(0,c.jsx)("span",{className:"stat-icon",children:"\u2b50"}),(0,c.jsx)("span",{children:e.stargazers_count||0})]}),(0,c.jsxs)("div",{className:"stat",children:[(0,c.jsx)("span",{className:"stat-icon",children:"\ud83c\udf74"}),(0,c.jsx)("span",{children:e.forks_count||0})]}),(0,c.jsxs)("div",{className:"stat",children:[(0,c.jsx)("span",{className:"stat-icon",children:"\ud83d\udcc5"}),(0,c.jsxs)("span",{children:["Updated ",(s=e.updated_at,new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]})]})]})]},e.id);var s})})]})})}):(0,c.jsx)("div",{children:"Redirecting..."})})}}}]);