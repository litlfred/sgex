"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[970],{26970:(e,s,i)=>{i.r(s),i.d(s,{default:()=>n});var a=i(89379),r=i(9950),t=i(85001),o=i(51635),l=i(44414);const n=()=>{const e=(0,t.zy)(),s=(0,t.Zp)(),{profile:i,templateRepository:n,destinationOrganization:c,action:h}=e.state||{},[m,d]=(0,r.useState)({repositoryName:"",repositoryDescription:"",repositoryPrivate:!1,repositoryTopics:["who","smart-guidelines","dak","fhir","implementation-guide"],sushiId:"",sushiName:"",sushiTitle:"",sushiDescription:"",sushiVersion:"0.1.0",sushiStatus:"draft",sushiExperimental:!0,sushiPublisher:(null===c||void 0===c?void 0:c.display_name)||(null===c||void 0===c?void 0:c.login)||"",contactName:(null===i||void 0===i?void 0:i.name)||(null===i||void 0===i?void 0:i.login)||"",contactEmail:(null===i||void 0===i?void 0:i.email)||""}),[u,p]=(0,r.useState)({}),[x,N]=(0,r.useState)(!1),g=(e,s)=>{if(d(i=>(0,a.A)((0,a.A)({},i),{},{[e]:s})),"repositoryName"===e){if(!m.sushiId){const e="".concat(c.login,".").concat(s).toLowerCase();d(s=>(0,a.A)((0,a.A)({},s),{},{sushiId:e}))}if(!m.sushiName){const e=s.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("");d(s=>(0,a.A)((0,a.A)({},s),{},{sushiName:e}))}}((e,s)=>{const i=(0,a.A)({},u);switch(e){case"repositoryName":!s||s.length<3?i.repositoryName="Repository name must be at least 3 characters":/^[a-z0-9][a-z0-9-]*[a-z0-9]$/.test(s)?delete i.repositoryName:i.repositoryName="Repository name must be lowercase with hyphens only";break;case"sushiId":!s||s.length<3?i.sushiId="Implementation Guide ID must be at least 3 characters":/^[a-z0-9][a-z0-9-.]*[a-z0-9]$/.test(s)?delete i.sushiId:i.sushiId="ID must be lowercase with dots or hyphens only";break;case"sushiName":!s||s.length<3?i.sushiName="Name must be at least 3 characters":/^[A-Z][A-Za-z0-9]*$/.test(s)?delete i.sushiName:i.sushiName="Name must be PascalCase (no spaces)";break;case"sushiTitle":!s||s.length<5?i.sushiTitle="Title must be at least 5 characters":delete i.sushiTitle;break;case"sushiDescription":!s||s.length<20?i.sushiDescription="Description must be at least 20 characters":delete i.sushiDescription;break;case"sushiPublisher":!s||s.length<2?i.sushiPublisher="Publisher is required":delete i.sushiPublisher}p(i)})(e,s)},j=()=>{const e=["repositoryName","repositoryDescription","sushiId","sushiName","sushiTitle","sushiDescription","sushiPublisher"].every(e=>{var s;return null===(s=m[e])||void 0===s?void 0:s.trim()}),s=0===Object.keys(u).length;return e&&s};if(!i||!n||!c||"create"!==h)return s("/"),(0,l.jsx)("div",{children:"Redirecting..."});return(0,l.jsx)(o.Mx,{pageName:"dak-configuration",children:(0,l.jsxs)("div",{className:"config-content",children:[(0,l.jsxs)("div",{className:"breadcrumb",children:[(0,l.jsx)("button",{onClick:()=>s("/"),className:"breadcrumb-link",children:"Select Profile"}),(0,l.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,l.jsx)("button",{onClick:()=>s("/dak-action",{state:{profile:i}}),className:"breadcrumb-link",children:"Choose DAK Action"}),(0,l.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,l.jsx)("button",{onClick:()=>s("/dak-selection/".concat(i.login),{state:{profile:i,action:h}}),className:"breadcrumb-link",children:"Select DAK"}),(0,l.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,l.jsx)("button",{onClick:()=>{s("/organization-selection",{state:{profile:i,sourceRepository:n,action:h}})},className:"breadcrumb-link",children:"Select Organization"}),(0,l.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,l.jsx)("span",{className:"breadcrumb-current",children:"Configure DAK"})]}),(0,l.jsxs)("div",{className:"config-main",children:[(0,l.jsxs)("div",{className:"config-intro",children:[(0,l.jsx)("h2",{children:"Configure New DAK"}),(0,l.jsx)("p",{children:"Set up your new Digital Adaptation Kit repository and FHIR Implementation Guide parameters."}),(0,l.jsxs)("div",{className:"template-info",children:[(0,l.jsxs)("div",{className:"info-item",children:[(0,l.jsx)("span",{className:"info-label",children:"Template:"}),(0,l.jsx)("span",{className:"info-value",children:n.name})]}),(0,l.jsxs)("div",{className:"info-item",children:[(0,l.jsx)("span",{className:"info-label",children:"Destination:"}),(0,l.jsxs)("span",{className:"info-value",children:["@",c.login]})]})]})]}),(0,l.jsxs)("div",{className:"config-form",children:[(0,l.jsxs)("div",{className:"form-section",children:[(0,l.jsx)("h3",{children:"Repository Settings"}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"repositoryName",children:"Repository Name*"}),(0,l.jsx)("input",{id:"repositoryName",type:"text",value:m.repositoryName,onChange:e=>g("repositoryName",e.target.value),placeholder:"my-dak-repository",className:u.repositoryName?"error":""}),u.repositoryName&&(0,l.jsx)("span",{className:"error-message",children:u.repositoryName}),(0,l.jsx)("small",{children:"Lowercase with hyphens only. Will be used in the GitHub URL."})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"repositoryDescription",children:"Repository Description*"}),(0,l.jsx)("textarea",{id:"repositoryDescription",value:m.repositoryDescription,onChange:e=>g("repositoryDescription",e.target.value),placeholder:"Digital Adaptation Kit for...",rows:3}),(0,l.jsx)("small",{children:"Short description for the GitHub repository."})]}),(0,l.jsx)("div",{className:"form-group",children:(0,l.jsxs)("label",{className:"checkbox-label",children:[(0,l.jsx)("input",{type:"checkbox",checked:m.repositoryPrivate,onChange:e=>g("repositoryPrivate",e.target.checked)}),(0,l.jsx)("span",{children:"Make repository private"})]})}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Repository Topics"}),(0,l.jsxs)("div",{className:"topics-container",children:[(0,l.jsx)("div",{className:"current-topics",children:m.repositoryTopics.map(e=>(0,l.jsxs)("span",{className:"topic-tag",children:[e,(0,l.jsx)("button",{type:"button",onClick:()=>(e=>{d(s=>(0,a.A)((0,a.A)({},s),{},{repositoryTopics:s.repositoryTopics.filter(s=>s!==e)}))})(e),className:"topic-remove",children:"\xd7"})]},e))}),(0,l.jsxs)("div",{className:"suggested-topics",children:[(0,l.jsx)("small",{children:"Suggested topics:"}),(0,l.jsx)("div",{className:"topic-suggestions",children:["maternal-health","immunization","anc","family-planning","clinical-guidelines","healthcare","digital-health","who-guidelines"].filter(e=>!m.repositoryTopics.includes(e)).map(e=>(0,l.jsxs)("button",{type:"button",onClick:()=>(e=>{e&&!m.repositoryTopics.includes(e)&&d(s=>(0,a.A)((0,a.A)({},s),{},{repositoryTopics:[...s.repositoryTopics,e]}))})(e),className:"topic-suggestion",children:["+ ",e]},e))})]})]})]})]}),(0,l.jsxs)("div",{className:"form-section",children:[(0,l.jsx)("h3",{children:"FHIR Implementation Guide Settings"}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"sushiId",children:"Implementation Guide ID*"}),(0,l.jsx)("input",{id:"sushiId",type:"text",value:m.sushiId,onChange:e=>g("sushiId",e.target.value),placeholder:"who.smart.maternal-health",className:u.sushiId?"error":""}),u.sushiId&&(0,l.jsx)("span",{className:"error-message",children:u.sushiId}),(0,l.jsx)("small",{children:"Unique identifier for the IG (lowercase with dots/hyphens)"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"sushiName",children:"Implementation Guide Name*"}),(0,l.jsx)("input",{id:"sushiName",type:"text",value:m.sushiName,onChange:e=>g("sushiName",e.target.value),placeholder:"WHOSmartMaternalHealth",className:u.sushiName?"error":""}),u.sushiName&&(0,l.jsx)("span",{className:"error-message",children:u.sushiName}),(0,l.jsx)("small",{children:"PascalCase technical name (no spaces)"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"sushiTitle",children:"Implementation Guide Title*"}),(0,l.jsx)("input",{id:"sushiTitle",type:"text",value:m.sushiTitle,onChange:e=>g("sushiTitle",e.target.value),placeholder:"WHO SMART Guidelines - Maternal Health DAK",className:u.sushiTitle?"error":""}),u.sushiTitle&&(0,l.jsx)("span",{className:"error-message",children:u.sushiTitle}),(0,l.jsx)("small",{children:"Human-readable title for the DAK"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"sushiDescription",children:"Description*"}),(0,l.jsx)("textarea",{id:"sushiDescription",value:m.sushiDescription,onChange:e=>g("sushiDescription",e.target.value),placeholder:"This implementation guide provides digital adaptation kit components for...",rows:4,className:u.sushiDescription?"error":""}),u.sushiDescription&&(0,l.jsx)("span",{className:"error-message",children:u.sushiDescription}),(0,l.jsx)("small",{children:"Detailed description of the DAK's purpose and scope"})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"sushiVersion",children:"Version"}),(0,l.jsx)("input",{id:"sushiVersion",type:"text",value:m.sushiVersion,onChange:e=>g("sushiVersion",e.target.value),placeholder:"0.1.0"}),(0,l.jsx)("small",{children:"Semantic version number"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"sushiPublisher",children:"Publisher*"}),(0,l.jsx)("input",{id:"sushiPublisher",type:"text",value:m.sushiPublisher,onChange:e=>g("sushiPublisher",e.target.value),placeholder:"World Health Organization",className:u.sushiPublisher?"error":""}),u.sushiPublisher&&(0,l.jsx)("span",{className:"error-message",children:u.sushiPublisher}),(0,l.jsx)("small",{children:"Organization responsible for publishing"})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"contactName",children:"Contact Name"}),(0,l.jsx)("input",{id:"contactName",type:"text",value:m.contactName,onChange:e=>g("contactName",e.target.value),placeholder:"Your Name"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"contactEmail",children:"Contact Email"}),(0,l.jsx)("input",{id:"contactEmail",type:"email",value:m.contactEmail,onChange:e=>g("contactEmail",e.target.value),placeholder:"your.email@example.com"})]})]})]}),(0,l.jsx)("div",{className:"config-footer",children:(0,l.jsx)("button",{className:"create-btn",onClick:async()=>{if(j()){N(!0);try{await new Promise(e=>setTimeout(e,2e3));const e={id:Date.now(),name:m.repositoryName,full_name:"".concat(c.login,"/").concat(m.repositoryName),description:m.repositoryDescription,html_url:"https://github.com/".concat(c.login,"/").concat(m.repositoryName),clone_url:"https://github.com/".concat(c.login,"/").concat(m.repositoryName,".git"),topics:m.repositoryTopics,private:m.repositoryPrivate,owner:c,smart_guidelines_compatible:!0,created_from_template:!0,template_repository:n};s("/dashboard",{state:{profile:i,repository:e,configuration:m,action:"create",isNewRepository:!0}})}catch(e){console.error("Error creating repository:",e),alert("Failed to create repository. Please try again.")}finally{N(!1)}}else alert("Please fix all errors before continuing")},disabled:!j()||x,children:x?"Creating DAK Repository...":"Create DAK Repository"})})]})]})]})})}}}]);