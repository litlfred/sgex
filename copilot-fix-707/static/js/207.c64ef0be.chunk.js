"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[207],{25207:(e,s,r)=>{r.r(s),r.d(s,{default:()=>l});var a=r(65043),i=r(73537),c=r(93071),o=r(65240),n=r(16786),t=r(70579);const l=()=>{var e;const s=(0,i.zy)(),r=(0,i.Zp)(),{user:l}=(0,i.g)(),[d,p]=(0,a.useState)([]),[h,g]=(0,a.useState)(!0),[m,x]=(0,a.useState)(null),[u,j]=(0,a.useState)(null===(e=s.state)||void 0===e?void 0:e.profile);(0,a.useEffect)(()=>{(async()=>{if(l&&!u)try{if(c.A.isAuth()){const e=await c.A.getUser(l);j(e)}else j({login:l,name:l.charAt(0).toUpperCase()+l.slice(1),avatar_url:"https://github.com/".concat(l,".png"),type:"User",isDemo:!0})}catch(m){console.error("Error fetching user profile:",m),r("/",{state:{warningMessage:"User '".concat(l,"' not found or not accessible.")}})}})()},[l,u,r]);const N=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g(!0),x(null);try{const r=u.type;if(!e){let e=null;try{e=o.A.getCachedRepositories(u.login,r)}catch(s){console.warn("Error accessing repository cache:",s)}if(e)return console.log("Using cached repositories for ".concat(u.login," (").concat(r,")")),p(e.repositories),void g(!1)}console.log("Fetching fresh repositories for ".concat(u.login," (").concat(r,")"));const a=await c.A.getRepositories(u.login,r,u.isDemo);try{o.A.setCachedRepositories(u.login,r,a)}catch(s){console.warn("Error caching repositories:",s)}p(a)}catch(m){console.error("Error fetching repositories:",m),x("Failed to fetch repositories. Please check your connection and try again.")}finally{g(!1)}},[u]);(0,a.useEffect)(()=>{u||l?u&&N():r("/")},[u,l,r,N]);return u?(0,t.jsx)(n.Mx,{pageName:"repository-selection",children:(0,t.jsxs)("div",{className:"repo-content",children:[(0,t.jsxs)("div",{className:"breadcrumb",children:[(0,t.jsx)("button",{onClick:()=>r("/"),className:"breadcrumb-link",children:"Select Profile"}),(0,t.jsx)("span",{className:"breadcrumb-separator",children:"\u203a"}),(0,t.jsx)("span",{className:"breadcrumb-current",children:"Select Repository"})]}),(0,t.jsx)("div",{className:"repo-main",children:(0,t.jsxs)("div",{className:"repo-selection",children:[(0,t.jsx)("h2",{children:"Select DAK Repository"}),(0,t.jsx)("p",{children:"Choose a repository containing WHO SMART Guidelines Digital Adaptation Kit content:"}),h?(0,t.jsxs)("div",{className:"loading",children:[(0,t.jsx)("div",{className:"spinner"}),(0,t.jsx)("p",{children:"Loading repositories..."})]}):m?(0,t.jsxs)("div",{className:"error-state",children:[(0,t.jsx)("h3",{children:"Error loading repositories"}),(0,t.jsx)("p",{children:m}),(0,t.jsx)("button",{onClick:()=>N(!0),className:"retry-btn",children:"Try Again"})]}):0===d.length?(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("h3",{children:"No DAK repositories found"}),(0,t.jsx)("p",{children:"No repositories found with DAK-related topics or keywords. Create a new repository or add topics like 'who', 'smart-guidelines', 'dak', or 'health' to existing repositories."})]}):(0,t.jsx)("div",{className:"repo-grid",children:d.map(e=>{return(0,t.jsxs)("div",{className:"repo-card",onClick:()=>(e=>{r("/dashboard/".concat(e.owner.login,"/").concat(e.name),{state:{profile:u,repository:e}})})(e),children:[(0,t.jsxs)("div",{className:"repo-header-info",children:[(0,t.jsx)("h3",{children:e.name}),(0,t.jsxs)("div",{className:"repo-meta",children:[e.private&&(0,t.jsx)("span",{className:"private-badge",children:"Private"}),e.language&&(0,t.jsx)("span",{className:"language-badge",children:e.language})]})]}),(0,t.jsx)("p",{className:"repo-description",children:e.description||"No description available"}),(0,t.jsxs)("div",{className:"repo-topics",children:[(e.topics||[]).slice(0,3).map(e=>(0,t.jsx)("span",{className:"topic-tag",children:e},e)),(e.topics||[]).length>3&&(0,t.jsxs)("span",{className:"topic-more",children:["+",(e.topics||[]).length-3," more"]})]}),(0,t.jsxs)("div",{className:"repo-stats",children:[(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{className:"stat-icon",children:"\u2b50"}),(0,t.jsx)("span",{children:e.stargazers_count||0})]}),(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{className:"stat-icon",children:"\ud83c\udf74"}),(0,t.jsx)("span",{children:e.forks_count||0})]}),(0,t.jsxs)("div",{className:"stat",children:[(0,t.jsx)("span",{className:"stat-icon",children:"\ud83d\udcc5"}),(0,t.jsxs)("span",{children:["Updated ",(s=e.updated_at,new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]})]})]})]},e.id);var s})})]})})]})}):(0,t.jsx)(n.Mx,{pageName:"repository-selection",children:(0,t.jsx)("div",{children:"Redirecting..."})})}}}]);
//# sourceMappingURL=207.c64ef0be.chunk.js.map