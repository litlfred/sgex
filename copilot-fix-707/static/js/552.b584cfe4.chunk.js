"use strict";(self.webpackChunksgex_workbench=self.webpackChunksgex_workbench||[]).push([[552],{13333:(e,s,a)=>{a.d(s,{hX:()=>n});const n=function(e,s,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if((e=>!!(null!==e&&void 0!==e&&e.ctrlKey||null!==e&&void 0!==e&&e.metaKey))(e)){const e=(e=>{const s="/sgex/copilot-fix-707",a=window.location.origin,n=e.startsWith("/")?e.slice(1):e;if(!s)return"".concat(a,"/").concat(n);const i=s.endsWith("/")?s:s+"/";return"".concat(a).concat(i).concat(n)})(s);window.open(e,"_blank","noopener,noreferrer")}else n?a(s,{state:n}):a(s)}},66175:(e,s,a)=>{a.r(s),a.d(s,{default:()=>g});var n=a(89379),i=a(65043),o=a(73537),t=a(74117),l=a(93071),r=a(65240),c=a(41135),d=a(13333),h=a(70579);const g=()=>{const{t:e}=(0,t.Bd)(),[s,a]=(0,i.useState)(null),[g,u]=(0,i.useState)([]),[m,p]=(0,i.useState)(!1),[x,f]=(0,i.useState)(!1),[v,j]=(0,i.useState)(null),[N,b]=(0,i.useState)({}),[w,y]=(0,i.useState)(null),A=(0,o.Zp)(),z=(0,o.zy)(),k=(0,i.useCallback)((e,s)=>{if(!l.A.isAuth())return;const a={};if(e){const s=r.A.getCachedRepositories(e.login,"user");s&&s.repositories&&(a["user-".concat(e.login)]=s.repositories.length)}s.forEach(e=>{const s=r.A.getCachedRepositories(e.login,"org");s&&s.repositories&&(a["org-".concat(e.login)]=s.repositories.length)}),b(a)},[]),O=(0,i.useCallback)(async()=>{f(!0),j(null);try{let s=null;m?(await l.A.checkTokenPermissions(),s=await l.A.getCurrentUser(),a(s)):(s={login:"anonymous-user",name:"Anonymous User",avatar_url:"https://github.com/github.png",type:"User",isAnonymous:!0},a(s));let i=[];if(m)try{i=await l.A.getUserOrganizations()}catch(v){console.error("Error fetching organizations:",v),i=[]}try{const e=await l.A.getWHOOrganization(),s=i.findIndex(e=>"WorldHealthOrganization"===e.login);s>=0?i[s]=(0,n.A)((0,n.A)((0,n.A)({},i[s]),e),{},{isWHO:!0}):i.unshift(e)}catch(e){console.warn("Could not fetch WHO organization data, using fallback:",e);const s={id:"who-organization",login:"WorldHealthOrganization",name:"World Health Organization",description:"The World Health Organization is a specialized agency of the United Nations responsible for international public health.",avatar_url:"https://avatars.githubusercontent.com/u/12261302?s=200&v=4",html_url:"https://github.com/WorldHealthOrganization",type:"Organization",isWHO:!0};i.some(e=>"WorldHealthOrganization"===e.login)?i=i.map(e=>"WorldHealthOrganization"===e.login?(0,n.A)((0,n.A)({},e),{},{isWHO:!0}):e):i.unshift(s)}u(i),m&&k(s,i)}catch(v){console.error("Error fetching user data:",v),m?(j("Failed to fetch user data. Please check your connection and try again."),p(!1),l.A.logout()):j("Unable to fetch additional data. Some features may be limited.")}finally{f(!1)}},[k,m]);(0,i.useEffect)(()=>{(()=>{const e=l.A.initializeFromStoredToken();p(!!e)})()},[]),(0,i.useEffect)(()=>{var e;null!==(e=z.state)&&void 0!==e&&e.warningMessage&&(y(z.state.warningMessage),A(z.pathname,{replace:!0,state:{}}))},[z.state,A,z.pathname]),(0,i.useEffect)(()=>{s||O()},[s,O]);const W=(e,s)=>{const a={profile:s};(0,d.hX)(e,"/dak-action/".concat(s.login),A,a)};return x&&!s?(0,h.jsx)(c.Mx,{pageName:"select-profile",children:(0,h.jsxs)("div",{className:"loading-section",children:[(0,h.jsx)("div",{className:"spinner"}),(0,h.jsx)("p",{children:"Loading profile data..."})]})}):(0,h.jsx)(c.Mx,{pageName:"select-profile",children:(0,h.jsxs)("div",{className:"select-profile-content",children:[w&&(0,h.jsx)("div",{className:"warning-message",children:(0,h.jsxs)("div",{className:"warning-content",children:[(0,h.jsxs)("div",{className:"warning-header",children:[(0,h.jsx)("span",{className:"warning-icon",children:"\u26a0\ufe0f"}),(0,h.jsx)("span",{className:"warning-text",children:w})]}),(0,h.jsx)("button",{className:"warning-dismiss",onClick:()=>{y(null)},"aria-label":"Dismiss warning",children:"\xd7 Dismiss"})]})}),!m&&(0,h.jsx)("div",{className:"auth-status-message",children:(0,h.jsxs)("div",{className:"auth-status-content",children:[(0,h.jsx)("span",{className:"auth-status-icon",children:"\ud83d\udd13"}),(0,h.jsx)("span",{className:"auth-status-text",children:"You are browsing in unauthenticated mode. Some features like saving to GitHub will be disabled, but you can still explore and use local staging."})]})}),x?(0,h.jsxs)("div",{className:"loading-section",children:[(0,h.jsx)("div",{className:"spinner"}),(0,h.jsx)("p",{children:"Loading profile data..."})]}):(0,h.jsxs)("div",{className:"profile-selection",children:[(0,h.jsx)("h2",{children:e("organization.select")}),(0,h.jsxs)("p",{children:[e("organization.personal"),":"]}),v&&(0,h.jsx)("div",{className:"error-message",children:v}),(0,h.jsxs)("div",{className:"profile-grid-horizontal",children:[(m||(null===s||void 0===s?void 0:s.isAnonymous))&&(0,h.jsxs)("div",{className:"profile-card",onClick:e=>W(e,(0,n.A)({type:"user"},s)),children:[(0,h.jsxs)("div",{className:"profile-card-header",children:[(0,h.jsx)("img",{src:null===s||void 0===s?void 0:s.avatar_url,alt:"Personal profile"}),N["user-".concat(null===s||void 0===s?void 0:s.login)]>0&&(0,h.jsx)("div",{className:"dak-count-badge",children:N["user-".concat(null===s||void 0===s?void 0:s.login)]})]}),(0,h.jsx)("h3",{children:(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.login)}),(0,h.jsx)("p",{children:null!==s&&void 0!==s&&s.isAnonymous?"Anonymous browsing":"Personal repositories"}),(0,h.jsxs)("div",{className:"profile-badges",children:[(0,h.jsx)("span",{className:"profile-type",children:null!==s&&void 0!==s&&s.isAnonymous?"Anonymous":"Personal"}),(null===s||void 0===s?void 0:s.isAnonymous)&&(0,h.jsx)("span",{className:"auth-badge",children:"Limited Access"})]})]}),g.map(s=>(0,h.jsxs)("div",{className:"profile-card ".concat(s.isWHO?"who-org":""),onClick:e=>W(e,(0,n.A)({type:"org"},s)),children:[(0,h.jsxs)("div",{className:"profile-card-header",children:[(0,h.jsx)("img",{src:s.avatar_url||"https://github.com/".concat(s.login,".png"),alt:"".concat(s.name||s.login," organization")}),N["org-".concat(s.login)]>0&&(0,h.jsx)("div",{className:"dak-count-badge",children:N["org-".concat(s.login)]})]}),(0,h.jsx)("h3",{children:s.name||s.login}),(0,h.jsxs)("p",{children:["@",s.login]}),(0,h.jsxs)("div",{className:"profile-badges",children:[(0,h.jsx)("span",{className:"profile-type",children:e("organization.organizations")}),s.isWHO&&(0,h.jsx)("span",{className:"who-badge",children:"WHO Official"})]})]},s.login))]})]})]})})}}}]);
//# sourceMappingURL=552.b584cfe4.chunk.js.map